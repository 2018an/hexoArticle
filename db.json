{"meta":{"version":1,"warehouse":"5.0.1"},"models":{"Asset":[{"_id":"themes/heyan/source/logo - å‰¯æœ¬.png","path":"logo - å‰¯æœ¬.png","modified":0,"renderable":1},{"_id":"themes/heyan/source/logo.png","path":"logo.png","modified":0,"renderable":1},{"_id":"themes/heyan/source/police.png","path":"police.png","modified":0,"renderable":1},{"_id":"themes/heyan/source/logo1.png","path":"logo1.png","modified":0,"renderable":1},{"_id":"themes/heyan/source/css/index.styl","path":"css/index.styl","modified":0,"renderable":1},{"_id":"themes/heyan/source/css/markdown.styl","path":"css/markdown.styl","modified":0,"renderable":1},{"_id":"themes/heyan/source/css/prism.css","path":"css/prism.css","modified":0,"renderable":1},{"_id":"themes/heyan/source/favicon/about.txt","path":"favicon/about.txt","modified":0,"renderable":1},{"_id":"themes/heyan/source/favicon/android-chrome-192x192.png","path":"favicon/android-chrome-192x192.png","modified":0,"renderable":1},{"_id":"themes/heyan/source/favicon/android-chrome-512x512.png","path":"favicon/android-chrome-512x512.png","modified":0,"renderable":1},{"_id":"themes/heyan/source/favicon/favicon-16x16.png","path":"favicon/favicon-16x16.png","modified":0,"renderable":1},{"_id":"themes/heyan/source/favicon/apple-touch-icon.png","path":"favicon/apple-touch-icon.png","modified":0,"renderable":1},{"_id":"themes/heyan/source/favicon/favicon-32x32.png","path":"favicon/favicon-32x32.png","modified":0,"renderable":1},{"_id":"themes/heyan/source/favicon/favicon.ico","path":"favicon/favicon.ico","modified":0,"renderable":1},{"_id":"themes/heyan/source/favicon/site.webmanifest","path":"favicon/site.webmanifest","modified":0,"renderable":1},{"_id":"themes/heyan/source/js/fancybox.js","path":"js/fancybox.js","modified":0,"renderable":1},{"_id":"themes/heyan/source/js/prism.js","path":"js/prism.js","modified":0,"renderable":1},{"_id":"themes/heyan/source/js/search.js","path":"js/search.js","modified":0,"renderable":1}],"Cache":[{"_id":"themes/heyan/.gitignore","hash":"b74ab8670f8a87b36fb8726fd6282ef2f8f27e5a","modified":1753076462000},{"_id":"themes/heyan/LICENSE","hash":"7df059597099bb7dcf25d2a9aedfaf4465f72d8d","modified":1753076462000},{"_id":"themes/heyan/README.md","hash":"87dc0dad2bd5b68a9e8b5c3819174b2bf8937848","modified":1753076462000},{"_id":"themes/heyan/_config.yml","hash":"c2a68a6f45ff2aa9893c4f56e8924c665ae8f1e4","modified":1760521690610},{"_id":"themes/heyan/languages/de-DE.yml","hash":"5d3556a885e355a8c2da65ef3e7b3ee36a628bfa","modified":1753076462000},{"_id":"themes/heyan/languages/es-ES.yml","hash":"58e1d04bcd1834fa9d2960e18e027abbbccbedc9","modified":1753076462000},{"_id":"themes/heyan/languages/fr-FR.yml","hash":"b47906ec0abf867fb3e3360bc046b7afb68aee25","modified":1753076462000},{"_id":"themes/heyan/languages/ko.yml","hash":"909a33e0befa6978e8e72157c6b415b48551ee31","modified":1753076462000},{"_id":"themes/heyan/languages/en.yml","hash":"9c979a2f107536399bbe2be572c2d0bebcdd9d95","modified":1753076462000},{"_id":"themes/heyan/languages/ru.yml","hash":"2476a631f4d3c668de04af85a6c2c97ba2a57e96","modified":1753076462000},{"_id":"themes/heyan/languages/zh-TW.yml","hash":"e9747f9b3ec1314a3cae44a9a90e7649af739633","modified":1753076462000},{"_id":"themes/heyan/languages/zh-CN.yml","hash":"78cc1794a3ce3e186c462c1a70f097d0c05cd210","modified":1753076462000},{"_id":"themes/heyan/layout/archive.ejs","hash":"97ac0ea7dff13181f74415fb35a733de4c2d3e82","modified":1760518008489},{"_id":"themes/heyan/layout/category.ejs","hash":"5e97ceb9309b8361b33b9d09d622bef2f6a33ab0","modified":1753076462000},{"_id":"themes/heyan/layout/layout.ejs","hash":"537088692915fda76a12830c9674fc4a2a3cab6b","modified":1753076462000},{"_id":"themes/heyan/layout/index.ejs","hash":"20f43b481c7748b27394ed017fe7b20f7a30fbfb","modified":1760523493014},{"_id":"themes/heyan/layout/page.ejs","hash":"a5f9afe66aefb24abb2b88975bfd631376791f65","modified":1753076462000},{"_id":"themes/heyan/layout/post.ejs","hash":"432a12279e997bf46df556161432e0f5b34db783","modified":1753076462000},{"_id":"themes/heyan/layout/tag.ejs","hash":"2fad18eaf49ffbd1338e5bc8d15ebdbe3a696ea9","modified":1753076462000},{"_id":"themes/heyan/source/logo - å‰¯æœ¬.png","hash":"ce91374e148e3391f8f3235b672fa32cd3746d7c","modified":1753076462000},{"_id":"themes/heyan/source/logo1.png","hash":"ce91374e148e3391f8f3235b672fa32cd3746d7c","modified":1753076462000},{"_id":"themes/heyan/scripts/mathjax_util.js","hash":"9a6be519b747c70948b8b63840d13cf0bdff95ec","modified":1753076462000},{"_id":"themes/heyan/source/police.png","hash":"7ec67ebc6cf0b3c79ec5cdd35b8c48f2fef2d80e","modified":1753076462000},{"_id":"themes/heyan/layout/_partial/footer.ejs","hash":"9e10eca74cd0f34fc4b63b0bfc1917088537ea30","modified":1760511846542},{"_id":"themes/heyan/layout/_partial/header.ejs","hash":"a861ff21fb57c7de48bdea9a8b9cd0cd1aefdf63","modified":1760583564182},{"_id":"themes/heyan/layout/_partial/nav.ejs","hash":"4e1ba71082b05dd7fee2573f82599feffac37c62","modified":1760518512048},{"_id":"themes/heyan/layout/_partial/next_post.ejs","hash":"a0ea0efc0b4b6f2cd3867373ed8d91056b57afe2","modified":1753076462000},{"_id":"themes/heyan/layout/_partial/paginator.ejs","hash":"e6ad2d3ab7e929cac007f25cf3d01658463114ab","modified":1753076462000},{"_id":"themes/heyan/layout/_partial/nav_menu.ejs","hash":"d98f7154722d4a4f6cd2cb31b7e1b603b1b72625","modified":1753076462000},{"_id":"themes/heyan/layout/_partial/post_list.ejs","hash":"88fe95a52bf0283ff284084b2f553d992feb87e5","modified":1760580976881},{"_id":"themes/heyan/layout/_partial/sidebar.ejs","hash":"b4c5ca3531674b194be7ffbdd5464f28fe1e9790","modified":1753076462000},{"_id":"themes/heyan/layout/_widget/category.ejs","hash":"60a5dd9a839b7379485ad3fc84746835f271211b","modified":1753076462000},{"_id":"themes/heyan/layout/_widget/links.ejs","hash":"e3c53cf5a247e5f916ce9aec1e7a1d121ce25ba4","modified":1753076462000},{"_id":"themes/heyan/layout/_widget/recent.ejs","hash":"245b3ce687dbab17dbd0b9f7c966a61064466689","modified":1753076462000},{"_id":"themes/heyan/layout/_widget/same_category.ejs","hash":"45a7b90364a5057dabd0ae6266a2ca139cfdb3ec","modified":1753076462000},{"_id":"themes/heyan/layout/_widget/related_posts.ejs","hash":"be23800b8777da59c0fb60fc540bc97caa980ffe","modified":1753076462000},{"_id":"themes/heyan/layout/_widget/search.ejs","hash":"1c1dffe48aa0e301b5866661faa4c79378f72f68","modified":1760518384127},{"_id":"themes/heyan/layout/_widget/tag.ejs","hash":"deef7b208d3d283dd960bf1f462080070959d0d7","modified":1753076462000},{"_id":"themes/heyan/layout/_widget/toc.ejs","hash":"c313013b91a7d2d58ca528886d2f68c2959a88fb","modified":1753076462000},{"_id":"themes/heyan/source/css/index.styl","hash":"0f3c6643833eb15907ba83ca36513174afaf9934","modified":1760579400919},{"_id":"themes/heyan/source/css/markdown.styl","hash":"46309f1bd5bf6425f9dac28f51c788b375cb7c15","modified":1753076462000},{"_id":"themes/heyan/source/favicon/about.txt","hash":"0d732aeb0fbae1e3a711c98a0ad4e04cc079f5e6","modified":1753076462000},{"_id":"themes/heyan/source/css/prism.css","hash":"8f4f3c2c50e06c4c93cea8f65273ba3d69038a36","modified":1760516486038},{"_id":"themes/heyan/source/favicon/android-chrome-192x192.png","hash":"ae182103e859a6cf14ea9bc053cf1a4926ea3d21","modified":1753076462000},{"_id":"themes/heyan/source/favicon/android-chrome-512x512.png","hash":"ebae4f76f3bb5521ed0655e78a10c235444ad42c","modified":1753076462000},{"_id":"themes/heyan/source/favicon/favicon-16x16.png","hash":"cb44828efc81002729bbc2396ba85f0e30e63bc4","modified":1753076462000},{"_id":"themes/heyan/source/favicon/apple-touch-icon.png","hash":"662a0af0933fcc0ce3c1cfc12ed07e7ae4306094","modified":1753076462000},{"_id":"themes/heyan/source/favicon/favicon-32x32.png","hash":"763b31f84d7ecf62946eb426692b949d31218b8e","modified":1753076462000},{"_id":"themes/heyan/source/favicon/site.webmanifest","hash":"bf31baf91bdd2fcde24a45e3f2a1be33733c6f69","modified":1753076462000},{"_id":"themes/heyan/source/favicon/favicon.ico","hash":"27ad4ec726910ba22e33da90ac55a9ac0bfac593","modified":1753076462000},{"_id":"themes/heyan/source/js/fancybox.js","hash":"d638c7b5fc3f87dd44b65c4769dbf97f41834f9f","modified":1753076462000},{"_id":"themes/heyan/source/js/prism.js","hash":"b8aad0b4b24ebc2907a60af635b22b4c459541b9","modified":1753076462000},{"_id":"themes/heyan/source/js/search.js","hash":"a6410a3f33b47ee4548d461b6fc6d1785fa36f2b","modified":1753076462000},{"_id":"source/index.md","hash":"dc20e7e49e39ba8510e36df7948f43a180e8c634","modified":1760522793232},{"_id":"source/_data/styles.styl","hash":"c223785291fa67b65e801b98311fc977c03f39a6","modified":1760522137846},{"_id":"source/_posts/JVM/JVMè¿è¡Œæ—¶åŒºåŸŸè¯¦è§£.md","hash":"19a37b48d04e3c0d06146ed76fe05aac9bd9c203","modified":1760523131562},{"_id":"source/_posts/hello-world.md","hash":"a57a9052918633fc13216e39e9be39630fd91b22","modified":1760516544471},{"_id":"source/about/index.md","hash":"a53c2e0ba2e14493d3e51df1adce12e0fc9770dc","modified":1760514010208},{"_id":"source/_posts/è¿›é˜¶/Java ä¸­çš„ 6 é¢—è¯­æ³•ç³–.md","hash":"7d4008ab03cdae5b843470e5c8fd4156e957013b","modified":1760583068329},{"_id":"source/categories/index.md","hash":"68ab054f1a5307fa0f5f88948df8c993754d3992","modified":1760515966510},{"_id":"source/_posts/è¿›é˜¶/Java ä¸­çš„ä¼ªå…±äº«è¯¦è§£åŠè§£å†³æ–¹æ¡ˆ.md","hash":"2d9d3fcfbc521374961a1624acbc6371724331cc","modified":1760512874235},{"_id":"source/_posts/æ–°ç‰¹æ€§/Java 5 ~ 10 æ–°ç‰¹æ€§å€¾æƒ…æ•´ç†ï¼.md","hash":"92b86a97241dbe839d2f6f1895e2b29f2fe67e2d","modified":1760512851376},{"_id":"source/_posts/è¿›é˜¶/Java ä¸­çš„ String çœŸçš„æ˜¯ä¸å¯å˜å—ï¼Ÿ.md","hash":"eac371e22a5539d4c00ff8b6a8af34007bb25d13","modified":1760512874230},{"_id":"source/_posts/è¿›é˜¶/Java ä¸­çš„å®å˜é‡ï¼Œå®æ›¿æ¢è¯¦è§£ã€‚.md","hash":"c02b542a02caecb74c15d3f1b5640b348e003008","modified":1760512874269},{"_id":"source/_posts/è¿›é˜¶/Java ä¸­è·å–ç±»åçš„ä¸‰ç§æ–¹æ³•ï¼Œä½ çŸ¥é“å‡ ç§ï¼Ÿ.md","hash":"cbdb8cef57206781573ddc8fe6483144e775cf32","modified":1760512874226},{"_id":"source/_posts/è¿›é˜¶/Java å¯¹è±¡å¼•ç”¨å››ä¸ªçº§åˆ«ï¼ˆå¼ºã€è½¯ã€å¼±ã€è™šï¼‰.md","hash":"1446572619bf8625178315aef788d12e65c07ad0","modified":1760512874282},{"_id":"source/_posts/è¿›é˜¶/Java å¼‚å¸¸å¤„ç† 10 ä¸ªæœ€ä½³å®è·µ.md","hash":"0109a7d5183bb9a7a23ef06388a50381a7f9cb7b","modified":1760512874273},{"_id":"source/_posts/è¿›é˜¶/Java ç±»åˆå§‹åŒ–é¡ºåºï¼Œ3ä¸ªç¤ºä¾‹å¸¦ä½ èººå‘ã€‚.md","hash":"11ae00de8b6b61534164942a4db5b0dd04e48b5e","modified":1760512874219},{"_id":"source/_posts/è¿›é˜¶/Java è‡ªå®šä¹‰ ClassLoader å®æˆ˜.md","hash":"194d79d2784bf0e45a3d814b2370da82744860ae","modified":1760512874287},{"_id":"source/_posts/è¿›é˜¶/hashCode å’Œ identityHashCode çš„åŒºåˆ«ä½ çŸ¥é“å—ï¼Ÿ.md","hash":"2b7e58819972df8626c0f043c4678af6cfe0e1b5","modified":1760512874277},{"_id":"source/_posts/è¿›é˜¶/åˆ«å†å†™ bug äº†ï¼Œé¿å…ç©ºæŒ‡é’ˆçš„ 5 ä¸ªæ¡ˆä¾‹ï¼.md","hash":"672ea27c566546c4c38e59f1915d257ef5ffbab9","modified":1760512874206},{"_id":"source/_posts/è¿›é˜¶/ä¸èƒ½ç”¨ + æ‹¼æ¥å­—ç¬¦ä¸²ï¼Ÿ è¿™æ¬¡æˆ‘è¦åŠæ‰“é¢è¯•å®˜ï¼.md","hash":"cc2b20c79e5ad16a93411c0b356c3c3215d4f023","modified":1760512874223},{"_id":"source/_posts/è¿›é˜¶/å­—ç¬¦ä¸² substring æ–¹æ³•åœ¨ JDK 6,7,8 ä¸­çš„å·®å¼‚ã€‚.md","hash":"b988100b3796681dc4bb30cfa847cc5dd9d549ff","modified":1760512874239},{"_id":"source/_posts/è¿›é˜¶/ç¥å¥‡ï¼Œæ•™ä½ ç”¨éšæœºæ•°æ‰“å°hello world.md","hash":"fe67000495276933450c48a3c350514822e1ae70","modified":1760512874215},{"_id":"source/_posts/è¿›é˜¶/é‡‘èç³»ç»Ÿä¸­æ­£ç¡®çš„é‡‘é¢è®¡ç®—åŠå­˜å‚¨æ–¹å¼.md","hash":"5680db59ebec5cc7a50a58fb1d89bdfda9843f02","modified":1760512874292},{"_id":"source/_posts/è¿›é˜¶/é¢è¯•é—®æˆ‘ Java é€ƒé€¸åˆ†æï¼Œç¬é—´è¢«ç§’æ€äº†ã€‚.md","hash":"2831bda6be4e7eb0de38707cfe8c035db2ed26c1","modified":1760512874211},{"_id":"source/_posts/å¤šçº¿ç¨‹/Javaå¤šçº¿ç¨‹joinä½¿ç”¨åŠåŸç†.md","hash":"18bf8f28448865853f50bc503b91ffc0348e934a","modified":1760512825057},{"_id":"source/_posts/å¤šçº¿ç¨‹/Javaè™šæ‹Ÿæœºå¯¹é”ä¼˜åŒ–æ‰€åšçš„åŠªåŠ›.md","hash":"6d65d23e3a8df93de9f2b12b7bd20021bcd7f83b","modified":1760512825052},{"_id":"source/_posts/å¤šçº¿ç¨‹/Synchronized æœ‰å‡ ç§ç”¨æ³•ï¼Ÿ.md","hash":"03c73fdb4c38fcfe61a7c04da3ef3c944df54f41","modified":1760512824976},{"_id":"source/_posts/å¤šçº¿ç¨‹/Javaå¤šçº¿ç¨‹å¯ä»¥åˆ†ç»„è¿˜èƒ½è¿™æ ·ç©.md","hash":"0944de993d5660358fbafc3a9156813a61c9a0f9","modified":1760512824996},{"_id":"source/_posts/å¤šçº¿ç¨‹/Synchronized ä¸ ReentrantLock çš„åŒºåˆ«ï¼.md","hash":"43841b8200d264d20de8a5f0575759bd20317cf0","modified":1760512825073},{"_id":"source/_posts/å¤šçº¿ç¨‹/i++æ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ.md","hash":"4f95f41ab81d054d259d9a886da3796d4e006083","modified":1760512825069},{"_id":"source/_posts/å¤šçº¿ç¨‹/ä¸€æ–‡ææ‡‚ Java çº¿ç¨‹ä¸­æ–­.md","hash":"5cc472936d029b1b204cc5dee6c524cfbb607b92","modified":1760512825065},{"_id":"source/_posts/å¤šçº¿ç¨‹/sleep( )å’Œwait( )çš„è¿™5ä¸ªåŒºåˆ«ï¼Œä½ çŸ¥é“å‡ ä¸ªï¼Ÿ.md","hash":"87506f6c1ebc70a0db94a78d7780f9b47be1c19b","modified":1760512825001},{"_id":"source/_posts/å¤šçº¿ç¨‹/å‡ºåœºç‡æ¯”è¾ƒé«˜çš„ä¸€é“å¤šçº¿ç¨‹å®‰å…¨é¢è¯•é¢˜.md","hash":"3a927a0092698bd459892195cfb695915552e77a","modified":1760512825061},{"_id":"source/_posts/å¤šçº¿ç¨‹/åˆ°åº•ä»€ä¹ˆæ˜¯é‡å…¥é”ï¼Œæ‹œæ‰˜ï¼Œä¸€æ¬¡ææ¸…æ¥šï¼.md","hash":"4eb30b656081d9787319c3b7fbf38f0bd023e7a2","modified":1760512825077},{"_id":"source/_posts/å¤šçº¿ç¨‹/å¤šçº¿ç¨‹ Thread.yield æ–¹æ³•åˆ°åº•æœ‰ä»€ä¹ˆç”¨ï¼Ÿ.md","hash":"1eeb3c6b51527b691f2e4fcc92425ffe03179427","modified":1760512825018},{"_id":"source/_posts/å¤šçº¿ç¨‹/å¤šçº¿ç¨‹ start å’Œ run æ–¹æ³•åˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ.md","hash":"9239aff69b4dd4a11c69e529d205d70f1bccf95e","modified":1760512824991},{"_id":"source/_posts/å¤šçº¿ç¨‹/å¹¶è¡Œä»»åŠ¡æ‰§è¡Œç¥å™¨ Fork & Join å®æˆ˜.md","hash":"37d029afda70a28476156f9a92a2420f4ecea764","modified":1760512824981},{"_id":"source/_posts/å¤šçº¿ç¨‹/å¤šçº¿ç¨‹é€šä¿¡çš„ä¸‰å¤§æ³•å™¨ï¼Œä½ çœŸçš„ä¼šç”¨å—ï¼Ÿ.md","hash":"1d74eae8091143169d5120d60fcecd305d1f6ebe","modified":1760512825005},{"_id":"source/_posts/å¤šçº¿ç¨‹/æ•™ä½ å¦‚ä½•ç›‘æ§ Java çº¿ç¨‹æ± è¿è¡ŒçŠ¶æ€.md","hash":"fb2397aa04bc0ad26b431e0166eeffb48d49a610","modified":1760512824986},{"_id":"source/_posts/å¤šçº¿ç¨‹/çº¿ç¨‹ä¼‘çœ åªä¼šç”¨Thread.sleepï¼Ÿé‚£å°±å¼±çˆ†äº†ï¼.md","hash":"1e7423fdffc3e53d0e1479e52a5e3f2a5542f46d","modified":1760512825009},{"_id":"source/_posts/å¤šçº¿ç¨‹/é¢è¯•å®˜é—®çº¿ç¨‹å®‰å…¨çš„Listï¼Œçœ‹å®Œå†ä¹Ÿä¸æ€•äº†ï¼.md","hash":"4d932a029fc696019bc41953c7f7e6257037902a","modified":1760512825014},{"_id":"source/_posts/åŸºç¡€/10 ä¸ªæ·±æ¶ç—›ç»çš„ Java å¼‚å¸¸.md","hash":"20f11ef0880b6570a2fd2c092fdaaabaa2d9e81e","modified":1760512791879},{"_id":"source/_posts/åŸºç¡€/Java Base64 ç¼–ç è§£ç æ–¹æ¡ˆæ€»ç»“.md","hash":"e3f5e26d19390b3104c04da84cf07864b39e5371","modified":1760512791820},{"_id":"source/_posts/åŸºç¡€/Java JaråŒ…å‹ç¼©ã€è§£å‹ä½¿ç”¨æŒ‡å—.md","hash":"f4a47cdf74a673c433fef301cd377ce541a5b8df","modified":1760512431265},{"_id":"source/_posts/åŸºç¡€/Java ä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹è½¬æ¢è¯¦è§£.md","hash":"db00ae3048a88abb739ad0a2c67086fe510455d7","modified":1760512791795},{"_id":"source/_posts/åŸºç¡€/Java çˆ¶ç±»å¼ºåˆ¶è½¬æ¢å­ç±»åŸåˆ™.md","hash":"b8cbe6f24b9d8aa84dd27b1c2ed00f45592de4e3","modified":1760512791800},{"_id":"source/_posts/åŸºç¡€/StringBuffer å’Œ StringBuilder çš„ 3 ä¸ªåŒºåˆ«.md","hash":"10d718ce9ce8a3bbf336588d5bfbb959eb97291f","modified":1760512791814},{"_id":"source/_posts/åŸºç¡€/switch case æ”¯æŒçš„ 6 ç§æ•°æ®ç±»å‹ï¼.md","hash":"c4454dc7e21bb799e4dd7cac2f5349ce38b01593","modified":1760512791810},{"_id":"source/_posts/åŸºç¡€/switchå¤šå€¼åŒ¹é…éªšæ“ä½œï¼Œå¸¦ä½ æ¶¨å§¿åŠ¿ï¼.md","hash":"8a235c193c7ee2e372d6c6e813765d85e980de64","modified":1760512791833},{"_id":"source/_posts/åŸºç¡€/ä¸€å¼ å›¾ææ¸…æ¥šJavaå¼‚å¸¸æœºåˆ¶.md","hash":"42f947797f22344ee38865406776f23235e1f5d6","modified":1760512791824},{"_id":"source/_posts/åŸºç¡€/ä½ çœŸçš„ææ‡‚ transient  å…³é”®å­—äº†å—ï¼Ÿ.md","hash":"4c4b71435388232a46a77ae6a534e1c4ddec1631","modified":1760512791838},{"_id":"source/_posts/åŸºç¡€/å…³äºJavaåºåˆ—åŒ–ä½ åº”è¯¥çŸ¥é“çš„ä¸€åˆ‡.md","hash":"1af5f6ba1893cdbb8278d970654d4e35953c2c34","modified":1760512791784},{"_id":"source/_posts/åŸºç¡€/å‘çˆ¹çš„ Java å¯å˜å‚æ•°ï¼ŒæŠŠæˆ‘æ•´å¾—å¤Ÿæƒ¨ã€‚.md","hash":"6b529e9faa46f3656be2093550ac88855150b3b3","modified":1760512791805},{"_id":"source/_posts/åŸºç¡€/ä½ çœŸçš„ææ‡‚ transient å…³é”®å­—äº†å—ï¼Ÿ.md","hash":"c02d30c3ff8d5f0ab8b180e9c2e9cc943017e0c0","modified":1760512791829},{"_id":"source/_posts/åŸºç¡€/å…³äº Java åºåˆ—åŒ–ä½ ä¸çŸ¥é“çš„ 5 ä»¶äº‹.md","hash":"c9e705295a342a1d49508bd08c5e491f869f0f3c","modified":1760512791889},{"_id":"source/_posts/åŸºç¡€/å¸¸è§çš„ 3 ç§ Class çº§åˆ«çš„é”™è¯¯.md","hash":"8c4bbf5457e34c2924a8393b99609759227e1ef8","modified":1760512791893},{"_id":"source/_posts/åŸºç¡€/å­—ç¬¦ä¸²æ‹¼æ¥ + å’Œ concat çš„åŒºåˆ«.md","hash":"ca88c7699d99ea07a8cb480a6a3a6819a977dcdf","modified":1760512791789},{"_id":"source/_posts/åŸºç¡€/æ·±å…¥æµ…å‡º Java ä¸­çš„åŒ…è£…ç±».md","hash":"b9863c74bc042e7e76705e20125da2bff7660139","modified":1760512791843},{"_id":"source/_posts/é›†åˆ/HashMap å’Œ Hashtable çš„ 6 ä¸ªåŒºåˆ«.md","hash":"e7dbcc871f27070cafd8016f67a1e315b561c77c","modified":1760512889813},{"_id":"source/_posts/åŸºç¡€/é€šç”¨å”¯ä¸€æ ‡è¯†ç  UUID çš„ä»‹ç»åŠä½¿ç”¨ã€‚.md","hash":"b32abeea8914c6f360bfd440ae2246d91d533a66","modified":1760512791883},{"_id":"source/_posts/é›†åˆ/Hashtable ä¸ºä»€ä¹ˆä¸å« HashTableï¼Ÿ.md","hash":"b80f7eeb16e94527046f01d9b57d946aa9883714","modified":1760512889809},{"_id":"source/_posts/é›†åˆ/Java ä¸­åˆå§‹åŒ– List é›†åˆçš„ 6 ç§æ–¹å¼!.md","hash":"aa24446cbe11c42d64c91ebf3d6809df77d43990","modified":1760512889764},{"_id":"source/_posts/æ–°ç‰¹æ€§/Java10/Java 10 çš„ 10 ä¸ªæ–°ç‰¹æ€§ï¼Œå°†å½»åº•æ”¹å˜ä½ å†™ä»£ç çš„æ–¹å¼.md","hash":"6cb8e6b36f498446756bfc7f5ac9f5dbfd3409fd","modified":1760512851431},{"_id":"source/_posts/æ–°ç‰¹æ€§/Java10/Java 10 å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä»‹ç»åŠå®æˆ˜.md","hash":"e7a5bb6c3dd4954b5f24be80e521ace70595aae3","modified":1760512851453},{"_id":"source/_posts/æ–°ç‰¹æ€§/Java11/Java 11 æ­£å¼å‘å¸ƒï¼Œè¿™ 8 ä¸ªæ–°ç‰¹æ€§æ•™ä½ å†™å‡ºæ›´ç‰›é€¼çš„ä»£ç .md","hash":"0395100751b043397886ff8026c6930ef6a066f3","modified":1760512851502},{"_id":"source/_posts/æ–°ç‰¹æ€§/Java8/Java8 ä¹‹æ–°ç‰¹æ€§æ‰©å±•ç¯‡.md","hash":"693231457018b3e6f51ad1772ea37cd208c15f3a","modified":1760512851461},{"_id":"source/_posts/æ–°ç‰¹æ€§/Java8/Java8 æ–°ç‰¹æ€§ä¹‹Optional.md","hash":"15a42f2883daf2a3c110f8825f8b4be08bdab73c","modified":1760512851398},{"_id":"source/_posts/æ–°ç‰¹æ€§/Java11/Java 11 å·²å‘å¸ƒï¼ŒString è¿˜èƒ½è¿™æ ·ç©.md","hash":"1386022c1bae1fa6fa96e9da117e291c0442ed3a","modified":1760512851427},{"_id":"source/_posts/æ–°ç‰¹æ€§/Java8/Java8 æ–°ç‰¹æ€§ä¹‹Lambdaè¡¨è¾¾å¼.md","hash":"b99c7edfcf71edc239031f861168b8125bb099cf","modified":1760512851510},{"_id":"source/_posts/æ–°ç‰¹æ€§/Java8/Java8 æ–°ç‰¹æ€§ä¹‹å‡½æ•°å¼æ¥å£.md","hash":"c319f7fce08ed01df53880605daaaed1cfdf34fe","modified":1760512851515},{"_id":"source/_posts/æ–°ç‰¹æ€§/Java8/Java8 æ–°ç‰¹æ€§ä¹‹æ–¹æ³•å¼•ç”¨.md","hash":"50d93453d3cc1ed532bcbbbfff7a89bf526b6ed6","modified":1760512851389},{"_id":"source/_posts/æ–°ç‰¹æ€§/Java8/Java8 æ–°ç‰¹æ€§ä¹‹æ¥å£é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•.md","hash":"775ef9f30b1bf7841b725a4eb77b42968d7aa0c5","modified":1760512851412},{"_id":"source/_posts/æ–°ç‰¹æ€§/Java8/Java8 æ–°ç‰¹æ€§ä¹‹é‡å¤æ³¨è§£.md","hash":"28eb2cd94555089d0f6c7643fdb339a2d9a6d62a","modified":1760512851456},{"_id":"source/_posts/æ–°ç‰¹æ€§/Java12/Java 12 éªšæ“ä½œï¼Œ Stringå±…ç„¶è¿˜èƒ½è¿™æ ·ç©.md","hash":"58731b4ad1ff6f85659ffa5d83bdda61c1b1eb89","modified":1760512851435},{"_id":"source/_posts/æ–°ç‰¹æ€§/Java12/Java 12 éªšæ“ä½œï¼Œ æ–‡ä»¶æ¯”å¯¹å±…ç„¶è¿˜èƒ½è¿™æ ·ç©ï¼.md","hash":"f88e6b517cca60e7cbdc57fbe923cfb7dea41ee1","modified":1760512851380},{"_id":"source/_posts/æ–°ç‰¹æ€§/Java12/Java 12 éªšæ“ä½œï¼Œ switchå±…ç„¶è¿˜èƒ½è¿™æ ·ç©ï¼.md","hash":"98333d65adff850ef6dcf5a1f772a1ac780a1318","modified":1760512851408},{"_id":"source/_posts/æ–°ç‰¹æ€§/Java9/Java9 ç®€åŒ–æµå…³é—­æ–°å§¿åŠ¿.md","hash":"012f16ec68b88bd606590b4bd324b4724d0e6cdc","modified":1760512851394},{"_id":"source/_posts/æ–°ç‰¹æ€§/Java8/Stream/Java 8 åˆ›å»º Stream çš„ 10 ç§æ–¹å¼ï¼Œæˆ‘ä¿è¯ä½ å—ç›Šæ— ç©·!.md","hash":"ebc5f123fa9ee90e5d72d71468848044855522fc","modified":1760512851449},{"_id":"source/_posts/æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸ƒï¼‰æµä¸è¿­ä»£å™¨ï¼Œæµç³»åˆ—å¤§ç»“å±€ï¼.md","hash":"1c22f223fd0c609f9027e81b72019ebd25262b36","modified":1760512851465},{"_id":"source/_posts/æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸‰ï¼‰ç¼©å‡æ“ä½œ.md","hash":"0df9f96dcbc7732f081bd70c9f11ebb135fb8cde","modified":1760512851402},{"_id":"source/_posts/æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸€ï¼‰åŸºç¡€ä½“éªŒ.md","hash":"ec16309cedc95b2de0259e35cfbb5eb48cca1a78","modified":1760512851422},{"_id":"source/_posts/æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆäºŒï¼‰å…³é”®çŸ¥è¯†ç‚¹.md","hash":"91f88a4508d6bedd4791f8c1d41ca4cc091c0067","modified":1760512851443},{"_id":"source/_posts/æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆå…­ï¼‰æ”¶é›†.md","hash":"09933a7fa09b619e241e0809d7e21ee72e20c78e","modified":1760512851417},{"_id":"source/_posts/æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆå››ï¼‰å¹¶è¡Œæµ.md","hash":"264512e3ee090131c1175b18ae18a4e213cd3d04","modified":1760512851506},{"_id":"source/_posts/æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆäº”ï¼‰æ˜ å°„.md","hash":"7979bafe3c43e617c1cc7a4a21164d2c7cc6f6ab","modified":1760512851385},{"_id":"source/_posts/æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹Streamæµ.md","hash":"542c169c8525c75c0ad1cfb00eb78df8c9f678f6","modified":1760512851439},{"_id":"source/_posts/é›†åˆ/HashMap, ConcurrentHashMap åŸç†åŠæºç .md","hash":"10618796195da0617d0c8095e4cfacdda56fc10c","modified":1760512889773},{"_id":"themes/heyan/source/logo.png","hash":"763da9c5d814ceced803525677f11337c908de63","modified":1760511437790},{"_id":"public/search.xml","hash":"a01fa7bd02213c6ee4a715582ecaa30e6663b9de","modified":1760583577910},{"_id":"public/index.html","hash":"4d131bccb2d671d0003344f8cbc0853b194ffcac","modified":1760583577910},{"_id":"public/about/index.html","hash":"35831f0fae2a184ece67f2007075c7fe8f50771f","modified":1760583577910},{"_id":"public/2025/10/15/æ–°ç‰¹æ€§/Java 5 ~ 10 æ–°ç‰¹æ€§å€¾æƒ…æ•´ç†ï¼/index.html","hash":"36d078e35c1fb02b819794a8b42f1087bfd4e707","modified":1760583577910},{"_id":"public/categories/index.html","hash":"eefcba446f03e86fd093004258ac48c40e1cf7fe","modified":1760583577910},{"_id":"public/2025/10/15/è¿›é˜¶/Java ä¸­çš„ String çœŸçš„æ˜¯ä¸å¯å˜å—ï¼Ÿ/index.html","hash":"f93820b168c3a80ed07b5f02f92c070906e846e9","modified":1760583577910},{"_id":"public/2025/10/15/è¿›é˜¶/Java ä¸­çš„ 6 é¢—è¯­æ³•ç³–/index.html","hash":"529126da4bc12d503350854a921f284bdfabde68","modified":1760583577910},{"_id":"public/2025/10/15/è¿›é˜¶/Java ä¸­çš„ä¼ªå…±äº«è¯¦è§£åŠè§£å†³æ–¹æ¡ˆ/index.html","hash":"7aea7c0acf1281a6d88d79004c4b9ec3db313c6b","modified":1760583577910},{"_id":"public/2025/10/15/è¿›é˜¶/Java ä¸­çš„å®å˜é‡ï¼Œå®æ›¿æ¢è¯¦è§£ã€‚/index.html","hash":"d2858c83ceb57343adfebf8d9505484a070b210b","modified":1760583577910},{"_id":"public/2025/10/15/è¿›é˜¶/Java ä¸­è·å–ç±»åçš„ä¸‰ç§æ–¹æ³•ï¼Œä½ çŸ¥é“å‡ ç§ï¼Ÿ/index.html","hash":"38780da22887b69c0c8832aad5df40a709dd9477","modified":1760583577910},{"_id":"public/2025/10/15/è¿›é˜¶/Java å¯¹è±¡å¼•ç”¨å››ä¸ªçº§åˆ«ï¼ˆå¼ºã€è½¯ã€å¼±ã€è™šï¼‰/index.html","hash":"bc4560568cdbd40b3f5ef6929b77475990b22224","modified":1760583577910},{"_id":"public/2025/10/15/è¿›é˜¶/Java å¼‚å¸¸å¤„ç† 10 ä¸ªæœ€ä½³å®è·µ/index.html","hash":"a141aa6206c22aa11521152dbed3e5182cc6d9db","modified":1760583577910},{"_id":"public/2025/10/15/è¿›é˜¶/Java ç±»åˆå§‹åŒ–é¡ºåºï¼Œ3ä¸ªç¤ºä¾‹å¸¦ä½ èººå‘ã€‚/index.html","hash":"5a6ab33e587fa28ad27b9109ddda658494adeb66","modified":1760583577910},{"_id":"public/2025/10/15/è¿›é˜¶/Java è‡ªå®šä¹‰ ClassLoader å®æˆ˜/index.html","hash":"32f65104763e8296942a945ea3f82331daada2fc","modified":1760583577910},{"_id":"public/2025/10/15/è¿›é˜¶/hashCode å’Œ identityHashCode çš„åŒºåˆ«ä½ çŸ¥é“å—ï¼Ÿ/index.html","hash":"9b8af8d8e10fb1d5771fd1cf72bd5f8fb891a2c7","modified":1760583577910},{"_id":"public/2025/10/15/è¿›é˜¶/ä¸èƒ½ç”¨ + æ‹¼æ¥å­—ç¬¦ä¸²ï¼Ÿ è¿™æ¬¡æˆ‘è¦åŠæ‰“é¢è¯•å®˜ï¼/index.html","hash":"819ff8836f8e66adb5900e1a77a187d4873549e1","modified":1760583577910},{"_id":"public/2025/10/15/è¿›é˜¶/åˆ«å†å†™ bug äº†ï¼Œé¿å…ç©ºæŒ‡é’ˆçš„ 5 ä¸ªæ¡ˆä¾‹ï¼/index.html","hash":"c163b14d3f159bfa2b3e8893cfda8695d4b219f2","modified":1760583577910},{"_id":"public/2025/10/15/è¿›é˜¶/ç¥å¥‡ï¼Œæ•™ä½ ç”¨éšæœºæ•°æ‰“å°hello world/index.html","hash":"06a4238557045d004c6d2382f7f1473fbe3d2dcc","modified":1760583577910},{"_id":"public/2025/10/15/è¿›é˜¶/å­—ç¬¦ä¸² substring æ–¹æ³•åœ¨ JDK 6,7,8 ä¸­çš„å·®å¼‚ã€‚/index.html","hash":"5d852d211ca9e7f95befe7240409186501a397ae","modified":1760583577910},{"_id":"public/2025/10/15/è¿›é˜¶/é‡‘èç³»ç»Ÿä¸­æ­£ç¡®çš„é‡‘é¢è®¡ç®—åŠå­˜å‚¨æ–¹å¼/index.html","hash":"5ee121978aa1a5639059074e234c5007f6290e3f","modified":1760583577910},{"_id":"public/2025/10/15/è¿›é˜¶/é¢è¯•é—®æˆ‘ Java é€ƒé€¸åˆ†æï¼Œç¬é—´è¢«ç§’æ€äº†ã€‚/index.html","hash":"4295e719d1d2e7a66fd4713752745e3ff94d9fe6","modified":1760583577910},{"_id":"public/2025/10/15/é›†åˆ/HashMap å’Œ Hashtable çš„ 6 ä¸ªåŒºåˆ«/index.html","hash":"41ecd1425fa0684fc1b42dc69eeec5123b1ede47","modified":1760583577910},{"_id":"public/2025/10/15/é›†åˆ/Hashtable ä¸ºä»€ä¹ˆä¸å« HashTableï¼Ÿ/index.html","hash":"a34813c9049712912668ee33822884600d0c7a77","modified":1760583577910},{"_id":"public/2025/10/15/é›†åˆ/Java ä¸­åˆå§‹åŒ– List é›†åˆçš„ 6 ç§æ–¹å¼!/index.html","hash":"19a2b2080ed24d22bf01a99e5e7dabf1c471a6cc","modified":1760583577910},{"_id":"public/2025/10/15/é›†åˆ/HashMap, ConcurrentHashMap åŸç†åŠæºç /index.html","hash":"8ce98bf57683bdc04010634fa8232e86723e4d55","modified":1760583577910},{"_id":"public/2025/10/15/æ–°ç‰¹æ€§/Java10/Java 10 çš„ 10 ä¸ªæ–°ç‰¹æ€§ï¼Œå°†å½»åº•æ”¹å˜ä½ å†™ä»£ç çš„æ–¹å¼/index.html","hash":"d0d4e9d48406e09c5b7ef2a42f06905ee5b059c4","modified":1760583577910},{"_id":"public/2025/10/15/æ–°ç‰¹æ€§/Java10/Java 10 å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä»‹ç»åŠå®æˆ˜/index.html","hash":"b2092e996abc3065ca6089bf19fda9a4cd5677ee","modified":1760583577910},{"_id":"public/2025/10/15/æ–°ç‰¹æ€§/Java11/Java 11 æ­£å¼å‘å¸ƒï¼Œè¿™ 8 ä¸ªæ–°ç‰¹æ€§æ•™ä½ å†™å‡ºæ›´ç‰›é€¼çš„ä»£ç /index.html","hash":"e65af4ae602544b2d252dcbadda187dd15750561","modified":1760583577910},{"_id":"public/2025/10/15/æ–°ç‰¹æ€§/Java8/Java8 ä¹‹æ–°ç‰¹æ€§æ‰©å±•ç¯‡/index.html","hash":"8be45510b8d89e72d29bdc8446b992a61a6a157b","modified":1760583577910},{"_id":"public/2025/10/15/æ–°ç‰¹æ€§/Java11/Java 11 å·²å‘å¸ƒï¼ŒString è¿˜èƒ½è¿™æ ·ç©/index.html","hash":"28a5feed536e4bb0a534f4794932adbc417e7a38","modified":1760583577910},{"_id":"public/2025/10/15/æ–°ç‰¹æ€§/Java8/Java8 æ–°ç‰¹æ€§ä¹‹Lambdaè¡¨è¾¾å¼/index.html","hash":"e6f1007b571451caac7efdafba0d4876d01e8c89","modified":1760583577910},{"_id":"public/2025/10/15/æ–°ç‰¹æ€§/Java8/Java8 æ–°ç‰¹æ€§ä¹‹Optional/index.html","hash":"9f0c4d837b686d9b88c4f46d431ccf72cb5f6c85","modified":1760583577910},{"_id":"public/2025/10/15/æ–°ç‰¹æ€§/Java8/Java8 æ–°ç‰¹æ€§ä¹‹å‡½æ•°å¼æ¥å£/index.html","hash":"a77b695fbe24032cbcbf42f20c2adeb6f49ab817","modified":1760583577910},{"_id":"public/2025/10/15/æ–°ç‰¹æ€§/Java8/Java8 æ–°ç‰¹æ€§ä¹‹æ¥å£é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•/index.html","hash":"dda77ebea50be1d1ab7c5176d352e0b85b192bca","modified":1760583577910},{"_id":"public/2025/10/15/æ–°ç‰¹æ€§/Java8/Java8 æ–°ç‰¹æ€§ä¹‹æ–¹æ³•å¼•ç”¨/index.html","hash":"c2cc601adb1eae1d7f2762d2b9f7920a6b84aae5","modified":1760583577910},{"_id":"public/2025/10/15/æ–°ç‰¹æ€§/Java8/Java8 æ–°ç‰¹æ€§ä¹‹é‡å¤æ³¨è§£/index.html","hash":"57cfd3a6673e749ed657bcbeca66211705453ef6","modified":1760583577910},{"_id":"public/2025/10/15/æ–°ç‰¹æ€§/Java12/Java 12 éªšæ“ä½œï¼Œ Stringå±…ç„¶è¿˜èƒ½è¿™æ ·ç©/index.html","hash":"d58b23b6a40e596b6027e8d61127db90feebec95","modified":1760583577910},{"_id":"public/2025/10/15/æ–°ç‰¹æ€§/Java12/Java 12 éªšæ“ä½œï¼Œ switchå±…ç„¶è¿˜èƒ½è¿™æ ·ç©ï¼/index.html","hash":"0654624d7be7409f42325e9619886f2fdbcd3c6f","modified":1760583577910},{"_id":"public/2025/10/15/æ–°ç‰¹æ€§/Java12/Java 12 éªšæ“ä½œï¼Œ æ–‡ä»¶æ¯”å¯¹å±…ç„¶è¿˜èƒ½è¿™æ ·ç©ï¼/index.html","hash":"62fec2b01ccb359d25a8884404d878f810b768f0","modified":1760583577910},{"_id":"public/2025/10/15/æ–°ç‰¹æ€§/Java9/Java9 ç®€åŒ–æµå…³é—­æ–°å§¿åŠ¿/index.html","hash":"e17f82b327b44e24d10a0d50c140d4b6f3752680","modified":1760583577910},{"_id":"public/2025/10/15/æ–°ç‰¹æ€§/Java8/Stream/Java 8 åˆ›å»º Stream çš„ 10 ç§æ–¹å¼ï¼Œæˆ‘ä¿è¯ä½ å—ç›Šæ— ç©·!/index.html","hash":"05fdbd5d0068105583f6ccb48b32d02c09f1535c","modified":1760583577910},{"_id":"public/2025/10/15/æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸€ï¼‰åŸºç¡€ä½“éªŒ/index.html","hash":"f775fb187a603abdfaccb0720fd6898ce2277729","modified":1760583577910},{"_id":"public/2025/10/15/æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸ƒï¼‰æµä¸è¿­ä»£å™¨ï¼Œæµç³»åˆ—å¤§ç»“å±€ï¼/index.html","hash":"51e9e966eaa303fbc8e2da4ebd10e6ed75a633c2","modified":1760583577910},{"_id":"public/2025/10/15/æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸‰ï¼‰ç¼©å‡æ“ä½œ/index.html","hash":"9dae917cf0041ecb4197f00471c4818e9dfb993e","modified":1760583577910},{"_id":"public/2025/10/15/æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆäºŒï¼‰å…³é”®çŸ¥è¯†ç‚¹/index.html","hash":"b44676b78e92310e5e412b7b6fdf9ce101eba746","modified":1760583577910},{"_id":"public/2025/10/15/æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆå…­ï¼‰æ”¶é›†/index.html","hash":"38edd7a8ed242926801b90738075fc22e98c6dd7","modified":1760583577910},{"_id":"public/2025/10/15/æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆäº”ï¼‰æ˜ å°„/index.html","hash":"ccd62dc7a30a5eb9cea62d9d29bbf64fda85708e","modified":1760583577910},{"_id":"public/2025/10/15/æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆå››ï¼‰å¹¶è¡Œæµ/index.html","hash":"478c663cd71feefe441626753e259c78695de48d","modified":1760583577910},{"_id":"public/2025/10/15/æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹Streamæµ/index.html","hash":"e0981f760d742c7a6bdaf0d91e141e6a60960746","modified":1760583577910},{"_id":"public/2025/10/14/å¤šçº¿ç¨‹/Synchronized ä¸ ReentrantLock çš„åŒºåˆ«ï¼/index.html","hash":"69884f08d693f8bd75df3b17267d8239277238bc","modified":1760583577910},{"_id":"public/2025/10/14/å¤šçº¿ç¨‹/Javaè™šæ‹Ÿæœºå¯¹é”ä¼˜åŒ–æ‰€åšçš„åŠªåŠ›/index.html","hash":"ea7cdbf35dc55b0635fb8ee5587d5553da91f3dd","modified":1760583577910},{"_id":"public/2025/10/14/å¤šçº¿ç¨‹/Synchronized æœ‰å‡ ç§ç”¨æ³•ï¼Ÿ/index.html","hash":"32921c5409789ee87102dcab223c6a2bb4f06b60","modified":1760583577910},{"_id":"public/2025/10/14/å¤šçº¿ç¨‹/sleep( )å’Œwait( )çš„è¿™5ä¸ªåŒºåˆ«ï¼Œä½ çŸ¥é“å‡ ä¸ªï¼Ÿ/index.html","hash":"1ed1b104f564f7455e84cf8a560348feec5cfdbf","modified":1760583577910},{"_id":"public/2025/10/14/å¤šçº¿ç¨‹/ä¸€æ–‡ææ‡‚ Java çº¿ç¨‹ä¸­æ–­/index.html","hash":"8d558936367ae2eee229d21039499a1a382a7726","modified":1760583577910},{"_id":"public/2025/10/14/å¤šçº¿ç¨‹/å‡ºåœºç‡æ¯”è¾ƒé«˜çš„ä¸€é“å¤šçº¿ç¨‹å®‰å…¨é¢è¯•é¢˜/index.html","hash":"718997f936840a098a4159e64953b68b71837145","modified":1760583577910},{"_id":"public/2025/10/14/å¤šçº¿ç¨‹/åˆ°åº•ä»€ä¹ˆæ˜¯é‡å…¥é”ï¼Œæ‹œæ‰˜ï¼Œä¸€æ¬¡ææ¸…æ¥šï¼/index.html","hash":"f5637ff904a6f87c25f1eaea45ebca978a12adee","modified":1760583577910},{"_id":"public/2025/10/14/å¤šçº¿ç¨‹/å¤šçº¿ç¨‹ Thread.yield æ–¹æ³•åˆ°åº•æœ‰ä»€ä¹ˆç”¨ï¼Ÿ/index.html","hash":"baeda373ae2728da1189bd4e55558b1d7e5ae576","modified":1760583577910},{"_id":"public/2025/10/14/å¤šçº¿ç¨‹/å¤šçº¿ç¨‹é€šä¿¡çš„ä¸‰å¤§æ³•å™¨ï¼Œä½ çœŸçš„ä¼šç”¨å—ï¼Ÿ/index.html","hash":"093c82ab424e634aaba268561271c922749b9f67","modified":1760583577910},{"_id":"public/2025/10/14/å¤šçº¿ç¨‹/å¤šçº¿ç¨‹ start å’Œ run æ–¹æ³•åˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ/index.html","hash":"3502d52376b006743121f4594c9c1446121fdaf3","modified":1760583577910},{"_id":"public/2025/10/14/å¤šçº¿ç¨‹/å¹¶è¡Œä»»åŠ¡æ‰§è¡Œç¥å™¨ Fork & Join å®æˆ˜/index.html","hash":"8a7338d0e8c79478f312924821db1524a8a76eb7","modified":1760583577910},{"_id":"public/2025/10/14/å¤šçº¿ç¨‹/æ•™ä½ å¦‚ä½•ç›‘æ§ Java çº¿ç¨‹æ± è¿è¡ŒçŠ¶æ€/index.html","hash":"ef9a0082f1fb3dd9c267f147f8527a3630eacfe2","modified":1760583577910},{"_id":"public/2025/10/14/å¤šçº¿ç¨‹/çº¿ç¨‹ä¼‘çœ åªä¼šç”¨Thread.sleepï¼Ÿé‚£å°±å¼±çˆ†äº†ï¼/index.html","hash":"a9e126c768a2b8ea107b0a655d4e0a48d93832f9","modified":1760583577910},{"_id":"public/2025/10/14/å¤šçº¿ç¨‹/é¢è¯•å®˜é—®çº¿ç¨‹å®‰å…¨çš„Listï¼Œçœ‹å®Œå†ä¹Ÿä¸æ€•äº†ï¼/index.html","hash":"1d17479b86729e90be5a5ca3cc271b5da9ea8838","modified":1760583577910},{"_id":"public/2025/10/14/åŸºç¡€/10 ä¸ªæ·±æ¶ç—›ç»çš„ Java å¼‚å¸¸/index.html","hash":"cf1c8a9071c41a675eea5d90502f29a83b0cdc86","modified":1760583577910},{"_id":"public/2025/10/14/åŸºç¡€/Java Base64 ç¼–ç è§£ç æ–¹æ¡ˆæ€»ç»“/index.html","hash":"a9e3c20f293d481b19282b6da1aa8234038b2f27","modified":1760583577910},{"_id":"public/2025/10/14/åŸºç¡€/Java ä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹è½¬æ¢è¯¦è§£/index.html","hash":"d80fbfed603481e203a46ce023574b43597124ae","modified":1760583577910},{"_id":"public/2025/10/14/åŸºç¡€/Java çˆ¶ç±»å¼ºåˆ¶è½¬æ¢å­ç±»åŸåˆ™/index.html","hash":"fb5da382a90446d8c1bc80ac8c5a3f1e96467371","modified":1760583577910},{"_id":"public/2025/10/14/åŸºç¡€/Java JaråŒ…å‹ç¼©ã€è§£å‹ä½¿ç”¨æŒ‡å—/index.html","hash":"04f644feb3ef451833aea8e9f42c253f9cebfdda","modified":1760583577910},{"_id":"public/2025/10/14/åŸºç¡€/StringBuffer å’Œ StringBuilder çš„ 3 ä¸ªåŒºåˆ«/index.html","hash":"9cccaaff1adfce111b8f4ad22ae44cf82816d598","modified":1760583577910},{"_id":"public/2025/10/14/åŸºç¡€/switch case æ”¯æŒçš„ 6 ç§æ•°æ®ç±»å‹ï¼/index.html","hash":"1c959ec6131634cc77ae13e9357afdc58af36672","modified":1760583577910},{"_id":"public/2025/10/14/åŸºç¡€/switchå¤šå€¼åŒ¹é…éªšæ“ä½œï¼Œå¸¦ä½ æ¶¨å§¿åŠ¿ï¼/index.html","hash":"8b65c5ad2a9fc795c1c39fecd6ae19cddd69f7e3","modified":1760583577910},{"_id":"public/2025/10/14/åŸºç¡€/ä¸€å¼ å›¾ææ¸…æ¥šJavaå¼‚å¸¸æœºåˆ¶/index.html","hash":"5ce83b720d180adf0c2a44b639968d250534d1eb","modified":1760583577910},{"_id":"public/2025/10/14/åŸºç¡€/ä½ çœŸçš„ææ‡‚ transient  å…³é”®å­—äº†å—ï¼Ÿ/index.html","hash":"c5c211786b90c05bf17130a474b74f1668cf33b5","modified":1760583577910},{"_id":"public/2025/10/14/åŸºç¡€/ä½ çœŸçš„ææ‡‚ transient å…³é”®å­—äº†å—ï¼Ÿ/index.html","hash":"c1d65bdc829b565a9516d9f1ae4f635d137a2caf","modified":1760583577910},{"_id":"public/2025/10/14/åŸºç¡€/å…³äº Java åºåˆ—åŒ–ä½ ä¸çŸ¥é“çš„ 5 ä»¶äº‹/index.html","hash":"9fbd48af407d130123cb8f376dbc6ec1ce905fd7","modified":1760583577910},{"_id":"public/2025/10/14/åŸºç¡€/å…³äºJavaåºåˆ—åŒ–ä½ åº”è¯¥çŸ¥é“çš„ä¸€åˆ‡/index.html","hash":"7e9d46f4a9ae9dcd40280d5191d8ca64e4f318ef","modified":1760583577910},{"_id":"public/2025/10/14/åŸºç¡€/å‘çˆ¹çš„ Java å¯å˜å‚æ•°ï¼ŒæŠŠæˆ‘æ•´å¾—å¤Ÿæƒ¨ã€‚/index.html","hash":"a17f1fcb1224c900670d7e38a9982deadc137474","modified":1760583577910},{"_id":"public/2025/10/14/åŸºç¡€/å¸¸è§çš„ 3 ç§ Class çº§åˆ«çš„é”™è¯¯/index.html","hash":"7798c86167b934b957f2c69afdbd92b84292d8c0","modified":1760583577910},{"_id":"public/2025/10/14/åŸºç¡€/å­—ç¬¦ä¸²æ‹¼æ¥ + å’Œ concat çš„åŒºåˆ«/index.html","hash":"84fee0ed956bcde90d7e58ab8f9eaa21d8cc4321","modified":1760583577910},{"_id":"public/2025/10/14/åŸºç¡€/æ·±å…¥æµ…å‡º Java ä¸­çš„åŒ…è£…ç±»/index.html","hash":"f1f607a81d3cee5047818537f69a9f4f2d13b8c1","modified":1760583577910},{"_id":"public/2025/10/14/åŸºç¡€/é€šç”¨å”¯ä¸€æ ‡è¯†ç  UUID çš„ä»‹ç»åŠä½¿ç”¨ã€‚/index.html","hash":"559e1ac9cb073cf812ab6682e2214fa5a821df0e","modified":1760583577910},{"_id":"public/2025/10/14/å¤šçº¿ç¨‹/Javaå¤šçº¿ç¨‹å¯ä»¥åˆ†ç»„è¿˜èƒ½è¿™æ ·ç©/index.html","hash":"96f9f9b20de821598efda9cdbc62045a067eba0f","modified":1760583577910},{"_id":"public/2025/10/14/å¤šçº¿ç¨‹/Javaå¤šçº¿ç¨‹joinä½¿ç”¨åŠåŸç†/index.html","hash":"a725c65924523441c09723b3a6f8966327067154","modified":1760583577910},{"_id":"public/2025/10/14/å¤šçº¿ç¨‹/i++æ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ/index.html","hash":"4c5f798f23316163932b548d37192459942e8f3d","modified":1760583577910},{"_id":"public/2025/09/14/JVM/JVMè¿è¡Œæ—¶åŒºåŸŸè¯¦è§£/index.html","hash":"f4554265b09dba3103cd601c684cc8290ab09d3e","modified":1760583577910},{"_id":"public/archives/index.html","hash":"e3fe7ae908da9a8293a0c365c480b5342c0c74e7","modified":1760583577910},{"_id":"public/2024/12/15/hello-world/index.html","hash":"1b9849f6ae45373ba3c38aca554ac2f83308468a","modified":1760583577910},{"_id":"public/categories/æ•™ç¨‹/index.html","hash":"a6711622a8b105a2ece0e7e385c08a31ff673904","modified":1760583577910},{"_id":"public/categories/åç«¯/index.html","hash":"aafdac1ff42155dc8cd2ffcb9cbf7fe6c2362f3b","modified":1760583577910},{"_id":"public/categories/åç«¯/page/3/index.html","hash":"6bb9f27efe730e760c265eb18e1c2c24d857b11b","modified":1760583577910},{"_id":"public/categories/åç«¯/page/2/index.html","hash":"5635fae5fcd435fc41c9c5f01a015a5fedd9c5a6","modified":1760583577910},{"_id":"public/categories/åç«¯/page/4/index.html","hash":"8571a63ed9c4f0e0010557f9805a562b7872b453","modified":1760583577910},{"_id":"public/categories/åç«¯/page/5/index.html","hash":"54f11c6c3314a9e480c5a9f52df457ca5f048a7a","modified":1760583577910},{"_id":"public/categories/åç«¯/page/6/index.html","hash":"b4e64d0285b32cc2aabedc68ac75af8d1893b2a6","modified":1760583577910},{"_id":"public/categories/åç«¯/page/7/index.html","hash":"4fd1f3f6bae1a430bfd86a475025a30c193ca3df","modified":1760583577910},{"_id":"public/categories/åç«¯/page/8/index.html","hash":"11e96140c87b368ebdb182ea294ee0fe130f8a47","modified":1760583577910},{"_id":"public/categories/åç«¯/page/9/index.html","hash":"19b5d04783dbf02666eb644676f09bfc600bae30","modified":1760583577910},{"_id":"public/tags/JVM/index.html","hash":"5baea4e8f796f0fe2645826ca055681286b34ace","modified":1760583577910},{"_id":"public/tags/æ–‡ç« /index.html","hash":"667542e4bd7c9ca89b502b2a327a29d4fba19492","modified":1760583577910},{"_id":"public/tags/æ–°ç‰¹æ€§/index.html","hash":"4df143385b71906ed1522c73edd00c6beb9fffd0","modified":1760583577910},{"_id":"public/tags/æ–°ç‰¹æ€§/page/2/index.html","hash":"401c91cd5327206621ffc3edd5fceecec23f48ba","modified":1760583577910},{"_id":"public/tags/æ–°ç‰¹æ€§/page/3/index.html","hash":"55c0aa48843444e50719691d284d212dd37b40d3","modified":1760583577910},{"_id":"public/tags/è¿›é˜¶/index.html","hash":"ea19ff7f21e03cce329b9271b25d799c31ecb877","modified":1760583577910},{"_id":"public/tags/è¿›é˜¶/page/2/index.html","hash":"e4af40abdc7281f28a1338ce0997d77cf6828d30","modified":1760583577910},{"_id":"public/tags/å¤šçº¿ç¨‹/index.html","hash":"f90be5ba3182a368320aa4ea338905e3d44206b3","modified":1760583577910},{"_id":"public/tags/å¤šçº¿ç¨‹/page/2/index.html","hash":"dd3986bd2ed37a0a2589b275aafeaac956328f53","modified":1760583577910},{"_id":"public/tags/åŸºç¡€/index.html","hash":"2ea9a35633d33a3980bb05028f39d02636f57174","modified":1760583577910},{"_id":"public/tags/åŸºç¡€/page/2/index.html","hash":"56d244073e35904d2d544d8ec1785fb714212aa1","modified":1760583577910},{"_id":"public/tags/é›†åˆ/index.html","hash":"bb9d4658d68a0e7c5d835338c767030ba8c40987","modified":1760583577910},{"_id":"public/page/2/index.html","hash":"27eb60ddf649a4e253beb9886e41e4964abf68e0","modified":1760583577910},{"_id":"public/page/5/index.html","hash":"8dd591675de3070105d23c4c9e4ad8682b589526","modified":1760583577910},{"_id":"public/page/4/index.html","hash":"4780f80ab695e58ed8d40bbce140afa41c01f89c","modified":1760583577910},{"_id":"public/page/7/index.html","hash":"b76bb175893ecaf06d083bc08ac7d6ce5ab371fc","modified":1760583577910},{"_id":"public/page/6/index.html","hash":"22d57eb32ead0b00b8b16487fd99bc168369dadc","modified":1760583577910},{"_id":"public/page/3/index.html","hash":"67d3ef4203be03be4e3a6c6113663270f45c6129","modified":1760583577910},{"_id":"public/page/8/index.html","hash":"491b303dafe9d1b3497fd51e1d2870729177b453","modified":1760583577910},{"_id":"public/page/9/index.html","hash":"8f0629831e1b7afe2bcd841f0b84bc93a22d1239","modified":1760583577910},{"_id":"public/police.png","hash":"7ec67ebc6cf0b3c79ec5cdd35b8c48f2fef2d80e","modified":1760583577910},{"_id":"public/logo - å‰¯æœ¬.png","hash":"ce91374e148e3391f8f3235b672fa32cd3746d7c","modified":1760583577910},{"_id":"public/favicon/about.txt","hash":"0d732aeb0fbae1e3a711c98a0ad4e04cc079f5e6","modified":1760583577910},{"_id":"public/logo1.png","hash":"ce91374e148e3391f8f3235b672fa32cd3746d7c","modified":1760583577910},{"_id":"public/favicon/apple-touch-icon.png","hash":"662a0af0933fcc0ce3c1cfc12ed07e7ae4306094","modified":1760583577910},{"_id":"public/favicon/favicon-16x16.png","hash":"cb44828efc81002729bbc2396ba85f0e30e63bc4","modified":1760583577910},{"_id":"public/favicon/android-chrome-192x192.png","hash":"ae182103e859a6cf14ea9bc053cf1a4926ea3d21","modified":1760583577910},{"_id":"public/favicon/android-chrome-512x512.png","hash":"ebae4f76f3bb5521ed0655e78a10c235444ad42c","modified":1760583577910},{"_id":"public/favicon/favicon-32x32.png","hash":"763b31f84d7ecf62946eb426692b949d31218b8e","modified":1760583577910},{"_id":"public/favicon/site.webmanifest","hash":"bf31baf91bdd2fcde24a45e3f2a1be33733c6f69","modified":1760583577910},{"_id":"public/favicon/favicon.ico","hash":"27ad4ec726910ba22e33da90ac55a9ac0bfac593","modified":1760583577910},{"_id":"public/css/index.css","hash":"e7c243a4fd04ea6adf8f31f8bbe8366e8ca85987","modified":1760583577910},{"_id":"public/js/fancybox.js","hash":"d638c7b5fc3f87dd44b65c4769dbf97f41834f9f","modified":1760583577910},{"_id":"public/css/markdown.css","hash":"0ac3c0fd374afd4ddac4bfbaf8fefd8baabafa0f","modified":1760583577910},{"_id":"public/css/prism.css","hash":"8f4f3c2c50e06c4c93cea8f65273ba3d69038a36","modified":1760583577910},{"_id":"public/js/search.js","hash":"a6410a3f33b47ee4548d461b6fc6d1785fa36f2b","modified":1760583577910},{"_id":"public/js/prism.js","hash":"b8aad0b4b24ebc2907a60af635b22b4c459541b9","modified":1760583577910},{"_id":"public/logo.png","hash":"763da9c5d814ceced803525677f11337c908de63","modified":1760583577910}],"Category":[{"name":"æ•™ç¨‹","_id":"cmgsu07690004qkd484knc1h0"},{"name":"åç«¯","_id":"cmgsu076c000aqkd4csl5d6aa"}],"Data":[{"_id":"styles","data":"#page-header.full_page {\n  height: 60vh !important;\n  background-attachment: fixed;\n}\n#page-header.full_page #site-title {\n  font-size: 3.5rem;\n  font-weight: bold;\n  text-shadow: 2px 2px 4px rgba(0,0,0,0.5);\n}\n#page-header.full_page #site-subtitle {\n  font-size: 1.5rem;\n  margin-top: 1rem;\n}\n.recent-post-item {\n  border-radius: 12px;\n  box-shadow: 0 4px 8px rgba(0,0,0,0.1);\n  transition: all 0.3s ease;\n}\n.recent-post-item:hover {\n  transform: translateY(-5px);\n  box-shadow: 0 8px 16px rgba(0,0,0,0.15);\n}\n#aside-content .card-widget {\n  border-radius: 12px;\n  box-shadow: 0 2px 6px rgba(0,0,0,0.1);\n}\n@media screen and (max-width: 768px) {\n  #page-header.full_page {\n    height: 40vh !important;\n  }\n  #page-header.full_page #site-title {\n    font-size: 2.5rem;\n  }\n  #page-header.full_page #site-subtitle {\n    font-size: 1.2rem;\n  }\n}\n"}],"Page":[{"title":"é¦–é¡µ","date":"2022-12-31T16:00:00.000Z","layout":"custom-home","_content":"\n## ğŸ¯ æœ€æ–°æ–‡ç« \n\n<%- list_posts({ limit: 5, order: -1 }) %>\n\n## ğŸ“š çƒ­é—¨åˆ†ç±»\n\n<%- list_categories({\nshow_count: true,\nlimit: 8,\norder: -1,\nstyle: 'list'\n}) %>\n\n## ğŸ”– çƒ­é—¨æ ‡ç­¾\n\n<%- list_tags({\nshow_count: true,\nlimit: 15,\norder: -1,\nstyle: 'list'\n}) %>","source":"index.md","raw":"---\ntitle: é¦–é¡µ\ndate: 2023-01-01 00:00:00\nlayout: custom-home\n---\n\n## ğŸ¯ æœ€æ–°æ–‡ç« \n\n<%- list_posts({ limit: 5, order: -1 }) %>\n\n## ğŸ“š çƒ­é—¨åˆ†ç±»\n\n<%- list_categories({\nshow_count: true,\nlimit: 8,\norder: -1,\nstyle: 'list'\n}) %>\n\n## ğŸ”– çƒ­é—¨æ ‡ç­¾\n\n<%- list_tags({\nshow_count: true,\nlimit: 15,\norder: -1,\nstyle: 'list'\n}) %>","updated":"2025-10-15T10:06:33.232Z","path":"index.html","comments":1,"_id":"cmgsu07630000qkd47ltudnes","content":"<h2 id=\"ğŸ¯-æœ€æ–°æ–‡ç« \"><a href=\"#ğŸ¯-æœ€æ–°æ–‡ç« \" class=\"headerlink\" title=\"ğŸ¯ æœ€æ–°æ–‡ç« \"></a>ğŸ¯ æœ€æ–°æ–‡ç« </h2><p>&lt;%- list_posts({ limit: 5, order: -1 }) %&gt;</p>\n<h2 id=\"ğŸ“š-çƒ­é—¨åˆ†ç±»\"><a href=\"#ğŸ“š-çƒ­é—¨åˆ†ç±»\" class=\"headerlink\" title=\"ğŸ“š çƒ­é—¨åˆ†ç±»\"></a>ğŸ“š çƒ­é—¨åˆ†ç±»</h2><p>&lt;%- list_categories({<br>show_count: true,<br>limit: 8,<br>order: -1,<br>style: â€˜listâ€™<br>}) %&gt;</p>\n<h2 id=\"ğŸ”–-çƒ­é—¨æ ‡ç­¾\"><a href=\"#ğŸ”–-çƒ­é—¨æ ‡ç­¾\" class=\"headerlink\" title=\"ğŸ”– çƒ­é—¨æ ‡ç­¾\"></a>ğŸ”– çƒ­é—¨æ ‡ç­¾</h2><p>&lt;%- list_tags({<br>show_count: true,<br>limit: 15,<br>order: -1,<br>style: â€˜listâ€™<br>}) %&gt;</p>\n","excerpt":"","more":"<h2 id=\"ğŸ¯-æœ€æ–°æ–‡ç« \"><a href=\"#ğŸ¯-æœ€æ–°æ–‡ç« \" class=\"headerlink\" title=\"ğŸ¯ æœ€æ–°æ–‡ç« \"></a>ğŸ¯ æœ€æ–°æ–‡ç« </h2><p>&lt;%- list_posts({ limit: 5, order: -1 }) %&gt;</p>\n<h2 id=\"ğŸ“š-çƒ­é—¨åˆ†ç±»\"><a href=\"#ğŸ“š-çƒ­é—¨åˆ†ç±»\" class=\"headerlink\" title=\"ğŸ“š çƒ­é—¨åˆ†ç±»\"></a>ğŸ“š çƒ­é—¨åˆ†ç±»</h2><p>&lt;%- list_categories({<br>show_count: true,<br>limit: 8,<br>order: -1,<br>style: â€˜listâ€™<br>}) %&gt;</p>\n<h2 id=\"ğŸ”–-çƒ­é—¨æ ‡ç­¾\"><a href=\"#ğŸ”–-çƒ­é—¨æ ‡ç­¾\" class=\"headerlink\" title=\"ğŸ”– çƒ­é—¨æ ‡ç­¾\"></a>ğŸ”– çƒ­é—¨æ ‡ç­¾</h2><p>&lt;%- list_tags({<br>show_count: true,<br>limit: 15,<br>order: -1,<br>style: â€˜listâ€™<br>}) %&gt;</p>\n"},{"title":"about","date":"2025-10-15T07:40:10.000Z","_content":"","source":"about/index.md","raw":"---\ntitle: about\ndate: 2025-10-15 15:40:10\n---\n","updated":"2025-10-15T07:40:10.208Z","path":"about/index.html","comments":1,"layout":"page","_id":"cmgsu07680002qkd47j868xxt","content":"","excerpt":"","more":""},{"title":"åˆ†ç±»","date":"2022-12-31T16:00:00.000Z","type":"categories","comments":0,"_content":"","source":"categories/index.md","raw":"---\ntitle: åˆ†ç±»\ndate: 2023-01-01 00:00:00\ntype: \"categories\"\ncomments: false\n---\n","updated":"2025-10-15T08:12:46.510Z","path":"categories/index.html","layout":"page","_id":"cmgsu076a0006qkd432gk4vuk","content":"","excerpt":"","more":""}],"Post":[{"title":"Hello World","date":"2024-12-15T03:36:33.000Z","_content":"Welcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n","source":"_posts/hello-world.md","raw":"---\ntitle: Hello World\ndate: 2024-12-15 11:36:33\ncategory: æ•™ç¨‹\ntags: æ–‡ç« \n---\nWelcome to [Hexo](https://hexo.io/)! This is your very first post. Check [documentation](https://hexo.io/docs/) for more info. If you get any problems when using Hexo, you can find the answer in [troubleshooting](https://hexo.io/docs/troubleshooting.html) or you can ask me on [GitHub](https://github.com/hexojs/hexo/issues).\n\n## Quick Start\n\n### Create a new post\n\n``` bash\n$ hexo new \"My New Post\"\n```\n\nMore info: [Writing](https://hexo.io/docs/writing.html)\n\n### Run server\n\n``` bash\n$ hexo server\n```\n\nMore info: [Server](https://hexo.io/docs/server.html)\n\n### Generate static files\n\n``` bash\n$ hexo generate\n```\n\nMore info: [Generating](https://hexo.io/docs/generating.html)\n\n### Deploy to remote sites\n\n``` bash\n$ hexo deploy\n```\n\nMore info: [Deployment](https://hexo.io/docs/one-command-deployment.html)\n","slug":"hello-world","published":1,"updated":"2025-10-15T08:22:24.471Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu07650001qkd4cw89bbnf","content":"<p>Welcome to <a href=\"https://hexo.io/\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ hexo new <span class=\"token string\">\"My New Post\"</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ hexo server<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>More info: <a href=\"https://hexo.io/docs/server.html\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ hexo generate<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ hexo deploy<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>More info: <a href=\"https://hexo.io/docs/one-command-deployment.html\">Deployment</a></p>\n","excerpt":"","more":"<p>Welcome to <a href=\"https://hexo.io/\">Hexo</a>! This is your very first post. Check <a href=\"https://hexo.io/docs/\">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href=\"https://hexo.io/docs/troubleshooting.html\">troubleshooting</a> or you can ask me on <a href=\"https://github.com/hexojs/hexo/issues\">GitHub</a>.</p>\n<h2 id=\"Quick-Start\"><a href=\"#Quick-Start\" class=\"headerlink\" title=\"Quick Start\"></a>Quick Start</h2><h3 id=\"Create-a-new-post\"><a href=\"#Create-a-new-post\" class=\"headerlink\" title=\"Create a new post\"></a>Create a new post</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ hexo new <span class=\"token string\">\"My New Post\"</span><span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>More info: <a href=\"https://hexo.io/docs/writing.html\">Writing</a></p>\n<h3 id=\"Run-server\"><a href=\"#Run-server\" class=\"headerlink\" title=\"Run server\"></a>Run server</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ hexo server<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>More info: <a href=\"https://hexo.io/docs/server.html\">Server</a></p>\n<h3 id=\"Generate-static-files\"><a href=\"#Generate-static-files\" class=\"headerlink\" title=\"Generate static files\"></a>Generate static files</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ hexo generate<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>More info: <a href=\"https://hexo.io/docs/generating.html\">Generating</a></p>\n<h3 id=\"Deploy-to-remote-sites\"><a href=\"#Deploy-to-remote-sites\" class=\"headerlink\" title=\"Deploy to remote sites\"></a>Deploy to remote sites</h3><pre class=\"line-numbers language-bash\" data-language=\"bash\"><code class=\"language-bash\">$ hexo deploy<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>More info: <a href=\"https://hexo.io/docs/one-command-deployment.html\">Deployment</a></p>\n"},{"title":"JVMè¿è¡Œæ—¶åŒºåŸŸè¯¦è§£","date":"2025-09-14T01:30:25.000Z","_content":"\næˆ‘ä»¬çŸ¥é“çš„JVMå†…å­˜åŒºåŸŸæœ‰ï¼šå †å’Œæ ˆï¼Œè¿™æ˜¯ä¸€ç§æ³›çš„åˆ†æ³•ï¼Œä¹Ÿæ˜¯æŒ‰è¿è¡Œæ—¶åŒºåŸŸçš„ä¸€ç§åˆ†æ³•ï¼Œå †æ˜¯æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ä¸€å—åŒºåŸŸï¼Œè€Œæ ˆæ˜¯çº¿ç¨‹éš”ç¦»çš„ï¼Œæ¯ä¸ªçº¿ç¨‹äº’ä¸å…±äº«ã€‚\n\n### çº¿ç¨‹ä¸å…±äº«åŒºåŸŸ\n\næ¯ä¸ªçº¿ç¨‹çš„æ•°æ®åŒºåŸŸåŒ…æ‹¬ç¨‹åºè®¡æ•°å™¨ã€è™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆï¼Œå®ƒä»¬éƒ½æ˜¯åœ¨æ–°çº¿ç¨‹åˆ›å»ºæ—¶æ‰åˆ›å»ºçš„ã€‚\n\n\n##### ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Reristerï¼‰\n\nç¨‹åºè®¡æ•°å™¨åŒºåŸŸä¸€å—å†…å­˜è¾ƒå°çš„åŒºåŸŸï¼Œå®ƒç”¨äºå­˜å‚¨çº¿ç¨‹çš„æ¯ä¸ªæ‰§è¡ŒæŒ‡ä»¤ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„ç¨‹åºè®¡æ•°å™¨ï¼Œæ­¤åŒºåŸŸä¸ä¼šæœ‰å†…å­˜æº¢å‡ºçš„æƒ…å†µã€‚\n\n##### è™šæ‹Ÿæœºæ ˆï¼ˆVM Stackï¼‰\n\nè™šæ‹Ÿæœºæ ˆæè¿°çš„æ˜¯Javaæ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹ï¼Œæ¯ä¸ªæ–¹æ³•è¢«æ‰§è¡Œçš„æ—¶å€™éƒ½ä¼šåŒæ—¶åˆ›å»ºä¸€ä¸ªæ ˆå¸§ï¼ˆStack Frameï¼‰ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯ã€‚æ¯ä¸€ä¸ªæ–¹æ³•è¢«è°ƒç”¨ç›´è‡³æ‰§è¡Œå®Œæˆçš„è¿‡ç¨‹å°±å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§åœ¨è™šæ‹Ÿæœºæ ˆä¸­ä»å…¥æ ˆåˆ°å‡ºæ ˆçš„è¿‡ç¨‹ã€‚\n\n##### æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰\n\næœ¬åœ°æ–¹æ³•æ ˆç”¨äºæ”¯æŒæœ¬åœ°æ–¹æ³•ï¼ˆnativeæ ‡è¯†çš„æ–¹æ³•ï¼Œå³éJavaè¯­è¨€å®ç°çš„æ–¹æ³•ï¼‰ã€‚ ã€€\n\nè™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆï¼Œå½“çº¿ç¨‹è¯·æ±‚åˆ†é…çš„æ ˆå®¹é‡è¶…è¿‡JVMå…è®¸çš„æœ€å¤§å®¹é‡æ—¶æŠ›å‡ºStackOverflowErrorå¼‚å¸¸ã€‚\n\nçº¿ç¨‹ä¸å…±äº«åŒºåŸŸå¦‚ä¸‹å›¾ç»¿è‰²èƒŒæ™¯æ‰€ç¤ºã€‚\n\n![image](https://www.programcreek.com/wp-content/uploads/2013/04/JVM-runtime-data-area.jpg)\n\n### çº¿ç¨‹å…±äº«åŒºåŸŸ\n\nçº¿ç¨‹å…±äº«åŒºåŸŸåŒ…å«ï¼šå †å’Œæ–¹æ³•åŒºã€‚\n\n##### å †ï¼ˆHeapï¼‰\n\nå †æ˜¯æœ€å¸¸å¤„ç†çš„åŒºåŸŸï¼Œå®ƒå­˜å‚¨åœ¨JVMå¯åŠ¨æ—¶åˆ›å»ºçš„æ•°ç»„å’Œå¯¹è±¡ï¼ŒJVMåƒåœ¾æ”¶é›†ä¹Ÿä¸»è¦æ˜¯åœ¨å †ä¸Šé¢å·¥ä½œã€‚\n\nå¦‚æœå®é™…æ‰€éœ€çš„å †è¶…è¿‡äº†è‡ªåŠ¨å†…å­˜ç®¡ç†ç³»ç»Ÿèƒ½æä¾›çš„æœ€å¤§å®¹é‡æ—¶æŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€‚\n\n##### æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰\n\næ–¹æ³•åŒºæ˜¯å¯ä¾›å„æ¡çº¿ç¨‹å…±äº«çš„è¿è¡Œæ—¶å†…å­˜åŒºåŸŸã€‚å­˜å‚¨äº†æ¯ä¸€ä¸ªç±»çš„ç»“æ„ä¿¡æ¯ï¼Œä¾‹å¦‚è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime Constant Poolï¼‰ã€å­—æ®µå’Œæ–¹æ³•æ•°æ®ã€æ„é€ å‡½æ•°å’Œæ™®é€šæ–¹æ³•çš„å­—èŠ‚ç å†…å®¹ã€è¿˜åŒ…æ‹¬ä¸€äº›åœ¨ç±»ã€å®ä¾‹ã€æ¥å£åˆå§‹åŒ–æ—¶ç”¨åˆ°çš„ç‰¹æ®Šæ–¹æ³•ã€‚\n\nå½“åˆ›å»ºç±»å’Œæ¥å£æ—¶ï¼Œå¦‚æœæ„é€ è¿è¡Œæ—¶å¸¸é‡æ± æ‰€éœ€çš„å†…å­˜ç©ºé—´è¶…è¿‡äº†æ–¹æ³•åŒºæ‰€èƒ½æä¾›çš„æœ€å¤§å†…å­˜ç©ºé—´åå°±ä¼šæŠ›å‡ºOutOfMemoryError\n\n##### è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime Constant Poolï¼‰\n\nè¿è¡Œæ—¶å¸¸é‡æ± æ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ï¼Œæ¯ä¸€ä¸ªè¿è¡Œæ—¶å¸¸é‡æ± éƒ½åˆ†é…åœ¨JVMçš„æ–¹æ³•åŒºä¸­ï¼Œåœ¨ç±»å’Œæ¥å£è¢«åŠ è½½åˆ°JVMåï¼Œå¯¹åº”çš„è¿è¡Œæ—¶å¸¸é‡æ± å°±è¢«åˆ›å»ºã€‚è¿è¡Œæ—¶å¸¸é‡æ± æ˜¯æ¯ä¸€ä¸ªç±»æˆ–æ¥å£çš„å¸¸é‡æ± ï¼ˆConstant_Poolï¼‰çš„è¿è¡Œæ—¶è¡¨ç°å½¢å¼ï¼Œå®ƒåŒ…æ‹¬äº†è‹¥å¹²ç§å¸¸é‡ï¼šç¼–è¯‘å™¨å¯çŸ¥çš„æ•°å€¼å­—é¢é‡åˆ°å¿…é¡»è¿è¡ŒæœŸè§£æåæ‰èƒ½è·å¾—çš„æ–¹æ³•æˆ–å­—æ®µçš„å¼•ç”¨ã€‚\n\nå¦‚æœæ–¹æ³•åŒºçš„å†…å­˜ç©ºé—´ä¸èƒ½æ»¡è¶³å†…å­˜åˆ†é…è¯·æ±‚ï¼Œé‚£Javaè™šæ‹Ÿæœºå°†æŠ›å‡ºä¸€ä¸ªOutOfMemoryErrorå¼‚å¸¸ã€‚\n\n![image](https://www.programcreek.com/wp-content/uploads/2013/04/JVM-Stack.png)\n\næ ˆåŒ…å«Framesï¼Œå½“è°ƒç”¨æ–¹æ³•æ—¶ï¼ŒFrameè¢«æ¨é€åˆ°å †æ ˆã€‚ä¸€ä¸ªFrameåŒ…å«å±€éƒ¨å˜é‡æ•°ç»„ã€æ“ä½œæ•°æ ˆã€å¸¸é‡æ± å¼•ç”¨ã€‚\n","source":"_posts/JVM/JVMè¿è¡Œæ—¶åŒºåŸŸè¯¦è§£.md","raw":"---\ntitle: JVMè¿è¡Œæ—¶åŒºåŸŸè¯¦è§£\ndate: 2025-09-14 09:30:25\ncategory: åç«¯\ntags: JVM\n---\n\næˆ‘ä»¬çŸ¥é“çš„JVMå†…å­˜åŒºåŸŸæœ‰ï¼šå †å’Œæ ˆï¼Œè¿™æ˜¯ä¸€ç§æ³›çš„åˆ†æ³•ï¼Œä¹Ÿæ˜¯æŒ‰è¿è¡Œæ—¶åŒºåŸŸçš„ä¸€ç§åˆ†æ³•ï¼Œå †æ˜¯æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ä¸€å—åŒºåŸŸï¼Œè€Œæ ˆæ˜¯çº¿ç¨‹éš”ç¦»çš„ï¼Œæ¯ä¸ªçº¿ç¨‹äº’ä¸å…±äº«ã€‚\n\n### çº¿ç¨‹ä¸å…±äº«åŒºåŸŸ\n\næ¯ä¸ªçº¿ç¨‹çš„æ•°æ®åŒºåŸŸåŒ…æ‹¬ç¨‹åºè®¡æ•°å™¨ã€è™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆï¼Œå®ƒä»¬éƒ½æ˜¯åœ¨æ–°çº¿ç¨‹åˆ›å»ºæ—¶æ‰åˆ›å»ºçš„ã€‚\n\n\n##### ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Reristerï¼‰\n\nç¨‹åºè®¡æ•°å™¨åŒºåŸŸä¸€å—å†…å­˜è¾ƒå°çš„åŒºåŸŸï¼Œå®ƒç”¨äºå­˜å‚¨çº¿ç¨‹çš„æ¯ä¸ªæ‰§è¡ŒæŒ‡ä»¤ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„ç¨‹åºè®¡æ•°å™¨ï¼Œæ­¤åŒºåŸŸä¸ä¼šæœ‰å†…å­˜æº¢å‡ºçš„æƒ…å†µã€‚\n\n##### è™šæ‹Ÿæœºæ ˆï¼ˆVM Stackï¼‰\n\nè™šæ‹Ÿæœºæ ˆæè¿°çš„æ˜¯Javaæ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹ï¼Œæ¯ä¸ªæ–¹æ³•è¢«æ‰§è¡Œçš„æ—¶å€™éƒ½ä¼šåŒæ—¶åˆ›å»ºä¸€ä¸ªæ ˆå¸§ï¼ˆStack Frameï¼‰ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯ã€‚æ¯ä¸€ä¸ªæ–¹æ³•è¢«è°ƒç”¨ç›´è‡³æ‰§è¡Œå®Œæˆçš„è¿‡ç¨‹å°±å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§åœ¨è™šæ‹Ÿæœºæ ˆä¸­ä»å…¥æ ˆåˆ°å‡ºæ ˆçš„è¿‡ç¨‹ã€‚\n\n##### æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰\n\næœ¬åœ°æ–¹æ³•æ ˆç”¨äºæ”¯æŒæœ¬åœ°æ–¹æ³•ï¼ˆnativeæ ‡è¯†çš„æ–¹æ³•ï¼Œå³éJavaè¯­è¨€å®ç°çš„æ–¹æ³•ï¼‰ã€‚ ã€€\n\nè™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆï¼Œå½“çº¿ç¨‹è¯·æ±‚åˆ†é…çš„æ ˆå®¹é‡è¶…è¿‡JVMå…è®¸çš„æœ€å¤§å®¹é‡æ—¶æŠ›å‡ºStackOverflowErrorå¼‚å¸¸ã€‚\n\nçº¿ç¨‹ä¸å…±äº«åŒºåŸŸå¦‚ä¸‹å›¾ç»¿è‰²èƒŒæ™¯æ‰€ç¤ºã€‚\n\n![image](https://www.programcreek.com/wp-content/uploads/2013/04/JVM-runtime-data-area.jpg)\n\n### çº¿ç¨‹å…±äº«åŒºåŸŸ\n\nçº¿ç¨‹å…±äº«åŒºåŸŸåŒ…å«ï¼šå †å’Œæ–¹æ³•åŒºã€‚\n\n##### å †ï¼ˆHeapï¼‰\n\nå †æ˜¯æœ€å¸¸å¤„ç†çš„åŒºåŸŸï¼Œå®ƒå­˜å‚¨åœ¨JVMå¯åŠ¨æ—¶åˆ›å»ºçš„æ•°ç»„å’Œå¯¹è±¡ï¼ŒJVMåƒåœ¾æ”¶é›†ä¹Ÿä¸»è¦æ˜¯åœ¨å †ä¸Šé¢å·¥ä½œã€‚\n\nå¦‚æœå®é™…æ‰€éœ€çš„å †è¶…è¿‡äº†è‡ªåŠ¨å†…å­˜ç®¡ç†ç³»ç»Ÿèƒ½æä¾›çš„æœ€å¤§å®¹é‡æ—¶æŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€‚\n\n##### æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰\n\næ–¹æ³•åŒºæ˜¯å¯ä¾›å„æ¡çº¿ç¨‹å…±äº«çš„è¿è¡Œæ—¶å†…å­˜åŒºåŸŸã€‚å­˜å‚¨äº†æ¯ä¸€ä¸ªç±»çš„ç»“æ„ä¿¡æ¯ï¼Œä¾‹å¦‚è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime Constant Poolï¼‰ã€å­—æ®µå’Œæ–¹æ³•æ•°æ®ã€æ„é€ å‡½æ•°å’Œæ™®é€šæ–¹æ³•çš„å­—èŠ‚ç å†…å®¹ã€è¿˜åŒ…æ‹¬ä¸€äº›åœ¨ç±»ã€å®ä¾‹ã€æ¥å£åˆå§‹åŒ–æ—¶ç”¨åˆ°çš„ç‰¹æ®Šæ–¹æ³•ã€‚\n\nå½“åˆ›å»ºç±»å’Œæ¥å£æ—¶ï¼Œå¦‚æœæ„é€ è¿è¡Œæ—¶å¸¸é‡æ± æ‰€éœ€çš„å†…å­˜ç©ºé—´è¶…è¿‡äº†æ–¹æ³•åŒºæ‰€èƒ½æä¾›çš„æœ€å¤§å†…å­˜ç©ºé—´åå°±ä¼šæŠ›å‡ºOutOfMemoryError\n\n##### è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime Constant Poolï¼‰\n\nè¿è¡Œæ—¶å¸¸é‡æ± æ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ï¼Œæ¯ä¸€ä¸ªè¿è¡Œæ—¶å¸¸é‡æ± éƒ½åˆ†é…åœ¨JVMçš„æ–¹æ³•åŒºä¸­ï¼Œåœ¨ç±»å’Œæ¥å£è¢«åŠ è½½åˆ°JVMåï¼Œå¯¹åº”çš„è¿è¡Œæ—¶å¸¸é‡æ± å°±è¢«åˆ›å»ºã€‚è¿è¡Œæ—¶å¸¸é‡æ± æ˜¯æ¯ä¸€ä¸ªç±»æˆ–æ¥å£çš„å¸¸é‡æ± ï¼ˆConstant_Poolï¼‰çš„è¿è¡Œæ—¶è¡¨ç°å½¢å¼ï¼Œå®ƒåŒ…æ‹¬äº†è‹¥å¹²ç§å¸¸é‡ï¼šç¼–è¯‘å™¨å¯çŸ¥çš„æ•°å€¼å­—é¢é‡åˆ°å¿…é¡»è¿è¡ŒæœŸè§£æåæ‰èƒ½è·å¾—çš„æ–¹æ³•æˆ–å­—æ®µçš„å¼•ç”¨ã€‚\n\nå¦‚æœæ–¹æ³•åŒºçš„å†…å­˜ç©ºé—´ä¸èƒ½æ»¡è¶³å†…å­˜åˆ†é…è¯·æ±‚ï¼Œé‚£Javaè™šæ‹Ÿæœºå°†æŠ›å‡ºä¸€ä¸ªOutOfMemoryErrorå¼‚å¸¸ã€‚\n\n![image](https://www.programcreek.com/wp-content/uploads/2013/04/JVM-Stack.png)\n\næ ˆåŒ…å«Framesï¼Œå½“è°ƒç”¨æ–¹æ³•æ—¶ï¼ŒFrameè¢«æ¨é€åˆ°å †æ ˆã€‚ä¸€ä¸ªFrameåŒ…å«å±€éƒ¨å˜é‡æ•°ç»„ã€æ“ä½œæ•°æ ˆã€å¸¸é‡æ± å¼•ç”¨ã€‚\n","slug":"JVM/JVMè¿è¡Œæ—¶åŒºåŸŸè¯¦è§£","published":1,"updated":"2025-10-15T10:12:11.562Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu07680003qkd42iuygj9v","content":"<p>æˆ‘ä»¬çŸ¥é“çš„JVMå†…å­˜åŒºåŸŸæœ‰ï¼šå †å’Œæ ˆï¼Œè¿™æ˜¯ä¸€ç§æ³›çš„åˆ†æ³•ï¼Œä¹Ÿæ˜¯æŒ‰è¿è¡Œæ—¶åŒºåŸŸçš„ä¸€ç§åˆ†æ³•ï¼Œå †æ˜¯æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ä¸€å—åŒºåŸŸï¼Œè€Œæ ˆæ˜¯çº¿ç¨‹éš”ç¦»çš„ï¼Œæ¯ä¸ªçº¿ç¨‹äº’ä¸å…±äº«ã€‚</p>\n<h3 id=\"çº¿ç¨‹ä¸å…±äº«åŒºåŸŸ\"><a href=\"#çº¿ç¨‹ä¸å…±äº«åŒºåŸŸ\" class=\"headerlink\" title=\"çº¿ç¨‹ä¸å…±äº«åŒºåŸŸ\"></a>çº¿ç¨‹ä¸å…±äº«åŒºåŸŸ</h3><p>æ¯ä¸ªçº¿ç¨‹çš„æ•°æ®åŒºåŸŸåŒ…æ‹¬ç¨‹åºè®¡æ•°å™¨ã€è™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆï¼Œå®ƒä»¬éƒ½æ˜¯åœ¨æ–°çº¿ç¨‹åˆ›å»ºæ—¶æ‰åˆ›å»ºçš„ã€‚</p>\n<h5 id=\"ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram-Counter-Reristerï¼‰\"><a href=\"#ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram-Counter-Reristerï¼‰\" class=\"headerlink\" title=\"ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Reristerï¼‰\"></a>ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Reristerï¼‰</h5><p>ç¨‹åºè®¡æ•°å™¨åŒºåŸŸä¸€å—å†…å­˜è¾ƒå°çš„åŒºåŸŸï¼Œå®ƒç”¨äºå­˜å‚¨çº¿ç¨‹çš„æ¯ä¸ªæ‰§è¡ŒæŒ‡ä»¤ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„ç¨‹åºè®¡æ•°å™¨ï¼Œæ­¤åŒºåŸŸä¸ä¼šæœ‰å†…å­˜æº¢å‡ºçš„æƒ…å†µã€‚</p>\n<h5 id=\"è™šæ‹Ÿæœºæ ˆï¼ˆVM-Stackï¼‰\"><a href=\"#è™šæ‹Ÿæœºæ ˆï¼ˆVM-Stackï¼‰\" class=\"headerlink\" title=\"è™šæ‹Ÿæœºæ ˆï¼ˆVM Stackï¼‰\"></a>è™šæ‹Ÿæœºæ ˆï¼ˆVM Stackï¼‰</h5><p>è™šæ‹Ÿæœºæ ˆæè¿°çš„æ˜¯Javaæ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹ï¼Œæ¯ä¸ªæ–¹æ³•è¢«æ‰§è¡Œçš„æ—¶å€™éƒ½ä¼šåŒæ—¶åˆ›å»ºä¸€ä¸ªæ ˆå¸§ï¼ˆStack Frameï¼‰ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯ã€‚æ¯ä¸€ä¸ªæ–¹æ³•è¢«è°ƒç”¨ç›´è‡³æ‰§è¡Œå®Œæˆçš„è¿‡ç¨‹å°±å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§åœ¨è™šæ‹Ÿæœºæ ˆä¸­ä»å…¥æ ˆåˆ°å‡ºæ ˆçš„è¿‡ç¨‹ã€‚</p>\n<h5 id=\"æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative-Method-Stackï¼‰\"><a href=\"#æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative-Method-Stackï¼‰\" class=\"headerlink\" title=\"æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰\"></a>æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰</h5><p>æœ¬åœ°æ–¹æ³•æ ˆç”¨äºæ”¯æŒæœ¬åœ°æ–¹æ³•ï¼ˆnativeæ ‡è¯†çš„æ–¹æ³•ï¼Œå³éJavaè¯­è¨€å®ç°çš„æ–¹æ³•ï¼‰ã€‚ ã€€</p>\n<p>è™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆï¼Œå½“çº¿ç¨‹è¯·æ±‚åˆ†é…çš„æ ˆå®¹é‡è¶…è¿‡JVMå…è®¸çš„æœ€å¤§å®¹é‡æ—¶æŠ›å‡ºStackOverflowErrorå¼‚å¸¸ã€‚</p>\n<p>çº¿ç¨‹ä¸å…±äº«åŒºåŸŸå¦‚ä¸‹å›¾ç»¿è‰²èƒŒæ™¯æ‰€ç¤ºã€‚</p>\n<p><img src=\"https://www.programcreek.com/wp-content/uploads/2013/04/JVM-runtime-data-area.jpg\" alt=\"image\"></p>\n<h3 id=\"çº¿ç¨‹å…±äº«åŒºåŸŸ\"><a href=\"#çº¿ç¨‹å…±äº«åŒºåŸŸ\" class=\"headerlink\" title=\"çº¿ç¨‹å…±äº«åŒºåŸŸ\"></a>çº¿ç¨‹å…±äº«åŒºåŸŸ</h3><p>çº¿ç¨‹å…±äº«åŒºåŸŸåŒ…å«ï¼šå †å’Œæ–¹æ³•åŒºã€‚</p>\n<h5 id=\"å †ï¼ˆHeapï¼‰\"><a href=\"#å †ï¼ˆHeapï¼‰\" class=\"headerlink\" title=\"å †ï¼ˆHeapï¼‰\"></a>å †ï¼ˆHeapï¼‰</h5><p>å †æ˜¯æœ€å¸¸å¤„ç†çš„åŒºåŸŸï¼Œå®ƒå­˜å‚¨åœ¨JVMå¯åŠ¨æ—¶åˆ›å»ºçš„æ•°ç»„å’Œå¯¹è±¡ï¼ŒJVMåƒåœ¾æ”¶é›†ä¹Ÿä¸»è¦æ˜¯åœ¨å †ä¸Šé¢å·¥ä½œã€‚</p>\n<p>å¦‚æœå®é™…æ‰€éœ€çš„å †è¶…è¿‡äº†è‡ªåŠ¨å†…å­˜ç®¡ç†ç³»ç»Ÿèƒ½æä¾›çš„æœ€å¤§å®¹é‡æ—¶æŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€‚</p>\n<h5 id=\"æ–¹æ³•åŒºï¼ˆMethod-Areaï¼‰\"><a href=\"#æ–¹æ³•åŒºï¼ˆMethod-Areaï¼‰\" class=\"headerlink\" title=\"æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰\"></a>æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰</h5><p>æ–¹æ³•åŒºæ˜¯å¯ä¾›å„æ¡çº¿ç¨‹å…±äº«çš„è¿è¡Œæ—¶å†…å­˜åŒºåŸŸã€‚å­˜å‚¨äº†æ¯ä¸€ä¸ªç±»çš„ç»“æ„ä¿¡æ¯ï¼Œä¾‹å¦‚è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime Constant Poolï¼‰ã€å­—æ®µå’Œæ–¹æ³•æ•°æ®ã€æ„é€ å‡½æ•°å’Œæ™®é€šæ–¹æ³•çš„å­—èŠ‚ç å†…å®¹ã€è¿˜åŒ…æ‹¬ä¸€äº›åœ¨ç±»ã€å®ä¾‹ã€æ¥å£åˆå§‹åŒ–æ—¶ç”¨åˆ°çš„ç‰¹æ®Šæ–¹æ³•ã€‚</p>\n<p>å½“åˆ›å»ºç±»å’Œæ¥å£æ—¶ï¼Œå¦‚æœæ„é€ è¿è¡Œæ—¶å¸¸é‡æ± æ‰€éœ€çš„å†…å­˜ç©ºé—´è¶…è¿‡äº†æ–¹æ³•åŒºæ‰€èƒ½æä¾›çš„æœ€å¤§å†…å­˜ç©ºé—´åå°±ä¼šæŠ›å‡ºOutOfMemoryError</p>\n<h5 id=\"è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime-Constant-Poolï¼‰\"><a href=\"#è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime-Constant-Poolï¼‰\" class=\"headerlink\" title=\"è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime Constant Poolï¼‰\"></a>è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime Constant Poolï¼‰</h5><p>è¿è¡Œæ—¶å¸¸é‡æ± æ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ï¼Œæ¯ä¸€ä¸ªè¿è¡Œæ—¶å¸¸é‡æ± éƒ½åˆ†é…åœ¨JVMçš„æ–¹æ³•åŒºä¸­ï¼Œåœ¨ç±»å’Œæ¥å£è¢«åŠ è½½åˆ°JVMåï¼Œå¯¹åº”çš„è¿è¡Œæ—¶å¸¸é‡æ± å°±è¢«åˆ›å»ºã€‚è¿è¡Œæ—¶å¸¸é‡æ± æ˜¯æ¯ä¸€ä¸ªç±»æˆ–æ¥å£çš„å¸¸é‡æ± ï¼ˆConstant_Poolï¼‰çš„è¿è¡Œæ—¶è¡¨ç°å½¢å¼ï¼Œå®ƒåŒ…æ‹¬äº†è‹¥å¹²ç§å¸¸é‡ï¼šç¼–è¯‘å™¨å¯çŸ¥çš„æ•°å€¼å­—é¢é‡åˆ°å¿…é¡»è¿è¡ŒæœŸè§£æåæ‰èƒ½è·å¾—çš„æ–¹æ³•æˆ–å­—æ®µçš„å¼•ç”¨ã€‚</p>\n<p>å¦‚æœæ–¹æ³•åŒºçš„å†…å­˜ç©ºé—´ä¸èƒ½æ»¡è¶³å†…å­˜åˆ†é…è¯·æ±‚ï¼Œé‚£Javaè™šæ‹Ÿæœºå°†æŠ›å‡ºä¸€ä¸ªOutOfMemoryErrorå¼‚å¸¸ã€‚</p>\n<p><img src=\"https://www.programcreek.com/wp-content/uploads/2013/04/JVM-Stack.png\" alt=\"image\"></p>\n<p>æ ˆåŒ…å«Framesï¼Œå½“è°ƒç”¨æ–¹æ³•æ—¶ï¼ŒFrameè¢«æ¨é€åˆ°å †æ ˆã€‚ä¸€ä¸ªFrameåŒ…å«å±€éƒ¨å˜é‡æ•°ç»„ã€æ“ä½œæ•°æ ˆã€å¸¸é‡æ± å¼•ç”¨ã€‚</p>\n","excerpt":"","more":"<p>æˆ‘ä»¬çŸ¥é“çš„JVMå†…å­˜åŒºåŸŸæœ‰ï¼šå †å’Œæ ˆï¼Œè¿™æ˜¯ä¸€ç§æ³›çš„åˆ†æ³•ï¼Œä¹Ÿæ˜¯æŒ‰è¿è¡Œæ—¶åŒºåŸŸçš„ä¸€ç§åˆ†æ³•ï¼Œå †æ˜¯æ‰€æœ‰çº¿ç¨‹å…±äº«çš„ä¸€å—åŒºåŸŸï¼Œè€Œæ ˆæ˜¯çº¿ç¨‹éš”ç¦»çš„ï¼Œæ¯ä¸ªçº¿ç¨‹äº’ä¸å…±äº«ã€‚</p>\n<h3 id=\"çº¿ç¨‹ä¸å…±äº«åŒºåŸŸ\"><a href=\"#çº¿ç¨‹ä¸å…±äº«åŒºåŸŸ\" class=\"headerlink\" title=\"çº¿ç¨‹ä¸å…±äº«åŒºåŸŸ\"></a>çº¿ç¨‹ä¸å…±äº«åŒºåŸŸ</h3><p>æ¯ä¸ªçº¿ç¨‹çš„æ•°æ®åŒºåŸŸåŒ…æ‹¬ç¨‹åºè®¡æ•°å™¨ã€è™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆï¼Œå®ƒä»¬éƒ½æ˜¯åœ¨æ–°çº¿ç¨‹åˆ›å»ºæ—¶æ‰åˆ›å»ºçš„ã€‚</p>\n<h5 id=\"ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram-Counter-Reristerï¼‰\"><a href=\"#ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram-Counter-Reristerï¼‰\" class=\"headerlink\" title=\"ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Reristerï¼‰\"></a>ç¨‹åºè®¡æ•°å™¨ï¼ˆProgram Counter Reristerï¼‰</h5><p>ç¨‹åºè®¡æ•°å™¨åŒºåŸŸä¸€å—å†…å­˜è¾ƒå°çš„åŒºåŸŸï¼Œå®ƒç”¨äºå­˜å‚¨çº¿ç¨‹çš„æ¯ä¸ªæ‰§è¡ŒæŒ‡ä»¤ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„ç¨‹åºè®¡æ•°å™¨ï¼Œæ­¤åŒºåŸŸä¸ä¼šæœ‰å†…å­˜æº¢å‡ºçš„æƒ…å†µã€‚</p>\n<h5 id=\"è™šæ‹Ÿæœºæ ˆï¼ˆVM-Stackï¼‰\"><a href=\"#è™šæ‹Ÿæœºæ ˆï¼ˆVM-Stackï¼‰\" class=\"headerlink\" title=\"è™šæ‹Ÿæœºæ ˆï¼ˆVM Stackï¼‰\"></a>è™šæ‹Ÿæœºæ ˆï¼ˆVM Stackï¼‰</h5><p>è™šæ‹Ÿæœºæ ˆæè¿°çš„æ˜¯Javaæ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹ï¼Œæ¯ä¸ªæ–¹æ³•è¢«æ‰§è¡Œçš„æ—¶å€™éƒ½ä¼šåŒæ—¶åˆ›å»ºä¸€ä¸ªæ ˆå¸§ï¼ˆStack Frameï¼‰ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯ã€‚æ¯ä¸€ä¸ªæ–¹æ³•è¢«è°ƒç”¨ç›´è‡³æ‰§è¡Œå®Œæˆçš„è¿‡ç¨‹å°±å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§åœ¨è™šæ‹Ÿæœºæ ˆä¸­ä»å…¥æ ˆåˆ°å‡ºæ ˆçš„è¿‡ç¨‹ã€‚</p>\n<h5 id=\"æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative-Method-Stackï¼‰\"><a href=\"#æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative-Method-Stackï¼‰\" class=\"headerlink\" title=\"æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰\"></a>æœ¬åœ°æ–¹æ³•æ ˆï¼ˆNative Method Stackï¼‰</h5><p>æœ¬åœ°æ–¹æ³•æ ˆç”¨äºæ”¯æŒæœ¬åœ°æ–¹æ³•ï¼ˆnativeæ ‡è¯†çš„æ–¹æ³•ï¼Œå³éJavaè¯­è¨€å®ç°çš„æ–¹æ³•ï¼‰ã€‚ ã€€</p>\n<p>è™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆï¼Œå½“çº¿ç¨‹è¯·æ±‚åˆ†é…çš„æ ˆå®¹é‡è¶…è¿‡JVMå…è®¸çš„æœ€å¤§å®¹é‡æ—¶æŠ›å‡ºStackOverflowErrorå¼‚å¸¸ã€‚</p>\n<p>çº¿ç¨‹ä¸å…±äº«åŒºåŸŸå¦‚ä¸‹å›¾ç»¿è‰²èƒŒæ™¯æ‰€ç¤ºã€‚</p>\n<p><img src=\"https://www.programcreek.com/wp-content/uploads/2013/04/JVM-runtime-data-area.jpg\" alt=\"image\"></p>\n<h3 id=\"çº¿ç¨‹å…±äº«åŒºåŸŸ\"><a href=\"#çº¿ç¨‹å…±äº«åŒºåŸŸ\" class=\"headerlink\" title=\"çº¿ç¨‹å…±äº«åŒºåŸŸ\"></a>çº¿ç¨‹å…±äº«åŒºåŸŸ</h3><p>çº¿ç¨‹å…±äº«åŒºåŸŸåŒ…å«ï¼šå †å’Œæ–¹æ³•åŒºã€‚</p>\n<h5 id=\"å †ï¼ˆHeapï¼‰\"><a href=\"#å †ï¼ˆHeapï¼‰\" class=\"headerlink\" title=\"å †ï¼ˆHeapï¼‰\"></a>å †ï¼ˆHeapï¼‰</h5><p>å †æ˜¯æœ€å¸¸å¤„ç†çš„åŒºåŸŸï¼Œå®ƒå­˜å‚¨åœ¨JVMå¯åŠ¨æ—¶åˆ›å»ºçš„æ•°ç»„å’Œå¯¹è±¡ï¼ŒJVMåƒåœ¾æ”¶é›†ä¹Ÿä¸»è¦æ˜¯åœ¨å †ä¸Šé¢å·¥ä½œã€‚</p>\n<p>å¦‚æœå®é™…æ‰€éœ€çš„å †è¶…è¿‡äº†è‡ªåŠ¨å†…å­˜ç®¡ç†ç³»ç»Ÿèƒ½æä¾›çš„æœ€å¤§å®¹é‡æ—¶æŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ã€‚</p>\n<h5 id=\"æ–¹æ³•åŒºï¼ˆMethod-Areaï¼‰\"><a href=\"#æ–¹æ³•åŒºï¼ˆMethod-Areaï¼‰\" class=\"headerlink\" title=\"æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰\"></a>æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰</h5><p>æ–¹æ³•åŒºæ˜¯å¯ä¾›å„æ¡çº¿ç¨‹å…±äº«çš„è¿è¡Œæ—¶å†…å­˜åŒºåŸŸã€‚å­˜å‚¨äº†æ¯ä¸€ä¸ªç±»çš„ç»“æ„ä¿¡æ¯ï¼Œä¾‹å¦‚è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime Constant Poolï¼‰ã€å­—æ®µå’Œæ–¹æ³•æ•°æ®ã€æ„é€ å‡½æ•°å’Œæ™®é€šæ–¹æ³•çš„å­—èŠ‚ç å†…å®¹ã€è¿˜åŒ…æ‹¬ä¸€äº›åœ¨ç±»ã€å®ä¾‹ã€æ¥å£åˆå§‹åŒ–æ—¶ç”¨åˆ°çš„ç‰¹æ®Šæ–¹æ³•ã€‚</p>\n<p>å½“åˆ›å»ºç±»å’Œæ¥å£æ—¶ï¼Œå¦‚æœæ„é€ è¿è¡Œæ—¶å¸¸é‡æ± æ‰€éœ€çš„å†…å­˜ç©ºé—´è¶…è¿‡äº†æ–¹æ³•åŒºæ‰€èƒ½æä¾›çš„æœ€å¤§å†…å­˜ç©ºé—´åå°±ä¼šæŠ›å‡ºOutOfMemoryError</p>\n<h5 id=\"è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime-Constant-Poolï¼‰\"><a href=\"#è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime-Constant-Poolï¼‰\" class=\"headerlink\" title=\"è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime Constant Poolï¼‰\"></a>è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime Constant Poolï¼‰</h5><p>è¿è¡Œæ—¶å¸¸é‡æ± æ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ï¼Œæ¯ä¸€ä¸ªè¿è¡Œæ—¶å¸¸é‡æ± éƒ½åˆ†é…åœ¨JVMçš„æ–¹æ³•åŒºä¸­ï¼Œåœ¨ç±»å’Œæ¥å£è¢«åŠ è½½åˆ°JVMåï¼Œå¯¹åº”çš„è¿è¡Œæ—¶å¸¸é‡æ± å°±è¢«åˆ›å»ºã€‚è¿è¡Œæ—¶å¸¸é‡æ± æ˜¯æ¯ä¸€ä¸ªç±»æˆ–æ¥å£çš„å¸¸é‡æ± ï¼ˆConstant_Poolï¼‰çš„è¿è¡Œæ—¶è¡¨ç°å½¢å¼ï¼Œå®ƒåŒ…æ‹¬äº†è‹¥å¹²ç§å¸¸é‡ï¼šç¼–è¯‘å™¨å¯çŸ¥çš„æ•°å€¼å­—é¢é‡åˆ°å¿…é¡»è¿è¡ŒæœŸè§£æåæ‰èƒ½è·å¾—çš„æ–¹æ³•æˆ–å­—æ®µçš„å¼•ç”¨ã€‚</p>\n<p>å¦‚æœæ–¹æ³•åŒºçš„å†…å­˜ç©ºé—´ä¸èƒ½æ»¡è¶³å†…å­˜åˆ†é…è¯·æ±‚ï¼Œé‚£Javaè™šæ‹Ÿæœºå°†æŠ›å‡ºä¸€ä¸ªOutOfMemoryErrorå¼‚å¸¸ã€‚</p>\n<p><img src=\"https://www.programcreek.com/wp-content/uploads/2013/04/JVM-Stack.png\" alt=\"image\"></p>\n<p>æ ˆåŒ…å«Framesï¼Œå½“è°ƒç”¨æ–¹æ³•æ—¶ï¼ŒFrameè¢«æ¨é€åˆ°å †æ ˆã€‚ä¸€ä¸ªFrameåŒ…å«å±€éƒ¨å˜é‡æ•°ç»„ã€æ“ä½œæ•°æ ˆã€å¸¸é‡æ± å¼•ç”¨ã€‚</p>\n"},{"title":"Java 5 ~ 10 æ–°ç‰¹æ€§å€¾æƒ…æ•´ç†ï¼","date":"2025-10-15T03:36:33.000Z","_content":"\næœ€è¿‘è¿ JDK11éƒ½åœ¨å‡†å¤‡å‘å¸ƒçš„è·¯ä¸Šäº†ï¼Œå¤§å®¶éƒ½æ•´æ˜ç™½äº†å—ï¼Ÿä¹Ÿè®¸ç°åœ¨å¤§éƒ¨åˆ†äººè¿˜åœ¨ç”¨6-8ï¼Œ8çš„æ–°ç‰¹æ€§éƒ½æ²¡ç”¨ç†Ÿï¼Œ9åˆšå‡ºä¸ä¹…ï¼Œ10-11å°±ä¸ç”¨è¯´äº†ã€‚\n\nä¸ºäº†å¤§å®¶å¯¹JDKæœ‰ä¸€ä¸ªå…¨é¢çš„äº†è§£ï¼Œä¸‹é¢æˆ‘ä¸ºå¤§å®¶æ•´ç†äº†JDK5~10çš„æ‰€æœ‰å…³é”®æ–°ç‰¹æ€§ï¼\n\n**JDK5æ–°ç‰¹æ€§**\n\n- è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±\n- æšä¸¾\n- é™æ€å¯¼å…¥\n- å¯å˜å‚æ•°ï¼ˆVarargsï¼‰\n- å†…çœï¼ˆintrospectorï¼‰\n- æ³›å‹ï¼ˆGenericï¼‰\n- For-Eachå¾ªç¯\n\n**JDK6æ–°ç‰¹æ€§**\n\n- Desktopç±»å’ŒSystemTrayç±»\n- ä½¿ç”¨JAXB2æ¥å®ç°å¯¹è±¡ä¸XMLä¹‹é—´çš„æ˜ å°„\n- ç†è§£STAX\n- ä½¿ç”¨Compiler API\n- è½»é‡çº§ Http Server API\n- æ’å…¥å¼æ³¨è§£å¤„ç† API\n- ä½¿ç”¨Consoleå¼€å‘æ§åˆ¶å°ç¨‹åº\n- å¯¹è„šæœ¬è¯­è¨€çš„æ”¯æŒ\n- Common Annotations\n- Java GUIç•Œé¢çš„æ˜¾ç¤º\n- åµŒå…¥å¼æ•°æ®åº“Derby\n- WebæœåŠ¡å…ƒæ•°æ®\n- Jtableçš„æ’åºå’Œè¿‡æ»¤\n- æ›´ç®€å•æ›´å¼ºå¤§çš„JAX-WS\n\n**JDK7æ–°ç‰¹æ€§**\n\n- switchä¸­å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²äº†\n- æ³›å‹å®ä¾‹åŒ–ç±»å‹è‡ªåŠ¨æ¨æ–­\n- è‡ªå®šä¹‰è‡ªåŠ¨å…³é—­ç±»\n- æ–°å¢ä¸€äº›è¯»å–ç¯å¢ƒä¿¡æ¯çš„å·¥å…·æ–¹æ³•\n- Booleanç±»å‹åè½¬ï¼Œç©ºæŒ‡é’ˆå®‰å…¨ï¼Œå‚ä¸ä½è¿ç®—\n- ä¸¤ä¸ªcharä¹‹é—´çš„equals\n- å®‰å…¨çš„åŠ å‡ä¹˜é™¤|sd\n- å¯¹Javaé›†åˆ( Collectionsï¼‰çš„å¢å¼ºæ”¯æŒ\n- æ•°å€¼å¯åŠ ä¸‹åˆ’çº¿\n- æ”¯æŒäºŒè¿›åˆ¶æ•°å­—\n- åœ¨try/catchå¼‚å¸¸æ‰‘æ‰ä¸­ï¼Œä¸€ä¸ªcatchå¯ä»¥å†™å¤šä¸ªå¼‚å¸¸ç±»å‹ç”¨|éš”å¼€\n- å¯ä»¥ä¸å¿…è¦å†™finallyè¯­å¥æ¥å…³é—­èµ„æºï¼Œåªè¦ä½ åœ¨try()çš„æ‹¬å·å†…éƒ¨å®šä¹‰è¦ä½¿ç”¨çš„èµ„æº\n\n**JDK8æ–°ç‰¹æ€§**\n\n- æ¥å£çš„é»˜è®¤æ–¹æ³•\n- Lambdaè¡¨è¾¾å¼\n- å‡½æ•°å¼æ¥å£\n- æ–¹æ³•ä¸æ„é€ å‡½æ•°å¼•ç”¨\n- æ‰©å±•äº†é›†åˆç±»\n- æ–°çš„Date API\n- Annotationå¤šé‡æ³¨è§£\n- streamsï¼ˆæµï¼‰\n- parallel streams(å¹¶è¡Œæµ)\n- Mapæ•°æ®ç»“æ„æ”¹è¿›\n\n**JDK9æ–°ç‰¹æ€§**\n\n- Jigsawæ¨¡å—åŒ–é¡¹ç›®\n- ç®€åŒ–è¿›ç¨‹API\n- è½»é‡çº§JSON API\n- é’±å’Œè´§å¸çš„API\n- æ”¹å–„é”ç«äº‰æœºåˆ¶\n- ä»£ç åˆ†æ®µç¼“å­˜\n- æ™ºèƒ½javaç¼–è¯‘\n- http2.0å®¢æˆ·ç«¯\n- kullaè®¡åˆ’\n\n**JDK10æ–°ç‰¹æ€§**\n\n- å±€éƒ¨å˜é‡çš„ç±»å‹æ¨æ–­\n- GCæ”¹è¿›å’Œå†…å­˜ç®¡ç†\n- çº¿ç¨‹æœ¬åœ°æ¡æ‰‹\n- å¤‡ç”¨å†…å­˜è®¾å¤‡ä¸Šçš„å †åˆ†é…\n- å…¶ä»–Unicodeè¯­è¨€ - æ ‡è®°æ‰©å±•\n- åŸºäºJavaçš„å®éªŒæ€§JITç¼–è¯‘å™¨\n- å¼€æºæ ¹è¯ä¹¦\n- æ ¹è¯ä¹¦é¢å‘è®¤è¯ï¼ˆCAï¼‰\n- å°†JDKç”Ÿæ€æ•´åˆå•ä¸ªå­˜å‚¨åº“\n- åˆ é™¤å·¥å…·javah\n\næ€ä¹ˆæ ·ï¼Œè¿™äº›æ–°ç‰¹æ€§éƒ½çŸ¥é“å¤šå°‘ï¼Ÿéƒ½ç”¨è¿‡å¤šå°‘ï¼Ÿå¤šå­¦ä¹ è¿™äº›æ–°ç‰¹æ€§ï¼Œå¯¹å†™ä»£ç çš„æ•ˆç‡ã€é€¼æ ¼ã€æŠ€èƒ½æˆé•¿ã€å°±ä¸šè¿˜æ˜¯ä¼šå¾ˆæœ‰å¸®åŠ©çš„ã€‚\n\n","source":"_posts/æ–°ç‰¹æ€§/Java 5 ~ 10 æ–°ç‰¹æ€§å€¾æƒ…æ•´ç†ï¼.md","raw":"---\ntitle: Java 5 ~ 10 æ–°ç‰¹æ€§å€¾æƒ…æ•´ç†ï¼\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: æ–°ç‰¹æ€§\n---\n\næœ€è¿‘è¿ JDK11éƒ½åœ¨å‡†å¤‡å‘å¸ƒçš„è·¯ä¸Šäº†ï¼Œå¤§å®¶éƒ½æ•´æ˜ç™½äº†å—ï¼Ÿä¹Ÿè®¸ç°åœ¨å¤§éƒ¨åˆ†äººè¿˜åœ¨ç”¨6-8ï¼Œ8çš„æ–°ç‰¹æ€§éƒ½æ²¡ç”¨ç†Ÿï¼Œ9åˆšå‡ºä¸ä¹…ï¼Œ10-11å°±ä¸ç”¨è¯´äº†ã€‚\n\nä¸ºäº†å¤§å®¶å¯¹JDKæœ‰ä¸€ä¸ªå…¨é¢çš„äº†è§£ï¼Œä¸‹é¢æˆ‘ä¸ºå¤§å®¶æ•´ç†äº†JDK5~10çš„æ‰€æœ‰å…³é”®æ–°ç‰¹æ€§ï¼\n\n**JDK5æ–°ç‰¹æ€§**\n\n- è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±\n- æšä¸¾\n- é™æ€å¯¼å…¥\n- å¯å˜å‚æ•°ï¼ˆVarargsï¼‰\n- å†…çœï¼ˆintrospectorï¼‰\n- æ³›å‹ï¼ˆGenericï¼‰\n- For-Eachå¾ªç¯\n\n**JDK6æ–°ç‰¹æ€§**\n\n- Desktopç±»å’ŒSystemTrayç±»\n- ä½¿ç”¨JAXB2æ¥å®ç°å¯¹è±¡ä¸XMLä¹‹é—´çš„æ˜ å°„\n- ç†è§£STAX\n- ä½¿ç”¨Compiler API\n- è½»é‡çº§ Http Server API\n- æ’å…¥å¼æ³¨è§£å¤„ç† API\n- ä½¿ç”¨Consoleå¼€å‘æ§åˆ¶å°ç¨‹åº\n- å¯¹è„šæœ¬è¯­è¨€çš„æ”¯æŒ\n- Common Annotations\n- Java GUIç•Œé¢çš„æ˜¾ç¤º\n- åµŒå…¥å¼æ•°æ®åº“Derby\n- WebæœåŠ¡å…ƒæ•°æ®\n- Jtableçš„æ’åºå’Œè¿‡æ»¤\n- æ›´ç®€å•æ›´å¼ºå¤§çš„JAX-WS\n\n**JDK7æ–°ç‰¹æ€§**\n\n- switchä¸­å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²äº†\n- æ³›å‹å®ä¾‹åŒ–ç±»å‹è‡ªåŠ¨æ¨æ–­\n- è‡ªå®šä¹‰è‡ªåŠ¨å…³é—­ç±»\n- æ–°å¢ä¸€äº›è¯»å–ç¯å¢ƒä¿¡æ¯çš„å·¥å…·æ–¹æ³•\n- Booleanç±»å‹åè½¬ï¼Œç©ºæŒ‡é’ˆå®‰å…¨ï¼Œå‚ä¸ä½è¿ç®—\n- ä¸¤ä¸ªcharä¹‹é—´çš„equals\n- å®‰å…¨çš„åŠ å‡ä¹˜é™¤|sd\n- å¯¹Javaé›†åˆ( Collectionsï¼‰çš„å¢å¼ºæ”¯æŒ\n- æ•°å€¼å¯åŠ ä¸‹åˆ’çº¿\n- æ”¯æŒäºŒè¿›åˆ¶æ•°å­—\n- åœ¨try/catchå¼‚å¸¸æ‰‘æ‰ä¸­ï¼Œä¸€ä¸ªcatchå¯ä»¥å†™å¤šä¸ªå¼‚å¸¸ç±»å‹ç”¨|éš”å¼€\n- å¯ä»¥ä¸å¿…è¦å†™finallyè¯­å¥æ¥å…³é—­èµ„æºï¼Œåªè¦ä½ åœ¨try()çš„æ‹¬å·å†…éƒ¨å®šä¹‰è¦ä½¿ç”¨çš„èµ„æº\n\n**JDK8æ–°ç‰¹æ€§**\n\n- æ¥å£çš„é»˜è®¤æ–¹æ³•\n- Lambdaè¡¨è¾¾å¼\n- å‡½æ•°å¼æ¥å£\n- æ–¹æ³•ä¸æ„é€ å‡½æ•°å¼•ç”¨\n- æ‰©å±•äº†é›†åˆç±»\n- æ–°çš„Date API\n- Annotationå¤šé‡æ³¨è§£\n- streamsï¼ˆæµï¼‰\n- parallel streams(å¹¶è¡Œæµ)\n- Mapæ•°æ®ç»“æ„æ”¹è¿›\n\n**JDK9æ–°ç‰¹æ€§**\n\n- Jigsawæ¨¡å—åŒ–é¡¹ç›®\n- ç®€åŒ–è¿›ç¨‹API\n- è½»é‡çº§JSON API\n- é’±å’Œè´§å¸çš„API\n- æ”¹å–„é”ç«äº‰æœºåˆ¶\n- ä»£ç åˆ†æ®µç¼“å­˜\n- æ™ºèƒ½javaç¼–è¯‘\n- http2.0å®¢æˆ·ç«¯\n- kullaè®¡åˆ’\n\n**JDK10æ–°ç‰¹æ€§**\n\n- å±€éƒ¨å˜é‡çš„ç±»å‹æ¨æ–­\n- GCæ”¹è¿›å’Œå†…å­˜ç®¡ç†\n- çº¿ç¨‹æœ¬åœ°æ¡æ‰‹\n- å¤‡ç”¨å†…å­˜è®¾å¤‡ä¸Šçš„å †åˆ†é…\n- å…¶ä»–Unicodeè¯­è¨€ - æ ‡è®°æ‰©å±•\n- åŸºäºJavaçš„å®éªŒæ€§JITç¼–è¯‘å™¨\n- å¼€æºæ ¹è¯ä¹¦\n- æ ¹è¯ä¹¦é¢å‘è®¤è¯ï¼ˆCAï¼‰\n- å°†JDKç”Ÿæ€æ•´åˆå•ä¸ªå­˜å‚¨åº“\n- åˆ é™¤å·¥å…·javah\n\næ€ä¹ˆæ ·ï¼Œè¿™äº›æ–°ç‰¹æ€§éƒ½çŸ¥é“å¤šå°‘ï¼Ÿéƒ½ç”¨è¿‡å¤šå°‘ï¼Ÿå¤šå­¦ä¹ è¿™äº›æ–°ç‰¹æ€§ï¼Œå¯¹å†™ä»£ç çš„æ•ˆç‡ã€é€¼æ ¼ã€æŠ€èƒ½æˆé•¿ã€å°±ä¸šè¿˜æ˜¯ä¼šå¾ˆæœ‰å¸®åŠ©çš„ã€‚\n\n","slug":"æ–°ç‰¹æ€§/Java 5 ~ 10 æ–°ç‰¹æ€§å€¾æƒ…æ•´ç†ï¼","published":1,"updated":"2025-10-15T07:20:51.376Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076a0007qkd413e6bn54","content":"<p>æœ€è¿‘è¿ JDK11éƒ½åœ¨å‡†å¤‡å‘å¸ƒçš„è·¯ä¸Šäº†ï¼Œå¤§å®¶éƒ½æ•´æ˜ç™½äº†å—ï¼Ÿä¹Ÿè®¸ç°åœ¨å¤§éƒ¨åˆ†äººè¿˜åœ¨ç”¨6-8ï¼Œ8çš„æ–°ç‰¹æ€§éƒ½æ²¡ç”¨ç†Ÿï¼Œ9åˆšå‡ºä¸ä¹…ï¼Œ10-11å°±ä¸ç”¨è¯´äº†ã€‚</p>\n<p>ä¸ºäº†å¤§å®¶å¯¹JDKæœ‰ä¸€ä¸ªå…¨é¢çš„äº†è§£ï¼Œä¸‹é¢æˆ‘ä¸ºå¤§å®¶æ•´ç†äº†JDK5~10çš„æ‰€æœ‰å…³é”®æ–°ç‰¹æ€§ï¼</p>\n<p><strong>JDK5æ–°ç‰¹æ€§</strong></p>\n<ul>\n<li>è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±</li>\n<li>æšä¸¾</li>\n<li>é™æ€å¯¼å…¥</li>\n<li>å¯å˜å‚æ•°ï¼ˆVarargsï¼‰</li>\n<li>å†…çœï¼ˆintrospectorï¼‰</li>\n<li>æ³›å‹ï¼ˆGenericï¼‰</li>\n<li>For-Eachå¾ªç¯</li>\n</ul>\n<p><strong>JDK6æ–°ç‰¹æ€§</strong></p>\n<ul>\n<li>Desktopç±»å’ŒSystemTrayç±»</li>\n<li>ä½¿ç”¨JAXB2æ¥å®ç°å¯¹è±¡ä¸XMLä¹‹é—´çš„æ˜ å°„</li>\n<li>ç†è§£STAX</li>\n<li>ä½¿ç”¨Compiler API</li>\n<li>è½»é‡çº§ Http Server API</li>\n<li>æ’å…¥å¼æ³¨è§£å¤„ç† API</li>\n<li>ä½¿ç”¨Consoleå¼€å‘æ§åˆ¶å°ç¨‹åº</li>\n<li>å¯¹è„šæœ¬è¯­è¨€çš„æ”¯æŒ</li>\n<li>Common Annotations</li>\n<li>Java GUIç•Œé¢çš„æ˜¾ç¤º</li>\n<li>åµŒå…¥å¼æ•°æ®åº“Derby</li>\n<li>WebæœåŠ¡å…ƒæ•°æ®</li>\n<li>Jtableçš„æ’åºå’Œè¿‡æ»¤</li>\n<li>æ›´ç®€å•æ›´å¼ºå¤§çš„JAX-WS</li>\n</ul>\n<p><strong>JDK7æ–°ç‰¹æ€§</strong></p>\n<ul>\n<li>switchä¸­å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²äº†</li>\n<li>æ³›å‹å®ä¾‹åŒ–ç±»å‹è‡ªåŠ¨æ¨æ–­</li>\n<li>è‡ªå®šä¹‰è‡ªåŠ¨å…³é—­ç±»</li>\n<li>æ–°å¢ä¸€äº›è¯»å–ç¯å¢ƒä¿¡æ¯çš„å·¥å…·æ–¹æ³•</li>\n<li>Booleanç±»å‹åè½¬ï¼Œç©ºæŒ‡é’ˆå®‰å…¨ï¼Œå‚ä¸ä½è¿ç®—</li>\n<li>ä¸¤ä¸ªcharä¹‹é—´çš„equals</li>\n<li>å®‰å…¨çš„åŠ å‡ä¹˜é™¤|sd</li>\n<li>å¯¹Javaé›†åˆ( Collectionsï¼‰çš„å¢å¼ºæ”¯æŒ</li>\n<li>æ•°å€¼å¯åŠ ä¸‹åˆ’çº¿</li>\n<li>æ”¯æŒäºŒè¿›åˆ¶æ•°å­—</li>\n<li>åœ¨try&#x2F;catchå¼‚å¸¸æ‰‘æ‰ä¸­ï¼Œä¸€ä¸ªcatchå¯ä»¥å†™å¤šä¸ªå¼‚å¸¸ç±»å‹ç”¨|éš”å¼€</li>\n<li>å¯ä»¥ä¸å¿…è¦å†™finallyè¯­å¥æ¥å…³é—­èµ„æºï¼Œåªè¦ä½ åœ¨try()çš„æ‹¬å·å†…éƒ¨å®šä¹‰è¦ä½¿ç”¨çš„èµ„æº</li>\n</ul>\n<p><strong>JDK8æ–°ç‰¹æ€§</strong></p>\n<ul>\n<li>æ¥å£çš„é»˜è®¤æ–¹æ³•</li>\n<li>Lambdaè¡¨è¾¾å¼</li>\n<li>å‡½æ•°å¼æ¥å£</li>\n<li>æ–¹æ³•ä¸æ„é€ å‡½æ•°å¼•ç”¨</li>\n<li>æ‰©å±•äº†é›†åˆç±»</li>\n<li>æ–°çš„Date API</li>\n<li>Annotationå¤šé‡æ³¨è§£</li>\n<li>streamsï¼ˆæµï¼‰</li>\n<li>parallel streams(å¹¶è¡Œæµ)</li>\n<li>Mapæ•°æ®ç»“æ„æ”¹è¿›</li>\n</ul>\n<p><strong>JDK9æ–°ç‰¹æ€§</strong></p>\n<ul>\n<li>Jigsawæ¨¡å—åŒ–é¡¹ç›®</li>\n<li>ç®€åŒ–è¿›ç¨‹API</li>\n<li>è½»é‡çº§JSON API</li>\n<li>é’±å’Œè´§å¸çš„API</li>\n<li>æ”¹å–„é”ç«äº‰æœºåˆ¶</li>\n<li>ä»£ç åˆ†æ®µç¼“å­˜</li>\n<li>æ™ºèƒ½javaç¼–è¯‘</li>\n<li>http2.0å®¢æˆ·ç«¯</li>\n<li>kullaè®¡åˆ’</li>\n</ul>\n<p><strong>JDK10æ–°ç‰¹æ€§</strong></p>\n<ul>\n<li>å±€éƒ¨å˜é‡çš„ç±»å‹æ¨æ–­</li>\n<li>GCæ”¹è¿›å’Œå†…å­˜ç®¡ç†</li>\n<li>çº¿ç¨‹æœ¬åœ°æ¡æ‰‹</li>\n<li>å¤‡ç”¨å†…å­˜è®¾å¤‡ä¸Šçš„å †åˆ†é…</li>\n<li>å…¶ä»–Unicodeè¯­è¨€ - æ ‡è®°æ‰©å±•</li>\n<li>åŸºäºJavaçš„å®éªŒæ€§JITç¼–è¯‘å™¨</li>\n<li>å¼€æºæ ¹è¯ä¹¦</li>\n<li>æ ¹è¯ä¹¦é¢å‘è®¤è¯ï¼ˆCAï¼‰</li>\n<li>å°†JDKç”Ÿæ€æ•´åˆå•ä¸ªå­˜å‚¨åº“</li>\n<li>åˆ é™¤å·¥å…·javah</li>\n</ul>\n<p>æ€ä¹ˆæ ·ï¼Œè¿™äº›æ–°ç‰¹æ€§éƒ½çŸ¥é“å¤šå°‘ï¼Ÿéƒ½ç”¨è¿‡å¤šå°‘ï¼Ÿå¤šå­¦ä¹ è¿™äº›æ–°ç‰¹æ€§ï¼Œå¯¹å†™ä»£ç çš„æ•ˆç‡ã€é€¼æ ¼ã€æŠ€èƒ½æˆé•¿ã€å°±ä¸šè¿˜æ˜¯ä¼šå¾ˆæœ‰å¸®åŠ©çš„ã€‚</p>\n","excerpt":"","more":"<p>æœ€è¿‘è¿ JDK11éƒ½åœ¨å‡†å¤‡å‘å¸ƒçš„è·¯ä¸Šäº†ï¼Œå¤§å®¶éƒ½æ•´æ˜ç™½äº†å—ï¼Ÿä¹Ÿè®¸ç°åœ¨å¤§éƒ¨åˆ†äººè¿˜åœ¨ç”¨6-8ï¼Œ8çš„æ–°ç‰¹æ€§éƒ½æ²¡ç”¨ç†Ÿï¼Œ9åˆšå‡ºä¸ä¹…ï¼Œ10-11å°±ä¸ç”¨è¯´äº†ã€‚</p>\n<p>ä¸ºäº†å¤§å®¶å¯¹JDKæœ‰ä¸€ä¸ªå…¨é¢çš„äº†è§£ï¼Œä¸‹é¢æˆ‘ä¸ºå¤§å®¶æ•´ç†äº†JDK5~10çš„æ‰€æœ‰å…³é”®æ–°ç‰¹æ€§ï¼</p>\n<p><strong>JDK5æ–°ç‰¹æ€§</strong></p>\n<ul>\n<li>è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±</li>\n<li>æšä¸¾</li>\n<li>é™æ€å¯¼å…¥</li>\n<li>å¯å˜å‚æ•°ï¼ˆVarargsï¼‰</li>\n<li>å†…çœï¼ˆintrospectorï¼‰</li>\n<li>æ³›å‹ï¼ˆGenericï¼‰</li>\n<li>For-Eachå¾ªç¯</li>\n</ul>\n<p><strong>JDK6æ–°ç‰¹æ€§</strong></p>\n<ul>\n<li>Desktopç±»å’ŒSystemTrayç±»</li>\n<li>ä½¿ç”¨JAXB2æ¥å®ç°å¯¹è±¡ä¸XMLä¹‹é—´çš„æ˜ å°„</li>\n<li>ç†è§£STAX</li>\n<li>ä½¿ç”¨Compiler API</li>\n<li>è½»é‡çº§ Http Server API</li>\n<li>æ’å…¥å¼æ³¨è§£å¤„ç† API</li>\n<li>ä½¿ç”¨Consoleå¼€å‘æ§åˆ¶å°ç¨‹åº</li>\n<li>å¯¹è„šæœ¬è¯­è¨€çš„æ”¯æŒ</li>\n<li>Common Annotations</li>\n<li>Java GUIç•Œé¢çš„æ˜¾ç¤º</li>\n<li>åµŒå…¥å¼æ•°æ®åº“Derby</li>\n<li>WebæœåŠ¡å…ƒæ•°æ®</li>\n<li>Jtableçš„æ’åºå’Œè¿‡æ»¤</li>\n<li>æ›´ç®€å•æ›´å¼ºå¤§çš„JAX-WS</li>\n</ul>\n<p><strong>JDK7æ–°ç‰¹æ€§</strong></p>\n<ul>\n<li>switchä¸­å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²äº†</li>\n<li>æ³›å‹å®ä¾‹åŒ–ç±»å‹è‡ªåŠ¨æ¨æ–­</li>\n<li>è‡ªå®šä¹‰è‡ªåŠ¨å…³é—­ç±»</li>\n<li>æ–°å¢ä¸€äº›è¯»å–ç¯å¢ƒä¿¡æ¯çš„å·¥å…·æ–¹æ³•</li>\n<li>Booleanç±»å‹åè½¬ï¼Œç©ºæŒ‡é’ˆå®‰å…¨ï¼Œå‚ä¸ä½è¿ç®—</li>\n<li>ä¸¤ä¸ªcharä¹‹é—´çš„equals</li>\n<li>å®‰å…¨çš„åŠ å‡ä¹˜é™¤|sd</li>\n<li>å¯¹Javaé›†åˆ( Collectionsï¼‰çš„å¢å¼ºæ”¯æŒ</li>\n<li>æ•°å€¼å¯åŠ ä¸‹åˆ’çº¿</li>\n<li>æ”¯æŒäºŒè¿›åˆ¶æ•°å­—</li>\n<li>åœ¨try&#x2F;catchå¼‚å¸¸æ‰‘æ‰ä¸­ï¼Œä¸€ä¸ªcatchå¯ä»¥å†™å¤šä¸ªå¼‚å¸¸ç±»å‹ç”¨|éš”å¼€</li>\n<li>å¯ä»¥ä¸å¿…è¦å†™finallyè¯­å¥æ¥å…³é—­èµ„æºï¼Œåªè¦ä½ åœ¨try()çš„æ‹¬å·å†…éƒ¨å®šä¹‰è¦ä½¿ç”¨çš„èµ„æº</li>\n</ul>\n<p><strong>JDK8æ–°ç‰¹æ€§</strong></p>\n<ul>\n<li>æ¥å£çš„é»˜è®¤æ–¹æ³•</li>\n<li>Lambdaè¡¨è¾¾å¼</li>\n<li>å‡½æ•°å¼æ¥å£</li>\n<li>æ–¹æ³•ä¸æ„é€ å‡½æ•°å¼•ç”¨</li>\n<li>æ‰©å±•äº†é›†åˆç±»</li>\n<li>æ–°çš„Date API</li>\n<li>Annotationå¤šé‡æ³¨è§£</li>\n<li>streamsï¼ˆæµï¼‰</li>\n<li>parallel streams(å¹¶è¡Œæµ)</li>\n<li>Mapæ•°æ®ç»“æ„æ”¹è¿›</li>\n</ul>\n<p><strong>JDK9æ–°ç‰¹æ€§</strong></p>\n<ul>\n<li>Jigsawæ¨¡å—åŒ–é¡¹ç›®</li>\n<li>ç®€åŒ–è¿›ç¨‹API</li>\n<li>è½»é‡çº§JSON API</li>\n<li>é’±å’Œè´§å¸çš„API</li>\n<li>æ”¹å–„é”ç«äº‰æœºåˆ¶</li>\n<li>ä»£ç åˆ†æ®µç¼“å­˜</li>\n<li>æ™ºèƒ½javaç¼–è¯‘</li>\n<li>http2.0å®¢æˆ·ç«¯</li>\n<li>kullaè®¡åˆ’</li>\n</ul>\n<p><strong>JDK10æ–°ç‰¹æ€§</strong></p>\n<ul>\n<li>å±€éƒ¨å˜é‡çš„ç±»å‹æ¨æ–­</li>\n<li>GCæ”¹è¿›å’Œå†…å­˜ç®¡ç†</li>\n<li>çº¿ç¨‹æœ¬åœ°æ¡æ‰‹</li>\n<li>å¤‡ç”¨å†…å­˜è®¾å¤‡ä¸Šçš„å †åˆ†é…</li>\n<li>å…¶ä»–Unicodeè¯­è¨€ - æ ‡è®°æ‰©å±•</li>\n<li>åŸºäºJavaçš„å®éªŒæ€§JITç¼–è¯‘å™¨</li>\n<li>å¼€æºæ ¹è¯ä¹¦</li>\n<li>æ ¹è¯ä¹¦é¢å‘è®¤è¯ï¼ˆCAï¼‰</li>\n<li>å°†JDKç”Ÿæ€æ•´åˆå•ä¸ªå­˜å‚¨åº“</li>\n<li>åˆ é™¤å·¥å…·javah</li>\n</ul>\n<p>æ€ä¹ˆæ ·ï¼Œè¿™äº›æ–°ç‰¹æ€§éƒ½çŸ¥é“å¤šå°‘ï¼Ÿéƒ½ç”¨è¿‡å¤šå°‘ï¼Ÿå¤šå­¦ä¹ è¿™äº›æ–°ç‰¹æ€§ï¼Œå¯¹å†™ä»£ç çš„æ•ˆç‡ã€é€¼æ ¼ã€æŠ€èƒ½æˆé•¿ã€å°±ä¸šè¿˜æ˜¯ä¼šå¾ˆæœ‰å¸®åŠ©çš„ã€‚</p>\n"},{"title":"Java ä¸­çš„ String çœŸçš„æ˜¯ä¸å¯å˜å—ï¼Ÿ","date":"2025-10-15T03:36:33.000Z","_content":"\næˆ‘ä»¬éƒ½çŸ¥é“ Java ä¸­çš„ String ç±»çš„è®¾è®¡æ˜¯ä¸å¯å˜çš„ï¼Œæ¥çœ‹ä¸‹ String ç±»çš„æºç ã€‚\n\n```\npublic final class String\n    implements java.io.Serializable, Comparable<String>, CharSequence {\n    \n    /** The value is used for character storage. */\n    private final char value[];\n    \n    /** Cache the hash code for the string */\n    private int hash; // Default to 0\n    \n    // ...\n    \n}\n```\n\nå¯ä»¥çœ‹å‡º String ç±»æ˜¯ final ç±»å‹çš„ï¼ŒString ä¸èƒ½è¢«ç»§æ‰¿ã€‚å…¶å€¼ value ä¹Ÿå°±æ˜¯å¯¹å­—ç¬¦æ•°ç»„çš„å°è£…ï¼Œå³ char[]ï¼Œå…¶å€¼è¢«å®šä¹‰æˆ private final çš„ï¼Œè¯´æ˜ä¸èƒ½é€šè¿‡å¤–ç•Œä¿®æ”¹ï¼Œå³ä¸å¯å˜ã€‚\n\n### String çœŸçš„ \"ä¸å¯å˜ \" å—ï¼Ÿ\n\næ¥çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ã€‚\n\n```\nString str = \"Python\";\nSystem.out.println(str); // Python\n\nstr = \"Java\";\nSystem.out.println(str); // Java\n\nstr = str.substring(1);\nSystem.out.println(str); // ava\n```\n\n**ä½ æœ‰å¯èƒ½ä¼šé—®ï¼šstr ä¸æ˜¯ç”± Python å˜æˆ Java äº†å—ï¼Ÿç„¶åé€šè¿‡ substring æ–¹æ³•å˜æˆ ava äº†å—ï¼Ÿ**\n\nè¿™å…¶å®æ˜¯åˆå­¦è€…çš„ä¸€ä¸ªè¯¯åŒºï¼Œä»ä¸Šé¢çœ‹ String çš„ç»“æ„å¯ä»¥å¾—çŸ¥å­—ç¬¦ä¸²æ˜¯ç”±å­—ç¬¦æ•°ç»„æ„æˆçš„ï¼Œstr åªæ˜¯ä¸€ä¸ªå¼•ç”¨è€Œå·²ï¼Œç¬¬ä¸€æ¬¡å¼•ç”¨äº† \"Python\"ï¼Œåé¢å˜æˆäº† \"Java\"ï¼Œè€Œ substring ä¹Ÿæ˜¯ç”¨ Arrays.copyOfRange æ–¹æ³•é‡æ–°å¤åˆ¶å­—ç¬¦æ•°ç»„æ„é€ äº†ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ã€‚\n\n![](http://img.javastack.cn/18-9-12/688492.jpg)\n\næ‰€ä»¥è¯´ï¼Œè¿™é‡Œçš„å­—ç¬¦ä¸²å¹¶ä¸æ˜¯å¯å˜ï¼Œåªæ˜¯å˜æ›´äº†å­—ç¬¦ä¸²å¼•ç”¨ã€‚\n\nå…³äº substring åœ¨ JDK å„ä¸ªç‰ˆæœ¬çš„å·®å¼‚å¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« ã€Š[æ³¨æ„ï¼šå­—ç¬¦ä¸²substringæ–¹æ³•åœ¨jkd6,7,8ä¸­çš„å·®å¼‚](https://mp.weixin.qq.com/s/3KrBept61jDAtheR27gFJA)ã€‹ï¼Œä¹Ÿå¯ä»¥å»çœ‹ substring çš„å„ä¸ªç‰ˆæœ¬çš„æºç ã€‚\n\n### String çœŸçš„çœŸçš„çœŸçš„ \"ä¸å¯å˜ \" å—ï¼Ÿ\n\nä¸Šé¢çš„ä¾‹å­è‚¯å®šæ˜¯ä¸å¯å˜çš„ï¼Œä¸‹é¢è¿™ä¸ªå°±å°´å°¬äº†ã€‚\n\n```\nString str = \"Hello Python\";\nSystem.out.println(str); // Hello Python\n\nField field = String.class.getDeclaredField(\"value\");\nfield.setAccessible(true);\n\nchar[] value = (char[])field.get(str);\nvalue[6] = 'J';\nvalue[7] = 'a';\nvalue[8] = 'v';\nvalue[9] = 'a';\nvalue[10] = '!';\nvalue[11] = '!';\nSystem.out.println(str); // Hello Java!!\n```\n\né€šè¿‡åå°„ï¼Œæˆ‘ä»¬æ”¹å˜äº†åº•å±‚çš„å­—ç¬¦æ•°ç»„çš„å€¼ï¼Œå®ç°äº†å­—ç¬¦ä¸²çš„ â€œä¸å¯å˜â€ æ€§ï¼Œè¿™æ˜¯ä¸€ç§éªšæ“ä½œï¼Œä¸å»ºè®®è¿™ä¹ˆä½¿ç”¨ï¼Œè¿åäº† Java å¯¹ String ç±»çš„ä¸å¯å˜è®¾è®¡åŸåˆ™ï¼Œä¼šé€ æˆä¸€äº›å®‰å…¨é—®é¢˜ã€‚\n\næ˜¯ä¸æ˜¯åˆæ¶¨å§¿åŠ¿äº†ï¼Ÿåˆ†äº«ç»™ä½ çš„æœ‹å‹ä»¬å§ï¼\n\n","source":"_posts/è¿›é˜¶/Java ä¸­çš„ String çœŸçš„æ˜¯ä¸å¯å˜å—ï¼Ÿ.md","raw":"---\ntitle: Java ä¸­çš„ String çœŸçš„æ˜¯ä¸å¯å˜å—ï¼Ÿ\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: è¿›é˜¶\n---\n\næˆ‘ä»¬éƒ½çŸ¥é“ Java ä¸­çš„ String ç±»çš„è®¾è®¡æ˜¯ä¸å¯å˜çš„ï¼Œæ¥çœ‹ä¸‹ String ç±»çš„æºç ã€‚\n\n```\npublic final class String\n    implements java.io.Serializable, Comparable<String>, CharSequence {\n    \n    /** The value is used for character storage. */\n    private final char value[];\n    \n    /** Cache the hash code for the string */\n    private int hash; // Default to 0\n    \n    // ...\n    \n}\n```\n\nå¯ä»¥çœ‹å‡º String ç±»æ˜¯ final ç±»å‹çš„ï¼ŒString ä¸èƒ½è¢«ç»§æ‰¿ã€‚å…¶å€¼ value ä¹Ÿå°±æ˜¯å¯¹å­—ç¬¦æ•°ç»„çš„å°è£…ï¼Œå³ char[]ï¼Œå…¶å€¼è¢«å®šä¹‰æˆ private final çš„ï¼Œè¯´æ˜ä¸èƒ½é€šè¿‡å¤–ç•Œä¿®æ”¹ï¼Œå³ä¸å¯å˜ã€‚\n\n### String çœŸçš„ \"ä¸å¯å˜ \" å—ï¼Ÿ\n\næ¥çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ã€‚\n\n```\nString str = \"Python\";\nSystem.out.println(str); // Python\n\nstr = \"Java\";\nSystem.out.println(str); // Java\n\nstr = str.substring(1);\nSystem.out.println(str); // ava\n```\n\n**ä½ æœ‰å¯èƒ½ä¼šé—®ï¼šstr ä¸æ˜¯ç”± Python å˜æˆ Java äº†å—ï¼Ÿç„¶åé€šè¿‡ substring æ–¹æ³•å˜æˆ ava äº†å—ï¼Ÿ**\n\nè¿™å…¶å®æ˜¯åˆå­¦è€…çš„ä¸€ä¸ªè¯¯åŒºï¼Œä»ä¸Šé¢çœ‹ String çš„ç»“æ„å¯ä»¥å¾—çŸ¥å­—ç¬¦ä¸²æ˜¯ç”±å­—ç¬¦æ•°ç»„æ„æˆçš„ï¼Œstr åªæ˜¯ä¸€ä¸ªå¼•ç”¨è€Œå·²ï¼Œç¬¬ä¸€æ¬¡å¼•ç”¨äº† \"Python\"ï¼Œåé¢å˜æˆäº† \"Java\"ï¼Œè€Œ substring ä¹Ÿæ˜¯ç”¨ Arrays.copyOfRange æ–¹æ³•é‡æ–°å¤åˆ¶å­—ç¬¦æ•°ç»„æ„é€ äº†ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ã€‚\n\n![](http://img.javastack.cn/18-9-12/688492.jpg)\n\næ‰€ä»¥è¯´ï¼Œè¿™é‡Œçš„å­—ç¬¦ä¸²å¹¶ä¸æ˜¯å¯å˜ï¼Œåªæ˜¯å˜æ›´äº†å­—ç¬¦ä¸²å¼•ç”¨ã€‚\n\nå…³äº substring åœ¨ JDK å„ä¸ªç‰ˆæœ¬çš„å·®å¼‚å¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« ã€Š[æ³¨æ„ï¼šå­—ç¬¦ä¸²substringæ–¹æ³•åœ¨jkd6,7,8ä¸­çš„å·®å¼‚](https://mp.weixin.qq.com/s/3KrBept61jDAtheR27gFJA)ã€‹ï¼Œä¹Ÿå¯ä»¥å»çœ‹ substring çš„å„ä¸ªç‰ˆæœ¬çš„æºç ã€‚\n\n### String çœŸçš„çœŸçš„çœŸçš„ \"ä¸å¯å˜ \" å—ï¼Ÿ\n\nä¸Šé¢çš„ä¾‹å­è‚¯å®šæ˜¯ä¸å¯å˜çš„ï¼Œä¸‹é¢è¿™ä¸ªå°±å°´å°¬äº†ã€‚\n\n```\nString str = \"Hello Python\";\nSystem.out.println(str); // Hello Python\n\nField field = String.class.getDeclaredField(\"value\");\nfield.setAccessible(true);\n\nchar[] value = (char[])field.get(str);\nvalue[6] = 'J';\nvalue[7] = 'a';\nvalue[8] = 'v';\nvalue[9] = 'a';\nvalue[10] = '!';\nvalue[11] = '!';\nSystem.out.println(str); // Hello Java!!\n```\n\né€šè¿‡åå°„ï¼Œæˆ‘ä»¬æ”¹å˜äº†åº•å±‚çš„å­—ç¬¦æ•°ç»„çš„å€¼ï¼Œå®ç°äº†å­—ç¬¦ä¸²çš„ â€œä¸å¯å˜â€ æ€§ï¼Œè¿™æ˜¯ä¸€ç§éªšæ“ä½œï¼Œä¸å»ºè®®è¿™ä¹ˆä½¿ç”¨ï¼Œè¿åäº† Java å¯¹ String ç±»çš„ä¸å¯å˜è®¾è®¡åŸåˆ™ï¼Œä¼šé€ æˆä¸€äº›å®‰å…¨é—®é¢˜ã€‚\n\næ˜¯ä¸æ˜¯åˆæ¶¨å§¿åŠ¿äº†ï¼Ÿåˆ†äº«ç»™ä½ çš„æœ‹å‹ä»¬å§ï¼\n\n","slug":"è¿›é˜¶/Java ä¸­çš„ String çœŸçš„æ˜¯ä¸å¯å˜å—ï¼Ÿ","published":1,"updated":"2025-10-15T07:21:14.230Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076b0008qkd4ht4ig6e4","content":"<p>æˆ‘ä»¬éƒ½çŸ¥é“ Java ä¸­çš„ String ç±»çš„è®¾è®¡æ˜¯ä¸å¯å˜çš„ï¼Œæ¥çœ‹ä¸‹ String ç±»çš„æºç ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public final class String\n    implements java.io.Serializable, Comparable&lt;String&gt;, CharSequence &#123;\n    \n    &#x2F;** The value is used for character storage. *&#x2F;\n    private final char value[];\n    \n    &#x2F;** Cache the hash code for the string *&#x2F;\n    private int hash; &#x2F;&#x2F; Default to 0\n    \n    &#x2F;&#x2F; ...\n    \n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥çœ‹å‡º String ç±»æ˜¯ final ç±»å‹çš„ï¼ŒString ä¸èƒ½è¢«ç»§æ‰¿ã€‚å…¶å€¼ value ä¹Ÿå°±æ˜¯å¯¹å­—ç¬¦æ•°ç»„çš„å°è£…ï¼Œå³ char[]ï¼Œå…¶å€¼è¢«å®šä¹‰æˆ private final çš„ï¼Œè¯´æ˜ä¸èƒ½é€šè¿‡å¤–ç•Œä¿®æ”¹ï¼Œå³ä¸å¯å˜ã€‚</p>\n<h3 id=\"String-çœŸçš„-â€œä¸å¯å˜-â€œ-å—ï¼Ÿ\"><a href=\"#String-çœŸçš„-â€œä¸å¯å˜-â€œ-å—ï¼Ÿ\" class=\"headerlink\" title=\"String çœŸçš„ â€œä¸å¯å˜ â€œ å—ï¼Ÿ\"></a>String çœŸçš„ â€œä¸å¯å˜ â€œ å—ï¼Ÿ</h3><p>æ¥çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">String str &#x3D; &quot;Python&quot;;\nSystem.out.println(str); &#x2F;&#x2F; Python\n\nstr &#x3D; &quot;Java&quot;;\nSystem.out.println(str); &#x2F;&#x2F; Java\n\nstr &#x3D; str.substring(1);\nSystem.out.println(str); &#x2F;&#x2F; ava<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>ä½ æœ‰å¯èƒ½ä¼šé—®ï¼šstr ä¸æ˜¯ç”± Python å˜æˆ Java äº†å—ï¼Ÿç„¶åé€šè¿‡ substring æ–¹æ³•å˜æˆ ava äº†å—ï¼Ÿ</strong></p>\n<p>è¿™å…¶å®æ˜¯åˆå­¦è€…çš„ä¸€ä¸ªè¯¯åŒºï¼Œä»ä¸Šé¢çœ‹ String çš„ç»“æ„å¯ä»¥å¾—çŸ¥å­—ç¬¦ä¸²æ˜¯ç”±å­—ç¬¦æ•°ç»„æ„æˆçš„ï¼Œstr åªæ˜¯ä¸€ä¸ªå¼•ç”¨è€Œå·²ï¼Œç¬¬ä¸€æ¬¡å¼•ç”¨äº† â€œPythonâ€ï¼Œåé¢å˜æˆäº† â€œJavaâ€ï¼Œè€Œ substring ä¹Ÿæ˜¯ç”¨ Arrays.copyOfRange æ–¹æ³•é‡æ–°å¤åˆ¶å­—ç¬¦æ•°ç»„æ„é€ äº†ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ã€‚</p>\n<p><img src=\"http://img.javastack.cn/18-9-12/688492.jpg\"></p>\n<p>æ‰€ä»¥è¯´ï¼Œè¿™é‡Œçš„å­—ç¬¦ä¸²å¹¶ä¸æ˜¯å¯å˜ï¼Œåªæ˜¯å˜æ›´äº†å­—ç¬¦ä¸²å¼•ç”¨ã€‚</p>\n<p>å…³äº substring åœ¨ JDK å„ä¸ªç‰ˆæœ¬çš„å·®å¼‚å¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« ã€Š<a href=\"https://mp.weixin.qq.com/s/3KrBept61jDAtheR27gFJA\">æ³¨æ„ï¼šå­—ç¬¦ä¸²substringæ–¹æ³•åœ¨jkd6,7,8ä¸­çš„å·®å¼‚</a>ã€‹ï¼Œä¹Ÿå¯ä»¥å»çœ‹ substring çš„å„ä¸ªç‰ˆæœ¬çš„æºç ã€‚</p>\n<h3 id=\"String-çœŸçš„çœŸçš„çœŸçš„-â€œä¸å¯å˜-â€œ-å—ï¼Ÿ\"><a href=\"#String-çœŸçš„çœŸçš„çœŸçš„-â€œä¸å¯å˜-â€œ-å—ï¼Ÿ\" class=\"headerlink\" title=\"String çœŸçš„çœŸçš„çœŸçš„ â€œä¸å¯å˜ â€œ å—ï¼Ÿ\"></a>String çœŸçš„çœŸçš„çœŸçš„ â€œä¸å¯å˜ â€œ å—ï¼Ÿ</h3><p>ä¸Šé¢çš„ä¾‹å­è‚¯å®šæ˜¯ä¸å¯å˜çš„ï¼Œä¸‹é¢è¿™ä¸ªå°±å°´å°¬äº†ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">String str &#x3D; &quot;Hello Python&quot;;\nSystem.out.println(str); &#x2F;&#x2F; Hello Python\n\nField field &#x3D; String.class.getDeclaredField(&quot;value&quot;);\nfield.setAccessible(true);\n\nchar[] value &#x3D; (char[])field.get(str);\nvalue[6] &#x3D; &#39;J&#39;;\nvalue[7] &#x3D; &#39;a&#39;;\nvalue[8] &#x3D; &#39;v&#39;;\nvalue[9] &#x3D; &#39;a&#39;;\nvalue[10] &#x3D; &#39;!&#39;;\nvalue[11] &#x3D; &#39;!&#39;;\nSystem.out.println(str); &#x2F;&#x2F; Hello Java!!<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>é€šè¿‡åå°„ï¼Œæˆ‘ä»¬æ”¹å˜äº†åº•å±‚çš„å­—ç¬¦æ•°ç»„çš„å€¼ï¼Œå®ç°äº†å­—ç¬¦ä¸²çš„ â€œä¸å¯å˜â€ æ€§ï¼Œè¿™æ˜¯ä¸€ç§éªšæ“ä½œï¼Œä¸å»ºè®®è¿™ä¹ˆä½¿ç”¨ï¼Œè¿åäº† Java å¯¹ String ç±»çš„ä¸å¯å˜è®¾è®¡åŸåˆ™ï¼Œä¼šé€ æˆä¸€äº›å®‰å…¨é—®é¢˜ã€‚</p>\n<p>æ˜¯ä¸æ˜¯åˆæ¶¨å§¿åŠ¿äº†ï¼Ÿåˆ†äº«ç»™ä½ çš„æœ‹å‹ä»¬å§ï¼</p>\n","excerpt":"","more":"<p>æˆ‘ä»¬éƒ½çŸ¥é“ Java ä¸­çš„ String ç±»çš„è®¾è®¡æ˜¯ä¸å¯å˜çš„ï¼Œæ¥çœ‹ä¸‹ String ç±»çš„æºç ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public final class String\n    implements java.io.Serializable, Comparable&lt;String&gt;, CharSequence &#123;\n    \n    &#x2F;** The value is used for character storage. *&#x2F;\n    private final char value[];\n    \n    &#x2F;** Cache the hash code for the string *&#x2F;\n    private int hash; &#x2F;&#x2F; Default to 0\n    \n    &#x2F;&#x2F; ...\n    \n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥çœ‹å‡º String ç±»æ˜¯ final ç±»å‹çš„ï¼ŒString ä¸èƒ½è¢«ç»§æ‰¿ã€‚å…¶å€¼ value ä¹Ÿå°±æ˜¯å¯¹å­—ç¬¦æ•°ç»„çš„å°è£…ï¼Œå³ char[]ï¼Œå…¶å€¼è¢«å®šä¹‰æˆ private final çš„ï¼Œè¯´æ˜ä¸èƒ½é€šè¿‡å¤–ç•Œä¿®æ”¹ï¼Œå³ä¸å¯å˜ã€‚</p>\n<h3 id=\"String-çœŸçš„-â€œä¸å¯å˜-â€œ-å—ï¼Ÿ\"><a href=\"#String-çœŸçš„-â€œä¸å¯å˜-â€œ-å—ï¼Ÿ\" class=\"headerlink\" title=\"String çœŸçš„ â€œä¸å¯å˜ â€œ å—ï¼Ÿ\"></a>String çœŸçš„ â€œä¸å¯å˜ â€œ å—ï¼Ÿ</h3><p>æ¥çœ‹ä¸‹é¢è¿™ä¸ªä¾‹å­ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">String str &#x3D; &quot;Python&quot;;\nSystem.out.println(str); &#x2F;&#x2F; Python\n\nstr &#x3D; &quot;Java&quot;;\nSystem.out.println(str); &#x2F;&#x2F; Java\n\nstr &#x3D; str.substring(1);\nSystem.out.println(str); &#x2F;&#x2F; ava<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>ä½ æœ‰å¯èƒ½ä¼šé—®ï¼šstr ä¸æ˜¯ç”± Python å˜æˆ Java äº†å—ï¼Ÿç„¶åé€šè¿‡ substring æ–¹æ³•å˜æˆ ava äº†å—ï¼Ÿ</strong></p>\n<p>è¿™å…¶å®æ˜¯åˆå­¦è€…çš„ä¸€ä¸ªè¯¯åŒºï¼Œä»ä¸Šé¢çœ‹ String çš„ç»“æ„å¯ä»¥å¾—çŸ¥å­—ç¬¦ä¸²æ˜¯ç”±å­—ç¬¦æ•°ç»„æ„æˆçš„ï¼Œstr åªæ˜¯ä¸€ä¸ªå¼•ç”¨è€Œå·²ï¼Œç¬¬ä¸€æ¬¡å¼•ç”¨äº† â€œPythonâ€ï¼Œåé¢å˜æˆäº† â€œJavaâ€ï¼Œè€Œ substring ä¹Ÿæ˜¯ç”¨ Arrays.copyOfRange æ–¹æ³•é‡æ–°å¤åˆ¶å­—ç¬¦æ•°ç»„æ„é€ äº†ä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ã€‚</p>\n<p><img src=\"http://img.javastack.cn/18-9-12/688492.jpg\"></p>\n<p>æ‰€ä»¥è¯´ï¼Œè¿™é‡Œçš„å­—ç¬¦ä¸²å¹¶ä¸æ˜¯å¯å˜ï¼Œåªæ˜¯å˜æ›´äº†å­—ç¬¦ä¸²å¼•ç”¨ã€‚</p>\n<p>å…³äº substring åœ¨ JDK å„ä¸ªç‰ˆæœ¬çš„å·®å¼‚å¯ä»¥çœ‹è¿™ç¯‡æ–‡ç« ã€Š<a href=\"https://mp.weixin.qq.com/s/3KrBept61jDAtheR27gFJA\">æ³¨æ„ï¼šå­—ç¬¦ä¸²substringæ–¹æ³•åœ¨jkd6,7,8ä¸­çš„å·®å¼‚</a>ã€‹ï¼Œä¹Ÿå¯ä»¥å»çœ‹ substring çš„å„ä¸ªç‰ˆæœ¬çš„æºç ã€‚</p>\n<h3 id=\"String-çœŸçš„çœŸçš„çœŸçš„-â€œä¸å¯å˜-â€œ-å—ï¼Ÿ\"><a href=\"#String-çœŸçš„çœŸçš„çœŸçš„-â€œä¸å¯å˜-â€œ-å—ï¼Ÿ\" class=\"headerlink\" title=\"String çœŸçš„çœŸçš„çœŸçš„ â€œä¸å¯å˜ â€œ å—ï¼Ÿ\"></a>String çœŸçš„çœŸçš„çœŸçš„ â€œä¸å¯å˜ â€œ å—ï¼Ÿ</h3><p>ä¸Šé¢çš„ä¾‹å­è‚¯å®šæ˜¯ä¸å¯å˜çš„ï¼Œä¸‹é¢è¿™ä¸ªå°±å°´å°¬äº†ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">String str &#x3D; &quot;Hello Python&quot;;\nSystem.out.println(str); &#x2F;&#x2F; Hello Python\n\nField field &#x3D; String.class.getDeclaredField(&quot;value&quot;);\nfield.setAccessible(true);\n\nchar[] value &#x3D; (char[])field.get(str);\nvalue[6] &#x3D; &#39;J&#39;;\nvalue[7] &#x3D; &#39;a&#39;;\nvalue[8] &#x3D; &#39;v&#39;;\nvalue[9] &#x3D; &#39;a&#39;;\nvalue[10] &#x3D; &#39;!&#39;;\nvalue[11] &#x3D; &#39;!&#39;;\nSystem.out.println(str); &#x2F;&#x2F; Hello Java!!<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>é€šè¿‡åå°„ï¼Œæˆ‘ä»¬æ”¹å˜äº†åº•å±‚çš„å­—ç¬¦æ•°ç»„çš„å€¼ï¼Œå®ç°äº†å­—ç¬¦ä¸²çš„ â€œä¸å¯å˜â€ æ€§ï¼Œè¿™æ˜¯ä¸€ç§éªšæ“ä½œï¼Œä¸å»ºè®®è¿™ä¹ˆä½¿ç”¨ï¼Œè¿åäº† Java å¯¹ String ç±»çš„ä¸å¯å˜è®¾è®¡åŸåˆ™ï¼Œä¼šé€ æˆä¸€äº›å®‰å…¨é—®é¢˜ã€‚</p>\n<p>æ˜¯ä¸æ˜¯åˆæ¶¨å§¿åŠ¿äº†ï¼Ÿåˆ†äº«ç»™ä½ çš„æœ‹å‹ä»¬å§ï¼</p>\n"},{"title":"Java ä¸­çš„ 6 é¢—è¯­æ³•ç³–","date":"2025-10-15T03:36:33.000Z","_content":"\n\nè¯­æ³•ç³–ï¼ˆSyntactic Sugarï¼‰ï¼Œä¹Ÿç§°ç³–è¡£è¯­æ³•ï¼ŒæŒ‡åœ¨è®¡ç®—æœºè¯­è¨€ä¸­æ·»åŠ çš„æŸç§è¯­æ³•ï¼Œè¿™ç§è¯­æ³•å¯¹è¯­è¨€æœ¬èº«åŠŸèƒ½æ¥è¯´æ²¡æœ‰ä»€ä¹ˆå½±å“ï¼Œåªæ˜¯ä¸ºäº†æ–¹ä¾¿ç¨‹åºå‘˜çš„å¼€å‘ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚è¯´ç™½äº†ï¼Œè¯­æ³•ç³–å°±æ˜¯å¯¹ç°æœ‰è¯­æ³•çš„ä¸€ä¸ªå°è£…ã€‚\n\nJavaä½œä¸ºä¸€ç§ä¸å¹³å°æ— å…³çš„é«˜çº§è¯­è¨€ï¼Œå½“ç„¶ä¹Ÿå«æœ‰è¯­æ³•ç³–ï¼Œè¿™äº›è¯­æ³•ç³–å¹¶ä¸è¢«è™šæ‹Ÿæœºæ‰€æ”¯æŒï¼Œåœ¨ç¼–è¯‘æˆå­—èŠ‚ç é˜¶æ®µå°±è‡ªåŠ¨è½¬æ¢æˆç®€å•å¸¸ç”¨è¯­æ³•ã€‚\n\n**ä¸€èˆ¬æ¥è¯´Javaä¸­çš„è¯­æ³•ç³–ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ï¼š** \n\n1. æ³›å‹ä¸ç±»å‹æ“¦é™¤ \n2. è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±\n3. å˜é•¿å‚æ•°\n4. å¢å¼ºforå¾ªç¯ \n5. å†…éƒ¨ç±»\n6. æšä¸¾ç±»\n\n**æ³›å‹ä¸ç±»å‹æ“¦é™¤**\n\nJavaè¯­è¨€å¹¶ä¸æ˜¯ä¸€å¼€å§‹å°±æ”¯æŒæ³›å‹çš„ã€‚åœ¨æ—©æœŸçš„JDKä¸­ï¼Œåªèƒ½é€šè¿‡Objectç±»æ˜¯æ‰€æœ‰ç±»å‹çš„çˆ¶ç±»å’Œå¼ºåˆ¶ç±»å‹è½¬æ¢æ¥å®ç°æ³›å‹çš„åŠŸèƒ½ã€‚å¼ºåˆ¶ç±»å‹è½¬æ¢çš„ç¼ºç‚¹å°±æ˜¯æŠŠç¼–è¯‘æœŸé—´çš„é—®é¢˜å»¶è¿Ÿåˆ°è¿è¡Œæ—¶ï¼ŒJVMå¹¶ä¸èƒ½ä¸ºæˆ‘ä»¬æä¾›ç¼–è¯‘æœŸé—´çš„æ£€æŸ¥ã€‚\n\nåœ¨JDK1.5ä¸­ï¼ŒJavaè¯­è¨€å¼•å…¥äº†æ³›å‹æœºåˆ¶ã€‚ä½†æ˜¯è¿™ç§æ³›å‹æœºåˆ¶æ˜¯é€šè¿‡ç±»å‹æ“¦é™¤æ¥å®ç°çš„ï¼Œå³Javaä¸­çš„æ³›å‹åªåœ¨ç¨‹åºæºä»£ç ä¸­æœ‰æ•ˆï¼ˆæºä»£ç é˜¶æ®µæä¾›ç±»å‹æ£€æŸ¥ï¼‰ï¼Œåœ¨ç¼–è¯‘åçš„å­—èŠ‚ç ä¸­è‡ªåŠ¨ç”¨å¼ºåˆ¶ç±»å‹è½¬æ¢è¿›è¡Œæ›¿ä»£ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒJavaè¯­è¨€ä¸­çš„æ³›å‹æœºåˆ¶å…¶å®å°±æ˜¯ä¸€é¢—è¯­æ³•ç³–ï¼Œç›¸è¾ƒä¸C++ã€C#ç›¸æ¯”ï¼Œå…¶æ³›å‹å®ç°å®åœ¨æ˜¯ä¸é‚£ä¹ˆä¼˜é›…ã€‚\n\n\n```\n/**\n* åœ¨æºä»£ç ä¸­å­˜åœ¨æ³›å‹\n*/\npublic static void main(String[] args) {\n    Map<String,String> map = new HashMap<String,String>();\n    map.put(\"hello\",\"ä½ å¥½\");\n    String hello = map.get(\"hello\");\n    System.out.println(hello);\n}\n```\n\nå½“ä¸Šè¿°æºä»£ç è¢«ç¼–è¯‘ä¸ºclassæ–‡ä»¶åï¼Œæ³›å‹è¢«æ“¦é™¤ä¸”å¼•å…¥å¼ºåˆ¶ç±»å‹è½¬æ¢\n\n\n```\npublic static void main(String[] args) {\n    HashMap map = new HashMap(); //ç±»å‹æ“¦é™¤\n    map.put(\"hello\", \"ä½ å¥½\");\n    String hello = (String)map.get(\"hello\");//å¼ºåˆ¶è½¬æ¢\n    System.out.println(hello);\n}\n```\n\n\n**è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±**\n\nJavaä¸­çš„è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±æŒ‡çš„æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ä¸ä»–ä»¬çš„åŒ…è£…ç±»å‹ä¹‹é—´çš„ç›¸äº’è½¬æ¢ã€‚\n\næˆ‘ä»¬çŸ¥é“Javaæ˜¯ä¸€é—¨é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œåœ¨Javaä¸–ç•Œä¸­æœ‰ä¸€å¥è¯æ˜¯è¿™ä¹ˆè¯´çš„ï¼šâ€œä¸‡ç‰©çš†å¯¹è±¡â€ã€‚ä½†æ˜¯Javaä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹å´ä¸æ˜¯å¯¹è±¡ï¼Œä»–ä»¬ä¸éœ€è¦è¿›è¡Œnewæ“ä½œï¼Œä¹Ÿä¸èƒ½è°ƒç”¨ä»»ä½•æ–¹æ³•ï¼Œè¿™åœ¨ä½¿ç”¨çš„æ—¶å€™æœ‰è¯¸å¤šä¸ä¾¿ã€‚å› æ­¤Javaä¸ºè¿™äº›åŸºæœ¬ç±»å‹æä¾›äº†åŒ…è£…ç±»ï¼Œå¹¶ä¸”ä¸ºäº†ä½¿ç”¨æ–¹ä¾¿ï¼Œæä¾›äº†è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±åŠŸèƒ½ã€‚è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œå…¶å®æ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œå†…éƒ¨è¿˜æ˜¯è°ƒç”¨äº†ç›¸åº”çš„å‡½æ•°è¿›è¡Œè½¬æ¢ã€‚\n\nä¸‹é¢ä»£ç æ¼”ç¤ºäº†è‡ªåŠ¨è£…ç®±å’Œæ‹†ç®±åŠŸèƒ½\n\n\n```\npublic static void main(String[] args) {\n    Integer a = 1;\n    int b = 2;\n    int c = a + b;\n    System.out.println(c);\n}\n```\n\nç»è¿‡ç¼–è¯‘åï¼Œä»£ç å¦‚ä¸‹\n\n\n```\npublic static void main(String[] args) {\n    Integer a = Integer.valueOf(1); // è‡ªåŠ¨è£…ç®±\n    byte b = 2;\n    int c = a.intValue() + b;//è‡ªåŠ¨æ‹†ç®±\n    System.out.println(c);\n}\n```\n\n**å˜é•¿å‚æ•°**\n\næ‰€è°“å˜é•¿å‚æ•°ï¼Œå°±æ˜¯æ–¹æ³•å¯ä»¥æ¥å—é•¿åº¦ä¸å®šç¡®å®šçš„å‚æ•°ã€‚å˜é•¿å‚æ•°ç‰¹æ€§æ˜¯åœ¨JDK1.5ä¸­å¼•å…¥çš„ï¼Œä½¿ç”¨å˜é•¿å‚æ•°æœ‰ä¸¤ä¸ªæ¡ä»¶ï¼Œä¸€æ˜¯å˜é•¿çš„é‚£ä¸€éƒ¨åˆ†å‚æ•°å…·æœ‰ç›¸åŒçš„ç±»å‹ï¼ŒäºŒæ˜¯å˜é•¿å‚æ•°å¿…é¡»ä½äºæ–¹æ³•å‚æ•°åˆ—è¡¨çš„æœ€åé¢ã€‚å˜é•¿å‚æ•°åŒæ ·æ˜¯Javaä¸­çš„è¯­æ³•ç³–ï¼Œå…¶å†…éƒ¨å®ç°æ˜¯Javaæ•°ç»„ã€‚\n\n\n```\npublic class Varargs {\n    public static void print(String... args) {\n        for(String str : args){\n            System.out.println(str);\n        }\n    }\n\n    public static void main(String[] args) {\n        print(\"hello\", \"world\");\n    }\n}\n```\n\nç¼–è¯‘ä¸ºclassæ–‡ä»¶åå¦‚ä¸‹ï¼Œä»ä¸­å¯ä»¥å¾ˆæ˜æ˜¾çš„çœ‹å‡ºå˜é•¿å‚æ•°å†…éƒ¨æ˜¯é€šè¿‡æ•°ç»„å®ç°çš„\n\n\n```\npublic class Varargs {\n    public Varargs() {\n    }\n\n    public static void print(String... args) {\n        String[] var1 = args;\n        int var2 = args.length;\n        //å¢å¼ºforå¾ªç¯çš„æ•°ç»„å®ç°æ–¹å¼\n        for(int var3 = 0; var3 < var2; ++var3) {\n            String str = var1[var3];\n            System.out.println(str);\n        }\n\n    }\n\n    public static void main(String[] args) {\n        //å˜é•¿å‚æ•°è½¬æ¢ä¸ºæ•°ç»„\n        print(new String[]{\"hello\", \"world\"});\n    }\n}\n```\n\n**å¢å¼ºforå¾ªç¯**\n\nå¢å¼ºforå¾ªç¯ä¸æ™®é€šforå¾ªç¯ç›¸æ¯”ï¼ŒåŠŸèƒ½æ›´å¼ºå¹¶ä¸”ä»£ç æ›´ç®€æ´ã€‚å¢å¼ºforå¾ªç¯çš„å¯¹è±¡è¦ä¹ˆæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¦ä¹ˆå®ç°äº†Iterableæ¥å£ã€‚è¿™ä¸ªè¯­æ³•ç³–ä¸»è¦ç”¨æ¥å¯¹æ•°ç»„æˆ–è€…é›†åˆè¿›è¡Œéå†ï¼Œå…¶åœ¨å¾ªç¯è¿‡ç¨‹ä¸­ä¸èƒ½æ”¹å˜é›†åˆçš„å¤§å°ã€‚\n\n\n```\npublic static void main(String[] args) {\n    String[] params = new String[]{\"hello\",\"world\"};\n    //å¢å¼ºforå¾ªç¯å¯¹è±¡ä¸ºæ•°ç»„\n    for(String str : params){\n        System.out.println(str);\n    }\n\n    List<String> lists = Arrays.asList(\"hello\",\"world\");\n    //å¢å¼ºforå¾ªç¯å¯¹è±¡å®ç°Iterableæ¥å£\n    for(String str : lists){\n        System.out.println(str);\n    }\n}\n```\n\nç¼–è¯‘åçš„classæ–‡ä»¶ä¸º\n\n\n```\npublic static void main(String[] args) {\n   String[] params = new String[]{\"hello\", \"world\"};\n   String[] lists = params;\n   int var3 = params.length;\n   //æ•°ç»„å½¢å¼çš„å¢å¼ºforé€€åŒ–ä¸ºæ™®é€šfor\n   for(int str = 0; str < var3; ++str) {\n       String str1 = lists[str];\n       System.out.println(str1);\n   }\n\n   List var6 = Arrays.asList(new String[]{\"hello\", \"world\"});\n   Iterator var7 = var6.iterator();\n   //å®ç°Iterableæ¥å£çš„å¢å¼ºforä½¿ç”¨iteratoræ¥å£è¿›è¡Œéå†\n   while(var7.hasNext()) {\n       String var8 = (String)var7.next();\n       System.out.println(var8);\n   }\n\n}\n```\n\n**å†…éƒ¨ç±»**\n\nå†…éƒ¨ç±»å°±æ˜¯å®šä¹‰åœ¨ä¸€ä¸ªç±»å†…éƒ¨çš„ç±»\nJavaè¯­è¨€ä¸­ä¹‹æ‰€ä»¥å¼•å…¥å†…éƒ¨ç±»ï¼Œæ˜¯å› ä¸ºæœ‰äº›æ—¶å€™ä¸€ä¸ªç±»åªåœ¨å¦ä¸€ä¸ªç±»ä¸­æœ‰ç”¨ï¼Œæˆ‘ä»¬ä¸æƒ³è®©å…¶åœ¨å¦å¤–ä¸€ä¸ªåœ°æ–¹è¢«ä½¿ç”¨ã€‚å†…éƒ¨ç±»ä¹‹æ‰€ä»¥æ˜¯è¯­æ³•ç³–ï¼Œæ˜¯å› ä¸ºå…¶åªæ˜¯ä¸€ä¸ªç¼–è¯‘æ—¶çš„æ¦‚å¿µï¼Œä¸€æ—¦ç¼–è¯‘å®Œæˆï¼Œç¼–è¯‘å™¨å°±ä¼šä¸ºå†…éƒ¨ç±»ç”Ÿæˆä¸€ä¸ªå•ç‹¬çš„classæ–‡ä»¶ï¼Œåä¸ºouter$innter.classã€‚\n\n\n```\npublic class Outer {\n    class Inner{\n    }\n}\n```\n\nä½¿ç”¨javacç¼–è¯‘åï¼Œç”Ÿæˆä¸¤ä¸ªclassæ–‡ä»¶Outer.classå’ŒOuter$Inner.classï¼Œå…¶ä¸­Outer$Inner.classçš„å†…å®¹å¦‚ä¸‹ï¼š\n\n\n```\nclass Outer$Inner {\n    Outer$Inner(Outer var1) {\n        this.this$0 = var1;\n    }\n}\n```\n\nå†…éƒ¨ç±»åˆ†ä¸ºå››ç§ï¼šæˆå‘˜å†…éƒ¨ç±»ã€å±€éƒ¨å†…éƒ¨ç±»ã€åŒ¿åå†…éƒ¨ç±»ã€é™æ€å†…éƒ¨ç±»ï¼Œæ¯ä¸€ç§éƒ½æœ‰å…¶ç”¨æ³•ï¼Œè¿™é‡Œå°±ä¸ä»‹ç»äº†\n\n**æšä¸¾ç±»å‹**\n\næšä¸¾ç±»å‹å°±æ˜¯ä¸€äº›å…·æœ‰ç›¸åŒç‰¹æ€§çš„ç±»å¸¸é‡\njavaä¸­ç±»çš„å®šä¹‰ä½¿ç”¨classï¼Œæšä¸¾ç±»çš„å®šä¹‰ä½¿ç”¨enumã€‚åœ¨Javaçš„å­—èŠ‚ç ç»“æ„ä¸­ï¼Œå…¶å®å¹¶æ²¡æœ‰æšä¸¾ç±»å‹ï¼Œæšä¸¾ç±»å‹åªæ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œåœ¨ç¼–è¯‘å®Œæˆåè¢«ç¼–è¯‘æˆä¸€ä¸ªæ™®é€šçš„ç±»ã€‚è¿™ä¸ªç±»ç»§æ‰¿java.lang.Enumï¼Œå¹¶è¢«finalå…³é”®å­—ä¿®é¥°ã€‚\n\n\n```\npublic enum Fruit {\n    APPLE,ORINGE\n}\n```\n\nä½¿ç”¨jadå¯¹ç¼–è¯‘åçš„classæ–‡ä»¶è¿›è¡Œåç¼–è¯‘åå¾—åˆ°ï¼š\n\n```\n//ç»§æ‰¿java.lang.Enumå¹¶å£°æ˜ä¸ºfinal\npublic final class Fruit extends Enum\n{\n\n    public static Fruit[] values()\n    {\n        return (Fruit[])$VALUES.clone();\n    }\n\n    public static Fruit valueOf(String s)\n    {\n        return (Fruit)Enum.valueOf(Fruit, s);\n    }\n\n    private Fruit(String s, int i)\n    {\n        super(s, i);\n    }\n    //æšä¸¾ç±»å‹å¸¸é‡\n    public static final Fruit APPLE;\n    public static final Fruit ORANGE;\n    private static final Fruit $VALUES[];//ä½¿ç”¨æ•°ç»„è¿›è¡Œç»´æŠ¤\n\n    static\n    {\n        APPLE = new Fruit(\"APPLE\", 0);\n        ORANGE = new Fruit(\"ORANGE\", 1);\n        $VALUES = (new Fruit[] {\n            APPLE, ORANGE\n        });\n    }\n}\n```\n\nJavaè¿œä¸æ­¢è¿™äº›è¯­æ³•ç³–ï¼ŒJDK7ã€JDK8æ·»åŠ çš„æ–°ç‰¹æ€§éƒ½æœ‰å¾ˆå¤šé«˜çº§çš„è¯­æ³•ç³–ã€‚\n","source":"_posts/è¿›é˜¶/Java ä¸­çš„ 6 é¢—è¯­æ³•ç³–.md","raw":"---\ntitle: Java ä¸­çš„ 6 é¢—è¯­æ³•ç³–\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: è¿›é˜¶\n---\n\n\nè¯­æ³•ç³–ï¼ˆSyntactic Sugarï¼‰ï¼Œä¹Ÿç§°ç³–è¡£è¯­æ³•ï¼ŒæŒ‡åœ¨è®¡ç®—æœºè¯­è¨€ä¸­æ·»åŠ çš„æŸç§è¯­æ³•ï¼Œè¿™ç§è¯­æ³•å¯¹è¯­è¨€æœ¬èº«åŠŸèƒ½æ¥è¯´æ²¡æœ‰ä»€ä¹ˆå½±å“ï¼Œåªæ˜¯ä¸ºäº†æ–¹ä¾¿ç¨‹åºå‘˜çš„å¼€å‘ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚è¯´ç™½äº†ï¼Œè¯­æ³•ç³–å°±æ˜¯å¯¹ç°æœ‰è¯­æ³•çš„ä¸€ä¸ªå°è£…ã€‚\n\nJavaä½œä¸ºä¸€ç§ä¸å¹³å°æ— å…³çš„é«˜çº§è¯­è¨€ï¼Œå½“ç„¶ä¹Ÿå«æœ‰è¯­æ³•ç³–ï¼Œè¿™äº›è¯­æ³•ç³–å¹¶ä¸è¢«è™šæ‹Ÿæœºæ‰€æ”¯æŒï¼Œåœ¨ç¼–è¯‘æˆå­—èŠ‚ç é˜¶æ®µå°±è‡ªåŠ¨è½¬æ¢æˆç®€å•å¸¸ç”¨è¯­æ³•ã€‚\n\n**ä¸€èˆ¬æ¥è¯´Javaä¸­çš„è¯­æ³•ç³–ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ï¼š** \n\n1. æ³›å‹ä¸ç±»å‹æ“¦é™¤ \n2. è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±\n3. å˜é•¿å‚æ•°\n4. å¢å¼ºforå¾ªç¯ \n5. å†…éƒ¨ç±»\n6. æšä¸¾ç±»\n\n**æ³›å‹ä¸ç±»å‹æ“¦é™¤**\n\nJavaè¯­è¨€å¹¶ä¸æ˜¯ä¸€å¼€å§‹å°±æ”¯æŒæ³›å‹çš„ã€‚åœ¨æ—©æœŸçš„JDKä¸­ï¼Œåªèƒ½é€šè¿‡Objectç±»æ˜¯æ‰€æœ‰ç±»å‹çš„çˆ¶ç±»å’Œå¼ºåˆ¶ç±»å‹è½¬æ¢æ¥å®ç°æ³›å‹çš„åŠŸèƒ½ã€‚å¼ºåˆ¶ç±»å‹è½¬æ¢çš„ç¼ºç‚¹å°±æ˜¯æŠŠç¼–è¯‘æœŸé—´çš„é—®é¢˜å»¶è¿Ÿåˆ°è¿è¡Œæ—¶ï¼ŒJVMå¹¶ä¸èƒ½ä¸ºæˆ‘ä»¬æä¾›ç¼–è¯‘æœŸé—´çš„æ£€æŸ¥ã€‚\n\nåœ¨JDK1.5ä¸­ï¼ŒJavaè¯­è¨€å¼•å…¥äº†æ³›å‹æœºåˆ¶ã€‚ä½†æ˜¯è¿™ç§æ³›å‹æœºåˆ¶æ˜¯é€šè¿‡ç±»å‹æ“¦é™¤æ¥å®ç°çš„ï¼Œå³Javaä¸­çš„æ³›å‹åªåœ¨ç¨‹åºæºä»£ç ä¸­æœ‰æ•ˆï¼ˆæºä»£ç é˜¶æ®µæä¾›ç±»å‹æ£€æŸ¥ï¼‰ï¼Œåœ¨ç¼–è¯‘åçš„å­—èŠ‚ç ä¸­è‡ªåŠ¨ç”¨å¼ºåˆ¶ç±»å‹è½¬æ¢è¿›è¡Œæ›¿ä»£ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒJavaè¯­è¨€ä¸­çš„æ³›å‹æœºåˆ¶å…¶å®å°±æ˜¯ä¸€é¢—è¯­æ³•ç³–ï¼Œç›¸è¾ƒä¸C++ã€C#ç›¸æ¯”ï¼Œå…¶æ³›å‹å®ç°å®åœ¨æ˜¯ä¸é‚£ä¹ˆä¼˜é›…ã€‚\n\n\n```\n/**\n* åœ¨æºä»£ç ä¸­å­˜åœ¨æ³›å‹\n*/\npublic static void main(String[] args) {\n    Map<String,String> map = new HashMap<String,String>();\n    map.put(\"hello\",\"ä½ å¥½\");\n    String hello = map.get(\"hello\");\n    System.out.println(hello);\n}\n```\n\nå½“ä¸Šè¿°æºä»£ç è¢«ç¼–è¯‘ä¸ºclassæ–‡ä»¶åï¼Œæ³›å‹è¢«æ“¦é™¤ä¸”å¼•å…¥å¼ºåˆ¶ç±»å‹è½¬æ¢\n\n\n```\npublic static void main(String[] args) {\n    HashMap map = new HashMap(); //ç±»å‹æ“¦é™¤\n    map.put(\"hello\", \"ä½ å¥½\");\n    String hello = (String)map.get(\"hello\");//å¼ºåˆ¶è½¬æ¢\n    System.out.println(hello);\n}\n```\n\n\n**è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±**\n\nJavaä¸­çš„è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±æŒ‡çš„æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ä¸ä»–ä»¬çš„åŒ…è£…ç±»å‹ä¹‹é—´çš„ç›¸äº’è½¬æ¢ã€‚\n\næˆ‘ä»¬çŸ¥é“Javaæ˜¯ä¸€é—¨é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œåœ¨Javaä¸–ç•Œä¸­æœ‰ä¸€å¥è¯æ˜¯è¿™ä¹ˆè¯´çš„ï¼šâ€œä¸‡ç‰©çš†å¯¹è±¡â€ã€‚ä½†æ˜¯Javaä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹å´ä¸æ˜¯å¯¹è±¡ï¼Œä»–ä»¬ä¸éœ€è¦è¿›è¡Œnewæ“ä½œï¼Œä¹Ÿä¸èƒ½è°ƒç”¨ä»»ä½•æ–¹æ³•ï¼Œè¿™åœ¨ä½¿ç”¨çš„æ—¶å€™æœ‰è¯¸å¤šä¸ä¾¿ã€‚å› æ­¤Javaä¸ºè¿™äº›åŸºæœ¬ç±»å‹æä¾›äº†åŒ…è£…ç±»ï¼Œå¹¶ä¸”ä¸ºäº†ä½¿ç”¨æ–¹ä¾¿ï¼Œæä¾›äº†è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±åŠŸèƒ½ã€‚è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œå…¶å®æ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œå†…éƒ¨è¿˜æ˜¯è°ƒç”¨äº†ç›¸åº”çš„å‡½æ•°è¿›è¡Œè½¬æ¢ã€‚\n\nä¸‹é¢ä»£ç æ¼”ç¤ºäº†è‡ªåŠ¨è£…ç®±å’Œæ‹†ç®±åŠŸèƒ½\n\n\n```\npublic static void main(String[] args) {\n    Integer a = 1;\n    int b = 2;\n    int c = a + b;\n    System.out.println(c);\n}\n```\n\nç»è¿‡ç¼–è¯‘åï¼Œä»£ç å¦‚ä¸‹\n\n\n```\npublic static void main(String[] args) {\n    Integer a = Integer.valueOf(1); // è‡ªåŠ¨è£…ç®±\n    byte b = 2;\n    int c = a.intValue() + b;//è‡ªåŠ¨æ‹†ç®±\n    System.out.println(c);\n}\n```\n\n**å˜é•¿å‚æ•°**\n\næ‰€è°“å˜é•¿å‚æ•°ï¼Œå°±æ˜¯æ–¹æ³•å¯ä»¥æ¥å—é•¿åº¦ä¸å®šç¡®å®šçš„å‚æ•°ã€‚å˜é•¿å‚æ•°ç‰¹æ€§æ˜¯åœ¨JDK1.5ä¸­å¼•å…¥çš„ï¼Œä½¿ç”¨å˜é•¿å‚æ•°æœ‰ä¸¤ä¸ªæ¡ä»¶ï¼Œä¸€æ˜¯å˜é•¿çš„é‚£ä¸€éƒ¨åˆ†å‚æ•°å…·æœ‰ç›¸åŒçš„ç±»å‹ï¼ŒäºŒæ˜¯å˜é•¿å‚æ•°å¿…é¡»ä½äºæ–¹æ³•å‚æ•°åˆ—è¡¨çš„æœ€åé¢ã€‚å˜é•¿å‚æ•°åŒæ ·æ˜¯Javaä¸­çš„è¯­æ³•ç³–ï¼Œå…¶å†…éƒ¨å®ç°æ˜¯Javaæ•°ç»„ã€‚\n\n\n```\npublic class Varargs {\n    public static void print(String... args) {\n        for(String str : args){\n            System.out.println(str);\n        }\n    }\n\n    public static void main(String[] args) {\n        print(\"hello\", \"world\");\n    }\n}\n```\n\nç¼–è¯‘ä¸ºclassæ–‡ä»¶åå¦‚ä¸‹ï¼Œä»ä¸­å¯ä»¥å¾ˆæ˜æ˜¾çš„çœ‹å‡ºå˜é•¿å‚æ•°å†…éƒ¨æ˜¯é€šè¿‡æ•°ç»„å®ç°çš„\n\n\n```\npublic class Varargs {\n    public Varargs() {\n    }\n\n    public static void print(String... args) {\n        String[] var1 = args;\n        int var2 = args.length;\n        //å¢å¼ºforå¾ªç¯çš„æ•°ç»„å®ç°æ–¹å¼\n        for(int var3 = 0; var3 < var2; ++var3) {\n            String str = var1[var3];\n            System.out.println(str);\n        }\n\n    }\n\n    public static void main(String[] args) {\n        //å˜é•¿å‚æ•°è½¬æ¢ä¸ºæ•°ç»„\n        print(new String[]{\"hello\", \"world\"});\n    }\n}\n```\n\n**å¢å¼ºforå¾ªç¯**\n\nå¢å¼ºforå¾ªç¯ä¸æ™®é€šforå¾ªç¯ç›¸æ¯”ï¼ŒåŠŸèƒ½æ›´å¼ºå¹¶ä¸”ä»£ç æ›´ç®€æ´ã€‚å¢å¼ºforå¾ªç¯çš„å¯¹è±¡è¦ä¹ˆæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¦ä¹ˆå®ç°äº†Iterableæ¥å£ã€‚è¿™ä¸ªè¯­æ³•ç³–ä¸»è¦ç”¨æ¥å¯¹æ•°ç»„æˆ–è€…é›†åˆè¿›è¡Œéå†ï¼Œå…¶åœ¨å¾ªç¯è¿‡ç¨‹ä¸­ä¸èƒ½æ”¹å˜é›†åˆçš„å¤§å°ã€‚\n\n\n```\npublic static void main(String[] args) {\n    String[] params = new String[]{\"hello\",\"world\"};\n    //å¢å¼ºforå¾ªç¯å¯¹è±¡ä¸ºæ•°ç»„\n    for(String str : params){\n        System.out.println(str);\n    }\n\n    List<String> lists = Arrays.asList(\"hello\",\"world\");\n    //å¢å¼ºforå¾ªç¯å¯¹è±¡å®ç°Iterableæ¥å£\n    for(String str : lists){\n        System.out.println(str);\n    }\n}\n```\n\nç¼–è¯‘åçš„classæ–‡ä»¶ä¸º\n\n\n```\npublic static void main(String[] args) {\n   String[] params = new String[]{\"hello\", \"world\"};\n   String[] lists = params;\n   int var3 = params.length;\n   //æ•°ç»„å½¢å¼çš„å¢å¼ºforé€€åŒ–ä¸ºæ™®é€šfor\n   for(int str = 0; str < var3; ++str) {\n       String str1 = lists[str];\n       System.out.println(str1);\n   }\n\n   List var6 = Arrays.asList(new String[]{\"hello\", \"world\"});\n   Iterator var7 = var6.iterator();\n   //å®ç°Iterableæ¥å£çš„å¢å¼ºforä½¿ç”¨iteratoræ¥å£è¿›è¡Œéå†\n   while(var7.hasNext()) {\n       String var8 = (String)var7.next();\n       System.out.println(var8);\n   }\n\n}\n```\n\n**å†…éƒ¨ç±»**\n\nå†…éƒ¨ç±»å°±æ˜¯å®šä¹‰åœ¨ä¸€ä¸ªç±»å†…éƒ¨çš„ç±»\nJavaè¯­è¨€ä¸­ä¹‹æ‰€ä»¥å¼•å…¥å†…éƒ¨ç±»ï¼Œæ˜¯å› ä¸ºæœ‰äº›æ—¶å€™ä¸€ä¸ªç±»åªåœ¨å¦ä¸€ä¸ªç±»ä¸­æœ‰ç”¨ï¼Œæˆ‘ä»¬ä¸æƒ³è®©å…¶åœ¨å¦å¤–ä¸€ä¸ªåœ°æ–¹è¢«ä½¿ç”¨ã€‚å†…éƒ¨ç±»ä¹‹æ‰€ä»¥æ˜¯è¯­æ³•ç³–ï¼Œæ˜¯å› ä¸ºå…¶åªæ˜¯ä¸€ä¸ªç¼–è¯‘æ—¶çš„æ¦‚å¿µï¼Œä¸€æ—¦ç¼–è¯‘å®Œæˆï¼Œç¼–è¯‘å™¨å°±ä¼šä¸ºå†…éƒ¨ç±»ç”Ÿæˆä¸€ä¸ªå•ç‹¬çš„classæ–‡ä»¶ï¼Œåä¸ºouter$innter.classã€‚\n\n\n```\npublic class Outer {\n    class Inner{\n    }\n}\n```\n\nä½¿ç”¨javacç¼–è¯‘åï¼Œç”Ÿæˆä¸¤ä¸ªclassæ–‡ä»¶Outer.classå’ŒOuter$Inner.classï¼Œå…¶ä¸­Outer$Inner.classçš„å†…å®¹å¦‚ä¸‹ï¼š\n\n\n```\nclass Outer$Inner {\n    Outer$Inner(Outer var1) {\n        this.this$0 = var1;\n    }\n}\n```\n\nå†…éƒ¨ç±»åˆ†ä¸ºå››ç§ï¼šæˆå‘˜å†…éƒ¨ç±»ã€å±€éƒ¨å†…éƒ¨ç±»ã€åŒ¿åå†…éƒ¨ç±»ã€é™æ€å†…éƒ¨ç±»ï¼Œæ¯ä¸€ç§éƒ½æœ‰å…¶ç”¨æ³•ï¼Œè¿™é‡Œå°±ä¸ä»‹ç»äº†\n\n**æšä¸¾ç±»å‹**\n\næšä¸¾ç±»å‹å°±æ˜¯ä¸€äº›å…·æœ‰ç›¸åŒç‰¹æ€§çš„ç±»å¸¸é‡\njavaä¸­ç±»çš„å®šä¹‰ä½¿ç”¨classï¼Œæšä¸¾ç±»çš„å®šä¹‰ä½¿ç”¨enumã€‚åœ¨Javaçš„å­—èŠ‚ç ç»“æ„ä¸­ï¼Œå…¶å®å¹¶æ²¡æœ‰æšä¸¾ç±»å‹ï¼Œæšä¸¾ç±»å‹åªæ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œåœ¨ç¼–è¯‘å®Œæˆåè¢«ç¼–è¯‘æˆä¸€ä¸ªæ™®é€šçš„ç±»ã€‚è¿™ä¸ªç±»ç»§æ‰¿java.lang.Enumï¼Œå¹¶è¢«finalå…³é”®å­—ä¿®é¥°ã€‚\n\n\n```\npublic enum Fruit {\n    APPLE,ORINGE\n}\n```\n\nä½¿ç”¨jadå¯¹ç¼–è¯‘åçš„classæ–‡ä»¶è¿›è¡Œåç¼–è¯‘åå¾—åˆ°ï¼š\n\n```\n//ç»§æ‰¿java.lang.Enumå¹¶å£°æ˜ä¸ºfinal\npublic final class Fruit extends Enum\n{\n\n    public static Fruit[] values()\n    {\n        return (Fruit[])$VALUES.clone();\n    }\n\n    public static Fruit valueOf(String s)\n    {\n        return (Fruit)Enum.valueOf(Fruit, s);\n    }\n\n    private Fruit(String s, int i)\n    {\n        super(s, i);\n    }\n    //æšä¸¾ç±»å‹å¸¸é‡\n    public static final Fruit APPLE;\n    public static final Fruit ORANGE;\n    private static final Fruit $VALUES[];//ä½¿ç”¨æ•°ç»„è¿›è¡Œç»´æŠ¤\n\n    static\n    {\n        APPLE = new Fruit(\"APPLE\", 0);\n        ORANGE = new Fruit(\"ORANGE\", 1);\n        $VALUES = (new Fruit[] {\n            APPLE, ORANGE\n        });\n    }\n}\n```\n\nJavaè¿œä¸æ­¢è¿™äº›è¯­æ³•ç³–ï¼ŒJDK7ã€JDK8æ·»åŠ çš„æ–°ç‰¹æ€§éƒ½æœ‰å¾ˆå¤šé«˜çº§çš„è¯­æ³•ç³–ã€‚\n","slug":"è¿›é˜¶/Java ä¸­çš„ 6 é¢—è¯­æ³•ç³–","published":1,"updated":"2025-10-16T02:51:08.329Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076c0009qkd4260v5ajm","content":"<p>è¯­æ³•ç³–ï¼ˆSyntactic Sugarï¼‰ï¼Œä¹Ÿç§°ç³–è¡£è¯­æ³•ï¼ŒæŒ‡åœ¨è®¡ç®—æœºè¯­è¨€ä¸­æ·»åŠ çš„æŸç§è¯­æ³•ï¼Œè¿™ç§è¯­æ³•å¯¹è¯­è¨€æœ¬èº«åŠŸèƒ½æ¥è¯´æ²¡æœ‰ä»€ä¹ˆå½±å“ï¼Œåªæ˜¯ä¸ºäº†æ–¹ä¾¿ç¨‹åºå‘˜çš„å¼€å‘ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚è¯´ç™½äº†ï¼Œè¯­æ³•ç³–å°±æ˜¯å¯¹ç°æœ‰è¯­æ³•çš„ä¸€ä¸ªå°è£…ã€‚</p>\n<p>Javaä½œä¸ºä¸€ç§ä¸å¹³å°æ— å…³çš„é«˜çº§è¯­è¨€ï¼Œå½“ç„¶ä¹Ÿå«æœ‰è¯­æ³•ç³–ï¼Œè¿™äº›è¯­æ³•ç³–å¹¶ä¸è¢«è™šæ‹Ÿæœºæ‰€æ”¯æŒï¼Œåœ¨ç¼–è¯‘æˆå­—èŠ‚ç é˜¶æ®µå°±è‡ªåŠ¨è½¬æ¢æˆç®€å•å¸¸ç”¨è¯­æ³•ã€‚</p>\n<p><strong>ä¸€èˆ¬æ¥è¯´Javaä¸­çš„è¯­æ³•ç³–ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ï¼š</strong> </p>\n<ol>\n<li>æ³›å‹ä¸ç±»å‹æ“¦é™¤ </li>\n<li>è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±</li>\n<li>å˜é•¿å‚æ•°</li>\n<li>å¢å¼ºforå¾ªç¯ </li>\n<li>å†…éƒ¨ç±»</li>\n<li>æšä¸¾ç±»</li>\n</ol>\n<p><strong>æ³›å‹ä¸ç±»å‹æ“¦é™¤</strong></p>\n<p>Javaè¯­è¨€å¹¶ä¸æ˜¯ä¸€å¼€å§‹å°±æ”¯æŒæ³›å‹çš„ã€‚åœ¨æ—©æœŸçš„JDKä¸­ï¼Œåªèƒ½é€šè¿‡Objectç±»æ˜¯æ‰€æœ‰ç±»å‹çš„çˆ¶ç±»å’Œå¼ºåˆ¶ç±»å‹è½¬æ¢æ¥å®ç°æ³›å‹çš„åŠŸèƒ½ã€‚å¼ºåˆ¶ç±»å‹è½¬æ¢çš„ç¼ºç‚¹å°±æ˜¯æŠŠç¼–è¯‘æœŸé—´çš„é—®é¢˜å»¶è¿Ÿåˆ°è¿è¡Œæ—¶ï¼ŒJVMå¹¶ä¸èƒ½ä¸ºæˆ‘ä»¬æä¾›ç¼–è¯‘æœŸé—´çš„æ£€æŸ¥ã€‚</p>\n<p>åœ¨JDK1.5ä¸­ï¼ŒJavaè¯­è¨€å¼•å…¥äº†æ³›å‹æœºåˆ¶ã€‚ä½†æ˜¯è¿™ç§æ³›å‹æœºåˆ¶æ˜¯é€šè¿‡ç±»å‹æ“¦é™¤æ¥å®ç°çš„ï¼Œå³Javaä¸­çš„æ³›å‹åªåœ¨ç¨‹åºæºä»£ç ä¸­æœ‰æ•ˆï¼ˆæºä»£ç é˜¶æ®µæä¾›ç±»å‹æ£€æŸ¥ï¼‰ï¼Œåœ¨ç¼–è¯‘åçš„å­—èŠ‚ç ä¸­è‡ªåŠ¨ç”¨å¼ºåˆ¶ç±»å‹è½¬æ¢è¿›è¡Œæ›¿ä»£ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒJavaè¯­è¨€ä¸­çš„æ³›å‹æœºåˆ¶å…¶å®å°±æ˜¯ä¸€é¢—è¯­æ³•ç³–ï¼Œç›¸è¾ƒä¸C++ã€C#ç›¸æ¯”ï¼Œå…¶æ³›å‹å®ç°å®åœ¨æ˜¯ä¸é‚£ä¹ˆä¼˜é›…ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n* åœ¨æºä»£ç ä¸­å­˜åœ¨æ³›å‹\n*&#x2F;\npublic static void main(String[] args) &#123;\n    Map&lt;String,String&gt; map &#x3D; new HashMap&lt;String,String&gt;();\n    map.put(&quot;hello&quot;,&quot;ä½ å¥½&quot;);\n    String hello &#x3D; map.get(&quot;hello&quot;);\n    System.out.println(hello);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å½“ä¸Šè¿°æºä»£ç è¢«ç¼–è¯‘ä¸ºclassæ–‡ä»¶åï¼Œæ³›å‹è¢«æ“¦é™¤ä¸”å¼•å…¥å¼ºåˆ¶ç±»å‹è½¬æ¢</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n    HashMap map &#x3D; new HashMap(); &#x2F;&#x2F;ç±»å‹æ“¦é™¤\n    map.put(&quot;hello&quot;, &quot;ä½ å¥½&quot;);\n    String hello &#x3D; (String)map.get(&quot;hello&quot;);&#x2F;&#x2F;å¼ºåˆ¶è½¬æ¢\n    System.out.println(hello);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n<p><strong>è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±</strong></p>\n<p>Javaä¸­çš„è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±æŒ‡çš„æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ä¸ä»–ä»¬çš„åŒ…è£…ç±»å‹ä¹‹é—´çš„ç›¸äº’è½¬æ¢ã€‚</p>\n<p>æˆ‘ä»¬çŸ¥é“Javaæ˜¯ä¸€é—¨é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œåœ¨Javaä¸–ç•Œä¸­æœ‰ä¸€å¥è¯æ˜¯è¿™ä¹ˆè¯´çš„ï¼šâ€œä¸‡ç‰©çš†å¯¹è±¡â€ã€‚ä½†æ˜¯Javaä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹å´ä¸æ˜¯å¯¹è±¡ï¼Œä»–ä»¬ä¸éœ€è¦è¿›è¡Œnewæ“ä½œï¼Œä¹Ÿä¸èƒ½è°ƒç”¨ä»»ä½•æ–¹æ³•ï¼Œè¿™åœ¨ä½¿ç”¨çš„æ—¶å€™æœ‰è¯¸å¤šä¸ä¾¿ã€‚å› æ­¤Javaä¸ºè¿™äº›åŸºæœ¬ç±»å‹æä¾›äº†åŒ…è£…ç±»ï¼Œå¹¶ä¸”ä¸ºäº†ä½¿ç”¨æ–¹ä¾¿ï¼Œæä¾›äº†è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±åŠŸèƒ½ã€‚è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œå…¶å®æ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œå†…éƒ¨è¿˜æ˜¯è°ƒç”¨äº†ç›¸åº”çš„å‡½æ•°è¿›è¡Œè½¬æ¢ã€‚</p>\n<p>ä¸‹é¢ä»£ç æ¼”ç¤ºäº†è‡ªåŠ¨è£…ç®±å’Œæ‹†ç®±åŠŸèƒ½</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n    Integer a &#x3D; 1;\n    int b &#x3D; 2;\n    int c &#x3D; a + b;\n    System.out.println(c);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç»è¿‡ç¼–è¯‘åï¼Œä»£ç å¦‚ä¸‹</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n    Integer a &#x3D; Integer.valueOf(1); &#x2F;&#x2F; è‡ªåŠ¨è£…ç®±\n    byte b &#x3D; 2;\n    int c &#x3D; a.intValue() + b;&#x2F;&#x2F;è‡ªåŠ¨æ‹†ç®±\n    System.out.println(c);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>å˜é•¿å‚æ•°</strong></p>\n<p>æ‰€è°“å˜é•¿å‚æ•°ï¼Œå°±æ˜¯æ–¹æ³•å¯ä»¥æ¥å—é•¿åº¦ä¸å®šç¡®å®šçš„å‚æ•°ã€‚å˜é•¿å‚æ•°ç‰¹æ€§æ˜¯åœ¨JDK1.5ä¸­å¼•å…¥çš„ï¼Œä½¿ç”¨å˜é•¿å‚æ•°æœ‰ä¸¤ä¸ªæ¡ä»¶ï¼Œä¸€æ˜¯å˜é•¿çš„é‚£ä¸€éƒ¨åˆ†å‚æ•°å…·æœ‰ç›¸åŒçš„ç±»å‹ï¼ŒäºŒæ˜¯å˜é•¿å‚æ•°å¿…é¡»ä½äºæ–¹æ³•å‚æ•°åˆ—è¡¨çš„æœ€åé¢ã€‚å˜é•¿å‚æ•°åŒæ ·æ˜¯Javaä¸­çš„è¯­æ³•ç³–ï¼Œå…¶å†…éƒ¨å®ç°æ˜¯Javaæ•°ç»„ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class Varargs &#123;\n    public static void print(String... args) &#123;\n        for(String str : args)&#123;\n            System.out.println(str);\n        &#125;\n    &#125;\n\n    public static void main(String[] args) &#123;\n        print(&quot;hello&quot;, &quot;world&quot;);\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¼–è¯‘ä¸ºclassæ–‡ä»¶åå¦‚ä¸‹ï¼Œä»ä¸­å¯ä»¥å¾ˆæ˜æ˜¾çš„çœ‹å‡ºå˜é•¿å‚æ•°å†…éƒ¨æ˜¯é€šè¿‡æ•°ç»„å®ç°çš„</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class Varargs &#123;\n    public Varargs() &#123;\n    &#125;\n\n    public static void print(String... args) &#123;\n        String[] var1 &#x3D; args;\n        int var2 &#x3D; args.length;\n        &#x2F;&#x2F;å¢å¼ºforå¾ªç¯çš„æ•°ç»„å®ç°æ–¹å¼\n        for(int var3 &#x3D; 0; var3 &lt; var2; ++var3) &#123;\n            String str &#x3D; var1[var3];\n            System.out.println(str);\n        &#125;\n\n    &#125;\n\n    public static void main(String[] args) &#123;\n        &#x2F;&#x2F;å˜é•¿å‚æ•°è½¬æ¢ä¸ºæ•°ç»„\n        print(new String[]&#123;&quot;hello&quot;, &quot;world&quot;&#125;);\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>å¢å¼ºforå¾ªç¯</strong></p>\n<p>å¢å¼ºforå¾ªç¯ä¸æ™®é€šforå¾ªç¯ç›¸æ¯”ï¼ŒåŠŸèƒ½æ›´å¼ºå¹¶ä¸”ä»£ç æ›´ç®€æ´ã€‚å¢å¼ºforå¾ªç¯çš„å¯¹è±¡è¦ä¹ˆæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¦ä¹ˆå®ç°äº†Iterableæ¥å£ã€‚è¿™ä¸ªè¯­æ³•ç³–ä¸»è¦ç”¨æ¥å¯¹æ•°ç»„æˆ–è€…é›†åˆè¿›è¡Œéå†ï¼Œå…¶åœ¨å¾ªç¯è¿‡ç¨‹ä¸­ä¸èƒ½æ”¹å˜é›†åˆçš„å¤§å°ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n    String[] params &#x3D; new String[]&#123;&quot;hello&quot;,&quot;world&quot;&#125;;\n    &#x2F;&#x2F;å¢å¼ºforå¾ªç¯å¯¹è±¡ä¸ºæ•°ç»„\n    for(String str : params)&#123;\n        System.out.println(str);\n    &#125;\n\n    List&lt;String&gt; lists &#x3D; Arrays.asList(&quot;hello&quot;,&quot;world&quot;);\n    &#x2F;&#x2F;å¢å¼ºforå¾ªç¯å¯¹è±¡å®ç°Iterableæ¥å£\n    for(String str : lists)&#123;\n        System.out.println(str);\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¼–è¯‘åçš„classæ–‡ä»¶ä¸º</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n   String[] params &#x3D; new String[]&#123;&quot;hello&quot;, &quot;world&quot;&#125;;\n   String[] lists &#x3D; params;\n   int var3 &#x3D; params.length;\n   &#x2F;&#x2F;æ•°ç»„å½¢å¼çš„å¢å¼ºforé€€åŒ–ä¸ºæ™®é€šfor\n   for(int str &#x3D; 0; str &lt; var3; ++str) &#123;\n       String str1 &#x3D; lists[str];\n       System.out.println(str1);\n   &#125;\n\n   List var6 &#x3D; Arrays.asList(new String[]&#123;&quot;hello&quot;, &quot;world&quot;&#125;);\n   Iterator var7 &#x3D; var6.iterator();\n   &#x2F;&#x2F;å®ç°Iterableæ¥å£çš„å¢å¼ºforä½¿ç”¨iteratoræ¥å£è¿›è¡Œéå†\n   while(var7.hasNext()) &#123;\n       String var8 &#x3D; (String)var7.next();\n       System.out.println(var8);\n   &#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>å†…éƒ¨ç±»</strong></p>\n<p>å†…éƒ¨ç±»å°±æ˜¯å®šä¹‰åœ¨ä¸€ä¸ªç±»å†…éƒ¨çš„ç±»<br>Javaè¯­è¨€ä¸­ä¹‹æ‰€ä»¥å¼•å…¥å†…éƒ¨ç±»ï¼Œæ˜¯å› ä¸ºæœ‰äº›æ—¶å€™ä¸€ä¸ªç±»åªåœ¨å¦ä¸€ä¸ªç±»ä¸­æœ‰ç”¨ï¼Œæˆ‘ä»¬ä¸æƒ³è®©å…¶åœ¨å¦å¤–ä¸€ä¸ªåœ°æ–¹è¢«ä½¿ç”¨ã€‚å†…éƒ¨ç±»ä¹‹æ‰€ä»¥æ˜¯è¯­æ³•ç³–ï¼Œæ˜¯å› ä¸ºå…¶åªæ˜¯ä¸€ä¸ªç¼–è¯‘æ—¶çš„æ¦‚å¿µï¼Œä¸€æ—¦ç¼–è¯‘å®Œæˆï¼Œç¼–è¯‘å™¨å°±ä¼šä¸ºå†…éƒ¨ç±»ç”Ÿæˆä¸€ä¸ªå•ç‹¬çš„classæ–‡ä»¶ï¼Œåä¸ºouter$innter.classã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class Outer &#123;\n    class Inner&#123;\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä½¿ç”¨javacç¼–è¯‘åï¼Œç”Ÿæˆä¸¤ä¸ªclassæ–‡ä»¶Outer.classå’ŒOuter$Inner.classï¼Œå…¶ä¸­Outer$Inner.classçš„å†…å®¹å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">class Outer$Inner &#123;\n    Outer$Inner(Outer var1) &#123;\n        this.this$0 &#x3D; var1;\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å†…éƒ¨ç±»åˆ†ä¸ºå››ç§ï¼šæˆå‘˜å†…éƒ¨ç±»ã€å±€éƒ¨å†…éƒ¨ç±»ã€åŒ¿åå†…éƒ¨ç±»ã€é™æ€å†…éƒ¨ç±»ï¼Œæ¯ä¸€ç§éƒ½æœ‰å…¶ç”¨æ³•ï¼Œè¿™é‡Œå°±ä¸ä»‹ç»äº†</p>\n<p><strong>æšä¸¾ç±»å‹</strong></p>\n<p>æšä¸¾ç±»å‹å°±æ˜¯ä¸€äº›å…·æœ‰ç›¸åŒç‰¹æ€§çš„ç±»å¸¸é‡<br>javaä¸­ç±»çš„å®šä¹‰ä½¿ç”¨classï¼Œæšä¸¾ç±»çš„å®šä¹‰ä½¿ç”¨enumã€‚åœ¨Javaçš„å­—èŠ‚ç ç»“æ„ä¸­ï¼Œå…¶å®å¹¶æ²¡æœ‰æšä¸¾ç±»å‹ï¼Œæšä¸¾ç±»å‹åªæ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œåœ¨ç¼–è¯‘å®Œæˆåè¢«ç¼–è¯‘æˆä¸€ä¸ªæ™®é€šçš„ç±»ã€‚è¿™ä¸ªç±»ç»§æ‰¿java.lang.Enumï¼Œå¹¶è¢«finalå…³é”®å­—ä¿®é¥°ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public enum Fruit &#123;\n    APPLE,ORINGE\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ä½¿ç”¨jadå¯¹ç¼–è¯‘åçš„classæ–‡ä»¶è¿›è¡Œåç¼–è¯‘åå¾—åˆ°ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F;ç»§æ‰¿java.lang.Enumå¹¶å£°æ˜ä¸ºfinal\npublic final class Fruit extends Enum\n&#123;\n\n    public static Fruit[] values()\n    &#123;\n        return (Fruit[])$VALUES.clone();\n    &#125;\n\n    public static Fruit valueOf(String s)\n    &#123;\n        return (Fruit)Enum.valueOf(Fruit, s);\n    &#125;\n\n    private Fruit(String s, int i)\n    &#123;\n        super(s, i);\n    &#125;\n    &#x2F;&#x2F;æšä¸¾ç±»å‹å¸¸é‡\n    public static final Fruit APPLE;\n    public static final Fruit ORANGE;\n    private static final Fruit $VALUES[];&#x2F;&#x2F;ä½¿ç”¨æ•°ç»„è¿›è¡Œç»´æŠ¤\n\n    static\n    &#123;\n        APPLE &#x3D; new Fruit(&quot;APPLE&quot;, 0);\n        ORANGE &#x3D; new Fruit(&quot;ORANGE&quot;, 1);\n        $VALUES &#x3D; (new Fruit[] &#123;\n            APPLE, ORANGE\n        &#125;);\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Javaè¿œä¸æ­¢è¿™äº›è¯­æ³•ç³–ï¼ŒJDK7ã€JDK8æ·»åŠ çš„æ–°ç‰¹æ€§éƒ½æœ‰å¾ˆå¤šé«˜çº§çš„è¯­æ³•ç³–ã€‚</p>\n","excerpt":"","more":"<p>è¯­æ³•ç³–ï¼ˆSyntactic Sugarï¼‰ï¼Œä¹Ÿç§°ç³–è¡£è¯­æ³•ï¼ŒæŒ‡åœ¨è®¡ç®—æœºè¯­è¨€ä¸­æ·»åŠ çš„æŸç§è¯­æ³•ï¼Œè¿™ç§è¯­æ³•å¯¹è¯­è¨€æœ¬èº«åŠŸèƒ½æ¥è¯´æ²¡æœ‰ä»€ä¹ˆå½±å“ï¼Œåªæ˜¯ä¸ºäº†æ–¹ä¾¿ç¨‹åºå‘˜çš„å¼€å‘ï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚è¯´ç™½äº†ï¼Œè¯­æ³•ç³–å°±æ˜¯å¯¹ç°æœ‰è¯­æ³•çš„ä¸€ä¸ªå°è£…ã€‚</p>\n<p>Javaä½œä¸ºä¸€ç§ä¸å¹³å°æ— å…³çš„é«˜çº§è¯­è¨€ï¼Œå½“ç„¶ä¹Ÿå«æœ‰è¯­æ³•ç³–ï¼Œè¿™äº›è¯­æ³•ç³–å¹¶ä¸è¢«è™šæ‹Ÿæœºæ‰€æ”¯æŒï¼Œåœ¨ç¼–è¯‘æˆå­—èŠ‚ç é˜¶æ®µå°±è‡ªåŠ¨è½¬æ¢æˆç®€å•å¸¸ç”¨è¯­æ³•ã€‚</p>\n<p><strong>ä¸€èˆ¬æ¥è¯´Javaä¸­çš„è¯­æ³•ç³–ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§ï¼š</strong> </p>\n<ol>\n<li>æ³›å‹ä¸ç±»å‹æ“¦é™¤ </li>\n<li>è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±</li>\n<li>å˜é•¿å‚æ•°</li>\n<li>å¢å¼ºforå¾ªç¯ </li>\n<li>å†…éƒ¨ç±»</li>\n<li>æšä¸¾ç±»</li>\n</ol>\n<p><strong>æ³›å‹ä¸ç±»å‹æ“¦é™¤</strong></p>\n<p>Javaè¯­è¨€å¹¶ä¸æ˜¯ä¸€å¼€å§‹å°±æ”¯æŒæ³›å‹çš„ã€‚åœ¨æ—©æœŸçš„JDKä¸­ï¼Œåªèƒ½é€šè¿‡Objectç±»æ˜¯æ‰€æœ‰ç±»å‹çš„çˆ¶ç±»å’Œå¼ºåˆ¶ç±»å‹è½¬æ¢æ¥å®ç°æ³›å‹çš„åŠŸèƒ½ã€‚å¼ºåˆ¶ç±»å‹è½¬æ¢çš„ç¼ºç‚¹å°±æ˜¯æŠŠç¼–è¯‘æœŸé—´çš„é—®é¢˜å»¶è¿Ÿåˆ°è¿è¡Œæ—¶ï¼ŒJVMå¹¶ä¸èƒ½ä¸ºæˆ‘ä»¬æä¾›ç¼–è¯‘æœŸé—´çš„æ£€æŸ¥ã€‚</p>\n<p>åœ¨JDK1.5ä¸­ï¼ŒJavaè¯­è¨€å¼•å…¥äº†æ³›å‹æœºåˆ¶ã€‚ä½†æ˜¯è¿™ç§æ³›å‹æœºåˆ¶æ˜¯é€šè¿‡ç±»å‹æ“¦é™¤æ¥å®ç°çš„ï¼Œå³Javaä¸­çš„æ³›å‹åªåœ¨ç¨‹åºæºä»£ç ä¸­æœ‰æ•ˆï¼ˆæºä»£ç é˜¶æ®µæä¾›ç±»å‹æ£€æŸ¥ï¼‰ï¼Œåœ¨ç¼–è¯‘åçš„å­—èŠ‚ç ä¸­è‡ªåŠ¨ç”¨å¼ºåˆ¶ç±»å‹è½¬æ¢è¿›è¡Œæ›¿ä»£ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒJavaè¯­è¨€ä¸­çš„æ³›å‹æœºåˆ¶å…¶å®å°±æ˜¯ä¸€é¢—è¯­æ³•ç³–ï¼Œç›¸è¾ƒä¸C++ã€C#ç›¸æ¯”ï¼Œå…¶æ³›å‹å®ç°å®åœ¨æ˜¯ä¸é‚£ä¹ˆä¼˜é›…ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n* åœ¨æºä»£ç ä¸­å­˜åœ¨æ³›å‹\n*&#x2F;\npublic static void main(String[] args) &#123;\n    Map&lt;String,String&gt; map &#x3D; new HashMap&lt;String,String&gt;();\n    map.put(&quot;hello&quot;,&quot;ä½ å¥½&quot;);\n    String hello &#x3D; map.get(&quot;hello&quot;);\n    System.out.println(hello);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å½“ä¸Šè¿°æºä»£ç è¢«ç¼–è¯‘ä¸ºclassæ–‡ä»¶åï¼Œæ³›å‹è¢«æ“¦é™¤ä¸”å¼•å…¥å¼ºåˆ¶ç±»å‹è½¬æ¢</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n    HashMap map &#x3D; new HashMap(); &#x2F;&#x2F;ç±»å‹æ“¦é™¤\n    map.put(&quot;hello&quot;, &quot;ä½ å¥½&quot;);\n    String hello &#x3D; (String)map.get(&quot;hello&quot;);&#x2F;&#x2F;å¼ºåˆ¶è½¬æ¢\n    System.out.println(hello);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n<p><strong>è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±</strong></p>\n<p>Javaä¸­çš„è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±æŒ‡çš„æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ä¸ä»–ä»¬çš„åŒ…è£…ç±»å‹ä¹‹é—´çš„ç›¸äº’è½¬æ¢ã€‚</p>\n<p>æˆ‘ä»¬çŸ¥é“Javaæ˜¯ä¸€é—¨é¢å‘å¯¹è±¡çš„è¯­è¨€ï¼Œåœ¨Javaä¸–ç•Œä¸­æœ‰ä¸€å¥è¯æ˜¯è¿™ä¹ˆè¯´çš„ï¼šâ€œä¸‡ç‰©çš†å¯¹è±¡â€ã€‚ä½†æ˜¯Javaä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹å´ä¸æ˜¯å¯¹è±¡ï¼Œä»–ä»¬ä¸éœ€è¦è¿›è¡Œnewæ“ä½œï¼Œä¹Ÿä¸èƒ½è°ƒç”¨ä»»ä½•æ–¹æ³•ï¼Œè¿™åœ¨ä½¿ç”¨çš„æ—¶å€™æœ‰è¯¸å¤šä¸ä¾¿ã€‚å› æ­¤Javaä¸ºè¿™äº›åŸºæœ¬ç±»å‹æä¾›äº†åŒ…è£…ç±»ï¼Œå¹¶ä¸”ä¸ºäº†ä½¿ç”¨æ–¹ä¾¿ï¼Œæä¾›äº†è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±åŠŸèƒ½ã€‚è‡ªåŠ¨è£…ç®±ä¸æ‹†ç®±åœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ï¼Œå…¶å®æ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œå†…éƒ¨è¿˜æ˜¯è°ƒç”¨äº†ç›¸åº”çš„å‡½æ•°è¿›è¡Œè½¬æ¢ã€‚</p>\n<p>ä¸‹é¢ä»£ç æ¼”ç¤ºäº†è‡ªåŠ¨è£…ç®±å’Œæ‹†ç®±åŠŸèƒ½</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n    Integer a &#x3D; 1;\n    int b &#x3D; 2;\n    int c &#x3D; a + b;\n    System.out.println(c);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç»è¿‡ç¼–è¯‘åï¼Œä»£ç å¦‚ä¸‹</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n    Integer a &#x3D; Integer.valueOf(1); &#x2F;&#x2F; è‡ªåŠ¨è£…ç®±\n    byte b &#x3D; 2;\n    int c &#x3D; a.intValue() + b;&#x2F;&#x2F;è‡ªåŠ¨æ‹†ç®±\n    System.out.println(c);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>å˜é•¿å‚æ•°</strong></p>\n<p>æ‰€è°“å˜é•¿å‚æ•°ï¼Œå°±æ˜¯æ–¹æ³•å¯ä»¥æ¥å—é•¿åº¦ä¸å®šç¡®å®šçš„å‚æ•°ã€‚å˜é•¿å‚æ•°ç‰¹æ€§æ˜¯åœ¨JDK1.5ä¸­å¼•å…¥çš„ï¼Œä½¿ç”¨å˜é•¿å‚æ•°æœ‰ä¸¤ä¸ªæ¡ä»¶ï¼Œä¸€æ˜¯å˜é•¿çš„é‚£ä¸€éƒ¨åˆ†å‚æ•°å…·æœ‰ç›¸åŒçš„ç±»å‹ï¼ŒäºŒæ˜¯å˜é•¿å‚æ•°å¿…é¡»ä½äºæ–¹æ³•å‚æ•°åˆ—è¡¨çš„æœ€åé¢ã€‚å˜é•¿å‚æ•°åŒæ ·æ˜¯Javaä¸­çš„è¯­æ³•ç³–ï¼Œå…¶å†…éƒ¨å®ç°æ˜¯Javaæ•°ç»„ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class Varargs &#123;\n    public static void print(String... args) &#123;\n        for(String str : args)&#123;\n            System.out.println(str);\n        &#125;\n    &#125;\n\n    public static void main(String[] args) &#123;\n        print(&quot;hello&quot;, &quot;world&quot;);\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¼–è¯‘ä¸ºclassæ–‡ä»¶åå¦‚ä¸‹ï¼Œä»ä¸­å¯ä»¥å¾ˆæ˜æ˜¾çš„çœ‹å‡ºå˜é•¿å‚æ•°å†…éƒ¨æ˜¯é€šè¿‡æ•°ç»„å®ç°çš„</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class Varargs &#123;\n    public Varargs() &#123;\n    &#125;\n\n    public static void print(String... args) &#123;\n        String[] var1 &#x3D; args;\n        int var2 &#x3D; args.length;\n        &#x2F;&#x2F;å¢å¼ºforå¾ªç¯çš„æ•°ç»„å®ç°æ–¹å¼\n        for(int var3 &#x3D; 0; var3 &lt; var2; ++var3) &#123;\n            String str &#x3D; var1[var3];\n            System.out.println(str);\n        &#125;\n\n    &#125;\n\n    public static void main(String[] args) &#123;\n        &#x2F;&#x2F;å˜é•¿å‚æ•°è½¬æ¢ä¸ºæ•°ç»„\n        print(new String[]&#123;&quot;hello&quot;, &quot;world&quot;&#125;);\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>å¢å¼ºforå¾ªç¯</strong></p>\n<p>å¢å¼ºforå¾ªç¯ä¸æ™®é€šforå¾ªç¯ç›¸æ¯”ï¼ŒåŠŸèƒ½æ›´å¼ºå¹¶ä¸”ä»£ç æ›´ç®€æ´ã€‚å¢å¼ºforå¾ªç¯çš„å¯¹è±¡è¦ä¹ˆæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¦ä¹ˆå®ç°äº†Iterableæ¥å£ã€‚è¿™ä¸ªè¯­æ³•ç³–ä¸»è¦ç”¨æ¥å¯¹æ•°ç»„æˆ–è€…é›†åˆè¿›è¡Œéå†ï¼Œå…¶åœ¨å¾ªç¯è¿‡ç¨‹ä¸­ä¸èƒ½æ”¹å˜é›†åˆçš„å¤§å°ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n    String[] params &#x3D; new String[]&#123;&quot;hello&quot;,&quot;world&quot;&#125;;\n    &#x2F;&#x2F;å¢å¼ºforå¾ªç¯å¯¹è±¡ä¸ºæ•°ç»„\n    for(String str : params)&#123;\n        System.out.println(str);\n    &#125;\n\n    List&lt;String&gt; lists &#x3D; Arrays.asList(&quot;hello&quot;,&quot;world&quot;);\n    &#x2F;&#x2F;å¢å¼ºforå¾ªç¯å¯¹è±¡å®ç°Iterableæ¥å£\n    for(String str : lists)&#123;\n        System.out.println(str);\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¼–è¯‘åçš„classæ–‡ä»¶ä¸º</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n   String[] params &#x3D; new String[]&#123;&quot;hello&quot;, &quot;world&quot;&#125;;\n   String[] lists &#x3D; params;\n   int var3 &#x3D; params.length;\n   &#x2F;&#x2F;æ•°ç»„å½¢å¼çš„å¢å¼ºforé€€åŒ–ä¸ºæ™®é€šfor\n   for(int str &#x3D; 0; str &lt; var3; ++str) &#123;\n       String str1 &#x3D; lists[str];\n       System.out.println(str1);\n   &#125;\n\n   List var6 &#x3D; Arrays.asList(new String[]&#123;&quot;hello&quot;, &quot;world&quot;&#125;);\n   Iterator var7 &#x3D; var6.iterator();\n   &#x2F;&#x2F;å®ç°Iterableæ¥å£çš„å¢å¼ºforä½¿ç”¨iteratoræ¥å£è¿›è¡Œéå†\n   while(var7.hasNext()) &#123;\n       String var8 &#x3D; (String)var7.next();\n       System.out.println(var8);\n   &#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>å†…éƒ¨ç±»</strong></p>\n<p>å†…éƒ¨ç±»å°±æ˜¯å®šä¹‰åœ¨ä¸€ä¸ªç±»å†…éƒ¨çš„ç±»<br>Javaè¯­è¨€ä¸­ä¹‹æ‰€ä»¥å¼•å…¥å†…éƒ¨ç±»ï¼Œæ˜¯å› ä¸ºæœ‰äº›æ—¶å€™ä¸€ä¸ªç±»åªåœ¨å¦ä¸€ä¸ªç±»ä¸­æœ‰ç”¨ï¼Œæˆ‘ä»¬ä¸æƒ³è®©å…¶åœ¨å¦å¤–ä¸€ä¸ªåœ°æ–¹è¢«ä½¿ç”¨ã€‚å†…éƒ¨ç±»ä¹‹æ‰€ä»¥æ˜¯è¯­æ³•ç³–ï¼Œæ˜¯å› ä¸ºå…¶åªæ˜¯ä¸€ä¸ªç¼–è¯‘æ—¶çš„æ¦‚å¿µï¼Œä¸€æ—¦ç¼–è¯‘å®Œæˆï¼Œç¼–è¯‘å™¨å°±ä¼šä¸ºå†…éƒ¨ç±»ç”Ÿæˆä¸€ä¸ªå•ç‹¬çš„classæ–‡ä»¶ï¼Œåä¸ºouter$innter.classã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class Outer &#123;\n    class Inner&#123;\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä½¿ç”¨javacç¼–è¯‘åï¼Œç”Ÿæˆä¸¤ä¸ªclassæ–‡ä»¶Outer.classå’ŒOuter$Inner.classï¼Œå…¶ä¸­Outer$Inner.classçš„å†…å®¹å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">class Outer$Inner &#123;\n    Outer$Inner(Outer var1) &#123;\n        this.this$0 &#x3D; var1;\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å†…éƒ¨ç±»åˆ†ä¸ºå››ç§ï¼šæˆå‘˜å†…éƒ¨ç±»ã€å±€éƒ¨å†…éƒ¨ç±»ã€åŒ¿åå†…éƒ¨ç±»ã€é™æ€å†…éƒ¨ç±»ï¼Œæ¯ä¸€ç§éƒ½æœ‰å…¶ç”¨æ³•ï¼Œè¿™é‡Œå°±ä¸ä»‹ç»äº†</p>\n<p><strong>æšä¸¾ç±»å‹</strong></p>\n<p>æšä¸¾ç±»å‹å°±æ˜¯ä¸€äº›å…·æœ‰ç›¸åŒç‰¹æ€§çš„ç±»å¸¸é‡<br>javaä¸­ç±»çš„å®šä¹‰ä½¿ç”¨classï¼Œæšä¸¾ç±»çš„å®šä¹‰ä½¿ç”¨enumã€‚åœ¨Javaçš„å­—èŠ‚ç ç»“æ„ä¸­ï¼Œå…¶å®å¹¶æ²¡æœ‰æšä¸¾ç±»å‹ï¼Œæšä¸¾ç±»å‹åªæ˜¯ä¸€ä¸ªè¯­æ³•ç³–ï¼Œåœ¨ç¼–è¯‘å®Œæˆåè¢«ç¼–è¯‘æˆä¸€ä¸ªæ™®é€šçš„ç±»ã€‚è¿™ä¸ªç±»ç»§æ‰¿java.lang.Enumï¼Œå¹¶è¢«finalå…³é”®å­—ä¿®é¥°ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public enum Fruit &#123;\n    APPLE,ORINGE\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ä½¿ç”¨jadå¯¹ç¼–è¯‘åçš„classæ–‡ä»¶è¿›è¡Œåç¼–è¯‘åå¾—åˆ°ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F;ç»§æ‰¿java.lang.Enumå¹¶å£°æ˜ä¸ºfinal\npublic final class Fruit extends Enum\n&#123;\n\n    public static Fruit[] values()\n    &#123;\n        return (Fruit[])$VALUES.clone();\n    &#125;\n\n    public static Fruit valueOf(String s)\n    &#123;\n        return (Fruit)Enum.valueOf(Fruit, s);\n    &#125;\n\n    private Fruit(String s, int i)\n    &#123;\n        super(s, i);\n    &#125;\n    &#x2F;&#x2F;æšä¸¾ç±»å‹å¸¸é‡\n    public static final Fruit APPLE;\n    public static final Fruit ORANGE;\n    private static final Fruit $VALUES[];&#x2F;&#x2F;ä½¿ç”¨æ•°ç»„è¿›è¡Œç»´æŠ¤\n\n    static\n    &#123;\n        APPLE &#x3D; new Fruit(&quot;APPLE&quot;, 0);\n        ORANGE &#x3D; new Fruit(&quot;ORANGE&quot;, 1);\n        $VALUES &#x3D; (new Fruit[] &#123;\n            APPLE, ORANGE\n        &#125;);\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Javaè¿œä¸æ­¢è¿™äº›è¯­æ³•ç³–ï¼ŒJDK7ã€JDK8æ·»åŠ çš„æ–°ç‰¹æ€§éƒ½æœ‰å¾ˆå¤šé«˜çº§çš„è¯­æ³•ç³–ã€‚</p>\n"},{"title":"Java ä¸­çš„ä¼ªå…±äº«è¯¦è§£åŠè§£å†³æ–¹æ¡ˆ","date":"2025-10-15T03:36:33.000Z","_content":"\n#### 1. ä»€ä¹ˆæ˜¯ä¼ªå…±äº«\n\nCPU ç¼“å­˜ç³»ç»Ÿä¸­æ˜¯ä»¥ç¼“å­˜è¡Œï¼ˆcache lineï¼‰ä¸ºå•ä½å­˜å‚¨çš„ã€‚ç›®å‰ä¸»æµçš„ CPU Cache çš„ Cache Line å¤§å°éƒ½æ˜¯ 64 Bytesã€‚åœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹ï¼Œå¦‚æœéœ€è¦ä¿®æ”¹â€œå…±äº«åŒä¸€ä¸ªç¼“å­˜è¡Œçš„å˜é‡â€ï¼Œå°±ä¼šæ— æ„ä¸­å½±å“å½¼æ­¤çš„æ€§èƒ½ï¼Œè¿™å°±æ˜¯ä¼ªå…±äº«ï¼ˆFalse Sharingï¼‰ã€‚\n\n#### 2. ç¼“å­˜è¡Œ\n\nç”±äºå…±äº«å˜é‡åœ¨ CPU ç¼“å­˜ä¸­çš„å­˜å‚¨æ˜¯ä»¥ç¼“å­˜è¡Œä¸ºå•ä½ï¼Œä¸€ä¸ªç¼“å­˜è¡Œå¯ä»¥å­˜å‚¨å¤šä¸ªå˜é‡ï¼ˆå­˜æ»¡å½“å‰ç¼“å­˜è¡Œçš„å­—èŠ‚æ•°ï¼‰ï¼›è€ŒCPUå¯¹ç¼“å­˜çš„ä¿®æ”¹åˆæ˜¯ä»¥ç¼“å­˜è¡Œä¸ºæœ€å°å•ä½çš„ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°ä¸Šè¯‰çš„ä¼ªå…±äº«é—®é¢˜ã€‚\n\nCache Line å¯ä»¥ç®€å•çš„ç†è§£ä¸º CPU Cache ä¸­çš„æœ€å°ç¼“å­˜å•ä½ï¼Œä»Šå¤©çš„ CPU ä¸å†æ˜¯æŒ‰å­—èŠ‚è®¿é—®å†…å­˜ï¼Œè€Œæ˜¯ä»¥ 64 å­—èŠ‚ä¸ºå•ä½çš„å—(chunk)æ‹¿å–ï¼Œç§°ä¸ºä¸€ä¸ªç¼“å­˜è¡Œ(cache line)ã€‚å½“ä½ è¯»ä¸€ä¸ªç‰¹å®šçš„å†…å­˜åœ°å€ï¼Œæ•´ä¸ªç¼“å­˜è¡Œå°†ä»ä¸»å­˜æ¢å…¥ç¼“å­˜ï¼Œå¹¶ä¸”è®¿é—®åŒä¸€ä¸ªç¼“å­˜è¡Œå†…çš„å…¶å®ƒå€¼çš„å¼€é”€æ˜¯å¾ˆå°çš„ã€‚\n\n#### 3. CPU çš„ä¸‰çº§ç¼“å­˜\n\nç”±äº CPU çš„é€Ÿåº¦è¿œè¿œå¤§äºå†…å­˜é€Ÿåº¦ï¼Œæ‰€ä»¥ CPU è®¾è®¡è€…ä»¬å°±ç»™ CPU åŠ ä¸Šäº†ç¼“å­˜(CPU Cache)ã€‚ ä»¥å…è¿ç®—è¢«å†…å­˜é€Ÿåº¦æ‹–ç´¯ã€‚ï¼ˆå°±åƒæˆ‘ä»¬å†™ä»£ç æŠŠå…±äº«æ•°æ®åšCacheä¸æƒ³è¢«DBå­˜å–é€Ÿåº¦æ‹–ç´¯ä¸€æ ·ï¼‰ï¼ŒCPU Cache åˆ†æˆäº†ä¸‰ä¸ªçº§åˆ«ï¼šL1ï¼ŒL2ï¼ŒL3ã€‚è¶Šé è¿‘CPUçš„ç¼“å­˜è¶Šå¿«ä¹Ÿè¶Šå°ã€‚æ‰€ ä»¥L1 ç¼“å­˜å¾ˆå°ä½†å¾ˆå¿«ï¼Œå¹¶ä¸”ç´§é ç€åœ¨ä½¿ç”¨å®ƒçš„ CPU å†…æ ¸ã€‚L2 å¤§ä¸€äº›ï¼Œä¹Ÿæ…¢ä¸€äº›ï¼Œå¹¶ä¸”ä»ç„¶åªèƒ½è¢«ä¸€ä¸ªå•ç‹¬çš„ CPU æ ¸ä½¿ç”¨ã€‚L3 åœ¨ç°ä»£å¤šæ ¸æœºå™¨ä¸­æ›´æ™®éï¼Œä»ç„¶æ›´å¤§ï¼Œæ›´æ…¢ï¼Œå¹¶ä¸”è¢«å•ä¸ªæ’æ§½ä¸Šçš„æ‰€æœ‰ CPU æ ¸å…±äº«ã€‚æœ€åï¼Œä½ æ‹¥æœ‰ä¸€å—ä¸»å­˜ï¼Œç”±å…¨éƒ¨æ’æ§½ä¸Šçš„æ‰€æœ‰ CPU æ ¸å…±äº«ã€‚\n\nå½“ CPU æ‰§è¡Œè¿ç®—çš„æ—¶å€™ï¼Œå®ƒå…ˆå»L1æŸ¥æ‰¾æ‰€éœ€çš„æ•°æ®ï¼Œå†å»L2ï¼Œç„¶åæ˜¯L3ï¼Œæœ€åå¦‚æœè¿™äº›ç¼“å­˜ä¸­éƒ½æ²¡æœ‰ï¼Œæ‰€éœ€çš„æ•°æ®å°±è¦å»ä¸»å†…å­˜æ‹¿ã€‚èµ°å¾—è¶Šè¿œï¼Œè¿ç®—è€—è´¹çš„æ—¶é—´å°±è¶Šé•¿ã€‚æ‰€ä»¥å¦‚æœä½ åœ¨åšä¸€äº›å¾ˆé¢‘ç¹çš„äº‹ï¼Œä½ è¦ç¡®ä¿æ•°æ®åœ¨L1ç¼“å­˜ä¸­ã€‚\n\n![](http://img.javastack.cn/18-5-31/91078691.jpg)\n\n#### 4. ç¼“å­˜å…³è”æ€§\n\nç›®å‰å¸¸ç”¨çš„ç¼“å­˜è®¾è®¡æ˜¯Nè·¯ç»„å…³è”(N-Way Set Associative Cache)ï¼Œä»–çš„åŸç†æ˜¯æŠŠä¸€ä¸ªç¼“å­˜æŒ‰ç…§Nä¸ª Cache Line ä½œä¸ºä¸€ç»„ï¼ˆSetï¼‰ï¼Œç¼“å­˜æŒ‰ç»„åˆ’ä¸ºç­‰åˆ†ã€‚æ¯ä¸ªå†…å­˜å—èƒ½å¤Ÿè¢«æ˜ å°„åˆ°ç›¸å¯¹åº”çš„setä¸­çš„ä»»æ„ä¸€ä¸ªç¼“å­˜è¡Œä¸­ã€‚æ¯”å¦‚ä¸€ä¸ª16è·¯ç¼“å­˜ï¼Œ16ä¸ª Cache Line ä½œä¸ºä¸€ä¸ªSetï¼Œæ¯ä¸ªå†…å­˜å—èƒ½å¤Ÿè¢«æ˜ å°„åˆ°ç›¸å¯¹åº”çš„ Set ä¸­çš„16ä¸ª CacheLine ä¸­çš„ä»»æ„ä¸€ä¸ªã€‚ä¸€èˆ¬åœ°ï¼Œå…·æœ‰ä¸€å®šç›¸åŒä½bitä½åœ°å€çš„å†…å­˜å—å°†å…±äº«åŒä¸€ä¸ªSetã€‚ \n\nä¸‹å›¾ä¸ºä¸€ä¸ª2-Wayçš„Cacheã€‚ç”±å›¾ä¸­å¯ä»¥çœ‹åˆ° Main Memory ä¸­çš„ Index 0,2,4 éƒ½æ˜ å°„åœ¨Way0çš„ä¸åŒ CacheLine ä¸­ï¼ŒIndex 1,3,5éƒ½æ˜ å°„åœ¨Way1çš„ä¸åŒ CacheLine ä¸­ã€‚\n\n![](http://img.javastack.cn/18-5-31/71458405.jpg)\n\n#### 5. MESI åè®®\n\nå¤šæ ¸ CPU éƒ½æœ‰è‡ªå·±çš„ä¸“æœ‰ç¼“å­˜ï¼ˆä¸€èˆ¬ä¸ºL1ï¼ŒL2ï¼‰ï¼Œä»¥åŠåŒä¸€ä¸ª CPU æ’æ§½ä¹‹é—´çš„æ ¸å…±äº«çš„ç¼“å­˜ï¼ˆä¸€èˆ¬ä¸ºL3ï¼‰ã€‚ä¸åŒæ ¸å¿ƒçš„CPUç¼“å­˜ä¸­éš¾å…ä¼šåŠ è½½åŒæ ·çš„æ•°æ®ï¼Œé‚£ä¹ˆå¦‚ä½•ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§å‘¢ï¼Œå°±æ˜¯ MESI åè®®äº†ã€‚\n\nåœ¨ MESI åè®®ä¸­ï¼Œæ¯ä¸ª Cache line æœ‰4ä¸ªçŠ¶æ€ï¼Œå¯ç”¨ 2 ä¸ª bit è¡¨ç¤ºï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ï¼š \nM(Modified)ï¼šè¿™è¡Œæ•°æ®æœ‰æ•ˆï¼Œæ•°æ®è¢«ä¿®æ”¹äº†ï¼Œå’Œå†…å­˜ä¸­çš„æ•°æ®ä¸ä¸€è‡´ï¼Œæ•°æ®åªå­˜åœ¨äºæœ¬ Cache ä¸­ï¼› \nE(Exclusive)ï¼šè¿™è¡Œæ•°æ®æœ‰æ•ˆï¼Œæ•°æ®å’Œå†…å­˜ä¸­çš„æ•°æ®ä¸€è‡´ï¼Œæ•°æ®åªå­˜åœ¨äºæœ¬ Cache ä¸­ï¼› \nS(Shared)ï¼šè¿™è¡Œæ•°æ®æœ‰æ•ˆï¼Œæ•°æ®å’Œå†…å­˜ä¸­çš„æ•°æ®ä¸€è‡´ï¼Œæ•°æ®å­˜åœ¨äºå¾ˆå¤š Cache ä¸­ï¼› \nI(Invalid)ï¼šè¿™è¡Œæ•°æ®æ— æ•ˆã€‚\n\né‚£ä¹ˆï¼Œå‡è®¾æœ‰ä¸€ä¸ªå˜é‡i=3ï¼ˆåº”è¯¥æ˜¯åŒ…æ‹¬å˜é‡içš„ç¼“å­˜å—ï¼Œå—å¤§å°ä¸ºç¼“å­˜è¡Œå¤§å°ï¼‰ï¼›å·²ç»åŠ è½½åˆ°å¤šæ ¸ï¼ˆa,b,cï¼‰çš„ç¼“å­˜ä¸­ï¼Œæ­¤æ—¶è¯¥ç¼“å­˜è¡Œçš„çŠ¶æ€ä¸ºSï¼›æ­¤æ—¶å…¶ä¸­çš„ä¸€ä¸ªæ ¸aæ”¹å˜äº†å˜é‡içš„å€¼ï¼Œé‚£ä¹ˆåœ¨æ ¸aä¸­çš„å½“å‰ç¼“å­˜è¡Œçš„çŠ¶æ€å°†å˜ä¸ºMï¼Œb,cæ ¸ä¸­çš„å½“å‰ç¼“å­˜è¡ŒçŠ¶æ€å°†å˜ä¸ºIã€‚å¦‚ä¸‹å›¾ï¼š\n\n![](http://img.javastack.cn/18-5-31/66429246.jpg)\n\n#### 6. è§£å†³åŸç†\n\nä¸ºäº†é¿å…ç”±äº false sharing å¯¼è‡´ Cache Line ä» L1,L2,L3 åˆ°ä¸»å­˜ä¹‹é—´é‡å¤è½½å…¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ•°æ®å¡«å……çš„æ–¹å¼æ¥é¿å…ï¼Œå³å•ä¸ªæ•°æ®å¡«å……æ»¡ä¸€ä¸ªCacheLineã€‚è¿™æœ¬è´¨æ˜¯ä¸€ç§ç©ºé—´æ¢æ—¶é—´çš„åšæ³•ã€‚\n\n#### 7. Java å¯¹äºä¼ªå…±äº«çš„ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ\n\n```\n/***\n* \n**/\nimport java.util.concurrent.atomic.AtomicLong;\n\npublic final class FalseSharing\n    implements Runnable\n{\n    public final static int NUM_THREADS = 4; // change\n    public final static long ITERATIONS = 500L * 1000L * 1000L;\n    private final int arrayIndex;\n\n    private static VolatileLong[] longs = new VolatileLong[NUM_THREADS];\n    static\n    {\n        for (int i = 0; i < longs.length; i++)\n        {\n            longs[i] = new VolatileLong();\n        }\n    }\n\n    public FalseSharing(final int arrayIndex)\n    {\n        this.arrayIndex = arrayIndex;\n    }\n\n    public static void main(final String[] args) throws Exception\n    {\n        final long start = System.nanoTime();\n        runTest();\n        System.out.println(\"duration = \" + (System.nanoTime() - start));\n    }\n\n    private static void runTest() throws InterruptedException\n    {\n        Thread[] threads = new Thread[NUM_THREADS];\n\n        for (int i = 0; i < threads.length; i++)\n        {\n            threads[i] = new Thread(new FalseSharing(i));\n        }\n\n        for (Thread t : threads)\n        {\n            t.start();\n        }\n\n        for (Thread t : threads)\n        {\n            t.join();\n        }\n    }\n\n    public void run()\n    {\n        long i = ITERATIONS + 1;\n        while (0 != --i)\n        {\n            longs[arrayIndex].set(i);\n        }\n    }\n\n    public static long sumPaddingToPreventOptimisation(final int index)\n    {\n        VolatileLong v = longs[index];\n        return v.p1 + v.p2 + v.p3 + v.p4 + v.p5 + v.p6;\n    }\n\n    //jdk7ä»¥ä¸Šä½¿ç”¨æ­¤æ–¹æ³•(jdk7çš„æŸä¸ªç‰ˆæœ¬oracleå¯¹ä¼ªå…±äº«åšäº†ä¼˜åŒ–)\n    public final static class VolatileLong\n    {\n        public volatile long value = 0L;\n        public long p1, p2, p3, p4, p5, p6;\n    }\n\n    // jdk7ä»¥ä¸‹ä½¿ç”¨æ­¤æ–¹æ³•\n    public final static class VolatileLong\n    {\n        public long p1, p2, p3, p4, p5, p6, p7; // cache line padding\n        public volatile long value = 0L;\n        public long p8, p9, p10, p11, p12, p13, p14; // cache line padding\n\n    }\n}\n```\n\n\n#### 8. Java 8 ä¸­çš„è§£å†³æ–¹æ¡ˆ\n\nJava 8 ä¸­å·²ç»æä¾›äº†å®˜æ–¹çš„è§£å†³æ–¹æ¡ˆï¼ŒJava 8 ä¸­æ–°å¢äº†ä¸€ä¸ªæ³¨è§£ï¼š`@sun.misc.Contended`ã€‚åŠ ä¸Šè¿™ä¸ªæ³¨è§£çš„ç±»ä¼šè‡ªåŠ¨è¡¥é½ç¼“å­˜è¡Œï¼Œéœ€è¦æ³¨æ„çš„æ˜¯æ­¤æ³¨è§£é»˜è®¤æ˜¯æ— æ•ˆçš„ï¼Œéœ€è¦åœ¨ jvm å¯åŠ¨æ—¶è®¾ç½® `-XX:-RestrictContended` æ‰ä¼šç”Ÿæ•ˆã€‚\n\n\n```\n@sun.misc.Contended\npublic final static class VolatileLong {\n    public volatile long value = 0L;\n    //public long p1, p2, p3, p4, p5, p6;\n```\n\n\n#### å‚è€ƒæ–‡çŒ®\n\n> http://igoro.com/archive/gallery-of-processor-cache-effects/\n> http://ifeve.com/false-sharing/ \n> http://blog.csdn.net/muxiqingyang/article/details/6615199 \n> https://yq.aliyun.com/articles/62865\n\n@ç å†œä»¬ï¼Œä½ ä»¬æ˜¯æ€ä¹ˆç†è§£å’Œè§£å†³ä¼ªå…±äº«çš„ï¼Ÿæ¬¢è¿ç•™è¨€ï¼\n\n","source":"_posts/è¿›é˜¶/Java ä¸­çš„ä¼ªå…±äº«è¯¦è§£åŠè§£å†³æ–¹æ¡ˆ.md","raw":"---\ntitle: Java ä¸­çš„ä¼ªå…±äº«è¯¦è§£åŠè§£å†³æ–¹æ¡ˆ\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: è¿›é˜¶\n---\n\n#### 1. ä»€ä¹ˆæ˜¯ä¼ªå…±äº«\n\nCPU ç¼“å­˜ç³»ç»Ÿä¸­æ˜¯ä»¥ç¼“å­˜è¡Œï¼ˆcache lineï¼‰ä¸ºå•ä½å­˜å‚¨çš„ã€‚ç›®å‰ä¸»æµçš„ CPU Cache çš„ Cache Line å¤§å°éƒ½æ˜¯ 64 Bytesã€‚åœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹ï¼Œå¦‚æœéœ€è¦ä¿®æ”¹â€œå…±äº«åŒä¸€ä¸ªç¼“å­˜è¡Œçš„å˜é‡â€ï¼Œå°±ä¼šæ— æ„ä¸­å½±å“å½¼æ­¤çš„æ€§èƒ½ï¼Œè¿™å°±æ˜¯ä¼ªå…±äº«ï¼ˆFalse Sharingï¼‰ã€‚\n\n#### 2. ç¼“å­˜è¡Œ\n\nç”±äºå…±äº«å˜é‡åœ¨ CPU ç¼“å­˜ä¸­çš„å­˜å‚¨æ˜¯ä»¥ç¼“å­˜è¡Œä¸ºå•ä½ï¼Œä¸€ä¸ªç¼“å­˜è¡Œå¯ä»¥å­˜å‚¨å¤šä¸ªå˜é‡ï¼ˆå­˜æ»¡å½“å‰ç¼“å­˜è¡Œçš„å­—èŠ‚æ•°ï¼‰ï¼›è€ŒCPUå¯¹ç¼“å­˜çš„ä¿®æ”¹åˆæ˜¯ä»¥ç¼“å­˜è¡Œä¸ºæœ€å°å•ä½çš„ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°ä¸Šè¯‰çš„ä¼ªå…±äº«é—®é¢˜ã€‚\n\nCache Line å¯ä»¥ç®€å•çš„ç†è§£ä¸º CPU Cache ä¸­çš„æœ€å°ç¼“å­˜å•ä½ï¼Œä»Šå¤©çš„ CPU ä¸å†æ˜¯æŒ‰å­—èŠ‚è®¿é—®å†…å­˜ï¼Œè€Œæ˜¯ä»¥ 64 å­—èŠ‚ä¸ºå•ä½çš„å—(chunk)æ‹¿å–ï¼Œç§°ä¸ºä¸€ä¸ªç¼“å­˜è¡Œ(cache line)ã€‚å½“ä½ è¯»ä¸€ä¸ªç‰¹å®šçš„å†…å­˜åœ°å€ï¼Œæ•´ä¸ªç¼“å­˜è¡Œå°†ä»ä¸»å­˜æ¢å…¥ç¼“å­˜ï¼Œå¹¶ä¸”è®¿é—®åŒä¸€ä¸ªç¼“å­˜è¡Œå†…çš„å…¶å®ƒå€¼çš„å¼€é”€æ˜¯å¾ˆå°çš„ã€‚\n\n#### 3. CPU çš„ä¸‰çº§ç¼“å­˜\n\nç”±äº CPU çš„é€Ÿåº¦è¿œè¿œå¤§äºå†…å­˜é€Ÿåº¦ï¼Œæ‰€ä»¥ CPU è®¾è®¡è€…ä»¬å°±ç»™ CPU åŠ ä¸Šäº†ç¼“å­˜(CPU Cache)ã€‚ ä»¥å…è¿ç®—è¢«å†…å­˜é€Ÿåº¦æ‹–ç´¯ã€‚ï¼ˆå°±åƒæˆ‘ä»¬å†™ä»£ç æŠŠå…±äº«æ•°æ®åšCacheä¸æƒ³è¢«DBå­˜å–é€Ÿåº¦æ‹–ç´¯ä¸€æ ·ï¼‰ï¼ŒCPU Cache åˆ†æˆäº†ä¸‰ä¸ªçº§åˆ«ï¼šL1ï¼ŒL2ï¼ŒL3ã€‚è¶Šé è¿‘CPUçš„ç¼“å­˜è¶Šå¿«ä¹Ÿè¶Šå°ã€‚æ‰€ ä»¥L1 ç¼“å­˜å¾ˆå°ä½†å¾ˆå¿«ï¼Œå¹¶ä¸”ç´§é ç€åœ¨ä½¿ç”¨å®ƒçš„ CPU å†…æ ¸ã€‚L2 å¤§ä¸€äº›ï¼Œä¹Ÿæ…¢ä¸€äº›ï¼Œå¹¶ä¸”ä»ç„¶åªèƒ½è¢«ä¸€ä¸ªå•ç‹¬çš„ CPU æ ¸ä½¿ç”¨ã€‚L3 åœ¨ç°ä»£å¤šæ ¸æœºå™¨ä¸­æ›´æ™®éï¼Œä»ç„¶æ›´å¤§ï¼Œæ›´æ…¢ï¼Œå¹¶ä¸”è¢«å•ä¸ªæ’æ§½ä¸Šçš„æ‰€æœ‰ CPU æ ¸å…±äº«ã€‚æœ€åï¼Œä½ æ‹¥æœ‰ä¸€å—ä¸»å­˜ï¼Œç”±å…¨éƒ¨æ’æ§½ä¸Šçš„æ‰€æœ‰ CPU æ ¸å…±äº«ã€‚\n\nå½“ CPU æ‰§è¡Œè¿ç®—çš„æ—¶å€™ï¼Œå®ƒå…ˆå»L1æŸ¥æ‰¾æ‰€éœ€çš„æ•°æ®ï¼Œå†å»L2ï¼Œç„¶åæ˜¯L3ï¼Œæœ€åå¦‚æœè¿™äº›ç¼“å­˜ä¸­éƒ½æ²¡æœ‰ï¼Œæ‰€éœ€çš„æ•°æ®å°±è¦å»ä¸»å†…å­˜æ‹¿ã€‚èµ°å¾—è¶Šè¿œï¼Œè¿ç®—è€—è´¹çš„æ—¶é—´å°±è¶Šé•¿ã€‚æ‰€ä»¥å¦‚æœä½ åœ¨åšä¸€äº›å¾ˆé¢‘ç¹çš„äº‹ï¼Œä½ è¦ç¡®ä¿æ•°æ®åœ¨L1ç¼“å­˜ä¸­ã€‚\n\n![](http://img.javastack.cn/18-5-31/91078691.jpg)\n\n#### 4. ç¼“å­˜å…³è”æ€§\n\nç›®å‰å¸¸ç”¨çš„ç¼“å­˜è®¾è®¡æ˜¯Nè·¯ç»„å…³è”(N-Way Set Associative Cache)ï¼Œä»–çš„åŸç†æ˜¯æŠŠä¸€ä¸ªç¼“å­˜æŒ‰ç…§Nä¸ª Cache Line ä½œä¸ºä¸€ç»„ï¼ˆSetï¼‰ï¼Œç¼“å­˜æŒ‰ç»„åˆ’ä¸ºç­‰åˆ†ã€‚æ¯ä¸ªå†…å­˜å—èƒ½å¤Ÿè¢«æ˜ å°„åˆ°ç›¸å¯¹åº”çš„setä¸­çš„ä»»æ„ä¸€ä¸ªç¼“å­˜è¡Œä¸­ã€‚æ¯”å¦‚ä¸€ä¸ª16è·¯ç¼“å­˜ï¼Œ16ä¸ª Cache Line ä½œä¸ºä¸€ä¸ªSetï¼Œæ¯ä¸ªå†…å­˜å—èƒ½å¤Ÿè¢«æ˜ å°„åˆ°ç›¸å¯¹åº”çš„ Set ä¸­çš„16ä¸ª CacheLine ä¸­çš„ä»»æ„ä¸€ä¸ªã€‚ä¸€èˆ¬åœ°ï¼Œå…·æœ‰ä¸€å®šç›¸åŒä½bitä½åœ°å€çš„å†…å­˜å—å°†å…±äº«åŒä¸€ä¸ªSetã€‚ \n\nä¸‹å›¾ä¸ºä¸€ä¸ª2-Wayçš„Cacheã€‚ç”±å›¾ä¸­å¯ä»¥çœ‹åˆ° Main Memory ä¸­çš„ Index 0,2,4 éƒ½æ˜ å°„åœ¨Way0çš„ä¸åŒ CacheLine ä¸­ï¼ŒIndex 1,3,5éƒ½æ˜ å°„åœ¨Way1çš„ä¸åŒ CacheLine ä¸­ã€‚\n\n![](http://img.javastack.cn/18-5-31/71458405.jpg)\n\n#### 5. MESI åè®®\n\nå¤šæ ¸ CPU éƒ½æœ‰è‡ªå·±çš„ä¸“æœ‰ç¼“å­˜ï¼ˆä¸€èˆ¬ä¸ºL1ï¼ŒL2ï¼‰ï¼Œä»¥åŠåŒä¸€ä¸ª CPU æ’æ§½ä¹‹é—´çš„æ ¸å…±äº«çš„ç¼“å­˜ï¼ˆä¸€èˆ¬ä¸ºL3ï¼‰ã€‚ä¸åŒæ ¸å¿ƒçš„CPUç¼“å­˜ä¸­éš¾å…ä¼šåŠ è½½åŒæ ·çš„æ•°æ®ï¼Œé‚£ä¹ˆå¦‚ä½•ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§å‘¢ï¼Œå°±æ˜¯ MESI åè®®äº†ã€‚\n\nåœ¨ MESI åè®®ä¸­ï¼Œæ¯ä¸ª Cache line æœ‰4ä¸ªçŠ¶æ€ï¼Œå¯ç”¨ 2 ä¸ª bit è¡¨ç¤ºï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ï¼š \nM(Modified)ï¼šè¿™è¡Œæ•°æ®æœ‰æ•ˆï¼Œæ•°æ®è¢«ä¿®æ”¹äº†ï¼Œå’Œå†…å­˜ä¸­çš„æ•°æ®ä¸ä¸€è‡´ï¼Œæ•°æ®åªå­˜åœ¨äºæœ¬ Cache ä¸­ï¼› \nE(Exclusive)ï¼šè¿™è¡Œæ•°æ®æœ‰æ•ˆï¼Œæ•°æ®å’Œå†…å­˜ä¸­çš„æ•°æ®ä¸€è‡´ï¼Œæ•°æ®åªå­˜åœ¨äºæœ¬ Cache ä¸­ï¼› \nS(Shared)ï¼šè¿™è¡Œæ•°æ®æœ‰æ•ˆï¼Œæ•°æ®å’Œå†…å­˜ä¸­çš„æ•°æ®ä¸€è‡´ï¼Œæ•°æ®å­˜åœ¨äºå¾ˆå¤š Cache ä¸­ï¼› \nI(Invalid)ï¼šè¿™è¡Œæ•°æ®æ— æ•ˆã€‚\n\né‚£ä¹ˆï¼Œå‡è®¾æœ‰ä¸€ä¸ªå˜é‡i=3ï¼ˆåº”è¯¥æ˜¯åŒ…æ‹¬å˜é‡içš„ç¼“å­˜å—ï¼Œå—å¤§å°ä¸ºç¼“å­˜è¡Œå¤§å°ï¼‰ï¼›å·²ç»åŠ è½½åˆ°å¤šæ ¸ï¼ˆa,b,cï¼‰çš„ç¼“å­˜ä¸­ï¼Œæ­¤æ—¶è¯¥ç¼“å­˜è¡Œçš„çŠ¶æ€ä¸ºSï¼›æ­¤æ—¶å…¶ä¸­çš„ä¸€ä¸ªæ ¸aæ”¹å˜äº†å˜é‡içš„å€¼ï¼Œé‚£ä¹ˆåœ¨æ ¸aä¸­çš„å½“å‰ç¼“å­˜è¡Œçš„çŠ¶æ€å°†å˜ä¸ºMï¼Œb,cæ ¸ä¸­çš„å½“å‰ç¼“å­˜è¡ŒçŠ¶æ€å°†å˜ä¸ºIã€‚å¦‚ä¸‹å›¾ï¼š\n\n![](http://img.javastack.cn/18-5-31/66429246.jpg)\n\n#### 6. è§£å†³åŸç†\n\nä¸ºäº†é¿å…ç”±äº false sharing å¯¼è‡´ Cache Line ä» L1,L2,L3 åˆ°ä¸»å­˜ä¹‹é—´é‡å¤è½½å…¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ•°æ®å¡«å……çš„æ–¹å¼æ¥é¿å…ï¼Œå³å•ä¸ªæ•°æ®å¡«å……æ»¡ä¸€ä¸ªCacheLineã€‚è¿™æœ¬è´¨æ˜¯ä¸€ç§ç©ºé—´æ¢æ—¶é—´çš„åšæ³•ã€‚\n\n#### 7. Java å¯¹äºä¼ªå…±äº«çš„ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ\n\n```\n/***\n* \n**/\nimport java.util.concurrent.atomic.AtomicLong;\n\npublic final class FalseSharing\n    implements Runnable\n{\n    public final static int NUM_THREADS = 4; // change\n    public final static long ITERATIONS = 500L * 1000L * 1000L;\n    private final int arrayIndex;\n\n    private static VolatileLong[] longs = new VolatileLong[NUM_THREADS];\n    static\n    {\n        for (int i = 0; i < longs.length; i++)\n        {\n            longs[i] = new VolatileLong();\n        }\n    }\n\n    public FalseSharing(final int arrayIndex)\n    {\n        this.arrayIndex = arrayIndex;\n    }\n\n    public static void main(final String[] args) throws Exception\n    {\n        final long start = System.nanoTime();\n        runTest();\n        System.out.println(\"duration = \" + (System.nanoTime() - start));\n    }\n\n    private static void runTest() throws InterruptedException\n    {\n        Thread[] threads = new Thread[NUM_THREADS];\n\n        for (int i = 0; i < threads.length; i++)\n        {\n            threads[i] = new Thread(new FalseSharing(i));\n        }\n\n        for (Thread t : threads)\n        {\n            t.start();\n        }\n\n        for (Thread t : threads)\n        {\n            t.join();\n        }\n    }\n\n    public void run()\n    {\n        long i = ITERATIONS + 1;\n        while (0 != --i)\n        {\n            longs[arrayIndex].set(i);\n        }\n    }\n\n    public static long sumPaddingToPreventOptimisation(final int index)\n    {\n        VolatileLong v = longs[index];\n        return v.p1 + v.p2 + v.p3 + v.p4 + v.p5 + v.p6;\n    }\n\n    //jdk7ä»¥ä¸Šä½¿ç”¨æ­¤æ–¹æ³•(jdk7çš„æŸä¸ªç‰ˆæœ¬oracleå¯¹ä¼ªå…±äº«åšäº†ä¼˜åŒ–)\n    public final static class VolatileLong\n    {\n        public volatile long value = 0L;\n        public long p1, p2, p3, p4, p5, p6;\n    }\n\n    // jdk7ä»¥ä¸‹ä½¿ç”¨æ­¤æ–¹æ³•\n    public final static class VolatileLong\n    {\n        public long p1, p2, p3, p4, p5, p6, p7; // cache line padding\n        public volatile long value = 0L;\n        public long p8, p9, p10, p11, p12, p13, p14; // cache line padding\n\n    }\n}\n```\n\n\n#### 8. Java 8 ä¸­çš„è§£å†³æ–¹æ¡ˆ\n\nJava 8 ä¸­å·²ç»æä¾›äº†å®˜æ–¹çš„è§£å†³æ–¹æ¡ˆï¼ŒJava 8 ä¸­æ–°å¢äº†ä¸€ä¸ªæ³¨è§£ï¼š`@sun.misc.Contended`ã€‚åŠ ä¸Šè¿™ä¸ªæ³¨è§£çš„ç±»ä¼šè‡ªåŠ¨è¡¥é½ç¼“å­˜è¡Œï¼Œéœ€è¦æ³¨æ„çš„æ˜¯æ­¤æ³¨è§£é»˜è®¤æ˜¯æ— æ•ˆçš„ï¼Œéœ€è¦åœ¨ jvm å¯åŠ¨æ—¶è®¾ç½® `-XX:-RestrictContended` æ‰ä¼šç”Ÿæ•ˆã€‚\n\n\n```\n@sun.misc.Contended\npublic final static class VolatileLong {\n    public volatile long value = 0L;\n    //public long p1, p2, p3, p4, p5, p6;\n```\n\n\n#### å‚è€ƒæ–‡çŒ®\n\n> http://igoro.com/archive/gallery-of-processor-cache-effects/\n> http://ifeve.com/false-sharing/ \n> http://blog.csdn.net/muxiqingyang/article/details/6615199 \n> https://yq.aliyun.com/articles/62865\n\n@ç å†œä»¬ï¼Œä½ ä»¬æ˜¯æ€ä¹ˆç†è§£å’Œè§£å†³ä¼ªå…±äº«çš„ï¼Ÿæ¬¢è¿ç•™è¨€ï¼\n\n","slug":"è¿›é˜¶/Java ä¸­çš„ä¼ªå…±äº«è¯¦è§£åŠè§£å†³æ–¹æ¡ˆ","published":1,"updated":"2025-10-15T07:21:14.235Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076c000dqkd47jvjh55h","content":"<h4 id=\"1-ä»€ä¹ˆæ˜¯ä¼ªå…±äº«\"><a href=\"#1-ä»€ä¹ˆæ˜¯ä¼ªå…±äº«\" class=\"headerlink\" title=\"1. ä»€ä¹ˆæ˜¯ä¼ªå…±äº«\"></a>1. ä»€ä¹ˆæ˜¯ä¼ªå…±äº«</h4><p>CPU ç¼“å­˜ç³»ç»Ÿä¸­æ˜¯ä»¥ç¼“å­˜è¡Œï¼ˆcache lineï¼‰ä¸ºå•ä½å­˜å‚¨çš„ã€‚ç›®å‰ä¸»æµçš„ CPU Cache çš„ Cache Line å¤§å°éƒ½æ˜¯ 64 Bytesã€‚åœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹ï¼Œå¦‚æœéœ€è¦ä¿®æ”¹â€œå…±äº«åŒä¸€ä¸ªç¼“å­˜è¡Œçš„å˜é‡â€ï¼Œå°±ä¼šæ— æ„ä¸­å½±å“å½¼æ­¤çš„æ€§èƒ½ï¼Œè¿™å°±æ˜¯ä¼ªå…±äº«ï¼ˆFalse Sharingï¼‰ã€‚</p>\n<h4 id=\"2-ç¼“å­˜è¡Œ\"><a href=\"#2-ç¼“å­˜è¡Œ\" class=\"headerlink\" title=\"2. ç¼“å­˜è¡Œ\"></a>2. ç¼“å­˜è¡Œ</h4><p>ç”±äºå…±äº«å˜é‡åœ¨ CPU ç¼“å­˜ä¸­çš„å­˜å‚¨æ˜¯ä»¥ç¼“å­˜è¡Œä¸ºå•ä½ï¼Œä¸€ä¸ªç¼“å­˜è¡Œå¯ä»¥å­˜å‚¨å¤šä¸ªå˜é‡ï¼ˆå­˜æ»¡å½“å‰ç¼“å­˜è¡Œçš„å­—èŠ‚æ•°ï¼‰ï¼›è€ŒCPUå¯¹ç¼“å­˜çš„ä¿®æ”¹åˆæ˜¯ä»¥ç¼“å­˜è¡Œä¸ºæœ€å°å•ä½çš„ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°ä¸Šè¯‰çš„ä¼ªå…±äº«é—®é¢˜ã€‚</p>\n<p>Cache Line å¯ä»¥ç®€å•çš„ç†è§£ä¸º CPU Cache ä¸­çš„æœ€å°ç¼“å­˜å•ä½ï¼Œä»Šå¤©çš„ CPU ä¸å†æ˜¯æŒ‰å­—èŠ‚è®¿é—®å†…å­˜ï¼Œè€Œæ˜¯ä»¥ 64 å­—èŠ‚ä¸ºå•ä½çš„å—(chunk)æ‹¿å–ï¼Œç§°ä¸ºä¸€ä¸ªç¼“å­˜è¡Œ(cache line)ã€‚å½“ä½ è¯»ä¸€ä¸ªç‰¹å®šçš„å†…å­˜åœ°å€ï¼Œæ•´ä¸ªç¼“å­˜è¡Œå°†ä»ä¸»å­˜æ¢å…¥ç¼“å­˜ï¼Œå¹¶ä¸”è®¿é—®åŒä¸€ä¸ªç¼“å­˜è¡Œå†…çš„å…¶å®ƒå€¼çš„å¼€é”€æ˜¯å¾ˆå°çš„ã€‚</p>\n<h4 id=\"3-CPU-çš„ä¸‰çº§ç¼“å­˜\"><a href=\"#3-CPU-çš„ä¸‰çº§ç¼“å­˜\" class=\"headerlink\" title=\"3. CPU çš„ä¸‰çº§ç¼“å­˜\"></a>3. CPU çš„ä¸‰çº§ç¼“å­˜</h4><p>ç”±äº CPU çš„é€Ÿåº¦è¿œè¿œå¤§äºå†…å­˜é€Ÿåº¦ï¼Œæ‰€ä»¥ CPU è®¾è®¡è€…ä»¬å°±ç»™ CPU åŠ ä¸Šäº†ç¼“å­˜(CPU Cache)ã€‚ ä»¥å…è¿ç®—è¢«å†…å­˜é€Ÿåº¦æ‹–ç´¯ã€‚ï¼ˆå°±åƒæˆ‘ä»¬å†™ä»£ç æŠŠå…±äº«æ•°æ®åšCacheä¸æƒ³è¢«DBå­˜å–é€Ÿåº¦æ‹–ç´¯ä¸€æ ·ï¼‰ï¼ŒCPU Cache åˆ†æˆäº†ä¸‰ä¸ªçº§åˆ«ï¼šL1ï¼ŒL2ï¼ŒL3ã€‚è¶Šé è¿‘CPUçš„ç¼“å­˜è¶Šå¿«ä¹Ÿè¶Šå°ã€‚æ‰€ ä»¥L1 ç¼“å­˜å¾ˆå°ä½†å¾ˆå¿«ï¼Œå¹¶ä¸”ç´§é ç€åœ¨ä½¿ç”¨å®ƒçš„ CPU å†…æ ¸ã€‚L2 å¤§ä¸€äº›ï¼Œä¹Ÿæ…¢ä¸€äº›ï¼Œå¹¶ä¸”ä»ç„¶åªèƒ½è¢«ä¸€ä¸ªå•ç‹¬çš„ CPU æ ¸ä½¿ç”¨ã€‚L3 åœ¨ç°ä»£å¤šæ ¸æœºå™¨ä¸­æ›´æ™®éï¼Œä»ç„¶æ›´å¤§ï¼Œæ›´æ…¢ï¼Œå¹¶ä¸”è¢«å•ä¸ªæ’æ§½ä¸Šçš„æ‰€æœ‰ CPU æ ¸å…±äº«ã€‚æœ€åï¼Œä½ æ‹¥æœ‰ä¸€å—ä¸»å­˜ï¼Œç”±å…¨éƒ¨æ’æ§½ä¸Šçš„æ‰€æœ‰ CPU æ ¸å…±äº«ã€‚</p>\n<p>å½“ CPU æ‰§è¡Œè¿ç®—çš„æ—¶å€™ï¼Œå®ƒå…ˆå»L1æŸ¥æ‰¾æ‰€éœ€çš„æ•°æ®ï¼Œå†å»L2ï¼Œç„¶åæ˜¯L3ï¼Œæœ€åå¦‚æœè¿™äº›ç¼“å­˜ä¸­éƒ½æ²¡æœ‰ï¼Œæ‰€éœ€çš„æ•°æ®å°±è¦å»ä¸»å†…å­˜æ‹¿ã€‚èµ°å¾—è¶Šè¿œï¼Œè¿ç®—è€—è´¹çš„æ—¶é—´å°±è¶Šé•¿ã€‚æ‰€ä»¥å¦‚æœä½ åœ¨åšä¸€äº›å¾ˆé¢‘ç¹çš„äº‹ï¼Œä½ è¦ç¡®ä¿æ•°æ®åœ¨L1ç¼“å­˜ä¸­ã€‚</p>\n<p><img src=\"http://img.javastack.cn/18-5-31/91078691.jpg\"></p>\n<h4 id=\"4-ç¼“å­˜å…³è”æ€§\"><a href=\"#4-ç¼“å­˜å…³è”æ€§\" class=\"headerlink\" title=\"4. ç¼“å­˜å…³è”æ€§\"></a>4. ç¼“å­˜å…³è”æ€§</h4><p>ç›®å‰å¸¸ç”¨çš„ç¼“å­˜è®¾è®¡æ˜¯Nè·¯ç»„å…³è”(N-Way Set Associative Cache)ï¼Œä»–çš„åŸç†æ˜¯æŠŠä¸€ä¸ªç¼“å­˜æŒ‰ç…§Nä¸ª Cache Line ä½œä¸ºä¸€ç»„ï¼ˆSetï¼‰ï¼Œç¼“å­˜æŒ‰ç»„åˆ’ä¸ºç­‰åˆ†ã€‚æ¯ä¸ªå†…å­˜å—èƒ½å¤Ÿè¢«æ˜ å°„åˆ°ç›¸å¯¹åº”çš„setä¸­çš„ä»»æ„ä¸€ä¸ªç¼“å­˜è¡Œä¸­ã€‚æ¯”å¦‚ä¸€ä¸ª16è·¯ç¼“å­˜ï¼Œ16ä¸ª Cache Line ä½œä¸ºä¸€ä¸ªSetï¼Œæ¯ä¸ªå†…å­˜å—èƒ½å¤Ÿè¢«æ˜ å°„åˆ°ç›¸å¯¹åº”çš„ Set ä¸­çš„16ä¸ª CacheLine ä¸­çš„ä»»æ„ä¸€ä¸ªã€‚ä¸€èˆ¬åœ°ï¼Œå…·æœ‰ä¸€å®šç›¸åŒä½bitä½åœ°å€çš„å†…å­˜å—å°†å…±äº«åŒä¸€ä¸ªSetã€‚ </p>\n<p>ä¸‹å›¾ä¸ºä¸€ä¸ª2-Wayçš„Cacheã€‚ç”±å›¾ä¸­å¯ä»¥çœ‹åˆ° Main Memory ä¸­çš„ Index 0,2,4 éƒ½æ˜ å°„åœ¨Way0çš„ä¸åŒ CacheLine ä¸­ï¼ŒIndex 1,3,5éƒ½æ˜ å°„åœ¨Way1çš„ä¸åŒ CacheLine ä¸­ã€‚</p>\n<p><img src=\"http://img.javastack.cn/18-5-31/71458405.jpg\"></p>\n<h4 id=\"5-MESI-åè®®\"><a href=\"#5-MESI-åè®®\" class=\"headerlink\" title=\"5. MESI åè®®\"></a>5. MESI åè®®</h4><p>å¤šæ ¸ CPU éƒ½æœ‰è‡ªå·±çš„ä¸“æœ‰ç¼“å­˜ï¼ˆä¸€èˆ¬ä¸ºL1ï¼ŒL2ï¼‰ï¼Œä»¥åŠåŒä¸€ä¸ª CPU æ’æ§½ä¹‹é—´çš„æ ¸å…±äº«çš„ç¼“å­˜ï¼ˆä¸€èˆ¬ä¸ºL3ï¼‰ã€‚ä¸åŒæ ¸å¿ƒçš„CPUç¼“å­˜ä¸­éš¾å…ä¼šåŠ è½½åŒæ ·çš„æ•°æ®ï¼Œé‚£ä¹ˆå¦‚ä½•ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§å‘¢ï¼Œå°±æ˜¯ MESI åè®®äº†ã€‚</p>\n<p>åœ¨ MESI åè®®ä¸­ï¼Œæ¯ä¸ª Cache line æœ‰4ä¸ªçŠ¶æ€ï¼Œå¯ç”¨ 2 ä¸ª bit è¡¨ç¤ºï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ï¼š<br>M(Modified)ï¼šè¿™è¡Œæ•°æ®æœ‰æ•ˆï¼Œæ•°æ®è¢«ä¿®æ”¹äº†ï¼Œå’Œå†…å­˜ä¸­çš„æ•°æ®ä¸ä¸€è‡´ï¼Œæ•°æ®åªå­˜åœ¨äºæœ¬ Cache ä¸­ï¼›<br>E(Exclusive)ï¼šè¿™è¡Œæ•°æ®æœ‰æ•ˆï¼Œæ•°æ®å’Œå†…å­˜ä¸­çš„æ•°æ®ä¸€è‡´ï¼Œæ•°æ®åªå­˜åœ¨äºæœ¬ Cache ä¸­ï¼›<br>S(Shared)ï¼šè¿™è¡Œæ•°æ®æœ‰æ•ˆï¼Œæ•°æ®å’Œå†…å­˜ä¸­çš„æ•°æ®ä¸€è‡´ï¼Œæ•°æ®å­˜åœ¨äºå¾ˆå¤š Cache ä¸­ï¼›<br>I(Invalid)ï¼šè¿™è¡Œæ•°æ®æ— æ•ˆã€‚</p>\n<p>é‚£ä¹ˆï¼Œå‡è®¾æœ‰ä¸€ä¸ªå˜é‡i&#x3D;3ï¼ˆåº”è¯¥æ˜¯åŒ…æ‹¬å˜é‡içš„ç¼“å­˜å—ï¼Œå—å¤§å°ä¸ºç¼“å­˜è¡Œå¤§å°ï¼‰ï¼›å·²ç»åŠ è½½åˆ°å¤šæ ¸ï¼ˆa,b,cï¼‰çš„ç¼“å­˜ä¸­ï¼Œæ­¤æ—¶è¯¥ç¼“å­˜è¡Œçš„çŠ¶æ€ä¸ºSï¼›æ­¤æ—¶å…¶ä¸­çš„ä¸€ä¸ªæ ¸aæ”¹å˜äº†å˜é‡içš„å€¼ï¼Œé‚£ä¹ˆåœ¨æ ¸aä¸­çš„å½“å‰ç¼“å­˜è¡Œçš„çŠ¶æ€å°†å˜ä¸ºMï¼Œb,cæ ¸ä¸­çš„å½“å‰ç¼“å­˜è¡ŒçŠ¶æ€å°†å˜ä¸ºIã€‚å¦‚ä¸‹å›¾ï¼š</p>\n<p><img src=\"http://img.javastack.cn/18-5-31/66429246.jpg\"></p>\n<h4 id=\"6-è§£å†³åŸç†\"><a href=\"#6-è§£å†³åŸç†\" class=\"headerlink\" title=\"6. è§£å†³åŸç†\"></a>6. è§£å†³åŸç†</h4><p>ä¸ºäº†é¿å…ç”±äº false sharing å¯¼è‡´ Cache Line ä» L1,L2,L3 åˆ°ä¸»å­˜ä¹‹é—´é‡å¤è½½å…¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ•°æ®å¡«å……çš„æ–¹å¼æ¥é¿å…ï¼Œå³å•ä¸ªæ•°æ®å¡«å……æ»¡ä¸€ä¸ªCacheLineã€‚è¿™æœ¬è´¨æ˜¯ä¸€ç§ç©ºé—´æ¢æ—¶é—´çš„åšæ³•ã€‚</p>\n<h4 id=\"7-Java-å¯¹äºä¼ªå…±äº«çš„ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ\"><a href=\"#7-Java-å¯¹äºä¼ªå…±äº«çš„ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ\" class=\"headerlink\" title=\"7. Java å¯¹äºä¼ªå…±äº«çš„ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ\"></a>7. Java å¯¹äºä¼ªå…±äº«çš„ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;***\n* \n**&#x2F;\nimport java.util.concurrent.atomic.AtomicLong;\n\npublic final class FalseSharing\n    implements Runnable\n&#123;\n    public final static int NUM_THREADS &#x3D; 4; &#x2F;&#x2F; change\n    public final static long ITERATIONS &#x3D; 500L * 1000L * 1000L;\n    private final int arrayIndex;\n\n    private static VolatileLong[] longs &#x3D; new VolatileLong[NUM_THREADS];\n    static\n    &#123;\n        for (int i &#x3D; 0; i &lt; longs.length; i++)\n        &#123;\n            longs[i] &#x3D; new VolatileLong();\n        &#125;\n    &#125;\n\n    public FalseSharing(final int arrayIndex)\n    &#123;\n        this.arrayIndex &#x3D; arrayIndex;\n    &#125;\n\n    public static void main(final String[] args) throws Exception\n    &#123;\n        final long start &#x3D; System.nanoTime();\n        runTest();\n        System.out.println(&quot;duration &#x3D; &quot; + (System.nanoTime() - start));\n    &#125;\n\n    private static void runTest() throws InterruptedException\n    &#123;\n        Thread[] threads &#x3D; new Thread[NUM_THREADS];\n\n        for (int i &#x3D; 0; i &lt; threads.length; i++)\n        &#123;\n            threads[i] &#x3D; new Thread(new FalseSharing(i));\n        &#125;\n\n        for (Thread t : threads)\n        &#123;\n            t.start();\n        &#125;\n\n        for (Thread t : threads)\n        &#123;\n            t.join();\n        &#125;\n    &#125;\n\n    public void run()\n    &#123;\n        long i &#x3D; ITERATIONS + 1;\n        while (0 !&#x3D; --i)\n        &#123;\n            longs[arrayIndex].set(i);\n        &#125;\n    &#125;\n\n    public static long sumPaddingToPreventOptimisation(final int index)\n    &#123;\n        VolatileLong v &#x3D; longs[index];\n        return v.p1 + v.p2 + v.p3 + v.p4 + v.p5 + v.p6;\n    &#125;\n\n    &#x2F;&#x2F;jdk7ä»¥ä¸Šä½¿ç”¨æ­¤æ–¹æ³•(jdk7çš„æŸä¸ªç‰ˆæœ¬oracleå¯¹ä¼ªå…±äº«åšäº†ä¼˜åŒ–)\n    public final static class VolatileLong\n    &#123;\n        public volatile long value &#x3D; 0L;\n        public long p1, p2, p3, p4, p5, p6;\n    &#125;\n\n    &#x2F;&#x2F; jdk7ä»¥ä¸‹ä½¿ç”¨æ­¤æ–¹æ³•\n    public final static class VolatileLong\n    &#123;\n        public long p1, p2, p3, p4, p5, p6, p7; &#x2F;&#x2F; cache line padding\n        public volatile long value &#x3D; 0L;\n        public long p8, p9, p10, p11, p12, p13, p14; &#x2F;&#x2F; cache line padding\n\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n<h4 id=\"8-Java-8-ä¸­çš„è§£å†³æ–¹æ¡ˆ\"><a href=\"#8-Java-8-ä¸­çš„è§£å†³æ–¹æ¡ˆ\" class=\"headerlink\" title=\"8. Java 8 ä¸­çš„è§£å†³æ–¹æ¡ˆ\"></a>8. Java 8 ä¸­çš„è§£å†³æ–¹æ¡ˆ</h4><p>Java 8 ä¸­å·²ç»æä¾›äº†å®˜æ–¹çš„è§£å†³æ–¹æ¡ˆï¼ŒJava 8 ä¸­æ–°å¢äº†ä¸€ä¸ªæ³¨è§£ï¼š<code>@sun.misc.Contended</code>ã€‚åŠ ä¸Šè¿™ä¸ªæ³¨è§£çš„ç±»ä¼šè‡ªåŠ¨è¡¥é½ç¼“å­˜è¡Œï¼Œéœ€è¦æ³¨æ„çš„æ˜¯æ­¤æ³¨è§£é»˜è®¤æ˜¯æ— æ•ˆçš„ï¼Œéœ€è¦åœ¨ jvm å¯åŠ¨æ—¶è®¾ç½® <code>-XX:-RestrictContended</code> æ‰ä¼šç”Ÿæ•ˆã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@sun.misc.Contended\npublic final static class VolatileLong &#123;\n    public volatile long value &#x3D; 0L;\n    &#x2F;&#x2F;public long p1, p2, p3, p4, p5, p6;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n<h4 id=\"å‚è€ƒæ–‡çŒ®\"><a href=\"#å‚è€ƒæ–‡çŒ®\" class=\"headerlink\" title=\"å‚è€ƒæ–‡çŒ®\"></a>å‚è€ƒæ–‡çŒ®</h4><blockquote>\n<p><a href=\"http://igoro.com/archive/gallery-of-processor-cache-effects/\">http://igoro.com/archive/gallery-of-processor-cache-effects/</a><br><a href=\"http://ifeve.com/false-sharing/\">http://ifeve.com/false-sharing/</a><br><a href=\"http://blog.csdn.net/muxiqingyang/article/details/6615199\">http://blog.csdn.net/muxiqingyang/article/details/6615199</a><br><a href=\"https://yq.aliyun.com/articles/62865\">https://yq.aliyun.com/articles/62865</a></p>\n</blockquote>\n<p>@ç å†œä»¬ï¼Œä½ ä»¬æ˜¯æ€ä¹ˆç†è§£å’Œè§£å†³ä¼ªå…±äº«çš„ï¼Ÿæ¬¢è¿ç•™è¨€ï¼</p>\n","excerpt":"","more":"<h4 id=\"1-ä»€ä¹ˆæ˜¯ä¼ªå…±äº«\"><a href=\"#1-ä»€ä¹ˆæ˜¯ä¼ªå…±äº«\" class=\"headerlink\" title=\"1. ä»€ä¹ˆæ˜¯ä¼ªå…±äº«\"></a>1. ä»€ä¹ˆæ˜¯ä¼ªå…±äº«</h4><p>CPU ç¼“å­˜ç³»ç»Ÿä¸­æ˜¯ä»¥ç¼“å­˜è¡Œï¼ˆcache lineï¼‰ä¸ºå•ä½å­˜å‚¨çš„ã€‚ç›®å‰ä¸»æµçš„ CPU Cache çš„ Cache Line å¤§å°éƒ½æ˜¯ 64 Bytesã€‚åœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹ï¼Œå¦‚æœéœ€è¦ä¿®æ”¹â€œå…±äº«åŒä¸€ä¸ªç¼“å­˜è¡Œçš„å˜é‡â€ï¼Œå°±ä¼šæ— æ„ä¸­å½±å“å½¼æ­¤çš„æ€§èƒ½ï¼Œè¿™å°±æ˜¯ä¼ªå…±äº«ï¼ˆFalse Sharingï¼‰ã€‚</p>\n<h4 id=\"2-ç¼“å­˜è¡Œ\"><a href=\"#2-ç¼“å­˜è¡Œ\" class=\"headerlink\" title=\"2. ç¼“å­˜è¡Œ\"></a>2. ç¼“å­˜è¡Œ</h4><p>ç”±äºå…±äº«å˜é‡åœ¨ CPU ç¼“å­˜ä¸­çš„å­˜å‚¨æ˜¯ä»¥ç¼“å­˜è¡Œä¸ºå•ä½ï¼Œä¸€ä¸ªç¼“å­˜è¡Œå¯ä»¥å­˜å‚¨å¤šä¸ªå˜é‡ï¼ˆå­˜æ»¡å½“å‰ç¼“å­˜è¡Œçš„å­—èŠ‚æ•°ï¼‰ï¼›è€ŒCPUå¯¹ç¼“å­˜çš„ä¿®æ”¹åˆæ˜¯ä»¥ç¼“å­˜è¡Œä¸ºæœ€å°å•ä½çš„ï¼Œé‚£ä¹ˆå°±ä¼šå‡ºç°ä¸Šè¯‰çš„ä¼ªå…±äº«é—®é¢˜ã€‚</p>\n<p>Cache Line å¯ä»¥ç®€å•çš„ç†è§£ä¸º CPU Cache ä¸­çš„æœ€å°ç¼“å­˜å•ä½ï¼Œä»Šå¤©çš„ CPU ä¸å†æ˜¯æŒ‰å­—èŠ‚è®¿é—®å†…å­˜ï¼Œè€Œæ˜¯ä»¥ 64 å­—èŠ‚ä¸ºå•ä½çš„å—(chunk)æ‹¿å–ï¼Œç§°ä¸ºä¸€ä¸ªç¼“å­˜è¡Œ(cache line)ã€‚å½“ä½ è¯»ä¸€ä¸ªç‰¹å®šçš„å†…å­˜åœ°å€ï¼Œæ•´ä¸ªç¼“å­˜è¡Œå°†ä»ä¸»å­˜æ¢å…¥ç¼“å­˜ï¼Œå¹¶ä¸”è®¿é—®åŒä¸€ä¸ªç¼“å­˜è¡Œå†…çš„å…¶å®ƒå€¼çš„å¼€é”€æ˜¯å¾ˆå°çš„ã€‚</p>\n<h4 id=\"3-CPU-çš„ä¸‰çº§ç¼“å­˜\"><a href=\"#3-CPU-çš„ä¸‰çº§ç¼“å­˜\" class=\"headerlink\" title=\"3. CPU çš„ä¸‰çº§ç¼“å­˜\"></a>3. CPU çš„ä¸‰çº§ç¼“å­˜</h4><p>ç”±äº CPU çš„é€Ÿåº¦è¿œè¿œå¤§äºå†…å­˜é€Ÿåº¦ï¼Œæ‰€ä»¥ CPU è®¾è®¡è€…ä»¬å°±ç»™ CPU åŠ ä¸Šäº†ç¼“å­˜(CPU Cache)ã€‚ ä»¥å…è¿ç®—è¢«å†…å­˜é€Ÿåº¦æ‹–ç´¯ã€‚ï¼ˆå°±åƒæˆ‘ä»¬å†™ä»£ç æŠŠå…±äº«æ•°æ®åšCacheä¸æƒ³è¢«DBå­˜å–é€Ÿåº¦æ‹–ç´¯ä¸€æ ·ï¼‰ï¼ŒCPU Cache åˆ†æˆäº†ä¸‰ä¸ªçº§åˆ«ï¼šL1ï¼ŒL2ï¼ŒL3ã€‚è¶Šé è¿‘CPUçš„ç¼“å­˜è¶Šå¿«ä¹Ÿè¶Šå°ã€‚æ‰€ ä»¥L1 ç¼“å­˜å¾ˆå°ä½†å¾ˆå¿«ï¼Œå¹¶ä¸”ç´§é ç€åœ¨ä½¿ç”¨å®ƒçš„ CPU å†…æ ¸ã€‚L2 å¤§ä¸€äº›ï¼Œä¹Ÿæ…¢ä¸€äº›ï¼Œå¹¶ä¸”ä»ç„¶åªèƒ½è¢«ä¸€ä¸ªå•ç‹¬çš„ CPU æ ¸ä½¿ç”¨ã€‚L3 åœ¨ç°ä»£å¤šæ ¸æœºå™¨ä¸­æ›´æ™®éï¼Œä»ç„¶æ›´å¤§ï¼Œæ›´æ…¢ï¼Œå¹¶ä¸”è¢«å•ä¸ªæ’æ§½ä¸Šçš„æ‰€æœ‰ CPU æ ¸å…±äº«ã€‚æœ€åï¼Œä½ æ‹¥æœ‰ä¸€å—ä¸»å­˜ï¼Œç”±å…¨éƒ¨æ’æ§½ä¸Šçš„æ‰€æœ‰ CPU æ ¸å…±äº«ã€‚</p>\n<p>å½“ CPU æ‰§è¡Œè¿ç®—çš„æ—¶å€™ï¼Œå®ƒå…ˆå»L1æŸ¥æ‰¾æ‰€éœ€çš„æ•°æ®ï¼Œå†å»L2ï¼Œç„¶åæ˜¯L3ï¼Œæœ€åå¦‚æœè¿™äº›ç¼“å­˜ä¸­éƒ½æ²¡æœ‰ï¼Œæ‰€éœ€çš„æ•°æ®å°±è¦å»ä¸»å†…å­˜æ‹¿ã€‚èµ°å¾—è¶Šè¿œï¼Œè¿ç®—è€—è´¹çš„æ—¶é—´å°±è¶Šé•¿ã€‚æ‰€ä»¥å¦‚æœä½ åœ¨åšä¸€äº›å¾ˆé¢‘ç¹çš„äº‹ï¼Œä½ è¦ç¡®ä¿æ•°æ®åœ¨L1ç¼“å­˜ä¸­ã€‚</p>\n<p><img src=\"http://img.javastack.cn/18-5-31/91078691.jpg\"></p>\n<h4 id=\"4-ç¼“å­˜å…³è”æ€§\"><a href=\"#4-ç¼“å­˜å…³è”æ€§\" class=\"headerlink\" title=\"4. ç¼“å­˜å…³è”æ€§\"></a>4. ç¼“å­˜å…³è”æ€§</h4><p>ç›®å‰å¸¸ç”¨çš„ç¼“å­˜è®¾è®¡æ˜¯Nè·¯ç»„å…³è”(N-Way Set Associative Cache)ï¼Œä»–çš„åŸç†æ˜¯æŠŠä¸€ä¸ªç¼“å­˜æŒ‰ç…§Nä¸ª Cache Line ä½œä¸ºä¸€ç»„ï¼ˆSetï¼‰ï¼Œç¼“å­˜æŒ‰ç»„åˆ’ä¸ºç­‰åˆ†ã€‚æ¯ä¸ªå†…å­˜å—èƒ½å¤Ÿè¢«æ˜ å°„åˆ°ç›¸å¯¹åº”çš„setä¸­çš„ä»»æ„ä¸€ä¸ªç¼“å­˜è¡Œä¸­ã€‚æ¯”å¦‚ä¸€ä¸ª16è·¯ç¼“å­˜ï¼Œ16ä¸ª Cache Line ä½œä¸ºä¸€ä¸ªSetï¼Œæ¯ä¸ªå†…å­˜å—èƒ½å¤Ÿè¢«æ˜ å°„åˆ°ç›¸å¯¹åº”çš„ Set ä¸­çš„16ä¸ª CacheLine ä¸­çš„ä»»æ„ä¸€ä¸ªã€‚ä¸€èˆ¬åœ°ï¼Œå…·æœ‰ä¸€å®šç›¸åŒä½bitä½åœ°å€çš„å†…å­˜å—å°†å…±äº«åŒä¸€ä¸ªSetã€‚ </p>\n<p>ä¸‹å›¾ä¸ºä¸€ä¸ª2-Wayçš„Cacheã€‚ç”±å›¾ä¸­å¯ä»¥çœ‹åˆ° Main Memory ä¸­çš„ Index 0,2,4 éƒ½æ˜ å°„åœ¨Way0çš„ä¸åŒ CacheLine ä¸­ï¼ŒIndex 1,3,5éƒ½æ˜ å°„åœ¨Way1çš„ä¸åŒ CacheLine ä¸­ã€‚</p>\n<p><img src=\"http://img.javastack.cn/18-5-31/71458405.jpg\"></p>\n<h4 id=\"5-MESI-åè®®\"><a href=\"#5-MESI-åè®®\" class=\"headerlink\" title=\"5. MESI åè®®\"></a>5. MESI åè®®</h4><p>å¤šæ ¸ CPU éƒ½æœ‰è‡ªå·±çš„ä¸“æœ‰ç¼“å­˜ï¼ˆä¸€èˆ¬ä¸ºL1ï¼ŒL2ï¼‰ï¼Œä»¥åŠåŒä¸€ä¸ª CPU æ’æ§½ä¹‹é—´çš„æ ¸å…±äº«çš„ç¼“å­˜ï¼ˆä¸€èˆ¬ä¸ºL3ï¼‰ã€‚ä¸åŒæ ¸å¿ƒçš„CPUç¼“å­˜ä¸­éš¾å…ä¼šåŠ è½½åŒæ ·çš„æ•°æ®ï¼Œé‚£ä¹ˆå¦‚ä½•ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§å‘¢ï¼Œå°±æ˜¯ MESI åè®®äº†ã€‚</p>\n<p>åœ¨ MESI åè®®ä¸­ï¼Œæ¯ä¸ª Cache line æœ‰4ä¸ªçŠ¶æ€ï¼Œå¯ç”¨ 2 ä¸ª bit è¡¨ç¤ºï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ï¼š<br>M(Modified)ï¼šè¿™è¡Œæ•°æ®æœ‰æ•ˆï¼Œæ•°æ®è¢«ä¿®æ”¹äº†ï¼Œå’Œå†…å­˜ä¸­çš„æ•°æ®ä¸ä¸€è‡´ï¼Œæ•°æ®åªå­˜åœ¨äºæœ¬ Cache ä¸­ï¼›<br>E(Exclusive)ï¼šè¿™è¡Œæ•°æ®æœ‰æ•ˆï¼Œæ•°æ®å’Œå†…å­˜ä¸­çš„æ•°æ®ä¸€è‡´ï¼Œæ•°æ®åªå­˜åœ¨äºæœ¬ Cache ä¸­ï¼›<br>S(Shared)ï¼šè¿™è¡Œæ•°æ®æœ‰æ•ˆï¼Œæ•°æ®å’Œå†…å­˜ä¸­çš„æ•°æ®ä¸€è‡´ï¼Œæ•°æ®å­˜åœ¨äºå¾ˆå¤š Cache ä¸­ï¼›<br>I(Invalid)ï¼šè¿™è¡Œæ•°æ®æ— æ•ˆã€‚</p>\n<p>é‚£ä¹ˆï¼Œå‡è®¾æœ‰ä¸€ä¸ªå˜é‡i&#x3D;3ï¼ˆåº”è¯¥æ˜¯åŒ…æ‹¬å˜é‡içš„ç¼“å­˜å—ï¼Œå—å¤§å°ä¸ºç¼“å­˜è¡Œå¤§å°ï¼‰ï¼›å·²ç»åŠ è½½åˆ°å¤šæ ¸ï¼ˆa,b,cï¼‰çš„ç¼“å­˜ä¸­ï¼Œæ­¤æ—¶è¯¥ç¼“å­˜è¡Œçš„çŠ¶æ€ä¸ºSï¼›æ­¤æ—¶å…¶ä¸­çš„ä¸€ä¸ªæ ¸aæ”¹å˜äº†å˜é‡içš„å€¼ï¼Œé‚£ä¹ˆåœ¨æ ¸aä¸­çš„å½“å‰ç¼“å­˜è¡Œçš„çŠ¶æ€å°†å˜ä¸ºMï¼Œb,cæ ¸ä¸­çš„å½“å‰ç¼“å­˜è¡ŒçŠ¶æ€å°†å˜ä¸ºIã€‚å¦‚ä¸‹å›¾ï¼š</p>\n<p><img src=\"http://img.javastack.cn/18-5-31/66429246.jpg\"></p>\n<h4 id=\"6-è§£å†³åŸç†\"><a href=\"#6-è§£å†³åŸç†\" class=\"headerlink\" title=\"6. è§£å†³åŸç†\"></a>6. è§£å†³åŸç†</h4><p>ä¸ºäº†é¿å…ç”±äº false sharing å¯¼è‡´ Cache Line ä» L1,L2,L3 åˆ°ä¸»å­˜ä¹‹é—´é‡å¤è½½å…¥ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ•°æ®å¡«å……çš„æ–¹å¼æ¥é¿å…ï¼Œå³å•ä¸ªæ•°æ®å¡«å……æ»¡ä¸€ä¸ªCacheLineã€‚è¿™æœ¬è´¨æ˜¯ä¸€ç§ç©ºé—´æ¢æ—¶é—´çš„åšæ³•ã€‚</p>\n<h4 id=\"7-Java-å¯¹äºä¼ªå…±äº«çš„ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ\"><a href=\"#7-Java-å¯¹äºä¼ªå…±äº«çš„ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ\" class=\"headerlink\" title=\"7. Java å¯¹äºä¼ªå…±äº«çš„ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ\"></a>7. Java å¯¹äºä¼ªå…±äº«çš„ä¼ ç»Ÿè§£å†³æ–¹æ¡ˆ</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;***\n* \n**&#x2F;\nimport java.util.concurrent.atomic.AtomicLong;\n\npublic final class FalseSharing\n    implements Runnable\n&#123;\n    public final static int NUM_THREADS &#x3D; 4; &#x2F;&#x2F; change\n    public final static long ITERATIONS &#x3D; 500L * 1000L * 1000L;\n    private final int arrayIndex;\n\n    private static VolatileLong[] longs &#x3D; new VolatileLong[NUM_THREADS];\n    static\n    &#123;\n        for (int i &#x3D; 0; i &lt; longs.length; i++)\n        &#123;\n            longs[i] &#x3D; new VolatileLong();\n        &#125;\n    &#125;\n\n    public FalseSharing(final int arrayIndex)\n    &#123;\n        this.arrayIndex &#x3D; arrayIndex;\n    &#125;\n\n    public static void main(final String[] args) throws Exception\n    &#123;\n        final long start &#x3D; System.nanoTime();\n        runTest();\n        System.out.println(&quot;duration &#x3D; &quot; + (System.nanoTime() - start));\n    &#125;\n\n    private static void runTest() throws InterruptedException\n    &#123;\n        Thread[] threads &#x3D; new Thread[NUM_THREADS];\n\n        for (int i &#x3D; 0; i &lt; threads.length; i++)\n        &#123;\n            threads[i] &#x3D; new Thread(new FalseSharing(i));\n        &#125;\n\n        for (Thread t : threads)\n        &#123;\n            t.start();\n        &#125;\n\n        for (Thread t : threads)\n        &#123;\n            t.join();\n        &#125;\n    &#125;\n\n    public void run()\n    &#123;\n        long i &#x3D; ITERATIONS + 1;\n        while (0 !&#x3D; --i)\n        &#123;\n            longs[arrayIndex].set(i);\n        &#125;\n    &#125;\n\n    public static long sumPaddingToPreventOptimisation(final int index)\n    &#123;\n        VolatileLong v &#x3D; longs[index];\n        return v.p1 + v.p2 + v.p3 + v.p4 + v.p5 + v.p6;\n    &#125;\n\n    &#x2F;&#x2F;jdk7ä»¥ä¸Šä½¿ç”¨æ­¤æ–¹æ³•(jdk7çš„æŸä¸ªç‰ˆæœ¬oracleå¯¹ä¼ªå…±äº«åšäº†ä¼˜åŒ–)\n    public final static class VolatileLong\n    &#123;\n        public volatile long value &#x3D; 0L;\n        public long p1, p2, p3, p4, p5, p6;\n    &#125;\n\n    &#x2F;&#x2F; jdk7ä»¥ä¸‹ä½¿ç”¨æ­¤æ–¹æ³•\n    public final static class VolatileLong\n    &#123;\n        public long p1, p2, p3, p4, p5, p6, p7; &#x2F;&#x2F; cache line padding\n        public volatile long value &#x3D; 0L;\n        public long p8, p9, p10, p11, p12, p13, p14; &#x2F;&#x2F; cache line padding\n\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n<h4 id=\"8-Java-8-ä¸­çš„è§£å†³æ–¹æ¡ˆ\"><a href=\"#8-Java-8-ä¸­çš„è§£å†³æ–¹æ¡ˆ\" class=\"headerlink\" title=\"8. Java 8 ä¸­çš„è§£å†³æ–¹æ¡ˆ\"></a>8. Java 8 ä¸­çš„è§£å†³æ–¹æ¡ˆ</h4><p>Java 8 ä¸­å·²ç»æä¾›äº†å®˜æ–¹çš„è§£å†³æ–¹æ¡ˆï¼ŒJava 8 ä¸­æ–°å¢äº†ä¸€ä¸ªæ³¨è§£ï¼š<code>@sun.misc.Contended</code>ã€‚åŠ ä¸Šè¿™ä¸ªæ³¨è§£çš„ç±»ä¼šè‡ªåŠ¨è¡¥é½ç¼“å­˜è¡Œï¼Œéœ€è¦æ³¨æ„çš„æ˜¯æ­¤æ³¨è§£é»˜è®¤æ˜¯æ— æ•ˆçš„ï¼Œéœ€è¦åœ¨ jvm å¯åŠ¨æ—¶è®¾ç½® <code>-XX:-RestrictContended</code> æ‰ä¼šç”Ÿæ•ˆã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@sun.misc.Contended\npublic final static class VolatileLong &#123;\n    public volatile long value &#x3D; 0L;\n    &#x2F;&#x2F;public long p1, p2, p3, p4, p5, p6;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n<h4 id=\"å‚è€ƒæ–‡çŒ®\"><a href=\"#å‚è€ƒæ–‡çŒ®\" class=\"headerlink\" title=\"å‚è€ƒæ–‡çŒ®\"></a>å‚è€ƒæ–‡çŒ®</h4><blockquote>\n<p><a href=\"http://igoro.com/archive/gallery-of-processor-cache-effects/\">http://igoro.com/archive/gallery-of-processor-cache-effects/</a><br><a href=\"http://ifeve.com/false-sharing/\">http://ifeve.com/false-sharing/</a><br><a href=\"http://blog.csdn.net/muxiqingyang/article/details/6615199\">http://blog.csdn.net/muxiqingyang/article/details/6615199</a><br><a href=\"https://yq.aliyun.com/articles/62865\">https://yq.aliyun.com/articles/62865</a></p>\n</blockquote>\n<p>@ç å†œä»¬ï¼Œä½ ä»¬æ˜¯æ€ä¹ˆç†è§£å’Œè§£å†³ä¼ªå…±äº«çš„ï¼Ÿæ¬¢è¿ç•™è¨€ï¼</p>\n"},{"title":"Java ä¸­çš„å®å˜é‡ï¼Œå®æ›¿æ¢è¯¦è§£ã€‚","date":"2025-10-15T03:36:33.000Z","_content":"\n\né¦–å…ˆæ¥çœ‹ä¸‹é¢è¿™æ®µç¨‹åºï¼Œå’Œç¾¤å‹åˆ†äº«çš„å¤§è‡´ä¸€æ ·ã€‚\n\n```\npublic static void main(String[] args) {\n    String hw = \"hello world\";\n    \n    String hello = \"hello\";\n    final String finalWorld2 = \"hello\";\n    final String finalWorld3 = hello;\n    final String finalWorld4 = \"he\" + \"llo\";\n    \n    String hw1 = hello + \" world\";\n    String hw2 = finalWorld2 + \" world\";\n    String hw3 = finalWorld3 + \" world\";\n    String hw4 = finalWorld4 + \" world\";\n    \n    System.out.println(hw == hw1);\n    System.out.println(hw == hw2);\n    System.out.println(hw == hw3);\n    System.out.println(hw == hw4);\n}\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n```\nfalse\ntrue\nfalse\ntrue\n```\n\nåŒæ ·æ˜¯å­—ç¬¦ä¸²\"hello\"ï¼Œä¸ºä»€ä¹ˆç”¨finalå®šä¹‰çš„ï¼Œä¸”ä¸ªè¿›è¡Œ==æ“ä½œå´æ˜¯trueæœ‰ä¸€ä¸ªæ˜¯falseï¼Œè€Œæ²¡ç”¨finalçš„å´æ˜¯false?\n\n**é¦–å…ˆæ¥ç†è§£ä¸‹å®å˜é‡ï¼š**\n\nJavaä¸­ï¼Œä¸€ä¸ªç”¨finalå®šä¹‰çš„å˜é‡ï¼Œä¸ç®¡å®ƒæ˜¯ç±»å‹çš„å˜é‡ï¼Œåªè¦ç”¨finalå®šä¹‰äº†å¹¶åŒæ—¶æŒ‡å®šäº†åˆå§‹å€¼ï¼Œå¹¶ä¸”è¿™ä¸ªåˆå§‹å€¼æ˜¯åœ¨ç¼–è¯‘æ—¶å°±è¢«ç¡®å®šä¸‹æ¥çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªfinalå˜é‡å°±æ˜¯ä¸€ä¸ªå®å˜é‡ã€‚ç¼–è¯‘å™¨ä¼šæŠŠç¨‹åºæ‰€æœ‰ç”¨åˆ°è¯¥å˜é‡çš„åœ°æ–¹ç›´æ¥æ›¿æ¢æˆè¯¥å˜é‡çš„å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´ç¼–è¯‘å™¨èƒ½å¯¹å®å˜é‡è¿›è¡Œå®æ›¿æ¢ã€‚\n\nå¦‚ï¼š\n\n```\nfinal String a = \"hello\";\nfinal String b = a;\nfinal String c = getHello();\n```\n\naåœ¨ç¼–è¯‘æœŸé—´å°±èƒ½ç¡®å®šä¸‹æ¥ï¼Œè€Œbã€cä¸è¡Œï¼Œæ‰€ä»¥aæ˜¯å®å˜é‡ï¼Œbã€cä¸æ˜¯ã€‚\n\næ‰€ä»¥ï¼Œå†å›åˆ°ä¸Šé¢çš„ç¨‹åºï¼ŒfinalWorld2å’ŒfinalWorld4æ˜¯finalå®šä¹‰çš„ï¼Œä¹Ÿæ˜¯åœ¨ç¼–è¯‘æœŸé—´èƒ½ç¡®å®šä¸‹æ¥çš„ï¼Œæ‰€ä»¥å®ƒèƒ½è¢«å®æ›¿æ¢ï¼Œç¼–è¯‘å™¨å°±ä¼šè®©finalWorld2å’ŒfinalWorld4æŒ‡å‘å­—ç¬¦ä¸²æ± ä¸­ç¼“å­˜çš„å­—ç¬¦ä¸²\"\"hello world\"ï¼Œæ‰€ä»¥å®ƒä»¬å°±æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚\n\n","source":"_posts/è¿›é˜¶/Java ä¸­çš„å®å˜é‡ï¼Œå®æ›¿æ¢è¯¦è§£ã€‚.md","raw":"---\ntitle: Java ä¸­çš„å®å˜é‡ï¼Œå®æ›¿æ¢è¯¦è§£ã€‚\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: è¿›é˜¶\n---\n\n\né¦–å…ˆæ¥çœ‹ä¸‹é¢è¿™æ®µç¨‹åºï¼Œå’Œç¾¤å‹åˆ†äº«çš„å¤§è‡´ä¸€æ ·ã€‚\n\n```\npublic static void main(String[] args) {\n    String hw = \"hello world\";\n    \n    String hello = \"hello\";\n    final String finalWorld2 = \"hello\";\n    final String finalWorld3 = hello;\n    final String finalWorld4 = \"he\" + \"llo\";\n    \n    String hw1 = hello + \" world\";\n    String hw2 = finalWorld2 + \" world\";\n    String hw3 = finalWorld3 + \" world\";\n    String hw4 = finalWorld4 + \" world\";\n    \n    System.out.println(hw == hw1);\n    System.out.println(hw == hw2);\n    System.out.println(hw == hw3);\n    System.out.println(hw == hw4);\n}\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n```\nfalse\ntrue\nfalse\ntrue\n```\n\nåŒæ ·æ˜¯å­—ç¬¦ä¸²\"hello\"ï¼Œä¸ºä»€ä¹ˆç”¨finalå®šä¹‰çš„ï¼Œä¸”ä¸ªè¿›è¡Œ==æ“ä½œå´æ˜¯trueæœ‰ä¸€ä¸ªæ˜¯falseï¼Œè€Œæ²¡ç”¨finalçš„å´æ˜¯false?\n\n**é¦–å…ˆæ¥ç†è§£ä¸‹å®å˜é‡ï¼š**\n\nJavaä¸­ï¼Œä¸€ä¸ªç”¨finalå®šä¹‰çš„å˜é‡ï¼Œä¸ç®¡å®ƒæ˜¯ç±»å‹çš„å˜é‡ï¼Œåªè¦ç”¨finalå®šä¹‰äº†å¹¶åŒæ—¶æŒ‡å®šäº†åˆå§‹å€¼ï¼Œå¹¶ä¸”è¿™ä¸ªåˆå§‹å€¼æ˜¯åœ¨ç¼–è¯‘æ—¶å°±è¢«ç¡®å®šä¸‹æ¥çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªfinalå˜é‡å°±æ˜¯ä¸€ä¸ªå®å˜é‡ã€‚ç¼–è¯‘å™¨ä¼šæŠŠç¨‹åºæ‰€æœ‰ç”¨åˆ°è¯¥å˜é‡çš„åœ°æ–¹ç›´æ¥æ›¿æ¢æˆè¯¥å˜é‡çš„å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´ç¼–è¯‘å™¨èƒ½å¯¹å®å˜é‡è¿›è¡Œå®æ›¿æ¢ã€‚\n\nå¦‚ï¼š\n\n```\nfinal String a = \"hello\";\nfinal String b = a;\nfinal String c = getHello();\n```\n\naåœ¨ç¼–è¯‘æœŸé—´å°±èƒ½ç¡®å®šä¸‹æ¥ï¼Œè€Œbã€cä¸è¡Œï¼Œæ‰€ä»¥aæ˜¯å®å˜é‡ï¼Œbã€cä¸æ˜¯ã€‚\n\næ‰€ä»¥ï¼Œå†å›åˆ°ä¸Šé¢çš„ç¨‹åºï¼ŒfinalWorld2å’ŒfinalWorld4æ˜¯finalå®šä¹‰çš„ï¼Œä¹Ÿæ˜¯åœ¨ç¼–è¯‘æœŸé—´èƒ½ç¡®å®šä¸‹æ¥çš„ï¼Œæ‰€ä»¥å®ƒèƒ½è¢«å®æ›¿æ¢ï¼Œç¼–è¯‘å™¨å°±ä¼šè®©finalWorld2å’ŒfinalWorld4æŒ‡å‘å­—ç¬¦ä¸²æ± ä¸­ç¼“å­˜çš„å­—ç¬¦ä¸²\"\"hello world\"ï¼Œæ‰€ä»¥å®ƒä»¬å°±æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚\n\n","slug":"è¿›é˜¶/Java ä¸­çš„å®å˜é‡ï¼Œå®æ›¿æ¢è¯¦è§£ã€‚","published":1,"updated":"2025-10-15T07:21:14.269Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076d000eqkd4glyl48p9","content":"<p>é¦–å…ˆæ¥çœ‹ä¸‹é¢è¿™æ®µç¨‹åºï¼Œå’Œç¾¤å‹åˆ†äº«çš„å¤§è‡´ä¸€æ ·ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n    String hw &#x3D; &quot;hello world&quot;;\n    \n    String hello &#x3D; &quot;hello&quot;;\n    final String finalWorld2 &#x3D; &quot;hello&quot;;\n    final String finalWorld3 &#x3D; hello;\n    final String finalWorld4 &#x3D; &quot;he&quot; + &quot;llo&quot;;\n    \n    String hw1 &#x3D; hello + &quot; world&quot;;\n    String hw2 &#x3D; finalWorld2 + &quot; world&quot;;\n    String hw3 &#x3D; finalWorld3 + &quot; world&quot;;\n    String hw4 &#x3D; finalWorld4 + &quot; world&quot;;\n    \n    System.out.println(hw &#x3D;&#x3D; hw1);\n    System.out.println(hw &#x3D;&#x3D; hw2);\n    System.out.println(hw &#x3D;&#x3D; hw3);\n    System.out.println(hw &#x3D;&#x3D; hw4);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">false\ntrue\nfalse\ntrue<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>åŒæ ·æ˜¯å­—ç¬¦ä¸²â€helloâ€ï¼Œä¸ºä»€ä¹ˆç”¨finalå®šä¹‰çš„ï¼Œä¸”ä¸ªè¿›è¡Œ&#x3D;&#x3D;æ“ä½œå´æ˜¯trueæœ‰ä¸€ä¸ªæ˜¯falseï¼Œè€Œæ²¡ç”¨finalçš„å´æ˜¯false?</p>\n<p><strong>é¦–å…ˆæ¥ç†è§£ä¸‹å®å˜é‡ï¼š</strong></p>\n<p>Javaä¸­ï¼Œä¸€ä¸ªç”¨finalå®šä¹‰çš„å˜é‡ï¼Œä¸ç®¡å®ƒæ˜¯ç±»å‹çš„å˜é‡ï¼Œåªè¦ç”¨finalå®šä¹‰äº†å¹¶åŒæ—¶æŒ‡å®šäº†åˆå§‹å€¼ï¼Œå¹¶ä¸”è¿™ä¸ªåˆå§‹å€¼æ˜¯åœ¨ç¼–è¯‘æ—¶å°±è¢«ç¡®å®šä¸‹æ¥çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªfinalå˜é‡å°±æ˜¯ä¸€ä¸ªå®å˜é‡ã€‚ç¼–è¯‘å™¨ä¼šæŠŠç¨‹åºæ‰€æœ‰ç”¨åˆ°è¯¥å˜é‡çš„åœ°æ–¹ç›´æ¥æ›¿æ¢æˆè¯¥å˜é‡çš„å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´ç¼–è¯‘å™¨èƒ½å¯¹å®å˜é‡è¿›è¡Œå®æ›¿æ¢ã€‚</p>\n<p>å¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">final String a &#x3D; &quot;hello&quot;;\nfinal String b &#x3D; a;\nfinal String c &#x3D; getHello();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>aåœ¨ç¼–è¯‘æœŸé—´å°±èƒ½ç¡®å®šä¸‹æ¥ï¼Œè€Œbã€cä¸è¡Œï¼Œæ‰€ä»¥aæ˜¯å®å˜é‡ï¼Œbã€cä¸æ˜¯ã€‚</p>\n<p>æ‰€ä»¥ï¼Œå†å›åˆ°ä¸Šé¢çš„ç¨‹åºï¼ŒfinalWorld2å’ŒfinalWorld4æ˜¯finalå®šä¹‰çš„ï¼Œä¹Ÿæ˜¯åœ¨ç¼–è¯‘æœŸé—´èƒ½ç¡®å®šä¸‹æ¥çš„ï¼Œæ‰€ä»¥å®ƒèƒ½è¢«å®æ›¿æ¢ï¼Œç¼–è¯‘å™¨å°±ä¼šè®©finalWorld2å’ŒfinalWorld4æŒ‡å‘å­—ç¬¦ä¸²æ± ä¸­ç¼“å­˜çš„å­—ç¬¦ä¸²â€â€hello worldâ€ï¼Œæ‰€ä»¥å®ƒä»¬å°±æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚</p>\n","excerpt":"","more":"<p>é¦–å…ˆæ¥çœ‹ä¸‹é¢è¿™æ®µç¨‹åºï¼Œå’Œç¾¤å‹åˆ†äº«çš„å¤§è‡´ä¸€æ ·ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n    String hw &#x3D; &quot;hello world&quot;;\n    \n    String hello &#x3D; &quot;hello&quot;;\n    final String finalWorld2 &#x3D; &quot;hello&quot;;\n    final String finalWorld3 &#x3D; hello;\n    final String finalWorld4 &#x3D; &quot;he&quot; + &quot;llo&quot;;\n    \n    String hw1 &#x3D; hello + &quot; world&quot;;\n    String hw2 &#x3D; finalWorld2 + &quot; world&quot;;\n    String hw3 &#x3D; finalWorld3 + &quot; world&quot;;\n    String hw4 &#x3D; finalWorld4 + &quot; world&quot;;\n    \n    System.out.println(hw &#x3D;&#x3D; hw1);\n    System.out.println(hw &#x3D;&#x3D; hw2);\n    System.out.println(hw &#x3D;&#x3D; hw3);\n    System.out.println(hw &#x3D;&#x3D; hw4);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">false\ntrue\nfalse\ntrue<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>åŒæ ·æ˜¯å­—ç¬¦ä¸²â€helloâ€ï¼Œä¸ºä»€ä¹ˆç”¨finalå®šä¹‰çš„ï¼Œä¸”ä¸ªè¿›è¡Œ&#x3D;&#x3D;æ“ä½œå´æ˜¯trueæœ‰ä¸€ä¸ªæ˜¯falseï¼Œè€Œæ²¡ç”¨finalçš„å´æ˜¯false?</p>\n<p><strong>é¦–å…ˆæ¥ç†è§£ä¸‹å®å˜é‡ï¼š</strong></p>\n<p>Javaä¸­ï¼Œä¸€ä¸ªç”¨finalå®šä¹‰çš„å˜é‡ï¼Œä¸ç®¡å®ƒæ˜¯ç±»å‹çš„å˜é‡ï¼Œåªè¦ç”¨finalå®šä¹‰äº†å¹¶åŒæ—¶æŒ‡å®šäº†åˆå§‹å€¼ï¼Œå¹¶ä¸”è¿™ä¸ªåˆå§‹å€¼æ˜¯åœ¨ç¼–è¯‘æ—¶å°±è¢«ç¡®å®šä¸‹æ¥çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªfinalå˜é‡å°±æ˜¯ä¸€ä¸ªå®å˜é‡ã€‚ç¼–è¯‘å™¨ä¼šæŠŠç¨‹åºæ‰€æœ‰ç”¨åˆ°è¯¥å˜é‡çš„åœ°æ–¹ç›´æ¥æ›¿æ¢æˆè¯¥å˜é‡çš„å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´ç¼–è¯‘å™¨èƒ½å¯¹å®å˜é‡è¿›è¡Œå®æ›¿æ¢ã€‚</p>\n<p>å¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">final String a &#x3D; &quot;hello&quot;;\nfinal String b &#x3D; a;\nfinal String c &#x3D; getHello();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>aåœ¨ç¼–è¯‘æœŸé—´å°±èƒ½ç¡®å®šä¸‹æ¥ï¼Œè€Œbã€cä¸è¡Œï¼Œæ‰€ä»¥aæ˜¯å®å˜é‡ï¼Œbã€cä¸æ˜¯ã€‚</p>\n<p>æ‰€ä»¥ï¼Œå†å›åˆ°ä¸Šé¢çš„ç¨‹åºï¼ŒfinalWorld2å’ŒfinalWorld4æ˜¯finalå®šä¹‰çš„ï¼Œä¹Ÿæ˜¯åœ¨ç¼–è¯‘æœŸé—´èƒ½ç¡®å®šä¸‹æ¥çš„ï¼Œæ‰€ä»¥å®ƒèƒ½è¢«å®æ›¿æ¢ï¼Œç¼–è¯‘å™¨å°±ä¼šè®©finalWorld2å’ŒfinalWorld4æŒ‡å‘å­—ç¬¦ä¸²æ± ä¸­ç¼“å­˜çš„å­—ç¬¦ä¸²â€â€hello worldâ€ï¼Œæ‰€ä»¥å®ƒä»¬å°±æ˜¯åŒä¸€ä¸ªå¯¹è±¡ã€‚</p>\n"},{"title":"Java ä¸­è·å–ç±»åçš„ä¸‰ç§æ–¹æ³•ï¼Œä½ çŸ¥é“å‡ ç§ï¼Ÿ","date":"2025-10-15T03:36:33.000Z","_content":"#### è·å–ç±»åçš„æ–¹æ³•\n\nJava ä¸­è·å–ç±»åçš„æ–¹å¼ä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ç§ã€‚\n\n- **getName()**\n\nè¿”å›çš„æ˜¯è™šæ‹Ÿæœºé‡Œé¢çš„classçš„ç±»åè¡¨ç°å½¢å¼ã€‚\n\n- **getCanonicalName()**\n\nè¿”å›çš„æ˜¯æ›´å®¹æ˜“ç†è§£çš„ç±»åè¡¨ç¤ºã€‚\n\n- **getSimpleName()**\n\nè¿”å›çš„æ˜¯ç±»çš„ç®€ç§°ã€‚\n\n#### éƒ½æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\né€šè¿‡ä¸€ä¸ªå®ä¾‹æ¥çœ‹ä¸‹å®ƒä»¬ä¸»è¦çš„åŒºåˆ«ã€‚\n\n```\npublic class TestClass {\n\n\tpublic static void main(String[] args) {\n\t\t// å¤–éƒ¨æ™®é€šç±»\n\t\tSystem.out.println(\"æ–¹æ³•å             ç±»å\");\n\t\tSystem.out.println(\"getName            \" + TestClass.class.getName());\n\t\tSystem.out.println(\"getCanonicalName   \" + TestClass.class.getCanonicalName());\n\t\tSystem.out.println(\"getSimpleName      \" + TestClass.class.getSimpleName());\n\t\tSystem.out.println();\n\n\t\t// å†…éƒ¨ç±»\n\t\tSystem.out.println(\"getName            \" + TestInnerClass.class.getName());\n\t\tSystem.out.println(\"getCanonicalName   \" + TestInnerClass.class.getCanonicalName());\n\t\tSystem.out.println(\"getSimpleName      \" + TestInnerClass.class.getSimpleName());\n\t\tSystem.out.println();\n\n\t\t// æ•°ç»„ç±»\n\t\tTestInnerClass[] testInnerClasses = new TestInnerClass[]{\n\t\t\t\tnew TestInnerClass(),\n\t\t\t\tnew TestInnerClass(),\n\t\t\t\tnew TestInnerClass()\n\t\t};\n\t\tSystem.out.println(\"getName            \" + testInnerClasses.getClass().getName());\n\t\tSystem.out.println(\"getCanonicalName   \" + testInnerClasses.getClass().getCanonicalName());\n\t\tSystem.out.println(\"getSimpleName      \" + testInnerClasses.getClass().getSimpleName());\n\t\tSystem.out.println();\n\t}\n\n\tstatic class TestInnerClass {\n\n\t}\n\n}\n```\n\nç¨‹åºè¾“å‡ºä»¥ä¸‹ç»“æœã€‚\n\n```\næ–¹æ³•å              ç±»å\ngetName            com.test.TestClass\ngetCanonicalName   com.test.TestClass\ngetSimpleName      TestClass\n\ngetName            com.test.TestClass$TestInnerClass\ngetCanonicalName   com.test.TestClass.TestInnerClass\ngetSimpleName      TestInnerClass\n\ngetName            [Lcom.test.TestClass$TestInnerClass;\ngetCanonicalName   com.test.TestClass.TestInnerClass[]\ngetSimpleName      TestInnerClass[]\n```\n\n`[Lcom.test.TestClass$TestInnerClass;`å€¼å¾—è¯´æ˜ä¸€ä¸‹ã€‚\n\nè¿™æ˜¯ä¸€ç§å¯¹å‡½æ•°è¿”å›å€¼å’Œå‚æ•°çš„ç¼–ç ï¼Œå«åšJNIå­—æ®µæè¿°ç¬¦ï¼ˆJavaNative Interface FieldDescriptors)ã€‚\n\n`[` è¡¨ç¤ºæ•°ç»„ï¼Œä¸€ä¸ªä»£è¡¨ä¸€ç»´æ•°ç»„ï¼Œæ¯”å¦‚ `[[` ä»£è¡¨äºŒç»´æ•°ç»„ã€‚ä¹‹å `L` ä»£è¡¨ç±»æè¿°ç¬¦ï¼Œæœ€å`;`è¡¨ç¤ºç±»åç»“æŸã€‚\n\n#### ç»“è®º\n\n1ã€ä»ä»¥ä¸Šç»“æœå¯ä»¥çœ‹å‡º getName() å’Œ getCanonicalName() åœ¨è·å–æ™®é€šç±»åçš„æ—¶å€™æ²¡æœ‰åŒºåˆ«ï¼Œåœ¨è·å–å†…éƒ¨ç±»å’Œæ•°ç»„ç±»æœ‰åŒºåˆ«çš„ã€‚\n\n2ã€getSimpleName() åœ¨è·å–æ™®é€šç±»å’Œå†…éƒ¨ç±»åçš„æ—¶å€™æ²¡åŒºåˆ«ï¼Œåœ¨è·å–æ•°ç»„ç±»çš„æ—¶å€™æœ‰åŒºåˆ«ã€‚\n\n","source":"_posts/è¿›é˜¶/Java ä¸­è·å–ç±»åçš„ä¸‰ç§æ–¹æ³•ï¼Œä½ çŸ¥é“å‡ ç§ï¼Ÿ.md","raw":"---\ntitle: Java ä¸­è·å–ç±»åçš„ä¸‰ç§æ–¹æ³•ï¼Œä½ çŸ¥é“å‡ ç§ï¼Ÿ\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: è¿›é˜¶\n---\n#### è·å–ç±»åçš„æ–¹æ³•\n\nJava ä¸­è·å–ç±»åçš„æ–¹å¼ä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ç§ã€‚\n\n- **getName()**\n\nè¿”å›çš„æ˜¯è™šæ‹Ÿæœºé‡Œé¢çš„classçš„ç±»åè¡¨ç°å½¢å¼ã€‚\n\n- **getCanonicalName()**\n\nè¿”å›çš„æ˜¯æ›´å®¹æ˜“ç†è§£çš„ç±»åè¡¨ç¤ºã€‚\n\n- **getSimpleName()**\n\nè¿”å›çš„æ˜¯ç±»çš„ç®€ç§°ã€‚\n\n#### éƒ½æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\n\né€šè¿‡ä¸€ä¸ªå®ä¾‹æ¥çœ‹ä¸‹å®ƒä»¬ä¸»è¦çš„åŒºåˆ«ã€‚\n\n```\npublic class TestClass {\n\n\tpublic static void main(String[] args) {\n\t\t// å¤–éƒ¨æ™®é€šç±»\n\t\tSystem.out.println(\"æ–¹æ³•å             ç±»å\");\n\t\tSystem.out.println(\"getName            \" + TestClass.class.getName());\n\t\tSystem.out.println(\"getCanonicalName   \" + TestClass.class.getCanonicalName());\n\t\tSystem.out.println(\"getSimpleName      \" + TestClass.class.getSimpleName());\n\t\tSystem.out.println();\n\n\t\t// å†…éƒ¨ç±»\n\t\tSystem.out.println(\"getName            \" + TestInnerClass.class.getName());\n\t\tSystem.out.println(\"getCanonicalName   \" + TestInnerClass.class.getCanonicalName());\n\t\tSystem.out.println(\"getSimpleName      \" + TestInnerClass.class.getSimpleName());\n\t\tSystem.out.println();\n\n\t\t// æ•°ç»„ç±»\n\t\tTestInnerClass[] testInnerClasses = new TestInnerClass[]{\n\t\t\t\tnew TestInnerClass(),\n\t\t\t\tnew TestInnerClass(),\n\t\t\t\tnew TestInnerClass()\n\t\t};\n\t\tSystem.out.println(\"getName            \" + testInnerClasses.getClass().getName());\n\t\tSystem.out.println(\"getCanonicalName   \" + testInnerClasses.getClass().getCanonicalName());\n\t\tSystem.out.println(\"getSimpleName      \" + testInnerClasses.getClass().getSimpleName());\n\t\tSystem.out.println();\n\t}\n\n\tstatic class TestInnerClass {\n\n\t}\n\n}\n```\n\nç¨‹åºè¾“å‡ºä»¥ä¸‹ç»“æœã€‚\n\n```\næ–¹æ³•å              ç±»å\ngetName            com.test.TestClass\ngetCanonicalName   com.test.TestClass\ngetSimpleName      TestClass\n\ngetName            com.test.TestClass$TestInnerClass\ngetCanonicalName   com.test.TestClass.TestInnerClass\ngetSimpleName      TestInnerClass\n\ngetName            [Lcom.test.TestClass$TestInnerClass;\ngetCanonicalName   com.test.TestClass.TestInnerClass[]\ngetSimpleName      TestInnerClass[]\n```\n\n`[Lcom.test.TestClass$TestInnerClass;`å€¼å¾—è¯´æ˜ä¸€ä¸‹ã€‚\n\nè¿™æ˜¯ä¸€ç§å¯¹å‡½æ•°è¿”å›å€¼å’Œå‚æ•°çš„ç¼–ç ï¼Œå«åšJNIå­—æ®µæè¿°ç¬¦ï¼ˆJavaNative Interface FieldDescriptors)ã€‚\n\n`[` è¡¨ç¤ºæ•°ç»„ï¼Œä¸€ä¸ªä»£è¡¨ä¸€ç»´æ•°ç»„ï¼Œæ¯”å¦‚ `[[` ä»£è¡¨äºŒç»´æ•°ç»„ã€‚ä¹‹å `L` ä»£è¡¨ç±»æè¿°ç¬¦ï¼Œæœ€å`;`è¡¨ç¤ºç±»åç»“æŸã€‚\n\n#### ç»“è®º\n\n1ã€ä»ä»¥ä¸Šç»“æœå¯ä»¥çœ‹å‡º getName() å’Œ getCanonicalName() åœ¨è·å–æ™®é€šç±»åçš„æ—¶å€™æ²¡æœ‰åŒºåˆ«ï¼Œåœ¨è·å–å†…éƒ¨ç±»å’Œæ•°ç»„ç±»æœ‰åŒºåˆ«çš„ã€‚\n\n2ã€getSimpleName() åœ¨è·å–æ™®é€šç±»å’Œå†…éƒ¨ç±»åçš„æ—¶å€™æ²¡åŒºåˆ«ï¼Œåœ¨è·å–æ•°ç»„ç±»çš„æ—¶å€™æœ‰åŒºåˆ«ã€‚\n\n","slug":"è¿›é˜¶/Java ä¸­è·å–ç±»åçš„ä¸‰ç§æ–¹æ³•ï¼Œä½ çŸ¥é“å‡ ç§ï¼Ÿ","published":1,"updated":"2025-10-15T07:21:14.226Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076e000iqkd4d2ck5ag5","content":"<h4 id=\"è·å–ç±»åçš„æ–¹æ³•\"><a href=\"#è·å–ç±»åçš„æ–¹æ³•\" class=\"headerlink\" title=\"è·å–ç±»åçš„æ–¹æ³•\"></a>è·å–ç±»åçš„æ–¹æ³•</h4><p>Java ä¸­è·å–ç±»åçš„æ–¹å¼ä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ç§ã€‚</p>\n<ul>\n<li><strong>getName()</strong></li>\n</ul>\n<p>è¿”å›çš„æ˜¯è™šæ‹Ÿæœºé‡Œé¢çš„classçš„ç±»åè¡¨ç°å½¢å¼ã€‚</p>\n<ul>\n<li><strong>getCanonicalName()</strong></li>\n</ul>\n<p>è¿”å›çš„æ˜¯æ›´å®¹æ˜“ç†è§£çš„ç±»åè¡¨ç¤ºã€‚</p>\n<ul>\n<li><strong>getSimpleName()</strong></li>\n</ul>\n<p>è¿”å›çš„æ˜¯ç±»çš„ç®€ç§°ã€‚</p>\n<h4 id=\"éƒ½æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#éƒ½æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"éƒ½æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>éƒ½æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h4><p>é€šè¿‡ä¸€ä¸ªå®ä¾‹æ¥çœ‹ä¸‹å®ƒä»¬ä¸»è¦çš„åŒºåˆ«ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class TestClass &#123;\n\n\tpublic static void main(String[] args) &#123;\n\t\t&#x2F;&#x2F; å¤–éƒ¨æ™®é€šç±»\n\t\tSystem.out.println(&quot;æ–¹æ³•å             ç±»å&quot;);\n\t\tSystem.out.println(&quot;getName            &quot; + TestClass.class.getName());\n\t\tSystem.out.println(&quot;getCanonicalName   &quot; + TestClass.class.getCanonicalName());\n\t\tSystem.out.println(&quot;getSimpleName      &quot; + TestClass.class.getSimpleName());\n\t\tSystem.out.println();\n\n\t\t&#x2F;&#x2F; å†…éƒ¨ç±»\n\t\tSystem.out.println(&quot;getName            &quot; + TestInnerClass.class.getName());\n\t\tSystem.out.println(&quot;getCanonicalName   &quot; + TestInnerClass.class.getCanonicalName());\n\t\tSystem.out.println(&quot;getSimpleName      &quot; + TestInnerClass.class.getSimpleName());\n\t\tSystem.out.println();\n\n\t\t&#x2F;&#x2F; æ•°ç»„ç±»\n\t\tTestInnerClass[] testInnerClasses &#x3D; new TestInnerClass[]&#123;\n\t\t\t\tnew TestInnerClass(),\n\t\t\t\tnew TestInnerClass(),\n\t\t\t\tnew TestInnerClass()\n\t\t&#125;;\n\t\tSystem.out.println(&quot;getName            &quot; + testInnerClasses.getClass().getName());\n\t\tSystem.out.println(&quot;getCanonicalName   &quot; + testInnerClasses.getClass().getCanonicalName());\n\t\tSystem.out.println(&quot;getSimpleName      &quot; + testInnerClasses.getClass().getSimpleName());\n\t\tSystem.out.println();\n\t&#125;\n\n\tstatic class TestInnerClass &#123;\n\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºä»¥ä¸‹ç»“æœã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">æ–¹æ³•å              ç±»å\ngetName            com.test.TestClass\ngetCanonicalName   com.test.TestClass\ngetSimpleName      TestClass\n\ngetName            com.test.TestClass$TestInnerClass\ngetCanonicalName   com.test.TestClass.TestInnerClass\ngetSimpleName      TestInnerClass\n\ngetName            [Lcom.test.TestClass$TestInnerClass;\ngetCanonicalName   com.test.TestClass.TestInnerClass[]\ngetSimpleName      TestInnerClass[]<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><code>[Lcom.test.TestClass$TestInnerClass;</code>å€¼å¾—è¯´æ˜ä¸€ä¸‹ã€‚</p>\n<p>è¿™æ˜¯ä¸€ç§å¯¹å‡½æ•°è¿”å›å€¼å’Œå‚æ•°çš„ç¼–ç ï¼Œå«åšJNIå­—æ®µæè¿°ç¬¦ï¼ˆJavaNative Interface FieldDescriptors)ã€‚</p>\n<p><code>[</code> è¡¨ç¤ºæ•°ç»„ï¼Œä¸€ä¸ªä»£è¡¨ä¸€ç»´æ•°ç»„ï¼Œæ¯”å¦‚ <code>[[</code> ä»£è¡¨äºŒç»´æ•°ç»„ã€‚ä¹‹å <code>L</code> ä»£è¡¨ç±»æè¿°ç¬¦ï¼Œæœ€å<code>;</code>è¡¨ç¤ºç±»åç»“æŸã€‚</p>\n<h4 id=\"ç»“è®º\"><a href=\"#ç»“è®º\" class=\"headerlink\" title=\"ç»“è®º\"></a>ç»“è®º</h4><p>1ã€ä»ä»¥ä¸Šç»“æœå¯ä»¥çœ‹å‡º getName() å’Œ getCanonicalName() åœ¨è·å–æ™®é€šç±»åçš„æ—¶å€™æ²¡æœ‰åŒºåˆ«ï¼Œåœ¨è·å–å†…éƒ¨ç±»å’Œæ•°ç»„ç±»æœ‰åŒºåˆ«çš„ã€‚</p>\n<p>2ã€getSimpleName() åœ¨è·å–æ™®é€šç±»å’Œå†…éƒ¨ç±»åçš„æ—¶å€™æ²¡åŒºåˆ«ï¼Œåœ¨è·å–æ•°ç»„ç±»çš„æ—¶å€™æœ‰åŒºåˆ«ã€‚</p>\n","excerpt":"","more":"<h4 id=\"è·å–ç±»åçš„æ–¹æ³•\"><a href=\"#è·å–ç±»åçš„æ–¹æ³•\" class=\"headerlink\" title=\"è·å–ç±»åçš„æ–¹æ³•\"></a>è·å–ç±»åçš„æ–¹æ³•</h4><p>Java ä¸­è·å–ç±»åçš„æ–¹å¼ä¸»è¦æœ‰ä»¥ä¸‹ä¸‰ç§ã€‚</p>\n<ul>\n<li><strong>getName()</strong></li>\n</ul>\n<p>è¿”å›çš„æ˜¯è™šæ‹Ÿæœºé‡Œé¢çš„classçš„ç±»åè¡¨ç°å½¢å¼ã€‚</p>\n<ul>\n<li><strong>getCanonicalName()</strong></li>\n</ul>\n<p>è¿”å›çš„æ˜¯æ›´å®¹æ˜“ç†è§£çš„ç±»åè¡¨ç¤ºã€‚</p>\n<ul>\n<li><strong>getSimpleName()</strong></li>\n</ul>\n<p>è¿”å›çš„æ˜¯ç±»çš„ç®€ç§°ã€‚</p>\n<h4 id=\"éƒ½æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"><a href=\"#éƒ½æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\" class=\"headerlink\" title=\"éƒ½æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\"></a>éƒ½æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h4><p>é€šè¿‡ä¸€ä¸ªå®ä¾‹æ¥çœ‹ä¸‹å®ƒä»¬ä¸»è¦çš„åŒºåˆ«ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class TestClass &#123;\n\n\tpublic static void main(String[] args) &#123;\n\t\t&#x2F;&#x2F; å¤–éƒ¨æ™®é€šç±»\n\t\tSystem.out.println(&quot;æ–¹æ³•å             ç±»å&quot;);\n\t\tSystem.out.println(&quot;getName            &quot; + TestClass.class.getName());\n\t\tSystem.out.println(&quot;getCanonicalName   &quot; + TestClass.class.getCanonicalName());\n\t\tSystem.out.println(&quot;getSimpleName      &quot; + TestClass.class.getSimpleName());\n\t\tSystem.out.println();\n\n\t\t&#x2F;&#x2F; å†…éƒ¨ç±»\n\t\tSystem.out.println(&quot;getName            &quot; + TestInnerClass.class.getName());\n\t\tSystem.out.println(&quot;getCanonicalName   &quot; + TestInnerClass.class.getCanonicalName());\n\t\tSystem.out.println(&quot;getSimpleName      &quot; + TestInnerClass.class.getSimpleName());\n\t\tSystem.out.println();\n\n\t\t&#x2F;&#x2F; æ•°ç»„ç±»\n\t\tTestInnerClass[] testInnerClasses &#x3D; new TestInnerClass[]&#123;\n\t\t\t\tnew TestInnerClass(),\n\t\t\t\tnew TestInnerClass(),\n\t\t\t\tnew TestInnerClass()\n\t\t&#125;;\n\t\tSystem.out.println(&quot;getName            &quot; + testInnerClasses.getClass().getName());\n\t\tSystem.out.println(&quot;getCanonicalName   &quot; + testInnerClasses.getClass().getCanonicalName());\n\t\tSystem.out.println(&quot;getSimpleName      &quot; + testInnerClasses.getClass().getSimpleName());\n\t\tSystem.out.println();\n\t&#125;\n\n\tstatic class TestInnerClass &#123;\n\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºä»¥ä¸‹ç»“æœã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">æ–¹æ³•å              ç±»å\ngetName            com.test.TestClass\ngetCanonicalName   com.test.TestClass\ngetSimpleName      TestClass\n\ngetName            com.test.TestClass$TestInnerClass\ngetCanonicalName   com.test.TestClass.TestInnerClass\ngetSimpleName      TestInnerClass\n\ngetName            [Lcom.test.TestClass$TestInnerClass;\ngetCanonicalName   com.test.TestClass.TestInnerClass[]\ngetSimpleName      TestInnerClass[]<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><code>[Lcom.test.TestClass$TestInnerClass;</code>å€¼å¾—è¯´æ˜ä¸€ä¸‹ã€‚</p>\n<p>è¿™æ˜¯ä¸€ç§å¯¹å‡½æ•°è¿”å›å€¼å’Œå‚æ•°çš„ç¼–ç ï¼Œå«åšJNIå­—æ®µæè¿°ç¬¦ï¼ˆJavaNative Interface FieldDescriptors)ã€‚</p>\n<p><code>[</code> è¡¨ç¤ºæ•°ç»„ï¼Œä¸€ä¸ªä»£è¡¨ä¸€ç»´æ•°ç»„ï¼Œæ¯”å¦‚ <code>[[</code> ä»£è¡¨äºŒç»´æ•°ç»„ã€‚ä¹‹å <code>L</code> ä»£è¡¨ç±»æè¿°ç¬¦ï¼Œæœ€å<code>;</code>è¡¨ç¤ºç±»åç»“æŸã€‚</p>\n<h4 id=\"ç»“è®º\"><a href=\"#ç»“è®º\" class=\"headerlink\" title=\"ç»“è®º\"></a>ç»“è®º</h4><p>1ã€ä»ä»¥ä¸Šç»“æœå¯ä»¥çœ‹å‡º getName() å’Œ getCanonicalName() åœ¨è·å–æ™®é€šç±»åçš„æ—¶å€™æ²¡æœ‰åŒºåˆ«ï¼Œåœ¨è·å–å†…éƒ¨ç±»å’Œæ•°ç»„ç±»æœ‰åŒºåˆ«çš„ã€‚</p>\n<p>2ã€getSimpleName() åœ¨è·å–æ™®é€šç±»å’Œå†…éƒ¨ç±»åçš„æ—¶å€™æ²¡åŒºåˆ«ï¼Œåœ¨è·å–æ•°ç»„ç±»çš„æ—¶å€™æœ‰åŒºåˆ«ã€‚</p>\n"},{"title":"Java å¯¹è±¡å¼•ç”¨å››ä¸ªçº§åˆ«ï¼ˆå¼ºã€è½¯ã€å¼±ã€è™šï¼‰","date":"2025-10-15T03:36:33.000Z","_content":"\n![image](http://img.javastack.cn/17-12-27/5366993.jpg)\n\n\nä¸ºäº†ä½¿ç¨‹åºèƒ½æ›´åŠ çµæ´»åœ°æ§åˆ¶å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œä»JDK1.2ç‰ˆæœ¬å¼€å§‹ï¼ŒJDKæŠŠå¯¹è±¡çš„å¼•ç”¨çº§åˆ«åˆ†ä¸ºäº†ä»¥ä¸‹å››ç§ã€‚\n\n**è¿™4ç§çº§åˆ«ç”±é«˜åˆ°ä½ä¾æ¬¡ä¸ºï¼š**\n\n- å¼ºå¼•ç”¨ï¼ˆStrongReferenceï¼‰\n\nå¼ºå¼•ç”¨å°±æ˜¯æˆ‘ä»¬å¹³å¸¸æœ€åŸºæœ¬çš„å¯¹è±¡å¼•ç”¨ï¼Œå¦‚æœæ˜¯å¼ºå¼•ç”¨ï¼Œé‚£å›æ”¶å™¨ä¸ä¼šå›æ”¶å¸¦æœ‰å¼ºå¼•ç”¨çš„å¯¹è±¡ã€‚å³ä½¿å†…å­˜ä¸è¶³æŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ä¹Ÿä¸ä¼šå›æ”¶å¼ºå¼•ç”¨å¯¹è±¡ï¼Œå­˜åœ¨å³åˆç†å§ã€‚\n\nå¦‚ï¼š\n```\nUser user = new User(\"JavaæŠ€æœ¯\");\n```\nè¿™å°±æ˜¯å¼ºå¼•ç”¨ï¼ŒuseræŒæœ‰äº†è¿™ä¸ªå¯¹è±¡çš„å­˜å‚¨åœ°å€çš„å¼•ç”¨ã€‚\n\n- è½¯å¼•ç”¨ï¼ˆSoftReferenceï¼‰\n\nä¸€ä¸ªå¯¹è±¡åªæœ‰è½¯å¼•ç”¨ï¼Œå¦‚æœå†…å­˜ç©ºé—´è¶³å¤Ÿæƒ…å†µä¸‹åƒåœ¾å›æ”¶å™¨å°±ä¸ä¼šå›æ”¶å®ƒï¼Œå¦‚æœå†…å­˜ç©ºé—´ä¸å¤Ÿäº†å°±ä¼šå¯¹è¿™äº›åªæœ‰è½¯å¼•ç”¨çš„å¯¹è±¡è¿›è¡Œå›æ”¶ã€‚åªè¦åƒåœ¾å›æ”¶å™¨æ²¡æœ‰å›æ”¶ï¼Œè¯¥è½¯å¼•ç”¨å¯¹è±¡å°±å¯ä»¥ç»§ç»­è¢«ç¨‹åºä½¿ç”¨ã€‚\n\næ‰€ä»¥è½¯å¼•ç”¨ä¸€èˆ¬ç”¨æ¥å®ç°ä¸€äº›å†…å­˜æ•æ„Ÿçš„ç¼“å­˜ï¼Œåªè¦å†…å­˜ç©ºé—´è¶³å¤Ÿï¼Œå¯¹è±¡å°±ä¼šä¿æŒä¸è¢«å›æ”¶æ‰ã€‚\n\n- å¼±å¼•ç”¨ï¼ˆWeakReferenceï¼‰\n\nå¼±å¼•ç”¨çš„å¯¹è±¡å…·æœ‰æ›´çŸ­æš‚çš„ç”Ÿå‘½å‘¨æœŸï¼Œåœ¨åƒåœ¾å›æ”¶å™¨çº¿ç¨‹æ‰«æå®ƒæ‰€ç®¡è¾–çš„å†…å­˜åŒºåŸŸçš„è¿‡ç¨‹ä¸­ï¼Œä¸€æ—¦å‘ç°äº†åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ï¼Œä¸ç®¡å½“å‰å†…å­˜ç©ºé—´è¶³å¤Ÿä¸å¦ï¼Œéƒ½ä¼šå›æ”¶å®ƒçš„å†…å­˜ã€‚ä¸è¿‡ï¼Œç”±äºåƒåœ¾å›æ”¶å™¨æ˜¯ä¸€ä¸ªä¼˜å…ˆçº§å¾ˆä½çš„çº¿ç¨‹ï¼Œå› æ­¤ä¸ä¸€å®šä¼šå¾ˆå¿«å‘ç°é‚£äº›åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ã€‚\n\nå¼±å¼•ç”¨å¯ä»¥ç”¨æ¥å®ç°ä¸€äº›è§„èŒƒåŒ–æ˜ å°„ï¼Œå¦‚WeakHashMapï¼Œå½“keyæˆ–è€…valueä¸å†è¢«å¼•ç”¨æ—¶å¯ä»¥è‡ªåŠ¨è¢«å›æ”¶ã€‚\n\n- è™šå¼•ç”¨ï¼ˆPhantomReferenceï¼‰\n\nè™šå¼•ç”¨é¡¾åæ€ä¹‰å°±æ˜¯å½¢åŒè™šè®¾ï¼Œè™šå¼•ç”¨å¹¶ä¸å†³å®šå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡ä»…æŒæœ‰è™šå¼•ç”¨ï¼Œé‚£ä¹ˆå®ƒå°±å’Œæ²¡æœ‰ä»»ä½•å¼•ç”¨ä¸€æ ·ï¼Œåœ¨ä»»ä½•æ—¶å€™éƒ½å¯èƒ½è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ã€‚\n\nè™šå¼•ç”¨ä¸»è¦ç”¨æ¥è·Ÿè¸ªå¯¹è±¡è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶çš„æ´»åŠ¨ï¼Œè™šå¼•ç”¨å¿…é¡»å’Œå¼•ç”¨é˜Ÿåˆ—ï¼ˆReferenceQueueï¼‰è”åˆä½¿ç”¨ï¼Œå½“åƒåœ¾å›æ”¶å™¨å‡†å¤‡å›æ”¶ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœå‘ç°å®ƒè¿˜æœ‰è™šå¼•ç”¨ï¼Œå°±ä¼šåœ¨å›æ”¶å¯¹è±¡çš„å†…å­˜ä¹‹å‰ï¼ŒæŠŠè¿™ä¸ªè™šå¼•ç”¨åŠ å…¥åˆ°ä¸ä¹‹å…³è”çš„å¼•ç”¨é˜Ÿåˆ—ä¸­ã€‚\n\n**ä¸‹é¢é€šè¿‡ä¸€å¼ è¡¨æ ¼æ¥è¯´æ˜å®ƒä»¬çš„å›æ”¶æ—¶é—´ã€ç”¨é€”ã€‚**\n\n\nå¼•ç”¨ç±»å‹ | å›æ”¶æ—¶é—´ | ç”¨é€”\n---|---|---\nå¼ºå¼•ç”¨ | æ°¸ä¸å›æ”¶ | æ™®é€šå¯¹è±¡å¼•ç”¨\nè½¯å¼•ç”¨ | å†…åœ¨ä¸è¶³å›æ”¶ | ç¼“å­˜å¯¹è±¡\nå¼±å¼•ç”¨ | åƒåœ¾å›æ”¶æ—¶ | ç¼“å­˜å¯¹è±¡\nè™šå¼•ç”¨ | ä¸ç¡®å®š | ä¸ç¡®å®š\n\nä¸ç®¡è¿™äº›ä¸œè¥¿å¹³æ—¶æœ‰æ²¡æœ‰ç”¨åˆ°ï¼Œæˆ‘ä»¬éƒ½å¿…é¡»äº†è§£è¿™äº›æœºåˆ¶ï¼Œè¿™å¯¹ä¸ªäººçš„çŸ¥è¯†é¢åŠæ‹“å±•æ˜¯éå¸¸æœ‰å¸®åŠ©çš„ã€‚\n\n\n","source":"_posts/è¿›é˜¶/Java å¯¹è±¡å¼•ç”¨å››ä¸ªçº§åˆ«ï¼ˆå¼ºã€è½¯ã€å¼±ã€è™šï¼‰.md","raw":"---\ntitle: Java å¯¹è±¡å¼•ç”¨å››ä¸ªçº§åˆ«ï¼ˆå¼ºã€è½¯ã€å¼±ã€è™šï¼‰\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: è¿›é˜¶\n---\n\n![image](http://img.javastack.cn/17-12-27/5366993.jpg)\n\n\nä¸ºäº†ä½¿ç¨‹åºèƒ½æ›´åŠ çµæ´»åœ°æ§åˆ¶å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œä»JDK1.2ç‰ˆæœ¬å¼€å§‹ï¼ŒJDKæŠŠå¯¹è±¡çš„å¼•ç”¨çº§åˆ«åˆ†ä¸ºäº†ä»¥ä¸‹å››ç§ã€‚\n\n**è¿™4ç§çº§åˆ«ç”±é«˜åˆ°ä½ä¾æ¬¡ä¸ºï¼š**\n\n- å¼ºå¼•ç”¨ï¼ˆStrongReferenceï¼‰\n\nå¼ºå¼•ç”¨å°±æ˜¯æˆ‘ä»¬å¹³å¸¸æœ€åŸºæœ¬çš„å¯¹è±¡å¼•ç”¨ï¼Œå¦‚æœæ˜¯å¼ºå¼•ç”¨ï¼Œé‚£å›æ”¶å™¨ä¸ä¼šå›æ”¶å¸¦æœ‰å¼ºå¼•ç”¨çš„å¯¹è±¡ã€‚å³ä½¿å†…å­˜ä¸è¶³æŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ä¹Ÿä¸ä¼šå›æ”¶å¼ºå¼•ç”¨å¯¹è±¡ï¼Œå­˜åœ¨å³åˆç†å§ã€‚\n\nå¦‚ï¼š\n```\nUser user = new User(\"JavaæŠ€æœ¯\");\n```\nè¿™å°±æ˜¯å¼ºå¼•ç”¨ï¼ŒuseræŒæœ‰äº†è¿™ä¸ªå¯¹è±¡çš„å­˜å‚¨åœ°å€çš„å¼•ç”¨ã€‚\n\n- è½¯å¼•ç”¨ï¼ˆSoftReferenceï¼‰\n\nä¸€ä¸ªå¯¹è±¡åªæœ‰è½¯å¼•ç”¨ï¼Œå¦‚æœå†…å­˜ç©ºé—´è¶³å¤Ÿæƒ…å†µä¸‹åƒåœ¾å›æ”¶å™¨å°±ä¸ä¼šå›æ”¶å®ƒï¼Œå¦‚æœå†…å­˜ç©ºé—´ä¸å¤Ÿäº†å°±ä¼šå¯¹è¿™äº›åªæœ‰è½¯å¼•ç”¨çš„å¯¹è±¡è¿›è¡Œå›æ”¶ã€‚åªè¦åƒåœ¾å›æ”¶å™¨æ²¡æœ‰å›æ”¶ï¼Œè¯¥è½¯å¼•ç”¨å¯¹è±¡å°±å¯ä»¥ç»§ç»­è¢«ç¨‹åºä½¿ç”¨ã€‚\n\næ‰€ä»¥è½¯å¼•ç”¨ä¸€èˆ¬ç”¨æ¥å®ç°ä¸€äº›å†…å­˜æ•æ„Ÿçš„ç¼“å­˜ï¼Œåªè¦å†…å­˜ç©ºé—´è¶³å¤Ÿï¼Œå¯¹è±¡å°±ä¼šä¿æŒä¸è¢«å›æ”¶æ‰ã€‚\n\n- å¼±å¼•ç”¨ï¼ˆWeakReferenceï¼‰\n\nå¼±å¼•ç”¨çš„å¯¹è±¡å…·æœ‰æ›´çŸ­æš‚çš„ç”Ÿå‘½å‘¨æœŸï¼Œåœ¨åƒåœ¾å›æ”¶å™¨çº¿ç¨‹æ‰«æå®ƒæ‰€ç®¡è¾–çš„å†…å­˜åŒºåŸŸçš„è¿‡ç¨‹ä¸­ï¼Œä¸€æ—¦å‘ç°äº†åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ï¼Œä¸ç®¡å½“å‰å†…å­˜ç©ºé—´è¶³å¤Ÿä¸å¦ï¼Œéƒ½ä¼šå›æ”¶å®ƒçš„å†…å­˜ã€‚ä¸è¿‡ï¼Œç”±äºåƒåœ¾å›æ”¶å™¨æ˜¯ä¸€ä¸ªä¼˜å…ˆçº§å¾ˆä½çš„çº¿ç¨‹ï¼Œå› æ­¤ä¸ä¸€å®šä¼šå¾ˆå¿«å‘ç°é‚£äº›åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ã€‚\n\nå¼±å¼•ç”¨å¯ä»¥ç”¨æ¥å®ç°ä¸€äº›è§„èŒƒåŒ–æ˜ å°„ï¼Œå¦‚WeakHashMapï¼Œå½“keyæˆ–è€…valueä¸å†è¢«å¼•ç”¨æ—¶å¯ä»¥è‡ªåŠ¨è¢«å›æ”¶ã€‚\n\n- è™šå¼•ç”¨ï¼ˆPhantomReferenceï¼‰\n\nè™šå¼•ç”¨é¡¾åæ€ä¹‰å°±æ˜¯å½¢åŒè™šè®¾ï¼Œè™šå¼•ç”¨å¹¶ä¸å†³å®šå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡ä»…æŒæœ‰è™šå¼•ç”¨ï¼Œé‚£ä¹ˆå®ƒå°±å’Œæ²¡æœ‰ä»»ä½•å¼•ç”¨ä¸€æ ·ï¼Œåœ¨ä»»ä½•æ—¶å€™éƒ½å¯èƒ½è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ã€‚\n\nè™šå¼•ç”¨ä¸»è¦ç”¨æ¥è·Ÿè¸ªå¯¹è±¡è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶çš„æ´»åŠ¨ï¼Œè™šå¼•ç”¨å¿…é¡»å’Œå¼•ç”¨é˜Ÿåˆ—ï¼ˆReferenceQueueï¼‰è”åˆä½¿ç”¨ï¼Œå½“åƒåœ¾å›æ”¶å™¨å‡†å¤‡å›æ”¶ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœå‘ç°å®ƒè¿˜æœ‰è™šå¼•ç”¨ï¼Œå°±ä¼šåœ¨å›æ”¶å¯¹è±¡çš„å†…å­˜ä¹‹å‰ï¼ŒæŠŠè¿™ä¸ªè™šå¼•ç”¨åŠ å…¥åˆ°ä¸ä¹‹å…³è”çš„å¼•ç”¨é˜Ÿåˆ—ä¸­ã€‚\n\n**ä¸‹é¢é€šè¿‡ä¸€å¼ è¡¨æ ¼æ¥è¯´æ˜å®ƒä»¬çš„å›æ”¶æ—¶é—´ã€ç”¨é€”ã€‚**\n\n\nå¼•ç”¨ç±»å‹ | å›æ”¶æ—¶é—´ | ç”¨é€”\n---|---|---\nå¼ºå¼•ç”¨ | æ°¸ä¸å›æ”¶ | æ™®é€šå¯¹è±¡å¼•ç”¨\nè½¯å¼•ç”¨ | å†…åœ¨ä¸è¶³å›æ”¶ | ç¼“å­˜å¯¹è±¡\nå¼±å¼•ç”¨ | åƒåœ¾å›æ”¶æ—¶ | ç¼“å­˜å¯¹è±¡\nè™šå¼•ç”¨ | ä¸ç¡®å®š | ä¸ç¡®å®š\n\nä¸ç®¡è¿™äº›ä¸œè¥¿å¹³æ—¶æœ‰æ²¡æœ‰ç”¨åˆ°ï¼Œæˆ‘ä»¬éƒ½å¿…é¡»äº†è§£è¿™äº›æœºåˆ¶ï¼Œè¿™å¯¹ä¸ªäººçš„çŸ¥è¯†é¢åŠæ‹“å±•æ˜¯éå¸¸æœ‰å¸®åŠ©çš„ã€‚\n\n\n","slug":"è¿›é˜¶/Java å¯¹è±¡å¼•ç”¨å››ä¸ªçº§åˆ«ï¼ˆå¼ºã€è½¯ã€å¼±ã€è™šï¼‰","published":1,"updated":"2025-10-15T07:21:14.282Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076f000kqkd40a0y7rel","content":"<p><img src=\"http://img.javastack.cn/17-12-27/5366993.jpg\" alt=\"image\"></p>\n<p>ä¸ºäº†ä½¿ç¨‹åºèƒ½æ›´åŠ çµæ´»åœ°æ§åˆ¶å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œä»JDK1.2ç‰ˆæœ¬å¼€å§‹ï¼ŒJDKæŠŠå¯¹è±¡çš„å¼•ç”¨çº§åˆ«åˆ†ä¸ºäº†ä»¥ä¸‹å››ç§ã€‚</p>\n<p><strong>è¿™4ç§çº§åˆ«ç”±é«˜åˆ°ä½ä¾æ¬¡ä¸ºï¼š</strong></p>\n<ul>\n<li>å¼ºå¼•ç”¨ï¼ˆStrongReferenceï¼‰</li>\n</ul>\n<p>å¼ºå¼•ç”¨å°±æ˜¯æˆ‘ä»¬å¹³å¸¸æœ€åŸºæœ¬çš„å¯¹è±¡å¼•ç”¨ï¼Œå¦‚æœæ˜¯å¼ºå¼•ç”¨ï¼Œé‚£å›æ”¶å™¨ä¸ä¼šå›æ”¶å¸¦æœ‰å¼ºå¼•ç”¨çš„å¯¹è±¡ã€‚å³ä½¿å†…å­˜ä¸è¶³æŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ä¹Ÿä¸ä¼šå›æ”¶å¼ºå¼•ç”¨å¯¹è±¡ï¼Œå­˜åœ¨å³åˆç†å§ã€‚</p>\n<p>å¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">User user &#x3D; new User(&quot;JavaæŠ€æœ¯&quot;);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>è¿™å°±æ˜¯å¼ºå¼•ç”¨ï¼ŒuseræŒæœ‰äº†è¿™ä¸ªå¯¹è±¡çš„å­˜å‚¨åœ°å€çš„å¼•ç”¨ã€‚</p>\n<ul>\n<li>è½¯å¼•ç”¨ï¼ˆSoftReferenceï¼‰</li>\n</ul>\n<p>ä¸€ä¸ªå¯¹è±¡åªæœ‰è½¯å¼•ç”¨ï¼Œå¦‚æœå†…å­˜ç©ºé—´è¶³å¤Ÿæƒ…å†µä¸‹åƒåœ¾å›æ”¶å™¨å°±ä¸ä¼šå›æ”¶å®ƒï¼Œå¦‚æœå†…å­˜ç©ºé—´ä¸å¤Ÿäº†å°±ä¼šå¯¹è¿™äº›åªæœ‰è½¯å¼•ç”¨çš„å¯¹è±¡è¿›è¡Œå›æ”¶ã€‚åªè¦åƒåœ¾å›æ”¶å™¨æ²¡æœ‰å›æ”¶ï¼Œè¯¥è½¯å¼•ç”¨å¯¹è±¡å°±å¯ä»¥ç»§ç»­è¢«ç¨‹åºä½¿ç”¨ã€‚</p>\n<p>æ‰€ä»¥è½¯å¼•ç”¨ä¸€èˆ¬ç”¨æ¥å®ç°ä¸€äº›å†…å­˜æ•æ„Ÿçš„ç¼“å­˜ï¼Œåªè¦å†…å­˜ç©ºé—´è¶³å¤Ÿï¼Œå¯¹è±¡å°±ä¼šä¿æŒä¸è¢«å›æ”¶æ‰ã€‚</p>\n<ul>\n<li>å¼±å¼•ç”¨ï¼ˆWeakReferenceï¼‰</li>\n</ul>\n<p>å¼±å¼•ç”¨çš„å¯¹è±¡å…·æœ‰æ›´çŸ­æš‚çš„ç”Ÿå‘½å‘¨æœŸï¼Œåœ¨åƒåœ¾å›æ”¶å™¨çº¿ç¨‹æ‰«æå®ƒæ‰€ç®¡è¾–çš„å†…å­˜åŒºåŸŸçš„è¿‡ç¨‹ä¸­ï¼Œä¸€æ—¦å‘ç°äº†åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ï¼Œä¸ç®¡å½“å‰å†…å­˜ç©ºé—´è¶³å¤Ÿä¸å¦ï¼Œéƒ½ä¼šå›æ”¶å®ƒçš„å†…å­˜ã€‚ä¸è¿‡ï¼Œç”±äºåƒåœ¾å›æ”¶å™¨æ˜¯ä¸€ä¸ªä¼˜å…ˆçº§å¾ˆä½çš„çº¿ç¨‹ï¼Œå› æ­¤ä¸ä¸€å®šä¼šå¾ˆå¿«å‘ç°é‚£äº›åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ã€‚</p>\n<p>å¼±å¼•ç”¨å¯ä»¥ç”¨æ¥å®ç°ä¸€äº›è§„èŒƒåŒ–æ˜ å°„ï¼Œå¦‚WeakHashMapï¼Œå½“keyæˆ–è€…valueä¸å†è¢«å¼•ç”¨æ—¶å¯ä»¥è‡ªåŠ¨è¢«å›æ”¶ã€‚</p>\n<ul>\n<li>è™šå¼•ç”¨ï¼ˆPhantomReferenceï¼‰</li>\n</ul>\n<p>è™šå¼•ç”¨é¡¾åæ€ä¹‰å°±æ˜¯å½¢åŒè™šè®¾ï¼Œè™šå¼•ç”¨å¹¶ä¸å†³å®šå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡ä»…æŒæœ‰è™šå¼•ç”¨ï¼Œé‚£ä¹ˆå®ƒå°±å’Œæ²¡æœ‰ä»»ä½•å¼•ç”¨ä¸€æ ·ï¼Œåœ¨ä»»ä½•æ—¶å€™éƒ½å¯èƒ½è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ã€‚</p>\n<p>è™šå¼•ç”¨ä¸»è¦ç”¨æ¥è·Ÿè¸ªå¯¹è±¡è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶çš„æ´»åŠ¨ï¼Œè™šå¼•ç”¨å¿…é¡»å’Œå¼•ç”¨é˜Ÿåˆ—ï¼ˆReferenceQueueï¼‰è”åˆä½¿ç”¨ï¼Œå½“åƒåœ¾å›æ”¶å™¨å‡†å¤‡å›æ”¶ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœå‘ç°å®ƒè¿˜æœ‰è™šå¼•ç”¨ï¼Œå°±ä¼šåœ¨å›æ”¶å¯¹è±¡çš„å†…å­˜ä¹‹å‰ï¼ŒæŠŠè¿™ä¸ªè™šå¼•ç”¨åŠ å…¥åˆ°ä¸ä¹‹å…³è”çš„å¼•ç”¨é˜Ÿåˆ—ä¸­ã€‚</p>\n<p><strong>ä¸‹é¢é€šè¿‡ä¸€å¼ è¡¨æ ¼æ¥è¯´æ˜å®ƒä»¬çš„å›æ”¶æ—¶é—´ã€ç”¨é€”ã€‚</strong></p>\n<table>\n<thead>\n<tr>\n<th>å¼•ç”¨ç±»å‹</th>\n<th>å›æ”¶æ—¶é—´</th>\n<th>ç”¨é€”</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>å¼ºå¼•ç”¨</td>\n<td>æ°¸ä¸å›æ”¶</td>\n<td>æ™®é€šå¯¹è±¡å¼•ç”¨</td>\n</tr>\n<tr>\n<td>è½¯å¼•ç”¨</td>\n<td>å†…åœ¨ä¸è¶³å›æ”¶</td>\n<td>ç¼“å­˜å¯¹è±¡</td>\n</tr>\n<tr>\n<td>å¼±å¼•ç”¨</td>\n<td>åƒåœ¾å›æ”¶æ—¶</td>\n<td>ç¼“å­˜å¯¹è±¡</td>\n</tr>\n<tr>\n<td>è™šå¼•ç”¨</td>\n<td>ä¸ç¡®å®š</td>\n<td>ä¸ç¡®å®š</td>\n</tr>\n</tbody></table>\n<p>ä¸ç®¡è¿™äº›ä¸œè¥¿å¹³æ—¶æœ‰æ²¡æœ‰ç”¨åˆ°ï¼Œæˆ‘ä»¬éƒ½å¿…é¡»äº†è§£è¿™äº›æœºåˆ¶ï¼Œè¿™å¯¹ä¸ªäººçš„çŸ¥è¯†é¢åŠæ‹“å±•æ˜¯éå¸¸æœ‰å¸®åŠ©çš„ã€‚</p>\n","excerpt":"","more":"<p><img src=\"http://img.javastack.cn/17-12-27/5366993.jpg\" alt=\"image\"></p>\n<p>ä¸ºäº†ä½¿ç¨‹åºèƒ½æ›´åŠ çµæ´»åœ°æ§åˆ¶å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œä»JDK1.2ç‰ˆæœ¬å¼€å§‹ï¼ŒJDKæŠŠå¯¹è±¡çš„å¼•ç”¨çº§åˆ«åˆ†ä¸ºäº†ä»¥ä¸‹å››ç§ã€‚</p>\n<p><strong>è¿™4ç§çº§åˆ«ç”±é«˜åˆ°ä½ä¾æ¬¡ä¸ºï¼š</strong></p>\n<ul>\n<li>å¼ºå¼•ç”¨ï¼ˆStrongReferenceï¼‰</li>\n</ul>\n<p>å¼ºå¼•ç”¨å°±æ˜¯æˆ‘ä»¬å¹³å¸¸æœ€åŸºæœ¬çš„å¯¹è±¡å¼•ç”¨ï¼Œå¦‚æœæ˜¯å¼ºå¼•ç”¨ï¼Œé‚£å›æ”¶å™¨ä¸ä¼šå›æ”¶å¸¦æœ‰å¼ºå¼•ç”¨çš„å¯¹è±¡ã€‚å³ä½¿å†…å­˜ä¸è¶³æŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ä¹Ÿä¸ä¼šå›æ”¶å¼ºå¼•ç”¨å¯¹è±¡ï¼Œå­˜åœ¨å³åˆç†å§ã€‚</p>\n<p>å¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">User user &#x3D; new User(&quot;JavaæŠ€æœ¯&quot;);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>è¿™å°±æ˜¯å¼ºå¼•ç”¨ï¼ŒuseræŒæœ‰äº†è¿™ä¸ªå¯¹è±¡çš„å­˜å‚¨åœ°å€çš„å¼•ç”¨ã€‚</p>\n<ul>\n<li>è½¯å¼•ç”¨ï¼ˆSoftReferenceï¼‰</li>\n</ul>\n<p>ä¸€ä¸ªå¯¹è±¡åªæœ‰è½¯å¼•ç”¨ï¼Œå¦‚æœå†…å­˜ç©ºé—´è¶³å¤Ÿæƒ…å†µä¸‹åƒåœ¾å›æ”¶å™¨å°±ä¸ä¼šå›æ”¶å®ƒï¼Œå¦‚æœå†…å­˜ç©ºé—´ä¸å¤Ÿäº†å°±ä¼šå¯¹è¿™äº›åªæœ‰è½¯å¼•ç”¨çš„å¯¹è±¡è¿›è¡Œå›æ”¶ã€‚åªè¦åƒåœ¾å›æ”¶å™¨æ²¡æœ‰å›æ”¶ï¼Œè¯¥è½¯å¼•ç”¨å¯¹è±¡å°±å¯ä»¥ç»§ç»­è¢«ç¨‹åºä½¿ç”¨ã€‚</p>\n<p>æ‰€ä»¥è½¯å¼•ç”¨ä¸€èˆ¬ç”¨æ¥å®ç°ä¸€äº›å†…å­˜æ•æ„Ÿçš„ç¼“å­˜ï¼Œåªè¦å†…å­˜ç©ºé—´è¶³å¤Ÿï¼Œå¯¹è±¡å°±ä¼šä¿æŒä¸è¢«å›æ”¶æ‰ã€‚</p>\n<ul>\n<li>å¼±å¼•ç”¨ï¼ˆWeakReferenceï¼‰</li>\n</ul>\n<p>å¼±å¼•ç”¨çš„å¯¹è±¡å…·æœ‰æ›´çŸ­æš‚çš„ç”Ÿå‘½å‘¨æœŸï¼Œåœ¨åƒåœ¾å›æ”¶å™¨çº¿ç¨‹æ‰«æå®ƒæ‰€ç®¡è¾–çš„å†…å­˜åŒºåŸŸçš„è¿‡ç¨‹ä¸­ï¼Œä¸€æ—¦å‘ç°äº†åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ï¼Œä¸ç®¡å½“å‰å†…å­˜ç©ºé—´è¶³å¤Ÿä¸å¦ï¼Œéƒ½ä¼šå›æ”¶å®ƒçš„å†…å­˜ã€‚ä¸è¿‡ï¼Œç”±äºåƒåœ¾å›æ”¶å™¨æ˜¯ä¸€ä¸ªä¼˜å…ˆçº§å¾ˆä½çš„çº¿ç¨‹ï¼Œå› æ­¤ä¸ä¸€å®šä¼šå¾ˆå¿«å‘ç°é‚£äº›åªå…·æœ‰å¼±å¼•ç”¨çš„å¯¹è±¡ã€‚</p>\n<p>å¼±å¼•ç”¨å¯ä»¥ç”¨æ¥å®ç°ä¸€äº›è§„èŒƒåŒ–æ˜ å°„ï¼Œå¦‚WeakHashMapï¼Œå½“keyæˆ–è€…valueä¸å†è¢«å¼•ç”¨æ—¶å¯ä»¥è‡ªåŠ¨è¢«å›æ”¶ã€‚</p>\n<ul>\n<li>è™šå¼•ç”¨ï¼ˆPhantomReferenceï¼‰</li>\n</ul>\n<p>è™šå¼•ç”¨é¡¾åæ€ä¹‰å°±æ˜¯å½¢åŒè™šè®¾ï¼Œè™šå¼•ç”¨å¹¶ä¸å†³å®šå¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡ä»…æŒæœ‰è™šå¼•ç”¨ï¼Œé‚£ä¹ˆå®ƒå°±å’Œæ²¡æœ‰ä»»ä½•å¼•ç”¨ä¸€æ ·ï¼Œåœ¨ä»»ä½•æ—¶å€™éƒ½å¯èƒ½è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶ã€‚</p>\n<p>è™šå¼•ç”¨ä¸»è¦ç”¨æ¥è·Ÿè¸ªå¯¹è±¡è¢«åƒåœ¾å›æ”¶å™¨å›æ”¶çš„æ´»åŠ¨ï¼Œè™šå¼•ç”¨å¿…é¡»å’Œå¼•ç”¨é˜Ÿåˆ—ï¼ˆReferenceQueueï¼‰è”åˆä½¿ç”¨ï¼Œå½“åƒåœ¾å›æ”¶å™¨å‡†å¤‡å›æ”¶ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œå¦‚æœå‘ç°å®ƒè¿˜æœ‰è™šå¼•ç”¨ï¼Œå°±ä¼šåœ¨å›æ”¶å¯¹è±¡çš„å†…å­˜ä¹‹å‰ï¼ŒæŠŠè¿™ä¸ªè™šå¼•ç”¨åŠ å…¥åˆ°ä¸ä¹‹å…³è”çš„å¼•ç”¨é˜Ÿåˆ—ä¸­ã€‚</p>\n<p><strong>ä¸‹é¢é€šè¿‡ä¸€å¼ è¡¨æ ¼æ¥è¯´æ˜å®ƒä»¬çš„å›æ”¶æ—¶é—´ã€ç”¨é€”ã€‚</strong></p>\n<table>\n<thead>\n<tr>\n<th>å¼•ç”¨ç±»å‹</th>\n<th>å›æ”¶æ—¶é—´</th>\n<th>ç”¨é€”</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>å¼ºå¼•ç”¨</td>\n<td>æ°¸ä¸å›æ”¶</td>\n<td>æ™®é€šå¯¹è±¡å¼•ç”¨</td>\n</tr>\n<tr>\n<td>è½¯å¼•ç”¨</td>\n<td>å†…åœ¨ä¸è¶³å›æ”¶</td>\n<td>ç¼“å­˜å¯¹è±¡</td>\n</tr>\n<tr>\n<td>å¼±å¼•ç”¨</td>\n<td>åƒåœ¾å›æ”¶æ—¶</td>\n<td>ç¼“å­˜å¯¹è±¡</td>\n</tr>\n<tr>\n<td>è™šå¼•ç”¨</td>\n<td>ä¸ç¡®å®š</td>\n<td>ä¸ç¡®å®š</td>\n</tr>\n</tbody></table>\n<p>ä¸ç®¡è¿™äº›ä¸œè¥¿å¹³æ—¶æœ‰æ²¡æœ‰ç”¨åˆ°ï¼Œæˆ‘ä»¬éƒ½å¿…é¡»äº†è§£è¿™äº›æœºåˆ¶ï¼Œè¿™å¯¹ä¸ªäººçš„çŸ¥è¯†é¢åŠæ‹“å±•æ˜¯éå¸¸æœ‰å¸®åŠ©çš„ã€‚</p>\n"},{"title":"Java å¼‚å¸¸å¤„ç† 10 ä¸ªæœ€ä½³å®è·µ","date":"2025-10-15T03:36:33.000Z","_content":"\nå¼‚å¸¸å¤„ç†æ˜¯Java å¼€å‘ä¸­çš„ä¸€ä¸ªé‡è¦éƒ¨åˆ†ã€‚å®ƒæ˜¯å…³ä¹æ¯ä¸ªåº”ç”¨çš„ä¸€ä¸ªéåŠŸèƒ½æ€§éœ€æ±‚ï¼Œæ˜¯ä¸ºäº†å¤„ç†ä»»ä½•é”™è¯¯çŠ¶å†µï¼Œæ¯”å¦‚èµ„æºä¸å¯è®¿é—®ï¼Œéæ³•è¾“å…¥ï¼Œç©ºè¾“å…¥ç­‰ç­‰ã€‚Javaæä¾›äº†å‡ ä¸ªå¼‚å¸¸å¤„ç†ç‰¹æ€§ï¼Œä»¥tryï¼Œcatch å’Œ finally å…³é”®å­—çš„å½¢å¼å†…å»ºäºè¯­è¨€è‡ªèº«ä¹‹ä¸­ã€‚Java ç¼–ç¨‹è¯­è¨€ä¹Ÿå…è®¸ä½ åˆ›å»ºæ–°çš„å¼‚å¸¸ï¼Œå¹¶é€šè¿‡ä½¿ç”¨ throw å’Œ throwså…³é”®å­—æŠ›å‡ºå®ƒä»¬ã€‚äº‹å®ä¸Šï¼Œåœ¨Javaç¼–ç¨‹ä¸­ï¼ŒJavaçš„å¼‚å¸¸å¤„ç†ä¸å•å•æ˜¯çŸ¥é“è¯­æ³•è¿™ä¹ˆç®€å•ï¼Œå®ƒå¿…é¡»éµå¾ªæ ‡å‡†çš„JDKåº“ï¼Œå’Œå‡ ä¸ªå¤„ç†é”™è¯¯å’Œå¼‚å¸¸çš„å¼€æºä»£ç ã€‚è¿™é‡Œæˆ‘ä»¬å°†è®¨è®ºä¸€äº›å…³äºå¼‚å¸¸å¤„ç†çš„Java æœ€ä½³å®è·µã€‚\n\n#### 1) ä¸ºå¯æ¢å¤çš„é”™è¯¯ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸ï¼Œä¸ºç¼–ç¨‹é”™è¯¯ä½¿ç”¨éæ£€æŸ¥å‹é”™è¯¯ã€‚\n\né€‰æ‹©æ£€æŸ¥å‹è¿˜æ˜¯éæ£€æŸ¥å‹å¼‚å¸¸ï¼Œå¯¹äºJavaç¼–ç¨‹äººå‘˜æ¥è¯´ï¼Œæ€»æ˜¯è®©äººæ„Ÿåˆ°å›°æƒ‘ã€‚æ£€æŸ¥å‹å¼‚å¸¸ä¿è¯ä½ å¯¹é”™è¯¯æ¡ä»¶æä¾›å¼‚å¸¸å¤„ç†ä»£ç ï¼Œè¿™æ˜¯ä¸€ç§ä»è¯­è¨€åˆ°å¼ºåˆ¶ä½ ç¼–å†™å¥å£®çš„ä»£ç çš„ä¸€ç§æ–¹å¼ï¼Œä½†åŒæ—¶ä¼šå¼•å…¥å¤§é‡æ‚ä¹±çš„ä»£ç å¹¶å¯¼è‡´å…¶ä¸å¯è¯»ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æœ‰æ›¿ä»£å“å’Œæ¢å¤ç­–ç•¥çš„è¯ï¼Œæ•æ‰å¼‚å¸¸å¹¶åšäº›ä»€ä¹ˆçœ‹èµ·æ¥ä¼¼ä¹ä¹Ÿåœ¨ç†ã€‚åœ¨Java ç¼–ç¨‹ä¸­é€‰æ‹©æ£€æŸ¥å‹å¼‚å¸¸è¿˜æ˜¯è¿è¡Œæ—¶å¼‚å¸¸ã€‚\n\n#### 2) åœ¨finallyç¨‹åºå—ä¸­å…³é—­æˆ–è€…é‡Šæ”¾èµ„æº\n\nè¿™åœ¨Javaç¼–ç¨‹ä¸­ï¼Œæ˜¯ä¸€ä¸ªå¹¿ä¸ºäººçŸ¥çš„æœ€ä½³å®è·µï¼Œåœ¨å¤„ç†ç½‘ç»œå’ŒIOç±»çš„æ—¶å€™ï¼Œç›¸å½“äºä¸€ä¸ªæ ‡å‡†ã€‚åœ¨finallyå—ä¸­å…³é—­èµ„æºï¼Œ åœ¨æ­£å¸¸å’Œå¼‚å¸¸æ‰§è¡Œçš„æƒ…å†µä¸‹ï¼Œä¿è¯ä¹‹å‰å’Œç¨€ç¼ºèµ„æºçš„åˆç†é‡Šæ”¾ï¼Œè¿™ç”±finallyå—ä¿è¯ã€‚ä»Java7å¼€å§‹ï¼Œè¯¥è¯­è¨€æœ‰äº†ä¸€é¡¹æ›´æœ‰è¶£çš„åŠŸèƒ½ï¼šèµ„æºç®¡ç†è‡ªåŠ¨åŒ–æˆ–è€…ARMå—èƒ½å®ç°è¿™ä¸€åŠŸèƒ½ã€‚å°½ç®¡å¦‚æ­¤ï¼Œæˆ‘ä»¬ä»ç„¶è¦è®°ä½åœ¨finallyå—ä¸­å…³é—­èµ„æºï¼Œè¿™æ˜¯å¯¹äºé‡Šæ”¾åƒFileDescriptorsè¿™ç±»ï¼Œåº”ç”¨åœ¨socketå’Œæ–‡ä»¶ç¼–ç¨‹çš„æƒ…å†µä¸‹çš„æœ‰é™èµ„æºå¾ˆé‡è¦çš„ã€‚\n\n\n\n#### 3) åœ¨å †æ ˆè·Ÿè¸ªä¸­åŒ…å«å¼•èµ·å¼‚å¸¸çš„åŸå› \n\nå¾ˆå¤šæ—¶å€™ï¼Œå½“ä¸€ä¸ªç”±å¦ä¸€ä¸ªå¼‚å¸¸å¯¼è‡´çš„å¼‚å¸¸è¢«æŠ›å‡ºçš„æ—¶å€™ï¼ŒJavaåº“å’Œå¼€æ”¾æºä»£ç ä¼šå°†ä¸€ç§å¼‚å¸¸åŒ…è£…æˆå¦ä¸€ç§å¼‚å¸¸ã€‚æ—¥å¿—è®°å½•å’Œæ‰“å°æ ¹å¼‚å¸¸å°±å˜å¾—éå¸¸é‡è¦ã€‚ Javaå¼‚å¸¸ç±»æä¾›äº† getCause()æ–¹æ³•æ¥æ£€ç´¢å¯¼è‡´å¼‚å¸¸çš„åŸå› ï¼Œè¿™äº›(åŸå› )å¯ä»¥å¯¹å¼‚å¸¸çš„æ ¹å±‚æ¬¡çš„åŸå› æä¾›æ›´å¤šçš„ä¿¡æ¯ã€‚è¯¥Javaå®è·µå¯¹åœ¨è¿›è¡Œè°ƒè¯•æˆ–æ’é™¤æ•…éšœå¤§æœ‰å¸®åŠ©ã€‚æ—¶åˆ»è®°ä½ï¼Œå¦‚æœä½ å°†ä¸€ä¸ªå¼‚å¸¸åŒ…è£…æˆå¦ä¸€ç§å¼‚å¸¸æ—¶ï¼Œæ„é€ ä¸€ä¸ªæ–°å¼‚å¸¸è¦ä¼ é€’æºå¼‚å¸¸ã€‚\n\n#### 4) å§‹ç»ˆæä¾›å…³äºå¼‚å¸¸çš„æœ‰æ„ä¹‰çš„å®Œæ•´çš„ä¿¡æ¯\n\nå¼‚å¸¸ä¿¡æ¯æ˜¯æœ€é‡è¦çš„åœ°æ–¹ï¼Œå› ä¸ºè¿™æ˜¯ç¨‹åºå‘˜é¦–å…ˆçœ‹åˆ°çš„ç¬¬ä¸€ä¸ªåœ°æ–¹ï¼Œè¿™é‡Œä½ èƒ½æ‰¾åˆ°é—®é¢˜äº§ç”Ÿçš„æ ¹æœ¬åŸå› ã€‚è¿™é‡Œå§‹ç»ˆæä¾›ç²¾ç¡®çš„çœŸå®çš„ä¿¡æ¯ã€‚\n\n#### 5) é¿å…è¿‡åº¦ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸\n\næ£€æŸ¥å‹å¼‚å¸¸åœ¨å¼ºåˆ¶æ‰§è¡Œæ–¹é¢æœ‰ä¸€å®šçš„ä¼˜åŠ¿ï¼Œä½†åŒæ—¶å®ƒä¹Ÿç ´åäº†ä»£ç ï¼Œé€šè¿‡æ©ç›–ä¸šåŠ¡é€»è¾‘ä½¿ä»£ç å¯è¯»æ€§é™ä½ã€‚åªè¦ä½ ä¸è¿‡åº¦ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸ï¼Œä½ å¯ä»¥æœ€å¤§é™åº¦çš„å‡å°‘è¿™ç±»æƒ…å†µï¼Œè¿™æ ·åšçš„ç»“æœæ˜¯ä½ ä¼šå¾—åˆ°æ›´æ¸…æ´çš„ä»£ç ã€‚ä½ åŒæ ·å¯ä»¥ä½¿ç”¨Java7çš„æ–°åŠŸèƒ½ï¼Œä»¥ç§»é™¤é‡å¤é¡¹ã€‚\n\n#### 6) å°†æ£€æŸ¥å‹å¼‚å¸¸è½¬ä¸ºè¿è¡Œæ—¶å¼‚å¸¸\n\nè¿™æ˜¯åœ¨åƒSpringä¹‹ç±»çš„å¤šæ•°æ¡†æ¶ä¸­ç”¨æ¥é™åˆ¶ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸çš„æŠ€æœ¯ä¹‹ä¸€ï¼Œå¤§éƒ¨åˆ†å‡ºè‡ªäºJDBCçš„æ£€æŸ¥å‹å¼‚å¸¸ï¼Œéƒ½è¢«åŒ…è£…è¿› DataAccessExceptionä¸­ï¼Œè€Œ(DataAccessException)å¼‚å¸¸æ˜¯ä¸€ç§éæ£€æŸ¥å‹å¼‚å¸¸ã€‚è¿™æ˜¯Javaæœ€ä½³å®è·µå¸¦æ¥çš„å¥½å¤„ï¼Œç‰¹å®šçš„å¼‚å¸¸é™åˆ¶åˆ°ç‰¹å®šçš„æ¨¡å—ï¼Œåƒ SQLException æ”¾åˆ°DAOå±‚ï¼Œå°†æ„æ€æ˜ç¡®çš„è¿è¡Œæ—¶å¼‚å¸¸æŠ›åˆ°å®¢æˆ·å±‚ã€‚\n\n#### 7) è®°ä½å¯¹æ€§èƒ½è€Œè¨€ï¼Œå¼‚å¸¸ä»£ä»·é«˜æ˜‚\n\néœ€è¦è®°ä½çš„ä¸€ä»¶äº‹æ˜¯å¼‚å¸¸ä»£ä»·é«˜æ˜‚ï¼ŒåŒæ—¶è®©ä½ çš„ä»£ç è¿è¡Œç¼“æ…¢ã€‚å‡å¦‚ä½ æœ‰æ–¹æ³•ä»ResultSet(ç»“æœé›†)ä¸­è¿›è¡Œè¯»å–ï¼Œè¿™æ—¶å¸¸ä¼šæŠ›å‡ºSQLException å¼‚å¸¸è€Œä¸ä¼šç§»åˆ°ä¸‹ä¸€å…ƒç´ ï¼Œè¿™å°†ä¼šæ¯”ä¸æŠ›å‡ºå¼‚å¸¸çš„æ­£å¸¸ä»£ç æ‰§è¡Œçš„æ…¢çš„å¤šã€‚å› æ­¤æœ€å¤§é™åº¦çš„å‡å°‘ä¸å¿…è¦çš„å¼‚å¸¸æ•æ‰å’Œç§»åŠ¨ï¼Œé‚£é‡Œæ²¡æœ‰ä»€ä¹ˆå›ºå®šçš„åŸå› ã€‚ä¸è¦ä»…ä»…æ˜¯æŠ›å‡ºå’Œæ•æ‰å¼‚å¸¸ï¼Œå¦‚æœä½ èƒ½ä½¿ç”¨booleanå˜é‡å»è¡¨ç¤ºæ‰§è¡Œç»“æœï¼Œå¯èƒ½ä¼šå¾—åˆ°æ›´æ•´æ´ï¼Œæ›´é«˜æ€§èƒ½çš„è§£å†³æ–¹æ¡ˆã€‚ä¿®æ­£é”™è¯¯çš„æ ¹æºï¼Œé¿å…ä¸å¿…é¡»è¦çš„å¼‚å¸¸æ•æ‰ã€‚\n\n#### 8) é¿å…catchå—ä¸ºç©º\n\næ²¡æœ‰ä»€ä¹ˆæ¯”ç©ºçš„catchå—æ›´ç³Ÿç³•çš„äº†ï¼Œå› ä¸ºå®ƒä¸ä»…éšè—äº†é”™è¯¯å’Œå¼‚å¸¸ï¼ŒåŒæ—¶å¯èƒ½å¯¼è‡´ä½ çš„å¯¹è±¡å¤„äºä¸å¯ä½¿ç”¨æˆ–è€…è„çš„çŠ¶æ€ã€‚ç©ºçš„catchå—åªèƒ½å˜å¾—æ— æ„ä¹‰ï¼Œå¦‚æœä½ éå¸¸è‚¯å®šå¼‚å¸¸ä¸ä¼šç»§ç»­ä»¥ä»»ä½•æ–¹å¼å½±å“å¯¹è±¡çŠ¶æ€ï¼Œä½†åœ¨ç¨‹åºæ‰§è¡ŒæœŸé—´ï¼Œç”¨æ—¥å¿—è®°å½•é”™è¯¯ä¾ç„¶æ˜¯æœ€å¥½çš„(æ–¹æ³•)ã€‚å¯¹äºåœ¨Javaç¼–ç¨‹ä¸­ç¼–å†™å¼‚å¸¸å¤„ç†ä»£ç ï¼Œè¿™ä¸ä»…ä»…æ˜¯ä¸€ä¸ªJavaæœ€ä½³å®è·µï¼Œè€Œæ˜¯ä¸€ä¸ªæœ€é€šç”¨çš„å®è·µã€‚\n\n#### 9) ä½¿ç”¨æ ‡å‡†å¼‚å¸¸\n\næˆ‘ä»¬çš„ç¬¬ä¹æ¡æœ€ä½³å®è·µå»ºè®®ä½¿ç”¨æ ‡å‡†å’Œå†…ç½®çš„Javaå¼‚å¸¸ã€‚ä½¿ç”¨æ ‡å‡†å¼‚å¸¸è€Œä¸æ˜¯æ¯æ¬¡åˆ›å»ºæˆ‘ä»¬è‡ªå·±çš„å¼‚å¸¸ï¼Œå¯¹äºç»´æŠ¤æ€§å’Œä¸€è‡´æ€§ï¼Œä¸ç®¡æ˜¯ç°åœ¨è¿˜æ˜¯ä»¥åï¼Œéƒ½æ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚é‡ç”¨æ ‡å‡†å¼‚å¸¸ä½¿ä»£ç æ›´å…·å¯è¯»æ€§ï¼Œå› ä¸ºå¤§éƒ¨åˆ†Javaå¼€å‘äººå‘˜å¯¹æ ‡å‡†çš„åƒæºè‡ªäºJDKçš„RuntimeException å¼‚å¸¸ï¼ŒIllegalStateException å¼‚å¸¸ï¼ŒIllegal Argument Exception å¼‚å¸¸æˆ–è€…NullPointerExceptionå¼‚å¸¸ï¼Œ(å¼€å‘è€…)ä»–ä»¬èƒ½ä¸€çœ¼å°±çŸ¥é“æ¯ç§å¼‚å¸¸çš„ç›®çš„ï¼Œè€Œä¸æ˜¯åœ¨ä»£ç é‡ŒæŸ¥æ‰¾æˆ–è€…åœ¨æ–‡æ¡£é‡ŒæŸ¥æ‰¾ç”¨æˆ·å®šä¹‰çš„å¼‚å¸¸çš„ç›®çš„ã€‚\n\n#### 10) è®°å½•ä»»ä½•æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸\n\nJavaæä¾›äº†throwå’Œthrowså…³é”®å­—æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œåœ¨javadocä¸­ç”¨@throwè®°å½•ä»»ä½•æ–¹æ³•å¯èƒ½ä¼šæŠ›å‡ºçš„å¼‚å¸¸ã€‚å¦‚æœä½ ç¼–å†™APIæˆ–è€…å…¬å…±æ¥å£ï¼Œè¿™å°±å˜å¾—éå¸¸é‡è¦ã€‚ä»»ä½•æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸éƒ½æœ‰ç›¸åº”çš„æ–‡æ¡£è®°å½•ï¼Œè¿™æ ·ä½ å°±èƒ½ä¸‹æ„è¯†çš„æé†’ä»»ä½•ä½¿ç”¨(è¯¥æ–¹æ³•)çš„äººã€‚\n\nè¿™äº›å°±æ˜¯æ‰€æœ‰åœ¨Javaç¼–ç¨‹ä¸­åœ¨å¤„ç†å¼‚å¸¸çš„æ—¶å€™éœ€è¦éµå¾ªçš„æœ€ä½³å®è·µã€‚è®©æˆ‘ä»¬çŸ¥é“äº†ä»€ä¹ˆæ˜¯åœ¨Javaç¼–ç¨‹ä¸­ç¼–å†™å¼‚å¸¸å¤„ç†ä»£ç æ—¶éœ€è¦éµå¾ªçš„å®è·µã€‚\n\nåŸæ–‡ï¼šhttps://www.oschina.net/translate/10-exception-handling-best-practices-in-java-programming\n\n","source":"_posts/è¿›é˜¶/Java å¼‚å¸¸å¤„ç† 10 ä¸ªæœ€ä½³å®è·µ.md","raw":"---\ntitle: Java å¼‚å¸¸å¤„ç† 10 ä¸ªæœ€ä½³å®è·µ\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: è¿›é˜¶\n---\n\nå¼‚å¸¸å¤„ç†æ˜¯Java å¼€å‘ä¸­çš„ä¸€ä¸ªé‡è¦éƒ¨åˆ†ã€‚å®ƒæ˜¯å…³ä¹æ¯ä¸ªåº”ç”¨çš„ä¸€ä¸ªéåŠŸèƒ½æ€§éœ€æ±‚ï¼Œæ˜¯ä¸ºäº†å¤„ç†ä»»ä½•é”™è¯¯çŠ¶å†µï¼Œæ¯”å¦‚èµ„æºä¸å¯è®¿é—®ï¼Œéæ³•è¾“å…¥ï¼Œç©ºè¾“å…¥ç­‰ç­‰ã€‚Javaæä¾›äº†å‡ ä¸ªå¼‚å¸¸å¤„ç†ç‰¹æ€§ï¼Œä»¥tryï¼Œcatch å’Œ finally å…³é”®å­—çš„å½¢å¼å†…å»ºäºè¯­è¨€è‡ªèº«ä¹‹ä¸­ã€‚Java ç¼–ç¨‹è¯­è¨€ä¹Ÿå…è®¸ä½ åˆ›å»ºæ–°çš„å¼‚å¸¸ï¼Œå¹¶é€šè¿‡ä½¿ç”¨ throw å’Œ throwså…³é”®å­—æŠ›å‡ºå®ƒä»¬ã€‚äº‹å®ä¸Šï¼Œåœ¨Javaç¼–ç¨‹ä¸­ï¼ŒJavaçš„å¼‚å¸¸å¤„ç†ä¸å•å•æ˜¯çŸ¥é“è¯­æ³•è¿™ä¹ˆç®€å•ï¼Œå®ƒå¿…é¡»éµå¾ªæ ‡å‡†çš„JDKåº“ï¼Œå’Œå‡ ä¸ªå¤„ç†é”™è¯¯å’Œå¼‚å¸¸çš„å¼€æºä»£ç ã€‚è¿™é‡Œæˆ‘ä»¬å°†è®¨è®ºä¸€äº›å…³äºå¼‚å¸¸å¤„ç†çš„Java æœ€ä½³å®è·µã€‚\n\n#### 1) ä¸ºå¯æ¢å¤çš„é”™è¯¯ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸ï¼Œä¸ºç¼–ç¨‹é”™è¯¯ä½¿ç”¨éæ£€æŸ¥å‹é”™è¯¯ã€‚\n\né€‰æ‹©æ£€æŸ¥å‹è¿˜æ˜¯éæ£€æŸ¥å‹å¼‚å¸¸ï¼Œå¯¹äºJavaç¼–ç¨‹äººå‘˜æ¥è¯´ï¼Œæ€»æ˜¯è®©äººæ„Ÿåˆ°å›°æƒ‘ã€‚æ£€æŸ¥å‹å¼‚å¸¸ä¿è¯ä½ å¯¹é”™è¯¯æ¡ä»¶æä¾›å¼‚å¸¸å¤„ç†ä»£ç ï¼Œè¿™æ˜¯ä¸€ç§ä»è¯­è¨€åˆ°å¼ºåˆ¶ä½ ç¼–å†™å¥å£®çš„ä»£ç çš„ä¸€ç§æ–¹å¼ï¼Œä½†åŒæ—¶ä¼šå¼•å…¥å¤§é‡æ‚ä¹±çš„ä»£ç å¹¶å¯¼è‡´å…¶ä¸å¯è¯»ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æœ‰æ›¿ä»£å“å’Œæ¢å¤ç­–ç•¥çš„è¯ï¼Œæ•æ‰å¼‚å¸¸å¹¶åšäº›ä»€ä¹ˆçœ‹èµ·æ¥ä¼¼ä¹ä¹Ÿåœ¨ç†ã€‚åœ¨Java ç¼–ç¨‹ä¸­é€‰æ‹©æ£€æŸ¥å‹å¼‚å¸¸è¿˜æ˜¯è¿è¡Œæ—¶å¼‚å¸¸ã€‚\n\n#### 2) åœ¨finallyç¨‹åºå—ä¸­å…³é—­æˆ–è€…é‡Šæ”¾èµ„æº\n\nè¿™åœ¨Javaç¼–ç¨‹ä¸­ï¼Œæ˜¯ä¸€ä¸ªå¹¿ä¸ºäººçŸ¥çš„æœ€ä½³å®è·µï¼Œåœ¨å¤„ç†ç½‘ç»œå’ŒIOç±»çš„æ—¶å€™ï¼Œç›¸å½“äºä¸€ä¸ªæ ‡å‡†ã€‚åœ¨finallyå—ä¸­å…³é—­èµ„æºï¼Œ åœ¨æ­£å¸¸å’Œå¼‚å¸¸æ‰§è¡Œçš„æƒ…å†µä¸‹ï¼Œä¿è¯ä¹‹å‰å’Œç¨€ç¼ºèµ„æºçš„åˆç†é‡Šæ”¾ï¼Œè¿™ç”±finallyå—ä¿è¯ã€‚ä»Java7å¼€å§‹ï¼Œè¯¥è¯­è¨€æœ‰äº†ä¸€é¡¹æ›´æœ‰è¶£çš„åŠŸèƒ½ï¼šèµ„æºç®¡ç†è‡ªåŠ¨åŒ–æˆ–è€…ARMå—èƒ½å®ç°è¿™ä¸€åŠŸèƒ½ã€‚å°½ç®¡å¦‚æ­¤ï¼Œæˆ‘ä»¬ä»ç„¶è¦è®°ä½åœ¨finallyå—ä¸­å…³é—­èµ„æºï¼Œè¿™æ˜¯å¯¹äºé‡Šæ”¾åƒFileDescriptorsè¿™ç±»ï¼Œåº”ç”¨åœ¨socketå’Œæ–‡ä»¶ç¼–ç¨‹çš„æƒ…å†µä¸‹çš„æœ‰é™èµ„æºå¾ˆé‡è¦çš„ã€‚\n\n\n\n#### 3) åœ¨å †æ ˆè·Ÿè¸ªä¸­åŒ…å«å¼•èµ·å¼‚å¸¸çš„åŸå› \n\nå¾ˆå¤šæ—¶å€™ï¼Œå½“ä¸€ä¸ªç”±å¦ä¸€ä¸ªå¼‚å¸¸å¯¼è‡´çš„å¼‚å¸¸è¢«æŠ›å‡ºçš„æ—¶å€™ï¼ŒJavaåº“å’Œå¼€æ”¾æºä»£ç ä¼šå°†ä¸€ç§å¼‚å¸¸åŒ…è£…æˆå¦ä¸€ç§å¼‚å¸¸ã€‚æ—¥å¿—è®°å½•å’Œæ‰“å°æ ¹å¼‚å¸¸å°±å˜å¾—éå¸¸é‡è¦ã€‚ Javaå¼‚å¸¸ç±»æä¾›äº† getCause()æ–¹æ³•æ¥æ£€ç´¢å¯¼è‡´å¼‚å¸¸çš„åŸå› ï¼Œè¿™äº›(åŸå› )å¯ä»¥å¯¹å¼‚å¸¸çš„æ ¹å±‚æ¬¡çš„åŸå› æä¾›æ›´å¤šçš„ä¿¡æ¯ã€‚è¯¥Javaå®è·µå¯¹åœ¨è¿›è¡Œè°ƒè¯•æˆ–æ’é™¤æ•…éšœå¤§æœ‰å¸®åŠ©ã€‚æ—¶åˆ»è®°ä½ï¼Œå¦‚æœä½ å°†ä¸€ä¸ªå¼‚å¸¸åŒ…è£…æˆå¦ä¸€ç§å¼‚å¸¸æ—¶ï¼Œæ„é€ ä¸€ä¸ªæ–°å¼‚å¸¸è¦ä¼ é€’æºå¼‚å¸¸ã€‚\n\n#### 4) å§‹ç»ˆæä¾›å…³äºå¼‚å¸¸çš„æœ‰æ„ä¹‰çš„å®Œæ•´çš„ä¿¡æ¯\n\nå¼‚å¸¸ä¿¡æ¯æ˜¯æœ€é‡è¦çš„åœ°æ–¹ï¼Œå› ä¸ºè¿™æ˜¯ç¨‹åºå‘˜é¦–å…ˆçœ‹åˆ°çš„ç¬¬ä¸€ä¸ªåœ°æ–¹ï¼Œè¿™é‡Œä½ èƒ½æ‰¾åˆ°é—®é¢˜äº§ç”Ÿçš„æ ¹æœ¬åŸå› ã€‚è¿™é‡Œå§‹ç»ˆæä¾›ç²¾ç¡®çš„çœŸå®çš„ä¿¡æ¯ã€‚\n\n#### 5) é¿å…è¿‡åº¦ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸\n\næ£€æŸ¥å‹å¼‚å¸¸åœ¨å¼ºåˆ¶æ‰§è¡Œæ–¹é¢æœ‰ä¸€å®šçš„ä¼˜åŠ¿ï¼Œä½†åŒæ—¶å®ƒä¹Ÿç ´åäº†ä»£ç ï¼Œé€šè¿‡æ©ç›–ä¸šåŠ¡é€»è¾‘ä½¿ä»£ç å¯è¯»æ€§é™ä½ã€‚åªè¦ä½ ä¸è¿‡åº¦ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸ï¼Œä½ å¯ä»¥æœ€å¤§é™åº¦çš„å‡å°‘è¿™ç±»æƒ…å†µï¼Œè¿™æ ·åšçš„ç»“æœæ˜¯ä½ ä¼šå¾—åˆ°æ›´æ¸…æ´çš„ä»£ç ã€‚ä½ åŒæ ·å¯ä»¥ä½¿ç”¨Java7çš„æ–°åŠŸèƒ½ï¼Œä»¥ç§»é™¤é‡å¤é¡¹ã€‚\n\n#### 6) å°†æ£€æŸ¥å‹å¼‚å¸¸è½¬ä¸ºè¿è¡Œæ—¶å¼‚å¸¸\n\nè¿™æ˜¯åœ¨åƒSpringä¹‹ç±»çš„å¤šæ•°æ¡†æ¶ä¸­ç”¨æ¥é™åˆ¶ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸çš„æŠ€æœ¯ä¹‹ä¸€ï¼Œå¤§éƒ¨åˆ†å‡ºè‡ªäºJDBCçš„æ£€æŸ¥å‹å¼‚å¸¸ï¼Œéƒ½è¢«åŒ…è£…è¿› DataAccessExceptionä¸­ï¼Œè€Œ(DataAccessException)å¼‚å¸¸æ˜¯ä¸€ç§éæ£€æŸ¥å‹å¼‚å¸¸ã€‚è¿™æ˜¯Javaæœ€ä½³å®è·µå¸¦æ¥çš„å¥½å¤„ï¼Œç‰¹å®šçš„å¼‚å¸¸é™åˆ¶åˆ°ç‰¹å®šçš„æ¨¡å—ï¼Œåƒ SQLException æ”¾åˆ°DAOå±‚ï¼Œå°†æ„æ€æ˜ç¡®çš„è¿è¡Œæ—¶å¼‚å¸¸æŠ›åˆ°å®¢æˆ·å±‚ã€‚\n\n#### 7) è®°ä½å¯¹æ€§èƒ½è€Œè¨€ï¼Œå¼‚å¸¸ä»£ä»·é«˜æ˜‚\n\néœ€è¦è®°ä½çš„ä¸€ä»¶äº‹æ˜¯å¼‚å¸¸ä»£ä»·é«˜æ˜‚ï¼ŒåŒæ—¶è®©ä½ çš„ä»£ç è¿è¡Œç¼“æ…¢ã€‚å‡å¦‚ä½ æœ‰æ–¹æ³•ä»ResultSet(ç»“æœé›†)ä¸­è¿›è¡Œè¯»å–ï¼Œè¿™æ—¶å¸¸ä¼šæŠ›å‡ºSQLException å¼‚å¸¸è€Œä¸ä¼šç§»åˆ°ä¸‹ä¸€å…ƒç´ ï¼Œè¿™å°†ä¼šæ¯”ä¸æŠ›å‡ºå¼‚å¸¸çš„æ­£å¸¸ä»£ç æ‰§è¡Œçš„æ…¢çš„å¤šã€‚å› æ­¤æœ€å¤§é™åº¦çš„å‡å°‘ä¸å¿…è¦çš„å¼‚å¸¸æ•æ‰å’Œç§»åŠ¨ï¼Œé‚£é‡Œæ²¡æœ‰ä»€ä¹ˆå›ºå®šçš„åŸå› ã€‚ä¸è¦ä»…ä»…æ˜¯æŠ›å‡ºå’Œæ•æ‰å¼‚å¸¸ï¼Œå¦‚æœä½ èƒ½ä½¿ç”¨booleanå˜é‡å»è¡¨ç¤ºæ‰§è¡Œç»“æœï¼Œå¯èƒ½ä¼šå¾—åˆ°æ›´æ•´æ´ï¼Œæ›´é«˜æ€§èƒ½çš„è§£å†³æ–¹æ¡ˆã€‚ä¿®æ­£é”™è¯¯çš„æ ¹æºï¼Œé¿å…ä¸å¿…é¡»è¦çš„å¼‚å¸¸æ•æ‰ã€‚\n\n#### 8) é¿å…catchå—ä¸ºç©º\n\næ²¡æœ‰ä»€ä¹ˆæ¯”ç©ºçš„catchå—æ›´ç³Ÿç³•çš„äº†ï¼Œå› ä¸ºå®ƒä¸ä»…éšè—äº†é”™è¯¯å’Œå¼‚å¸¸ï¼ŒåŒæ—¶å¯èƒ½å¯¼è‡´ä½ çš„å¯¹è±¡å¤„äºä¸å¯ä½¿ç”¨æˆ–è€…è„çš„çŠ¶æ€ã€‚ç©ºçš„catchå—åªèƒ½å˜å¾—æ— æ„ä¹‰ï¼Œå¦‚æœä½ éå¸¸è‚¯å®šå¼‚å¸¸ä¸ä¼šç»§ç»­ä»¥ä»»ä½•æ–¹å¼å½±å“å¯¹è±¡çŠ¶æ€ï¼Œä½†åœ¨ç¨‹åºæ‰§è¡ŒæœŸé—´ï¼Œç”¨æ—¥å¿—è®°å½•é”™è¯¯ä¾ç„¶æ˜¯æœ€å¥½çš„(æ–¹æ³•)ã€‚å¯¹äºåœ¨Javaç¼–ç¨‹ä¸­ç¼–å†™å¼‚å¸¸å¤„ç†ä»£ç ï¼Œè¿™ä¸ä»…ä»…æ˜¯ä¸€ä¸ªJavaæœ€ä½³å®è·µï¼Œè€Œæ˜¯ä¸€ä¸ªæœ€é€šç”¨çš„å®è·µã€‚\n\n#### 9) ä½¿ç”¨æ ‡å‡†å¼‚å¸¸\n\næˆ‘ä»¬çš„ç¬¬ä¹æ¡æœ€ä½³å®è·µå»ºè®®ä½¿ç”¨æ ‡å‡†å’Œå†…ç½®çš„Javaå¼‚å¸¸ã€‚ä½¿ç”¨æ ‡å‡†å¼‚å¸¸è€Œä¸æ˜¯æ¯æ¬¡åˆ›å»ºæˆ‘ä»¬è‡ªå·±çš„å¼‚å¸¸ï¼Œå¯¹äºç»´æŠ¤æ€§å’Œä¸€è‡´æ€§ï¼Œä¸ç®¡æ˜¯ç°åœ¨è¿˜æ˜¯ä»¥åï¼Œéƒ½æ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚é‡ç”¨æ ‡å‡†å¼‚å¸¸ä½¿ä»£ç æ›´å…·å¯è¯»æ€§ï¼Œå› ä¸ºå¤§éƒ¨åˆ†Javaå¼€å‘äººå‘˜å¯¹æ ‡å‡†çš„åƒæºè‡ªäºJDKçš„RuntimeException å¼‚å¸¸ï¼ŒIllegalStateException å¼‚å¸¸ï¼ŒIllegal Argument Exception å¼‚å¸¸æˆ–è€…NullPointerExceptionå¼‚å¸¸ï¼Œ(å¼€å‘è€…)ä»–ä»¬èƒ½ä¸€çœ¼å°±çŸ¥é“æ¯ç§å¼‚å¸¸çš„ç›®çš„ï¼Œè€Œä¸æ˜¯åœ¨ä»£ç é‡ŒæŸ¥æ‰¾æˆ–è€…åœ¨æ–‡æ¡£é‡ŒæŸ¥æ‰¾ç”¨æˆ·å®šä¹‰çš„å¼‚å¸¸çš„ç›®çš„ã€‚\n\n#### 10) è®°å½•ä»»ä½•æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸\n\nJavaæä¾›äº†throwå’Œthrowså…³é”®å­—æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œåœ¨javadocä¸­ç”¨@throwè®°å½•ä»»ä½•æ–¹æ³•å¯èƒ½ä¼šæŠ›å‡ºçš„å¼‚å¸¸ã€‚å¦‚æœä½ ç¼–å†™APIæˆ–è€…å…¬å…±æ¥å£ï¼Œè¿™å°±å˜å¾—éå¸¸é‡è¦ã€‚ä»»ä½•æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸éƒ½æœ‰ç›¸åº”çš„æ–‡æ¡£è®°å½•ï¼Œè¿™æ ·ä½ å°±èƒ½ä¸‹æ„è¯†çš„æé†’ä»»ä½•ä½¿ç”¨(è¯¥æ–¹æ³•)çš„äººã€‚\n\nè¿™äº›å°±æ˜¯æ‰€æœ‰åœ¨Javaç¼–ç¨‹ä¸­åœ¨å¤„ç†å¼‚å¸¸çš„æ—¶å€™éœ€è¦éµå¾ªçš„æœ€ä½³å®è·µã€‚è®©æˆ‘ä»¬çŸ¥é“äº†ä»€ä¹ˆæ˜¯åœ¨Javaç¼–ç¨‹ä¸­ç¼–å†™å¼‚å¸¸å¤„ç†ä»£ç æ—¶éœ€è¦éµå¾ªçš„å®è·µã€‚\n\nåŸæ–‡ï¼šhttps://www.oschina.net/translate/10-exception-handling-best-practices-in-java-programming\n\n","slug":"è¿›é˜¶/Java å¼‚å¸¸å¤„ç† 10 ä¸ªæœ€ä½³å®è·µ","published":1,"updated":"2025-10-15T07:21:14.273Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076f000oqkd4cxjcdawn","content":"<p>å¼‚å¸¸å¤„ç†æ˜¯Java å¼€å‘ä¸­çš„ä¸€ä¸ªé‡è¦éƒ¨åˆ†ã€‚å®ƒæ˜¯å…³ä¹æ¯ä¸ªåº”ç”¨çš„ä¸€ä¸ªéåŠŸèƒ½æ€§éœ€æ±‚ï¼Œæ˜¯ä¸ºäº†å¤„ç†ä»»ä½•é”™è¯¯çŠ¶å†µï¼Œæ¯”å¦‚èµ„æºä¸å¯è®¿é—®ï¼Œéæ³•è¾“å…¥ï¼Œç©ºè¾“å…¥ç­‰ç­‰ã€‚Javaæä¾›äº†å‡ ä¸ªå¼‚å¸¸å¤„ç†ç‰¹æ€§ï¼Œä»¥tryï¼Œcatch å’Œ finally å…³é”®å­—çš„å½¢å¼å†…å»ºäºè¯­è¨€è‡ªèº«ä¹‹ä¸­ã€‚Java ç¼–ç¨‹è¯­è¨€ä¹Ÿå…è®¸ä½ åˆ›å»ºæ–°çš„å¼‚å¸¸ï¼Œå¹¶é€šè¿‡ä½¿ç”¨ throw å’Œ throwså…³é”®å­—æŠ›å‡ºå®ƒä»¬ã€‚äº‹å®ä¸Šï¼Œåœ¨Javaç¼–ç¨‹ä¸­ï¼ŒJavaçš„å¼‚å¸¸å¤„ç†ä¸å•å•æ˜¯çŸ¥é“è¯­æ³•è¿™ä¹ˆç®€å•ï¼Œå®ƒå¿…é¡»éµå¾ªæ ‡å‡†çš„JDKåº“ï¼Œå’Œå‡ ä¸ªå¤„ç†é”™è¯¯å’Œå¼‚å¸¸çš„å¼€æºä»£ç ã€‚è¿™é‡Œæˆ‘ä»¬å°†è®¨è®ºä¸€äº›å…³äºå¼‚å¸¸å¤„ç†çš„Java æœ€ä½³å®è·µã€‚</p>\n<h4 id=\"1-ä¸ºå¯æ¢å¤çš„é”™è¯¯ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸ï¼Œä¸ºç¼–ç¨‹é”™è¯¯ä½¿ç”¨éæ£€æŸ¥å‹é”™è¯¯ã€‚\"><a href=\"#1-ä¸ºå¯æ¢å¤çš„é”™è¯¯ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸ï¼Œä¸ºç¼–ç¨‹é”™è¯¯ä½¿ç”¨éæ£€æŸ¥å‹é”™è¯¯ã€‚\" class=\"headerlink\" title=\"1) ä¸ºå¯æ¢å¤çš„é”™è¯¯ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸ï¼Œä¸ºç¼–ç¨‹é”™è¯¯ä½¿ç”¨éæ£€æŸ¥å‹é”™è¯¯ã€‚\"></a>1) ä¸ºå¯æ¢å¤çš„é”™è¯¯ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸ï¼Œä¸ºç¼–ç¨‹é”™è¯¯ä½¿ç”¨éæ£€æŸ¥å‹é”™è¯¯ã€‚</h4><p>é€‰æ‹©æ£€æŸ¥å‹è¿˜æ˜¯éæ£€æŸ¥å‹å¼‚å¸¸ï¼Œå¯¹äºJavaç¼–ç¨‹äººå‘˜æ¥è¯´ï¼Œæ€»æ˜¯è®©äººæ„Ÿåˆ°å›°æƒ‘ã€‚æ£€æŸ¥å‹å¼‚å¸¸ä¿è¯ä½ å¯¹é”™è¯¯æ¡ä»¶æä¾›å¼‚å¸¸å¤„ç†ä»£ç ï¼Œè¿™æ˜¯ä¸€ç§ä»è¯­è¨€åˆ°å¼ºåˆ¶ä½ ç¼–å†™å¥å£®çš„ä»£ç çš„ä¸€ç§æ–¹å¼ï¼Œä½†åŒæ—¶ä¼šå¼•å…¥å¤§é‡æ‚ä¹±çš„ä»£ç å¹¶å¯¼è‡´å…¶ä¸å¯è¯»ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æœ‰æ›¿ä»£å“å’Œæ¢å¤ç­–ç•¥çš„è¯ï¼Œæ•æ‰å¼‚å¸¸å¹¶åšäº›ä»€ä¹ˆçœ‹èµ·æ¥ä¼¼ä¹ä¹Ÿåœ¨ç†ã€‚åœ¨Java ç¼–ç¨‹ä¸­é€‰æ‹©æ£€æŸ¥å‹å¼‚å¸¸è¿˜æ˜¯è¿è¡Œæ—¶å¼‚å¸¸ã€‚</p>\n<h4 id=\"2-åœ¨finallyç¨‹åºå—ä¸­å…³é—­æˆ–è€…é‡Šæ”¾èµ„æº\"><a href=\"#2-åœ¨finallyç¨‹åºå—ä¸­å…³é—­æˆ–è€…é‡Šæ”¾èµ„æº\" class=\"headerlink\" title=\"2) åœ¨finallyç¨‹åºå—ä¸­å…³é—­æˆ–è€…é‡Šæ”¾èµ„æº\"></a>2) åœ¨finallyç¨‹åºå—ä¸­å…³é—­æˆ–è€…é‡Šæ”¾èµ„æº</h4><p>è¿™åœ¨Javaç¼–ç¨‹ä¸­ï¼Œæ˜¯ä¸€ä¸ªå¹¿ä¸ºäººçŸ¥çš„æœ€ä½³å®è·µï¼Œåœ¨å¤„ç†ç½‘ç»œå’ŒIOç±»çš„æ—¶å€™ï¼Œç›¸å½“äºä¸€ä¸ªæ ‡å‡†ã€‚åœ¨finallyå—ä¸­å…³é—­èµ„æºï¼Œ åœ¨æ­£å¸¸å’Œå¼‚å¸¸æ‰§è¡Œçš„æƒ…å†µä¸‹ï¼Œä¿è¯ä¹‹å‰å’Œç¨€ç¼ºèµ„æºçš„åˆç†é‡Šæ”¾ï¼Œè¿™ç”±finallyå—ä¿è¯ã€‚ä»Java7å¼€å§‹ï¼Œè¯¥è¯­è¨€æœ‰äº†ä¸€é¡¹æ›´æœ‰è¶£çš„åŠŸèƒ½ï¼šèµ„æºç®¡ç†è‡ªåŠ¨åŒ–æˆ–è€…ARMå—èƒ½å®ç°è¿™ä¸€åŠŸèƒ½ã€‚å°½ç®¡å¦‚æ­¤ï¼Œæˆ‘ä»¬ä»ç„¶è¦è®°ä½åœ¨finallyå—ä¸­å…³é—­èµ„æºï¼Œè¿™æ˜¯å¯¹äºé‡Šæ”¾åƒFileDescriptorsè¿™ç±»ï¼Œåº”ç”¨åœ¨socketå’Œæ–‡ä»¶ç¼–ç¨‹çš„æƒ…å†µä¸‹çš„æœ‰é™èµ„æºå¾ˆé‡è¦çš„ã€‚</p>\n<h4 id=\"3-åœ¨å †æ ˆè·Ÿè¸ªä¸­åŒ…å«å¼•èµ·å¼‚å¸¸çš„åŸå› \"><a href=\"#3-åœ¨å †æ ˆè·Ÿè¸ªä¸­åŒ…å«å¼•èµ·å¼‚å¸¸çš„åŸå› \" class=\"headerlink\" title=\"3) åœ¨å †æ ˆè·Ÿè¸ªä¸­åŒ…å«å¼•èµ·å¼‚å¸¸çš„åŸå› \"></a>3) åœ¨å †æ ˆè·Ÿè¸ªä¸­åŒ…å«å¼•èµ·å¼‚å¸¸çš„åŸå› </h4><p>å¾ˆå¤šæ—¶å€™ï¼Œå½“ä¸€ä¸ªç”±å¦ä¸€ä¸ªå¼‚å¸¸å¯¼è‡´çš„å¼‚å¸¸è¢«æŠ›å‡ºçš„æ—¶å€™ï¼ŒJavaåº“å’Œå¼€æ”¾æºä»£ç ä¼šå°†ä¸€ç§å¼‚å¸¸åŒ…è£…æˆå¦ä¸€ç§å¼‚å¸¸ã€‚æ—¥å¿—è®°å½•å’Œæ‰“å°æ ¹å¼‚å¸¸å°±å˜å¾—éå¸¸é‡è¦ã€‚ Javaå¼‚å¸¸ç±»æä¾›äº† getCause()æ–¹æ³•æ¥æ£€ç´¢å¯¼è‡´å¼‚å¸¸çš„åŸå› ï¼Œè¿™äº›(åŸå› )å¯ä»¥å¯¹å¼‚å¸¸çš„æ ¹å±‚æ¬¡çš„åŸå› æä¾›æ›´å¤šçš„ä¿¡æ¯ã€‚è¯¥Javaå®è·µå¯¹åœ¨è¿›è¡Œè°ƒè¯•æˆ–æ’é™¤æ•…éšœå¤§æœ‰å¸®åŠ©ã€‚æ—¶åˆ»è®°ä½ï¼Œå¦‚æœä½ å°†ä¸€ä¸ªå¼‚å¸¸åŒ…è£…æˆå¦ä¸€ç§å¼‚å¸¸æ—¶ï¼Œæ„é€ ä¸€ä¸ªæ–°å¼‚å¸¸è¦ä¼ é€’æºå¼‚å¸¸ã€‚</p>\n<h4 id=\"4-å§‹ç»ˆæä¾›å…³äºå¼‚å¸¸çš„æœ‰æ„ä¹‰çš„å®Œæ•´çš„ä¿¡æ¯\"><a href=\"#4-å§‹ç»ˆæä¾›å…³äºå¼‚å¸¸çš„æœ‰æ„ä¹‰çš„å®Œæ•´çš„ä¿¡æ¯\" class=\"headerlink\" title=\"4) å§‹ç»ˆæä¾›å…³äºå¼‚å¸¸çš„æœ‰æ„ä¹‰çš„å®Œæ•´çš„ä¿¡æ¯\"></a>4) å§‹ç»ˆæä¾›å…³äºå¼‚å¸¸çš„æœ‰æ„ä¹‰çš„å®Œæ•´çš„ä¿¡æ¯</h4><p>å¼‚å¸¸ä¿¡æ¯æ˜¯æœ€é‡è¦çš„åœ°æ–¹ï¼Œå› ä¸ºè¿™æ˜¯ç¨‹åºå‘˜é¦–å…ˆçœ‹åˆ°çš„ç¬¬ä¸€ä¸ªåœ°æ–¹ï¼Œè¿™é‡Œä½ èƒ½æ‰¾åˆ°é—®é¢˜äº§ç”Ÿçš„æ ¹æœ¬åŸå› ã€‚è¿™é‡Œå§‹ç»ˆæä¾›ç²¾ç¡®çš„çœŸå®çš„ä¿¡æ¯ã€‚</p>\n<h4 id=\"5-é¿å…è¿‡åº¦ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸\"><a href=\"#5-é¿å…è¿‡åº¦ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸\" class=\"headerlink\" title=\"5) é¿å…è¿‡åº¦ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸\"></a>5) é¿å…è¿‡åº¦ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸</h4><p>æ£€æŸ¥å‹å¼‚å¸¸åœ¨å¼ºåˆ¶æ‰§è¡Œæ–¹é¢æœ‰ä¸€å®šçš„ä¼˜åŠ¿ï¼Œä½†åŒæ—¶å®ƒä¹Ÿç ´åäº†ä»£ç ï¼Œé€šè¿‡æ©ç›–ä¸šåŠ¡é€»è¾‘ä½¿ä»£ç å¯è¯»æ€§é™ä½ã€‚åªè¦ä½ ä¸è¿‡åº¦ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸ï¼Œä½ å¯ä»¥æœ€å¤§é™åº¦çš„å‡å°‘è¿™ç±»æƒ…å†µï¼Œè¿™æ ·åšçš„ç»“æœæ˜¯ä½ ä¼šå¾—åˆ°æ›´æ¸…æ´çš„ä»£ç ã€‚ä½ åŒæ ·å¯ä»¥ä½¿ç”¨Java7çš„æ–°åŠŸèƒ½ï¼Œä»¥ç§»é™¤é‡å¤é¡¹ã€‚</p>\n<h4 id=\"6-å°†æ£€æŸ¥å‹å¼‚å¸¸è½¬ä¸ºè¿è¡Œæ—¶å¼‚å¸¸\"><a href=\"#6-å°†æ£€æŸ¥å‹å¼‚å¸¸è½¬ä¸ºè¿è¡Œæ—¶å¼‚å¸¸\" class=\"headerlink\" title=\"6) å°†æ£€æŸ¥å‹å¼‚å¸¸è½¬ä¸ºè¿è¡Œæ—¶å¼‚å¸¸\"></a>6) å°†æ£€æŸ¥å‹å¼‚å¸¸è½¬ä¸ºè¿è¡Œæ—¶å¼‚å¸¸</h4><p>è¿™æ˜¯åœ¨åƒSpringä¹‹ç±»çš„å¤šæ•°æ¡†æ¶ä¸­ç”¨æ¥é™åˆ¶ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸çš„æŠ€æœ¯ä¹‹ä¸€ï¼Œå¤§éƒ¨åˆ†å‡ºè‡ªäºJDBCçš„æ£€æŸ¥å‹å¼‚å¸¸ï¼Œéƒ½è¢«åŒ…è£…è¿› DataAccessExceptionä¸­ï¼Œè€Œ(DataAccessException)å¼‚å¸¸æ˜¯ä¸€ç§éæ£€æŸ¥å‹å¼‚å¸¸ã€‚è¿™æ˜¯Javaæœ€ä½³å®è·µå¸¦æ¥çš„å¥½å¤„ï¼Œç‰¹å®šçš„å¼‚å¸¸é™åˆ¶åˆ°ç‰¹å®šçš„æ¨¡å—ï¼Œåƒ SQLException æ”¾åˆ°DAOå±‚ï¼Œå°†æ„æ€æ˜ç¡®çš„è¿è¡Œæ—¶å¼‚å¸¸æŠ›åˆ°å®¢æˆ·å±‚ã€‚</p>\n<h4 id=\"7-è®°ä½å¯¹æ€§èƒ½è€Œè¨€ï¼Œå¼‚å¸¸ä»£ä»·é«˜æ˜‚\"><a href=\"#7-è®°ä½å¯¹æ€§èƒ½è€Œè¨€ï¼Œå¼‚å¸¸ä»£ä»·é«˜æ˜‚\" class=\"headerlink\" title=\"7) è®°ä½å¯¹æ€§èƒ½è€Œè¨€ï¼Œå¼‚å¸¸ä»£ä»·é«˜æ˜‚\"></a>7) è®°ä½å¯¹æ€§èƒ½è€Œè¨€ï¼Œå¼‚å¸¸ä»£ä»·é«˜æ˜‚</h4><p>éœ€è¦è®°ä½çš„ä¸€ä»¶äº‹æ˜¯å¼‚å¸¸ä»£ä»·é«˜æ˜‚ï¼ŒåŒæ—¶è®©ä½ çš„ä»£ç è¿è¡Œç¼“æ…¢ã€‚å‡å¦‚ä½ æœ‰æ–¹æ³•ä»ResultSet(ç»“æœé›†)ä¸­è¿›è¡Œè¯»å–ï¼Œè¿™æ—¶å¸¸ä¼šæŠ›å‡ºSQLException å¼‚å¸¸è€Œä¸ä¼šç§»åˆ°ä¸‹ä¸€å…ƒç´ ï¼Œè¿™å°†ä¼šæ¯”ä¸æŠ›å‡ºå¼‚å¸¸çš„æ­£å¸¸ä»£ç æ‰§è¡Œçš„æ…¢çš„å¤šã€‚å› æ­¤æœ€å¤§é™åº¦çš„å‡å°‘ä¸å¿…è¦çš„å¼‚å¸¸æ•æ‰å’Œç§»åŠ¨ï¼Œé‚£é‡Œæ²¡æœ‰ä»€ä¹ˆå›ºå®šçš„åŸå› ã€‚ä¸è¦ä»…ä»…æ˜¯æŠ›å‡ºå’Œæ•æ‰å¼‚å¸¸ï¼Œå¦‚æœä½ èƒ½ä½¿ç”¨booleanå˜é‡å»è¡¨ç¤ºæ‰§è¡Œç»“æœï¼Œå¯èƒ½ä¼šå¾—åˆ°æ›´æ•´æ´ï¼Œæ›´é«˜æ€§èƒ½çš„è§£å†³æ–¹æ¡ˆã€‚ä¿®æ­£é”™è¯¯çš„æ ¹æºï¼Œé¿å…ä¸å¿…é¡»è¦çš„å¼‚å¸¸æ•æ‰ã€‚</p>\n<h4 id=\"8-é¿å…catchå—ä¸ºç©º\"><a href=\"#8-é¿å…catchå—ä¸ºç©º\" class=\"headerlink\" title=\"8) é¿å…catchå—ä¸ºç©º\"></a>8) é¿å…catchå—ä¸ºç©º</h4><p>æ²¡æœ‰ä»€ä¹ˆæ¯”ç©ºçš„catchå—æ›´ç³Ÿç³•çš„äº†ï¼Œå› ä¸ºå®ƒä¸ä»…éšè—äº†é”™è¯¯å’Œå¼‚å¸¸ï¼ŒåŒæ—¶å¯èƒ½å¯¼è‡´ä½ çš„å¯¹è±¡å¤„äºä¸å¯ä½¿ç”¨æˆ–è€…è„çš„çŠ¶æ€ã€‚ç©ºçš„catchå—åªèƒ½å˜å¾—æ— æ„ä¹‰ï¼Œå¦‚æœä½ éå¸¸è‚¯å®šå¼‚å¸¸ä¸ä¼šç»§ç»­ä»¥ä»»ä½•æ–¹å¼å½±å“å¯¹è±¡çŠ¶æ€ï¼Œä½†åœ¨ç¨‹åºæ‰§è¡ŒæœŸé—´ï¼Œç”¨æ—¥å¿—è®°å½•é”™è¯¯ä¾ç„¶æ˜¯æœ€å¥½çš„(æ–¹æ³•)ã€‚å¯¹äºåœ¨Javaç¼–ç¨‹ä¸­ç¼–å†™å¼‚å¸¸å¤„ç†ä»£ç ï¼Œè¿™ä¸ä»…ä»…æ˜¯ä¸€ä¸ªJavaæœ€ä½³å®è·µï¼Œè€Œæ˜¯ä¸€ä¸ªæœ€é€šç”¨çš„å®è·µã€‚</p>\n<h4 id=\"9-ä½¿ç”¨æ ‡å‡†å¼‚å¸¸\"><a href=\"#9-ä½¿ç”¨æ ‡å‡†å¼‚å¸¸\" class=\"headerlink\" title=\"9) ä½¿ç”¨æ ‡å‡†å¼‚å¸¸\"></a>9) ä½¿ç”¨æ ‡å‡†å¼‚å¸¸</h4><p>æˆ‘ä»¬çš„ç¬¬ä¹æ¡æœ€ä½³å®è·µå»ºè®®ä½¿ç”¨æ ‡å‡†å’Œå†…ç½®çš„Javaå¼‚å¸¸ã€‚ä½¿ç”¨æ ‡å‡†å¼‚å¸¸è€Œä¸æ˜¯æ¯æ¬¡åˆ›å»ºæˆ‘ä»¬è‡ªå·±çš„å¼‚å¸¸ï¼Œå¯¹äºç»´æŠ¤æ€§å’Œä¸€è‡´æ€§ï¼Œä¸ç®¡æ˜¯ç°åœ¨è¿˜æ˜¯ä»¥åï¼Œéƒ½æ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚é‡ç”¨æ ‡å‡†å¼‚å¸¸ä½¿ä»£ç æ›´å…·å¯è¯»æ€§ï¼Œå› ä¸ºå¤§éƒ¨åˆ†Javaå¼€å‘äººå‘˜å¯¹æ ‡å‡†çš„åƒæºè‡ªäºJDKçš„RuntimeException å¼‚å¸¸ï¼ŒIllegalStateException å¼‚å¸¸ï¼ŒIllegal Argument Exception å¼‚å¸¸æˆ–è€…NullPointerExceptionå¼‚å¸¸ï¼Œ(å¼€å‘è€…)ä»–ä»¬èƒ½ä¸€çœ¼å°±çŸ¥é“æ¯ç§å¼‚å¸¸çš„ç›®çš„ï¼Œè€Œä¸æ˜¯åœ¨ä»£ç é‡ŒæŸ¥æ‰¾æˆ–è€…åœ¨æ–‡æ¡£é‡ŒæŸ¥æ‰¾ç”¨æˆ·å®šä¹‰çš„å¼‚å¸¸çš„ç›®çš„ã€‚</p>\n<h4 id=\"10-è®°å½•ä»»ä½•æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸\"><a href=\"#10-è®°å½•ä»»ä½•æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸\" class=\"headerlink\" title=\"10) è®°å½•ä»»ä½•æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸\"></a>10) è®°å½•ä»»ä½•æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸</h4><p>Javaæä¾›äº†throwå’Œthrowså…³é”®å­—æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œåœ¨javadocä¸­ç”¨@throwè®°å½•ä»»ä½•æ–¹æ³•å¯èƒ½ä¼šæŠ›å‡ºçš„å¼‚å¸¸ã€‚å¦‚æœä½ ç¼–å†™APIæˆ–è€…å…¬å…±æ¥å£ï¼Œè¿™å°±å˜å¾—éå¸¸é‡è¦ã€‚ä»»ä½•æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸éƒ½æœ‰ç›¸åº”çš„æ–‡æ¡£è®°å½•ï¼Œè¿™æ ·ä½ å°±èƒ½ä¸‹æ„è¯†çš„æé†’ä»»ä½•ä½¿ç”¨(è¯¥æ–¹æ³•)çš„äººã€‚</p>\n<p>è¿™äº›å°±æ˜¯æ‰€æœ‰åœ¨Javaç¼–ç¨‹ä¸­åœ¨å¤„ç†å¼‚å¸¸çš„æ—¶å€™éœ€è¦éµå¾ªçš„æœ€ä½³å®è·µã€‚è®©æˆ‘ä»¬çŸ¥é“äº†ä»€ä¹ˆæ˜¯åœ¨Javaç¼–ç¨‹ä¸­ç¼–å†™å¼‚å¸¸å¤„ç†ä»£ç æ—¶éœ€è¦éµå¾ªçš„å®è·µã€‚</p>\n<p>åŸæ–‡ï¼š<a href=\"https://www.oschina.net/translate/10-exception-handling-best-practices-in-java-programming\">https://www.oschina.net/translate/10-exception-handling-best-practices-in-java-programming</a></p>\n","excerpt":"","more":"<p>å¼‚å¸¸å¤„ç†æ˜¯Java å¼€å‘ä¸­çš„ä¸€ä¸ªé‡è¦éƒ¨åˆ†ã€‚å®ƒæ˜¯å…³ä¹æ¯ä¸ªåº”ç”¨çš„ä¸€ä¸ªéåŠŸèƒ½æ€§éœ€æ±‚ï¼Œæ˜¯ä¸ºäº†å¤„ç†ä»»ä½•é”™è¯¯çŠ¶å†µï¼Œæ¯”å¦‚èµ„æºä¸å¯è®¿é—®ï¼Œéæ³•è¾“å…¥ï¼Œç©ºè¾“å…¥ç­‰ç­‰ã€‚Javaæä¾›äº†å‡ ä¸ªå¼‚å¸¸å¤„ç†ç‰¹æ€§ï¼Œä»¥tryï¼Œcatch å’Œ finally å…³é”®å­—çš„å½¢å¼å†…å»ºäºè¯­è¨€è‡ªèº«ä¹‹ä¸­ã€‚Java ç¼–ç¨‹è¯­è¨€ä¹Ÿå…è®¸ä½ åˆ›å»ºæ–°çš„å¼‚å¸¸ï¼Œå¹¶é€šè¿‡ä½¿ç”¨ throw å’Œ throwså…³é”®å­—æŠ›å‡ºå®ƒä»¬ã€‚äº‹å®ä¸Šï¼Œåœ¨Javaç¼–ç¨‹ä¸­ï¼ŒJavaçš„å¼‚å¸¸å¤„ç†ä¸å•å•æ˜¯çŸ¥é“è¯­æ³•è¿™ä¹ˆç®€å•ï¼Œå®ƒå¿…é¡»éµå¾ªæ ‡å‡†çš„JDKåº“ï¼Œå’Œå‡ ä¸ªå¤„ç†é”™è¯¯å’Œå¼‚å¸¸çš„å¼€æºä»£ç ã€‚è¿™é‡Œæˆ‘ä»¬å°†è®¨è®ºä¸€äº›å…³äºå¼‚å¸¸å¤„ç†çš„Java æœ€ä½³å®è·µã€‚</p>\n<h4 id=\"1-ä¸ºå¯æ¢å¤çš„é”™è¯¯ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸ï¼Œä¸ºç¼–ç¨‹é”™è¯¯ä½¿ç”¨éæ£€æŸ¥å‹é”™è¯¯ã€‚\"><a href=\"#1-ä¸ºå¯æ¢å¤çš„é”™è¯¯ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸ï¼Œä¸ºç¼–ç¨‹é”™è¯¯ä½¿ç”¨éæ£€æŸ¥å‹é”™è¯¯ã€‚\" class=\"headerlink\" title=\"1) ä¸ºå¯æ¢å¤çš„é”™è¯¯ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸ï¼Œä¸ºç¼–ç¨‹é”™è¯¯ä½¿ç”¨éæ£€æŸ¥å‹é”™è¯¯ã€‚\"></a>1) ä¸ºå¯æ¢å¤çš„é”™è¯¯ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸ï¼Œä¸ºç¼–ç¨‹é”™è¯¯ä½¿ç”¨éæ£€æŸ¥å‹é”™è¯¯ã€‚</h4><p>é€‰æ‹©æ£€æŸ¥å‹è¿˜æ˜¯éæ£€æŸ¥å‹å¼‚å¸¸ï¼Œå¯¹äºJavaç¼–ç¨‹äººå‘˜æ¥è¯´ï¼Œæ€»æ˜¯è®©äººæ„Ÿåˆ°å›°æƒ‘ã€‚æ£€æŸ¥å‹å¼‚å¸¸ä¿è¯ä½ å¯¹é”™è¯¯æ¡ä»¶æä¾›å¼‚å¸¸å¤„ç†ä»£ç ï¼Œè¿™æ˜¯ä¸€ç§ä»è¯­è¨€åˆ°å¼ºåˆ¶ä½ ç¼–å†™å¥å£®çš„ä»£ç çš„ä¸€ç§æ–¹å¼ï¼Œä½†åŒæ—¶ä¼šå¼•å…¥å¤§é‡æ‚ä¹±çš„ä»£ç å¹¶å¯¼è‡´å…¶ä¸å¯è¯»ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æœ‰æ›¿ä»£å“å’Œæ¢å¤ç­–ç•¥çš„è¯ï¼Œæ•æ‰å¼‚å¸¸å¹¶åšäº›ä»€ä¹ˆçœ‹èµ·æ¥ä¼¼ä¹ä¹Ÿåœ¨ç†ã€‚åœ¨Java ç¼–ç¨‹ä¸­é€‰æ‹©æ£€æŸ¥å‹å¼‚å¸¸è¿˜æ˜¯è¿è¡Œæ—¶å¼‚å¸¸ã€‚</p>\n<h4 id=\"2-åœ¨finallyç¨‹åºå—ä¸­å…³é—­æˆ–è€…é‡Šæ”¾èµ„æº\"><a href=\"#2-åœ¨finallyç¨‹åºå—ä¸­å…³é—­æˆ–è€…é‡Šæ”¾èµ„æº\" class=\"headerlink\" title=\"2) åœ¨finallyç¨‹åºå—ä¸­å…³é—­æˆ–è€…é‡Šæ”¾èµ„æº\"></a>2) åœ¨finallyç¨‹åºå—ä¸­å…³é—­æˆ–è€…é‡Šæ”¾èµ„æº</h4><p>è¿™åœ¨Javaç¼–ç¨‹ä¸­ï¼Œæ˜¯ä¸€ä¸ªå¹¿ä¸ºäººçŸ¥çš„æœ€ä½³å®è·µï¼Œåœ¨å¤„ç†ç½‘ç»œå’ŒIOç±»çš„æ—¶å€™ï¼Œç›¸å½“äºä¸€ä¸ªæ ‡å‡†ã€‚åœ¨finallyå—ä¸­å…³é—­èµ„æºï¼Œ åœ¨æ­£å¸¸å’Œå¼‚å¸¸æ‰§è¡Œçš„æƒ…å†µä¸‹ï¼Œä¿è¯ä¹‹å‰å’Œç¨€ç¼ºèµ„æºçš„åˆç†é‡Šæ”¾ï¼Œè¿™ç”±finallyå—ä¿è¯ã€‚ä»Java7å¼€å§‹ï¼Œè¯¥è¯­è¨€æœ‰äº†ä¸€é¡¹æ›´æœ‰è¶£çš„åŠŸèƒ½ï¼šèµ„æºç®¡ç†è‡ªåŠ¨åŒ–æˆ–è€…ARMå—èƒ½å®ç°è¿™ä¸€åŠŸèƒ½ã€‚å°½ç®¡å¦‚æ­¤ï¼Œæˆ‘ä»¬ä»ç„¶è¦è®°ä½åœ¨finallyå—ä¸­å…³é—­èµ„æºï¼Œè¿™æ˜¯å¯¹äºé‡Šæ”¾åƒFileDescriptorsè¿™ç±»ï¼Œåº”ç”¨åœ¨socketå’Œæ–‡ä»¶ç¼–ç¨‹çš„æƒ…å†µä¸‹çš„æœ‰é™èµ„æºå¾ˆé‡è¦çš„ã€‚</p>\n<h4 id=\"3-åœ¨å †æ ˆè·Ÿè¸ªä¸­åŒ…å«å¼•èµ·å¼‚å¸¸çš„åŸå› \"><a href=\"#3-åœ¨å †æ ˆè·Ÿè¸ªä¸­åŒ…å«å¼•èµ·å¼‚å¸¸çš„åŸå› \" class=\"headerlink\" title=\"3) åœ¨å †æ ˆè·Ÿè¸ªä¸­åŒ…å«å¼•èµ·å¼‚å¸¸çš„åŸå› \"></a>3) åœ¨å †æ ˆè·Ÿè¸ªä¸­åŒ…å«å¼•èµ·å¼‚å¸¸çš„åŸå› </h4><p>å¾ˆå¤šæ—¶å€™ï¼Œå½“ä¸€ä¸ªç”±å¦ä¸€ä¸ªå¼‚å¸¸å¯¼è‡´çš„å¼‚å¸¸è¢«æŠ›å‡ºçš„æ—¶å€™ï¼ŒJavaåº“å’Œå¼€æ”¾æºä»£ç ä¼šå°†ä¸€ç§å¼‚å¸¸åŒ…è£…æˆå¦ä¸€ç§å¼‚å¸¸ã€‚æ—¥å¿—è®°å½•å’Œæ‰“å°æ ¹å¼‚å¸¸å°±å˜å¾—éå¸¸é‡è¦ã€‚ Javaå¼‚å¸¸ç±»æä¾›äº† getCause()æ–¹æ³•æ¥æ£€ç´¢å¯¼è‡´å¼‚å¸¸çš„åŸå› ï¼Œè¿™äº›(åŸå› )å¯ä»¥å¯¹å¼‚å¸¸çš„æ ¹å±‚æ¬¡çš„åŸå› æä¾›æ›´å¤šçš„ä¿¡æ¯ã€‚è¯¥Javaå®è·µå¯¹åœ¨è¿›è¡Œè°ƒè¯•æˆ–æ’é™¤æ•…éšœå¤§æœ‰å¸®åŠ©ã€‚æ—¶åˆ»è®°ä½ï¼Œå¦‚æœä½ å°†ä¸€ä¸ªå¼‚å¸¸åŒ…è£…æˆå¦ä¸€ç§å¼‚å¸¸æ—¶ï¼Œæ„é€ ä¸€ä¸ªæ–°å¼‚å¸¸è¦ä¼ é€’æºå¼‚å¸¸ã€‚</p>\n<h4 id=\"4-å§‹ç»ˆæä¾›å…³äºå¼‚å¸¸çš„æœ‰æ„ä¹‰çš„å®Œæ•´çš„ä¿¡æ¯\"><a href=\"#4-å§‹ç»ˆæä¾›å…³äºå¼‚å¸¸çš„æœ‰æ„ä¹‰çš„å®Œæ•´çš„ä¿¡æ¯\" class=\"headerlink\" title=\"4) å§‹ç»ˆæä¾›å…³äºå¼‚å¸¸çš„æœ‰æ„ä¹‰çš„å®Œæ•´çš„ä¿¡æ¯\"></a>4) å§‹ç»ˆæä¾›å…³äºå¼‚å¸¸çš„æœ‰æ„ä¹‰çš„å®Œæ•´çš„ä¿¡æ¯</h4><p>å¼‚å¸¸ä¿¡æ¯æ˜¯æœ€é‡è¦çš„åœ°æ–¹ï¼Œå› ä¸ºè¿™æ˜¯ç¨‹åºå‘˜é¦–å…ˆçœ‹åˆ°çš„ç¬¬ä¸€ä¸ªåœ°æ–¹ï¼Œè¿™é‡Œä½ èƒ½æ‰¾åˆ°é—®é¢˜äº§ç”Ÿçš„æ ¹æœ¬åŸå› ã€‚è¿™é‡Œå§‹ç»ˆæä¾›ç²¾ç¡®çš„çœŸå®çš„ä¿¡æ¯ã€‚</p>\n<h4 id=\"5-é¿å…è¿‡åº¦ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸\"><a href=\"#5-é¿å…è¿‡åº¦ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸\" class=\"headerlink\" title=\"5) é¿å…è¿‡åº¦ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸\"></a>5) é¿å…è¿‡åº¦ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸</h4><p>æ£€æŸ¥å‹å¼‚å¸¸åœ¨å¼ºåˆ¶æ‰§è¡Œæ–¹é¢æœ‰ä¸€å®šçš„ä¼˜åŠ¿ï¼Œä½†åŒæ—¶å®ƒä¹Ÿç ´åäº†ä»£ç ï¼Œé€šè¿‡æ©ç›–ä¸šåŠ¡é€»è¾‘ä½¿ä»£ç å¯è¯»æ€§é™ä½ã€‚åªè¦ä½ ä¸è¿‡åº¦ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸ï¼Œä½ å¯ä»¥æœ€å¤§é™åº¦çš„å‡å°‘è¿™ç±»æƒ…å†µï¼Œè¿™æ ·åšçš„ç»“æœæ˜¯ä½ ä¼šå¾—åˆ°æ›´æ¸…æ´çš„ä»£ç ã€‚ä½ åŒæ ·å¯ä»¥ä½¿ç”¨Java7çš„æ–°åŠŸèƒ½ï¼Œä»¥ç§»é™¤é‡å¤é¡¹ã€‚</p>\n<h4 id=\"6-å°†æ£€æŸ¥å‹å¼‚å¸¸è½¬ä¸ºè¿è¡Œæ—¶å¼‚å¸¸\"><a href=\"#6-å°†æ£€æŸ¥å‹å¼‚å¸¸è½¬ä¸ºè¿è¡Œæ—¶å¼‚å¸¸\" class=\"headerlink\" title=\"6) å°†æ£€æŸ¥å‹å¼‚å¸¸è½¬ä¸ºè¿è¡Œæ—¶å¼‚å¸¸\"></a>6) å°†æ£€æŸ¥å‹å¼‚å¸¸è½¬ä¸ºè¿è¡Œæ—¶å¼‚å¸¸</h4><p>è¿™æ˜¯åœ¨åƒSpringä¹‹ç±»çš„å¤šæ•°æ¡†æ¶ä¸­ç”¨æ¥é™åˆ¶ä½¿ç”¨æ£€æŸ¥å‹å¼‚å¸¸çš„æŠ€æœ¯ä¹‹ä¸€ï¼Œå¤§éƒ¨åˆ†å‡ºè‡ªäºJDBCçš„æ£€æŸ¥å‹å¼‚å¸¸ï¼Œéƒ½è¢«åŒ…è£…è¿› DataAccessExceptionä¸­ï¼Œè€Œ(DataAccessException)å¼‚å¸¸æ˜¯ä¸€ç§éæ£€æŸ¥å‹å¼‚å¸¸ã€‚è¿™æ˜¯Javaæœ€ä½³å®è·µå¸¦æ¥çš„å¥½å¤„ï¼Œç‰¹å®šçš„å¼‚å¸¸é™åˆ¶åˆ°ç‰¹å®šçš„æ¨¡å—ï¼Œåƒ SQLException æ”¾åˆ°DAOå±‚ï¼Œå°†æ„æ€æ˜ç¡®çš„è¿è¡Œæ—¶å¼‚å¸¸æŠ›åˆ°å®¢æˆ·å±‚ã€‚</p>\n<h4 id=\"7-è®°ä½å¯¹æ€§èƒ½è€Œè¨€ï¼Œå¼‚å¸¸ä»£ä»·é«˜æ˜‚\"><a href=\"#7-è®°ä½å¯¹æ€§èƒ½è€Œè¨€ï¼Œå¼‚å¸¸ä»£ä»·é«˜æ˜‚\" class=\"headerlink\" title=\"7) è®°ä½å¯¹æ€§èƒ½è€Œè¨€ï¼Œå¼‚å¸¸ä»£ä»·é«˜æ˜‚\"></a>7) è®°ä½å¯¹æ€§èƒ½è€Œè¨€ï¼Œå¼‚å¸¸ä»£ä»·é«˜æ˜‚</h4><p>éœ€è¦è®°ä½çš„ä¸€ä»¶äº‹æ˜¯å¼‚å¸¸ä»£ä»·é«˜æ˜‚ï¼ŒåŒæ—¶è®©ä½ çš„ä»£ç è¿è¡Œç¼“æ…¢ã€‚å‡å¦‚ä½ æœ‰æ–¹æ³•ä»ResultSet(ç»“æœé›†)ä¸­è¿›è¡Œè¯»å–ï¼Œè¿™æ—¶å¸¸ä¼šæŠ›å‡ºSQLException å¼‚å¸¸è€Œä¸ä¼šç§»åˆ°ä¸‹ä¸€å…ƒç´ ï¼Œè¿™å°†ä¼šæ¯”ä¸æŠ›å‡ºå¼‚å¸¸çš„æ­£å¸¸ä»£ç æ‰§è¡Œçš„æ…¢çš„å¤šã€‚å› æ­¤æœ€å¤§é™åº¦çš„å‡å°‘ä¸å¿…è¦çš„å¼‚å¸¸æ•æ‰å’Œç§»åŠ¨ï¼Œé‚£é‡Œæ²¡æœ‰ä»€ä¹ˆå›ºå®šçš„åŸå› ã€‚ä¸è¦ä»…ä»…æ˜¯æŠ›å‡ºå’Œæ•æ‰å¼‚å¸¸ï¼Œå¦‚æœä½ èƒ½ä½¿ç”¨booleanå˜é‡å»è¡¨ç¤ºæ‰§è¡Œç»“æœï¼Œå¯èƒ½ä¼šå¾—åˆ°æ›´æ•´æ´ï¼Œæ›´é«˜æ€§èƒ½çš„è§£å†³æ–¹æ¡ˆã€‚ä¿®æ­£é”™è¯¯çš„æ ¹æºï¼Œé¿å…ä¸å¿…é¡»è¦çš„å¼‚å¸¸æ•æ‰ã€‚</p>\n<h4 id=\"8-é¿å…catchå—ä¸ºç©º\"><a href=\"#8-é¿å…catchå—ä¸ºç©º\" class=\"headerlink\" title=\"8) é¿å…catchå—ä¸ºç©º\"></a>8) é¿å…catchå—ä¸ºç©º</h4><p>æ²¡æœ‰ä»€ä¹ˆæ¯”ç©ºçš„catchå—æ›´ç³Ÿç³•çš„äº†ï¼Œå› ä¸ºå®ƒä¸ä»…éšè—äº†é”™è¯¯å’Œå¼‚å¸¸ï¼ŒåŒæ—¶å¯èƒ½å¯¼è‡´ä½ çš„å¯¹è±¡å¤„äºä¸å¯ä½¿ç”¨æˆ–è€…è„çš„çŠ¶æ€ã€‚ç©ºçš„catchå—åªèƒ½å˜å¾—æ— æ„ä¹‰ï¼Œå¦‚æœä½ éå¸¸è‚¯å®šå¼‚å¸¸ä¸ä¼šç»§ç»­ä»¥ä»»ä½•æ–¹å¼å½±å“å¯¹è±¡çŠ¶æ€ï¼Œä½†åœ¨ç¨‹åºæ‰§è¡ŒæœŸé—´ï¼Œç”¨æ—¥å¿—è®°å½•é”™è¯¯ä¾ç„¶æ˜¯æœ€å¥½çš„(æ–¹æ³•)ã€‚å¯¹äºåœ¨Javaç¼–ç¨‹ä¸­ç¼–å†™å¼‚å¸¸å¤„ç†ä»£ç ï¼Œè¿™ä¸ä»…ä»…æ˜¯ä¸€ä¸ªJavaæœ€ä½³å®è·µï¼Œè€Œæ˜¯ä¸€ä¸ªæœ€é€šç”¨çš„å®è·µã€‚</p>\n<h4 id=\"9-ä½¿ç”¨æ ‡å‡†å¼‚å¸¸\"><a href=\"#9-ä½¿ç”¨æ ‡å‡†å¼‚å¸¸\" class=\"headerlink\" title=\"9) ä½¿ç”¨æ ‡å‡†å¼‚å¸¸\"></a>9) ä½¿ç”¨æ ‡å‡†å¼‚å¸¸</h4><p>æˆ‘ä»¬çš„ç¬¬ä¹æ¡æœ€ä½³å®è·µå»ºè®®ä½¿ç”¨æ ‡å‡†å’Œå†…ç½®çš„Javaå¼‚å¸¸ã€‚ä½¿ç”¨æ ‡å‡†å¼‚å¸¸è€Œä¸æ˜¯æ¯æ¬¡åˆ›å»ºæˆ‘ä»¬è‡ªå·±çš„å¼‚å¸¸ï¼Œå¯¹äºç»´æŠ¤æ€§å’Œä¸€è‡´æ€§ï¼Œä¸ç®¡æ˜¯ç°åœ¨è¿˜æ˜¯ä»¥åï¼Œéƒ½æ˜¯æœ€å¥½çš„é€‰æ‹©ã€‚é‡ç”¨æ ‡å‡†å¼‚å¸¸ä½¿ä»£ç æ›´å…·å¯è¯»æ€§ï¼Œå› ä¸ºå¤§éƒ¨åˆ†Javaå¼€å‘äººå‘˜å¯¹æ ‡å‡†çš„åƒæºè‡ªäºJDKçš„RuntimeException å¼‚å¸¸ï¼ŒIllegalStateException å¼‚å¸¸ï¼ŒIllegal Argument Exception å¼‚å¸¸æˆ–è€…NullPointerExceptionå¼‚å¸¸ï¼Œ(å¼€å‘è€…)ä»–ä»¬èƒ½ä¸€çœ¼å°±çŸ¥é“æ¯ç§å¼‚å¸¸çš„ç›®çš„ï¼Œè€Œä¸æ˜¯åœ¨ä»£ç é‡ŒæŸ¥æ‰¾æˆ–è€…åœ¨æ–‡æ¡£é‡ŒæŸ¥æ‰¾ç”¨æˆ·å®šä¹‰çš„å¼‚å¸¸çš„ç›®çš„ã€‚</p>\n<h4 id=\"10-è®°å½•ä»»ä½•æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸\"><a href=\"#10-è®°å½•ä»»ä½•æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸\" class=\"headerlink\" title=\"10) è®°å½•ä»»ä½•æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸\"></a>10) è®°å½•ä»»ä½•æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸</h4><p>Javaæä¾›äº†throwå’Œthrowså…³é”®å­—æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œåœ¨javadocä¸­ç”¨@throwè®°å½•ä»»ä½•æ–¹æ³•å¯èƒ½ä¼šæŠ›å‡ºçš„å¼‚å¸¸ã€‚å¦‚æœä½ ç¼–å†™APIæˆ–è€…å…¬å…±æ¥å£ï¼Œè¿™å°±å˜å¾—éå¸¸é‡è¦ã€‚ä»»ä½•æ–¹æ³•æŠ›å‡ºçš„å¼‚å¸¸éƒ½æœ‰ç›¸åº”çš„æ–‡æ¡£è®°å½•ï¼Œè¿™æ ·ä½ å°±èƒ½ä¸‹æ„è¯†çš„æé†’ä»»ä½•ä½¿ç”¨(è¯¥æ–¹æ³•)çš„äººã€‚</p>\n<p>è¿™äº›å°±æ˜¯æ‰€æœ‰åœ¨Javaç¼–ç¨‹ä¸­åœ¨å¤„ç†å¼‚å¸¸çš„æ—¶å€™éœ€è¦éµå¾ªçš„æœ€ä½³å®è·µã€‚è®©æˆ‘ä»¬çŸ¥é“äº†ä»€ä¹ˆæ˜¯åœ¨Javaç¼–ç¨‹ä¸­ç¼–å†™å¼‚å¸¸å¤„ç†ä»£ç æ—¶éœ€è¦éµå¾ªçš„å®è·µã€‚</p>\n<p>åŸæ–‡ï¼š<a href=\"https://www.oschina.net/translate/10-exception-handling-best-practices-in-java-programming\">https://www.oschina.net/translate/10-exception-handling-best-practices-in-java-programming</a></p>\n"},{"title":"Java ç±»åˆå§‹åŒ–é¡ºåºï¼Œ3ä¸ªç¤ºä¾‹å¸¦ä½ èººå‘ã€‚","date":"2025-10-15T03:36:33.000Z","_content":"\næœ€è¿‘å‘ç°å¾®ä¿¡ç¾¤é‡Œé¢æœ‰äº›ç¾¤å‹åœ¨è®¨è®ºç±»çš„åˆå§‹åŒ–é¡ºåºï¼Œå¦‚ç±»çš„é™æ€å˜é‡ã€æˆå‘˜å˜é‡ã€é™æ€ä»£ç å—ã€éé™æ€ä»£ç å—ã€æ„é€ å™¨ï¼ŒåŠç»§æ‰¿çˆ¶ç±»æ—¶ï¼Œå®ƒä»¬çš„åˆå§‹åŒ–é¡ºåºéƒ½æ˜¯æ€æ ·çš„ï¼Œä¸‹é¢æˆ‘é€šè¿‡ä¾‹å­æ¥è¯´æ˜è¿™ä¸ªæƒ…å†µï¼Œä»¥å…è¢«äººè¯¯å¯¼ã€‚\n\n#### ç¤ºä¾‹1ï¼šæµ‹è¯•å•ç±»çš„åˆå§‹åŒ–é¡ºåº\n\n```\npublic class ClassInitOrderTest {\n\n\tpublic static String staticField = \"static field\";\n\n\tstatic {\n\t\tSystem.out.println(staticField);\n\t\tSystem.out.println(\"static block\");\n\t}\n\n\tprivate String field = \"member field\";\n\n\t{\n\t\tSystem.out.println(field);\n\t\tSystem.out.println(\"non-static block\");\n\t}\n\n\tpublic ClassInitOrderTest() {\n\t\tSystem.out.println(\"constructor\");\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew ClassInitOrderTest();\n\t}\n\n}\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n\n```\nstatic field\nstatic block\nmember field\nnon-static block\nconstructor\n```\n\nå¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼Œå•ç±»çš„åˆå§‹åŒ–é¡ºåºä¸ºï¼š\n\n> **é™æ€å˜é‡ > é™æ€åˆå§‹å— > æˆå‘˜å˜é‡ > éé™æ€åˆå§‹å— > æ„é€ å™¨**\n\n\n#### ç¤ºä¾‹2ï¼šæµ‹è¯•ç±»ç»§æ‰¿çš„åˆå§‹åŒ–é¡ºåº\n\n```\nclass Parent {\n\n\tprivate static String parentStaticField = \"parent static field\";\n\n\tstatic {\n\t\tSystem.out.println(parentStaticField);\n\t\tSystem.out.println(\"parent static block\");\n\t}\n\n\tprivate String parentField = \"parent member field\";\n\n\t{\n\t\tSystem.out.println(parentField);\n\t\tSystem.out.println(\"parent non-static block\");\n\t}\n\n\tpublic Parent() {\n\t\tSystem.out.println(\"parent constructor\");\n\t}\n\n}\n\npublic class Child extends Parent {\n\n\tprivate static String childStaticField = \"child static field\";\n\n\tstatic {\n\t\tSystem.out.println(childStaticField);\n\t\tSystem.out.println(\"child static block\");\n\t}\n\n\tprivate String childField = \"child member field\";\n\n\t{\n\t\tSystem.out.println(childField);\n\t\tSystem.out.println(\"child non-static block\");\n\t}\n\n\tpublic Child() {\n\t\tSystem.out.println(\"child constructor\");\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Child();\n\t}\n\n}\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n\n```\nparent static field\nparent static block\nchild static field\nchild static block\nparent member field\nparent non-static block\nparent constructor\nchild member field\nchild non-static block\nchild constructor\n```\n\nå¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼Œå•ç±»çš„åˆå§‹åŒ–é¡ºåºä¸ºï¼š\n\n> **çˆ¶ç±»é™æ€å˜é‡ > çˆ¶ç±»é™æ€åˆå§‹å— > å­ç±»é™æ€å˜é‡ > å­ç±»é™æ€åˆå§‹å— > çˆ¶ç±»æˆå‘˜å˜é‡ > çˆ¶ç±»éé™æ€åˆå§‹å— > çˆ¶ç±»æ„é€ å™¨ > å­ç±»æˆå‘˜å˜é‡ > å­ç±»éé™æ€åˆå§‹å— > å­ç±»æ„é€ å™¨**\n\n\n#### ç¤ºä¾‹3ï¼šæµ‹è¯•æˆå‘˜å˜é‡ã€åˆå§‹å—çš„åˆå§‹åŒ–é¡ºåº\n\nä»ä¸Šé¢ä¸¤ä¸ªä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œçˆ¶ç±»çš„é™æ€å˜é‡å’Œé™æ€åˆå§‹å—è‚¯å®šæ˜¯å…ˆäºå­ç±»åŠ è½½çš„ã€‚ä½†åŒä¸€ä¸ªç±»ä¸­çš„é™æ€å˜é‡ä¸é™æ€åˆå§‹å—ä¹‹é—´ï¼Œæˆå‘˜å˜é‡ä¸åˆå§‹å—ä¹‹é—´çš„é¡ºåºä¸€å®šæ˜¯å˜é‡å…ˆäºåˆå§‹å—å—ï¼Ÿç»§ç»­æ¼”ç¤ºï¼\n\n```\npublic class TestOrder {\n\n\tprivate static A a = new A();\n\n\tstatic {\n\t\tSystem.out.println(\"static block\");\n\t}\n\n\tprivate static B b = new B();\n\n\tpublic static void main(String[] args) {\n\t\tnew TestOrder();\n\t}\n\n}\n\nclass A {\n\tpublic A() {\n\t\tSystem.out.println(\"static field A\");\n\t}\n}\n\nclass B {\n\tpublic B() {\n\t\tSystem.out.println(\"static field B\");\n\t}\n}\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n\n```\nstatic field A\nstatic block\nstatic field B\n```\n\nå¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼Œå•ç±»çš„åˆå§‹åŒ–é¡ºåºä¸ºï¼š\n\n> **é™æ€å˜é‡A > é™æ€åˆå§‹å— > é™æ€å˜é‡B**\n\næ‰€ä»¥ï¼Œå®ƒä»¬çš„åœ¨ç±»ä¸­çš„é¡ºåºå°±å†³å®šäº†å®ƒä»¬çš„åˆå§‹åŒ–é¡ºåºï¼Œè€Œä¸æ˜¯å˜é‡ä¸€å®šä¼šä¼˜å…ˆäºåˆå§‹å—ã€‚\n\n\n","source":"_posts/è¿›é˜¶/Java ç±»åˆå§‹åŒ–é¡ºåºï¼Œ3ä¸ªç¤ºä¾‹å¸¦ä½ èººå‘ã€‚.md","raw":"---\ntitle: Java ç±»åˆå§‹åŒ–é¡ºåºï¼Œ3ä¸ªç¤ºä¾‹å¸¦ä½ èººå‘ã€‚\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: è¿›é˜¶\n---\n\næœ€è¿‘å‘ç°å¾®ä¿¡ç¾¤é‡Œé¢æœ‰äº›ç¾¤å‹åœ¨è®¨è®ºç±»çš„åˆå§‹åŒ–é¡ºåºï¼Œå¦‚ç±»çš„é™æ€å˜é‡ã€æˆå‘˜å˜é‡ã€é™æ€ä»£ç å—ã€éé™æ€ä»£ç å—ã€æ„é€ å™¨ï¼ŒåŠç»§æ‰¿çˆ¶ç±»æ—¶ï¼Œå®ƒä»¬çš„åˆå§‹åŒ–é¡ºåºéƒ½æ˜¯æ€æ ·çš„ï¼Œä¸‹é¢æˆ‘é€šè¿‡ä¾‹å­æ¥è¯´æ˜è¿™ä¸ªæƒ…å†µï¼Œä»¥å…è¢«äººè¯¯å¯¼ã€‚\n\n#### ç¤ºä¾‹1ï¼šæµ‹è¯•å•ç±»çš„åˆå§‹åŒ–é¡ºåº\n\n```\npublic class ClassInitOrderTest {\n\n\tpublic static String staticField = \"static field\";\n\n\tstatic {\n\t\tSystem.out.println(staticField);\n\t\tSystem.out.println(\"static block\");\n\t}\n\n\tprivate String field = \"member field\";\n\n\t{\n\t\tSystem.out.println(field);\n\t\tSystem.out.println(\"non-static block\");\n\t}\n\n\tpublic ClassInitOrderTest() {\n\t\tSystem.out.println(\"constructor\");\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew ClassInitOrderTest();\n\t}\n\n}\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n\n```\nstatic field\nstatic block\nmember field\nnon-static block\nconstructor\n```\n\nå¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼Œå•ç±»çš„åˆå§‹åŒ–é¡ºåºä¸ºï¼š\n\n> **é™æ€å˜é‡ > é™æ€åˆå§‹å— > æˆå‘˜å˜é‡ > éé™æ€åˆå§‹å— > æ„é€ å™¨**\n\n\n#### ç¤ºä¾‹2ï¼šæµ‹è¯•ç±»ç»§æ‰¿çš„åˆå§‹åŒ–é¡ºåº\n\n```\nclass Parent {\n\n\tprivate static String parentStaticField = \"parent static field\";\n\n\tstatic {\n\t\tSystem.out.println(parentStaticField);\n\t\tSystem.out.println(\"parent static block\");\n\t}\n\n\tprivate String parentField = \"parent member field\";\n\n\t{\n\t\tSystem.out.println(parentField);\n\t\tSystem.out.println(\"parent non-static block\");\n\t}\n\n\tpublic Parent() {\n\t\tSystem.out.println(\"parent constructor\");\n\t}\n\n}\n\npublic class Child extends Parent {\n\n\tprivate static String childStaticField = \"child static field\";\n\n\tstatic {\n\t\tSystem.out.println(childStaticField);\n\t\tSystem.out.println(\"child static block\");\n\t}\n\n\tprivate String childField = \"child member field\";\n\n\t{\n\t\tSystem.out.println(childField);\n\t\tSystem.out.println(\"child non-static block\");\n\t}\n\n\tpublic Child() {\n\t\tSystem.out.println(\"child constructor\");\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tnew Child();\n\t}\n\n}\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n\n```\nparent static field\nparent static block\nchild static field\nchild static block\nparent member field\nparent non-static block\nparent constructor\nchild member field\nchild non-static block\nchild constructor\n```\n\nå¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼Œå•ç±»çš„åˆå§‹åŒ–é¡ºåºä¸ºï¼š\n\n> **çˆ¶ç±»é™æ€å˜é‡ > çˆ¶ç±»é™æ€åˆå§‹å— > å­ç±»é™æ€å˜é‡ > å­ç±»é™æ€åˆå§‹å— > çˆ¶ç±»æˆå‘˜å˜é‡ > çˆ¶ç±»éé™æ€åˆå§‹å— > çˆ¶ç±»æ„é€ å™¨ > å­ç±»æˆå‘˜å˜é‡ > å­ç±»éé™æ€åˆå§‹å— > å­ç±»æ„é€ å™¨**\n\n\n#### ç¤ºä¾‹3ï¼šæµ‹è¯•æˆå‘˜å˜é‡ã€åˆå§‹å—çš„åˆå§‹åŒ–é¡ºåº\n\nä»ä¸Šé¢ä¸¤ä¸ªä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œçˆ¶ç±»çš„é™æ€å˜é‡å’Œé™æ€åˆå§‹å—è‚¯å®šæ˜¯å…ˆäºå­ç±»åŠ è½½çš„ã€‚ä½†åŒä¸€ä¸ªç±»ä¸­çš„é™æ€å˜é‡ä¸é™æ€åˆå§‹å—ä¹‹é—´ï¼Œæˆå‘˜å˜é‡ä¸åˆå§‹å—ä¹‹é—´çš„é¡ºåºä¸€å®šæ˜¯å˜é‡å…ˆäºåˆå§‹å—å—ï¼Ÿç»§ç»­æ¼”ç¤ºï¼\n\n```\npublic class TestOrder {\n\n\tprivate static A a = new A();\n\n\tstatic {\n\t\tSystem.out.println(\"static block\");\n\t}\n\n\tprivate static B b = new B();\n\n\tpublic static void main(String[] args) {\n\t\tnew TestOrder();\n\t}\n\n}\n\nclass A {\n\tpublic A() {\n\t\tSystem.out.println(\"static field A\");\n\t}\n}\n\nclass B {\n\tpublic B() {\n\t\tSystem.out.println(\"static field B\");\n\t}\n}\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n\n```\nstatic field A\nstatic block\nstatic field B\n```\n\nå¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼Œå•ç±»çš„åˆå§‹åŒ–é¡ºåºä¸ºï¼š\n\n> **é™æ€å˜é‡A > é™æ€åˆå§‹å— > é™æ€å˜é‡B**\n\næ‰€ä»¥ï¼Œå®ƒä»¬çš„åœ¨ç±»ä¸­çš„é¡ºåºå°±å†³å®šäº†å®ƒä»¬çš„åˆå§‹åŒ–é¡ºåºï¼Œè€Œä¸æ˜¯å˜é‡ä¸€å®šä¼šä¼˜å…ˆäºåˆå§‹å—ã€‚\n\n\n","slug":"è¿›é˜¶/Java ç±»åˆå§‹åŒ–é¡ºåºï¼Œ3ä¸ªç¤ºä¾‹å¸¦ä½ èººå‘ã€‚","published":1,"updated":"2025-10-15T07:21:14.219Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076g000rqkd4fvzra77j","content":"<p>æœ€è¿‘å‘ç°å¾®ä¿¡ç¾¤é‡Œé¢æœ‰äº›ç¾¤å‹åœ¨è®¨è®ºç±»çš„åˆå§‹åŒ–é¡ºåºï¼Œå¦‚ç±»çš„é™æ€å˜é‡ã€æˆå‘˜å˜é‡ã€é™æ€ä»£ç å—ã€éé™æ€ä»£ç å—ã€æ„é€ å™¨ï¼ŒåŠç»§æ‰¿çˆ¶ç±»æ—¶ï¼Œå®ƒä»¬çš„åˆå§‹åŒ–é¡ºåºéƒ½æ˜¯æ€æ ·çš„ï¼Œä¸‹é¢æˆ‘é€šè¿‡ä¾‹å­æ¥è¯´æ˜è¿™ä¸ªæƒ…å†µï¼Œä»¥å…è¢«äººè¯¯å¯¼ã€‚</p>\n<h4 id=\"ç¤ºä¾‹1ï¼šæµ‹è¯•å•ç±»çš„åˆå§‹åŒ–é¡ºåº\"><a href=\"#ç¤ºä¾‹1ï¼šæµ‹è¯•å•ç±»çš„åˆå§‹åŒ–é¡ºåº\" class=\"headerlink\" title=\"ç¤ºä¾‹1ï¼šæµ‹è¯•å•ç±»çš„åˆå§‹åŒ–é¡ºåº\"></a>ç¤ºä¾‹1ï¼šæµ‹è¯•å•ç±»çš„åˆå§‹åŒ–é¡ºåº</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">public class ClassInitOrderTest &#123;\n\n\tpublic static String staticField &#x3D; &quot;static field&quot;;\n\n\tstatic &#123;\n\t\tSystem.out.println(staticField);\n\t\tSystem.out.println(&quot;static block&quot;);\n\t&#125;\n\n\tprivate String field &#x3D; &quot;member field&quot;;\n\n\t&#123;\n\t\tSystem.out.println(field);\n\t\tSystem.out.println(&quot;non-static block&quot;);\n\t&#125;\n\n\tpublic ClassInitOrderTest() &#123;\n\t\tSystem.out.println(&quot;constructor&quot;);\n\t&#125;\n\n\tpublic static void main(String[] args) &#123;\n\t\tnew ClassInitOrderTest();\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">static field\nstatic block\nmember field\nnon-static block\nconstructor<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼Œå•ç±»çš„åˆå§‹åŒ–é¡ºåºä¸ºï¼š</p>\n<blockquote>\n<p><strong>é™æ€å˜é‡ &gt; é™æ€åˆå§‹å— &gt; æˆå‘˜å˜é‡ &gt; éé™æ€åˆå§‹å— &gt; æ„é€ å™¨</strong></p>\n</blockquote>\n<h4 id=\"ç¤ºä¾‹2ï¼šæµ‹è¯•ç±»ç»§æ‰¿çš„åˆå§‹åŒ–é¡ºåº\"><a href=\"#ç¤ºä¾‹2ï¼šæµ‹è¯•ç±»ç»§æ‰¿çš„åˆå§‹åŒ–é¡ºåº\" class=\"headerlink\" title=\"ç¤ºä¾‹2ï¼šæµ‹è¯•ç±»ç»§æ‰¿çš„åˆå§‹åŒ–é¡ºåº\"></a>ç¤ºä¾‹2ï¼šæµ‹è¯•ç±»ç»§æ‰¿çš„åˆå§‹åŒ–é¡ºåº</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">class Parent &#123;\n\n\tprivate static String parentStaticField &#x3D; &quot;parent static field&quot;;\n\n\tstatic &#123;\n\t\tSystem.out.println(parentStaticField);\n\t\tSystem.out.println(&quot;parent static block&quot;);\n\t&#125;\n\n\tprivate String parentField &#x3D; &quot;parent member field&quot;;\n\n\t&#123;\n\t\tSystem.out.println(parentField);\n\t\tSystem.out.println(&quot;parent non-static block&quot;);\n\t&#125;\n\n\tpublic Parent() &#123;\n\t\tSystem.out.println(&quot;parent constructor&quot;);\n\t&#125;\n\n&#125;\n\npublic class Child extends Parent &#123;\n\n\tprivate static String childStaticField &#x3D; &quot;child static field&quot;;\n\n\tstatic &#123;\n\t\tSystem.out.println(childStaticField);\n\t\tSystem.out.println(&quot;child static block&quot;);\n\t&#125;\n\n\tprivate String childField &#x3D; &quot;child member field&quot;;\n\n\t&#123;\n\t\tSystem.out.println(childField);\n\t\tSystem.out.println(&quot;child non-static block&quot;);\n\t&#125;\n\n\tpublic Child() &#123;\n\t\tSystem.out.println(&quot;child constructor&quot;);\n\t&#125;\n\n\tpublic static void main(String[] args) &#123;\n\t\tnew Child();\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">parent static field\nparent static block\nchild static field\nchild static block\nparent member field\nparent non-static block\nparent constructor\nchild member field\nchild non-static block\nchild constructor<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼Œå•ç±»çš„åˆå§‹åŒ–é¡ºåºä¸ºï¼š</p>\n<blockquote>\n<p><strong>çˆ¶ç±»é™æ€å˜é‡ &gt; çˆ¶ç±»é™æ€åˆå§‹å— &gt; å­ç±»é™æ€å˜é‡ &gt; å­ç±»é™æ€åˆå§‹å— &gt; çˆ¶ç±»æˆå‘˜å˜é‡ &gt; çˆ¶ç±»éé™æ€åˆå§‹å— &gt; çˆ¶ç±»æ„é€ å™¨ &gt; å­ç±»æˆå‘˜å˜é‡ &gt; å­ç±»éé™æ€åˆå§‹å— &gt; å­ç±»æ„é€ å™¨</strong></p>\n</blockquote>\n<h4 id=\"ç¤ºä¾‹3ï¼šæµ‹è¯•æˆå‘˜å˜é‡ã€åˆå§‹å—çš„åˆå§‹åŒ–é¡ºåº\"><a href=\"#ç¤ºä¾‹3ï¼šæµ‹è¯•æˆå‘˜å˜é‡ã€åˆå§‹å—çš„åˆå§‹åŒ–é¡ºåº\" class=\"headerlink\" title=\"ç¤ºä¾‹3ï¼šæµ‹è¯•æˆå‘˜å˜é‡ã€åˆå§‹å—çš„åˆå§‹åŒ–é¡ºåº\"></a>ç¤ºä¾‹3ï¼šæµ‹è¯•æˆå‘˜å˜é‡ã€åˆå§‹å—çš„åˆå§‹åŒ–é¡ºåº</h4><p>ä»ä¸Šé¢ä¸¤ä¸ªä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œçˆ¶ç±»çš„é™æ€å˜é‡å’Œé™æ€åˆå§‹å—è‚¯å®šæ˜¯å…ˆäºå­ç±»åŠ è½½çš„ã€‚ä½†åŒä¸€ä¸ªç±»ä¸­çš„é™æ€å˜é‡ä¸é™æ€åˆå§‹å—ä¹‹é—´ï¼Œæˆå‘˜å˜é‡ä¸åˆå§‹å—ä¹‹é—´çš„é¡ºåºä¸€å®šæ˜¯å˜é‡å…ˆäºåˆå§‹å—å—ï¼Ÿç»§ç»­æ¼”ç¤ºï¼</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class TestOrder &#123;\n\n\tprivate static A a &#x3D; new A();\n\n\tstatic &#123;\n\t\tSystem.out.println(&quot;static block&quot;);\n\t&#125;\n\n\tprivate static B b &#x3D; new B();\n\n\tpublic static void main(String[] args) &#123;\n\t\tnew TestOrder();\n\t&#125;\n\n&#125;\n\nclass A &#123;\n\tpublic A() &#123;\n\t\tSystem.out.println(&quot;static field A&quot;);\n\t&#125;\n&#125;\n\nclass B &#123;\n\tpublic B() &#123;\n\t\tSystem.out.println(&quot;static field B&quot;);\n\t&#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">static field A\nstatic block\nstatic field B<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼Œå•ç±»çš„åˆå§‹åŒ–é¡ºåºä¸ºï¼š</p>\n<blockquote>\n<p><strong>é™æ€å˜é‡A &gt; é™æ€åˆå§‹å— &gt; é™æ€å˜é‡B</strong></p>\n</blockquote>\n<p>æ‰€ä»¥ï¼Œå®ƒä»¬çš„åœ¨ç±»ä¸­çš„é¡ºåºå°±å†³å®šäº†å®ƒä»¬çš„åˆå§‹åŒ–é¡ºåºï¼Œè€Œä¸æ˜¯å˜é‡ä¸€å®šä¼šä¼˜å…ˆäºåˆå§‹å—ã€‚</p>\n","excerpt":"","more":"<p>æœ€è¿‘å‘ç°å¾®ä¿¡ç¾¤é‡Œé¢æœ‰äº›ç¾¤å‹åœ¨è®¨è®ºç±»çš„åˆå§‹åŒ–é¡ºåºï¼Œå¦‚ç±»çš„é™æ€å˜é‡ã€æˆå‘˜å˜é‡ã€é™æ€ä»£ç å—ã€éé™æ€ä»£ç å—ã€æ„é€ å™¨ï¼ŒåŠç»§æ‰¿çˆ¶ç±»æ—¶ï¼Œå®ƒä»¬çš„åˆå§‹åŒ–é¡ºåºéƒ½æ˜¯æ€æ ·çš„ï¼Œä¸‹é¢æˆ‘é€šè¿‡ä¾‹å­æ¥è¯´æ˜è¿™ä¸ªæƒ…å†µï¼Œä»¥å…è¢«äººè¯¯å¯¼ã€‚</p>\n<h4 id=\"ç¤ºä¾‹1ï¼šæµ‹è¯•å•ç±»çš„åˆå§‹åŒ–é¡ºåº\"><a href=\"#ç¤ºä¾‹1ï¼šæµ‹è¯•å•ç±»çš„åˆå§‹åŒ–é¡ºåº\" class=\"headerlink\" title=\"ç¤ºä¾‹1ï¼šæµ‹è¯•å•ç±»çš„åˆå§‹åŒ–é¡ºåº\"></a>ç¤ºä¾‹1ï¼šæµ‹è¯•å•ç±»çš„åˆå§‹åŒ–é¡ºåº</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">public class ClassInitOrderTest &#123;\n\n\tpublic static String staticField &#x3D; &quot;static field&quot;;\n\n\tstatic &#123;\n\t\tSystem.out.println(staticField);\n\t\tSystem.out.println(&quot;static block&quot;);\n\t&#125;\n\n\tprivate String field &#x3D; &quot;member field&quot;;\n\n\t&#123;\n\t\tSystem.out.println(field);\n\t\tSystem.out.println(&quot;non-static block&quot;);\n\t&#125;\n\n\tpublic ClassInitOrderTest() &#123;\n\t\tSystem.out.println(&quot;constructor&quot;);\n\t&#125;\n\n\tpublic static void main(String[] args) &#123;\n\t\tnew ClassInitOrderTest();\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">static field\nstatic block\nmember field\nnon-static block\nconstructor<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼Œå•ç±»çš„åˆå§‹åŒ–é¡ºåºä¸ºï¼š</p>\n<blockquote>\n<p><strong>é™æ€å˜é‡ &gt; é™æ€åˆå§‹å— &gt; æˆå‘˜å˜é‡ &gt; éé™æ€åˆå§‹å— &gt; æ„é€ å™¨</strong></p>\n</blockquote>\n<h4 id=\"ç¤ºä¾‹2ï¼šæµ‹è¯•ç±»ç»§æ‰¿çš„åˆå§‹åŒ–é¡ºåº\"><a href=\"#ç¤ºä¾‹2ï¼šæµ‹è¯•ç±»ç»§æ‰¿çš„åˆå§‹åŒ–é¡ºåº\" class=\"headerlink\" title=\"ç¤ºä¾‹2ï¼šæµ‹è¯•ç±»ç»§æ‰¿çš„åˆå§‹åŒ–é¡ºåº\"></a>ç¤ºä¾‹2ï¼šæµ‹è¯•ç±»ç»§æ‰¿çš„åˆå§‹åŒ–é¡ºåº</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">class Parent &#123;\n\n\tprivate static String parentStaticField &#x3D; &quot;parent static field&quot;;\n\n\tstatic &#123;\n\t\tSystem.out.println(parentStaticField);\n\t\tSystem.out.println(&quot;parent static block&quot;);\n\t&#125;\n\n\tprivate String parentField &#x3D; &quot;parent member field&quot;;\n\n\t&#123;\n\t\tSystem.out.println(parentField);\n\t\tSystem.out.println(&quot;parent non-static block&quot;);\n\t&#125;\n\n\tpublic Parent() &#123;\n\t\tSystem.out.println(&quot;parent constructor&quot;);\n\t&#125;\n\n&#125;\n\npublic class Child extends Parent &#123;\n\n\tprivate static String childStaticField &#x3D; &quot;child static field&quot;;\n\n\tstatic &#123;\n\t\tSystem.out.println(childStaticField);\n\t\tSystem.out.println(&quot;child static block&quot;);\n\t&#125;\n\n\tprivate String childField &#x3D; &quot;child member field&quot;;\n\n\t&#123;\n\t\tSystem.out.println(childField);\n\t\tSystem.out.println(&quot;child non-static block&quot;);\n\t&#125;\n\n\tpublic Child() &#123;\n\t\tSystem.out.println(&quot;child constructor&quot;);\n\t&#125;\n\n\tpublic static void main(String[] args) &#123;\n\t\tnew Child();\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">parent static field\nparent static block\nchild static field\nchild static block\nparent member field\nparent non-static block\nparent constructor\nchild member field\nchild non-static block\nchild constructor<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼Œå•ç±»çš„åˆå§‹åŒ–é¡ºåºä¸ºï¼š</p>\n<blockquote>\n<p><strong>çˆ¶ç±»é™æ€å˜é‡ &gt; çˆ¶ç±»é™æ€åˆå§‹å— &gt; å­ç±»é™æ€å˜é‡ &gt; å­ç±»é™æ€åˆå§‹å— &gt; çˆ¶ç±»æˆå‘˜å˜é‡ &gt; çˆ¶ç±»éé™æ€åˆå§‹å— &gt; çˆ¶ç±»æ„é€ å™¨ &gt; å­ç±»æˆå‘˜å˜é‡ &gt; å­ç±»éé™æ€åˆå§‹å— &gt; å­ç±»æ„é€ å™¨</strong></p>\n</blockquote>\n<h4 id=\"ç¤ºä¾‹3ï¼šæµ‹è¯•æˆå‘˜å˜é‡ã€åˆå§‹å—çš„åˆå§‹åŒ–é¡ºåº\"><a href=\"#ç¤ºä¾‹3ï¼šæµ‹è¯•æˆå‘˜å˜é‡ã€åˆå§‹å—çš„åˆå§‹åŒ–é¡ºåº\" class=\"headerlink\" title=\"ç¤ºä¾‹3ï¼šæµ‹è¯•æˆå‘˜å˜é‡ã€åˆå§‹å—çš„åˆå§‹åŒ–é¡ºåº\"></a>ç¤ºä¾‹3ï¼šæµ‹è¯•æˆå‘˜å˜é‡ã€åˆå§‹å—çš„åˆå§‹åŒ–é¡ºåº</h4><p>ä»ä¸Šé¢ä¸¤ä¸ªä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œçˆ¶ç±»çš„é™æ€å˜é‡å’Œé™æ€åˆå§‹å—è‚¯å®šæ˜¯å…ˆäºå­ç±»åŠ è½½çš„ã€‚ä½†åŒä¸€ä¸ªç±»ä¸­çš„é™æ€å˜é‡ä¸é™æ€åˆå§‹å—ä¹‹é—´ï¼Œæˆå‘˜å˜é‡ä¸åˆå§‹å—ä¹‹é—´çš„é¡ºåºä¸€å®šæ˜¯å˜é‡å…ˆäºåˆå§‹å—å—ï¼Ÿç»§ç»­æ¼”ç¤ºï¼</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class TestOrder &#123;\n\n\tprivate static A a &#x3D; new A();\n\n\tstatic &#123;\n\t\tSystem.out.println(&quot;static block&quot;);\n\t&#125;\n\n\tprivate static B b &#x3D; new B();\n\n\tpublic static void main(String[] args) &#123;\n\t\tnew TestOrder();\n\t&#125;\n\n&#125;\n\nclass A &#123;\n\tpublic A() &#123;\n\t\tSystem.out.println(&quot;static field A&quot;);\n\t&#125;\n&#125;\n\nclass B &#123;\n\tpublic B() &#123;\n\t\tSystem.out.println(&quot;static field B&quot;);\n\t&#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">static field A\nstatic block\nstatic field B<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼Œå•ç±»çš„åˆå§‹åŒ–é¡ºåºä¸ºï¼š</p>\n<blockquote>\n<p><strong>é™æ€å˜é‡A &gt; é™æ€åˆå§‹å— &gt; é™æ€å˜é‡B</strong></p>\n</blockquote>\n<p>æ‰€ä»¥ï¼Œå®ƒä»¬çš„åœ¨ç±»ä¸­çš„é¡ºåºå°±å†³å®šäº†å®ƒä»¬çš„åˆå§‹åŒ–é¡ºåºï¼Œè€Œä¸æ˜¯å˜é‡ä¸€å®šä¼šä¼˜å…ˆäºåˆå§‹å—ã€‚</p>\n"},{"title":"Java è‡ªå®šä¹‰ ClassLoader å®æˆ˜","date":"2025-10-15T03:36:33.000Z","_content":"\nå‡å¦‚æˆ‘ä»¬çš„ç±»ä¸åœ¨classpathä¸‹ï¼Œè€Œæˆ‘ä»¬åˆæƒ³è¯»å–ä¸€ä¸ªè‡ªå®šä¹‰çš„ç›®å½•ä¸‹çš„classï¼Œå¦‚æœåšå‘¢ï¼Ÿ\n\n## è¯»å–è‡ªå®šä¹‰ç›®å½•çš„ç±»\n\nç¤ºä¾‹è¯»å–c:/test/com/test.jdk/Key.classè¿™ä¸ªç±»ã€‚\n\n```\npackage com.test.jdk;\n\npublic class Key {\n    private String key = \"111111\";\n}\n```\n\n## è‡ªå®šä¹‰ClassLoader\n\n```\nimport org.apache.commons.io.IOUtils;\n\nimport java.io.FileInputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\n\npublic class LocalClassLoader extends ClassLoader {\n\n    private String path = \"c:/test/\";\n\n    @Override\n    protected Class<?> findClass(String name) throws ClassNotFoundException {\n        Class<?> cls = findLoadedClass(name);\n        if (cls != null) {\n            return cls;\n        }\n\n        if (!name.endsWith(\".Key\")) {\n            return super.loadClass(name);\n        }\n\n        try {\n            InputStream is = new FileInputStream(path + name.replace(\".\", \"/\") + \".class\");\n            byte[] bytes = IOUtils.toByteArray(is);\n            return defineClass(name, bytes, 0, bytes.length);\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n\n        return super.loadClass(name);\n    }\n}\n```\n\n## å¼€å§‹è¯»å–ç±»\n\n```\npublic static void main(String[] args) {\n    try {\n        LocalClassLoader lcl = new LocalClassLoader();\n        Class<?> cls = lcl.loadClass(\"com.test.jdk.Key\");\n        Field field = FieldUtils.getField(cls, \"key\", true);\n        Object value = field.get(cls.newInstance());\n        System.out.println(value);\n    } catch (Exception e) {\n        e.printStackTrace();\n    }\n}\n```\nè‡ªå®šä¹‰ç±»åŠ è½½å™¨æ­£å¸¸åŠ è½½åˆ°ç±»ï¼Œç¨‹åºæœ€åè¾“å‡ºï¼š111111\n\n## URLClassLoader\n\nä¸Šé¢è‡ªå®šä¹‰ä¸€ä¸ªç±»åŠ è½½å™¨æ¥è¯»å–è‡ªå®šä¹‰çš„ç›®å½•ï¼Œå…¶å®å¯ä»¥ç›´æ¥ä½¿ç”¨URLClassLoaderå°±èƒ½è¯»å–ï¼Œå®ƒå·²ç»å®ç°äº†è·¯å¾„ä¸‹ç±»çš„è¯»å–é€»è¾‘ã€‚\n\n```\npublic static void main(String[] args) {\n    try {\n        URLClassLoader ucl = new URLClassLoader(new URL[]{new URL(\"c:/test/\")});\n        Class<?> cls = ucl.loadClass(\"com.test.jdk.Key\");\n        Field field = FieldUtils.getField(cls, \"key\", true);\n        Object value = field.get(cls.newInstance());\n        System.out.println(value);\n    } catch (Exception e) {\n        e.printStackTrace();\n    }\n}\n```\n\n","source":"_posts/è¿›é˜¶/Java è‡ªå®šä¹‰ ClassLoader å®æˆ˜.md","raw":"---\ntitle: Java è‡ªå®šä¹‰ ClassLoader å®æˆ˜\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: è¿›é˜¶\n---\n\nå‡å¦‚æˆ‘ä»¬çš„ç±»ä¸åœ¨classpathä¸‹ï¼Œè€Œæˆ‘ä»¬åˆæƒ³è¯»å–ä¸€ä¸ªè‡ªå®šä¹‰çš„ç›®å½•ä¸‹çš„classï¼Œå¦‚æœåšå‘¢ï¼Ÿ\n\n## è¯»å–è‡ªå®šä¹‰ç›®å½•çš„ç±»\n\nç¤ºä¾‹è¯»å–c:/test/com/test.jdk/Key.classè¿™ä¸ªç±»ã€‚\n\n```\npackage com.test.jdk;\n\npublic class Key {\n    private String key = \"111111\";\n}\n```\n\n## è‡ªå®šä¹‰ClassLoader\n\n```\nimport org.apache.commons.io.IOUtils;\n\nimport java.io.FileInputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\n\npublic class LocalClassLoader extends ClassLoader {\n\n    private String path = \"c:/test/\";\n\n    @Override\n    protected Class<?> findClass(String name) throws ClassNotFoundException {\n        Class<?> cls = findLoadedClass(name);\n        if (cls != null) {\n            return cls;\n        }\n\n        if (!name.endsWith(\".Key\")) {\n            return super.loadClass(name);\n        }\n\n        try {\n            InputStream is = new FileInputStream(path + name.replace(\".\", \"/\") + \".class\");\n            byte[] bytes = IOUtils.toByteArray(is);\n            return defineClass(name, bytes, 0, bytes.length);\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n\n        return super.loadClass(name);\n    }\n}\n```\n\n## å¼€å§‹è¯»å–ç±»\n\n```\npublic static void main(String[] args) {\n    try {\n        LocalClassLoader lcl = new LocalClassLoader();\n        Class<?> cls = lcl.loadClass(\"com.test.jdk.Key\");\n        Field field = FieldUtils.getField(cls, \"key\", true);\n        Object value = field.get(cls.newInstance());\n        System.out.println(value);\n    } catch (Exception e) {\n        e.printStackTrace();\n    }\n}\n```\nè‡ªå®šä¹‰ç±»åŠ è½½å™¨æ­£å¸¸åŠ è½½åˆ°ç±»ï¼Œç¨‹åºæœ€åè¾“å‡ºï¼š111111\n\n## URLClassLoader\n\nä¸Šé¢è‡ªå®šä¹‰ä¸€ä¸ªç±»åŠ è½½å™¨æ¥è¯»å–è‡ªå®šä¹‰çš„ç›®å½•ï¼Œå…¶å®å¯ä»¥ç›´æ¥ä½¿ç”¨URLClassLoaderå°±èƒ½è¯»å–ï¼Œå®ƒå·²ç»å®ç°äº†è·¯å¾„ä¸‹ç±»çš„è¯»å–é€»è¾‘ã€‚\n\n```\npublic static void main(String[] args) {\n    try {\n        URLClassLoader ucl = new URLClassLoader(new URL[]{new URL(\"c:/test/\")});\n        Class<?> cls = ucl.loadClass(\"com.test.jdk.Key\");\n        Field field = FieldUtils.getField(cls, \"key\", true);\n        Object value = field.get(cls.newInstance());\n        System.out.println(value);\n    } catch (Exception e) {\n        e.printStackTrace();\n    }\n}\n```\n\n","slug":"è¿›é˜¶/Java è‡ªå®šä¹‰ ClassLoader å®æˆ˜","published":1,"updated":"2025-10-15T07:21:14.287Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076g000wqkd417w28zfm","content":"<p>å‡å¦‚æˆ‘ä»¬çš„ç±»ä¸åœ¨classpathä¸‹ï¼Œè€Œæˆ‘ä»¬åˆæƒ³è¯»å–ä¸€ä¸ªè‡ªå®šä¹‰çš„ç›®å½•ä¸‹çš„classï¼Œå¦‚æœåšå‘¢ï¼Ÿ</p>\n<h2 id=\"è¯»å–è‡ªå®šä¹‰ç›®å½•çš„ç±»\"><a href=\"#è¯»å–è‡ªå®šä¹‰ç›®å½•çš„ç±»\" class=\"headerlink\" title=\"è¯»å–è‡ªå®šä¹‰ç›®å½•çš„ç±»\"></a>è¯»å–è‡ªå®šä¹‰ç›®å½•çš„ç±»</h2><p>ç¤ºä¾‹è¯»å–c:&#x2F;test&#x2F;com&#x2F;test.jdk&#x2F;Key.classè¿™ä¸ªç±»ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">package com.test.jdk;\n\npublic class Key &#123;\n    private String key &#x3D; &quot;111111&quot;;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"è‡ªå®šä¹‰ClassLoader\"><a href=\"#è‡ªå®šä¹‰ClassLoader\" class=\"headerlink\" title=\"è‡ªå®šä¹‰ClassLoader\"></a>è‡ªå®šä¹‰ClassLoader</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">import org.apache.commons.io.IOUtils;\n\nimport java.io.FileInputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\n\npublic class LocalClassLoader extends ClassLoader &#123;\n\n    private String path &#x3D; &quot;c:&#x2F;test&#x2F;&quot;;\n\n    @Override\n    protected Class&lt;?&gt; findClass(String name) throws ClassNotFoundException &#123;\n        Class&lt;?&gt; cls &#x3D; findLoadedClass(name);\n        if (cls !&#x3D; null) &#123;\n            return cls;\n        &#125;\n\n        if (!name.endsWith(&quot;.Key&quot;)) &#123;\n            return super.loadClass(name);\n        &#125;\n\n        try &#123;\n            InputStream is &#x3D; new FileInputStream(path + name.replace(&quot;.&quot;, &quot;&#x2F;&quot;) + &quot;.class&quot;);\n            byte[] bytes &#x3D; IOUtils.toByteArray(is);\n            return defineClass(name, bytes, 0, bytes.length);\n        &#125; catch (IOException e) &#123;\n            e.printStackTrace();\n        &#125;\n\n        return super.loadClass(name);\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"å¼€å§‹è¯»å–ç±»\"><a href=\"#å¼€å§‹è¯»å–ç±»\" class=\"headerlink\" title=\"å¼€å§‹è¯»å–ç±»\"></a>å¼€å§‹è¯»å–ç±»</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n    try &#123;\n        LocalClassLoader lcl &#x3D; new LocalClassLoader();\n        Class&lt;?&gt; cls &#x3D; lcl.loadClass(&quot;com.test.jdk.Key&quot;);\n        Field field &#x3D; FieldUtils.getField(cls, &quot;key&quot;, true);\n        Object value &#x3D; field.get(cls.newInstance());\n        System.out.println(value);\n    &#125; catch (Exception e) &#123;\n        e.printStackTrace();\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>è‡ªå®šä¹‰ç±»åŠ è½½å™¨æ­£å¸¸åŠ è½½åˆ°ç±»ï¼Œç¨‹åºæœ€åè¾“å‡ºï¼š111111</p>\n<h2 id=\"URLClassLoader\"><a href=\"#URLClassLoader\" class=\"headerlink\" title=\"URLClassLoader\"></a>URLClassLoader</h2><p>ä¸Šé¢è‡ªå®šä¹‰ä¸€ä¸ªç±»åŠ è½½å™¨æ¥è¯»å–è‡ªå®šä¹‰çš„ç›®å½•ï¼Œå…¶å®å¯ä»¥ç›´æ¥ä½¿ç”¨URLClassLoaderå°±èƒ½è¯»å–ï¼Œå®ƒå·²ç»å®ç°äº†è·¯å¾„ä¸‹ç±»çš„è¯»å–é€»è¾‘ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n    try &#123;\n        URLClassLoader ucl &#x3D; new URLClassLoader(new URL[]&#123;new URL(&quot;c:&#x2F;test&#x2F;&quot;)&#125;);\n        Class&lt;?&gt; cls &#x3D; ucl.loadClass(&quot;com.test.jdk.Key&quot;);\n        Field field &#x3D; FieldUtils.getField(cls, &quot;key&quot;, true);\n        Object value &#x3D; field.get(cls.newInstance());\n        System.out.println(value);\n    &#125; catch (Exception e) &#123;\n        e.printStackTrace();\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n","excerpt":"","more":"<p>å‡å¦‚æˆ‘ä»¬çš„ç±»ä¸åœ¨classpathä¸‹ï¼Œè€Œæˆ‘ä»¬åˆæƒ³è¯»å–ä¸€ä¸ªè‡ªå®šä¹‰çš„ç›®å½•ä¸‹çš„classï¼Œå¦‚æœåšå‘¢ï¼Ÿ</p>\n<h2 id=\"è¯»å–è‡ªå®šä¹‰ç›®å½•çš„ç±»\"><a href=\"#è¯»å–è‡ªå®šä¹‰ç›®å½•çš„ç±»\" class=\"headerlink\" title=\"è¯»å–è‡ªå®šä¹‰ç›®å½•çš„ç±»\"></a>è¯»å–è‡ªå®šä¹‰ç›®å½•çš„ç±»</h2><p>ç¤ºä¾‹è¯»å–c:&#x2F;test&#x2F;com&#x2F;test.jdk&#x2F;Key.classè¿™ä¸ªç±»ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">package com.test.jdk;\n\npublic class Key &#123;\n    private String key &#x3D; &quot;111111&quot;;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"è‡ªå®šä¹‰ClassLoader\"><a href=\"#è‡ªå®šä¹‰ClassLoader\" class=\"headerlink\" title=\"è‡ªå®šä¹‰ClassLoader\"></a>è‡ªå®šä¹‰ClassLoader</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">import org.apache.commons.io.IOUtils;\n\nimport java.io.FileInputStream;\nimport java.io.IOException;\nimport java.io.InputStream;\n\npublic class LocalClassLoader extends ClassLoader &#123;\n\n    private String path &#x3D; &quot;c:&#x2F;test&#x2F;&quot;;\n\n    @Override\n    protected Class&lt;?&gt; findClass(String name) throws ClassNotFoundException &#123;\n        Class&lt;?&gt; cls &#x3D; findLoadedClass(name);\n        if (cls !&#x3D; null) &#123;\n            return cls;\n        &#125;\n\n        if (!name.endsWith(&quot;.Key&quot;)) &#123;\n            return super.loadClass(name);\n        &#125;\n\n        try &#123;\n            InputStream is &#x3D; new FileInputStream(path + name.replace(&quot;.&quot;, &quot;&#x2F;&quot;) + &quot;.class&quot;);\n            byte[] bytes &#x3D; IOUtils.toByteArray(is);\n            return defineClass(name, bytes, 0, bytes.length);\n        &#125; catch (IOException e) &#123;\n            e.printStackTrace();\n        &#125;\n\n        return super.loadClass(name);\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"å¼€å§‹è¯»å–ç±»\"><a href=\"#å¼€å§‹è¯»å–ç±»\" class=\"headerlink\" title=\"å¼€å§‹è¯»å–ç±»\"></a>å¼€å§‹è¯»å–ç±»</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n    try &#123;\n        LocalClassLoader lcl &#x3D; new LocalClassLoader();\n        Class&lt;?&gt; cls &#x3D; lcl.loadClass(&quot;com.test.jdk.Key&quot;);\n        Field field &#x3D; FieldUtils.getField(cls, &quot;key&quot;, true);\n        Object value &#x3D; field.get(cls.newInstance());\n        System.out.println(value);\n    &#125; catch (Exception e) &#123;\n        e.printStackTrace();\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>è‡ªå®šä¹‰ç±»åŠ è½½å™¨æ­£å¸¸åŠ è½½åˆ°ç±»ï¼Œç¨‹åºæœ€åè¾“å‡ºï¼š111111</p>\n<h2 id=\"URLClassLoader\"><a href=\"#URLClassLoader\" class=\"headerlink\" title=\"URLClassLoader\"></a>URLClassLoader</h2><p>ä¸Šé¢è‡ªå®šä¹‰ä¸€ä¸ªç±»åŠ è½½å™¨æ¥è¯»å–è‡ªå®šä¹‰çš„ç›®å½•ï¼Œå…¶å®å¯ä»¥ç›´æ¥ä½¿ç”¨URLClassLoaderå°±èƒ½è¯»å–ï¼Œå®ƒå·²ç»å®ç°äº†è·¯å¾„ä¸‹ç±»çš„è¯»å–é€»è¾‘ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n    try &#123;\n        URLClassLoader ucl &#x3D; new URLClassLoader(new URL[]&#123;new URL(&quot;c:&#x2F;test&#x2F;&quot;)&#125;);\n        Class&lt;?&gt; cls &#x3D; ucl.loadClass(&quot;com.test.jdk.Key&quot;);\n        Field field &#x3D; FieldUtils.getField(cls, &quot;key&quot;, true);\n        Object value &#x3D; field.get(cls.newInstance());\n        System.out.println(value);\n    &#125; catch (Exception e) &#123;\n        e.printStackTrace();\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n"},{"title":"hashCode å’Œ identityHashCode çš„åŒºåˆ«ä½ çŸ¥é“å—ï¼Ÿ","date":"2025-10-15T03:36:33.000Z","_content":"\n## hashCode\n\nå…³äºhashCodeå‚è€ƒä¹‹å‰çš„æ–‡ç« ï¼Œ[ç‚¹å‡»](https://mp.weixin.qq.com/s?__biz=MzI3ODcxMzQzMw==&mid=2247483797&idx=1&sn=e3bb47b13d0c3f25341470a0ce598752&chksm=eb5384a3dc240db5e6378dc5160fa01fd10569ffb5f95f5d5daa4589c3308515139b29e2b314#rd)å‚è€ƒä¹‹å‰æ–‡ç« ã€‚\n\n## identityHashCode\n\nidentityHashCodeæ˜¯Systemé‡Œé¢æä¾›çš„æœ¬åœ°æ–¹æ³•ï¼Œjava.lang.System#identityHashCodeã€‚\n\n```\n/**\n * Returns the same hash code for the given object as\n * would be returned by the default method hashCode(),\n * whether or not the given object's class overrides\n * hashCode().\n * The hash code for the null reference is zero.\n *\n * @param x object for which the hashCode is to be calculated\n * @return  the hashCode\n * @since   JDK1.1\n */\npublic static native int identityHashCode(Object x);\n```\n\nidentityHashCodeå’ŒhashCodeçš„åŒºåˆ«æ˜¯ï¼ŒidentityHashCodeä¼šè¿”å›å¯¹è±¡çš„hashCodeï¼Œè€Œä¸ç®¡å¯¹è±¡æ˜¯å¦é‡å†™äº†hashCodeæ–¹æ³•ã€‚\n\n## ç¤ºä¾‹\n\n\n```\npublic static void main(String[] args) {\n\tString str1 = new String(\"abc\");\n\tString str2 = new String(\"abc\");\n\tSystem.out.println(\"str1 hashCode: \" + str1.hashCode());\n\tSystem.out.println(\"str2 hashCode: \" + str2.hashCode());\n\tSystem.out.println(\"str1 identityHashCode: \" + System.identityHashCode(str1));\n\tSystem.out.println(\"str2 identityHashCode: \" + System.identityHashCode(str2));\n\n\tUser user = new User(\"test\", 1);\n\tSystem.out.println(\"user hashCode: \" + user.hashCode());\n\tSystem.out.println(\"user identityHashCode: \" + System.identityHashCode(user));\n}\n```\n\nè¾“å‡ºç»“æœï¼š\n\n```\nstr1 hashCode: 96354\nstr2 hashCode: 96354\nstr1 identityHashCode: 1173230247\nstr2 identityHashCode: 856419764\nuser hashCode: 621009875\nuser identityHashCode: 621009875\n```\n\nç»“æœåˆ†æï¼š\n\n1ã€str1å’Œstr2çš„hashCodeæ˜¯ç›¸åŒçš„ï¼Œæ˜¯å› ä¸ºStringç±»é‡å†™äº†hashCodeæ–¹æ³•ï¼Œå®ƒæ ¹æ®Stringçš„å€¼æ¥ç¡®å®šhashCodeçš„å€¼ï¼Œæ‰€ä»¥åªè¦å€¼ä¸€æ ·ï¼ŒhashCodeå°±ä¼šä¸€æ ·ã€‚\n\n2ã€str1å’Œstr2çš„identityHashCodeä¸ä¸€æ ·ï¼Œè™½ç„¶Stringé‡å†™äº†hashCodeæ–¹æ³•ï¼ŒidentityHashCodeæ°¸è¿œè¿”å›æ ¹æ®å¯¹è±¡ç‰©ç†å†…å­˜åœ°å€äº§ç”Ÿçš„hashå€¼ï¼Œæ‰€ä»¥æ¯ä¸ªStringå¯¹è±¡çš„ç‰©ç†åœ°å€ä¸ä¸€æ ·ï¼ŒidentityHashCodeä¹Ÿä¼šä¸ä¸€æ ·ã€‚\n\n3ã€Userå¯¹è±¡æ²¡é‡å†™hashCodeæ–¹æ³•ï¼Œæ‰€ä»¥hashCodeå’ŒidentityHashCodeè¿”å›çš„å€¼ä¸€æ ·ã€‚\n\n## ç»“è®º\n\nhashCodeæ–¹æ³•å¯ä»¥è¢«é‡å†™å¹¶è¿”å›é‡å†™åçš„å€¼ï¼ŒidentityHashCodeä¼šè¿”å›å¯¹è±¡çš„hashå€¼è€Œä¸ç®¡å¯¹è±¡æ˜¯å¦é‡å†™äº†hashCodeæ–¹æ³•ã€‚\n\n","source":"_posts/è¿›é˜¶/hashCode å’Œ identityHashCode çš„åŒºåˆ«ä½ çŸ¥é“å—ï¼Ÿ.md","raw":"---\ntitle: hashCode å’Œ identityHashCode çš„åŒºåˆ«ä½ çŸ¥é“å—ï¼Ÿ\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: è¿›é˜¶\n---\n\n## hashCode\n\nå…³äºhashCodeå‚è€ƒä¹‹å‰çš„æ–‡ç« ï¼Œ[ç‚¹å‡»](https://mp.weixin.qq.com/s?__biz=MzI3ODcxMzQzMw==&mid=2247483797&idx=1&sn=e3bb47b13d0c3f25341470a0ce598752&chksm=eb5384a3dc240db5e6378dc5160fa01fd10569ffb5f95f5d5daa4589c3308515139b29e2b314#rd)å‚è€ƒä¹‹å‰æ–‡ç« ã€‚\n\n## identityHashCode\n\nidentityHashCodeæ˜¯Systemé‡Œé¢æä¾›çš„æœ¬åœ°æ–¹æ³•ï¼Œjava.lang.System#identityHashCodeã€‚\n\n```\n/**\n * Returns the same hash code for the given object as\n * would be returned by the default method hashCode(),\n * whether or not the given object's class overrides\n * hashCode().\n * The hash code for the null reference is zero.\n *\n * @param x object for which the hashCode is to be calculated\n * @return  the hashCode\n * @since   JDK1.1\n */\npublic static native int identityHashCode(Object x);\n```\n\nidentityHashCodeå’ŒhashCodeçš„åŒºåˆ«æ˜¯ï¼ŒidentityHashCodeä¼šè¿”å›å¯¹è±¡çš„hashCodeï¼Œè€Œä¸ç®¡å¯¹è±¡æ˜¯å¦é‡å†™äº†hashCodeæ–¹æ³•ã€‚\n\n## ç¤ºä¾‹\n\n\n```\npublic static void main(String[] args) {\n\tString str1 = new String(\"abc\");\n\tString str2 = new String(\"abc\");\n\tSystem.out.println(\"str1 hashCode: \" + str1.hashCode());\n\tSystem.out.println(\"str2 hashCode: \" + str2.hashCode());\n\tSystem.out.println(\"str1 identityHashCode: \" + System.identityHashCode(str1));\n\tSystem.out.println(\"str2 identityHashCode: \" + System.identityHashCode(str2));\n\n\tUser user = new User(\"test\", 1);\n\tSystem.out.println(\"user hashCode: \" + user.hashCode());\n\tSystem.out.println(\"user identityHashCode: \" + System.identityHashCode(user));\n}\n```\n\nè¾“å‡ºç»“æœï¼š\n\n```\nstr1 hashCode: 96354\nstr2 hashCode: 96354\nstr1 identityHashCode: 1173230247\nstr2 identityHashCode: 856419764\nuser hashCode: 621009875\nuser identityHashCode: 621009875\n```\n\nç»“æœåˆ†æï¼š\n\n1ã€str1å’Œstr2çš„hashCodeæ˜¯ç›¸åŒçš„ï¼Œæ˜¯å› ä¸ºStringç±»é‡å†™äº†hashCodeæ–¹æ³•ï¼Œå®ƒæ ¹æ®Stringçš„å€¼æ¥ç¡®å®šhashCodeçš„å€¼ï¼Œæ‰€ä»¥åªè¦å€¼ä¸€æ ·ï¼ŒhashCodeå°±ä¼šä¸€æ ·ã€‚\n\n2ã€str1å’Œstr2çš„identityHashCodeä¸ä¸€æ ·ï¼Œè™½ç„¶Stringé‡å†™äº†hashCodeæ–¹æ³•ï¼ŒidentityHashCodeæ°¸è¿œè¿”å›æ ¹æ®å¯¹è±¡ç‰©ç†å†…å­˜åœ°å€äº§ç”Ÿçš„hashå€¼ï¼Œæ‰€ä»¥æ¯ä¸ªStringå¯¹è±¡çš„ç‰©ç†åœ°å€ä¸ä¸€æ ·ï¼ŒidentityHashCodeä¹Ÿä¼šä¸ä¸€æ ·ã€‚\n\n3ã€Userå¯¹è±¡æ²¡é‡å†™hashCodeæ–¹æ³•ï¼Œæ‰€ä»¥hashCodeå’ŒidentityHashCodeè¿”å›çš„å€¼ä¸€æ ·ã€‚\n\n## ç»“è®º\n\nhashCodeæ–¹æ³•å¯ä»¥è¢«é‡å†™å¹¶è¿”å›é‡å†™åçš„å€¼ï¼ŒidentityHashCodeä¼šè¿”å›å¯¹è±¡çš„hashå€¼è€Œä¸ç®¡å¯¹è±¡æ˜¯å¦é‡å†™äº†hashCodeæ–¹æ³•ã€‚\n\n","slug":"è¿›é˜¶/hashCode å’Œ identityHashCode çš„åŒºåˆ«ä½ çŸ¥é“å—ï¼Ÿ","published":1,"updated":"2025-10-15T07:21:14.277Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076h000zqkd4b9042yxp","content":"<h2 id=\"hashCode\"><a href=\"#hashCode\" class=\"headerlink\" title=\"hashCode\"></a>hashCode</h2><p>å…³äºhashCodeå‚è€ƒä¹‹å‰çš„æ–‡ç« ï¼Œ<a href=\"https://mp.weixin.qq.com/s?__biz=MzI3ODcxMzQzMw==&mid=2247483797&idx=1&sn=e3bb47b13d0c3f25341470a0ce598752&chksm=eb5384a3dc240db5e6378dc5160fa01fd10569ffb5f95f5d5daa4589c3308515139b29e2b314#rd\">ç‚¹å‡»</a>å‚è€ƒä¹‹å‰æ–‡ç« ã€‚</p>\n<h2 id=\"identityHashCode\"><a href=\"#identityHashCode\" class=\"headerlink\" title=\"identityHashCode\"></a>identityHashCode</h2><p>identityHashCodeæ˜¯Systemé‡Œé¢æä¾›çš„æœ¬åœ°æ–¹æ³•ï¼Œjava.lang.System#identityHashCodeã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * Returns the same hash code for the given object as\n * would be returned by the default method hashCode(),\n * whether or not the given object&#39;s class overrides\n * hashCode().\n * The hash code for the null reference is zero.\n *\n * @param x object for which the hashCode is to be calculated\n * @return  the hashCode\n * @since   JDK1.1\n *&#x2F;\npublic static native int identityHashCode(Object x);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>identityHashCodeå’ŒhashCodeçš„åŒºåˆ«æ˜¯ï¼ŒidentityHashCodeä¼šè¿”å›å¯¹è±¡çš„hashCodeï¼Œè€Œä¸ç®¡å¯¹è±¡æ˜¯å¦é‡å†™äº†hashCodeæ–¹æ³•ã€‚</p>\n<h2 id=\"ç¤ºä¾‹\"><a href=\"#ç¤ºä¾‹\" class=\"headerlink\" title=\"ç¤ºä¾‹\"></a>ç¤ºä¾‹</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n\tString str1 &#x3D; new String(&quot;abc&quot;);\n\tString str2 &#x3D; new String(&quot;abc&quot;);\n\tSystem.out.println(&quot;str1 hashCode: &quot; + str1.hashCode());\n\tSystem.out.println(&quot;str2 hashCode: &quot; + str2.hashCode());\n\tSystem.out.println(&quot;str1 identityHashCode: &quot; + System.identityHashCode(str1));\n\tSystem.out.println(&quot;str2 identityHashCode: &quot; + System.identityHashCode(str2));\n\n\tUser user &#x3D; new User(&quot;test&quot;, 1);\n\tSystem.out.println(&quot;user hashCode: &quot; + user.hashCode());\n\tSystem.out.println(&quot;user identityHashCode: &quot; + System.identityHashCode(user));\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¾“å‡ºç»“æœï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">str1 hashCode: 96354\nstr2 hashCode: 96354\nstr1 identityHashCode: 1173230247\nstr2 identityHashCode: 856419764\nuser hashCode: 621009875\nuser identityHashCode: 621009875<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç»“æœåˆ†æï¼š</p>\n<p>1ã€str1å’Œstr2çš„hashCodeæ˜¯ç›¸åŒçš„ï¼Œæ˜¯å› ä¸ºStringç±»é‡å†™äº†hashCodeæ–¹æ³•ï¼Œå®ƒæ ¹æ®Stringçš„å€¼æ¥ç¡®å®šhashCodeçš„å€¼ï¼Œæ‰€ä»¥åªè¦å€¼ä¸€æ ·ï¼ŒhashCodeå°±ä¼šä¸€æ ·ã€‚</p>\n<p>2ã€str1å’Œstr2çš„identityHashCodeä¸ä¸€æ ·ï¼Œè™½ç„¶Stringé‡å†™äº†hashCodeæ–¹æ³•ï¼ŒidentityHashCodeæ°¸è¿œè¿”å›æ ¹æ®å¯¹è±¡ç‰©ç†å†…å­˜åœ°å€äº§ç”Ÿçš„hashå€¼ï¼Œæ‰€ä»¥æ¯ä¸ªStringå¯¹è±¡çš„ç‰©ç†åœ°å€ä¸ä¸€æ ·ï¼ŒidentityHashCodeä¹Ÿä¼šä¸ä¸€æ ·ã€‚</p>\n<p>3ã€Userå¯¹è±¡æ²¡é‡å†™hashCodeæ–¹æ³•ï¼Œæ‰€ä»¥hashCodeå’ŒidentityHashCodeè¿”å›çš„å€¼ä¸€æ ·ã€‚</p>\n<h2 id=\"ç»“è®º\"><a href=\"#ç»“è®º\" class=\"headerlink\" title=\"ç»“è®º\"></a>ç»“è®º</h2><p>hashCodeæ–¹æ³•å¯ä»¥è¢«é‡å†™å¹¶è¿”å›é‡å†™åçš„å€¼ï¼ŒidentityHashCodeä¼šè¿”å›å¯¹è±¡çš„hashå€¼è€Œä¸ç®¡å¯¹è±¡æ˜¯å¦é‡å†™äº†hashCodeæ–¹æ³•ã€‚</p>\n","excerpt":"","more":"<h2 id=\"hashCode\"><a href=\"#hashCode\" class=\"headerlink\" title=\"hashCode\"></a>hashCode</h2><p>å…³äºhashCodeå‚è€ƒä¹‹å‰çš„æ–‡ç« ï¼Œ<a href=\"https://mp.weixin.qq.com/s?__biz=MzI3ODcxMzQzMw==&mid=2247483797&idx=1&sn=e3bb47b13d0c3f25341470a0ce598752&chksm=eb5384a3dc240db5e6378dc5160fa01fd10569ffb5f95f5d5daa4589c3308515139b29e2b314#rd\">ç‚¹å‡»</a>å‚è€ƒä¹‹å‰æ–‡ç« ã€‚</p>\n<h2 id=\"identityHashCode\"><a href=\"#identityHashCode\" class=\"headerlink\" title=\"identityHashCode\"></a>identityHashCode</h2><p>identityHashCodeæ˜¯Systemé‡Œé¢æä¾›çš„æœ¬åœ°æ–¹æ³•ï¼Œjava.lang.System#identityHashCodeã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * Returns the same hash code for the given object as\n * would be returned by the default method hashCode(),\n * whether or not the given object&#39;s class overrides\n * hashCode().\n * The hash code for the null reference is zero.\n *\n * @param x object for which the hashCode is to be calculated\n * @return  the hashCode\n * @since   JDK1.1\n *&#x2F;\npublic static native int identityHashCode(Object x);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>identityHashCodeå’ŒhashCodeçš„åŒºåˆ«æ˜¯ï¼ŒidentityHashCodeä¼šè¿”å›å¯¹è±¡çš„hashCodeï¼Œè€Œä¸ç®¡å¯¹è±¡æ˜¯å¦é‡å†™äº†hashCodeæ–¹æ³•ã€‚</p>\n<h2 id=\"ç¤ºä¾‹\"><a href=\"#ç¤ºä¾‹\" class=\"headerlink\" title=\"ç¤ºä¾‹\"></a>ç¤ºä¾‹</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n\tString str1 &#x3D; new String(&quot;abc&quot;);\n\tString str2 &#x3D; new String(&quot;abc&quot;);\n\tSystem.out.println(&quot;str1 hashCode: &quot; + str1.hashCode());\n\tSystem.out.println(&quot;str2 hashCode: &quot; + str2.hashCode());\n\tSystem.out.println(&quot;str1 identityHashCode: &quot; + System.identityHashCode(str1));\n\tSystem.out.println(&quot;str2 identityHashCode: &quot; + System.identityHashCode(str2));\n\n\tUser user &#x3D; new User(&quot;test&quot;, 1);\n\tSystem.out.println(&quot;user hashCode: &quot; + user.hashCode());\n\tSystem.out.println(&quot;user identityHashCode: &quot; + System.identityHashCode(user));\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¾“å‡ºç»“æœï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">str1 hashCode: 96354\nstr2 hashCode: 96354\nstr1 identityHashCode: 1173230247\nstr2 identityHashCode: 856419764\nuser hashCode: 621009875\nuser identityHashCode: 621009875<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç»“æœåˆ†æï¼š</p>\n<p>1ã€str1å’Œstr2çš„hashCodeæ˜¯ç›¸åŒçš„ï¼Œæ˜¯å› ä¸ºStringç±»é‡å†™äº†hashCodeæ–¹æ³•ï¼Œå®ƒæ ¹æ®Stringçš„å€¼æ¥ç¡®å®šhashCodeçš„å€¼ï¼Œæ‰€ä»¥åªè¦å€¼ä¸€æ ·ï¼ŒhashCodeå°±ä¼šä¸€æ ·ã€‚</p>\n<p>2ã€str1å’Œstr2çš„identityHashCodeä¸ä¸€æ ·ï¼Œè™½ç„¶Stringé‡å†™äº†hashCodeæ–¹æ³•ï¼ŒidentityHashCodeæ°¸è¿œè¿”å›æ ¹æ®å¯¹è±¡ç‰©ç†å†…å­˜åœ°å€äº§ç”Ÿçš„hashå€¼ï¼Œæ‰€ä»¥æ¯ä¸ªStringå¯¹è±¡çš„ç‰©ç†åœ°å€ä¸ä¸€æ ·ï¼ŒidentityHashCodeä¹Ÿä¼šä¸ä¸€æ ·ã€‚</p>\n<p>3ã€Userå¯¹è±¡æ²¡é‡å†™hashCodeæ–¹æ³•ï¼Œæ‰€ä»¥hashCodeå’ŒidentityHashCodeè¿”å›çš„å€¼ä¸€æ ·ã€‚</p>\n<h2 id=\"ç»“è®º\"><a href=\"#ç»“è®º\" class=\"headerlink\" title=\"ç»“è®º\"></a>ç»“è®º</h2><p>hashCodeæ–¹æ³•å¯ä»¥è¢«é‡å†™å¹¶è¿”å›é‡å†™åçš„å€¼ï¼ŒidentityHashCodeä¼šè¿”å›å¯¹è±¡çš„hashå€¼è€Œä¸ç®¡å¯¹è±¡æ˜¯å¦é‡å†™äº†hashCodeæ–¹æ³•ã€‚</p>\n"},{"title":"ä¸èƒ½ç”¨ + æ‹¼æ¥å­—ç¬¦ä¸²ï¼Ÿ è¿™æ¬¡æˆ‘è¦åŠæ‰“é¢è¯•å®˜ï¼","date":"2025-10-15T03:36:33.000Z","_content":"\næˆ‘ä»¬åš Java ç¨‹åºå‘˜ä»¥æ¥ï¼Œä¸ç®¡æ˜¯å·¥ä½œå½“ä¸­ï¼Œè¿˜æ˜¯é¢è¯•è¿‡ç¨‹ä¸­ï¼Œéƒ½çŸ¥é“ï¼šå­—ç¬¦ä¸²æ‹¼æ¥ä¸èƒ½ç”¨ Stringï¼Œè¦ç”¨ `StringBuilder` æˆ–è€…æ˜¯ `StringBuffer`ï¼Œä»¥è‡³äºå®ƒä»¬éƒ½è¢«æ»¥ç”¨äº†ã€‚\n\nStringBuilderã€StringBuffer ç®€ç§°ï¼šSBï¼Œä¸‹æ–‡ç»Ÿä¸€ç”¨ `SB` ä»£æ›¿ã€‚\n\n`SB`å®ƒä»¬éƒ½æ˜¯å¯å˜çš„å­—ç¬¦ä¸²ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ä¹Ÿæ˜¯ Java åˆä¸­çº§é¢è¯•æˆ˜åœºä¸Šå‡ºç°å‡ ç‡ååˆ†é«˜çš„ä¸€é“é¢˜ï¼Œä¸Šåœºç‡æ²¡æœ‰ 90% ä¹Ÿæœ‰ 80% å§ã€‚\n\nè¿™ä¸¤ä¸ªçš„å…·ä½“åŒºåˆ«è¯·çœ‹è¿™ç¯‡æ–‡ç« ï¼š[StringBuffer å’Œ StringBuilder çš„ 3 ä¸ªåŒºåˆ«](https://mp.weixin.qq.com/s/Eeb9wa0DfUs9U5snahAJZQ)ã€‚\n\næˆ‘ä»¬åè¿‡æ¥æƒ³ä¸‹ï¼ŒStringçœŸçš„æ˜¯ä¸å¯å˜çš„ä¹ˆï¼Ÿä¸ä¸€å®šï¼Œçœ‹ä¸‹è¿™ç¯‡ï¼š[Java ä¸­çš„ String çœŸçš„æ˜¯ä¸å¯å˜çš„å—ï¼Ÿ](https://mp.weixin.qq.com/s/sLsCZ7T-GnkI6ZZXn22o-w)\n\nå½“ç„¶ï¼Œæœ¬æ–‡ä¸æ˜¯è®¨è®ºå­—ç¬¦ä¸²å¯å˜ä¸ä¸å¯å˜çš„é—®é¢˜ï¼Œè€Œæ˜¯è®¨è®ºï¼šå­—ç¬¦ä¸²æ‹¼æ¥ä¸€å®šè¦ç”¨ `SB` å—ï¼Ÿä¸ºä»€ä¹ˆä¸èƒ½ç”¨ `+` ï¼Ÿèƒ½ä¸èƒ½ç”¨ `+` ï¼Ÿä»€ä¹ˆæ—¶å€™å¯ä»¥ç”¨ `+` ï¼Ÿ\n\nä¸ºä»€ä¹ˆä¸èƒ½ç”¨ + å·æ‹¼æ¥å­—ç¬¦ä¸²ï¼Ÿæˆ‘ä¸æœï¼Œæ¥ä¸‹æ¥æˆ‘è¦åŠæ‰“é¢è¯•å®˜ï¼\n\n#### ä»€ä¹ˆæ—¶å€™ä¸èƒ½ç”¨ `+`\n\né€šè¿‡å¤šä¸ªè¡¨è¾¾å¼å®Œæˆä¸€ä¸ªå­—ç¬¦ä¸²æ‹¼æ¥æ“ä½œã€‚\n\n```\nprivate void test1() {\n    String www = \"www.\";\n    String str = www;\n    str += \"javastack.\";\n    str += \"com\";\n}\n```\n\nå­—èŠ‚ç å¦‚ä¸‹ï¼š\n\n```\n// access flags 0xA\nprivate static test2()V\nL0\nLINENUMBER 14 L0\nLDC \"www.\"\nASTORE 0\nL1\nLINENUMBER 15 L1\nALOAD 0\nASTORE 1\nL2\nLINENUMBER 16 L2\nNEW java/lang/StringBuilder\nDUP\nINVOKESPECIAL java/lang/StringBuilder.<init> ()V\nALOAD 1\nINVOKEVIRTUAL java/lang/StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder;\nLDC \"javastack.\"\nINVOKEVIRTUAL java/lang/StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder;\nINVOKEVIRTUAL java/lang/StringBuilder.toString ()Ljava/lang/String;\nASTORE 1\nL3\nLINENUMBER 17 L3\nNEW java/lang/StringBuilder\nDUP\nINVOKESPECIAL java/lang/StringBuilder.<init> ()V\nALOAD 1\nINVOKEVIRTUAL java/lang/StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder;\nLDC \"com\"\nINVOKEVIRTUAL java/lang/StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder;\nINVOKEVIRTUAL java/lang/StringBuilder.toString ()Ljava/lang/String;\nASTORE 1\nL4\nLINENUMBER 18 L4\nRETURN\nL5\nLOCALVARIABLE www Ljava/lang/String; L1 L5 0\nLOCALVARIABLE str Ljava/lang/String; L2 L5 1\nMAXSTACK = 2\nMAXLOCALS = 2\n```\n\nä¸ä¼šæŸ¥çœ‹å­—èŠ‚ç çš„ï¼Œçœ‹è¿™é‡Œï¼š[3ç§éªšæ“ä½œï¼Œæ•™ä½ æŸ¥çœ‹ Java å­—èŠ‚ç ](https://mp.weixin.qq.com/s/bEEQf7bNik-rBPgK0uhjWg)ï¼Œçœ‹è¿™ä¸€ç¯‡å°±ä¼šäº†ã€‚\n\nè§‚å¯Ÿä¸‹ï¼Œ`NEW java/lang/StringBuilder` å‡ºç°äº†ä¸¤æ¬¡ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬åœ¨ä»£ç ä¸­æ‹¼æ¥äº†ä¸¤æ¬¡ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸€æ¬¡æ‹¼æ¥æ“ä½œéƒ½ä¼šåˆ›å»ºä¸€æ¬¡ `StringBuilder`ã€‚\n\nå¦‚æœæˆ‘ä»¬æ˜¯åœ¨ä¸€ä¸ªå¾ªç¯ä¸­è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œé‚£æ˜¯ä¸æ˜¯ä¸€æ¬¡æ‹¼æ¥å°±è¦åˆ›å»ºä¸€ä¸ª `StringBuilder`ï¼Ÿ\n\nwtfâ€¦â€¦è¿™å“ªèƒ½æ¥å—ï¼é¢‘ç¹åˆ›å»ºå¯¹è±¡æ˜¯æœ‰æ€§èƒ½å¼€é”€çš„ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å¸¸è¯´çš„å­—ç¬¦ä¸²ä¸èƒ½ç”¨ `+` æ‹¼æ¥ï¼Œè€Œè¦ç”¨é‚£ä¸¤ä¸ª `SB`  æ‹¼æ¥äº†ã€‚\n\n#### ä»€ä¹ˆæ—¶å€™å¯ä»¥ç”¨ `+`\n\nç›´æ¥å°†ä¸‰ä¸ªå­—é¢é‡çš„å­—ç¬¦ä¸²æ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚\n\n```\nprivate static void test2() {\n    String str = \"www.\" + \"javastack.\" + \"com\";\n}\n```\n\nå­—èŠ‚ç å¦‚ä¸‹ï¼š\n\n```\n// access flags 0x2\nprivate test2()V\nL0\nLINENUMBER 13 L0\nLDC \"www.javastack.com\"\nASTORE 1\nL1\nLINENUMBER 14 L1\nRETURN\nL2\nLOCALVARIABLE this Lcom/test/jdk/TestSB; L0 L2 0\nLOCALVARIABLE str Ljava/lang/String; L1 L2 1\nMAXSTACK = 1\nMAXLOCALS = 2\n```\n\nä»å­—èŠ‚ç çœ‹å‡ºï¼Œæ²¡æœ‰ä»»ä½•åˆ›å»º `StringBuilder` çš„æŒ‡ä»¤ï¼Œç›´æ¥ä»å¸¸é‡æ± è¿›è¡Œå–å‡ºä¸€ä¸ªå®Œæ•´çš„å­—ç¬¦ä¸²ï¼šwww.javastack.comã€‚å¾ˆæ˜æ˜¾ï¼Œè¿™æ˜¯ Java ç¼–è¯‘å™¨å¯¹ä»£ç è¿›è¡Œäº†ä¼˜åŒ–ã€‚\n\næ‰€ä»¥ï¼Œé€šè¿‡è¿™ä¸ªç¤ºä¾‹å‘Šè¯‰ä½ ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯å¯ä»¥ç”¨ `+` å·è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥çš„ã€‚\n\nè¿™ä¸ªç¤ºä¾‹å¯ä»¥æ¼”å˜æˆæˆ‘ä»¬å®é™…å·¥ä½œå½“ä¸­çš„æŸä¸ª SQL è¯­å¥æ‹¼æ¥çš„æ¡ˆä¾‹ï¼Œå¦‚ï¼š\n\n```\nString sql = \"select name, sex, age, address\"\n        + \"from t_user\"\n        + \"where age > 18\";\n```\n\nåˆ«è¯´è¿™æ ·ä¸è¡Œï¼Œè¿™æ ·æ˜¯è¡Œçš„ã€‚\n\nä½†ä½ è¦æ˜¯æ¢æˆè¿™æ ·å°±ä¸è¡Œäº†ï¼š\n\n```\nString sql = \"select name, sex, age, address\";\nsql += \"from t_user\";\nsql += \"where age > 18\";\n```\n\nè¿™æ ·åˆå›åˆ°åˆ›å»ºå¤šä¸ª `StringBuilder` çš„æ—¶å€™äº†ã€‚\n\nä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ä¸€ä¸ªè¡¨è¾¾å¼ä¸­å®Œæˆå­—ç¬¦ä¸²æ‹¼æ¥æ˜¯å¯ä»¥ç”¨ `+` å·å®Œæˆçš„ï¼Œå› ä¸ºç¼–è¯‘å™¨å·²ç»åšäº†ä¼˜åŒ–ã€‚\n\n#### å°ç»“ä¸€ä¸‹\n\nä½ åªéœ€è¦è®°ä½è¿™ä¸¤ç‚¹ï¼š\n\n1ã€åœ¨å¾ªç¯å’Œå¤šä¸ªè¡¨è¾¾å¼ä¸­ä¸èƒ½ `+`ï¼Œé¢‘ç¹åˆ›å»º `SB` æ€§èƒ½å½±å“ï¼›\n\n2ã€åœ¨å•ä¸ªè¡¨è¾¾å¼ä¸­å¯ä»¥ç”¨ `+`ï¼Œç¼–è¯‘å™¨ç›´æ¥åšäº†ä¼˜åŒ–ï¼›\n\nè€é“ä»¬ï¼Œéƒ½ææ¸…æ¥šäº†ï¼Ÿ\n\nè¿™ä¸ªè§‚ç‚¹æœ‰æ²¡æœ‰è¢«è¯¯è§£å¾ˆä¹…ï¼Ÿ\n\nä¸‹æ¬¡é¢è¯•ï¼ŒæŠŠè¿™ç¯‡å†…å®¹äº®å‡ºæ¥ï¼ŒåŠæ‰“é¢è¯•å®˜ï¼Œæ²¡é—®é¢˜çš„ã€‚\n\næœ‰æ”¶è·çš„æœ‹å‹ä¸€å®šè¦ç‚¹ä¸ªåœ¨çœ‹ï¼Œè¿™æ ·æˆ‘å†™åŸåˆ›æ›´å¸¦åŠ²äº†ï¼Œè°¢äº†ï¼Œè€é“ä»¬ã€‚\n","source":"_posts/è¿›é˜¶/ä¸èƒ½ç”¨ + æ‹¼æ¥å­—ç¬¦ä¸²ï¼Ÿ è¿™æ¬¡æˆ‘è¦åŠæ‰“é¢è¯•å®˜ï¼.md","raw":"---\ntitle: ä¸èƒ½ç”¨ + æ‹¼æ¥å­—ç¬¦ä¸²ï¼Ÿ è¿™æ¬¡æˆ‘è¦åŠæ‰“é¢è¯•å®˜ï¼\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: è¿›é˜¶\n---\n\næˆ‘ä»¬åš Java ç¨‹åºå‘˜ä»¥æ¥ï¼Œä¸ç®¡æ˜¯å·¥ä½œå½“ä¸­ï¼Œè¿˜æ˜¯é¢è¯•è¿‡ç¨‹ä¸­ï¼Œéƒ½çŸ¥é“ï¼šå­—ç¬¦ä¸²æ‹¼æ¥ä¸èƒ½ç”¨ Stringï¼Œè¦ç”¨ `StringBuilder` æˆ–è€…æ˜¯ `StringBuffer`ï¼Œä»¥è‡³äºå®ƒä»¬éƒ½è¢«æ»¥ç”¨äº†ã€‚\n\nStringBuilderã€StringBuffer ç®€ç§°ï¼šSBï¼Œä¸‹æ–‡ç»Ÿä¸€ç”¨ `SB` ä»£æ›¿ã€‚\n\n`SB`å®ƒä»¬éƒ½æ˜¯å¯å˜çš„å­—ç¬¦ä¸²ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ä¹Ÿæ˜¯ Java åˆä¸­çº§é¢è¯•æˆ˜åœºä¸Šå‡ºç°å‡ ç‡ååˆ†é«˜çš„ä¸€é“é¢˜ï¼Œä¸Šåœºç‡æ²¡æœ‰ 90% ä¹Ÿæœ‰ 80% å§ã€‚\n\nè¿™ä¸¤ä¸ªçš„å…·ä½“åŒºåˆ«è¯·çœ‹è¿™ç¯‡æ–‡ç« ï¼š[StringBuffer å’Œ StringBuilder çš„ 3 ä¸ªåŒºåˆ«](https://mp.weixin.qq.com/s/Eeb9wa0DfUs9U5snahAJZQ)ã€‚\n\næˆ‘ä»¬åè¿‡æ¥æƒ³ä¸‹ï¼ŒStringçœŸçš„æ˜¯ä¸å¯å˜çš„ä¹ˆï¼Ÿä¸ä¸€å®šï¼Œçœ‹ä¸‹è¿™ç¯‡ï¼š[Java ä¸­çš„ String çœŸçš„æ˜¯ä¸å¯å˜çš„å—ï¼Ÿ](https://mp.weixin.qq.com/s/sLsCZ7T-GnkI6ZZXn22o-w)\n\nå½“ç„¶ï¼Œæœ¬æ–‡ä¸æ˜¯è®¨è®ºå­—ç¬¦ä¸²å¯å˜ä¸ä¸å¯å˜çš„é—®é¢˜ï¼Œè€Œæ˜¯è®¨è®ºï¼šå­—ç¬¦ä¸²æ‹¼æ¥ä¸€å®šè¦ç”¨ `SB` å—ï¼Ÿä¸ºä»€ä¹ˆä¸èƒ½ç”¨ `+` ï¼Ÿèƒ½ä¸èƒ½ç”¨ `+` ï¼Ÿä»€ä¹ˆæ—¶å€™å¯ä»¥ç”¨ `+` ï¼Ÿ\n\nä¸ºä»€ä¹ˆä¸èƒ½ç”¨ + å·æ‹¼æ¥å­—ç¬¦ä¸²ï¼Ÿæˆ‘ä¸æœï¼Œæ¥ä¸‹æ¥æˆ‘è¦åŠæ‰“é¢è¯•å®˜ï¼\n\n#### ä»€ä¹ˆæ—¶å€™ä¸èƒ½ç”¨ `+`\n\né€šè¿‡å¤šä¸ªè¡¨è¾¾å¼å®Œæˆä¸€ä¸ªå­—ç¬¦ä¸²æ‹¼æ¥æ“ä½œã€‚\n\n```\nprivate void test1() {\n    String www = \"www.\";\n    String str = www;\n    str += \"javastack.\";\n    str += \"com\";\n}\n```\n\nå­—èŠ‚ç å¦‚ä¸‹ï¼š\n\n```\n// access flags 0xA\nprivate static test2()V\nL0\nLINENUMBER 14 L0\nLDC \"www.\"\nASTORE 0\nL1\nLINENUMBER 15 L1\nALOAD 0\nASTORE 1\nL2\nLINENUMBER 16 L2\nNEW java/lang/StringBuilder\nDUP\nINVOKESPECIAL java/lang/StringBuilder.<init> ()V\nALOAD 1\nINVOKEVIRTUAL java/lang/StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder;\nLDC \"javastack.\"\nINVOKEVIRTUAL java/lang/StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder;\nINVOKEVIRTUAL java/lang/StringBuilder.toString ()Ljava/lang/String;\nASTORE 1\nL3\nLINENUMBER 17 L3\nNEW java/lang/StringBuilder\nDUP\nINVOKESPECIAL java/lang/StringBuilder.<init> ()V\nALOAD 1\nINVOKEVIRTUAL java/lang/StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder;\nLDC \"com\"\nINVOKEVIRTUAL java/lang/StringBuilder.append (Ljava/lang/String;)Ljava/lang/StringBuilder;\nINVOKEVIRTUAL java/lang/StringBuilder.toString ()Ljava/lang/String;\nASTORE 1\nL4\nLINENUMBER 18 L4\nRETURN\nL5\nLOCALVARIABLE www Ljava/lang/String; L1 L5 0\nLOCALVARIABLE str Ljava/lang/String; L2 L5 1\nMAXSTACK = 2\nMAXLOCALS = 2\n```\n\nä¸ä¼šæŸ¥çœ‹å­—èŠ‚ç çš„ï¼Œçœ‹è¿™é‡Œï¼š[3ç§éªšæ“ä½œï¼Œæ•™ä½ æŸ¥çœ‹ Java å­—èŠ‚ç ](https://mp.weixin.qq.com/s/bEEQf7bNik-rBPgK0uhjWg)ï¼Œçœ‹è¿™ä¸€ç¯‡å°±ä¼šäº†ã€‚\n\nè§‚å¯Ÿä¸‹ï¼Œ`NEW java/lang/StringBuilder` å‡ºç°äº†ä¸¤æ¬¡ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬åœ¨ä»£ç ä¸­æ‹¼æ¥äº†ä¸¤æ¬¡ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸€æ¬¡æ‹¼æ¥æ“ä½œéƒ½ä¼šåˆ›å»ºä¸€æ¬¡ `StringBuilder`ã€‚\n\nå¦‚æœæˆ‘ä»¬æ˜¯åœ¨ä¸€ä¸ªå¾ªç¯ä¸­è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œé‚£æ˜¯ä¸æ˜¯ä¸€æ¬¡æ‹¼æ¥å°±è¦åˆ›å»ºä¸€ä¸ª `StringBuilder`ï¼Ÿ\n\nwtfâ€¦â€¦è¿™å“ªèƒ½æ¥å—ï¼é¢‘ç¹åˆ›å»ºå¯¹è±¡æ˜¯æœ‰æ€§èƒ½å¼€é”€çš„ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å¸¸è¯´çš„å­—ç¬¦ä¸²ä¸èƒ½ç”¨ `+` æ‹¼æ¥ï¼Œè€Œè¦ç”¨é‚£ä¸¤ä¸ª `SB`  æ‹¼æ¥äº†ã€‚\n\n#### ä»€ä¹ˆæ—¶å€™å¯ä»¥ç”¨ `+`\n\nç›´æ¥å°†ä¸‰ä¸ªå­—é¢é‡çš„å­—ç¬¦ä¸²æ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚\n\n```\nprivate static void test2() {\n    String str = \"www.\" + \"javastack.\" + \"com\";\n}\n```\n\nå­—èŠ‚ç å¦‚ä¸‹ï¼š\n\n```\n// access flags 0x2\nprivate test2()V\nL0\nLINENUMBER 13 L0\nLDC \"www.javastack.com\"\nASTORE 1\nL1\nLINENUMBER 14 L1\nRETURN\nL2\nLOCALVARIABLE this Lcom/test/jdk/TestSB; L0 L2 0\nLOCALVARIABLE str Ljava/lang/String; L1 L2 1\nMAXSTACK = 1\nMAXLOCALS = 2\n```\n\nä»å­—èŠ‚ç çœ‹å‡ºï¼Œæ²¡æœ‰ä»»ä½•åˆ›å»º `StringBuilder` çš„æŒ‡ä»¤ï¼Œç›´æ¥ä»å¸¸é‡æ± è¿›è¡Œå–å‡ºä¸€ä¸ªå®Œæ•´çš„å­—ç¬¦ä¸²ï¼šwww.javastack.comã€‚å¾ˆæ˜æ˜¾ï¼Œè¿™æ˜¯ Java ç¼–è¯‘å™¨å¯¹ä»£ç è¿›è¡Œäº†ä¼˜åŒ–ã€‚\n\næ‰€ä»¥ï¼Œé€šè¿‡è¿™ä¸ªç¤ºä¾‹å‘Šè¯‰ä½ ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯å¯ä»¥ç”¨ `+` å·è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥çš„ã€‚\n\nè¿™ä¸ªç¤ºä¾‹å¯ä»¥æ¼”å˜æˆæˆ‘ä»¬å®é™…å·¥ä½œå½“ä¸­çš„æŸä¸ª SQL è¯­å¥æ‹¼æ¥çš„æ¡ˆä¾‹ï¼Œå¦‚ï¼š\n\n```\nString sql = \"select name, sex, age, address\"\n        + \"from t_user\"\n        + \"where age > 18\";\n```\n\nåˆ«è¯´è¿™æ ·ä¸è¡Œï¼Œè¿™æ ·æ˜¯è¡Œçš„ã€‚\n\nä½†ä½ è¦æ˜¯æ¢æˆè¿™æ ·å°±ä¸è¡Œäº†ï¼š\n\n```\nString sql = \"select name, sex, age, address\";\nsql += \"from t_user\";\nsql += \"where age > 18\";\n```\n\nè¿™æ ·åˆå›åˆ°åˆ›å»ºå¤šä¸ª `StringBuilder` çš„æ—¶å€™äº†ã€‚\n\nä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ä¸€ä¸ªè¡¨è¾¾å¼ä¸­å®Œæˆå­—ç¬¦ä¸²æ‹¼æ¥æ˜¯å¯ä»¥ç”¨ `+` å·å®Œæˆçš„ï¼Œå› ä¸ºç¼–è¯‘å™¨å·²ç»åšäº†ä¼˜åŒ–ã€‚\n\n#### å°ç»“ä¸€ä¸‹\n\nä½ åªéœ€è¦è®°ä½è¿™ä¸¤ç‚¹ï¼š\n\n1ã€åœ¨å¾ªç¯å’Œå¤šä¸ªè¡¨è¾¾å¼ä¸­ä¸èƒ½ `+`ï¼Œé¢‘ç¹åˆ›å»º `SB` æ€§èƒ½å½±å“ï¼›\n\n2ã€åœ¨å•ä¸ªè¡¨è¾¾å¼ä¸­å¯ä»¥ç”¨ `+`ï¼Œç¼–è¯‘å™¨ç›´æ¥åšäº†ä¼˜åŒ–ï¼›\n\nè€é“ä»¬ï¼Œéƒ½ææ¸…æ¥šäº†ï¼Ÿ\n\nè¿™ä¸ªè§‚ç‚¹æœ‰æ²¡æœ‰è¢«è¯¯è§£å¾ˆä¹…ï¼Ÿ\n\nä¸‹æ¬¡é¢è¯•ï¼ŒæŠŠè¿™ç¯‡å†…å®¹äº®å‡ºæ¥ï¼ŒåŠæ‰“é¢è¯•å®˜ï¼Œæ²¡é—®é¢˜çš„ã€‚\n\næœ‰æ”¶è·çš„æœ‹å‹ä¸€å®šè¦ç‚¹ä¸ªåœ¨çœ‹ï¼Œè¿™æ ·æˆ‘å†™åŸåˆ›æ›´å¸¦åŠ²äº†ï¼Œè°¢äº†ï¼Œè€é“ä»¬ã€‚\n","slug":"è¿›é˜¶/ä¸èƒ½ç”¨ + æ‹¼æ¥å­—ç¬¦ä¸²ï¼Ÿ è¿™æ¬¡æˆ‘è¦åŠæ‰“é¢è¯•å®˜ï¼","published":1,"updated":"2025-10-15T07:21:14.223Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076h0013qkd42sjh4ej0","content":"<p>æˆ‘ä»¬åš Java ç¨‹åºå‘˜ä»¥æ¥ï¼Œä¸ç®¡æ˜¯å·¥ä½œå½“ä¸­ï¼Œè¿˜æ˜¯é¢è¯•è¿‡ç¨‹ä¸­ï¼Œéƒ½çŸ¥é“ï¼šå­—ç¬¦ä¸²æ‹¼æ¥ä¸èƒ½ç”¨ Stringï¼Œè¦ç”¨ <code>StringBuilder</code> æˆ–è€…æ˜¯ <code>StringBuffer</code>ï¼Œä»¥è‡³äºå®ƒä»¬éƒ½è¢«æ»¥ç”¨äº†ã€‚</p>\n<p>StringBuilderã€StringBuffer ç®€ç§°ï¼šSBï¼Œä¸‹æ–‡ç»Ÿä¸€ç”¨ <code>SB</code> ä»£æ›¿ã€‚</p>\n<p><code>SB</code>å®ƒä»¬éƒ½æ˜¯å¯å˜çš„å­—ç¬¦ä¸²ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ä¹Ÿæ˜¯ Java åˆä¸­çº§é¢è¯•æˆ˜åœºä¸Šå‡ºç°å‡ ç‡ååˆ†é«˜çš„ä¸€é“é¢˜ï¼Œä¸Šåœºç‡æ²¡æœ‰ 90% ä¹Ÿæœ‰ 80% å§ã€‚</p>\n<p>è¿™ä¸¤ä¸ªçš„å…·ä½“åŒºåˆ«è¯·çœ‹è¿™ç¯‡æ–‡ç« ï¼š<a href=\"https://mp.weixin.qq.com/s/Eeb9wa0DfUs9U5snahAJZQ\">StringBuffer å’Œ StringBuilder çš„ 3 ä¸ªåŒºåˆ«</a>ã€‚</p>\n<p>æˆ‘ä»¬åè¿‡æ¥æƒ³ä¸‹ï¼ŒStringçœŸçš„æ˜¯ä¸å¯å˜çš„ä¹ˆï¼Ÿä¸ä¸€å®šï¼Œçœ‹ä¸‹è¿™ç¯‡ï¼š<a href=\"https://mp.weixin.qq.com/s/sLsCZ7T-GnkI6ZZXn22o-w\">Java ä¸­çš„ String çœŸçš„æ˜¯ä¸å¯å˜çš„å—ï¼Ÿ</a></p>\n<p>å½“ç„¶ï¼Œæœ¬æ–‡ä¸æ˜¯è®¨è®ºå­—ç¬¦ä¸²å¯å˜ä¸ä¸å¯å˜çš„é—®é¢˜ï¼Œè€Œæ˜¯è®¨è®ºï¼šå­—ç¬¦ä¸²æ‹¼æ¥ä¸€å®šè¦ç”¨ <code>SB</code> å—ï¼Ÿä¸ºä»€ä¹ˆä¸èƒ½ç”¨ <code>+</code> ï¼Ÿèƒ½ä¸èƒ½ç”¨ <code>+</code> ï¼Ÿä»€ä¹ˆæ—¶å€™å¯ä»¥ç”¨ <code>+</code> ï¼Ÿ</p>\n<p>ä¸ºä»€ä¹ˆä¸èƒ½ç”¨ + å·æ‹¼æ¥å­—ç¬¦ä¸²ï¼Ÿæˆ‘ä¸æœï¼Œæ¥ä¸‹æ¥æˆ‘è¦åŠæ‰“é¢è¯•å®˜ï¼</p>\n<h4 id=\"ä»€ä¹ˆæ—¶å€™ä¸èƒ½ç”¨\"><a href=\"#ä»€ä¹ˆæ—¶å€™ä¸èƒ½ç”¨\" class=\"headerlink\" title=\"ä»€ä¹ˆæ—¶å€™ä¸èƒ½ç”¨ +\"></a>ä»€ä¹ˆæ—¶å€™ä¸èƒ½ç”¨ <code>+</code></h4><p>é€šè¿‡å¤šä¸ªè¡¨è¾¾å¼å®Œæˆä¸€ä¸ªå­—ç¬¦ä¸²æ‹¼æ¥æ“ä½œã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private void test1() &#123;\n    String www &#x3D; &quot;www.&quot;;\n    String str &#x3D; www;\n    str +&#x3D; &quot;javastack.&quot;;\n    str +&#x3D; &quot;com&quot;;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å­—èŠ‚ç å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; access flags 0xA\nprivate static test2()V\nL0\nLINENUMBER 14 L0\nLDC &quot;www.&quot;\nASTORE 0\nL1\nLINENUMBER 15 L1\nALOAD 0\nASTORE 1\nL2\nLINENUMBER 16 L2\nNEW java&#x2F;lang&#x2F;StringBuilder\nDUP\nINVOKESPECIAL java&#x2F;lang&#x2F;StringBuilder.&lt;init&gt; ()V\nALOAD 1\nINVOKEVIRTUAL java&#x2F;lang&#x2F;StringBuilder.append (Ljava&#x2F;lang&#x2F;String;)Ljava&#x2F;lang&#x2F;StringBuilder;\nLDC &quot;javastack.&quot;\nINVOKEVIRTUAL java&#x2F;lang&#x2F;StringBuilder.append (Ljava&#x2F;lang&#x2F;String;)Ljava&#x2F;lang&#x2F;StringBuilder;\nINVOKEVIRTUAL java&#x2F;lang&#x2F;StringBuilder.toString ()Ljava&#x2F;lang&#x2F;String;\nASTORE 1\nL3\nLINENUMBER 17 L3\nNEW java&#x2F;lang&#x2F;StringBuilder\nDUP\nINVOKESPECIAL java&#x2F;lang&#x2F;StringBuilder.&lt;init&gt; ()V\nALOAD 1\nINVOKEVIRTUAL java&#x2F;lang&#x2F;StringBuilder.append (Ljava&#x2F;lang&#x2F;String;)Ljava&#x2F;lang&#x2F;StringBuilder;\nLDC &quot;com&quot;\nINVOKEVIRTUAL java&#x2F;lang&#x2F;StringBuilder.append (Ljava&#x2F;lang&#x2F;String;)Ljava&#x2F;lang&#x2F;StringBuilder;\nINVOKEVIRTUAL java&#x2F;lang&#x2F;StringBuilder.toString ()Ljava&#x2F;lang&#x2F;String;\nASTORE 1\nL4\nLINENUMBER 18 L4\nRETURN\nL5\nLOCALVARIABLE www Ljava&#x2F;lang&#x2F;String; L1 L5 0\nLOCALVARIABLE str Ljava&#x2F;lang&#x2F;String; L2 L5 1\nMAXSTACK &#x3D; 2\nMAXLOCALS &#x3D; 2<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä¸ä¼šæŸ¥çœ‹å­—èŠ‚ç çš„ï¼Œçœ‹è¿™é‡Œï¼š<a href=\"https://mp.weixin.qq.com/s/bEEQf7bNik-rBPgK0uhjWg\">3ç§éªšæ“ä½œï¼Œæ•™ä½ æŸ¥çœ‹ Java å­—èŠ‚ç </a>ï¼Œçœ‹è¿™ä¸€ç¯‡å°±ä¼šäº†ã€‚</p>\n<p>è§‚å¯Ÿä¸‹ï¼Œ<code>NEW java/lang/StringBuilder</code> å‡ºç°äº†ä¸¤æ¬¡ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬åœ¨ä»£ç ä¸­æ‹¼æ¥äº†ä¸¤æ¬¡ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸€æ¬¡æ‹¼æ¥æ“ä½œéƒ½ä¼šåˆ›å»ºä¸€æ¬¡ <code>StringBuilder</code>ã€‚</p>\n<p>å¦‚æœæˆ‘ä»¬æ˜¯åœ¨ä¸€ä¸ªå¾ªç¯ä¸­è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œé‚£æ˜¯ä¸æ˜¯ä¸€æ¬¡æ‹¼æ¥å°±è¦åˆ›å»ºä¸€ä¸ª <code>StringBuilder</code>ï¼Ÿ</p>\n<p>wtfâ€¦â€¦è¿™å“ªèƒ½æ¥å—ï¼é¢‘ç¹åˆ›å»ºå¯¹è±¡æ˜¯æœ‰æ€§èƒ½å¼€é”€çš„ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å¸¸è¯´çš„å­—ç¬¦ä¸²ä¸èƒ½ç”¨ <code>+</code> æ‹¼æ¥ï¼Œè€Œè¦ç”¨é‚£ä¸¤ä¸ª <code>SB</code>  æ‹¼æ¥äº†ã€‚</p>\n<h4 id=\"ä»€ä¹ˆæ—¶å€™å¯ä»¥ç”¨\"><a href=\"#ä»€ä¹ˆæ—¶å€™å¯ä»¥ç”¨\" class=\"headerlink\" title=\"ä»€ä¹ˆæ—¶å€™å¯ä»¥ç”¨ +\"></a>ä»€ä¹ˆæ—¶å€™å¯ä»¥ç”¨ <code>+</code></h4><p>ç›´æ¥å°†ä¸‰ä¸ªå­—é¢é‡çš„å­—ç¬¦ä¸²æ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void test2() &#123;\n    String str &#x3D; &quot;www.&quot; + &quot;javastack.&quot; + &quot;com&quot;;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>å­—èŠ‚ç å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; access flags 0x2\nprivate test2()V\nL0\nLINENUMBER 13 L0\nLDC &quot;www.javastack.com&quot;\nASTORE 1\nL1\nLINENUMBER 14 L1\nRETURN\nL2\nLOCALVARIABLE this Lcom&#x2F;test&#x2F;jdk&#x2F;TestSB; L0 L2 0\nLOCALVARIABLE str Ljava&#x2F;lang&#x2F;String; L1 L2 1\nMAXSTACK &#x3D; 1\nMAXLOCALS &#x3D; 2<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä»å­—èŠ‚ç çœ‹å‡ºï¼Œæ²¡æœ‰ä»»ä½•åˆ›å»º <code>StringBuilder</code> çš„æŒ‡ä»¤ï¼Œç›´æ¥ä»å¸¸é‡æ± è¿›è¡Œå–å‡ºä¸€ä¸ªå®Œæ•´çš„å­—ç¬¦ä¸²ï¼š<a href=\"http://www.javastack.com.å¾ˆæ˜æ˜¾,è¿™æ˜¯/\">www.javastack.comã€‚å¾ˆæ˜æ˜¾ï¼Œè¿™æ˜¯</a> Java ç¼–è¯‘å™¨å¯¹ä»£ç è¿›è¡Œäº†ä¼˜åŒ–ã€‚</p>\n<p>æ‰€ä»¥ï¼Œé€šè¿‡è¿™ä¸ªç¤ºä¾‹å‘Šè¯‰ä½ ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯å¯ä»¥ç”¨ <code>+</code> å·è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥çš„ã€‚</p>\n<p>è¿™ä¸ªç¤ºä¾‹å¯ä»¥æ¼”å˜æˆæˆ‘ä»¬å®é™…å·¥ä½œå½“ä¸­çš„æŸä¸ª SQL è¯­å¥æ‹¼æ¥çš„æ¡ˆä¾‹ï¼Œå¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">String sql &#x3D; &quot;select name, sex, age, address&quot;\n        + &quot;from t_user&quot;\n        + &quot;where age &gt; 18&quot;;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>åˆ«è¯´è¿™æ ·ä¸è¡Œï¼Œè¿™æ ·æ˜¯è¡Œçš„ã€‚</p>\n<p>ä½†ä½ è¦æ˜¯æ¢æˆè¿™æ ·å°±ä¸è¡Œäº†ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">String sql &#x3D; &quot;select name, sex, age, address&quot;;\nsql +&#x3D; &quot;from t_user&quot;;\nsql +&#x3D; &quot;where age &gt; 18&quot;;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™æ ·åˆå›åˆ°åˆ›å»ºå¤šä¸ª <code>StringBuilder</code> çš„æ—¶å€™äº†ã€‚</p>\n<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ä¸€ä¸ªè¡¨è¾¾å¼ä¸­å®Œæˆå­—ç¬¦ä¸²æ‹¼æ¥æ˜¯å¯ä»¥ç”¨ <code>+</code> å·å®Œæˆçš„ï¼Œå› ä¸ºç¼–è¯‘å™¨å·²ç»åšäº†ä¼˜åŒ–ã€‚</p>\n<h4 id=\"å°ç»“ä¸€ä¸‹\"><a href=\"#å°ç»“ä¸€ä¸‹\" class=\"headerlink\" title=\"å°ç»“ä¸€ä¸‹\"></a>å°ç»“ä¸€ä¸‹</h4><p>ä½ åªéœ€è¦è®°ä½è¿™ä¸¤ç‚¹ï¼š</p>\n<p>1ã€åœ¨å¾ªç¯å’Œå¤šä¸ªè¡¨è¾¾å¼ä¸­ä¸èƒ½ <code>+</code>ï¼Œé¢‘ç¹åˆ›å»º <code>SB</code> æ€§èƒ½å½±å“ï¼›</p>\n<p>2ã€åœ¨å•ä¸ªè¡¨è¾¾å¼ä¸­å¯ä»¥ç”¨ <code>+</code>ï¼Œç¼–è¯‘å™¨ç›´æ¥åšäº†ä¼˜åŒ–ï¼›</p>\n<p>è€é“ä»¬ï¼Œéƒ½ææ¸…æ¥šäº†ï¼Ÿ</p>\n<p>è¿™ä¸ªè§‚ç‚¹æœ‰æ²¡æœ‰è¢«è¯¯è§£å¾ˆä¹…ï¼Ÿ</p>\n<p>ä¸‹æ¬¡é¢è¯•ï¼ŒæŠŠè¿™ç¯‡å†…å®¹äº®å‡ºæ¥ï¼ŒåŠæ‰“é¢è¯•å®˜ï¼Œæ²¡é—®é¢˜çš„ã€‚</p>\n<p>æœ‰æ”¶è·çš„æœ‹å‹ä¸€å®šè¦ç‚¹ä¸ªåœ¨çœ‹ï¼Œè¿™æ ·æˆ‘å†™åŸåˆ›æ›´å¸¦åŠ²äº†ï¼Œè°¢äº†ï¼Œè€é“ä»¬ã€‚</p>\n","excerpt":"","more":"<p>æˆ‘ä»¬åš Java ç¨‹åºå‘˜ä»¥æ¥ï¼Œä¸ç®¡æ˜¯å·¥ä½œå½“ä¸­ï¼Œè¿˜æ˜¯é¢è¯•è¿‡ç¨‹ä¸­ï¼Œéƒ½çŸ¥é“ï¼šå­—ç¬¦ä¸²æ‹¼æ¥ä¸èƒ½ç”¨ Stringï¼Œè¦ç”¨ <code>StringBuilder</code> æˆ–è€…æ˜¯ <code>StringBuffer</code>ï¼Œä»¥è‡³äºå®ƒä»¬éƒ½è¢«æ»¥ç”¨äº†ã€‚</p>\n<p>StringBuilderã€StringBuffer ç®€ç§°ï¼šSBï¼Œä¸‹æ–‡ç»Ÿä¸€ç”¨ <code>SB</code> ä»£æ›¿ã€‚</p>\n<p><code>SB</code>å®ƒä»¬éƒ½æ˜¯å¯å˜çš„å­—ç¬¦ä¸²ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«ä¹Ÿæ˜¯ Java åˆä¸­çº§é¢è¯•æˆ˜åœºä¸Šå‡ºç°å‡ ç‡ååˆ†é«˜çš„ä¸€é“é¢˜ï¼Œä¸Šåœºç‡æ²¡æœ‰ 90% ä¹Ÿæœ‰ 80% å§ã€‚</p>\n<p>è¿™ä¸¤ä¸ªçš„å…·ä½“åŒºåˆ«è¯·çœ‹è¿™ç¯‡æ–‡ç« ï¼š<a href=\"https://mp.weixin.qq.com/s/Eeb9wa0DfUs9U5snahAJZQ\">StringBuffer å’Œ StringBuilder çš„ 3 ä¸ªåŒºåˆ«</a>ã€‚</p>\n<p>æˆ‘ä»¬åè¿‡æ¥æƒ³ä¸‹ï¼ŒStringçœŸçš„æ˜¯ä¸å¯å˜çš„ä¹ˆï¼Ÿä¸ä¸€å®šï¼Œçœ‹ä¸‹è¿™ç¯‡ï¼š<a href=\"https://mp.weixin.qq.com/s/sLsCZ7T-GnkI6ZZXn22o-w\">Java ä¸­çš„ String çœŸçš„æ˜¯ä¸å¯å˜çš„å—ï¼Ÿ</a></p>\n<p>å½“ç„¶ï¼Œæœ¬æ–‡ä¸æ˜¯è®¨è®ºå­—ç¬¦ä¸²å¯å˜ä¸ä¸å¯å˜çš„é—®é¢˜ï¼Œè€Œæ˜¯è®¨è®ºï¼šå­—ç¬¦ä¸²æ‹¼æ¥ä¸€å®šè¦ç”¨ <code>SB</code> å—ï¼Ÿä¸ºä»€ä¹ˆä¸èƒ½ç”¨ <code>+</code> ï¼Ÿèƒ½ä¸èƒ½ç”¨ <code>+</code> ï¼Ÿä»€ä¹ˆæ—¶å€™å¯ä»¥ç”¨ <code>+</code> ï¼Ÿ</p>\n<p>ä¸ºä»€ä¹ˆä¸èƒ½ç”¨ + å·æ‹¼æ¥å­—ç¬¦ä¸²ï¼Ÿæˆ‘ä¸æœï¼Œæ¥ä¸‹æ¥æˆ‘è¦åŠæ‰“é¢è¯•å®˜ï¼</p>\n<h4 id=\"ä»€ä¹ˆæ—¶å€™ä¸èƒ½ç”¨\"><a href=\"#ä»€ä¹ˆæ—¶å€™ä¸èƒ½ç”¨\" class=\"headerlink\" title=\"ä»€ä¹ˆæ—¶å€™ä¸èƒ½ç”¨ +\"></a>ä»€ä¹ˆæ—¶å€™ä¸èƒ½ç”¨ <code>+</code></h4><p>é€šè¿‡å¤šä¸ªè¡¨è¾¾å¼å®Œæˆä¸€ä¸ªå­—ç¬¦ä¸²æ‹¼æ¥æ“ä½œã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private void test1() &#123;\n    String www &#x3D; &quot;www.&quot;;\n    String str &#x3D; www;\n    str +&#x3D; &quot;javastack.&quot;;\n    str +&#x3D; &quot;com&quot;;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å­—èŠ‚ç å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; access flags 0xA\nprivate static test2()V\nL0\nLINENUMBER 14 L0\nLDC &quot;www.&quot;\nASTORE 0\nL1\nLINENUMBER 15 L1\nALOAD 0\nASTORE 1\nL2\nLINENUMBER 16 L2\nNEW java&#x2F;lang&#x2F;StringBuilder\nDUP\nINVOKESPECIAL java&#x2F;lang&#x2F;StringBuilder.&lt;init&gt; ()V\nALOAD 1\nINVOKEVIRTUAL java&#x2F;lang&#x2F;StringBuilder.append (Ljava&#x2F;lang&#x2F;String;)Ljava&#x2F;lang&#x2F;StringBuilder;\nLDC &quot;javastack.&quot;\nINVOKEVIRTUAL java&#x2F;lang&#x2F;StringBuilder.append (Ljava&#x2F;lang&#x2F;String;)Ljava&#x2F;lang&#x2F;StringBuilder;\nINVOKEVIRTUAL java&#x2F;lang&#x2F;StringBuilder.toString ()Ljava&#x2F;lang&#x2F;String;\nASTORE 1\nL3\nLINENUMBER 17 L3\nNEW java&#x2F;lang&#x2F;StringBuilder\nDUP\nINVOKESPECIAL java&#x2F;lang&#x2F;StringBuilder.&lt;init&gt; ()V\nALOAD 1\nINVOKEVIRTUAL java&#x2F;lang&#x2F;StringBuilder.append (Ljava&#x2F;lang&#x2F;String;)Ljava&#x2F;lang&#x2F;StringBuilder;\nLDC &quot;com&quot;\nINVOKEVIRTUAL java&#x2F;lang&#x2F;StringBuilder.append (Ljava&#x2F;lang&#x2F;String;)Ljava&#x2F;lang&#x2F;StringBuilder;\nINVOKEVIRTUAL java&#x2F;lang&#x2F;StringBuilder.toString ()Ljava&#x2F;lang&#x2F;String;\nASTORE 1\nL4\nLINENUMBER 18 L4\nRETURN\nL5\nLOCALVARIABLE www Ljava&#x2F;lang&#x2F;String; L1 L5 0\nLOCALVARIABLE str Ljava&#x2F;lang&#x2F;String; L2 L5 1\nMAXSTACK &#x3D; 2\nMAXLOCALS &#x3D; 2<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä¸ä¼šæŸ¥çœ‹å­—èŠ‚ç çš„ï¼Œçœ‹è¿™é‡Œï¼š<a href=\"https://mp.weixin.qq.com/s/bEEQf7bNik-rBPgK0uhjWg\">3ç§éªšæ“ä½œï¼Œæ•™ä½ æŸ¥çœ‹ Java å­—èŠ‚ç </a>ï¼Œçœ‹è¿™ä¸€ç¯‡å°±ä¼šäº†ã€‚</p>\n<p>è§‚å¯Ÿä¸‹ï¼Œ<code>NEW java/lang/StringBuilder</code> å‡ºç°äº†ä¸¤æ¬¡ï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬åœ¨ä»£ç ä¸­æ‹¼æ¥äº†ä¸¤æ¬¡ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯ä¸€æ¬¡æ‹¼æ¥æ“ä½œéƒ½ä¼šåˆ›å»ºä¸€æ¬¡ <code>StringBuilder</code>ã€‚</p>\n<p>å¦‚æœæˆ‘ä»¬æ˜¯åœ¨ä¸€ä¸ªå¾ªç¯ä¸­è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥ï¼Œé‚£æ˜¯ä¸æ˜¯ä¸€æ¬¡æ‹¼æ¥å°±è¦åˆ›å»ºä¸€ä¸ª <code>StringBuilder</code>ï¼Ÿ</p>\n<p>wtfâ€¦â€¦è¿™å“ªèƒ½æ¥å—ï¼é¢‘ç¹åˆ›å»ºå¯¹è±¡æ˜¯æœ‰æ€§èƒ½å¼€é”€çš„ï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»¬å¸¸è¯´çš„å­—ç¬¦ä¸²ä¸èƒ½ç”¨ <code>+</code> æ‹¼æ¥ï¼Œè€Œè¦ç”¨é‚£ä¸¤ä¸ª <code>SB</code>  æ‹¼æ¥äº†ã€‚</p>\n<h4 id=\"ä»€ä¹ˆæ—¶å€™å¯ä»¥ç”¨\"><a href=\"#ä»€ä¹ˆæ—¶å€™å¯ä»¥ç”¨\" class=\"headerlink\" title=\"ä»€ä¹ˆæ—¶å€™å¯ä»¥ç”¨ +\"></a>ä»€ä¹ˆæ—¶å€™å¯ä»¥ç”¨ <code>+</code></h4><p>ç›´æ¥å°†ä¸‰ä¸ªå­—é¢é‡çš„å­—ç¬¦ä¸²æ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void test2() &#123;\n    String str &#x3D; &quot;www.&quot; + &quot;javastack.&quot; + &quot;com&quot;;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>å­—èŠ‚ç å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; access flags 0x2\nprivate test2()V\nL0\nLINENUMBER 13 L0\nLDC &quot;www.javastack.com&quot;\nASTORE 1\nL1\nLINENUMBER 14 L1\nRETURN\nL2\nLOCALVARIABLE this Lcom&#x2F;test&#x2F;jdk&#x2F;TestSB; L0 L2 0\nLOCALVARIABLE str Ljava&#x2F;lang&#x2F;String; L1 L2 1\nMAXSTACK &#x3D; 1\nMAXLOCALS &#x3D; 2<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä»å­—èŠ‚ç çœ‹å‡ºï¼Œæ²¡æœ‰ä»»ä½•åˆ›å»º <code>StringBuilder</code> çš„æŒ‡ä»¤ï¼Œç›´æ¥ä»å¸¸é‡æ± è¿›è¡Œå–å‡ºä¸€ä¸ªå®Œæ•´çš„å­—ç¬¦ä¸²ï¼š<a href=\"http://www.javastack.com.å¾ˆæ˜æ˜¾,è¿™æ˜¯/\">www.javastack.comã€‚å¾ˆæ˜æ˜¾ï¼Œè¿™æ˜¯</a> Java ç¼–è¯‘å™¨å¯¹ä»£ç è¿›è¡Œäº†ä¼˜åŒ–ã€‚</p>\n<p>æ‰€ä»¥ï¼Œé€šè¿‡è¿™ä¸ªç¤ºä¾‹å‘Šè¯‰ä½ ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹æ˜¯å¯ä»¥ç”¨ <code>+</code> å·è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥çš„ã€‚</p>\n<p>è¿™ä¸ªç¤ºä¾‹å¯ä»¥æ¼”å˜æˆæˆ‘ä»¬å®é™…å·¥ä½œå½“ä¸­çš„æŸä¸ª SQL è¯­å¥æ‹¼æ¥çš„æ¡ˆä¾‹ï¼Œå¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">String sql &#x3D; &quot;select name, sex, age, address&quot;\n        + &quot;from t_user&quot;\n        + &quot;where age &gt; 18&quot;;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>åˆ«è¯´è¿™æ ·ä¸è¡Œï¼Œè¿™æ ·æ˜¯è¡Œçš„ã€‚</p>\n<p>ä½†ä½ è¦æ˜¯æ¢æˆè¿™æ ·å°±ä¸è¡Œäº†ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">String sql &#x3D; &quot;select name, sex, age, address&quot;;\nsql +&#x3D; &quot;from t_user&quot;;\nsql +&#x3D; &quot;where age &gt; 18&quot;;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™æ ·åˆå›åˆ°åˆ›å»ºå¤šä¸ª <code>StringBuilder</code> çš„æ—¶å€™äº†ã€‚</p>\n<p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨ä¸€ä¸ªè¡¨è¾¾å¼ä¸­å®Œæˆå­—ç¬¦ä¸²æ‹¼æ¥æ˜¯å¯ä»¥ç”¨ <code>+</code> å·å®Œæˆçš„ï¼Œå› ä¸ºç¼–è¯‘å™¨å·²ç»åšäº†ä¼˜åŒ–ã€‚</p>\n<h4 id=\"å°ç»“ä¸€ä¸‹\"><a href=\"#å°ç»“ä¸€ä¸‹\" class=\"headerlink\" title=\"å°ç»“ä¸€ä¸‹\"></a>å°ç»“ä¸€ä¸‹</h4><p>ä½ åªéœ€è¦è®°ä½è¿™ä¸¤ç‚¹ï¼š</p>\n<p>1ã€åœ¨å¾ªç¯å’Œå¤šä¸ªè¡¨è¾¾å¼ä¸­ä¸èƒ½ <code>+</code>ï¼Œé¢‘ç¹åˆ›å»º <code>SB</code> æ€§èƒ½å½±å“ï¼›</p>\n<p>2ã€åœ¨å•ä¸ªè¡¨è¾¾å¼ä¸­å¯ä»¥ç”¨ <code>+</code>ï¼Œç¼–è¯‘å™¨ç›´æ¥åšäº†ä¼˜åŒ–ï¼›</p>\n<p>è€é“ä»¬ï¼Œéƒ½ææ¸…æ¥šäº†ï¼Ÿ</p>\n<p>è¿™ä¸ªè§‚ç‚¹æœ‰æ²¡æœ‰è¢«è¯¯è§£å¾ˆä¹…ï¼Ÿ</p>\n<p>ä¸‹æ¬¡é¢è¯•ï¼ŒæŠŠè¿™ç¯‡å†…å®¹äº®å‡ºæ¥ï¼ŒåŠæ‰“é¢è¯•å®˜ï¼Œæ²¡é—®é¢˜çš„ã€‚</p>\n<p>æœ‰æ”¶è·çš„æœ‹å‹ä¸€å®šè¦ç‚¹ä¸ªåœ¨çœ‹ï¼Œè¿™æ ·æˆ‘å†™åŸåˆ›æ›´å¸¦åŠ²äº†ï¼Œè°¢äº†ï¼Œè€é“ä»¬ã€‚</p>\n"},{"title":"åˆ«å†å†™ bug äº†ï¼Œé¿å…ç©ºæŒ‡é’ˆçš„ 5 ä¸ªæ¡ˆä¾‹ï¼","date":"2025-10-15T03:36:33.000Z","_content":"\nç©ºæŒ‡é’ˆæ˜¯æˆ‘ä»¬ Java å¼€å‘äººå‘˜ç»å¸¸é‡åˆ°çš„ä¸€ä¸ªåŸºæœ¬å¼‚å¸¸ï¼Œè¿™æ˜¯ä¸€ä¸ªæå…¶æ™®éä½†ä¼¼ä¹åˆæ— æ³•æ ¹æ²»çš„é—®é¢˜ã€‚\n\næœ¬æ–‡ï¼Œæ ˆé•¿å°†å¸¦ä½ äº†è§£ä»€ä¹ˆæ˜¯ç©ºæŒ‡é’ˆï¼Œè¿˜æœ‰å¦‚ä½•æœ‰æ•ˆçš„é¿å…ç©ºæŒ‡é’ˆã€‚\n\n## ä»€ä¹ˆæ˜¯ç©ºæŒ‡é’ˆï¼Ÿ\n\nå½“ä¸€ä¸ªå˜é‡çš„å€¼ä¸º null æ—¶ï¼Œåœ¨ Java é‡Œé¢è¡¨ç¤ºä¸€ä¸ªä¸å­˜åœ¨çš„ç©ºå¯¹è±¡ï¼Œæ²¡æœ‰å®é™…å†…å®¹ï¼Œæ²¡æœ‰ç»™å®ƒåˆ†é…å†…å­˜ï¼Œnull ä¹Ÿæ˜¯å¯¹è±¡æˆå‘˜å˜é‡çš„é»˜è®¤å€¼ã€‚\n\næ‰€ä»¥ï¼Œä¸€ä¸ªå¯¹è±¡å¦‚æœæ²¡æœ‰è¿›è¡Œåˆå§‹åŒ–æ“ä½œï¼Œè¿™æ—¶å€™ï¼Œå¦‚æœä½ è°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„æ–¹æ³•æˆ–è€…å˜é‡ï¼Œå°±ä¼šå‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚\n\nå¦‚ä¸‹é¢ç¤ºä¾‹ä¼šå‘ç”Ÿç©ºæŒ‡é’ˆå¼‚å¸¸ï¼š\n\n```\nObject object = null;\nString string = object.toString();\n```\n\n![](http://qianniu.javastack.cn/18-12-12/46377586.jpg)\n\nä»ç±»ç»“æ„å›¾æ¥çœ‹ï¼Œç©ºæŒ‡é’ˆå®ƒæ˜¯å±äºè¿è¡Œæ—¶å¼‚å¸¸ `RuntimeException` çš„å­ç±»ï¼Œå®ƒä¸æ˜¯æ•è·å‹çš„ï¼Œåªæœ‰åœ¨ç¨‹åºè¿è¡Œæ—¶æ‰å¯èƒ½æŠ¥å‡ºæ¥ï¼Œè€Œä¸”ä¼šé€ æˆç¨‹åºä¸­æ–­ã€‚\n\n> ä»€ä¹ˆæ˜¯è¿è¡Œæ—¶å¼‚å¸¸åŠå¼‚å¸¸çš„åˆ†ç±»è¯·çœ‹è¿™ç¯‡æ–‡ç« ï¼š[ä¸€å¼ å›¾ææ¸…æ¥š Java å¼‚å¸¸æœºåˆ¶](https://mp.weixin.qq.com/s/xbopgxZ5BEDdSvwO9ad9Xg)ã€‚\n\n## å¦‚ä½•é¿å…ç©ºæŒ‡é’ˆï¼Ÿ\n\nä¸‹é¢è¯´å‡ ä¸ªç©ºæŒ‡é’ˆçš„å‡ ä¸ªæœ€å¸¸è§çš„æ¡ˆä¾‹åŠè§£å†³ä¹‹é“ã€‚\n\n#### 1ã€å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œå¸¸é‡æ”¾å‰é¢\n\n```\nif(status.equals(SUCCESS)){\n    \n}\n```\n\nè¿™ä¸ªæ—¶å€™ status å¯èƒ½ä¸º null é€ æˆç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œåº”è¯¥æŠŠå¸¸é‡æ”¾å‰é¢ï¼Œå°±èƒ½é¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚\n\n```\nif(SUCCESS.equals(status)){\n    \n}\n```\n\nè¿™ä¸ªåº”è¯¥åœ¨å„ç§å¼€å‘è§„èŒƒé‡Œé¢éƒ½ä¼šæåˆ°ï¼Œä¹Ÿæ˜¯æœ€åŸºç¡€çš„ã€‚\n\n#### 2ã€åˆå§‹åŒ–é»˜è®¤å€¼\n\nåœ¨å¯¹è±¡åˆå§‹åŒ–çš„æ—¶å€™ç»™å®ƒä¸€ä¸ªé»˜è®¤å€¼æˆ–è€…é»˜è®¤æ„é€ å®ç°ï¼Œå¦‚ï¼š\n\n```\nUser user = new User();\nString name = StringUtils.EMPTY;\n```\n\n#### 3ã€è¿”å›ç©ºé›†åˆ\n\nåœ¨è¿”å›ä¸€ä¸ªé›†åˆçš„è¯ï¼Œé»˜è®¤ä¼šæ˜¯ nullï¼Œç»Ÿä¸€è§„èŒƒè¿”å›ä¸€ä¸ªç©ºé›†åˆã€‚\n\nä¸¾ä¸ª List ä¾‹å­ï¼Œå¦‚ï¼š\n\n```\npublic List getUserList(){\n    List list = userMapper.gerUserList();\n    return list == null ? new ArrayList() : list;\n}\n```\n\nè¿™æ ·æ¥æ”¶æ–¹å°±ä¸ç”¨æ‹…å¿ƒç©ºæŒ‡é’ˆå¼‚å¸¸äº†ï¼Œä¹Ÿä¸ä¼šå½±å“ä¸šåŠ¡ã€‚\n\n#### 4ã€æ–­è¨€\n\næ–­è¨€æ˜¯ç”¨æ¥æ£€æŸ¥ç¨‹åºçš„å®‰å…¨æ€§çš„ï¼Œåœ¨ä½¿ç”¨ä¹‹å‰è¿›è¡Œæ£€æŸ¥æ¡ä»¶ï¼Œå¦‚æœä¸ç¬¦åˆæ¡ä»¶å°±æŠ¥å¼‚å¸¸ï¼Œç¬¦åˆå°±ç»§ç»­ã€‚\n\nJava ä¸­è‡ªå¸¦çš„æ–­è¨€å…³é”®å­—ï¼šassertï¼Œå¦‚ï¼š\n\n```\nassert name == null : \"åç§°ä¸èƒ½ä¸ºç©º\";\n```\n\nè¾“å‡ºï¼š\n\n```\nException in thread \"main\" java.lang.AssertionError: åç§°ä¸æ­£ç¡®\n```\n\nä¸è¿‡é»˜è®¤æ˜¯ä¸å¯åŠ¨æ–­è¨€æ£€æŸ¥çš„ï¼Œéœ€è¦è¦å¸¦ä¸Š JVM å‚æ•°ï¼š-enableassertions æ‰èƒ½ç”Ÿæ•ˆã€‚\n\nJava ä¸­è¿™ä¸ªç”¨çš„å¾ˆå°‘ï¼Œå»ºè®®ä½¿ç”¨ Spring ä¸­çš„ï¼Œæ›´å¼ºå¤§ï¼Œæ›´æ–¹ä¾¿å¥½ç”¨ã€‚\n\nSpringä¸­çš„ç”¨æ³•ï¼š\n\n```\nAssert.notNull(name,\"åç§°ä¸èƒ½ä¸ºç©º\");\n```\n\n#### 5ã€Optional\n\nOptional æ˜¯ JDK 8 æ–°å¢çš„æ–°ç‰¹æ€§ï¼Œå†ä¹Ÿä¸ç”¨ != null æ¥åˆ¤æ–­äº†ï¼Œè¿™ä¸ªåœ¨ä¸€ä¸ªå¯¹è±¡é‡Œé¢çš„å¤šä¸ªå­å¯¹è±¡è¿ç»­åˆ¤æ–­çš„æ—¶å€™éå¸¸æœ‰ç”¨ã€‚\n\nè¿™é‡Œä¸å†è¯¦ç»†ä»‹ç»äº†ï¼Œå…·ä½“çœ‹è¿™ç¯‡æ–‡ç« ï¼š[JDK8æ–°ç‰¹æ€§ä¹‹Optional](https://mp.weixin.qq.com/s/uXw4eTZqLfj871FlciPh6Q)ã€‚\n\nå¤§å®¶éƒ½æœ‰ä»€ä¹ˆé«˜è§ï¼Œæ¬¢è¿ç•™è¨€åˆ†äº«ï¼\n\n","source":"_posts/è¿›é˜¶/åˆ«å†å†™ bug äº†ï¼Œé¿å…ç©ºæŒ‡é’ˆçš„ 5 ä¸ªæ¡ˆä¾‹ï¼.md","raw":"---\ntitle: åˆ«å†å†™ bug äº†ï¼Œé¿å…ç©ºæŒ‡é’ˆçš„ 5 ä¸ªæ¡ˆä¾‹ï¼\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: è¿›é˜¶\n---\n\nç©ºæŒ‡é’ˆæ˜¯æˆ‘ä»¬ Java å¼€å‘äººå‘˜ç»å¸¸é‡åˆ°çš„ä¸€ä¸ªåŸºæœ¬å¼‚å¸¸ï¼Œè¿™æ˜¯ä¸€ä¸ªæå…¶æ™®éä½†ä¼¼ä¹åˆæ— æ³•æ ¹æ²»çš„é—®é¢˜ã€‚\n\næœ¬æ–‡ï¼Œæ ˆé•¿å°†å¸¦ä½ äº†è§£ä»€ä¹ˆæ˜¯ç©ºæŒ‡é’ˆï¼Œè¿˜æœ‰å¦‚ä½•æœ‰æ•ˆçš„é¿å…ç©ºæŒ‡é’ˆã€‚\n\n## ä»€ä¹ˆæ˜¯ç©ºæŒ‡é’ˆï¼Ÿ\n\nå½“ä¸€ä¸ªå˜é‡çš„å€¼ä¸º null æ—¶ï¼Œåœ¨ Java é‡Œé¢è¡¨ç¤ºä¸€ä¸ªä¸å­˜åœ¨çš„ç©ºå¯¹è±¡ï¼Œæ²¡æœ‰å®é™…å†…å®¹ï¼Œæ²¡æœ‰ç»™å®ƒåˆ†é…å†…å­˜ï¼Œnull ä¹Ÿæ˜¯å¯¹è±¡æˆå‘˜å˜é‡çš„é»˜è®¤å€¼ã€‚\n\næ‰€ä»¥ï¼Œä¸€ä¸ªå¯¹è±¡å¦‚æœæ²¡æœ‰è¿›è¡Œåˆå§‹åŒ–æ“ä½œï¼Œè¿™æ—¶å€™ï¼Œå¦‚æœä½ è°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„æ–¹æ³•æˆ–è€…å˜é‡ï¼Œå°±ä¼šå‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚\n\nå¦‚ä¸‹é¢ç¤ºä¾‹ä¼šå‘ç”Ÿç©ºæŒ‡é’ˆå¼‚å¸¸ï¼š\n\n```\nObject object = null;\nString string = object.toString();\n```\n\n![](http://qianniu.javastack.cn/18-12-12/46377586.jpg)\n\nä»ç±»ç»“æ„å›¾æ¥çœ‹ï¼Œç©ºæŒ‡é’ˆå®ƒæ˜¯å±äºè¿è¡Œæ—¶å¼‚å¸¸ `RuntimeException` çš„å­ç±»ï¼Œå®ƒä¸æ˜¯æ•è·å‹çš„ï¼Œåªæœ‰åœ¨ç¨‹åºè¿è¡Œæ—¶æ‰å¯èƒ½æŠ¥å‡ºæ¥ï¼Œè€Œä¸”ä¼šé€ æˆç¨‹åºä¸­æ–­ã€‚\n\n> ä»€ä¹ˆæ˜¯è¿è¡Œæ—¶å¼‚å¸¸åŠå¼‚å¸¸çš„åˆ†ç±»è¯·çœ‹è¿™ç¯‡æ–‡ç« ï¼š[ä¸€å¼ å›¾ææ¸…æ¥š Java å¼‚å¸¸æœºåˆ¶](https://mp.weixin.qq.com/s/xbopgxZ5BEDdSvwO9ad9Xg)ã€‚\n\n## å¦‚ä½•é¿å…ç©ºæŒ‡é’ˆï¼Ÿ\n\nä¸‹é¢è¯´å‡ ä¸ªç©ºæŒ‡é’ˆçš„å‡ ä¸ªæœ€å¸¸è§çš„æ¡ˆä¾‹åŠè§£å†³ä¹‹é“ã€‚\n\n#### 1ã€å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œå¸¸é‡æ”¾å‰é¢\n\n```\nif(status.equals(SUCCESS)){\n    \n}\n```\n\nè¿™ä¸ªæ—¶å€™ status å¯èƒ½ä¸º null é€ æˆç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œåº”è¯¥æŠŠå¸¸é‡æ”¾å‰é¢ï¼Œå°±èƒ½é¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚\n\n```\nif(SUCCESS.equals(status)){\n    \n}\n```\n\nè¿™ä¸ªåº”è¯¥åœ¨å„ç§å¼€å‘è§„èŒƒé‡Œé¢éƒ½ä¼šæåˆ°ï¼Œä¹Ÿæ˜¯æœ€åŸºç¡€çš„ã€‚\n\n#### 2ã€åˆå§‹åŒ–é»˜è®¤å€¼\n\nåœ¨å¯¹è±¡åˆå§‹åŒ–çš„æ—¶å€™ç»™å®ƒä¸€ä¸ªé»˜è®¤å€¼æˆ–è€…é»˜è®¤æ„é€ å®ç°ï¼Œå¦‚ï¼š\n\n```\nUser user = new User();\nString name = StringUtils.EMPTY;\n```\n\n#### 3ã€è¿”å›ç©ºé›†åˆ\n\nåœ¨è¿”å›ä¸€ä¸ªé›†åˆçš„è¯ï¼Œé»˜è®¤ä¼šæ˜¯ nullï¼Œç»Ÿä¸€è§„èŒƒè¿”å›ä¸€ä¸ªç©ºé›†åˆã€‚\n\nä¸¾ä¸ª List ä¾‹å­ï¼Œå¦‚ï¼š\n\n```\npublic List getUserList(){\n    List list = userMapper.gerUserList();\n    return list == null ? new ArrayList() : list;\n}\n```\n\nè¿™æ ·æ¥æ”¶æ–¹å°±ä¸ç”¨æ‹…å¿ƒç©ºæŒ‡é’ˆå¼‚å¸¸äº†ï¼Œä¹Ÿä¸ä¼šå½±å“ä¸šåŠ¡ã€‚\n\n#### 4ã€æ–­è¨€\n\næ–­è¨€æ˜¯ç”¨æ¥æ£€æŸ¥ç¨‹åºçš„å®‰å…¨æ€§çš„ï¼Œåœ¨ä½¿ç”¨ä¹‹å‰è¿›è¡Œæ£€æŸ¥æ¡ä»¶ï¼Œå¦‚æœä¸ç¬¦åˆæ¡ä»¶å°±æŠ¥å¼‚å¸¸ï¼Œç¬¦åˆå°±ç»§ç»­ã€‚\n\nJava ä¸­è‡ªå¸¦çš„æ–­è¨€å…³é”®å­—ï¼šassertï¼Œå¦‚ï¼š\n\n```\nassert name == null : \"åç§°ä¸èƒ½ä¸ºç©º\";\n```\n\nè¾“å‡ºï¼š\n\n```\nException in thread \"main\" java.lang.AssertionError: åç§°ä¸æ­£ç¡®\n```\n\nä¸è¿‡é»˜è®¤æ˜¯ä¸å¯åŠ¨æ–­è¨€æ£€æŸ¥çš„ï¼Œéœ€è¦è¦å¸¦ä¸Š JVM å‚æ•°ï¼š-enableassertions æ‰èƒ½ç”Ÿæ•ˆã€‚\n\nJava ä¸­è¿™ä¸ªç”¨çš„å¾ˆå°‘ï¼Œå»ºè®®ä½¿ç”¨ Spring ä¸­çš„ï¼Œæ›´å¼ºå¤§ï¼Œæ›´æ–¹ä¾¿å¥½ç”¨ã€‚\n\nSpringä¸­çš„ç”¨æ³•ï¼š\n\n```\nAssert.notNull(name,\"åç§°ä¸èƒ½ä¸ºç©º\");\n```\n\n#### 5ã€Optional\n\nOptional æ˜¯ JDK 8 æ–°å¢çš„æ–°ç‰¹æ€§ï¼Œå†ä¹Ÿä¸ç”¨ != null æ¥åˆ¤æ–­äº†ï¼Œè¿™ä¸ªåœ¨ä¸€ä¸ªå¯¹è±¡é‡Œé¢çš„å¤šä¸ªå­å¯¹è±¡è¿ç»­åˆ¤æ–­çš„æ—¶å€™éå¸¸æœ‰ç”¨ã€‚\n\nè¿™é‡Œä¸å†è¯¦ç»†ä»‹ç»äº†ï¼Œå…·ä½“çœ‹è¿™ç¯‡æ–‡ç« ï¼š[JDK8æ–°ç‰¹æ€§ä¹‹Optional](https://mp.weixin.qq.com/s/uXw4eTZqLfj871FlciPh6Q)ã€‚\n\nå¤§å®¶éƒ½æœ‰ä»€ä¹ˆé«˜è§ï¼Œæ¬¢è¿ç•™è¨€åˆ†äº«ï¼\n\n","slug":"è¿›é˜¶/åˆ«å†å†™ bug äº†ï¼Œé¿å…ç©ºæŒ‡é’ˆçš„ 5 ä¸ªæ¡ˆä¾‹ï¼","published":1,"updated":"2025-10-15T07:21:14.206Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076i0016qkd498g4cosa","content":"<p>ç©ºæŒ‡é’ˆæ˜¯æˆ‘ä»¬ Java å¼€å‘äººå‘˜ç»å¸¸é‡åˆ°çš„ä¸€ä¸ªåŸºæœ¬å¼‚å¸¸ï¼Œè¿™æ˜¯ä¸€ä¸ªæå…¶æ™®éä½†ä¼¼ä¹åˆæ— æ³•æ ¹æ²»çš„é—®é¢˜ã€‚</p>\n<p>æœ¬æ–‡ï¼Œæ ˆé•¿å°†å¸¦ä½ äº†è§£ä»€ä¹ˆæ˜¯ç©ºæŒ‡é’ˆï¼Œè¿˜æœ‰å¦‚ä½•æœ‰æ•ˆçš„é¿å…ç©ºæŒ‡é’ˆã€‚</p>\n<h2 id=\"ä»€ä¹ˆæ˜¯ç©ºæŒ‡é’ˆï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯ç©ºæŒ‡é’ˆï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ç©ºæŒ‡é’ˆï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯ç©ºæŒ‡é’ˆï¼Ÿ</h2><p>å½“ä¸€ä¸ªå˜é‡çš„å€¼ä¸º null æ—¶ï¼Œåœ¨ Java é‡Œé¢è¡¨ç¤ºä¸€ä¸ªä¸å­˜åœ¨çš„ç©ºå¯¹è±¡ï¼Œæ²¡æœ‰å®é™…å†…å®¹ï¼Œæ²¡æœ‰ç»™å®ƒåˆ†é…å†…å­˜ï¼Œnull ä¹Ÿæ˜¯å¯¹è±¡æˆå‘˜å˜é‡çš„é»˜è®¤å€¼ã€‚</p>\n<p>æ‰€ä»¥ï¼Œä¸€ä¸ªå¯¹è±¡å¦‚æœæ²¡æœ‰è¿›è¡Œåˆå§‹åŒ–æ“ä½œï¼Œè¿™æ—¶å€™ï¼Œå¦‚æœä½ è°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„æ–¹æ³•æˆ–è€…å˜é‡ï¼Œå°±ä¼šå‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚</p>\n<p>å¦‚ä¸‹é¢ç¤ºä¾‹ä¼šå‘ç”Ÿç©ºæŒ‡é’ˆå¼‚å¸¸ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Object object &#x3D; null;\nString string &#x3D; object.toString();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p><img src=\"http://qianniu.javastack.cn/18-12-12/46377586.jpg\"></p>\n<p>ä»ç±»ç»“æ„å›¾æ¥çœ‹ï¼Œç©ºæŒ‡é’ˆå®ƒæ˜¯å±äºè¿è¡Œæ—¶å¼‚å¸¸ <code>RuntimeException</code> çš„å­ç±»ï¼Œå®ƒä¸æ˜¯æ•è·å‹çš„ï¼Œåªæœ‰åœ¨ç¨‹åºè¿è¡Œæ—¶æ‰å¯èƒ½æŠ¥å‡ºæ¥ï¼Œè€Œä¸”ä¼šé€ æˆç¨‹åºä¸­æ–­ã€‚</p>\n<blockquote>\n<p>ä»€ä¹ˆæ˜¯è¿è¡Œæ—¶å¼‚å¸¸åŠå¼‚å¸¸çš„åˆ†ç±»è¯·çœ‹è¿™ç¯‡æ–‡ç« ï¼š<a href=\"https://mp.weixin.qq.com/s/xbopgxZ5BEDdSvwO9ad9Xg\">ä¸€å¼ å›¾ææ¸…æ¥š Java å¼‚å¸¸æœºåˆ¶</a>ã€‚</p>\n</blockquote>\n<h2 id=\"å¦‚ä½•é¿å…ç©ºæŒ‡é’ˆï¼Ÿ\"><a href=\"#å¦‚ä½•é¿å…ç©ºæŒ‡é’ˆï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•é¿å…ç©ºæŒ‡é’ˆï¼Ÿ\"></a>å¦‚ä½•é¿å…ç©ºæŒ‡é’ˆï¼Ÿ</h2><p>ä¸‹é¢è¯´å‡ ä¸ªç©ºæŒ‡é’ˆçš„å‡ ä¸ªæœ€å¸¸è§çš„æ¡ˆä¾‹åŠè§£å†³ä¹‹é“ã€‚</p>\n<h4 id=\"1ã€å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œå¸¸é‡æ”¾å‰é¢\"><a href=\"#1ã€å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œå¸¸é‡æ”¾å‰é¢\" class=\"headerlink\" title=\"1ã€å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œå¸¸é‡æ”¾å‰é¢\"></a>1ã€å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œå¸¸é‡æ”¾å‰é¢</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">if(status.equals(SUCCESS))&#123;\n    \n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªæ—¶å€™ status å¯èƒ½ä¸º null é€ æˆç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œåº”è¯¥æŠŠå¸¸é‡æ”¾å‰é¢ï¼Œå°±èƒ½é¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">if(SUCCESS.equals(status))&#123;\n    \n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªåº”è¯¥åœ¨å„ç§å¼€å‘è§„èŒƒé‡Œé¢éƒ½ä¼šæåˆ°ï¼Œä¹Ÿæ˜¯æœ€åŸºç¡€çš„ã€‚</p>\n<h4 id=\"2ã€åˆå§‹åŒ–é»˜è®¤å€¼\"><a href=\"#2ã€åˆå§‹åŒ–é»˜è®¤å€¼\" class=\"headerlink\" title=\"2ã€åˆå§‹åŒ–é»˜è®¤å€¼\"></a>2ã€åˆå§‹åŒ–é»˜è®¤å€¼</h4><p>åœ¨å¯¹è±¡åˆå§‹åŒ–çš„æ—¶å€™ç»™å®ƒä¸€ä¸ªé»˜è®¤å€¼æˆ–è€…é»˜è®¤æ„é€ å®ç°ï¼Œå¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">User user &#x3D; new User();\nString name &#x3D; StringUtils.EMPTY;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h4 id=\"3ã€è¿”å›ç©ºé›†åˆ\"><a href=\"#3ã€è¿”å›ç©ºé›†åˆ\" class=\"headerlink\" title=\"3ã€è¿”å›ç©ºé›†åˆ\"></a>3ã€è¿”å›ç©ºé›†åˆ</h4><p>åœ¨è¿”å›ä¸€ä¸ªé›†åˆçš„è¯ï¼Œé»˜è®¤ä¼šæ˜¯ nullï¼Œç»Ÿä¸€è§„èŒƒè¿”å›ä¸€ä¸ªç©ºé›†åˆã€‚</p>\n<p>ä¸¾ä¸ª List ä¾‹å­ï¼Œå¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public List getUserList()&#123;\n    List list &#x3D; userMapper.gerUserList();\n    return list &#x3D;&#x3D; null ? new ArrayList() : list;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™æ ·æ¥æ”¶æ–¹å°±ä¸ç”¨æ‹…å¿ƒç©ºæŒ‡é’ˆå¼‚å¸¸äº†ï¼Œä¹Ÿä¸ä¼šå½±å“ä¸šåŠ¡ã€‚</p>\n<h4 id=\"4ã€æ–­è¨€\"><a href=\"#4ã€æ–­è¨€\" class=\"headerlink\" title=\"4ã€æ–­è¨€\"></a>4ã€æ–­è¨€</h4><p>æ–­è¨€æ˜¯ç”¨æ¥æ£€æŸ¥ç¨‹åºçš„å®‰å…¨æ€§çš„ï¼Œåœ¨ä½¿ç”¨ä¹‹å‰è¿›è¡Œæ£€æŸ¥æ¡ä»¶ï¼Œå¦‚æœä¸ç¬¦åˆæ¡ä»¶å°±æŠ¥å¼‚å¸¸ï¼Œç¬¦åˆå°±ç»§ç»­ã€‚</p>\n<p>Java ä¸­è‡ªå¸¦çš„æ–­è¨€å…³é”®å­—ï¼šassertï¼Œå¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">assert name &#x3D;&#x3D; null : &quot;åç§°ä¸èƒ½ä¸ºç©º&quot;;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>è¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Exception in thread &quot;main&quot; java.lang.AssertionError: åç§°ä¸æ­£ç¡®<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>ä¸è¿‡é»˜è®¤æ˜¯ä¸å¯åŠ¨æ–­è¨€æ£€æŸ¥çš„ï¼Œéœ€è¦è¦å¸¦ä¸Š JVM å‚æ•°ï¼š-enableassertions æ‰èƒ½ç”Ÿæ•ˆã€‚</p>\n<p>Java ä¸­è¿™ä¸ªç”¨çš„å¾ˆå°‘ï¼Œå»ºè®®ä½¿ç”¨ Spring ä¸­çš„ï¼Œæ›´å¼ºå¤§ï¼Œæ›´æ–¹ä¾¿å¥½ç”¨ã€‚</p>\n<p>Springä¸­çš„ç”¨æ³•ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Assert.notNull(name,&quot;åç§°ä¸èƒ½ä¸ºç©º&quot;);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"5ã€Optional\"><a href=\"#5ã€Optional\" class=\"headerlink\" title=\"5ã€Optional\"></a>5ã€Optional</h4><p>Optional æ˜¯ JDK 8 æ–°å¢çš„æ–°ç‰¹æ€§ï¼Œå†ä¹Ÿä¸ç”¨ !&#x3D; null æ¥åˆ¤æ–­äº†ï¼Œè¿™ä¸ªåœ¨ä¸€ä¸ªå¯¹è±¡é‡Œé¢çš„å¤šä¸ªå­å¯¹è±¡è¿ç»­åˆ¤æ–­çš„æ—¶å€™éå¸¸æœ‰ç”¨ã€‚</p>\n<p>è¿™é‡Œä¸å†è¯¦ç»†ä»‹ç»äº†ï¼Œå…·ä½“çœ‹è¿™ç¯‡æ–‡ç« ï¼š<a href=\"https://mp.weixin.qq.com/s/uXw4eTZqLfj871FlciPh6Q\">JDK8æ–°ç‰¹æ€§ä¹‹Optional</a>ã€‚</p>\n<p>å¤§å®¶éƒ½æœ‰ä»€ä¹ˆé«˜è§ï¼Œæ¬¢è¿ç•™è¨€åˆ†äº«ï¼</p>\n","excerpt":"","more":"<p>ç©ºæŒ‡é’ˆæ˜¯æˆ‘ä»¬ Java å¼€å‘äººå‘˜ç»å¸¸é‡åˆ°çš„ä¸€ä¸ªåŸºæœ¬å¼‚å¸¸ï¼Œè¿™æ˜¯ä¸€ä¸ªæå…¶æ™®éä½†ä¼¼ä¹åˆæ— æ³•æ ¹æ²»çš„é—®é¢˜ã€‚</p>\n<p>æœ¬æ–‡ï¼Œæ ˆé•¿å°†å¸¦ä½ äº†è§£ä»€ä¹ˆæ˜¯ç©ºæŒ‡é’ˆï¼Œè¿˜æœ‰å¦‚ä½•æœ‰æ•ˆçš„é¿å…ç©ºæŒ‡é’ˆã€‚</p>\n<h2 id=\"ä»€ä¹ˆæ˜¯ç©ºæŒ‡é’ˆï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯ç©ºæŒ‡é’ˆï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ç©ºæŒ‡é’ˆï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯ç©ºæŒ‡é’ˆï¼Ÿ</h2><p>å½“ä¸€ä¸ªå˜é‡çš„å€¼ä¸º null æ—¶ï¼Œåœ¨ Java é‡Œé¢è¡¨ç¤ºä¸€ä¸ªä¸å­˜åœ¨çš„ç©ºå¯¹è±¡ï¼Œæ²¡æœ‰å®é™…å†…å®¹ï¼Œæ²¡æœ‰ç»™å®ƒåˆ†é…å†…å­˜ï¼Œnull ä¹Ÿæ˜¯å¯¹è±¡æˆå‘˜å˜é‡çš„é»˜è®¤å€¼ã€‚</p>\n<p>æ‰€ä»¥ï¼Œä¸€ä¸ªå¯¹è±¡å¦‚æœæ²¡æœ‰è¿›è¡Œåˆå§‹åŒ–æ“ä½œï¼Œè¿™æ—¶å€™ï¼Œå¦‚æœä½ è°ƒç”¨è¿™ä¸ªå¯¹è±¡çš„æ–¹æ³•æˆ–è€…å˜é‡ï¼Œå°±ä¼šå‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚</p>\n<p>å¦‚ä¸‹é¢ç¤ºä¾‹ä¼šå‘ç”Ÿç©ºæŒ‡é’ˆå¼‚å¸¸ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Object object &#x3D; null;\nString string &#x3D; object.toString();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p><img src=\"http://qianniu.javastack.cn/18-12-12/46377586.jpg\"></p>\n<p>ä»ç±»ç»“æ„å›¾æ¥çœ‹ï¼Œç©ºæŒ‡é’ˆå®ƒæ˜¯å±äºè¿è¡Œæ—¶å¼‚å¸¸ <code>RuntimeException</code> çš„å­ç±»ï¼Œå®ƒä¸æ˜¯æ•è·å‹çš„ï¼Œåªæœ‰åœ¨ç¨‹åºè¿è¡Œæ—¶æ‰å¯èƒ½æŠ¥å‡ºæ¥ï¼Œè€Œä¸”ä¼šé€ æˆç¨‹åºä¸­æ–­ã€‚</p>\n<blockquote>\n<p>ä»€ä¹ˆæ˜¯è¿è¡Œæ—¶å¼‚å¸¸åŠå¼‚å¸¸çš„åˆ†ç±»è¯·çœ‹è¿™ç¯‡æ–‡ç« ï¼š<a href=\"https://mp.weixin.qq.com/s/xbopgxZ5BEDdSvwO9ad9Xg\">ä¸€å¼ å›¾ææ¸…æ¥š Java å¼‚å¸¸æœºåˆ¶</a>ã€‚</p>\n</blockquote>\n<h2 id=\"å¦‚ä½•é¿å…ç©ºæŒ‡é’ˆï¼Ÿ\"><a href=\"#å¦‚ä½•é¿å…ç©ºæŒ‡é’ˆï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•é¿å…ç©ºæŒ‡é’ˆï¼Ÿ\"></a>å¦‚ä½•é¿å…ç©ºæŒ‡é’ˆï¼Ÿ</h2><p>ä¸‹é¢è¯´å‡ ä¸ªç©ºæŒ‡é’ˆçš„å‡ ä¸ªæœ€å¸¸è§çš„æ¡ˆä¾‹åŠè§£å†³ä¹‹é“ã€‚</p>\n<h4 id=\"1ã€å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œå¸¸é‡æ”¾å‰é¢\"><a href=\"#1ã€å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œå¸¸é‡æ”¾å‰é¢\" class=\"headerlink\" title=\"1ã€å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œå¸¸é‡æ”¾å‰é¢\"></a>1ã€å­—ç¬¦ä¸²æ¯”è¾ƒï¼Œå¸¸é‡æ”¾å‰é¢</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">if(status.equals(SUCCESS))&#123;\n    \n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªæ—¶å€™ status å¯èƒ½ä¸º null é€ æˆç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œåº”è¯¥æŠŠå¸¸é‡æ”¾å‰é¢ï¼Œå°±èƒ½é¿å…ç©ºæŒ‡é’ˆå¼‚å¸¸ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">if(SUCCESS.equals(status))&#123;\n    \n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªåº”è¯¥åœ¨å„ç§å¼€å‘è§„èŒƒé‡Œé¢éƒ½ä¼šæåˆ°ï¼Œä¹Ÿæ˜¯æœ€åŸºç¡€çš„ã€‚</p>\n<h4 id=\"2ã€åˆå§‹åŒ–é»˜è®¤å€¼\"><a href=\"#2ã€åˆå§‹åŒ–é»˜è®¤å€¼\" class=\"headerlink\" title=\"2ã€åˆå§‹åŒ–é»˜è®¤å€¼\"></a>2ã€åˆå§‹åŒ–é»˜è®¤å€¼</h4><p>åœ¨å¯¹è±¡åˆå§‹åŒ–çš„æ—¶å€™ç»™å®ƒä¸€ä¸ªé»˜è®¤å€¼æˆ–è€…é»˜è®¤æ„é€ å®ç°ï¼Œå¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">User user &#x3D; new User();\nString name &#x3D; StringUtils.EMPTY;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h4 id=\"3ã€è¿”å›ç©ºé›†åˆ\"><a href=\"#3ã€è¿”å›ç©ºé›†åˆ\" class=\"headerlink\" title=\"3ã€è¿”å›ç©ºé›†åˆ\"></a>3ã€è¿”å›ç©ºé›†åˆ</h4><p>åœ¨è¿”å›ä¸€ä¸ªé›†åˆçš„è¯ï¼Œé»˜è®¤ä¼šæ˜¯ nullï¼Œç»Ÿä¸€è§„èŒƒè¿”å›ä¸€ä¸ªç©ºé›†åˆã€‚</p>\n<p>ä¸¾ä¸ª List ä¾‹å­ï¼Œå¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public List getUserList()&#123;\n    List list &#x3D; userMapper.gerUserList();\n    return list &#x3D;&#x3D; null ? new ArrayList() : list;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™æ ·æ¥æ”¶æ–¹å°±ä¸ç”¨æ‹…å¿ƒç©ºæŒ‡é’ˆå¼‚å¸¸äº†ï¼Œä¹Ÿä¸ä¼šå½±å“ä¸šåŠ¡ã€‚</p>\n<h4 id=\"4ã€æ–­è¨€\"><a href=\"#4ã€æ–­è¨€\" class=\"headerlink\" title=\"4ã€æ–­è¨€\"></a>4ã€æ–­è¨€</h4><p>æ–­è¨€æ˜¯ç”¨æ¥æ£€æŸ¥ç¨‹åºçš„å®‰å…¨æ€§çš„ï¼Œåœ¨ä½¿ç”¨ä¹‹å‰è¿›è¡Œæ£€æŸ¥æ¡ä»¶ï¼Œå¦‚æœä¸ç¬¦åˆæ¡ä»¶å°±æŠ¥å¼‚å¸¸ï¼Œç¬¦åˆå°±ç»§ç»­ã€‚</p>\n<p>Java ä¸­è‡ªå¸¦çš„æ–­è¨€å…³é”®å­—ï¼šassertï¼Œå¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">assert name &#x3D;&#x3D; null : &quot;åç§°ä¸èƒ½ä¸ºç©º&quot;;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>è¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Exception in thread &quot;main&quot; java.lang.AssertionError: åç§°ä¸æ­£ç¡®<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>ä¸è¿‡é»˜è®¤æ˜¯ä¸å¯åŠ¨æ–­è¨€æ£€æŸ¥çš„ï¼Œéœ€è¦è¦å¸¦ä¸Š JVM å‚æ•°ï¼š-enableassertions æ‰èƒ½ç”Ÿæ•ˆã€‚</p>\n<p>Java ä¸­è¿™ä¸ªç”¨çš„å¾ˆå°‘ï¼Œå»ºè®®ä½¿ç”¨ Spring ä¸­çš„ï¼Œæ›´å¼ºå¤§ï¼Œæ›´æ–¹ä¾¿å¥½ç”¨ã€‚</p>\n<p>Springä¸­çš„ç”¨æ³•ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Assert.notNull(name,&quot;åç§°ä¸èƒ½ä¸ºç©º&quot;);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"5ã€Optional\"><a href=\"#5ã€Optional\" class=\"headerlink\" title=\"5ã€Optional\"></a>5ã€Optional</h4><p>Optional æ˜¯ JDK 8 æ–°å¢çš„æ–°ç‰¹æ€§ï¼Œå†ä¹Ÿä¸ç”¨ !&#x3D; null æ¥åˆ¤æ–­äº†ï¼Œè¿™ä¸ªåœ¨ä¸€ä¸ªå¯¹è±¡é‡Œé¢çš„å¤šä¸ªå­å¯¹è±¡è¿ç»­åˆ¤æ–­çš„æ—¶å€™éå¸¸æœ‰ç”¨ã€‚</p>\n<p>è¿™é‡Œä¸å†è¯¦ç»†ä»‹ç»äº†ï¼Œå…·ä½“çœ‹è¿™ç¯‡æ–‡ç« ï¼š<a href=\"https://mp.weixin.qq.com/s/uXw4eTZqLfj871FlciPh6Q\">JDK8æ–°ç‰¹æ€§ä¹‹Optional</a>ã€‚</p>\n<p>å¤§å®¶éƒ½æœ‰ä»€ä¹ˆé«˜è§ï¼Œæ¬¢è¿ç•™è¨€åˆ†äº«ï¼</p>\n"},{"title":"å­—ç¬¦ä¸² substring æ–¹æ³•åœ¨ JDK 6,7,8 ä¸­çš„å·®å¼‚ã€‚","date":"2025-10-15T03:36:33.000Z","_content":"\næ ‡é¢˜ä¸­çš„substringæ–¹æ³•æŒ‡çš„æ˜¯å­—ç¬¦ä¸²çš„substring(int beginIndex, int endIndex)æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•åœ¨jdk6,7æ˜¯æœ‰å·®å¼‚çš„ã€‚\n\n## substringæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\n\nsubstringè¿”å›çš„æ˜¯å­—ç¬¦ä¸²ç´¢å¼•ä½ç½®beginIndexå¼€å§‹ï¼ŒendIndex-1ç»“æŸçš„å­—ç¬¦ä¸²ã€‚\n\næ¥çœ‹è¿™ä¸ªä¾‹å­ï¼š\n\n```\nString x = \"abcdef\";\nx = x.substring(1,3);\nSystem.out.println(x);\n```\nè¾“å‡ºï¼š\n\n```\nbc\n```\n\nä¸‹é¢çœ‹çœ‹åœ¨JDKä¹‹é—´ï¼Œå®ƒä»¬çš„å®ç°åŸç†æœ‰ä»€ä¹ˆä¸ä¸€æ ·ï¼ŒåŠå€¼å¾—æ³¨æ„çš„åœ°æ–¹ã€‚\n\n#### JDK 6\n\nStringèƒŒåæ˜¯ç”±charæ•°ç»„æ„æˆçš„ï¼Œåœ¨JDK6ä¸­ï¼ŒStringåŒ…å«ä¸‰ä¸ªå­—æ®µï¼šchar value[], int offset, int countï¼Œæ„æ€å¾ˆç®€å•ã€‚\n\nsubstringè¢«è°ƒç”¨æ—¶ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œä½†å­—ç¬¦ä¸²çš„å€¼è¿˜æŒ‡å‘å †ä¸­åŒæ ·çš„å­—ç¬¦æ•°ç»„ã€‚å®ƒä»¬çš„åŒºåˆ«åªæ˜¯æ•°é‡å’Œä¸‹æ ‡å¼•ç”¨ä¸ä¸€æ ·ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚\n\n![image](https://www.programcreek.com/wp-content/uploads/2013/09/string-substring-jdk6-650x389.jpeg)\n\nJDK6ä¸­çš„éƒ¨åˆ†æºç å¯ä»¥è¯´æ˜è¿™ä¸ªé—®é¢˜ã€‚\n\n```\n//JDK 6\nString(int offset, int count, char value[]) {\n\tthis.value = value;\n\tthis.offset = offset;\n\tthis.count = count;\n}\n \npublic String substring(int beginIndex, int endIndex) {\n\t//check boundary\n\treturn  new String(offset + beginIndex, endIndex - beginIndex, value);\n}\n```\n\n**ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ**\n\nå¦‚æœä¸€ä¸ªå¾ˆé•¿çš„å­—ç¬¦ä¸²ï¼Œä½†æ˜¯æ¯æ¬¡ä½¿ç”¨substring()ï¼Œä½ åªéœ€è¦å¾ˆå°çš„ä¸€éƒ¨åˆ†ã€‚è¿™å°†ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œå› ä¸ºåªéœ€è¦ä¸€å°éƒ¨åˆ†ï¼Œå´å¼•ç”¨äº†æ•´ä¸ªå­—ç¬¦æ•°ç»„å†…å®¹ã€‚å¯¹äºJDK 6ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨ä»¥ä¸‹å†…å®¹ï¼š\n\n```\nx = x.substring(x, y) + \"\"\n```\n\n#### JDK 7,8\n\nJDK6è¿™ç§é—®é¢˜åœ¨JDK7+ä¸­å·²ç»æ”¹å–„äº†ï¼ŒJDK7+ä¸­å®é™…æ˜¯é‡æ–°åˆ›å»ºäº†ä¸€ä¸ªå­—ç¬¦æ•°ç»„ï¼Œå¦‚å›¾ã€‚\n\n![image](https://www.programcreek.com/wp-content/uploads/2013/09/string-substring-jdk71-650x389.jpeg)\n\n\nJDK7ä¸­çš„éƒ¨åˆ†æºç ï¼ŒJDK8ç±»ä¼¼ã€‚\n\n```\n//JDK 7\npublic String(char value[], int offset, int count) {\n\t//check boundary\n\tthis.value = Arrays.copyOfRange(value, offset, offset + count);\n}\n \npublic String substring(int beginIndex, int endIndex) {\n\t//check boundary\n\tint subLen = endIndex - beginIndex;\n\treturn new String(value, beginIndex, subLen);\n}\n```\n\nå¯¹äºJDKçš„è¿™ç§å·®å¼‚ï¼Œæˆ‘ä»¬çŸ¥é“å°±å¥½ï¼Œç°åœ¨åº”è¯¥éƒ½æ˜¯JDK7åŠ8äº†å§ï¼Œå…¶å®å¯¹äºå°å­—ç¬¦ä¸²çš„è¿™ç§æ“ä½œæ€§èƒ½ä¹Ÿæ˜¯å¯ä»¥å¿½ç•¥ä¸è®¡çš„ã€‚\n\n","source":"_posts/è¿›é˜¶/å­—ç¬¦ä¸² substring æ–¹æ³•åœ¨ JDK 6,7,8 ä¸­çš„å·®å¼‚ã€‚.md","raw":"---\ntitle: å­—ç¬¦ä¸² substring æ–¹æ³•åœ¨ JDK 6,7,8 ä¸­çš„å·®å¼‚ã€‚\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: è¿›é˜¶\n---\n\næ ‡é¢˜ä¸­çš„substringæ–¹æ³•æŒ‡çš„æ˜¯å­—ç¬¦ä¸²çš„substring(int beginIndex, int endIndex)æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•åœ¨jdk6,7æ˜¯æœ‰å·®å¼‚çš„ã€‚\n\n## substringæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\n\nsubstringè¿”å›çš„æ˜¯å­—ç¬¦ä¸²ç´¢å¼•ä½ç½®beginIndexå¼€å§‹ï¼ŒendIndex-1ç»“æŸçš„å­—ç¬¦ä¸²ã€‚\n\næ¥çœ‹è¿™ä¸ªä¾‹å­ï¼š\n\n```\nString x = \"abcdef\";\nx = x.substring(1,3);\nSystem.out.println(x);\n```\nè¾“å‡ºï¼š\n\n```\nbc\n```\n\nä¸‹é¢çœ‹çœ‹åœ¨JDKä¹‹é—´ï¼Œå®ƒä»¬çš„å®ç°åŸç†æœ‰ä»€ä¹ˆä¸ä¸€æ ·ï¼ŒåŠå€¼å¾—æ³¨æ„çš„åœ°æ–¹ã€‚\n\n#### JDK 6\n\nStringèƒŒåæ˜¯ç”±charæ•°ç»„æ„æˆçš„ï¼Œåœ¨JDK6ä¸­ï¼ŒStringåŒ…å«ä¸‰ä¸ªå­—æ®µï¼šchar value[], int offset, int countï¼Œæ„æ€å¾ˆç®€å•ã€‚\n\nsubstringè¢«è°ƒç”¨æ—¶ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œä½†å­—ç¬¦ä¸²çš„å€¼è¿˜æŒ‡å‘å †ä¸­åŒæ ·çš„å­—ç¬¦æ•°ç»„ã€‚å®ƒä»¬çš„åŒºåˆ«åªæ˜¯æ•°é‡å’Œä¸‹æ ‡å¼•ç”¨ä¸ä¸€æ ·ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚\n\n![image](https://www.programcreek.com/wp-content/uploads/2013/09/string-substring-jdk6-650x389.jpeg)\n\nJDK6ä¸­çš„éƒ¨åˆ†æºç å¯ä»¥è¯´æ˜è¿™ä¸ªé—®é¢˜ã€‚\n\n```\n//JDK 6\nString(int offset, int count, char value[]) {\n\tthis.value = value;\n\tthis.offset = offset;\n\tthis.count = count;\n}\n \npublic String substring(int beginIndex, int endIndex) {\n\t//check boundary\n\treturn  new String(offset + beginIndex, endIndex - beginIndex, value);\n}\n```\n\n**ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ**\n\nå¦‚æœä¸€ä¸ªå¾ˆé•¿çš„å­—ç¬¦ä¸²ï¼Œä½†æ˜¯æ¯æ¬¡ä½¿ç”¨substring()ï¼Œä½ åªéœ€è¦å¾ˆå°çš„ä¸€éƒ¨åˆ†ã€‚è¿™å°†ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œå› ä¸ºåªéœ€è¦ä¸€å°éƒ¨åˆ†ï¼Œå´å¼•ç”¨äº†æ•´ä¸ªå­—ç¬¦æ•°ç»„å†…å®¹ã€‚å¯¹äºJDK 6ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨ä»¥ä¸‹å†…å®¹ï¼š\n\n```\nx = x.substring(x, y) + \"\"\n```\n\n#### JDK 7,8\n\nJDK6è¿™ç§é—®é¢˜åœ¨JDK7+ä¸­å·²ç»æ”¹å–„äº†ï¼ŒJDK7+ä¸­å®é™…æ˜¯é‡æ–°åˆ›å»ºäº†ä¸€ä¸ªå­—ç¬¦æ•°ç»„ï¼Œå¦‚å›¾ã€‚\n\n![image](https://www.programcreek.com/wp-content/uploads/2013/09/string-substring-jdk71-650x389.jpeg)\n\n\nJDK7ä¸­çš„éƒ¨åˆ†æºç ï¼ŒJDK8ç±»ä¼¼ã€‚\n\n```\n//JDK 7\npublic String(char value[], int offset, int count) {\n\t//check boundary\n\tthis.value = Arrays.copyOfRange(value, offset, offset + count);\n}\n \npublic String substring(int beginIndex, int endIndex) {\n\t//check boundary\n\tint subLen = endIndex - beginIndex;\n\treturn new String(value, beginIndex, subLen);\n}\n```\n\nå¯¹äºJDKçš„è¿™ç§å·®å¼‚ï¼Œæˆ‘ä»¬çŸ¥é“å°±å¥½ï¼Œç°åœ¨åº”è¯¥éƒ½æ˜¯JDK7åŠ8äº†å§ï¼Œå…¶å®å¯¹äºå°å­—ç¬¦ä¸²çš„è¿™ç§æ“ä½œæ€§èƒ½ä¹Ÿæ˜¯å¯ä»¥å¿½ç•¥ä¸è®¡çš„ã€‚\n\n","slug":"è¿›é˜¶/å­—ç¬¦ä¸² substring æ–¹æ³•åœ¨ JDK 6,7,8 ä¸­çš„å·®å¼‚ã€‚","published":1,"updated":"2025-10-15T07:21:14.239Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076j001aqkd4f4878bo7","content":"<p>æ ‡é¢˜ä¸­çš„substringæ–¹æ³•æŒ‡çš„æ˜¯å­—ç¬¦ä¸²çš„substring(int beginIndex, int endIndex)æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•åœ¨jdk6,7æ˜¯æœ‰å·®å¼‚çš„ã€‚</p>\n<h2 id=\"substringæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\"><a href=\"#substringæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\" class=\"headerlink\" title=\"substringæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\"></a>substringæœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h2><p>substringè¿”å›çš„æ˜¯å­—ç¬¦ä¸²ç´¢å¼•ä½ç½®beginIndexå¼€å§‹ï¼ŒendIndex-1ç»“æŸçš„å­—ç¬¦ä¸²ã€‚</p>\n<p>æ¥çœ‹è¿™ä¸ªä¾‹å­ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">String x &#x3D; &quot;abcdef&quot;;\nx &#x3D; x.substring(1,3);\nSystem.out.println(x);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>è¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">bc<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>ä¸‹é¢çœ‹çœ‹åœ¨JDKä¹‹é—´ï¼Œå®ƒä»¬çš„å®ç°åŸç†æœ‰ä»€ä¹ˆä¸ä¸€æ ·ï¼ŒåŠå€¼å¾—æ³¨æ„çš„åœ°æ–¹ã€‚</p>\n<h4 id=\"JDK-6\"><a href=\"#JDK-6\" class=\"headerlink\" title=\"JDK 6\"></a>JDK 6</h4><p>StringèƒŒåæ˜¯ç”±charæ•°ç»„æ„æˆçš„ï¼Œåœ¨JDK6ä¸­ï¼ŒStringåŒ…å«ä¸‰ä¸ªå­—æ®µï¼šchar value[], int offset, int countï¼Œæ„æ€å¾ˆç®€å•ã€‚</p>\n<p>substringè¢«è°ƒç”¨æ—¶ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œä½†å­—ç¬¦ä¸²çš„å€¼è¿˜æŒ‡å‘å †ä¸­åŒæ ·çš„å­—ç¬¦æ•°ç»„ã€‚å®ƒä»¬çš„åŒºåˆ«åªæ˜¯æ•°é‡å’Œä¸‹æ ‡å¼•ç”¨ä¸ä¸€æ ·ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚</p>\n<p><img src=\"https://www.programcreek.com/wp-content/uploads/2013/09/string-substring-jdk6-650x389.jpeg\" alt=\"image\"></p>\n<p>JDK6ä¸­çš„éƒ¨åˆ†æºç å¯ä»¥è¯´æ˜è¿™ä¸ªé—®é¢˜ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F;JDK 6\nString(int offset, int count, char value[]) &#123;\n\tthis.value &#x3D; value;\n\tthis.offset &#x3D; offset;\n\tthis.count &#x3D; count;\n&#125;\n \npublic String substring(int beginIndex, int endIndex) &#123;\n\t&#x2F;&#x2F;check boundary\n\treturn  new String(offset + beginIndex, endIndex - beginIndex, value);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ</strong></p>\n<p>å¦‚æœä¸€ä¸ªå¾ˆé•¿çš„å­—ç¬¦ä¸²ï¼Œä½†æ˜¯æ¯æ¬¡ä½¿ç”¨substring()ï¼Œä½ åªéœ€è¦å¾ˆå°çš„ä¸€éƒ¨åˆ†ã€‚è¿™å°†ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œå› ä¸ºåªéœ€è¦ä¸€å°éƒ¨åˆ†ï¼Œå´å¼•ç”¨äº†æ•´ä¸ªå­—ç¬¦æ•°ç»„å†…å®¹ã€‚å¯¹äºJDK 6ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨ä»¥ä¸‹å†…å®¹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">x &#x3D; x.substring(x, y) + &quot;&quot;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"JDK-7-8\"><a href=\"#JDK-7-8\" class=\"headerlink\" title=\"JDK 7,8\"></a>JDK 7,8</h4><p>JDK6è¿™ç§é—®é¢˜åœ¨JDK7+ä¸­å·²ç»æ”¹å–„äº†ï¼ŒJDK7+ä¸­å®é™…æ˜¯é‡æ–°åˆ›å»ºäº†ä¸€ä¸ªå­—ç¬¦æ•°ç»„ï¼Œå¦‚å›¾ã€‚</p>\n<p><img src=\"https://www.programcreek.com/wp-content/uploads/2013/09/string-substring-jdk71-650x389.jpeg\" alt=\"image\"></p>\n<p>JDK7ä¸­çš„éƒ¨åˆ†æºç ï¼ŒJDK8ç±»ä¼¼ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F;JDK 7\npublic String(char value[], int offset, int count) &#123;\n\t&#x2F;&#x2F;check boundary\n\tthis.value &#x3D; Arrays.copyOfRange(value, offset, offset + count);\n&#125;\n \npublic String substring(int beginIndex, int endIndex) &#123;\n\t&#x2F;&#x2F;check boundary\n\tint subLen &#x3D; endIndex - beginIndex;\n\treturn new String(value, beginIndex, subLen);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯¹äºJDKçš„è¿™ç§å·®å¼‚ï¼Œæˆ‘ä»¬çŸ¥é“å°±å¥½ï¼Œç°åœ¨åº”è¯¥éƒ½æ˜¯JDK7åŠ8äº†å§ï¼Œå…¶å®å¯¹äºå°å­—ç¬¦ä¸²çš„è¿™ç§æ“ä½œæ€§èƒ½ä¹Ÿæ˜¯å¯ä»¥å¿½ç•¥ä¸è®¡çš„ã€‚</p>\n","excerpt":"","more":"<p>æ ‡é¢˜ä¸­çš„substringæ–¹æ³•æŒ‡çš„æ˜¯å­—ç¬¦ä¸²çš„substring(int beginIndex, int endIndex)æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•åœ¨jdk6,7æ˜¯æœ‰å·®å¼‚çš„ã€‚</p>\n<h2 id=\"substringæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\"><a href=\"#substringæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\" class=\"headerlink\" title=\"substringæœ‰ä»€ä¹ˆç”¨ï¼Ÿ\"></a>substringæœ‰ä»€ä¹ˆç”¨ï¼Ÿ</h2><p>substringè¿”å›çš„æ˜¯å­—ç¬¦ä¸²ç´¢å¼•ä½ç½®beginIndexå¼€å§‹ï¼ŒendIndex-1ç»“æŸçš„å­—ç¬¦ä¸²ã€‚</p>\n<p>æ¥çœ‹è¿™ä¸ªä¾‹å­ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">String x &#x3D; &quot;abcdef&quot;;\nx &#x3D; x.substring(1,3);\nSystem.out.println(x);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>è¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">bc<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>ä¸‹é¢çœ‹çœ‹åœ¨JDKä¹‹é—´ï¼Œå®ƒä»¬çš„å®ç°åŸç†æœ‰ä»€ä¹ˆä¸ä¸€æ ·ï¼ŒåŠå€¼å¾—æ³¨æ„çš„åœ°æ–¹ã€‚</p>\n<h4 id=\"JDK-6\"><a href=\"#JDK-6\" class=\"headerlink\" title=\"JDK 6\"></a>JDK 6</h4><p>StringèƒŒåæ˜¯ç”±charæ•°ç»„æ„æˆçš„ï¼Œåœ¨JDK6ä¸­ï¼ŒStringåŒ…å«ä¸‰ä¸ªå­—æ®µï¼šchar value[], int offset, int countï¼Œæ„æ€å¾ˆç®€å•ã€‚</p>\n<p>substringè¢«è°ƒç”¨æ—¶ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²ï¼Œä½†å­—ç¬¦ä¸²çš„å€¼è¿˜æŒ‡å‘å †ä¸­åŒæ ·çš„å­—ç¬¦æ•°ç»„ã€‚å®ƒä»¬çš„åŒºåˆ«åªæ˜¯æ•°é‡å’Œä¸‹æ ‡å¼•ç”¨ä¸ä¸€æ ·ï¼Œå¦‚å›¾æ‰€ç¤ºã€‚</p>\n<p><img src=\"https://www.programcreek.com/wp-content/uploads/2013/09/string-substring-jdk6-650x389.jpeg\" alt=\"image\"></p>\n<p>JDK6ä¸­çš„éƒ¨åˆ†æºç å¯ä»¥è¯´æ˜è¿™ä¸ªé—®é¢˜ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F;JDK 6\nString(int offset, int count, char value[]) &#123;\n\tthis.value &#x3D; value;\n\tthis.offset &#x3D; offset;\n\tthis.count &#x3D; count;\n&#125;\n \npublic String substring(int beginIndex, int endIndex) &#123;\n\t&#x2F;&#x2F;check boundary\n\treturn  new String(offset + beginIndex, endIndex - beginIndex, value);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>ä¼šæœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ</strong></p>\n<p>å¦‚æœä¸€ä¸ªå¾ˆé•¿çš„å­—ç¬¦ä¸²ï¼Œä½†æ˜¯æ¯æ¬¡ä½¿ç”¨substring()ï¼Œä½ åªéœ€è¦å¾ˆå°çš„ä¸€éƒ¨åˆ†ã€‚è¿™å°†ä¼šå¯¼è‡´æ€§èƒ½é—®é¢˜ï¼Œå› ä¸ºåªéœ€è¦ä¸€å°éƒ¨åˆ†ï¼Œå´å¼•ç”¨äº†æ•´ä¸ªå­—ç¬¦æ•°ç»„å†…å®¹ã€‚å¯¹äºJDK 6ï¼Œè§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨ä»¥ä¸‹å†…å®¹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">x &#x3D; x.substring(x, y) + &quot;&quot;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"JDK-7-8\"><a href=\"#JDK-7-8\" class=\"headerlink\" title=\"JDK 7,8\"></a>JDK 7,8</h4><p>JDK6è¿™ç§é—®é¢˜åœ¨JDK7+ä¸­å·²ç»æ”¹å–„äº†ï¼ŒJDK7+ä¸­å®é™…æ˜¯é‡æ–°åˆ›å»ºäº†ä¸€ä¸ªå­—ç¬¦æ•°ç»„ï¼Œå¦‚å›¾ã€‚</p>\n<p><img src=\"https://www.programcreek.com/wp-content/uploads/2013/09/string-substring-jdk71-650x389.jpeg\" alt=\"image\"></p>\n<p>JDK7ä¸­çš„éƒ¨åˆ†æºç ï¼ŒJDK8ç±»ä¼¼ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F;JDK 7\npublic String(char value[], int offset, int count) &#123;\n\t&#x2F;&#x2F;check boundary\n\tthis.value &#x3D; Arrays.copyOfRange(value, offset, offset + count);\n&#125;\n \npublic String substring(int beginIndex, int endIndex) &#123;\n\t&#x2F;&#x2F;check boundary\n\tint subLen &#x3D; endIndex - beginIndex;\n\treturn new String(value, beginIndex, subLen);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯¹äºJDKçš„è¿™ç§å·®å¼‚ï¼Œæˆ‘ä»¬çŸ¥é“å°±å¥½ï¼Œç°åœ¨åº”è¯¥éƒ½æ˜¯JDK7åŠ8äº†å§ï¼Œå…¶å®å¯¹äºå°å­—ç¬¦ä¸²çš„è¿™ç§æ“ä½œæ€§èƒ½ä¹Ÿæ˜¯å¯ä»¥å¿½ç•¥ä¸è®¡çš„ã€‚</p>\n"},{"title":"ç¥å¥‡ï¼Œæ•™ä½ ç”¨éšæœºæ•°æ‰“å°hello world","date":"2025-10-15T03:36:33.000Z","_content":"ä¸‹é¢æ˜¯ä¸€æ®µéšæœºæ•°ç¨‹åºã€‚\n\n```\npublic static void main(String[] args) {\n\tSystem.out.println(randomString(-229985452) + \" \" + randomString(-147909649));\n}\n\npublic static String randomString(int seed) {\n\tRandom ran = new Random(seed);\n\tStringBuilder sb = new StringBuilder();\n\twhile (true) {\n\t\tint k = ran.nextInt(27);\n\t\tif (k == 0) {\n\t\t\tbreak;\n\t\t}\n\t\tsb.append((char) ('`' + k));\n\t}\n\treturn sb.toString();\n}\n```\n\n**æ¯æ¬¡éƒ½ä¼šè¾“å‡ºï¼šhello worldï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿï¼Ÿ**\n\nRandomæ„é€ å‡½æ•°ï¼Œå‚æ•°seedæ˜¯åˆå§‹ç§å­ï¼Œç›¸åŒçš„ç§å­æ¯æ¬¡äº§ç”Ÿçš„éšæœºæ•°éƒ½ä¸€æ ·ï¼Œæ‰€ä»¥æ— è®ºæ€ä¹ˆéšæœºï¼Œæ„é€ å‡ºæ¥çš„éšæœºæ•°éƒ½ä¸€æ ·ã€‚\n\n**Random r = new Random(-229985452)**\n\nä¼šäº§ç”Ÿä»¥ä¸‹5ä½ä¸ä¸º0çš„éšæœºæ•°ï¼š\n\n\n```\n8\n5\n12\n12\n15\n```\n\n**Random r = new Random(-147909649)**\n\nä¼šäº§ç”Ÿä»¥ä¸‹5ä½ä¸ä¸º0çš„éšæœºæ•°ï¼š\n\n\n```\n23\n15\n18\n12\n4\n```\n\nç¨‹åºé‡Œé¢ç”¨\\`ç¬¦å·ç›¸åŠ ï¼Œ\\`ä»£è¡¨96.\n\næ‰€ä»¥ï¼Œæœ‰ä¸‹é¢çš„ç»“æœï¼š\n\n\n```\n8  + 96 = 104 --> h\n5  + 96 = 101 --> e\n12 + 96 = 108 --> l\n12 + 96 = 108 --> l\n15 + 96 = 111 --> o\n\n23 + 96 = 119 --> w\n15 + 96 = 111 --> o\n18 + 96 = 114 --> r\n12 + 96 = 108 --> l\n4  + 96 = 100 --> d\n```\n\nä¸€æ®µå¾ˆç®€å•çš„ç¨‹åºå´å¦‚æ­¤ç¥å¥‡ï¼Œåˆ†äº«ç»™åˆ«äººï¼Œçœ‹ä»–çŸ¥é“ä¸ï¼Ÿ\n\n","source":"_posts/è¿›é˜¶/ç¥å¥‡ï¼Œæ•™ä½ ç”¨éšæœºæ•°æ‰“å°hello world.md","raw":"---\ntitle: ç¥å¥‡ï¼Œæ•™ä½ ç”¨éšæœºæ•°æ‰“å°hello world\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: è¿›é˜¶\n---\nä¸‹é¢æ˜¯ä¸€æ®µéšæœºæ•°ç¨‹åºã€‚\n\n```\npublic static void main(String[] args) {\n\tSystem.out.println(randomString(-229985452) + \" \" + randomString(-147909649));\n}\n\npublic static String randomString(int seed) {\n\tRandom ran = new Random(seed);\n\tStringBuilder sb = new StringBuilder();\n\twhile (true) {\n\t\tint k = ran.nextInt(27);\n\t\tif (k == 0) {\n\t\t\tbreak;\n\t\t}\n\t\tsb.append((char) ('`' + k));\n\t}\n\treturn sb.toString();\n}\n```\n\n**æ¯æ¬¡éƒ½ä¼šè¾“å‡ºï¼šhello worldï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿï¼Ÿ**\n\nRandomæ„é€ å‡½æ•°ï¼Œå‚æ•°seedæ˜¯åˆå§‹ç§å­ï¼Œç›¸åŒçš„ç§å­æ¯æ¬¡äº§ç”Ÿçš„éšæœºæ•°éƒ½ä¸€æ ·ï¼Œæ‰€ä»¥æ— è®ºæ€ä¹ˆéšæœºï¼Œæ„é€ å‡ºæ¥çš„éšæœºæ•°éƒ½ä¸€æ ·ã€‚\n\n**Random r = new Random(-229985452)**\n\nä¼šäº§ç”Ÿä»¥ä¸‹5ä½ä¸ä¸º0çš„éšæœºæ•°ï¼š\n\n\n```\n8\n5\n12\n12\n15\n```\n\n**Random r = new Random(-147909649)**\n\nä¼šäº§ç”Ÿä»¥ä¸‹5ä½ä¸ä¸º0çš„éšæœºæ•°ï¼š\n\n\n```\n23\n15\n18\n12\n4\n```\n\nç¨‹åºé‡Œé¢ç”¨\\`ç¬¦å·ç›¸åŠ ï¼Œ\\`ä»£è¡¨96.\n\næ‰€ä»¥ï¼Œæœ‰ä¸‹é¢çš„ç»“æœï¼š\n\n\n```\n8  + 96 = 104 --> h\n5  + 96 = 101 --> e\n12 + 96 = 108 --> l\n12 + 96 = 108 --> l\n15 + 96 = 111 --> o\n\n23 + 96 = 119 --> w\n15 + 96 = 111 --> o\n18 + 96 = 114 --> r\n12 + 96 = 108 --> l\n4  + 96 = 100 --> d\n```\n\nä¸€æ®µå¾ˆç®€å•çš„ç¨‹åºå´å¦‚æ­¤ç¥å¥‡ï¼Œåˆ†äº«ç»™åˆ«äººï¼Œçœ‹ä»–çŸ¥é“ä¸ï¼Ÿ\n\n","slug":"è¿›é˜¶/ç¥å¥‡ï¼Œæ•™ä½ ç”¨éšæœºæ•°æ‰“å°hello world","published":1,"updated":"2025-10-15T07:21:14.215Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076j001dqkd4d422aq8t","content":"<p>ä¸‹é¢æ˜¯ä¸€æ®µéšæœºæ•°ç¨‹åºã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n\tSystem.out.println(randomString(-229985452) + &quot; &quot; + randomString(-147909649));\n&#125;\n\npublic static String randomString(int seed) &#123;\n\tRandom ran &#x3D; new Random(seed);\n\tStringBuilder sb &#x3D; new StringBuilder();\n\twhile (true) &#123;\n\t\tint k &#x3D; ran.nextInt(27);\n\t\tif (k &#x3D;&#x3D; 0) &#123;\n\t\t\tbreak;\n\t\t&#125;\n\t\tsb.append((char) (&#39;&#96;&#39; + k));\n\t&#125;\n\treturn sb.toString();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>æ¯æ¬¡éƒ½ä¼šè¾“å‡ºï¼šhello worldï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿï¼Ÿ</strong></p>\n<p>Randomæ„é€ å‡½æ•°ï¼Œå‚æ•°seedæ˜¯åˆå§‹ç§å­ï¼Œç›¸åŒçš„ç§å­æ¯æ¬¡äº§ç”Ÿçš„éšæœºæ•°éƒ½ä¸€æ ·ï¼Œæ‰€ä»¥æ— è®ºæ€ä¹ˆéšæœºï¼Œæ„é€ å‡ºæ¥çš„éšæœºæ•°éƒ½ä¸€æ ·ã€‚</p>\n<p><strong>Random r &#x3D; new Random(-229985452)</strong></p>\n<p>ä¼šäº§ç”Ÿä»¥ä¸‹5ä½ä¸ä¸º0çš„éšæœºæ•°ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">8\n5\n12\n12\n15<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>Random r &#x3D; new Random(-147909649)</strong></p>\n<p>ä¼šäº§ç”Ÿä»¥ä¸‹5ä½ä¸ä¸º0çš„éšæœºæ•°ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">23\n15\n18\n12\n4<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºé‡Œé¢ç”¨`ç¬¦å·ç›¸åŠ ï¼Œ`ä»£è¡¨96.</p>\n<p>æ‰€ä»¥ï¼Œæœ‰ä¸‹é¢çš„ç»“æœï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">8  + 96 &#x3D; 104 --&gt; h\n5  + 96 &#x3D; 101 --&gt; e\n12 + 96 &#x3D; 108 --&gt; l\n12 + 96 &#x3D; 108 --&gt; l\n15 + 96 &#x3D; 111 --&gt; o\n\n23 + 96 &#x3D; 119 --&gt; w\n15 + 96 &#x3D; 111 --&gt; o\n18 + 96 &#x3D; 114 --&gt; r\n12 + 96 &#x3D; 108 --&gt; l\n4  + 96 &#x3D; 100 --&gt; d<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä¸€æ®µå¾ˆç®€å•çš„ç¨‹åºå´å¦‚æ­¤ç¥å¥‡ï¼Œåˆ†äº«ç»™åˆ«äººï¼Œçœ‹ä»–çŸ¥é“ä¸ï¼Ÿ</p>\n","excerpt":"","more":"<p>ä¸‹é¢æ˜¯ä¸€æ®µéšæœºæ•°ç¨‹åºã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n\tSystem.out.println(randomString(-229985452) + &quot; &quot; + randomString(-147909649));\n&#125;\n\npublic static String randomString(int seed) &#123;\n\tRandom ran &#x3D; new Random(seed);\n\tStringBuilder sb &#x3D; new StringBuilder();\n\twhile (true) &#123;\n\t\tint k &#x3D; ran.nextInt(27);\n\t\tif (k &#x3D;&#x3D; 0) &#123;\n\t\t\tbreak;\n\t\t&#125;\n\t\tsb.append((char) (&#39;&#96;&#39; + k));\n\t&#125;\n\treturn sb.toString();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>æ¯æ¬¡éƒ½ä¼šè¾“å‡ºï¼šhello worldï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿï¼Ÿ</strong></p>\n<p>Randomæ„é€ å‡½æ•°ï¼Œå‚æ•°seedæ˜¯åˆå§‹ç§å­ï¼Œç›¸åŒçš„ç§å­æ¯æ¬¡äº§ç”Ÿçš„éšæœºæ•°éƒ½ä¸€æ ·ï¼Œæ‰€ä»¥æ— è®ºæ€ä¹ˆéšæœºï¼Œæ„é€ å‡ºæ¥çš„éšæœºæ•°éƒ½ä¸€æ ·ã€‚</p>\n<p><strong>Random r &#x3D; new Random(-229985452)</strong></p>\n<p>ä¼šäº§ç”Ÿä»¥ä¸‹5ä½ä¸ä¸º0çš„éšæœºæ•°ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">8\n5\n12\n12\n15<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>Random r &#x3D; new Random(-147909649)</strong></p>\n<p>ä¼šäº§ç”Ÿä»¥ä¸‹5ä½ä¸ä¸º0çš„éšæœºæ•°ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">23\n15\n18\n12\n4<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºé‡Œé¢ç”¨`ç¬¦å·ç›¸åŠ ï¼Œ`ä»£è¡¨96.</p>\n<p>æ‰€ä»¥ï¼Œæœ‰ä¸‹é¢çš„ç»“æœï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">8  + 96 &#x3D; 104 --&gt; h\n5  + 96 &#x3D; 101 --&gt; e\n12 + 96 &#x3D; 108 --&gt; l\n12 + 96 &#x3D; 108 --&gt; l\n15 + 96 &#x3D; 111 --&gt; o\n\n23 + 96 &#x3D; 119 --&gt; w\n15 + 96 &#x3D; 111 --&gt; o\n18 + 96 &#x3D; 114 --&gt; r\n12 + 96 &#x3D; 108 --&gt; l\n4  + 96 &#x3D; 100 --&gt; d<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä¸€æ®µå¾ˆç®€å•çš„ç¨‹åºå´å¦‚æ­¤ç¥å¥‡ï¼Œåˆ†äº«ç»™åˆ«äººï¼Œçœ‹ä»–çŸ¥é“ä¸ï¼Ÿ</p>\n"},{"title":"é‡‘èç³»ç»Ÿä¸­æ­£ç¡®çš„é‡‘é¢è®¡ç®—åŠå­˜å‚¨æ–¹å¼","date":"2025-10-15T03:36:33.000Z","_content":"\n#### ç»å…¸çš„ç²¾åº¦ä¸¢å¤±é—®é¢˜\n\n Javaä¸­çš„ç±»å‹floatã€doubleç”¨æ¥åšè®¡ç®—ä¼šæœ‰ç²¾åº¦ä¸¢å¤±é—®é¢˜ï¼Œä¸‹é¢æ¥çœ‹ä¸‹é¢çš„ç¤ºä¾‹ã€‚\n\n```\npublic static void main(String[] args) {\n\ttest1();\n\ttest2();\n}\n\nprivate static void test1() {\n\tdouble totalAmount = 0.09;\n\tdouble feeAmount = 0.02;\n\tdouble tradeAmount = totalAmount - feeAmount;\n\tSystem.out.println(tradeAmount);\n}\n```\n\nä¸Šé¢çš„ç¨‹åºè¾“å‡ºç»“æœæ˜¯å¤šå°‘ï¼Ÿ\n\n0.07ï¼Ÿéä¹Ÿï¼\n\næ­£ç¡®çš„ç»“æœæ˜¯ï¼š\n\n\n```\n0.06999999999999999\n```\n\nä¸ºä»€ä¹ˆæ˜¯è¿™æ ·ï¼Ÿ\n\næµ®ç‚¹æ•°å¯èƒ½ä¸¢å¤±ç²¾åº¦ï¼Œæµ®ç‚¹åè¿›åˆ¶æ•°é€šå¸¸æ²¡æœ‰å®Œå…¨ç›¸åŒçš„äºŒè¿›åˆ¶çš„è¡¨ç¤ºå½¢å¼ï¼Œè¿™æ˜¯CPUæ‰€é‡‡ç”¨çš„æµ®ç‚¹æ•°æ®è¡¨ç¤ºå½¢å¼çš„å‰¯ä½œç”¨ã€‚ä¸ºæ­¤ï¼Œå¯èƒ½ä¼šæœ‰ä¸€äº›ç²¾åº¦ä¸¢å¤±ï¼Œå¹¶ä¸”ä¸€äº›æµ®ç‚¹è¿ç®—å¯èƒ½ä¼šäº§ç”ŸæœªçŸ¥çš„ç»“æœã€‚\n\næµ®ç‚¹è¿ç®—å¾ˆå°‘æ˜¯ç²¾ç¡®çš„ï¼Œåªè¦æ˜¯è¶…è¿‡ç²¾åº¦èƒ½è¡¨ç¤ºçš„èŒƒå›´å°±ä¼šäº§ç”Ÿè¯¯å·®ã€‚æ‰€ä»¥ï¼Œåœ¨ä½¿ç”¨floatã€doubleä½œç²¾ç¡®è¿ç®—çš„æ—¶å€™ä¸€å®šè¦ç‰¹åˆ«å°å¿ƒï¼Œé™¤éèƒ½å®¹å¿ç²¾åº¦ä¸¢å¤±ï¼Œä¸ç„¶äº§ç”Ÿçš„è¯¯å·®ä¹Ÿæ˜¯ä¼šé€ æˆåŒæ–¹å¯¹è´¦ä¸ä¸€è‡´çš„ç»“æœã€‚\n\n#### æ€ä¹ˆè§£å†³\n\n> åœ¨ã€ŠEffective Javaã€‹è¿™æœ¬ä¹¦ä¸­ä¹Ÿæåˆ°è¿™ä¸ªåŸåˆ™ï¼Œfloatå’Œdoubleåªèƒ½ç”¨æ¥åšç§‘å­¦è®¡ç®—æˆ–è€…æ˜¯å·¥ç¨‹è®¡ç®—ï¼Œåœ¨å•†ä¸šè®¡ç®—ä¸­æˆ‘ä»¬è¦ç”¨ java.math.BigDecimalã€‚\n\nBigDecimalé€‚åˆæ›´ç²¾åº¦çš„è¿ç®—ï¼Œä¹Ÿæä¾›äº†ä¸°å¯Œçš„æ“ä½œç¬¦ç±»å‹ï¼Œå°æ•°ä½æ§åˆ¶ï¼Œå››èˆäº”å…¥è§„åˆ™ç­‰ã€‚\n\nä¸è¿‡ï¼Œä½¿ç”¨BigDecimalä¸å½“ä¹Ÿæœ‰ç²¾åº¦ä¸¢å¤±çš„æƒ…å†µï¼Œå¦‚doubleçš„æ„é€ æ–¹æ³•ï¼š\n\n```\nBigDecimal(double val)\n```\n\nå†æ¥çœ‹è¿™ä¸ªç¤ºä¾‹ï¼š\n\n```\nprivate static void test2() {\n\tdouble totalAmount = 0.09;\n\tdouble feeAmount = 0.02;\n\tBigDecimal tradeAmount = new BigDecimal(totalAmount).subtract(new BigDecimal(feeAmount));\n\tSystem.out.println(tradeAmount);\n}\n```\n\nè¾“å‡ºï¼š\n\n```\n0.0699999999999999962529972918900966760702431201934814453125\n```\n\nè¿™ä¸ªç²¾åº¦å°±æ›´ææ€–äº†ã€‚ã€‚\n\næ‰€ä»¥ï¼Œä¸€å®šè¦ä½¿ç”¨Stringçš„æ„é€ æ–¹æ³•ï¼š\n\n```\nBigDecimal(String val)\n```\n\n```\nprivate static void test3() {\n\tdouble totalAmount = 0.09;\n\tdouble feeAmount = 0.02;\n\tBigDecimal tradeAmount = new BigDecimal(String.valueOf(totalAmount))\n\t\t\t.subtract(new BigDecimal(String.valueOf(feeAmount)));\n\tSystem.out.println(tradeAmount);\n}\n```\n\n#### æ€»ç»“\n\n1. é‡‘é¢è¿ç®—å°½é‡ä½¿ç”¨BigDecimal(String val)è¿›è¡Œè¿ç®—ã€‚\n\n1. æ•°æ®åº“å­˜å‚¨é‡‘é¢ï¼Œä¸€èˆ¬æœ‰æ•´å‹å’Œæµ®ç‚¹å‹ä¸¤ç§å­˜å‚¨æ–¹å¼ã€‚å¦‚æœæ˜¯æœ‰æ±‡ç‡è½¬æ¢çš„ï¼Œå»ºè®®ä½¿ç”¨æµ®ç‚¹æ•°decimalè¿›è¡Œå­˜å‚¨ï¼Œå¯ä»¥çµæ´»çš„æ§åˆ¶ç²¾åº¦ï¼Œdecimalç›´æ¥å¯¹åº”javaç±»å‹BigDecimalã€‚å½“ç„¶ï¼Œç”¨æ•´æ•°å­˜å‚¨åˆ†è¿™ç§å½¢å¼ä¹Ÿå¯ä»¥ï¼Œè½¬è´¦çš„æ—¶å€™å•ä½ä¸ºå…ƒè€Œå¦‚æœå¿˜äº†è½¬æ¢åˆ†ä¸ºå…ƒï¼Œé‚£å°±æ‚²å‰§äº†ã€‚","source":"_posts/è¿›é˜¶/é‡‘èç³»ç»Ÿä¸­æ­£ç¡®çš„é‡‘é¢è®¡ç®—åŠå­˜å‚¨æ–¹å¼.md","raw":"---\ntitle: é‡‘èç³»ç»Ÿä¸­æ­£ç¡®çš„é‡‘é¢è®¡ç®—åŠå­˜å‚¨æ–¹å¼\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: è¿›é˜¶\n---\n\n#### ç»å…¸çš„ç²¾åº¦ä¸¢å¤±é—®é¢˜\n\n Javaä¸­çš„ç±»å‹floatã€doubleç”¨æ¥åšè®¡ç®—ä¼šæœ‰ç²¾åº¦ä¸¢å¤±é—®é¢˜ï¼Œä¸‹é¢æ¥çœ‹ä¸‹é¢çš„ç¤ºä¾‹ã€‚\n\n```\npublic static void main(String[] args) {\n\ttest1();\n\ttest2();\n}\n\nprivate static void test1() {\n\tdouble totalAmount = 0.09;\n\tdouble feeAmount = 0.02;\n\tdouble tradeAmount = totalAmount - feeAmount;\n\tSystem.out.println(tradeAmount);\n}\n```\n\nä¸Šé¢çš„ç¨‹åºè¾“å‡ºç»“æœæ˜¯å¤šå°‘ï¼Ÿ\n\n0.07ï¼Ÿéä¹Ÿï¼\n\næ­£ç¡®çš„ç»“æœæ˜¯ï¼š\n\n\n```\n0.06999999999999999\n```\n\nä¸ºä»€ä¹ˆæ˜¯è¿™æ ·ï¼Ÿ\n\næµ®ç‚¹æ•°å¯èƒ½ä¸¢å¤±ç²¾åº¦ï¼Œæµ®ç‚¹åè¿›åˆ¶æ•°é€šå¸¸æ²¡æœ‰å®Œå…¨ç›¸åŒçš„äºŒè¿›åˆ¶çš„è¡¨ç¤ºå½¢å¼ï¼Œè¿™æ˜¯CPUæ‰€é‡‡ç”¨çš„æµ®ç‚¹æ•°æ®è¡¨ç¤ºå½¢å¼çš„å‰¯ä½œç”¨ã€‚ä¸ºæ­¤ï¼Œå¯èƒ½ä¼šæœ‰ä¸€äº›ç²¾åº¦ä¸¢å¤±ï¼Œå¹¶ä¸”ä¸€äº›æµ®ç‚¹è¿ç®—å¯èƒ½ä¼šäº§ç”ŸæœªçŸ¥çš„ç»“æœã€‚\n\næµ®ç‚¹è¿ç®—å¾ˆå°‘æ˜¯ç²¾ç¡®çš„ï¼Œåªè¦æ˜¯è¶…è¿‡ç²¾åº¦èƒ½è¡¨ç¤ºçš„èŒƒå›´å°±ä¼šäº§ç”Ÿè¯¯å·®ã€‚æ‰€ä»¥ï¼Œåœ¨ä½¿ç”¨floatã€doubleä½œç²¾ç¡®è¿ç®—çš„æ—¶å€™ä¸€å®šè¦ç‰¹åˆ«å°å¿ƒï¼Œé™¤éèƒ½å®¹å¿ç²¾åº¦ä¸¢å¤±ï¼Œä¸ç„¶äº§ç”Ÿçš„è¯¯å·®ä¹Ÿæ˜¯ä¼šé€ æˆåŒæ–¹å¯¹è´¦ä¸ä¸€è‡´çš„ç»“æœã€‚\n\n#### æ€ä¹ˆè§£å†³\n\n> åœ¨ã€ŠEffective Javaã€‹è¿™æœ¬ä¹¦ä¸­ä¹Ÿæåˆ°è¿™ä¸ªåŸåˆ™ï¼Œfloatå’Œdoubleåªèƒ½ç”¨æ¥åšç§‘å­¦è®¡ç®—æˆ–è€…æ˜¯å·¥ç¨‹è®¡ç®—ï¼Œåœ¨å•†ä¸šè®¡ç®—ä¸­æˆ‘ä»¬è¦ç”¨ java.math.BigDecimalã€‚\n\nBigDecimalé€‚åˆæ›´ç²¾åº¦çš„è¿ç®—ï¼Œä¹Ÿæä¾›äº†ä¸°å¯Œçš„æ“ä½œç¬¦ç±»å‹ï¼Œå°æ•°ä½æ§åˆ¶ï¼Œå››èˆäº”å…¥è§„åˆ™ç­‰ã€‚\n\nä¸è¿‡ï¼Œä½¿ç”¨BigDecimalä¸å½“ä¹Ÿæœ‰ç²¾åº¦ä¸¢å¤±çš„æƒ…å†µï¼Œå¦‚doubleçš„æ„é€ æ–¹æ³•ï¼š\n\n```\nBigDecimal(double val)\n```\n\nå†æ¥çœ‹è¿™ä¸ªç¤ºä¾‹ï¼š\n\n```\nprivate static void test2() {\n\tdouble totalAmount = 0.09;\n\tdouble feeAmount = 0.02;\n\tBigDecimal tradeAmount = new BigDecimal(totalAmount).subtract(new BigDecimal(feeAmount));\n\tSystem.out.println(tradeAmount);\n}\n```\n\nè¾“å‡ºï¼š\n\n```\n0.0699999999999999962529972918900966760702431201934814453125\n```\n\nè¿™ä¸ªç²¾åº¦å°±æ›´ææ€–äº†ã€‚ã€‚\n\næ‰€ä»¥ï¼Œä¸€å®šè¦ä½¿ç”¨Stringçš„æ„é€ æ–¹æ³•ï¼š\n\n```\nBigDecimal(String val)\n```\n\n```\nprivate static void test3() {\n\tdouble totalAmount = 0.09;\n\tdouble feeAmount = 0.02;\n\tBigDecimal tradeAmount = new BigDecimal(String.valueOf(totalAmount))\n\t\t\t.subtract(new BigDecimal(String.valueOf(feeAmount)));\n\tSystem.out.println(tradeAmount);\n}\n```\n\n#### æ€»ç»“\n\n1. é‡‘é¢è¿ç®—å°½é‡ä½¿ç”¨BigDecimal(String val)è¿›è¡Œè¿ç®—ã€‚\n\n1. æ•°æ®åº“å­˜å‚¨é‡‘é¢ï¼Œä¸€èˆ¬æœ‰æ•´å‹å’Œæµ®ç‚¹å‹ä¸¤ç§å­˜å‚¨æ–¹å¼ã€‚å¦‚æœæ˜¯æœ‰æ±‡ç‡è½¬æ¢çš„ï¼Œå»ºè®®ä½¿ç”¨æµ®ç‚¹æ•°decimalè¿›è¡Œå­˜å‚¨ï¼Œå¯ä»¥çµæ´»çš„æ§åˆ¶ç²¾åº¦ï¼Œdecimalç›´æ¥å¯¹åº”javaç±»å‹BigDecimalã€‚å½“ç„¶ï¼Œç”¨æ•´æ•°å­˜å‚¨åˆ†è¿™ç§å½¢å¼ä¹Ÿå¯ä»¥ï¼Œè½¬è´¦çš„æ—¶å€™å•ä½ä¸ºå…ƒè€Œå¦‚æœå¿˜äº†è½¬æ¢åˆ†ä¸ºå…ƒï¼Œé‚£å°±æ‚²å‰§äº†ã€‚","slug":"è¿›é˜¶/é‡‘èç³»ç»Ÿä¸­æ­£ç¡®çš„é‡‘é¢è®¡ç®—åŠå­˜å‚¨æ–¹å¼","published":1,"updated":"2025-10-15T07:21:14.292Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076j001hqkd423ox8ra0","content":"<h4 id=\"ç»å…¸çš„ç²¾åº¦ä¸¢å¤±é—®é¢˜\"><a href=\"#ç»å…¸çš„ç²¾åº¦ä¸¢å¤±é—®é¢˜\" class=\"headerlink\" title=\"ç»å…¸çš„ç²¾åº¦ä¸¢å¤±é—®é¢˜\"></a>ç»å…¸çš„ç²¾åº¦ä¸¢å¤±é—®é¢˜</h4><p> Javaä¸­çš„ç±»å‹floatã€doubleç”¨æ¥åšè®¡ç®—ä¼šæœ‰ç²¾åº¦ä¸¢å¤±é—®é¢˜ï¼Œä¸‹é¢æ¥çœ‹ä¸‹é¢çš„ç¤ºä¾‹ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n\ttest1();\n\ttest2();\n&#125;\n\nprivate static void test1() &#123;\n\tdouble totalAmount &#x3D; 0.09;\n\tdouble feeAmount &#x3D; 0.02;\n\tdouble tradeAmount &#x3D; totalAmount - feeAmount;\n\tSystem.out.println(tradeAmount);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä¸Šé¢çš„ç¨‹åºè¾“å‡ºç»“æœæ˜¯å¤šå°‘ï¼Ÿ</p>\n<p>0.07ï¼Ÿéä¹Ÿï¼</p>\n<p>æ­£ç¡®çš„ç»“æœæ˜¯ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">0.06999999999999999<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>ä¸ºä»€ä¹ˆæ˜¯è¿™æ ·ï¼Ÿ</p>\n<p>æµ®ç‚¹æ•°å¯èƒ½ä¸¢å¤±ç²¾åº¦ï¼Œæµ®ç‚¹åè¿›åˆ¶æ•°é€šå¸¸æ²¡æœ‰å®Œå…¨ç›¸åŒçš„äºŒè¿›åˆ¶çš„è¡¨ç¤ºå½¢å¼ï¼Œè¿™æ˜¯CPUæ‰€é‡‡ç”¨çš„æµ®ç‚¹æ•°æ®è¡¨ç¤ºå½¢å¼çš„å‰¯ä½œç”¨ã€‚ä¸ºæ­¤ï¼Œå¯èƒ½ä¼šæœ‰ä¸€äº›ç²¾åº¦ä¸¢å¤±ï¼Œå¹¶ä¸”ä¸€äº›æµ®ç‚¹è¿ç®—å¯èƒ½ä¼šäº§ç”ŸæœªçŸ¥çš„ç»“æœã€‚</p>\n<p>æµ®ç‚¹è¿ç®—å¾ˆå°‘æ˜¯ç²¾ç¡®çš„ï¼Œåªè¦æ˜¯è¶…è¿‡ç²¾åº¦èƒ½è¡¨ç¤ºçš„èŒƒå›´å°±ä¼šäº§ç”Ÿè¯¯å·®ã€‚æ‰€ä»¥ï¼Œåœ¨ä½¿ç”¨floatã€doubleä½œç²¾ç¡®è¿ç®—çš„æ—¶å€™ä¸€å®šè¦ç‰¹åˆ«å°å¿ƒï¼Œé™¤éèƒ½å®¹å¿ç²¾åº¦ä¸¢å¤±ï¼Œä¸ç„¶äº§ç”Ÿçš„è¯¯å·®ä¹Ÿæ˜¯ä¼šé€ æˆåŒæ–¹å¯¹è´¦ä¸ä¸€è‡´çš„ç»“æœã€‚</p>\n<h4 id=\"æ€ä¹ˆè§£å†³\"><a href=\"#æ€ä¹ˆè§£å†³\" class=\"headerlink\" title=\"æ€ä¹ˆè§£å†³\"></a>æ€ä¹ˆè§£å†³</h4><blockquote>\n<p>åœ¨ã€ŠEffective Javaã€‹è¿™æœ¬ä¹¦ä¸­ä¹Ÿæåˆ°è¿™ä¸ªåŸåˆ™ï¼Œfloatå’Œdoubleåªèƒ½ç”¨æ¥åšç§‘å­¦è®¡ç®—æˆ–è€…æ˜¯å·¥ç¨‹è®¡ç®—ï¼Œåœ¨å•†ä¸šè®¡ç®—ä¸­æˆ‘ä»¬è¦ç”¨ java.math.BigDecimalã€‚</p>\n</blockquote>\n<p>BigDecimalé€‚åˆæ›´ç²¾åº¦çš„è¿ç®—ï¼Œä¹Ÿæä¾›äº†ä¸°å¯Œçš„æ“ä½œç¬¦ç±»å‹ï¼Œå°æ•°ä½æ§åˆ¶ï¼Œå››èˆäº”å…¥è§„åˆ™ç­‰ã€‚</p>\n<p>ä¸è¿‡ï¼Œä½¿ç”¨BigDecimalä¸å½“ä¹Ÿæœ‰ç²¾åº¦ä¸¢å¤±çš„æƒ…å†µï¼Œå¦‚doubleçš„æ„é€ æ–¹æ³•ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">BigDecimal(double val)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>å†æ¥çœ‹è¿™ä¸ªç¤ºä¾‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void test2() &#123;\n\tdouble totalAmount &#x3D; 0.09;\n\tdouble feeAmount &#x3D; 0.02;\n\tBigDecimal tradeAmount &#x3D; new BigDecimal(totalAmount).subtract(new BigDecimal(feeAmount));\n\tSystem.out.println(tradeAmount);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">0.0699999999999999962529972918900966760702431201934814453125<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>è¿™ä¸ªç²¾åº¦å°±æ›´ææ€–äº†ã€‚ã€‚</p>\n<p>æ‰€ä»¥ï¼Œä¸€å®šè¦ä½¿ç”¨Stringçš„æ„é€ æ–¹æ³•ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">BigDecimal(String val)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void test3() &#123;\n\tdouble totalAmount &#x3D; 0.09;\n\tdouble feeAmount &#x3D; 0.02;\n\tBigDecimal tradeAmount &#x3D; new BigDecimal(String.valueOf(totalAmount))\n\t\t\t.subtract(new BigDecimal(String.valueOf(feeAmount)));\n\tSystem.out.println(tradeAmount);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h4><ol>\n<li><p>é‡‘é¢è¿ç®—å°½é‡ä½¿ç”¨BigDecimal(String val)è¿›è¡Œè¿ç®—ã€‚</p>\n</li>\n<li><p>æ•°æ®åº“å­˜å‚¨é‡‘é¢ï¼Œä¸€èˆ¬æœ‰æ•´å‹å’Œæµ®ç‚¹å‹ä¸¤ç§å­˜å‚¨æ–¹å¼ã€‚å¦‚æœæ˜¯æœ‰æ±‡ç‡è½¬æ¢çš„ï¼Œå»ºè®®ä½¿ç”¨æµ®ç‚¹æ•°decimalè¿›è¡Œå­˜å‚¨ï¼Œå¯ä»¥çµæ´»çš„æ§åˆ¶ç²¾åº¦ï¼Œdecimalç›´æ¥å¯¹åº”javaç±»å‹BigDecimalã€‚å½“ç„¶ï¼Œç”¨æ•´æ•°å­˜å‚¨åˆ†è¿™ç§å½¢å¼ä¹Ÿå¯ä»¥ï¼Œè½¬è´¦çš„æ—¶å€™å•ä½ä¸ºå…ƒè€Œå¦‚æœå¿˜äº†è½¬æ¢åˆ†ä¸ºå…ƒï¼Œé‚£å°±æ‚²å‰§äº†ã€‚</p>\n</li>\n</ol>\n","excerpt":"","more":"<h4 id=\"ç»å…¸çš„ç²¾åº¦ä¸¢å¤±é—®é¢˜\"><a href=\"#ç»å…¸çš„ç²¾åº¦ä¸¢å¤±é—®é¢˜\" class=\"headerlink\" title=\"ç»å…¸çš„ç²¾åº¦ä¸¢å¤±é—®é¢˜\"></a>ç»å…¸çš„ç²¾åº¦ä¸¢å¤±é—®é¢˜</h4><p> Javaä¸­çš„ç±»å‹floatã€doubleç”¨æ¥åšè®¡ç®—ä¼šæœ‰ç²¾åº¦ä¸¢å¤±é—®é¢˜ï¼Œä¸‹é¢æ¥çœ‹ä¸‹é¢çš„ç¤ºä¾‹ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n\ttest1();\n\ttest2();\n&#125;\n\nprivate static void test1() &#123;\n\tdouble totalAmount &#x3D; 0.09;\n\tdouble feeAmount &#x3D; 0.02;\n\tdouble tradeAmount &#x3D; totalAmount - feeAmount;\n\tSystem.out.println(tradeAmount);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä¸Šé¢çš„ç¨‹åºè¾“å‡ºç»“æœæ˜¯å¤šå°‘ï¼Ÿ</p>\n<p>0.07ï¼Ÿéä¹Ÿï¼</p>\n<p>æ­£ç¡®çš„ç»“æœæ˜¯ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">0.06999999999999999<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>ä¸ºä»€ä¹ˆæ˜¯è¿™æ ·ï¼Ÿ</p>\n<p>æµ®ç‚¹æ•°å¯èƒ½ä¸¢å¤±ç²¾åº¦ï¼Œæµ®ç‚¹åè¿›åˆ¶æ•°é€šå¸¸æ²¡æœ‰å®Œå…¨ç›¸åŒçš„äºŒè¿›åˆ¶çš„è¡¨ç¤ºå½¢å¼ï¼Œè¿™æ˜¯CPUæ‰€é‡‡ç”¨çš„æµ®ç‚¹æ•°æ®è¡¨ç¤ºå½¢å¼çš„å‰¯ä½œç”¨ã€‚ä¸ºæ­¤ï¼Œå¯èƒ½ä¼šæœ‰ä¸€äº›ç²¾åº¦ä¸¢å¤±ï¼Œå¹¶ä¸”ä¸€äº›æµ®ç‚¹è¿ç®—å¯èƒ½ä¼šäº§ç”ŸæœªçŸ¥çš„ç»“æœã€‚</p>\n<p>æµ®ç‚¹è¿ç®—å¾ˆå°‘æ˜¯ç²¾ç¡®çš„ï¼Œåªè¦æ˜¯è¶…è¿‡ç²¾åº¦èƒ½è¡¨ç¤ºçš„èŒƒå›´å°±ä¼šäº§ç”Ÿè¯¯å·®ã€‚æ‰€ä»¥ï¼Œåœ¨ä½¿ç”¨floatã€doubleä½œç²¾ç¡®è¿ç®—çš„æ—¶å€™ä¸€å®šè¦ç‰¹åˆ«å°å¿ƒï¼Œé™¤éèƒ½å®¹å¿ç²¾åº¦ä¸¢å¤±ï¼Œä¸ç„¶äº§ç”Ÿçš„è¯¯å·®ä¹Ÿæ˜¯ä¼šé€ æˆåŒæ–¹å¯¹è´¦ä¸ä¸€è‡´çš„ç»“æœã€‚</p>\n<h4 id=\"æ€ä¹ˆè§£å†³\"><a href=\"#æ€ä¹ˆè§£å†³\" class=\"headerlink\" title=\"æ€ä¹ˆè§£å†³\"></a>æ€ä¹ˆè§£å†³</h4><blockquote>\n<p>åœ¨ã€ŠEffective Javaã€‹è¿™æœ¬ä¹¦ä¸­ä¹Ÿæåˆ°è¿™ä¸ªåŸåˆ™ï¼Œfloatå’Œdoubleåªèƒ½ç”¨æ¥åšç§‘å­¦è®¡ç®—æˆ–è€…æ˜¯å·¥ç¨‹è®¡ç®—ï¼Œåœ¨å•†ä¸šè®¡ç®—ä¸­æˆ‘ä»¬è¦ç”¨ java.math.BigDecimalã€‚</p>\n</blockquote>\n<p>BigDecimalé€‚åˆæ›´ç²¾åº¦çš„è¿ç®—ï¼Œä¹Ÿæä¾›äº†ä¸°å¯Œçš„æ“ä½œç¬¦ç±»å‹ï¼Œå°æ•°ä½æ§åˆ¶ï¼Œå››èˆäº”å…¥è§„åˆ™ç­‰ã€‚</p>\n<p>ä¸è¿‡ï¼Œä½¿ç”¨BigDecimalä¸å½“ä¹Ÿæœ‰ç²¾åº¦ä¸¢å¤±çš„æƒ…å†µï¼Œå¦‚doubleçš„æ„é€ æ–¹æ³•ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">BigDecimal(double val)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>å†æ¥çœ‹è¿™ä¸ªç¤ºä¾‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void test2() &#123;\n\tdouble totalAmount &#x3D; 0.09;\n\tdouble feeAmount &#x3D; 0.02;\n\tBigDecimal tradeAmount &#x3D; new BigDecimal(totalAmount).subtract(new BigDecimal(feeAmount));\n\tSystem.out.println(tradeAmount);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">0.0699999999999999962529972918900966760702431201934814453125<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>è¿™ä¸ªç²¾åº¦å°±æ›´ææ€–äº†ã€‚ã€‚</p>\n<p>æ‰€ä»¥ï¼Œä¸€å®šè¦ä½¿ç”¨Stringçš„æ„é€ æ–¹æ³•ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">BigDecimal(String val)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void test3() &#123;\n\tdouble totalAmount &#x3D; 0.09;\n\tdouble feeAmount &#x3D; 0.02;\n\tBigDecimal tradeAmount &#x3D; new BigDecimal(String.valueOf(totalAmount))\n\t\t\t.subtract(new BigDecimal(String.valueOf(feeAmount)));\n\tSystem.out.println(tradeAmount);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h4><ol>\n<li><p>é‡‘é¢è¿ç®—å°½é‡ä½¿ç”¨BigDecimal(String val)è¿›è¡Œè¿ç®—ã€‚</p>\n</li>\n<li><p>æ•°æ®åº“å­˜å‚¨é‡‘é¢ï¼Œä¸€èˆ¬æœ‰æ•´å‹å’Œæµ®ç‚¹å‹ä¸¤ç§å­˜å‚¨æ–¹å¼ã€‚å¦‚æœæ˜¯æœ‰æ±‡ç‡è½¬æ¢çš„ï¼Œå»ºè®®ä½¿ç”¨æµ®ç‚¹æ•°decimalè¿›è¡Œå­˜å‚¨ï¼Œå¯ä»¥çµæ´»çš„æ§åˆ¶ç²¾åº¦ï¼Œdecimalç›´æ¥å¯¹åº”javaç±»å‹BigDecimalã€‚å½“ç„¶ï¼Œç”¨æ•´æ•°å­˜å‚¨åˆ†è¿™ç§å½¢å¼ä¹Ÿå¯ä»¥ï¼Œè½¬è´¦çš„æ—¶å€™å•ä½ä¸ºå…ƒè€Œå¦‚æœå¿˜äº†è½¬æ¢åˆ†ä¸ºå…ƒï¼Œé‚£å°±æ‚²å‰§äº†ã€‚</p>\n</li>\n</ol>\n"},{"title":"é¢è¯•é—®æˆ‘ Java é€ƒé€¸åˆ†æï¼Œç¬é—´è¢«ç§’æ€äº†ã€‚","date":"2025-10-15T03:36:33.000Z","_content":"\nè®°å¾—å‡ å¹´å‰æœ‰ä¸€æ¬¡æ ˆé•¿å»é¢è¯•ï¼Œé—®åˆ°äº†è¿™ä¹ˆä¸€ä¸ªé—®é¢˜:\n\n> Javaä¸­çš„å¯¹è±¡éƒ½æ˜¯åœ¨å †ä¸­åˆ†é…å—ï¼Ÿè¯´æ˜ä¸ºä»€ä¹ˆï¼\n\nå½“æ—¶æˆ‘è¢«é—®å¾—ä¸€è„¸è’™é€¼ï¼Œç¬é—´è¢«ç§’æ€å¾—ä½“æ— å®Œè‚¤ï¼Œå½“æ—¶æˆ‘å‹æ ¹å°±ä¸çŸ¥é“ä»–åœ¨è€ƒä»€ä¹ˆçŸ¥è¯†ç‚¹ï¼Œéš¾é“å¯¹è±¡ä¸æ˜¯åœ¨å †ä¸­åˆ†é…å—ï¼Ÿæœ€åå°±æ²¡ç„¶åäº†ï¼Œå›å»ç­‰é€šçŸ¥äº†ã€‚ã€‚\n\nè¿™ä¸ªé¢è¯•é¢˜å¾ˆç»å…¸ï¼Œæˆ‘æœ€è¿‘ä¹Ÿåˆ†äº«åˆ°äº†çŸ¥è¯†æ˜Ÿçƒä¸Šé¢ï¼š\n\n![](http://img.javastack.cn/20190527134034.png)\n\nå›ç­”å¾ˆç²¾å½©ï¼Œå¤§å®¶å¯ä»¥åŠ å…¥ä¸€èµ·ææŠ€æœ¯ï¼Œæˆ‘ç°åœ¨å°†ç­”æ¡ˆæ€»ç»“ä¸€ä¸‹ç»™å¤§å®¶ã€‚\n\n## ä»€ä¹ˆæ˜¯é€ƒé€¸åˆ†æï¼Ÿ\n\nå…³äº Java é€ƒé€¸åˆ†æçš„å®šä¹‰ï¼š\n\né€ƒé€¸åˆ†æï¼ˆEscape Analysisï¼‰ç®€å•æ¥è®²å°±æ˜¯ï¼ŒJava Hotspot è™šæ‹Ÿæœºå¯ä»¥åˆ†ææ–°åˆ›å»ºå¯¹è±¡çš„ä½¿ç”¨èŒƒå›´ï¼Œå¹¶å†³å®šæ˜¯å¦åœ¨ Java å †ä¸Šåˆ†é…å†…å­˜çš„ä¸€é¡¹æŠ€æœ¯ã€‚\n\né€ƒé€¸åˆ†æçš„ JVM å‚æ•°å¦‚ä¸‹ï¼š\n\n- å¼€å¯é€ƒé€¸åˆ†æï¼š-XX:+DoEscapeAnalysis\n- å…³é—­é€ƒé€¸åˆ†æï¼š-XX:-DoEscapeAnalysis\n- æ˜¾ç¤ºåˆ†æç»“æœï¼š-XX:+PrintEscapeAnalysis\n\né€ƒé€¸åˆ†ææŠ€æœ¯åœ¨ Java SE 6u23+ å¼€å§‹æ”¯æŒï¼Œå¹¶é»˜è®¤è®¾ç½®ä¸ºå¯ç”¨çŠ¶æ€ï¼Œå¯ä»¥ä¸ç”¨é¢å¤–åŠ è¿™ä¸ªå‚æ•°ã€‚\n\n## é€ƒé€¸åˆ†æç®—æ³•\n\nJava Hotspot ç¼–è¯‘å™¨å®ç°ä¸‹é¢è®ºæ–‡ä¸­æè¿°çš„é€ƒé€¸ç®—æ³•ï¼š\n\n```\n[Choi99] Jong-Deok Choi, Manish Gupta, Mauricio Seffano,\n          Vugranam C. Sreedhar, Sam Midkiff,\n          \"Escape Analysis for Java\", Procedings of ACM SIGPLAN\n          OOPSLA  Conference, November 1, 1999\n```\n\næ ¹æ® Jong-Deok Choi, Manish Gupta, Mauricio Seffano,Vugranam C. Sreedhar, Sam Midkiff ç­‰å¤§ç‰›åœ¨è®ºæ–‡ã€Š**Escape Analysis for Java**ã€‹ä¸­æè¿°çš„ç®—æ³•è¿›è¡Œé€ƒé€¸åˆ†æçš„ã€‚\n\nè¯¥ç®—æ³•å¼•å…¥äº†è¿é€šå›¾ï¼Œç”¨è¿é€šå›¾æ¥æ„å»ºå¯¹è±¡å’Œå¯¹è±¡å¼•ç”¨ä¹‹é—´çš„å¯è¾¾æ€§å…³ç³»ï¼Œå¹¶åœ¨æ¬¡åŸºç¡€ä¸Šï¼Œæå‡ºä¸€ç§ç»„åˆæ•°æ®æµåˆ†ææ³•ã€‚\n\nç”±äºç®—æ³•æ˜¯ä¸Šä¸‹æ–‡ç›¸å…³å’Œæµæ•æ„Ÿçš„ï¼Œå¹¶ä¸”æ¨¡æ‹Ÿäº†å¯¹è±¡ä»»æ„å±‚æ¬¡çš„åµŒå¥—å…³ç³»ï¼Œæ‰€ä»¥åˆ†æç²¾åº¦è¾ƒé«˜ï¼Œåªæ˜¯è¿è¡Œæ—¶é—´å’Œå†…å­˜æ¶ˆè€—ç›¸å¯¹è¾ƒå¤§ã€‚ \n\n## å¯¹è±¡é€ƒé€¸çŠ¶æ€\n\næˆ‘ä»¬äº†è§£äº† Java ä¸­çš„é€ƒé€¸åˆ†ææŠ€æœ¯ï¼Œå†æ¥äº†è§£ä¸‹ä¸€ä¸ªå¯¹è±¡çš„é€ƒé€¸çŠ¶æ€ã€‚\n\n#### 1ã€å…¨å±€é€ƒé€¸ï¼ˆGlobalEscapeï¼‰\n\nå³ä¸€ä¸ªå¯¹è±¡çš„ä½œç”¨èŒƒå›´é€ƒå‡ºäº†å½“å‰æ–¹æ³•æˆ–è€…å½“å‰çº¿ç¨‹ï¼Œæœ‰ä»¥ä¸‹å‡ ç§åœºæ™¯ï¼š\n\n- å¯¹è±¡æ˜¯ä¸€ä¸ªé™æ€å˜é‡\n- å¯¹è±¡æ˜¯ä¸€ä¸ªå·²ç»å‘ç”Ÿé€ƒé€¸çš„å¯¹è±¡\n- å¯¹è±¡ä½œä¸ºå½“å‰æ–¹æ³•çš„è¿”å›å€¼\n\n#### 2ã€å‚æ•°é€ƒé€¸ï¼ˆArgEscapeï¼‰\n\nå³ä¸€ä¸ªå¯¹è±¡è¢«ä½œä¸ºæ–¹æ³•å‚æ•°ä¼ é€’æˆ–è€…è¢«å‚æ•°å¼•ç”¨ï¼Œä½†åœ¨è°ƒç”¨è¿‡ç¨‹ä¸­ä¸ä¼šå‘ç”Ÿå…¨å±€é€ƒé€¸ï¼Œè¿™ä¸ªçŠ¶æ€æ˜¯é€šè¿‡è¢«è°ƒæ–¹æ³•çš„å­—èŠ‚ç ç¡®å®šçš„ã€‚\n\n#### 3ã€æ²¡æœ‰é€ƒé€¸\n\nå³æ–¹æ³•ä¸­çš„å¯¹è±¡æ²¡æœ‰å‘ç”Ÿé€ƒé€¸ã€‚\n\n## é€ƒé€¸åˆ†æä¼˜åŒ–\n\né’ˆå¯¹ä¸Šé¢ç¬¬ä¸‰ç‚¹ï¼Œå½“ä¸€ä¸ªå¯¹è±¡æ²¡æœ‰é€ƒé€¸æ—¶ï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹å‡ ä¸ªè™šæ‹Ÿæœºçš„ä¼˜åŒ–ã€‚\n\n**1) é”æ¶ˆé™¤**\n\næˆ‘ä»¬çŸ¥é“çº¿ç¨‹åŒæ­¥é”æ˜¯éå¸¸ç‰ºç‰²æ€§èƒ½çš„ï¼Œå½“ç¼–è¯‘å™¨ç¡®å®šå½“å‰å¯¹è±¡åªæœ‰å½“å‰çº¿ç¨‹ä½¿ç”¨ï¼Œé‚£ä¹ˆå°±ä¼šç§»é™¤è¯¥å¯¹è±¡çš„åŒæ­¥é”ã€‚\n\nä¾‹å¦‚ï¼ŒStringBuffer å’Œ Vector éƒ½æ˜¯ç”¨ synchronized ä¿®é¥°çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œå®ƒä»¬éƒ½åªæ˜¯åœ¨å½“å‰çº¿ç¨‹ä¸­ç”¨åˆ°ï¼Œè¿™æ ·ç¼–è¯‘å™¨å°±ä¼šä¼˜åŒ–ç§»é™¤æ‰è¿™äº›é”æ“ä½œã€‚\n\né”æ¶ˆé™¤çš„ JVM å‚æ•°å¦‚ä¸‹ï¼š\n\n- å¼€å¯é”æ¶ˆé™¤ï¼š-XX:+EliminateLocks\n- å…³é—­é”æ¶ˆé™¤ï¼š-XX:-EliminateLocks\n\né”æ¶ˆé™¤åœ¨ JDK8 ä¸­éƒ½æ˜¯é»˜è®¤å¼€å¯çš„ï¼Œå¹¶ä¸”é”æ¶ˆé™¤éƒ½è¦å»ºç«‹åœ¨é€ƒé€¸åˆ†æçš„åŸºç¡€ä¸Šã€‚\n\n**2) æ ‡é‡æ›¿æ¢**\n\né¦–å…ˆè¦æ˜ç™½æ ‡é‡å’Œèšåˆé‡ï¼ŒåŸºç¡€ç±»å‹å’Œå¯¹è±¡çš„å¼•ç”¨å¯ä»¥ç†è§£ä¸ºæ ‡é‡ï¼Œå®ƒä»¬ä¸èƒ½è¢«è¿›ä¸€æ­¥åˆ†è§£ã€‚è€Œèƒ½è¢«è¿›ä¸€æ­¥åˆ†è§£çš„é‡å°±æ˜¯èšåˆé‡ï¼Œæ¯”å¦‚ï¼šå¯¹è±¡ã€‚\n\nå¯¹è±¡æ˜¯èšåˆé‡ï¼Œå®ƒåˆå¯ä»¥è¢«è¿›ä¸€æ­¥åˆ†è§£æˆæ ‡é‡ï¼Œå°†å…¶æˆå‘˜å˜é‡åˆ†è§£ä¸ºåˆ†æ•£çš„å˜é‡ï¼Œè¿™å°±å«åšæ ‡é‡æ›¿æ¢ã€‚\n\nè¿™æ ·ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡æ²¡æœ‰å‘ç”Ÿé€ƒé€¸ï¼Œé‚£å‹æ ¹å°±ä¸ç”¨åˆ›å»ºå®ƒï¼Œåªä¼šåœ¨æ ˆæˆ–è€…å¯„å­˜å™¨ä¸Šåˆ›å»ºå®ƒç”¨åˆ°çš„æˆå‘˜æ ‡é‡ï¼ŒèŠ‚çœäº†å†…å­˜ç©ºé—´ï¼Œä¹Ÿæå‡äº†åº”ç”¨ç¨‹åºæ€§èƒ½ã€‚\n\næ ‡é‡æ›¿æ¢çš„ JVM å‚æ•°å¦‚ä¸‹ï¼š\n\n- å¼€å¯æ ‡é‡æ›¿æ¢ï¼š-XX:+EliminateAllocations\n- å…³é—­æ ‡é‡æ›¿æ¢ï¼š-XX:-EliminateAllocations\n- æ˜¾ç¤ºæ ‡é‡æ›¿æ¢è¯¦æƒ…ï¼š-XX:+PrintEliminateAllocations\n\næ ‡é‡æ›¿æ¢åŒæ ·åœ¨ JDK8 ä¸­éƒ½æ˜¯é»˜è®¤å¼€å¯çš„ï¼Œå¹¶ä¸”éƒ½è¦å»ºç«‹åœ¨é€ƒé€¸åˆ†æçš„åŸºç¡€ä¸Šã€‚\n\n**3) æ ˆä¸Šåˆ†é…**\n\nå½“å¯¹è±¡æ²¡æœ‰å‘ç”Ÿé€ƒé€¸æ—¶ï¼Œè¯¥å¯¹è±¡å°±å¯ä»¥é€šè¿‡æ ‡é‡æ›¿æ¢åˆ†è§£æˆæˆå‘˜æ ‡é‡åˆ†é…åœ¨æ ˆå†…å­˜ä¸­ï¼Œå’Œæ–¹æ³•çš„ç”Ÿå‘½å‘¨æœŸä¸€è‡´ï¼Œéšç€æ ˆå¸§å‡ºæ ˆæ—¶é”€æ¯ï¼Œå‡å°‘äº† GC å‹åŠ›ï¼Œæé«˜äº†åº”ç”¨ç¨‹åºæ€§èƒ½ã€‚\n\n## æ€»ç»“\n\né€ƒé€¸åˆ†æè®²å®Œäº†ï¼Œæ€»ç»“äº†ä¸å°‘æ—¶é—´ï¼Œæˆ‘ä»¬ä¹Ÿåº”è¯¥å¤§æ¦‚çŸ¥é“é€ƒé€¸åˆ†ææ˜¯ä¸ºäº†ä¼˜åŒ– JVM å†…å­˜å’Œæå‡ç¨‹åºæ€§èƒ½çš„ã€‚\n\næˆ‘ä»¬çŸ¥é“è¿™ç‚¹åï¼Œåœ¨å¹³æ—¶å¼€å‘è¿‡ç¨‹ä¸­å°±è¦å¯å°½å¯èƒ½çš„æ§åˆ¶å˜é‡çš„ä½œç”¨èŒƒå›´äº†ï¼Œå˜é‡èŒƒå›´è¶Šå°è¶Šå¥½ï¼Œè®©è™šæ‹Ÿæœºå°½å¯èƒ½æœ‰ä¼˜åŒ–çš„ç©ºé—´ã€‚\n\nç®€å•ä¸¾ä¸€ä¸ªä¾‹å­å§ï¼Œå¦‚ï¼š\n\n```\nreturn sb;\n```\n\nå¯ä»¥æ”¹ä¸ºï¼š\n\n```\nreturn sb.toString();\n```\n\nè¿™æ˜¯ä¸€ç§ä¼˜åŒ–æ¡ˆä¾‹ï¼ŒæŠŠ StringBuilder å˜é‡æ§åˆ¶åœ¨äº†å½“å‰æ–¹æ³•ä¹‹å†…ï¼Œæ²¡æœ‰é€ƒå‡ºå½“å‰æ–¹æ³•ä½œç”¨åŸŸã€‚\n\nå¤§å®¶è¿˜æœ‰æ²¡æœ‰åˆ«çš„ä¼˜åŒ–ç»éªŒï¼Œæ¬¢è¿åˆ†äº«~\n\nå‚è€ƒèµ„æ–™ï¼š\n\n - https://docs.oracle.com/javase/8/docs/technotes/guides/vm/performance-enhancements-7.html#escapeAnalysis\n - https://blog.csdn.net/rickiyeat/article/details/76802085\n - https://blog.csdn.net/baichoufei90/article/details/85180478\n \n\n- ä½ çœŸçš„ææ‡‚ transient å…³é”®å­—äº†å—ï¼Ÿ\n- é¢è¯•å¸¸è€ƒï¼šSynchronized æœ‰å‡ ç§ç”¨æ³•ï¼Ÿ\n- Java 11 å·²å‘å¸ƒï¼ŒString è¿˜èƒ½è¿™æ ·ç©ï¼\n- Java ä¸­çš„ String çœŸçš„æ˜¯ä¸å¯å˜å—ï¼Ÿ\n- sleep( ) å’Œ wait( ) çš„è¿™ 5 ä¸ªåŒºåˆ«\n- â€¦â€¦\n\n\n \n","source":"_posts/è¿›é˜¶/é¢è¯•é—®æˆ‘ Java é€ƒé€¸åˆ†æï¼Œç¬é—´è¢«ç§’æ€äº†ã€‚.md","raw":"---\ntitle: é¢è¯•é—®æˆ‘ Java é€ƒé€¸åˆ†æï¼Œç¬é—´è¢«ç§’æ€äº†ã€‚\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: è¿›é˜¶\n---\n\nè®°å¾—å‡ å¹´å‰æœ‰ä¸€æ¬¡æ ˆé•¿å»é¢è¯•ï¼Œé—®åˆ°äº†è¿™ä¹ˆä¸€ä¸ªé—®é¢˜:\n\n> Javaä¸­çš„å¯¹è±¡éƒ½æ˜¯åœ¨å †ä¸­åˆ†é…å—ï¼Ÿè¯´æ˜ä¸ºä»€ä¹ˆï¼\n\nå½“æ—¶æˆ‘è¢«é—®å¾—ä¸€è„¸è’™é€¼ï¼Œç¬é—´è¢«ç§’æ€å¾—ä½“æ— å®Œè‚¤ï¼Œå½“æ—¶æˆ‘å‹æ ¹å°±ä¸çŸ¥é“ä»–åœ¨è€ƒä»€ä¹ˆçŸ¥è¯†ç‚¹ï¼Œéš¾é“å¯¹è±¡ä¸æ˜¯åœ¨å †ä¸­åˆ†é…å—ï¼Ÿæœ€åå°±æ²¡ç„¶åäº†ï¼Œå›å»ç­‰é€šçŸ¥äº†ã€‚ã€‚\n\nè¿™ä¸ªé¢è¯•é¢˜å¾ˆç»å…¸ï¼Œæˆ‘æœ€è¿‘ä¹Ÿåˆ†äº«åˆ°äº†çŸ¥è¯†æ˜Ÿçƒä¸Šé¢ï¼š\n\n![](http://img.javastack.cn/20190527134034.png)\n\nå›ç­”å¾ˆç²¾å½©ï¼Œå¤§å®¶å¯ä»¥åŠ å…¥ä¸€èµ·ææŠ€æœ¯ï¼Œæˆ‘ç°åœ¨å°†ç­”æ¡ˆæ€»ç»“ä¸€ä¸‹ç»™å¤§å®¶ã€‚\n\n## ä»€ä¹ˆæ˜¯é€ƒé€¸åˆ†æï¼Ÿ\n\nå…³äº Java é€ƒé€¸åˆ†æçš„å®šä¹‰ï¼š\n\né€ƒé€¸åˆ†æï¼ˆEscape Analysisï¼‰ç®€å•æ¥è®²å°±æ˜¯ï¼ŒJava Hotspot è™šæ‹Ÿæœºå¯ä»¥åˆ†ææ–°åˆ›å»ºå¯¹è±¡çš„ä½¿ç”¨èŒƒå›´ï¼Œå¹¶å†³å®šæ˜¯å¦åœ¨ Java å †ä¸Šåˆ†é…å†…å­˜çš„ä¸€é¡¹æŠ€æœ¯ã€‚\n\né€ƒé€¸åˆ†æçš„ JVM å‚æ•°å¦‚ä¸‹ï¼š\n\n- å¼€å¯é€ƒé€¸åˆ†æï¼š-XX:+DoEscapeAnalysis\n- å…³é—­é€ƒé€¸åˆ†æï¼š-XX:-DoEscapeAnalysis\n- æ˜¾ç¤ºåˆ†æç»“æœï¼š-XX:+PrintEscapeAnalysis\n\né€ƒé€¸åˆ†ææŠ€æœ¯åœ¨ Java SE 6u23+ å¼€å§‹æ”¯æŒï¼Œå¹¶é»˜è®¤è®¾ç½®ä¸ºå¯ç”¨çŠ¶æ€ï¼Œå¯ä»¥ä¸ç”¨é¢å¤–åŠ è¿™ä¸ªå‚æ•°ã€‚\n\n## é€ƒé€¸åˆ†æç®—æ³•\n\nJava Hotspot ç¼–è¯‘å™¨å®ç°ä¸‹é¢è®ºæ–‡ä¸­æè¿°çš„é€ƒé€¸ç®—æ³•ï¼š\n\n```\n[Choi99] Jong-Deok Choi, Manish Gupta, Mauricio Seffano,\n          Vugranam C. Sreedhar, Sam Midkiff,\n          \"Escape Analysis for Java\", Procedings of ACM SIGPLAN\n          OOPSLA  Conference, November 1, 1999\n```\n\næ ¹æ® Jong-Deok Choi, Manish Gupta, Mauricio Seffano,Vugranam C. Sreedhar, Sam Midkiff ç­‰å¤§ç‰›åœ¨è®ºæ–‡ã€Š**Escape Analysis for Java**ã€‹ä¸­æè¿°çš„ç®—æ³•è¿›è¡Œé€ƒé€¸åˆ†æçš„ã€‚\n\nè¯¥ç®—æ³•å¼•å…¥äº†è¿é€šå›¾ï¼Œç”¨è¿é€šå›¾æ¥æ„å»ºå¯¹è±¡å’Œå¯¹è±¡å¼•ç”¨ä¹‹é—´çš„å¯è¾¾æ€§å…³ç³»ï¼Œå¹¶åœ¨æ¬¡åŸºç¡€ä¸Šï¼Œæå‡ºä¸€ç§ç»„åˆæ•°æ®æµåˆ†ææ³•ã€‚\n\nç”±äºç®—æ³•æ˜¯ä¸Šä¸‹æ–‡ç›¸å…³å’Œæµæ•æ„Ÿçš„ï¼Œå¹¶ä¸”æ¨¡æ‹Ÿäº†å¯¹è±¡ä»»æ„å±‚æ¬¡çš„åµŒå¥—å…³ç³»ï¼Œæ‰€ä»¥åˆ†æç²¾åº¦è¾ƒé«˜ï¼Œåªæ˜¯è¿è¡Œæ—¶é—´å’Œå†…å­˜æ¶ˆè€—ç›¸å¯¹è¾ƒå¤§ã€‚ \n\n## å¯¹è±¡é€ƒé€¸çŠ¶æ€\n\næˆ‘ä»¬äº†è§£äº† Java ä¸­çš„é€ƒé€¸åˆ†ææŠ€æœ¯ï¼Œå†æ¥äº†è§£ä¸‹ä¸€ä¸ªå¯¹è±¡çš„é€ƒé€¸çŠ¶æ€ã€‚\n\n#### 1ã€å…¨å±€é€ƒé€¸ï¼ˆGlobalEscapeï¼‰\n\nå³ä¸€ä¸ªå¯¹è±¡çš„ä½œç”¨èŒƒå›´é€ƒå‡ºäº†å½“å‰æ–¹æ³•æˆ–è€…å½“å‰çº¿ç¨‹ï¼Œæœ‰ä»¥ä¸‹å‡ ç§åœºæ™¯ï¼š\n\n- å¯¹è±¡æ˜¯ä¸€ä¸ªé™æ€å˜é‡\n- å¯¹è±¡æ˜¯ä¸€ä¸ªå·²ç»å‘ç”Ÿé€ƒé€¸çš„å¯¹è±¡\n- å¯¹è±¡ä½œä¸ºå½“å‰æ–¹æ³•çš„è¿”å›å€¼\n\n#### 2ã€å‚æ•°é€ƒé€¸ï¼ˆArgEscapeï¼‰\n\nå³ä¸€ä¸ªå¯¹è±¡è¢«ä½œä¸ºæ–¹æ³•å‚æ•°ä¼ é€’æˆ–è€…è¢«å‚æ•°å¼•ç”¨ï¼Œä½†åœ¨è°ƒç”¨è¿‡ç¨‹ä¸­ä¸ä¼šå‘ç”Ÿå…¨å±€é€ƒé€¸ï¼Œè¿™ä¸ªçŠ¶æ€æ˜¯é€šè¿‡è¢«è°ƒæ–¹æ³•çš„å­—èŠ‚ç ç¡®å®šçš„ã€‚\n\n#### 3ã€æ²¡æœ‰é€ƒé€¸\n\nå³æ–¹æ³•ä¸­çš„å¯¹è±¡æ²¡æœ‰å‘ç”Ÿé€ƒé€¸ã€‚\n\n## é€ƒé€¸åˆ†æä¼˜åŒ–\n\né’ˆå¯¹ä¸Šé¢ç¬¬ä¸‰ç‚¹ï¼Œå½“ä¸€ä¸ªå¯¹è±¡æ²¡æœ‰é€ƒé€¸æ—¶ï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹å‡ ä¸ªè™šæ‹Ÿæœºçš„ä¼˜åŒ–ã€‚\n\n**1) é”æ¶ˆé™¤**\n\næˆ‘ä»¬çŸ¥é“çº¿ç¨‹åŒæ­¥é”æ˜¯éå¸¸ç‰ºç‰²æ€§èƒ½çš„ï¼Œå½“ç¼–è¯‘å™¨ç¡®å®šå½“å‰å¯¹è±¡åªæœ‰å½“å‰çº¿ç¨‹ä½¿ç”¨ï¼Œé‚£ä¹ˆå°±ä¼šç§»é™¤è¯¥å¯¹è±¡çš„åŒæ­¥é”ã€‚\n\nä¾‹å¦‚ï¼ŒStringBuffer å’Œ Vector éƒ½æ˜¯ç”¨ synchronized ä¿®é¥°çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œå®ƒä»¬éƒ½åªæ˜¯åœ¨å½“å‰çº¿ç¨‹ä¸­ç”¨åˆ°ï¼Œè¿™æ ·ç¼–è¯‘å™¨å°±ä¼šä¼˜åŒ–ç§»é™¤æ‰è¿™äº›é”æ“ä½œã€‚\n\né”æ¶ˆé™¤çš„ JVM å‚æ•°å¦‚ä¸‹ï¼š\n\n- å¼€å¯é”æ¶ˆé™¤ï¼š-XX:+EliminateLocks\n- å…³é—­é”æ¶ˆé™¤ï¼š-XX:-EliminateLocks\n\né”æ¶ˆé™¤åœ¨ JDK8 ä¸­éƒ½æ˜¯é»˜è®¤å¼€å¯çš„ï¼Œå¹¶ä¸”é”æ¶ˆé™¤éƒ½è¦å»ºç«‹åœ¨é€ƒé€¸åˆ†æçš„åŸºç¡€ä¸Šã€‚\n\n**2) æ ‡é‡æ›¿æ¢**\n\né¦–å…ˆè¦æ˜ç™½æ ‡é‡å’Œèšåˆé‡ï¼ŒåŸºç¡€ç±»å‹å’Œå¯¹è±¡çš„å¼•ç”¨å¯ä»¥ç†è§£ä¸ºæ ‡é‡ï¼Œå®ƒä»¬ä¸èƒ½è¢«è¿›ä¸€æ­¥åˆ†è§£ã€‚è€Œèƒ½è¢«è¿›ä¸€æ­¥åˆ†è§£çš„é‡å°±æ˜¯èšåˆé‡ï¼Œæ¯”å¦‚ï¼šå¯¹è±¡ã€‚\n\nå¯¹è±¡æ˜¯èšåˆé‡ï¼Œå®ƒåˆå¯ä»¥è¢«è¿›ä¸€æ­¥åˆ†è§£æˆæ ‡é‡ï¼Œå°†å…¶æˆå‘˜å˜é‡åˆ†è§£ä¸ºåˆ†æ•£çš„å˜é‡ï¼Œè¿™å°±å«åšæ ‡é‡æ›¿æ¢ã€‚\n\nè¿™æ ·ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡æ²¡æœ‰å‘ç”Ÿé€ƒé€¸ï¼Œé‚£å‹æ ¹å°±ä¸ç”¨åˆ›å»ºå®ƒï¼Œåªä¼šåœ¨æ ˆæˆ–è€…å¯„å­˜å™¨ä¸Šåˆ›å»ºå®ƒç”¨åˆ°çš„æˆå‘˜æ ‡é‡ï¼ŒèŠ‚çœäº†å†…å­˜ç©ºé—´ï¼Œä¹Ÿæå‡äº†åº”ç”¨ç¨‹åºæ€§èƒ½ã€‚\n\næ ‡é‡æ›¿æ¢çš„ JVM å‚æ•°å¦‚ä¸‹ï¼š\n\n- å¼€å¯æ ‡é‡æ›¿æ¢ï¼š-XX:+EliminateAllocations\n- å…³é—­æ ‡é‡æ›¿æ¢ï¼š-XX:-EliminateAllocations\n- æ˜¾ç¤ºæ ‡é‡æ›¿æ¢è¯¦æƒ…ï¼š-XX:+PrintEliminateAllocations\n\næ ‡é‡æ›¿æ¢åŒæ ·åœ¨ JDK8 ä¸­éƒ½æ˜¯é»˜è®¤å¼€å¯çš„ï¼Œå¹¶ä¸”éƒ½è¦å»ºç«‹åœ¨é€ƒé€¸åˆ†æçš„åŸºç¡€ä¸Šã€‚\n\n**3) æ ˆä¸Šåˆ†é…**\n\nå½“å¯¹è±¡æ²¡æœ‰å‘ç”Ÿé€ƒé€¸æ—¶ï¼Œè¯¥å¯¹è±¡å°±å¯ä»¥é€šè¿‡æ ‡é‡æ›¿æ¢åˆ†è§£æˆæˆå‘˜æ ‡é‡åˆ†é…åœ¨æ ˆå†…å­˜ä¸­ï¼Œå’Œæ–¹æ³•çš„ç”Ÿå‘½å‘¨æœŸä¸€è‡´ï¼Œéšç€æ ˆå¸§å‡ºæ ˆæ—¶é”€æ¯ï¼Œå‡å°‘äº† GC å‹åŠ›ï¼Œæé«˜äº†åº”ç”¨ç¨‹åºæ€§èƒ½ã€‚\n\n## æ€»ç»“\n\né€ƒé€¸åˆ†æè®²å®Œäº†ï¼Œæ€»ç»“äº†ä¸å°‘æ—¶é—´ï¼Œæˆ‘ä»¬ä¹Ÿåº”è¯¥å¤§æ¦‚çŸ¥é“é€ƒé€¸åˆ†ææ˜¯ä¸ºäº†ä¼˜åŒ– JVM å†…å­˜å’Œæå‡ç¨‹åºæ€§èƒ½çš„ã€‚\n\næˆ‘ä»¬çŸ¥é“è¿™ç‚¹åï¼Œåœ¨å¹³æ—¶å¼€å‘è¿‡ç¨‹ä¸­å°±è¦å¯å°½å¯èƒ½çš„æ§åˆ¶å˜é‡çš„ä½œç”¨èŒƒå›´äº†ï¼Œå˜é‡èŒƒå›´è¶Šå°è¶Šå¥½ï¼Œè®©è™šæ‹Ÿæœºå°½å¯èƒ½æœ‰ä¼˜åŒ–çš„ç©ºé—´ã€‚\n\nç®€å•ä¸¾ä¸€ä¸ªä¾‹å­å§ï¼Œå¦‚ï¼š\n\n```\nreturn sb;\n```\n\nå¯ä»¥æ”¹ä¸ºï¼š\n\n```\nreturn sb.toString();\n```\n\nè¿™æ˜¯ä¸€ç§ä¼˜åŒ–æ¡ˆä¾‹ï¼ŒæŠŠ StringBuilder å˜é‡æ§åˆ¶åœ¨äº†å½“å‰æ–¹æ³•ä¹‹å†…ï¼Œæ²¡æœ‰é€ƒå‡ºå½“å‰æ–¹æ³•ä½œç”¨åŸŸã€‚\n\nå¤§å®¶è¿˜æœ‰æ²¡æœ‰åˆ«çš„ä¼˜åŒ–ç»éªŒï¼Œæ¬¢è¿åˆ†äº«~\n\nå‚è€ƒèµ„æ–™ï¼š\n\n - https://docs.oracle.com/javase/8/docs/technotes/guides/vm/performance-enhancements-7.html#escapeAnalysis\n - https://blog.csdn.net/rickiyeat/article/details/76802085\n - https://blog.csdn.net/baichoufei90/article/details/85180478\n \n\n- ä½ çœŸçš„ææ‡‚ transient å…³é”®å­—äº†å—ï¼Ÿ\n- é¢è¯•å¸¸è€ƒï¼šSynchronized æœ‰å‡ ç§ç”¨æ³•ï¼Ÿ\n- Java 11 å·²å‘å¸ƒï¼ŒString è¿˜èƒ½è¿™æ ·ç©ï¼\n- Java ä¸­çš„ String çœŸçš„æ˜¯ä¸å¯å˜å—ï¼Ÿ\n- sleep( ) å’Œ wait( ) çš„è¿™ 5 ä¸ªåŒºåˆ«\n- â€¦â€¦\n\n\n \n","slug":"è¿›é˜¶/é¢è¯•é—®æˆ‘ Java é€ƒé€¸åˆ†æï¼Œç¬é—´è¢«ç§’æ€äº†ã€‚","published":1,"updated":"2025-10-15T07:21:14.211Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076k001kqkd44fgl9hlq","content":"<p>è®°å¾—å‡ å¹´å‰æœ‰ä¸€æ¬¡æ ˆé•¿å»é¢è¯•ï¼Œé—®åˆ°äº†è¿™ä¹ˆä¸€ä¸ªé—®é¢˜:</p>\n<blockquote>\n<p>Javaä¸­çš„å¯¹è±¡éƒ½æ˜¯åœ¨å †ä¸­åˆ†é…å—ï¼Ÿè¯´æ˜ä¸ºä»€ä¹ˆï¼</p>\n</blockquote>\n<p>å½“æ—¶æˆ‘è¢«é—®å¾—ä¸€è„¸è’™é€¼ï¼Œç¬é—´è¢«ç§’æ€å¾—ä½“æ— å®Œè‚¤ï¼Œå½“æ—¶æˆ‘å‹æ ¹å°±ä¸çŸ¥é“ä»–åœ¨è€ƒä»€ä¹ˆçŸ¥è¯†ç‚¹ï¼Œéš¾é“å¯¹è±¡ä¸æ˜¯åœ¨å †ä¸­åˆ†é…å—ï¼Ÿæœ€åå°±æ²¡ç„¶åäº†ï¼Œå›å»ç­‰é€šçŸ¥äº†ã€‚ã€‚</p>\n<p>è¿™ä¸ªé¢è¯•é¢˜å¾ˆç»å…¸ï¼Œæˆ‘æœ€è¿‘ä¹Ÿåˆ†äº«åˆ°äº†çŸ¥è¯†æ˜Ÿçƒä¸Šé¢ï¼š</p>\n<p><img src=\"http://img.javastack.cn/20190527134034.png\"></p>\n<p>å›ç­”å¾ˆç²¾å½©ï¼Œå¤§å®¶å¯ä»¥åŠ å…¥ä¸€èµ·ææŠ€æœ¯ï¼Œæˆ‘ç°åœ¨å°†ç­”æ¡ˆæ€»ç»“ä¸€ä¸‹ç»™å¤§å®¶ã€‚</p>\n<h2 id=\"ä»€ä¹ˆæ˜¯é€ƒé€¸åˆ†æï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯é€ƒé€¸åˆ†æï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯é€ƒé€¸åˆ†æï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯é€ƒé€¸åˆ†æï¼Ÿ</h2><p>å…³äº Java é€ƒé€¸åˆ†æçš„å®šä¹‰ï¼š</p>\n<p>é€ƒé€¸åˆ†æï¼ˆEscape Analysisï¼‰ç®€å•æ¥è®²å°±æ˜¯ï¼ŒJava Hotspot è™šæ‹Ÿæœºå¯ä»¥åˆ†ææ–°åˆ›å»ºå¯¹è±¡çš„ä½¿ç”¨èŒƒå›´ï¼Œå¹¶å†³å®šæ˜¯å¦åœ¨ Java å †ä¸Šåˆ†é…å†…å­˜çš„ä¸€é¡¹æŠ€æœ¯ã€‚</p>\n<p>é€ƒé€¸åˆ†æçš„ JVM å‚æ•°å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>å¼€å¯é€ƒé€¸åˆ†æï¼š-XX:+DoEscapeAnalysis</li>\n<li>å…³é—­é€ƒé€¸åˆ†æï¼š-XX:-DoEscapeAnalysis</li>\n<li>æ˜¾ç¤ºåˆ†æç»“æœï¼š-XX:+PrintEscapeAnalysis</li>\n</ul>\n<p>é€ƒé€¸åˆ†ææŠ€æœ¯åœ¨ Java SE 6u23+ å¼€å§‹æ”¯æŒï¼Œå¹¶é»˜è®¤è®¾ç½®ä¸ºå¯ç”¨çŠ¶æ€ï¼Œå¯ä»¥ä¸ç”¨é¢å¤–åŠ è¿™ä¸ªå‚æ•°ã€‚</p>\n<h2 id=\"é€ƒé€¸åˆ†æç®—æ³•\"><a href=\"#é€ƒé€¸åˆ†æç®—æ³•\" class=\"headerlink\" title=\"é€ƒé€¸åˆ†æç®—æ³•\"></a>é€ƒé€¸åˆ†æç®—æ³•</h2><p>Java Hotspot ç¼–è¯‘å™¨å®ç°ä¸‹é¢è®ºæ–‡ä¸­æè¿°çš„é€ƒé€¸ç®—æ³•ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">[Choi99] Jong-Deok Choi, Manish Gupta, Mauricio Seffano,\n          Vugranam C. Sreedhar, Sam Midkiff,\n          &quot;Escape Analysis for Java&quot;, Procedings of ACM SIGPLAN\n          OOPSLA  Conference, November 1, 1999<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ ¹æ® Jong-Deok Choi, Manish Gupta, Mauricio Seffano,Vugranam C. Sreedhar, Sam Midkiff ç­‰å¤§ç‰›åœ¨è®ºæ–‡ã€Š<strong>Escape Analysis for Java</strong>ã€‹ä¸­æè¿°çš„ç®—æ³•è¿›è¡Œé€ƒé€¸åˆ†æçš„ã€‚</p>\n<p>è¯¥ç®—æ³•å¼•å…¥äº†è¿é€šå›¾ï¼Œç”¨è¿é€šå›¾æ¥æ„å»ºå¯¹è±¡å’Œå¯¹è±¡å¼•ç”¨ä¹‹é—´çš„å¯è¾¾æ€§å…³ç³»ï¼Œå¹¶åœ¨æ¬¡åŸºç¡€ä¸Šï¼Œæå‡ºä¸€ç§ç»„åˆæ•°æ®æµåˆ†ææ³•ã€‚</p>\n<p>ç”±äºç®—æ³•æ˜¯ä¸Šä¸‹æ–‡ç›¸å…³å’Œæµæ•æ„Ÿçš„ï¼Œå¹¶ä¸”æ¨¡æ‹Ÿäº†å¯¹è±¡ä»»æ„å±‚æ¬¡çš„åµŒå¥—å…³ç³»ï¼Œæ‰€ä»¥åˆ†æç²¾åº¦è¾ƒé«˜ï¼Œåªæ˜¯è¿è¡Œæ—¶é—´å’Œå†…å­˜æ¶ˆè€—ç›¸å¯¹è¾ƒå¤§ã€‚ </p>\n<h2 id=\"å¯¹è±¡é€ƒé€¸çŠ¶æ€\"><a href=\"#å¯¹è±¡é€ƒé€¸çŠ¶æ€\" class=\"headerlink\" title=\"å¯¹è±¡é€ƒé€¸çŠ¶æ€\"></a>å¯¹è±¡é€ƒé€¸çŠ¶æ€</h2><p>æˆ‘ä»¬äº†è§£äº† Java ä¸­çš„é€ƒé€¸åˆ†ææŠ€æœ¯ï¼Œå†æ¥äº†è§£ä¸‹ä¸€ä¸ªå¯¹è±¡çš„é€ƒé€¸çŠ¶æ€ã€‚</p>\n<h4 id=\"1ã€å…¨å±€é€ƒé€¸ï¼ˆGlobalEscapeï¼‰\"><a href=\"#1ã€å…¨å±€é€ƒé€¸ï¼ˆGlobalEscapeï¼‰\" class=\"headerlink\" title=\"1ã€å…¨å±€é€ƒé€¸ï¼ˆGlobalEscapeï¼‰\"></a>1ã€å…¨å±€é€ƒé€¸ï¼ˆGlobalEscapeï¼‰</h4><p>å³ä¸€ä¸ªå¯¹è±¡çš„ä½œç”¨èŒƒå›´é€ƒå‡ºäº†å½“å‰æ–¹æ³•æˆ–è€…å½“å‰çº¿ç¨‹ï¼Œæœ‰ä»¥ä¸‹å‡ ç§åœºæ™¯ï¼š</p>\n<ul>\n<li>å¯¹è±¡æ˜¯ä¸€ä¸ªé™æ€å˜é‡</li>\n<li>å¯¹è±¡æ˜¯ä¸€ä¸ªå·²ç»å‘ç”Ÿé€ƒé€¸çš„å¯¹è±¡</li>\n<li>å¯¹è±¡ä½œä¸ºå½“å‰æ–¹æ³•çš„è¿”å›å€¼</li>\n</ul>\n<h4 id=\"2ã€å‚æ•°é€ƒé€¸ï¼ˆArgEscapeï¼‰\"><a href=\"#2ã€å‚æ•°é€ƒé€¸ï¼ˆArgEscapeï¼‰\" class=\"headerlink\" title=\"2ã€å‚æ•°é€ƒé€¸ï¼ˆArgEscapeï¼‰\"></a>2ã€å‚æ•°é€ƒé€¸ï¼ˆArgEscapeï¼‰</h4><p>å³ä¸€ä¸ªå¯¹è±¡è¢«ä½œä¸ºæ–¹æ³•å‚æ•°ä¼ é€’æˆ–è€…è¢«å‚æ•°å¼•ç”¨ï¼Œä½†åœ¨è°ƒç”¨è¿‡ç¨‹ä¸­ä¸ä¼šå‘ç”Ÿå…¨å±€é€ƒé€¸ï¼Œè¿™ä¸ªçŠ¶æ€æ˜¯é€šè¿‡è¢«è°ƒæ–¹æ³•çš„å­—èŠ‚ç ç¡®å®šçš„ã€‚</p>\n<h4 id=\"3ã€æ²¡æœ‰é€ƒé€¸\"><a href=\"#3ã€æ²¡æœ‰é€ƒé€¸\" class=\"headerlink\" title=\"3ã€æ²¡æœ‰é€ƒé€¸\"></a>3ã€æ²¡æœ‰é€ƒé€¸</h4><p>å³æ–¹æ³•ä¸­çš„å¯¹è±¡æ²¡æœ‰å‘ç”Ÿé€ƒé€¸ã€‚</p>\n<h2 id=\"é€ƒé€¸åˆ†æä¼˜åŒ–\"><a href=\"#é€ƒé€¸åˆ†æä¼˜åŒ–\" class=\"headerlink\" title=\"é€ƒé€¸åˆ†æä¼˜åŒ–\"></a>é€ƒé€¸åˆ†æä¼˜åŒ–</h2><p>é’ˆå¯¹ä¸Šé¢ç¬¬ä¸‰ç‚¹ï¼Œå½“ä¸€ä¸ªå¯¹è±¡æ²¡æœ‰é€ƒé€¸æ—¶ï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹å‡ ä¸ªè™šæ‹Ÿæœºçš„ä¼˜åŒ–ã€‚</p>\n<p><strong>1) é”æ¶ˆé™¤</strong></p>\n<p>æˆ‘ä»¬çŸ¥é“çº¿ç¨‹åŒæ­¥é”æ˜¯éå¸¸ç‰ºç‰²æ€§èƒ½çš„ï¼Œå½“ç¼–è¯‘å™¨ç¡®å®šå½“å‰å¯¹è±¡åªæœ‰å½“å‰çº¿ç¨‹ä½¿ç”¨ï¼Œé‚£ä¹ˆå°±ä¼šç§»é™¤è¯¥å¯¹è±¡çš„åŒæ­¥é”ã€‚</p>\n<p>ä¾‹å¦‚ï¼ŒStringBuffer å’Œ Vector éƒ½æ˜¯ç”¨ synchronized ä¿®é¥°çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œå®ƒä»¬éƒ½åªæ˜¯åœ¨å½“å‰çº¿ç¨‹ä¸­ç”¨åˆ°ï¼Œè¿™æ ·ç¼–è¯‘å™¨å°±ä¼šä¼˜åŒ–ç§»é™¤æ‰è¿™äº›é”æ“ä½œã€‚</p>\n<p>é”æ¶ˆé™¤çš„ JVM å‚æ•°å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>å¼€å¯é”æ¶ˆé™¤ï¼š-XX:+EliminateLocks</li>\n<li>å…³é—­é”æ¶ˆé™¤ï¼š-XX:-EliminateLocks</li>\n</ul>\n<p>é”æ¶ˆé™¤åœ¨ JDK8 ä¸­éƒ½æ˜¯é»˜è®¤å¼€å¯çš„ï¼Œå¹¶ä¸”é”æ¶ˆé™¤éƒ½è¦å»ºç«‹åœ¨é€ƒé€¸åˆ†æçš„åŸºç¡€ä¸Šã€‚</p>\n<p><strong>2) æ ‡é‡æ›¿æ¢</strong></p>\n<p>é¦–å…ˆè¦æ˜ç™½æ ‡é‡å’Œèšåˆé‡ï¼ŒåŸºç¡€ç±»å‹å’Œå¯¹è±¡çš„å¼•ç”¨å¯ä»¥ç†è§£ä¸ºæ ‡é‡ï¼Œå®ƒä»¬ä¸èƒ½è¢«è¿›ä¸€æ­¥åˆ†è§£ã€‚è€Œèƒ½è¢«è¿›ä¸€æ­¥åˆ†è§£çš„é‡å°±æ˜¯èšåˆé‡ï¼Œæ¯”å¦‚ï¼šå¯¹è±¡ã€‚</p>\n<p>å¯¹è±¡æ˜¯èšåˆé‡ï¼Œå®ƒåˆå¯ä»¥è¢«è¿›ä¸€æ­¥åˆ†è§£æˆæ ‡é‡ï¼Œå°†å…¶æˆå‘˜å˜é‡åˆ†è§£ä¸ºåˆ†æ•£çš„å˜é‡ï¼Œè¿™å°±å«åšæ ‡é‡æ›¿æ¢ã€‚</p>\n<p>è¿™æ ·ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡æ²¡æœ‰å‘ç”Ÿé€ƒé€¸ï¼Œé‚£å‹æ ¹å°±ä¸ç”¨åˆ›å»ºå®ƒï¼Œåªä¼šåœ¨æ ˆæˆ–è€…å¯„å­˜å™¨ä¸Šåˆ›å»ºå®ƒç”¨åˆ°çš„æˆå‘˜æ ‡é‡ï¼ŒèŠ‚çœäº†å†…å­˜ç©ºé—´ï¼Œä¹Ÿæå‡äº†åº”ç”¨ç¨‹åºæ€§èƒ½ã€‚</p>\n<p>æ ‡é‡æ›¿æ¢çš„ JVM å‚æ•°å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>å¼€å¯æ ‡é‡æ›¿æ¢ï¼š-XX:+EliminateAllocations</li>\n<li>å…³é—­æ ‡é‡æ›¿æ¢ï¼š-XX:-EliminateAllocations</li>\n<li>æ˜¾ç¤ºæ ‡é‡æ›¿æ¢è¯¦æƒ…ï¼š-XX:+PrintEliminateAllocations</li>\n</ul>\n<p>æ ‡é‡æ›¿æ¢åŒæ ·åœ¨ JDK8 ä¸­éƒ½æ˜¯é»˜è®¤å¼€å¯çš„ï¼Œå¹¶ä¸”éƒ½è¦å»ºç«‹åœ¨é€ƒé€¸åˆ†æçš„åŸºç¡€ä¸Šã€‚</p>\n<p><strong>3) æ ˆä¸Šåˆ†é…</strong></p>\n<p>å½“å¯¹è±¡æ²¡æœ‰å‘ç”Ÿé€ƒé€¸æ—¶ï¼Œè¯¥å¯¹è±¡å°±å¯ä»¥é€šè¿‡æ ‡é‡æ›¿æ¢åˆ†è§£æˆæˆå‘˜æ ‡é‡åˆ†é…åœ¨æ ˆå†…å­˜ä¸­ï¼Œå’Œæ–¹æ³•çš„ç”Ÿå‘½å‘¨æœŸä¸€è‡´ï¼Œéšç€æ ˆå¸§å‡ºæ ˆæ—¶é”€æ¯ï¼Œå‡å°‘äº† GC å‹åŠ›ï¼Œæé«˜äº†åº”ç”¨ç¨‹åºæ€§èƒ½ã€‚</p>\n<h2 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h2><p>é€ƒé€¸åˆ†æè®²å®Œäº†ï¼Œæ€»ç»“äº†ä¸å°‘æ—¶é—´ï¼Œæˆ‘ä»¬ä¹Ÿåº”è¯¥å¤§æ¦‚çŸ¥é“é€ƒé€¸åˆ†ææ˜¯ä¸ºäº†ä¼˜åŒ– JVM å†…å­˜å’Œæå‡ç¨‹åºæ€§èƒ½çš„ã€‚</p>\n<p>æˆ‘ä»¬çŸ¥é“è¿™ç‚¹åï¼Œåœ¨å¹³æ—¶å¼€å‘è¿‡ç¨‹ä¸­å°±è¦å¯å°½å¯èƒ½çš„æ§åˆ¶å˜é‡çš„ä½œç”¨èŒƒå›´äº†ï¼Œå˜é‡èŒƒå›´è¶Šå°è¶Šå¥½ï¼Œè®©è™šæ‹Ÿæœºå°½å¯èƒ½æœ‰ä¼˜åŒ–çš„ç©ºé—´ã€‚</p>\n<p>ç®€å•ä¸¾ä¸€ä¸ªä¾‹å­å§ï¼Œå¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">return sb;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>å¯ä»¥æ”¹ä¸ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">return sb.toString();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>è¿™æ˜¯ä¸€ç§ä¼˜åŒ–æ¡ˆä¾‹ï¼ŒæŠŠ StringBuilder å˜é‡æ§åˆ¶åœ¨äº†å½“å‰æ–¹æ³•ä¹‹å†…ï¼Œæ²¡æœ‰é€ƒå‡ºå½“å‰æ–¹æ³•ä½œç”¨åŸŸã€‚</p>\n<p>å¤§å®¶è¿˜æœ‰æ²¡æœ‰åˆ«çš„ä¼˜åŒ–ç»éªŒï¼Œæ¬¢è¿åˆ†äº«~</p>\n<p>å‚è€ƒèµ„æ–™ï¼š</p>\n<ul>\n<li><p><a href=\"https://docs.oracle.com/javase/8/docs/technotes/guides/vm/performance-enhancements-7.html#escapeAnalysis\">https://docs.oracle.com/javase/8/docs/technotes/guides/vm/performance-enhancements-7.html#escapeAnalysis</a></p>\n</li>\n<li><p><a href=\"https://blog.csdn.net/rickiyeat/article/details/76802085\">https://blog.csdn.net/rickiyeat/article/details/76802085</a></p>\n</li>\n<li><p><a href=\"https://blog.csdn.net/baichoufei90/article/details/85180478\">https://blog.csdn.net/baichoufei90/article/details/85180478</a></p>\n</li>\n<li><p>ä½ çœŸçš„ææ‡‚ transient å…³é”®å­—äº†å—ï¼Ÿ</p>\n</li>\n<li><p>é¢è¯•å¸¸è€ƒï¼šSynchronized æœ‰å‡ ç§ç”¨æ³•ï¼Ÿ</p>\n</li>\n<li><p>Java 11 å·²å‘å¸ƒï¼ŒString è¿˜èƒ½è¿™æ ·ç©ï¼</p>\n</li>\n<li><p>Java ä¸­çš„ String çœŸçš„æ˜¯ä¸å¯å˜å—ï¼Ÿ</p>\n</li>\n<li><p>sleep( ) å’Œ wait( ) çš„è¿™ 5 ä¸ªåŒºåˆ«</p>\n</li>\n<li><p>â€¦â€¦</p>\n</li>\n</ul>\n","excerpt":"","more":"<p>è®°å¾—å‡ å¹´å‰æœ‰ä¸€æ¬¡æ ˆé•¿å»é¢è¯•ï¼Œé—®åˆ°äº†è¿™ä¹ˆä¸€ä¸ªé—®é¢˜:</p>\n<blockquote>\n<p>Javaä¸­çš„å¯¹è±¡éƒ½æ˜¯åœ¨å †ä¸­åˆ†é…å—ï¼Ÿè¯´æ˜ä¸ºä»€ä¹ˆï¼</p>\n</blockquote>\n<p>å½“æ—¶æˆ‘è¢«é—®å¾—ä¸€è„¸è’™é€¼ï¼Œç¬é—´è¢«ç§’æ€å¾—ä½“æ— å®Œè‚¤ï¼Œå½“æ—¶æˆ‘å‹æ ¹å°±ä¸çŸ¥é“ä»–åœ¨è€ƒä»€ä¹ˆçŸ¥è¯†ç‚¹ï¼Œéš¾é“å¯¹è±¡ä¸æ˜¯åœ¨å †ä¸­åˆ†é…å—ï¼Ÿæœ€åå°±æ²¡ç„¶åäº†ï¼Œå›å»ç­‰é€šçŸ¥äº†ã€‚ã€‚</p>\n<p>è¿™ä¸ªé¢è¯•é¢˜å¾ˆç»å…¸ï¼Œæˆ‘æœ€è¿‘ä¹Ÿåˆ†äº«åˆ°äº†çŸ¥è¯†æ˜Ÿçƒä¸Šé¢ï¼š</p>\n<p><img src=\"http://img.javastack.cn/20190527134034.png\"></p>\n<p>å›ç­”å¾ˆç²¾å½©ï¼Œå¤§å®¶å¯ä»¥åŠ å…¥ä¸€èµ·ææŠ€æœ¯ï¼Œæˆ‘ç°åœ¨å°†ç­”æ¡ˆæ€»ç»“ä¸€ä¸‹ç»™å¤§å®¶ã€‚</p>\n<h2 id=\"ä»€ä¹ˆæ˜¯é€ƒé€¸åˆ†æï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯é€ƒé€¸åˆ†æï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯é€ƒé€¸åˆ†æï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯é€ƒé€¸åˆ†æï¼Ÿ</h2><p>å…³äº Java é€ƒé€¸åˆ†æçš„å®šä¹‰ï¼š</p>\n<p>é€ƒé€¸åˆ†æï¼ˆEscape Analysisï¼‰ç®€å•æ¥è®²å°±æ˜¯ï¼ŒJava Hotspot è™šæ‹Ÿæœºå¯ä»¥åˆ†ææ–°åˆ›å»ºå¯¹è±¡çš„ä½¿ç”¨èŒƒå›´ï¼Œå¹¶å†³å®šæ˜¯å¦åœ¨ Java å †ä¸Šåˆ†é…å†…å­˜çš„ä¸€é¡¹æŠ€æœ¯ã€‚</p>\n<p>é€ƒé€¸åˆ†æçš„ JVM å‚æ•°å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>å¼€å¯é€ƒé€¸åˆ†æï¼š-XX:+DoEscapeAnalysis</li>\n<li>å…³é—­é€ƒé€¸åˆ†æï¼š-XX:-DoEscapeAnalysis</li>\n<li>æ˜¾ç¤ºåˆ†æç»“æœï¼š-XX:+PrintEscapeAnalysis</li>\n</ul>\n<p>é€ƒé€¸åˆ†ææŠ€æœ¯åœ¨ Java SE 6u23+ å¼€å§‹æ”¯æŒï¼Œå¹¶é»˜è®¤è®¾ç½®ä¸ºå¯ç”¨çŠ¶æ€ï¼Œå¯ä»¥ä¸ç”¨é¢å¤–åŠ è¿™ä¸ªå‚æ•°ã€‚</p>\n<h2 id=\"é€ƒé€¸åˆ†æç®—æ³•\"><a href=\"#é€ƒé€¸åˆ†æç®—æ³•\" class=\"headerlink\" title=\"é€ƒé€¸åˆ†æç®—æ³•\"></a>é€ƒé€¸åˆ†æç®—æ³•</h2><p>Java Hotspot ç¼–è¯‘å™¨å®ç°ä¸‹é¢è®ºæ–‡ä¸­æè¿°çš„é€ƒé€¸ç®—æ³•ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">[Choi99] Jong-Deok Choi, Manish Gupta, Mauricio Seffano,\n          Vugranam C. Sreedhar, Sam Midkiff,\n          &quot;Escape Analysis for Java&quot;, Procedings of ACM SIGPLAN\n          OOPSLA  Conference, November 1, 1999<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ ¹æ® Jong-Deok Choi, Manish Gupta, Mauricio Seffano,Vugranam C. Sreedhar, Sam Midkiff ç­‰å¤§ç‰›åœ¨è®ºæ–‡ã€Š<strong>Escape Analysis for Java</strong>ã€‹ä¸­æè¿°çš„ç®—æ³•è¿›è¡Œé€ƒé€¸åˆ†æçš„ã€‚</p>\n<p>è¯¥ç®—æ³•å¼•å…¥äº†è¿é€šå›¾ï¼Œç”¨è¿é€šå›¾æ¥æ„å»ºå¯¹è±¡å’Œå¯¹è±¡å¼•ç”¨ä¹‹é—´çš„å¯è¾¾æ€§å…³ç³»ï¼Œå¹¶åœ¨æ¬¡åŸºç¡€ä¸Šï¼Œæå‡ºä¸€ç§ç»„åˆæ•°æ®æµåˆ†ææ³•ã€‚</p>\n<p>ç”±äºç®—æ³•æ˜¯ä¸Šä¸‹æ–‡ç›¸å…³å’Œæµæ•æ„Ÿçš„ï¼Œå¹¶ä¸”æ¨¡æ‹Ÿäº†å¯¹è±¡ä»»æ„å±‚æ¬¡çš„åµŒå¥—å…³ç³»ï¼Œæ‰€ä»¥åˆ†æç²¾åº¦è¾ƒé«˜ï¼Œåªæ˜¯è¿è¡Œæ—¶é—´å’Œå†…å­˜æ¶ˆè€—ç›¸å¯¹è¾ƒå¤§ã€‚ </p>\n<h2 id=\"å¯¹è±¡é€ƒé€¸çŠ¶æ€\"><a href=\"#å¯¹è±¡é€ƒé€¸çŠ¶æ€\" class=\"headerlink\" title=\"å¯¹è±¡é€ƒé€¸çŠ¶æ€\"></a>å¯¹è±¡é€ƒé€¸çŠ¶æ€</h2><p>æˆ‘ä»¬äº†è§£äº† Java ä¸­çš„é€ƒé€¸åˆ†ææŠ€æœ¯ï¼Œå†æ¥äº†è§£ä¸‹ä¸€ä¸ªå¯¹è±¡çš„é€ƒé€¸çŠ¶æ€ã€‚</p>\n<h4 id=\"1ã€å…¨å±€é€ƒé€¸ï¼ˆGlobalEscapeï¼‰\"><a href=\"#1ã€å…¨å±€é€ƒé€¸ï¼ˆGlobalEscapeï¼‰\" class=\"headerlink\" title=\"1ã€å…¨å±€é€ƒé€¸ï¼ˆGlobalEscapeï¼‰\"></a>1ã€å…¨å±€é€ƒé€¸ï¼ˆGlobalEscapeï¼‰</h4><p>å³ä¸€ä¸ªå¯¹è±¡çš„ä½œç”¨èŒƒå›´é€ƒå‡ºäº†å½“å‰æ–¹æ³•æˆ–è€…å½“å‰çº¿ç¨‹ï¼Œæœ‰ä»¥ä¸‹å‡ ç§åœºæ™¯ï¼š</p>\n<ul>\n<li>å¯¹è±¡æ˜¯ä¸€ä¸ªé™æ€å˜é‡</li>\n<li>å¯¹è±¡æ˜¯ä¸€ä¸ªå·²ç»å‘ç”Ÿé€ƒé€¸çš„å¯¹è±¡</li>\n<li>å¯¹è±¡ä½œä¸ºå½“å‰æ–¹æ³•çš„è¿”å›å€¼</li>\n</ul>\n<h4 id=\"2ã€å‚æ•°é€ƒé€¸ï¼ˆArgEscapeï¼‰\"><a href=\"#2ã€å‚æ•°é€ƒé€¸ï¼ˆArgEscapeï¼‰\" class=\"headerlink\" title=\"2ã€å‚æ•°é€ƒé€¸ï¼ˆArgEscapeï¼‰\"></a>2ã€å‚æ•°é€ƒé€¸ï¼ˆArgEscapeï¼‰</h4><p>å³ä¸€ä¸ªå¯¹è±¡è¢«ä½œä¸ºæ–¹æ³•å‚æ•°ä¼ é€’æˆ–è€…è¢«å‚æ•°å¼•ç”¨ï¼Œä½†åœ¨è°ƒç”¨è¿‡ç¨‹ä¸­ä¸ä¼šå‘ç”Ÿå…¨å±€é€ƒé€¸ï¼Œè¿™ä¸ªçŠ¶æ€æ˜¯é€šè¿‡è¢«è°ƒæ–¹æ³•çš„å­—èŠ‚ç ç¡®å®šçš„ã€‚</p>\n<h4 id=\"3ã€æ²¡æœ‰é€ƒé€¸\"><a href=\"#3ã€æ²¡æœ‰é€ƒé€¸\" class=\"headerlink\" title=\"3ã€æ²¡æœ‰é€ƒé€¸\"></a>3ã€æ²¡æœ‰é€ƒé€¸</h4><p>å³æ–¹æ³•ä¸­çš„å¯¹è±¡æ²¡æœ‰å‘ç”Ÿé€ƒé€¸ã€‚</p>\n<h2 id=\"é€ƒé€¸åˆ†æä¼˜åŒ–\"><a href=\"#é€ƒé€¸åˆ†æä¼˜åŒ–\" class=\"headerlink\" title=\"é€ƒé€¸åˆ†æä¼˜åŒ–\"></a>é€ƒé€¸åˆ†æä¼˜åŒ–</h2><p>é’ˆå¯¹ä¸Šé¢ç¬¬ä¸‰ç‚¹ï¼Œå½“ä¸€ä¸ªå¯¹è±¡æ²¡æœ‰é€ƒé€¸æ—¶ï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹å‡ ä¸ªè™šæ‹Ÿæœºçš„ä¼˜åŒ–ã€‚</p>\n<p><strong>1) é”æ¶ˆé™¤</strong></p>\n<p>æˆ‘ä»¬çŸ¥é“çº¿ç¨‹åŒæ­¥é”æ˜¯éå¸¸ç‰ºç‰²æ€§èƒ½çš„ï¼Œå½“ç¼–è¯‘å™¨ç¡®å®šå½“å‰å¯¹è±¡åªæœ‰å½“å‰çº¿ç¨‹ä½¿ç”¨ï¼Œé‚£ä¹ˆå°±ä¼šç§»é™¤è¯¥å¯¹è±¡çš„åŒæ­¥é”ã€‚</p>\n<p>ä¾‹å¦‚ï¼ŒStringBuffer å’Œ Vector éƒ½æ˜¯ç”¨ synchronized ä¿®é¥°çº¿ç¨‹å®‰å…¨çš„ï¼Œä½†å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œå®ƒä»¬éƒ½åªæ˜¯åœ¨å½“å‰çº¿ç¨‹ä¸­ç”¨åˆ°ï¼Œè¿™æ ·ç¼–è¯‘å™¨å°±ä¼šä¼˜åŒ–ç§»é™¤æ‰è¿™äº›é”æ“ä½œã€‚</p>\n<p>é”æ¶ˆé™¤çš„ JVM å‚æ•°å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>å¼€å¯é”æ¶ˆé™¤ï¼š-XX:+EliminateLocks</li>\n<li>å…³é—­é”æ¶ˆé™¤ï¼š-XX:-EliminateLocks</li>\n</ul>\n<p>é”æ¶ˆé™¤åœ¨ JDK8 ä¸­éƒ½æ˜¯é»˜è®¤å¼€å¯çš„ï¼Œå¹¶ä¸”é”æ¶ˆé™¤éƒ½è¦å»ºç«‹åœ¨é€ƒé€¸åˆ†æçš„åŸºç¡€ä¸Šã€‚</p>\n<p><strong>2) æ ‡é‡æ›¿æ¢</strong></p>\n<p>é¦–å…ˆè¦æ˜ç™½æ ‡é‡å’Œèšåˆé‡ï¼ŒåŸºç¡€ç±»å‹å’Œå¯¹è±¡çš„å¼•ç”¨å¯ä»¥ç†è§£ä¸ºæ ‡é‡ï¼Œå®ƒä»¬ä¸èƒ½è¢«è¿›ä¸€æ­¥åˆ†è§£ã€‚è€Œèƒ½è¢«è¿›ä¸€æ­¥åˆ†è§£çš„é‡å°±æ˜¯èšåˆé‡ï¼Œæ¯”å¦‚ï¼šå¯¹è±¡ã€‚</p>\n<p>å¯¹è±¡æ˜¯èšåˆé‡ï¼Œå®ƒåˆå¯ä»¥è¢«è¿›ä¸€æ­¥åˆ†è§£æˆæ ‡é‡ï¼Œå°†å…¶æˆå‘˜å˜é‡åˆ†è§£ä¸ºåˆ†æ•£çš„å˜é‡ï¼Œè¿™å°±å«åšæ ‡é‡æ›¿æ¢ã€‚</p>\n<p>è¿™æ ·ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡æ²¡æœ‰å‘ç”Ÿé€ƒé€¸ï¼Œé‚£å‹æ ¹å°±ä¸ç”¨åˆ›å»ºå®ƒï¼Œåªä¼šåœ¨æ ˆæˆ–è€…å¯„å­˜å™¨ä¸Šåˆ›å»ºå®ƒç”¨åˆ°çš„æˆå‘˜æ ‡é‡ï¼ŒèŠ‚çœäº†å†…å­˜ç©ºé—´ï¼Œä¹Ÿæå‡äº†åº”ç”¨ç¨‹åºæ€§èƒ½ã€‚</p>\n<p>æ ‡é‡æ›¿æ¢çš„ JVM å‚æ•°å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>å¼€å¯æ ‡é‡æ›¿æ¢ï¼š-XX:+EliminateAllocations</li>\n<li>å…³é—­æ ‡é‡æ›¿æ¢ï¼š-XX:-EliminateAllocations</li>\n<li>æ˜¾ç¤ºæ ‡é‡æ›¿æ¢è¯¦æƒ…ï¼š-XX:+PrintEliminateAllocations</li>\n</ul>\n<p>æ ‡é‡æ›¿æ¢åŒæ ·åœ¨ JDK8 ä¸­éƒ½æ˜¯é»˜è®¤å¼€å¯çš„ï¼Œå¹¶ä¸”éƒ½è¦å»ºç«‹åœ¨é€ƒé€¸åˆ†æçš„åŸºç¡€ä¸Šã€‚</p>\n<p><strong>3) æ ˆä¸Šåˆ†é…</strong></p>\n<p>å½“å¯¹è±¡æ²¡æœ‰å‘ç”Ÿé€ƒé€¸æ—¶ï¼Œè¯¥å¯¹è±¡å°±å¯ä»¥é€šè¿‡æ ‡é‡æ›¿æ¢åˆ†è§£æˆæˆå‘˜æ ‡é‡åˆ†é…åœ¨æ ˆå†…å­˜ä¸­ï¼Œå’Œæ–¹æ³•çš„ç”Ÿå‘½å‘¨æœŸä¸€è‡´ï¼Œéšç€æ ˆå¸§å‡ºæ ˆæ—¶é”€æ¯ï¼Œå‡å°‘äº† GC å‹åŠ›ï¼Œæé«˜äº†åº”ç”¨ç¨‹åºæ€§èƒ½ã€‚</p>\n<h2 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h2><p>é€ƒé€¸åˆ†æè®²å®Œäº†ï¼Œæ€»ç»“äº†ä¸å°‘æ—¶é—´ï¼Œæˆ‘ä»¬ä¹Ÿåº”è¯¥å¤§æ¦‚çŸ¥é“é€ƒé€¸åˆ†ææ˜¯ä¸ºäº†ä¼˜åŒ– JVM å†…å­˜å’Œæå‡ç¨‹åºæ€§èƒ½çš„ã€‚</p>\n<p>æˆ‘ä»¬çŸ¥é“è¿™ç‚¹åï¼Œåœ¨å¹³æ—¶å¼€å‘è¿‡ç¨‹ä¸­å°±è¦å¯å°½å¯èƒ½çš„æ§åˆ¶å˜é‡çš„ä½œç”¨èŒƒå›´äº†ï¼Œå˜é‡èŒƒå›´è¶Šå°è¶Šå¥½ï¼Œè®©è™šæ‹Ÿæœºå°½å¯èƒ½æœ‰ä¼˜åŒ–çš„ç©ºé—´ã€‚</p>\n<p>ç®€å•ä¸¾ä¸€ä¸ªä¾‹å­å§ï¼Œå¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">return sb;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>å¯ä»¥æ”¹ä¸ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">return sb.toString();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>è¿™æ˜¯ä¸€ç§ä¼˜åŒ–æ¡ˆä¾‹ï¼ŒæŠŠ StringBuilder å˜é‡æ§åˆ¶åœ¨äº†å½“å‰æ–¹æ³•ä¹‹å†…ï¼Œæ²¡æœ‰é€ƒå‡ºå½“å‰æ–¹æ³•ä½œç”¨åŸŸã€‚</p>\n<p>å¤§å®¶è¿˜æœ‰æ²¡æœ‰åˆ«çš„ä¼˜åŒ–ç»éªŒï¼Œæ¬¢è¿åˆ†äº«~</p>\n<p>å‚è€ƒèµ„æ–™ï¼š</p>\n<ul>\n<li><p><a href=\"https://docs.oracle.com/javase/8/docs/technotes/guides/vm/performance-enhancements-7.html#escapeAnalysis\">https://docs.oracle.com/javase/8/docs/technotes/guides/vm/performance-enhancements-7.html#escapeAnalysis</a></p>\n</li>\n<li><p><a href=\"https://blog.csdn.net/rickiyeat/article/details/76802085\">https://blog.csdn.net/rickiyeat/article/details/76802085</a></p>\n</li>\n<li><p><a href=\"https://blog.csdn.net/baichoufei90/article/details/85180478\">https://blog.csdn.net/baichoufei90/article/details/85180478</a></p>\n</li>\n<li><p>ä½ çœŸçš„ææ‡‚ transient å…³é”®å­—äº†å—ï¼Ÿ</p>\n</li>\n<li><p>é¢è¯•å¸¸è€ƒï¼šSynchronized æœ‰å‡ ç§ç”¨æ³•ï¼Ÿ</p>\n</li>\n<li><p>Java 11 å·²å‘å¸ƒï¼ŒString è¿˜èƒ½è¿™æ ·ç©ï¼</p>\n</li>\n<li><p>Java ä¸­çš„ String çœŸçš„æ˜¯ä¸å¯å˜å—ï¼Ÿ</p>\n</li>\n<li><p>sleep( ) å’Œ wait( ) çš„è¿™ 5 ä¸ªåŒºåˆ«</p>\n</li>\n<li><p>â€¦â€¦</p>\n</li>\n</ul>\n"},{"title":"Javaå¤šçº¿ç¨‹joinä½¿ç”¨åŠåŸç†","date":"2025-10-14T01:53:44.000Z","_content":"\n## join()\n\njoin()æ˜¯çº¿ç¨‹ç±»`Thread`çš„æ–¹æ³•ï¼Œå®˜æ–¹çš„è¯´æ˜æ˜¯ï¼š\n\n> Waits for this thread to die.\n\nç­‰å¾…è¿™ä¸ªçº¿ç¨‹ç»“æŸï¼Œä¹Ÿå°±æ˜¯è¯´å½“å‰çº¿ç¨‹ç­‰å¾…è¿™ä¸ªçº¿ç¨‹ç»“æŸåå†ç»§ç»­æ‰§è¡Œï¼Œä¸‹é¢æ¥çœ‹è¿™ä¸ªç¤ºä¾‹å°±æ˜ç™½äº†ã€‚\n\n## ç¤ºä¾‹\n\n```\npublic static void main(String[] args) throws Exception {\n\tSystem.out.println(\"start\");\n\n\tThread t = new Thread(() -> {\n\t\tfor (int i = 0; i < 5; i++) {\n\t\t\tSystem.out.println(i);\n\t\t\ttry {\n\t\t\t\tThread.sleep(500);\n\t\t\t} catch (InterruptedException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t}\n\t});\n\tt.start();\n\tt.join();\n\n\tSystem.out.println(\"end\");\n}\n```\n\nç»“æœè¾“å‡ºï¼š\n\n\n```\nstart\n0\n1\n2\n3\n4\nend\n```\n\nçº¿ç¨‹tå¼€å§‹åï¼Œæ¥ç€åŠ å…¥t.join()æ–¹æ³•ï¼Œtçº¿ç¨‹é‡Œé¢ç¨‹åºåœ¨ä¸»çº¿ç¨‹endè¾“å‡ºä¹‹å‰å…¨éƒ¨æ‰§è¡Œå®Œäº†ï¼Œè¯´æ˜t.join()é˜»å¡äº†ä¸»çº¿ç¨‹ç›´åˆ°tçº¿ç¨‹æ‰§è¡Œå®Œæ¯•ã€‚\n\nå¦‚æœæ²¡æœ‰t.join()ï¼Œendå¯èƒ½ä¼šåœ¨0~5ä¹‹é—´è¾“å‡ºã€‚\n\n\n## join()åŸç†\n\nä¸‹é¢æ˜¯join()çš„æºç ï¼š\n\n```\npublic final synchronized void join(long millis)\n    throws InterruptedException {\n    long base = System.currentTimeMillis();\n    long now = 0;\n\n    if (millis < 0) {\n        throw new IllegalArgumentException(\"timeout value is negative\");\n    }\n\n    if (millis == 0) {\n        while (isAlive()) {\n            wait(0);\n        }\n    } else {\n        while (isAlive()) {\n            long delay = millis - now;\n            if (delay <= 0) {\n                break;\n            }\n            wait(delay);\n            now = System.currentTimeMillis() - base;\n        }\n    }\n}\n```\n\nå¯ä»¥çœ‹å‡ºå®ƒæ˜¯åˆ©ç”¨waitæ–¹æ³•æ¥å®ç°çš„ï¼Œä¸Šé¢çš„ä¾‹å­å½“mainæ–¹æ³•ä¸»çº¿ç¨‹è°ƒç”¨çº¿ç¨‹tçš„æ—¶å€™ï¼Œmainæ–¹æ³•è·å–åˆ°äº†tçš„å¯¹è±¡é”ï¼Œè€Œtè°ƒç”¨è‡ªèº«waitæ–¹æ³•è¿›è¡Œé˜»å¡ï¼Œåªè¦å½“tç»“æŸæˆ–è€…åˆ°æ—¶é—´åæ‰ä¼šé€€å‡ºï¼Œæ¥ç€å”¤é†’ä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œã€‚millisä¸ºä¸»çº¿ç¨‹ç­‰å¾…tçº¿ç¨‹æœ€é•¿æ‰§è¡Œå¤šä¹…ï¼Œ0ä¸ºæ°¸ä¹…ç›´åˆ°tçº¿ç¨‹æ‰§è¡Œç»“æŸã€‚","source":"_posts/å¤šçº¿ç¨‹/Javaå¤šçº¿ç¨‹joinä½¿ç”¨åŠåŸç†.md","raw":"---\ntitle: Javaå¤šçº¿ç¨‹joinä½¿ç”¨åŠåŸç†\ndate: 2025-10-14 09:53:44\ncategory: åç«¯\ntags: å¤šçº¿ç¨‹\n---\n\n## join()\n\njoin()æ˜¯çº¿ç¨‹ç±»`Thread`çš„æ–¹æ³•ï¼Œå®˜æ–¹çš„è¯´æ˜æ˜¯ï¼š\n\n> Waits for this thread to die.\n\nç­‰å¾…è¿™ä¸ªçº¿ç¨‹ç»“æŸï¼Œä¹Ÿå°±æ˜¯è¯´å½“å‰çº¿ç¨‹ç­‰å¾…è¿™ä¸ªçº¿ç¨‹ç»“æŸåå†ç»§ç»­æ‰§è¡Œï¼Œä¸‹é¢æ¥çœ‹è¿™ä¸ªç¤ºä¾‹å°±æ˜ç™½äº†ã€‚\n\n## ç¤ºä¾‹\n\n```\npublic static void main(String[] args) throws Exception {\n\tSystem.out.println(\"start\");\n\n\tThread t = new Thread(() -> {\n\t\tfor (int i = 0; i < 5; i++) {\n\t\t\tSystem.out.println(i);\n\t\t\ttry {\n\t\t\t\tThread.sleep(500);\n\t\t\t} catch (InterruptedException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t}\n\t});\n\tt.start();\n\tt.join();\n\n\tSystem.out.println(\"end\");\n}\n```\n\nç»“æœè¾“å‡ºï¼š\n\n\n```\nstart\n0\n1\n2\n3\n4\nend\n```\n\nçº¿ç¨‹tå¼€å§‹åï¼Œæ¥ç€åŠ å…¥t.join()æ–¹æ³•ï¼Œtçº¿ç¨‹é‡Œé¢ç¨‹åºåœ¨ä¸»çº¿ç¨‹endè¾“å‡ºä¹‹å‰å…¨éƒ¨æ‰§è¡Œå®Œäº†ï¼Œè¯´æ˜t.join()é˜»å¡äº†ä¸»çº¿ç¨‹ç›´åˆ°tçº¿ç¨‹æ‰§è¡Œå®Œæ¯•ã€‚\n\nå¦‚æœæ²¡æœ‰t.join()ï¼Œendå¯èƒ½ä¼šåœ¨0~5ä¹‹é—´è¾“å‡ºã€‚\n\n\n## join()åŸç†\n\nä¸‹é¢æ˜¯join()çš„æºç ï¼š\n\n```\npublic final synchronized void join(long millis)\n    throws InterruptedException {\n    long base = System.currentTimeMillis();\n    long now = 0;\n\n    if (millis < 0) {\n        throw new IllegalArgumentException(\"timeout value is negative\");\n    }\n\n    if (millis == 0) {\n        while (isAlive()) {\n            wait(0);\n        }\n    } else {\n        while (isAlive()) {\n            long delay = millis - now;\n            if (delay <= 0) {\n                break;\n            }\n            wait(delay);\n            now = System.currentTimeMillis() - base;\n        }\n    }\n}\n```\n\nå¯ä»¥çœ‹å‡ºå®ƒæ˜¯åˆ©ç”¨waitæ–¹æ³•æ¥å®ç°çš„ï¼Œä¸Šé¢çš„ä¾‹å­å½“mainæ–¹æ³•ä¸»çº¿ç¨‹è°ƒç”¨çº¿ç¨‹tçš„æ—¶å€™ï¼Œmainæ–¹æ³•è·å–åˆ°äº†tçš„å¯¹è±¡é”ï¼Œè€Œtè°ƒç”¨è‡ªèº«waitæ–¹æ³•è¿›è¡Œé˜»å¡ï¼Œåªè¦å½“tç»“æŸæˆ–è€…åˆ°æ—¶é—´åæ‰ä¼šé€€å‡ºï¼Œæ¥ç€å”¤é†’ä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œã€‚millisä¸ºä¸»çº¿ç¨‹ç­‰å¾…tçº¿ç¨‹æœ€é•¿æ‰§è¡Œå¤šä¹…ï¼Œ0ä¸ºæ°¸ä¹…ç›´åˆ°tçº¿ç¨‹æ‰§è¡Œç»“æŸã€‚","slug":"å¤šçº¿ç¨‹/Javaå¤šçº¿ç¨‹joinä½¿ç”¨åŠåŸç†","published":1,"updated":"2025-10-15T07:20:25.057Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076k001oqkd47hvn1fd4","content":"<h2 id=\"join\"><a href=\"#join\" class=\"headerlink\" title=\"join()\"></a>join()</h2><p>join()æ˜¯çº¿ç¨‹ç±»<code>Thread</code>çš„æ–¹æ³•ï¼Œå®˜æ–¹çš„è¯´æ˜æ˜¯ï¼š</p>\n<blockquote>\n<p>Waits for this thread to die.</p>\n</blockquote>\n<p>ç­‰å¾…è¿™ä¸ªçº¿ç¨‹ç»“æŸï¼Œä¹Ÿå°±æ˜¯è¯´å½“å‰çº¿ç¨‹ç­‰å¾…è¿™ä¸ªçº¿ç¨‹ç»“æŸåå†ç»§ç»­æ‰§è¡Œï¼Œä¸‹é¢æ¥çœ‹è¿™ä¸ªç¤ºä¾‹å°±æ˜ç™½äº†ã€‚</p>\n<h2 id=\"ç¤ºä¾‹\"><a href=\"#ç¤ºä¾‹\" class=\"headerlink\" title=\"ç¤ºä¾‹\"></a>ç¤ºä¾‹</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) throws Exception &#123;\n\tSystem.out.println(&quot;start&quot;);\n\n\tThread t &#x3D; new Thread(() -&gt; &#123;\n\t\tfor (int i &#x3D; 0; i &lt; 5; i++) &#123;\n\t\t\tSystem.out.println(i);\n\t\t\ttry &#123;\n\t\t\t\tThread.sleep(500);\n\t\t\t&#125; catch (InterruptedException e) &#123;\n\t\t\t\te.printStackTrace();\n\t\t\t&#125;\n\t\t&#125;\n\t&#125;);\n\tt.start();\n\tt.join();\n\n\tSystem.out.println(&quot;end&quot;);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç»“æœè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">start\n0\n1\n2\n3\n4\nend<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>çº¿ç¨‹tå¼€å§‹åï¼Œæ¥ç€åŠ å…¥t.join()æ–¹æ³•ï¼Œtçº¿ç¨‹é‡Œé¢ç¨‹åºåœ¨ä¸»çº¿ç¨‹endè¾“å‡ºä¹‹å‰å…¨éƒ¨æ‰§è¡Œå®Œäº†ï¼Œè¯´æ˜t.join()é˜»å¡äº†ä¸»çº¿ç¨‹ç›´åˆ°tçº¿ç¨‹æ‰§è¡Œå®Œæ¯•ã€‚</p>\n<p>å¦‚æœæ²¡æœ‰t.join()ï¼Œendå¯èƒ½ä¼šåœ¨0~5ä¹‹é—´è¾“å‡ºã€‚</p>\n<h2 id=\"join-åŸç†\"><a href=\"#join-åŸç†\" class=\"headerlink\" title=\"join()åŸç†\"></a>join()åŸç†</h2><p>ä¸‹é¢æ˜¯join()çš„æºç ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public final synchronized void join(long millis)\n    throws InterruptedException &#123;\n    long base &#x3D; System.currentTimeMillis();\n    long now &#x3D; 0;\n\n    if (millis &lt; 0) &#123;\n        throw new IllegalArgumentException(&quot;timeout value is negative&quot;);\n    &#125;\n\n    if (millis &#x3D;&#x3D; 0) &#123;\n        while (isAlive()) &#123;\n            wait(0);\n        &#125;\n    &#125; else &#123;\n        while (isAlive()) &#123;\n            long delay &#x3D; millis - now;\n            if (delay &lt;&#x3D; 0) &#123;\n                break;\n            &#125;\n            wait(delay);\n            now &#x3D; System.currentTimeMillis() - base;\n        &#125;\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥çœ‹å‡ºå®ƒæ˜¯åˆ©ç”¨waitæ–¹æ³•æ¥å®ç°çš„ï¼Œä¸Šé¢çš„ä¾‹å­å½“mainæ–¹æ³•ä¸»çº¿ç¨‹è°ƒç”¨çº¿ç¨‹tçš„æ—¶å€™ï¼Œmainæ–¹æ³•è·å–åˆ°äº†tçš„å¯¹è±¡é”ï¼Œè€Œtè°ƒç”¨è‡ªèº«waitæ–¹æ³•è¿›è¡Œé˜»å¡ï¼Œåªè¦å½“tç»“æŸæˆ–è€…åˆ°æ—¶é—´åæ‰ä¼šé€€å‡ºï¼Œæ¥ç€å”¤é†’ä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œã€‚millisä¸ºä¸»çº¿ç¨‹ç­‰å¾…tçº¿ç¨‹æœ€é•¿æ‰§è¡Œå¤šä¹…ï¼Œ0ä¸ºæ°¸ä¹…ç›´åˆ°tçº¿ç¨‹æ‰§è¡Œç»“æŸã€‚</p>\n","excerpt":"","more":"<h2 id=\"join\"><a href=\"#join\" class=\"headerlink\" title=\"join()\"></a>join()</h2><p>join()æ˜¯çº¿ç¨‹ç±»<code>Thread</code>çš„æ–¹æ³•ï¼Œå®˜æ–¹çš„è¯´æ˜æ˜¯ï¼š</p>\n<blockquote>\n<p>Waits for this thread to die.</p>\n</blockquote>\n<p>ç­‰å¾…è¿™ä¸ªçº¿ç¨‹ç»“æŸï¼Œä¹Ÿå°±æ˜¯è¯´å½“å‰çº¿ç¨‹ç­‰å¾…è¿™ä¸ªçº¿ç¨‹ç»“æŸåå†ç»§ç»­æ‰§è¡Œï¼Œä¸‹é¢æ¥çœ‹è¿™ä¸ªç¤ºä¾‹å°±æ˜ç™½äº†ã€‚</p>\n<h2 id=\"ç¤ºä¾‹\"><a href=\"#ç¤ºä¾‹\" class=\"headerlink\" title=\"ç¤ºä¾‹\"></a>ç¤ºä¾‹</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) throws Exception &#123;\n\tSystem.out.println(&quot;start&quot;);\n\n\tThread t &#x3D; new Thread(() -&gt; &#123;\n\t\tfor (int i &#x3D; 0; i &lt; 5; i++) &#123;\n\t\t\tSystem.out.println(i);\n\t\t\ttry &#123;\n\t\t\t\tThread.sleep(500);\n\t\t\t&#125; catch (InterruptedException e) &#123;\n\t\t\t\te.printStackTrace();\n\t\t\t&#125;\n\t\t&#125;\n\t&#125;);\n\tt.start();\n\tt.join();\n\n\tSystem.out.println(&quot;end&quot;);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç»“æœè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">start\n0\n1\n2\n3\n4\nend<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>çº¿ç¨‹tå¼€å§‹åï¼Œæ¥ç€åŠ å…¥t.join()æ–¹æ³•ï¼Œtçº¿ç¨‹é‡Œé¢ç¨‹åºåœ¨ä¸»çº¿ç¨‹endè¾“å‡ºä¹‹å‰å…¨éƒ¨æ‰§è¡Œå®Œäº†ï¼Œè¯´æ˜t.join()é˜»å¡äº†ä¸»çº¿ç¨‹ç›´åˆ°tçº¿ç¨‹æ‰§è¡Œå®Œæ¯•ã€‚</p>\n<p>å¦‚æœæ²¡æœ‰t.join()ï¼Œendå¯èƒ½ä¼šåœ¨0~5ä¹‹é—´è¾“å‡ºã€‚</p>\n<h2 id=\"join-åŸç†\"><a href=\"#join-åŸç†\" class=\"headerlink\" title=\"join()åŸç†\"></a>join()åŸç†</h2><p>ä¸‹é¢æ˜¯join()çš„æºç ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public final synchronized void join(long millis)\n    throws InterruptedException &#123;\n    long base &#x3D; System.currentTimeMillis();\n    long now &#x3D; 0;\n\n    if (millis &lt; 0) &#123;\n        throw new IllegalArgumentException(&quot;timeout value is negative&quot;);\n    &#125;\n\n    if (millis &#x3D;&#x3D; 0) &#123;\n        while (isAlive()) &#123;\n            wait(0);\n        &#125;\n    &#125; else &#123;\n        while (isAlive()) &#123;\n            long delay &#x3D; millis - now;\n            if (delay &lt;&#x3D; 0) &#123;\n                break;\n            &#125;\n            wait(delay);\n            now &#x3D; System.currentTimeMillis() - base;\n        &#125;\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥çœ‹å‡ºå®ƒæ˜¯åˆ©ç”¨waitæ–¹æ³•æ¥å®ç°çš„ï¼Œä¸Šé¢çš„ä¾‹å­å½“mainæ–¹æ³•ä¸»çº¿ç¨‹è°ƒç”¨çº¿ç¨‹tçš„æ—¶å€™ï¼Œmainæ–¹æ³•è·å–åˆ°äº†tçš„å¯¹è±¡é”ï¼Œè€Œtè°ƒç”¨è‡ªèº«waitæ–¹æ³•è¿›è¡Œé˜»å¡ï¼Œåªè¦å½“tç»“æŸæˆ–è€…åˆ°æ—¶é—´åæ‰ä¼šé€€å‡ºï¼Œæ¥ç€å”¤é†’ä¸»çº¿ç¨‹ç»§ç»­æ‰§è¡Œã€‚millisä¸ºä¸»çº¿ç¨‹ç­‰å¾…tçº¿ç¨‹æœ€é•¿æ‰§è¡Œå¤šä¹…ï¼Œ0ä¸ºæ°¸ä¹…ç›´åˆ°tçº¿ç¨‹æ‰§è¡Œç»“æŸã€‚</p>\n"},{"title":"Javaå¤šçº¿ç¨‹å¯ä»¥åˆ†ç»„è¿˜èƒ½è¿™æ ·ç©","date":"2025-10-14T01:56:28.000Z","_content":"\n\nä½†å¦‚æœçº¿ç¨‹å¾ˆå¤šçš„æƒ…å†µä¸‹ï¼Œä½ çŸ¥é“å¦‚ä½•å¯¹å®ƒä»¬è¿›è¡Œåˆ†ç»„å—ï¼Ÿ\n\nå’Œ Dubbo çš„æœåŠ¡åˆ†ç»„ä¸€æ ·ï¼ŒJava å¯ä»¥å¯¹ç›¸åŒæ€§è´¨çš„çº¿ç¨‹è¿›è¡Œåˆ†ç»„ã€‚\n\næ¥çœ‹ä¸‹çº¿ç¨‹ç±» Thread çš„æ‰€æœ‰æ„é€ æ–¹æ³•ã€‚\n\n![](http://qianniu.javastack.cn/18-6-3/9061041.jpg)\n\nå¦‚å›¾æ‰€ç¤ºï¼Œå¸¦æœ‰ ThreadGroup çš„æ‰€æœ‰çº¿ç¨‹æ„é€ æ–¹æ³•éƒ½å¯ä»¥å®šä¹‰çº¿ç¨‹ç»„çš„ã€‚\n\nçº¿ç¨‹ç»„ä½¿ç”¨ java.lang.ThreadGroup ç±»å®šä¹‰ï¼Œå®ƒæœ‰ä¸¤ä¸ªæ„é€ æ–¹æ³•ï¼Œç¬¬äºŒä¸ªæ„é€ æ–¹æ³•å…è®¸çº¿ç¨‹ç»„æœ‰çˆ¶ç±»çº¿ç¨‹ç»„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªçº¿ç¨‹ç»„å¯ä»¥å¤šä¸ªå­çº¿ç¨‹ç»„ã€‚\n\n```\njava.lang.ThreadGroup#ThreadGroup(java.lang.String)\njava.lang.ThreadGroup#ThreadGroup(java.lang.ThreadGroup, java.lang.String)\n```\n\n![](http://qianniu.javastack.cn/18-6-4/38415499.jpg)\n\nçº¿ç¨‹ç»„ä¸­æ¯”è¾ƒæœ‰ç”¨çš„å‡ ä¸ªæ–¹æ³•ã€‚\n\n> // è·å–å½“å‰çº¿ç¨‹ç»„å†…çš„è¿è¡Œçº¿ç¨‹æ•°\n> java.lang.ThreadGroup#activeCount\n>\n> // ä¸­æ–­çº¿ç¨‹ç»„å†…çš„æ‰€æœ‰çº¿ç¨‹\n> java.lang.ThreadGroup#interrupt\n>\n> // ä½¿ç”¨ System.out æ‰“å°å‡ºæ‰€æœ‰çº¿ç¨‹ä¿¡æ¯\n> java.lang.ThreadGroup#list()\n\næˆ‘ä»¬æ¥ç®€å•ä½¿ç”¨ä¸‹çº¿ç¨‹ç»„å§ï¼\n\n```\n/**\n * \n */\npublic static void main(String[] args) {\n\tRunnable runnable = () -> {\n\t\tSystem.out.println(\"JavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹ç»„åç§°ï¼š\" + Thread.currentThread().getThreadGroup());\n\t\tSystem.out.println(\"JavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹åç§°ï¼š\" + Thread.currentThread().getName());\n\t\ttry {\n\t\t\tThread.sleep(3000);\n\t\t} catch (InterruptedException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t};\n\n\tThreadGroup userGroup = new ThreadGroup(\"user\");\n    userGroup.setMaxPriority(Thread.MIN_PRIORITY);\n    \n\tThread userTask1 = new Thread(userGroup, runnable, \"user-task1\");\n\tThread userTask2 = new Thread(userGroup, runnable, \"user-task2\");\n\n\tuserTask1.start();\n\tuserTask2.start();\n\n\tSystem.out.println(\"JavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹ç»„æ´»è·ƒçº¿ç¨‹æ•°ï¼š\" + userGroup.activeCount());\n\tuserGroup.list();\n\n}\n```\n\nç¨‹åºè¾“å‡ºä»¥ä¸‹ç»“æœã€‚\n\n```\nJavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹ç»„åç§°ï¼šjava.lang.ThreadGroup[name=user,maxpri=1]\nJavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹åç§°ï¼šuser-task1\nJavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹ç»„æ´»è·ƒçº¿ç¨‹æ•°ï¼š2\nJavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹ç»„åç§°ï¼šjava.lang.ThreadGroup[name=user,maxpri=1]\nJavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹åç§°ï¼šuser-task2\njava.lang.ThreadGroup[name=user,maxpri=1]\n    Thread[user-task1,1,user]\n    Thread[user-task2,1,user]\n```\n\næ ¹æ®ç¤ºä¾‹ä»£ç å’Œç¨‹åºè¾“å‡ºç»“æœåº”è¯¥å¯¹çº¿ç¨‹ç»„æœ‰äº†ä¸€ä¸ªå¤§æ¦‚çš„äº†è§£å§ã€‚\n\nçº¿ç¨‹ç»„è¿˜èƒ½ç»Ÿä¸€è®¾ç½®ç»„å†…æ‰€æœ‰çº¿ç¨‹çš„æœ€é«˜ä¼˜å…ˆçº§ï¼Œçº¿ç¨‹å•ç‹¬è®¾ç½®çš„ä¼˜å…ˆçº§ä¸ä¼šé«˜äºçº¿ç¨‹ç»„è®¾ç½®çš„æœ€å¤§ä¼˜å…ˆçº§ã€‚\n\nå¦å¤–ï¼Œçº¿ç¨‹ç»„ä¸­æœ‰ä¸€ä¸ª stop æ–¹æ³•ç”¨æ¥ç»ˆæ­¢ç»„å†…æ‰€æœ‰çš„çº¿ç¨‹ï¼Œä½†è¿™ä¸ªæ–¹æ³•å’Œ Thread ä¸­çš„ stop æ–¹æ³•ä¸€æ ·ä¼šå¸¦æ¥å¾ˆå¤šé—®é¢˜ï¼Œæ‰€ä»¥å®ƒä»¬ä¸¤ä¸ªç°åœ¨éƒ½å·²ç»è¢«åºŸå¼ƒäº†ï¼Œå®˜æ–¹ä¹Ÿæ˜¯ä¸å»ºè®®ä½¿ç”¨äº†ï¼Œå»ºè®®ä½¿ç”¨çº¿ç¨‹ä¸­æ–­åŠŸèƒ½è¿›è¡Œä¼˜é›…ç»ˆæ­¢çº¿ç¨‹ã€‚\n\n---\n\n","source":"_posts/å¤šçº¿ç¨‹/Javaå¤šçº¿ç¨‹å¯ä»¥åˆ†ç»„è¿˜èƒ½è¿™æ ·ç©.md","raw":"---\ntitle: Javaå¤šçº¿ç¨‹å¯ä»¥åˆ†ç»„è¿˜èƒ½è¿™æ ·ç©\ndate: 2025-10-14 09:56:28\ncategory: åç«¯\ntags: å¤šçº¿ç¨‹\n---\n\n\nä½†å¦‚æœçº¿ç¨‹å¾ˆå¤šçš„æƒ…å†µä¸‹ï¼Œä½ çŸ¥é“å¦‚ä½•å¯¹å®ƒä»¬è¿›è¡Œåˆ†ç»„å—ï¼Ÿ\n\nå’Œ Dubbo çš„æœåŠ¡åˆ†ç»„ä¸€æ ·ï¼ŒJava å¯ä»¥å¯¹ç›¸åŒæ€§è´¨çš„çº¿ç¨‹è¿›è¡Œåˆ†ç»„ã€‚\n\næ¥çœ‹ä¸‹çº¿ç¨‹ç±» Thread çš„æ‰€æœ‰æ„é€ æ–¹æ³•ã€‚\n\n![](http://qianniu.javastack.cn/18-6-3/9061041.jpg)\n\nå¦‚å›¾æ‰€ç¤ºï¼Œå¸¦æœ‰ ThreadGroup çš„æ‰€æœ‰çº¿ç¨‹æ„é€ æ–¹æ³•éƒ½å¯ä»¥å®šä¹‰çº¿ç¨‹ç»„çš„ã€‚\n\nçº¿ç¨‹ç»„ä½¿ç”¨ java.lang.ThreadGroup ç±»å®šä¹‰ï¼Œå®ƒæœ‰ä¸¤ä¸ªæ„é€ æ–¹æ³•ï¼Œç¬¬äºŒä¸ªæ„é€ æ–¹æ³•å…è®¸çº¿ç¨‹ç»„æœ‰çˆ¶ç±»çº¿ç¨‹ç»„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªçº¿ç¨‹ç»„å¯ä»¥å¤šä¸ªå­çº¿ç¨‹ç»„ã€‚\n\n```\njava.lang.ThreadGroup#ThreadGroup(java.lang.String)\njava.lang.ThreadGroup#ThreadGroup(java.lang.ThreadGroup, java.lang.String)\n```\n\n![](http://qianniu.javastack.cn/18-6-4/38415499.jpg)\n\nçº¿ç¨‹ç»„ä¸­æ¯”è¾ƒæœ‰ç”¨çš„å‡ ä¸ªæ–¹æ³•ã€‚\n\n> // è·å–å½“å‰çº¿ç¨‹ç»„å†…çš„è¿è¡Œçº¿ç¨‹æ•°\n> java.lang.ThreadGroup#activeCount\n>\n> // ä¸­æ–­çº¿ç¨‹ç»„å†…çš„æ‰€æœ‰çº¿ç¨‹\n> java.lang.ThreadGroup#interrupt\n>\n> // ä½¿ç”¨ System.out æ‰“å°å‡ºæ‰€æœ‰çº¿ç¨‹ä¿¡æ¯\n> java.lang.ThreadGroup#list()\n\næˆ‘ä»¬æ¥ç®€å•ä½¿ç”¨ä¸‹çº¿ç¨‹ç»„å§ï¼\n\n```\n/**\n * \n */\npublic static void main(String[] args) {\n\tRunnable runnable = () -> {\n\t\tSystem.out.println(\"JavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹ç»„åç§°ï¼š\" + Thread.currentThread().getThreadGroup());\n\t\tSystem.out.println(\"JavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹åç§°ï¼š\" + Thread.currentThread().getName());\n\t\ttry {\n\t\t\tThread.sleep(3000);\n\t\t} catch (InterruptedException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t};\n\n\tThreadGroup userGroup = new ThreadGroup(\"user\");\n    userGroup.setMaxPriority(Thread.MIN_PRIORITY);\n    \n\tThread userTask1 = new Thread(userGroup, runnable, \"user-task1\");\n\tThread userTask2 = new Thread(userGroup, runnable, \"user-task2\");\n\n\tuserTask1.start();\n\tuserTask2.start();\n\n\tSystem.out.println(\"JavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹ç»„æ´»è·ƒçº¿ç¨‹æ•°ï¼š\" + userGroup.activeCount());\n\tuserGroup.list();\n\n}\n```\n\nç¨‹åºè¾“å‡ºä»¥ä¸‹ç»“æœã€‚\n\n```\nJavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹ç»„åç§°ï¼šjava.lang.ThreadGroup[name=user,maxpri=1]\nJavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹åç§°ï¼šuser-task1\nJavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹ç»„æ´»è·ƒçº¿ç¨‹æ•°ï¼š2\nJavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹ç»„åç§°ï¼šjava.lang.ThreadGroup[name=user,maxpri=1]\nJavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹åç§°ï¼šuser-task2\njava.lang.ThreadGroup[name=user,maxpri=1]\n    Thread[user-task1,1,user]\n    Thread[user-task2,1,user]\n```\n\næ ¹æ®ç¤ºä¾‹ä»£ç å’Œç¨‹åºè¾“å‡ºç»“æœåº”è¯¥å¯¹çº¿ç¨‹ç»„æœ‰äº†ä¸€ä¸ªå¤§æ¦‚çš„äº†è§£å§ã€‚\n\nçº¿ç¨‹ç»„è¿˜èƒ½ç»Ÿä¸€è®¾ç½®ç»„å†…æ‰€æœ‰çº¿ç¨‹çš„æœ€é«˜ä¼˜å…ˆçº§ï¼Œçº¿ç¨‹å•ç‹¬è®¾ç½®çš„ä¼˜å…ˆçº§ä¸ä¼šé«˜äºçº¿ç¨‹ç»„è®¾ç½®çš„æœ€å¤§ä¼˜å…ˆçº§ã€‚\n\nå¦å¤–ï¼Œçº¿ç¨‹ç»„ä¸­æœ‰ä¸€ä¸ª stop æ–¹æ³•ç”¨æ¥ç»ˆæ­¢ç»„å†…æ‰€æœ‰çš„çº¿ç¨‹ï¼Œä½†è¿™ä¸ªæ–¹æ³•å’Œ Thread ä¸­çš„ stop æ–¹æ³•ä¸€æ ·ä¼šå¸¦æ¥å¾ˆå¤šé—®é¢˜ï¼Œæ‰€ä»¥å®ƒä»¬ä¸¤ä¸ªç°åœ¨éƒ½å·²ç»è¢«åºŸå¼ƒäº†ï¼Œå®˜æ–¹ä¹Ÿæ˜¯ä¸å»ºè®®ä½¿ç”¨äº†ï¼Œå»ºè®®ä½¿ç”¨çº¿ç¨‹ä¸­æ–­åŠŸèƒ½è¿›è¡Œä¼˜é›…ç»ˆæ­¢çº¿ç¨‹ã€‚\n\n---\n\n","slug":"å¤šçº¿ç¨‹/Javaå¤šçº¿ç¨‹å¯ä»¥åˆ†ç»„è¿˜èƒ½è¿™æ ·ç©","published":1,"updated":"2025-10-15T07:20:24.996Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076l001rqkd4e7k6bofk","content":"<p>ä½†å¦‚æœçº¿ç¨‹å¾ˆå¤šçš„æƒ…å†µä¸‹ï¼Œä½ çŸ¥é“å¦‚ä½•å¯¹å®ƒä»¬è¿›è¡Œåˆ†ç»„å—ï¼Ÿ</p>\n<p>å’Œ Dubbo çš„æœåŠ¡åˆ†ç»„ä¸€æ ·ï¼ŒJava å¯ä»¥å¯¹ç›¸åŒæ€§è´¨çš„çº¿ç¨‹è¿›è¡Œåˆ†ç»„ã€‚</p>\n<p>æ¥çœ‹ä¸‹çº¿ç¨‹ç±» Thread çš„æ‰€æœ‰æ„é€ æ–¹æ³•ã€‚</p>\n<p><img src=\"http://qianniu.javastack.cn/18-6-3/9061041.jpg\"></p>\n<p>å¦‚å›¾æ‰€ç¤ºï¼Œå¸¦æœ‰ ThreadGroup çš„æ‰€æœ‰çº¿ç¨‹æ„é€ æ–¹æ³•éƒ½å¯ä»¥å®šä¹‰çº¿ç¨‹ç»„çš„ã€‚</p>\n<p>çº¿ç¨‹ç»„ä½¿ç”¨ java.lang.ThreadGroup ç±»å®šä¹‰ï¼Œå®ƒæœ‰ä¸¤ä¸ªæ„é€ æ–¹æ³•ï¼Œç¬¬äºŒä¸ªæ„é€ æ–¹æ³•å…è®¸çº¿ç¨‹ç»„æœ‰çˆ¶ç±»çº¿ç¨‹ç»„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªçº¿ç¨‹ç»„å¯ä»¥å¤šä¸ªå­çº¿ç¨‹ç»„ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">java.lang.ThreadGroup#ThreadGroup(java.lang.String)\njava.lang.ThreadGroup#ThreadGroup(java.lang.ThreadGroup, java.lang.String)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p><img src=\"http://qianniu.javastack.cn/18-6-4/38415499.jpg\"></p>\n<p>çº¿ç¨‹ç»„ä¸­æ¯”è¾ƒæœ‰ç”¨çš„å‡ ä¸ªæ–¹æ³•ã€‚</p>\n<blockquote>\n<p>&#x2F;&#x2F; è·å–å½“å‰çº¿ç¨‹ç»„å†…çš„è¿è¡Œçº¿ç¨‹æ•°<br>java.lang.ThreadGroup#activeCount</p>\n<p>&#x2F;&#x2F; ä¸­æ–­çº¿ç¨‹ç»„å†…çš„æ‰€æœ‰çº¿ç¨‹<br>java.lang.ThreadGroup#interrupt</p>\n<p>&#x2F;&#x2F; ä½¿ç”¨ System.out æ‰“å°å‡ºæ‰€æœ‰çº¿ç¨‹ä¿¡æ¯<br>java.lang.ThreadGroup#list()</p>\n</blockquote>\n<p>æˆ‘ä»¬æ¥ç®€å•ä½¿ç”¨ä¸‹çº¿ç¨‹ç»„å§ï¼</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * \n *&#x2F;\npublic static void main(String[] args) &#123;\n\tRunnable runnable &#x3D; () -&gt; &#123;\n\t\tSystem.out.println(&quot;JavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹ç»„åç§°ï¼š&quot; + Thread.currentThread().getThreadGroup());\n\t\tSystem.out.println(&quot;JavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹åç§°ï¼š&quot; + Thread.currentThread().getName());\n\t\ttry &#123;\n\t\t\tThread.sleep(3000);\n\t\t&#125; catch (InterruptedException e) &#123;\n\t\t\te.printStackTrace();\n\t\t&#125;\n\t&#125;;\n\n\tThreadGroup userGroup &#x3D; new ThreadGroup(&quot;user&quot;);\n    userGroup.setMaxPriority(Thread.MIN_PRIORITY);\n    \n\tThread userTask1 &#x3D; new Thread(userGroup, runnable, &quot;user-task1&quot;);\n\tThread userTask2 &#x3D; new Thread(userGroup, runnable, &quot;user-task2&quot;);\n\n\tuserTask1.start();\n\tuserTask2.start();\n\n\tSystem.out.println(&quot;JavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹ç»„æ´»è·ƒçº¿ç¨‹æ•°ï¼š&quot; + userGroup.activeCount());\n\tuserGroup.list();\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºä»¥ä¸‹ç»“æœã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">JavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹ç»„åç§°ï¼šjava.lang.ThreadGroup[name&#x3D;user,maxpri&#x3D;1]\nJavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹åç§°ï¼šuser-task1\nJavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹ç»„æ´»è·ƒçº¿ç¨‹æ•°ï¼š2\nJavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹ç»„åç§°ï¼šjava.lang.ThreadGroup[name&#x3D;user,maxpri&#x3D;1]\nJavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹åç§°ï¼šuser-task2\njava.lang.ThreadGroup[name&#x3D;user,maxpri&#x3D;1]\n    Thread[user-task1,1,user]\n    Thread[user-task2,1,user]<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ ¹æ®ç¤ºä¾‹ä»£ç å’Œç¨‹åºè¾“å‡ºç»“æœåº”è¯¥å¯¹çº¿ç¨‹ç»„æœ‰äº†ä¸€ä¸ªå¤§æ¦‚çš„äº†è§£å§ã€‚</p>\n<p>çº¿ç¨‹ç»„è¿˜èƒ½ç»Ÿä¸€è®¾ç½®ç»„å†…æ‰€æœ‰çº¿ç¨‹çš„æœ€é«˜ä¼˜å…ˆçº§ï¼Œçº¿ç¨‹å•ç‹¬è®¾ç½®çš„ä¼˜å…ˆçº§ä¸ä¼šé«˜äºçº¿ç¨‹ç»„è®¾ç½®çš„æœ€å¤§ä¼˜å…ˆçº§ã€‚</p>\n<p>å¦å¤–ï¼Œçº¿ç¨‹ç»„ä¸­æœ‰ä¸€ä¸ª stop æ–¹æ³•ç”¨æ¥ç»ˆæ­¢ç»„å†…æ‰€æœ‰çš„çº¿ç¨‹ï¼Œä½†è¿™ä¸ªæ–¹æ³•å’Œ Thread ä¸­çš„ stop æ–¹æ³•ä¸€æ ·ä¼šå¸¦æ¥å¾ˆå¤šé—®é¢˜ï¼Œæ‰€ä»¥å®ƒä»¬ä¸¤ä¸ªç°åœ¨éƒ½å·²ç»è¢«åºŸå¼ƒäº†ï¼Œå®˜æ–¹ä¹Ÿæ˜¯ä¸å»ºè®®ä½¿ç”¨äº†ï¼Œå»ºè®®ä½¿ç”¨çº¿ç¨‹ä¸­æ–­åŠŸèƒ½è¿›è¡Œä¼˜é›…ç»ˆæ­¢çº¿ç¨‹ã€‚</p>\n<hr>\n","excerpt":"","more":"<p>ä½†å¦‚æœçº¿ç¨‹å¾ˆå¤šçš„æƒ…å†µä¸‹ï¼Œä½ çŸ¥é“å¦‚ä½•å¯¹å®ƒä»¬è¿›è¡Œåˆ†ç»„å—ï¼Ÿ</p>\n<p>å’Œ Dubbo çš„æœåŠ¡åˆ†ç»„ä¸€æ ·ï¼ŒJava å¯ä»¥å¯¹ç›¸åŒæ€§è´¨çš„çº¿ç¨‹è¿›è¡Œåˆ†ç»„ã€‚</p>\n<p>æ¥çœ‹ä¸‹çº¿ç¨‹ç±» Thread çš„æ‰€æœ‰æ„é€ æ–¹æ³•ã€‚</p>\n<p><img src=\"http://qianniu.javastack.cn/18-6-3/9061041.jpg\"></p>\n<p>å¦‚å›¾æ‰€ç¤ºï¼Œå¸¦æœ‰ ThreadGroup çš„æ‰€æœ‰çº¿ç¨‹æ„é€ æ–¹æ³•éƒ½å¯ä»¥å®šä¹‰çº¿ç¨‹ç»„çš„ã€‚</p>\n<p>çº¿ç¨‹ç»„ä½¿ç”¨ java.lang.ThreadGroup ç±»å®šä¹‰ï¼Œå®ƒæœ‰ä¸¤ä¸ªæ„é€ æ–¹æ³•ï¼Œç¬¬äºŒä¸ªæ„é€ æ–¹æ³•å…è®¸çº¿ç¨‹ç»„æœ‰çˆ¶ç±»çº¿ç¨‹ç»„ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€ä¸ªçº¿ç¨‹ç»„å¯ä»¥å¤šä¸ªå­çº¿ç¨‹ç»„ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">java.lang.ThreadGroup#ThreadGroup(java.lang.String)\njava.lang.ThreadGroup#ThreadGroup(java.lang.ThreadGroup, java.lang.String)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p><img src=\"http://qianniu.javastack.cn/18-6-4/38415499.jpg\"></p>\n<p>çº¿ç¨‹ç»„ä¸­æ¯”è¾ƒæœ‰ç”¨çš„å‡ ä¸ªæ–¹æ³•ã€‚</p>\n<blockquote>\n<p>&#x2F;&#x2F; è·å–å½“å‰çº¿ç¨‹ç»„å†…çš„è¿è¡Œçº¿ç¨‹æ•°<br>java.lang.ThreadGroup#activeCount</p>\n<p>&#x2F;&#x2F; ä¸­æ–­çº¿ç¨‹ç»„å†…çš„æ‰€æœ‰çº¿ç¨‹<br>java.lang.ThreadGroup#interrupt</p>\n<p>&#x2F;&#x2F; ä½¿ç”¨ System.out æ‰“å°å‡ºæ‰€æœ‰çº¿ç¨‹ä¿¡æ¯<br>java.lang.ThreadGroup#list()</p>\n</blockquote>\n<p>æˆ‘ä»¬æ¥ç®€å•ä½¿ç”¨ä¸‹çº¿ç¨‹ç»„å§ï¼</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * \n *&#x2F;\npublic static void main(String[] args) &#123;\n\tRunnable runnable &#x3D; () -&gt; &#123;\n\t\tSystem.out.println(&quot;JavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹ç»„åç§°ï¼š&quot; + Thread.currentThread().getThreadGroup());\n\t\tSystem.out.println(&quot;JavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹åç§°ï¼š&quot; + Thread.currentThread().getName());\n\t\ttry &#123;\n\t\t\tThread.sleep(3000);\n\t\t&#125; catch (InterruptedException e) &#123;\n\t\t\te.printStackTrace();\n\t\t&#125;\n\t&#125;;\n\n\tThreadGroup userGroup &#x3D; new ThreadGroup(&quot;user&quot;);\n    userGroup.setMaxPriority(Thread.MIN_PRIORITY);\n    \n\tThread userTask1 &#x3D; new Thread(userGroup, runnable, &quot;user-task1&quot;);\n\tThread userTask2 &#x3D; new Thread(userGroup, runnable, &quot;user-task2&quot;);\n\n\tuserTask1.start();\n\tuserTask2.start();\n\n\tSystem.out.println(&quot;JavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹ç»„æ´»è·ƒçº¿ç¨‹æ•°ï¼š&quot; + userGroup.activeCount());\n\tuserGroup.list();\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºä»¥ä¸‹ç»“æœã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">JavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹ç»„åç§°ï¼šjava.lang.ThreadGroup[name&#x3D;user,maxpri&#x3D;1]\nJavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹åç§°ï¼šuser-task1\nJavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹ç»„æ´»è·ƒçº¿ç¨‹æ•°ï¼š2\nJavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹ç»„åç§°ï¼šjava.lang.ThreadGroup[name&#x3D;user,maxpri&#x3D;1]\nJavaæŠ€æœ¯çº¿ç¨‹çº¿ç¨‹åç§°ï¼šuser-task2\njava.lang.ThreadGroup[name&#x3D;user,maxpri&#x3D;1]\n    Thread[user-task1,1,user]\n    Thread[user-task2,1,user]<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ ¹æ®ç¤ºä¾‹ä»£ç å’Œç¨‹åºè¾“å‡ºç»“æœåº”è¯¥å¯¹çº¿ç¨‹ç»„æœ‰äº†ä¸€ä¸ªå¤§æ¦‚çš„äº†è§£å§ã€‚</p>\n<p>çº¿ç¨‹ç»„è¿˜èƒ½ç»Ÿä¸€è®¾ç½®ç»„å†…æ‰€æœ‰çº¿ç¨‹çš„æœ€é«˜ä¼˜å…ˆçº§ï¼Œçº¿ç¨‹å•ç‹¬è®¾ç½®çš„ä¼˜å…ˆçº§ä¸ä¼šé«˜äºçº¿ç¨‹ç»„è®¾ç½®çš„æœ€å¤§ä¼˜å…ˆçº§ã€‚</p>\n<p>å¦å¤–ï¼Œçº¿ç¨‹ç»„ä¸­æœ‰ä¸€ä¸ª stop æ–¹æ³•ç”¨æ¥ç»ˆæ­¢ç»„å†…æ‰€æœ‰çš„çº¿ç¨‹ï¼Œä½†è¿™ä¸ªæ–¹æ³•å’Œ Thread ä¸­çš„ stop æ–¹æ³•ä¸€æ ·ä¼šå¸¦æ¥å¾ˆå¤šé—®é¢˜ï¼Œæ‰€ä»¥å®ƒä»¬ä¸¤ä¸ªç°åœ¨éƒ½å·²ç»è¢«åºŸå¼ƒäº†ï¼Œå®˜æ–¹ä¹Ÿæ˜¯ä¸å»ºè®®ä½¿ç”¨äº†ï¼Œå»ºè®®ä½¿ç”¨çº¿ç¨‹ä¸­æ–­åŠŸèƒ½è¿›è¡Œä¼˜é›…ç»ˆæ­¢çº¿ç¨‹ã€‚</p>\n<hr>\n"},{"title":"Javaè™šæ‹Ÿæœºå¯¹é”ä¼˜åŒ–æ‰€åšçš„åŠªåŠ›","date":"2025-10-14T06:42:34.000Z","_content":"\n![](http://img.javastack.cn/18-6-10/54034705.jpg)\n\nä½œä¸ºä¸€æ¬¾å…¬ç”¨å¹³å°ï¼ŒJDK æœ¬èº«ä¹Ÿä¸ºå¹¶å‘ç¨‹åºçš„æ€§èƒ½ç»å°½è„‘æ±ï¼Œåœ¨ JDK å†…éƒ¨ä¹Ÿæƒ³å°½ä¸€åˆ‡åŠæ³•æä¾›å¹¶å‘æ—¶çš„ç³»ç»Ÿååé‡ã€‚è¿™é‡Œï¼Œæˆ‘å°†å‘å¤§å®¶ç®€å•ä»‹ç»å‡ ç§ JDK å†…éƒ¨çš„ \"é”\" ä¼˜åŒ–ç­–ç•¥ã€‚\n\n### 1ã€ é”åå‘\n\né”åå‘æ˜¯ä¸€ç§é’ˆå¯¹åŠ é”æ“ä½œçš„ä¼˜åŒ–æ‰‹æ®µã€‚\n\nå¦‚æœä¸€ä¸ªçº¿ç¨‹è·å¾—äº†é”ï¼Œé‚£ä¹ˆé”å°±è¿›å…¥åå‘æ¨¡å¼ã€‚å½“è¿™ä¸ªçº¿ç¨‹å†æ¬¡è¯·æ±‚é”æ—¶ï¼Œæ— é¡»å†åšä»»ä½•åŒæ­¥æ“ä½œã€‚è¿™æ ·å°±èŠ‚çœäº†å¤§é‡æœ‰å…³é”ç”³è¯·çš„æ“ä½œï¼Œä»è€Œæé«˜äº†ç¨‹åºæ€§èƒ½ã€‚å› æ­¤ï¼Œå¯¹äºå‡ ä¹æ²¡æœ‰é”ç«äº‰çš„åœºåˆï¼Œåå‘é”æœ‰æ¯”è¾ƒçº¢å•Šçš„ä¼˜åŒ–æ•ˆæœï¼Œå› ä¸ºè¿ç»­å¤šæ¬¡ææœ‰å¯èƒ½æ˜¯åŒä¸€ä¸ªçº¿ç¨‹è¯·æ±‚ç›¸åŒçš„é”ã€‚è€Œå¯¹äºé”ç«äº‰æ¯”è¾ƒæ¿€çƒˆçš„åœºåˆï¼Œå…¶æ•ˆæœä¸ä½³ã€‚å› ä¸ºåœ¨ç«äº‰æ¿€çƒˆçš„åœºåˆï¼Œæœ€æœ‰å¯èƒ½çš„æƒ…å†µæ˜¯æ¯æ¬¡éƒ½æ˜¯ä¸åŒçš„çº¿ç¨‹æ¥è¯·æ±‚ç›¸åŒçš„é”ã€‚\n\n### 2ã€ è½»é‡çº§é”\n\nå¦‚æœåå‘é”å¤±è´¥ï¼Œå³ä¸Šä¸€ä¸ªè¯·æ±‚çš„é”çš„çº¿ç¨‹å’Œè¿™ä¸ªçº¿ç¨‹ä¸æ˜¯åŒä¸€ä¸ªã€‚åå‘é”å¤±è´¥æ„å‘³è€…ä¸èƒ½é¿å…åšåŒæ­¥æ“ä½œã€‚æ­¤æ—¶ï¼Œè™šæ‹Ÿæœºå¹¶ä¸ä¼šç«‹å³æŒ‚èµ·çº¿ç¨‹ã€‚ä»–ä¼šä½¿ç”¨ä¸€ç§æˆä¸ºè½»é‡çº§é”çš„ä¼˜åŒ–æ‰‹æ®µã€‚ è½»é‡çº§é”çš„æ“ä½œä¹Ÿå¾ˆæ–¹ä¾¿ï¼Œå®ƒåªæ˜¯ç®€å•åœ°å°†å¯¹è±¡å¤´éƒ¨ä½œä¸ºæŒ‡é’ˆï¼ŒæŒ‡å‘èš©å°¤é”çš„çº¿ç¨‹å †æ ˆçš„å†…éƒ¨ï¼Œæ¥åˆ¤æ–­ä¸€ä¸ªçº¿ç¨‹æ˜¯å¦æŒæœ‰å¯¹è±¡é”ã€‚ å¦‚æœçº¿ç¨‹è·å¾—è½»é‡çº§é”æˆåŠŸï¼Œåˆ™å¯ä»¥é¡ºåˆ©è¿›å…¥ä¸´ç•ŒåŒºã€‚å¦‚æœè½»é‡çº§é”å¤±è´¥ï¼Œåˆ™è¡¨ç¤ºå…¶ä»–çº¿ç¨‹æŠ¢å…ˆäº‰å¤ºäº†é”ï¼Œé‚£ä¹ˆå½“å‰çº¿ç¨‹çš„é”è¯·æ±‚å°±ä¼šè†¨èƒ€ä¸ºé‡é‡çº§é”ã€‚\n\n### 3ã€ è‡ªé€‰é”\n\né”è†¨èƒ€åï¼Œè™šæ‹Ÿæœºä¸ºäº†é¿å…çº¿ç¨‹çœŸå®åœ°åœ¨æ“ä½œç³»ç»Ÿå±‚é¢æŒ‚èµ·ï¼Œè™šæ‹Ÿæœºè¿˜ä¼šåœ¨åšæœ€åçš„åŠªåŠ›â€“è‡ªé€‰é”ã€‚ç”±äºå½“å‰çº¿ç¨‹æš‚æ—¶æ— æ³•è·å¾—é”ï¼Œä½†æ˜¯ä»€ä¹ˆæ—¶å€™å¯ä»¥è·å¾—é”æ˜¯ä¸€ä¸ªæœªçŸ¥æ•°ã€‚ä¹Ÿè®¸åœ¨CPUå‡ ä¸ªæ—¶é’Ÿå‘¨æœŸåï¼Œå°±å¯ä»¥å¾—åˆ°é”ã€‚å¦‚æœè¿™æ ·ï¼Œç®€å•ç²—æš´çš„æŒ‚èµ·çº¿ç¨‹å¯èƒ½æ˜¯ä¸€ç§å¾—ä¸å¿å¤±çš„æ“ä½œï¼Œå› æ­¤ç³»ç»Ÿä¼šè¿›è¡Œä¸€æ¬¡èµŒæ³¨ï¼šå®ƒä¼šå‡è®¾åœ¨ä¸ä¹…çš„å°†æ¥ï¼Œçº¿ç¨‹å¯ä»¥å¾—åˆ°è¿™æŠŠé”ã€‚å› æ­¤è™šæ‹Ÿæœºè®©å½“å‰çº¿ç¨‹åšä¸ªç©ºå¾ªç¯ï¼Œåœ¨ç»è¿‡è‹¥å¹²æ¬¡å¾ªç¯åï¼Œå¦‚æœå¯ä»¥å¾—åˆ°é”ï¼Œé‚£ä¹ˆå°±é¡ºåˆ©è¿›å…¥ä¸´ç•ŒåŒºã€‚å¦‚æœè¿˜ä¸èƒ½å¾—åˆ°é”ï¼Œæ‰ä¼šçœŸå®åœ°å°†çº¿ç¨‹åœ¨æ“ä½œç³»ç»Ÿå±‚é¢æŒ‚èµ·ã€‚\n\n### 4ã€ é”æ¶ˆé™¤\n\né”æ¶ˆé™¤æ˜¯ä¸€ç§æ›´å½»åº•çš„é”ä¼˜åŒ–ã€‚Javaè™šæ‹Ÿæœºåœ¨JITç¼–è¯‘æ—¶ï¼Œé€šè¿‡å¯¹è¿è¡Œä¸Šä¸‹æ–‡çš„æ‰«æï¼Œå»é™¤ä¸å¯èƒ½å­˜åœ¨å…±äº«èµ„æºç«äº‰çš„é”ã€‚é€šè¿‡é”æ¶ˆé™¤ï¼Œå¯ä»¥èŠ‚çœæ¯«æ— æ„ä¹‰çš„è¯·æ±‚é”æ—¶é—´ã€‚\n\nä¸‹é¢è¿™ç§è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬ä½¿ç”¨vectorï¼Œ è€Œvectorå†…éƒ¨ä½¿ç”¨äº†synchronizeè¯·æ±‚é”ã€‚\n\n\n```\npublic String []  createStrings(){\n    Vector<String>  v= new Vector<String>();\n    for(int i=0;i<100;i++){\n        v.add(Integer.toString(i));\n    }\n    return v.toArray(new String[]{});\n}\n```\n\nç”±äºVåªåœ¨å‡½æ•° createStrnigs ä¸­ä½¿ç”¨ï¼Œå› æ­¤å®ƒåªæ˜¯ä¸€ä¸ªå•çº¯çš„å±€éƒ¨å˜é‡ã€‚å±€éƒ¨å˜é‡æ˜¯åœ¨çº¿ç¨‹æ ˆä¸Šåˆ†é…çš„ï¼Œå±äºçº¿ç¨‹ç§æœ‰é¢æ•°æ®ï¼Œå› æ­¤ä¸å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹è®¿é—®ã€‚æ‰€ä»¥ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒVectorå†…éƒ¨æ‰€æœ‰åŠ é”åŒæ­¥éƒ½æ˜¯æ²¡æœ‰å¿…è¦çš„ã€‚å¦‚æœè™šæ‹Ÿæœºæ£€æµ‹åˆ°è¿™ç§æƒ…å†µï¼Œå°±ä¼šå°†è¿™äº›æ— ç”¨çš„é”æ“ä½œå»é™¤ã€‚\n\né”æ¶ˆé™¤æ¶‰åŠçš„ä¸€é¡¹å…³é”®æŠ€æœ¯ä¸ºé€ƒé€¸åˆ†æã€‚æ‰€è°“é€ƒé€¸åˆ†æå°±æ˜¯è§‚å¯ŸæŸä¸€ä¸ªå˜é‡æ˜¯å¦ä¼šé€ƒå‡ºæŸä¸€ä¸ªä½œç”¨åŸŸã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œå˜é‡væ˜¾ç„¶æ²¡æœ‰é€ƒå‡ºcreateString å‡½æ•°ä¹‹å¤–ã€‚ä»¥æ­¤ä¸ºåŸºç¡€ï¼Œè™šæ‹Ÿæœºæ‰å¯ä»¥å¤§èƒ†çš„å°†vå†…éƒ¨çš„åŠ é”æ“ä½œå»é™¤ã€‚å¦‚æœcreateStrings è¿”å›çš„ä¸æ˜¯Stringæ•°ç»„ï¼Œè€Œæ˜¯væœ¬èº«ï¼Œé‚£ä¹ˆå°±è®¤ä¸ºå˜é‡vé€ƒé€¸å‡ºäº†å½“å‰å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´væœ‰å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹è®¿é—®ã€‚å¦‚æ˜¯è¿™æ ·ï¼Œè™šæ‹Ÿæœºå°±ä¸èƒ½æ¶ˆé™¤vä¸­çš„é”æ“ä½œã€‚\n\né€ƒé€¸åˆ†æå¿…é¡»åœ¨ -server æ¨¡å¼ä¸‹è¿›è¡Œï¼Œå¯ä»¥ä½¿ç”¨ -XX:DoEscapeAnalysis å‚æ•°æ‰“å¼€é€ƒé€¸åˆ†æï¼Œä½¿ç”¨ -XX:+EliminateLocks å‚æ•°å¯ä»¥æ‰“å¼€é”æ¶ˆé™¤ã€‚\n\næœ¬æ–‡æ‘˜è‡ªã€ŠJavaé«˜å¹¶å‘ç¨‹åºè®¾è®¡ã€‹ä¸€ä¹¦ã€‚\n\n","source":"_posts/å¤šçº¿ç¨‹/Javaè™šæ‹Ÿæœºå¯¹é”ä¼˜åŒ–æ‰€åšçš„åŠªåŠ›.md","raw":"---\ntitle: Javaè™šæ‹Ÿæœºå¯¹é”ä¼˜åŒ–æ‰€åšçš„åŠªåŠ›\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: å¤šçº¿ç¨‹\n---\n\n![](http://img.javastack.cn/18-6-10/54034705.jpg)\n\nä½œä¸ºä¸€æ¬¾å…¬ç”¨å¹³å°ï¼ŒJDK æœ¬èº«ä¹Ÿä¸ºå¹¶å‘ç¨‹åºçš„æ€§èƒ½ç»å°½è„‘æ±ï¼Œåœ¨ JDK å†…éƒ¨ä¹Ÿæƒ³å°½ä¸€åˆ‡åŠæ³•æä¾›å¹¶å‘æ—¶çš„ç³»ç»Ÿååé‡ã€‚è¿™é‡Œï¼Œæˆ‘å°†å‘å¤§å®¶ç®€å•ä»‹ç»å‡ ç§ JDK å†…éƒ¨çš„ \"é”\" ä¼˜åŒ–ç­–ç•¥ã€‚\n\n### 1ã€ é”åå‘\n\né”åå‘æ˜¯ä¸€ç§é’ˆå¯¹åŠ é”æ“ä½œçš„ä¼˜åŒ–æ‰‹æ®µã€‚\n\nå¦‚æœä¸€ä¸ªçº¿ç¨‹è·å¾—äº†é”ï¼Œé‚£ä¹ˆé”å°±è¿›å…¥åå‘æ¨¡å¼ã€‚å½“è¿™ä¸ªçº¿ç¨‹å†æ¬¡è¯·æ±‚é”æ—¶ï¼Œæ— é¡»å†åšä»»ä½•åŒæ­¥æ“ä½œã€‚è¿™æ ·å°±èŠ‚çœäº†å¤§é‡æœ‰å…³é”ç”³è¯·çš„æ“ä½œï¼Œä»è€Œæé«˜äº†ç¨‹åºæ€§èƒ½ã€‚å› æ­¤ï¼Œå¯¹äºå‡ ä¹æ²¡æœ‰é”ç«äº‰çš„åœºåˆï¼Œåå‘é”æœ‰æ¯”è¾ƒçº¢å•Šçš„ä¼˜åŒ–æ•ˆæœï¼Œå› ä¸ºè¿ç»­å¤šæ¬¡ææœ‰å¯èƒ½æ˜¯åŒä¸€ä¸ªçº¿ç¨‹è¯·æ±‚ç›¸åŒçš„é”ã€‚è€Œå¯¹äºé”ç«äº‰æ¯”è¾ƒæ¿€çƒˆçš„åœºåˆï¼Œå…¶æ•ˆæœä¸ä½³ã€‚å› ä¸ºåœ¨ç«äº‰æ¿€çƒˆçš„åœºåˆï¼Œæœ€æœ‰å¯èƒ½çš„æƒ…å†µæ˜¯æ¯æ¬¡éƒ½æ˜¯ä¸åŒçš„çº¿ç¨‹æ¥è¯·æ±‚ç›¸åŒçš„é”ã€‚\n\n### 2ã€ è½»é‡çº§é”\n\nå¦‚æœåå‘é”å¤±è´¥ï¼Œå³ä¸Šä¸€ä¸ªè¯·æ±‚çš„é”çš„çº¿ç¨‹å’Œè¿™ä¸ªçº¿ç¨‹ä¸æ˜¯åŒä¸€ä¸ªã€‚åå‘é”å¤±è´¥æ„å‘³è€…ä¸èƒ½é¿å…åšåŒæ­¥æ“ä½œã€‚æ­¤æ—¶ï¼Œè™šæ‹Ÿæœºå¹¶ä¸ä¼šç«‹å³æŒ‚èµ·çº¿ç¨‹ã€‚ä»–ä¼šä½¿ç”¨ä¸€ç§æˆä¸ºè½»é‡çº§é”çš„ä¼˜åŒ–æ‰‹æ®µã€‚ è½»é‡çº§é”çš„æ“ä½œä¹Ÿå¾ˆæ–¹ä¾¿ï¼Œå®ƒåªæ˜¯ç®€å•åœ°å°†å¯¹è±¡å¤´éƒ¨ä½œä¸ºæŒ‡é’ˆï¼ŒæŒ‡å‘èš©å°¤é”çš„çº¿ç¨‹å †æ ˆçš„å†…éƒ¨ï¼Œæ¥åˆ¤æ–­ä¸€ä¸ªçº¿ç¨‹æ˜¯å¦æŒæœ‰å¯¹è±¡é”ã€‚ å¦‚æœçº¿ç¨‹è·å¾—è½»é‡çº§é”æˆåŠŸï¼Œåˆ™å¯ä»¥é¡ºåˆ©è¿›å…¥ä¸´ç•ŒåŒºã€‚å¦‚æœè½»é‡çº§é”å¤±è´¥ï¼Œåˆ™è¡¨ç¤ºå…¶ä»–çº¿ç¨‹æŠ¢å…ˆäº‰å¤ºäº†é”ï¼Œé‚£ä¹ˆå½“å‰çº¿ç¨‹çš„é”è¯·æ±‚å°±ä¼šè†¨èƒ€ä¸ºé‡é‡çº§é”ã€‚\n\n### 3ã€ è‡ªé€‰é”\n\né”è†¨èƒ€åï¼Œè™šæ‹Ÿæœºä¸ºäº†é¿å…çº¿ç¨‹çœŸå®åœ°åœ¨æ“ä½œç³»ç»Ÿå±‚é¢æŒ‚èµ·ï¼Œè™šæ‹Ÿæœºè¿˜ä¼šåœ¨åšæœ€åçš„åŠªåŠ›â€“è‡ªé€‰é”ã€‚ç”±äºå½“å‰çº¿ç¨‹æš‚æ—¶æ— æ³•è·å¾—é”ï¼Œä½†æ˜¯ä»€ä¹ˆæ—¶å€™å¯ä»¥è·å¾—é”æ˜¯ä¸€ä¸ªæœªçŸ¥æ•°ã€‚ä¹Ÿè®¸åœ¨CPUå‡ ä¸ªæ—¶é’Ÿå‘¨æœŸåï¼Œå°±å¯ä»¥å¾—åˆ°é”ã€‚å¦‚æœè¿™æ ·ï¼Œç®€å•ç²—æš´çš„æŒ‚èµ·çº¿ç¨‹å¯èƒ½æ˜¯ä¸€ç§å¾—ä¸å¿å¤±çš„æ“ä½œï¼Œå› æ­¤ç³»ç»Ÿä¼šè¿›è¡Œä¸€æ¬¡èµŒæ³¨ï¼šå®ƒä¼šå‡è®¾åœ¨ä¸ä¹…çš„å°†æ¥ï¼Œçº¿ç¨‹å¯ä»¥å¾—åˆ°è¿™æŠŠé”ã€‚å› æ­¤è™šæ‹Ÿæœºè®©å½“å‰çº¿ç¨‹åšä¸ªç©ºå¾ªç¯ï¼Œåœ¨ç»è¿‡è‹¥å¹²æ¬¡å¾ªç¯åï¼Œå¦‚æœå¯ä»¥å¾—åˆ°é”ï¼Œé‚£ä¹ˆå°±é¡ºåˆ©è¿›å…¥ä¸´ç•ŒåŒºã€‚å¦‚æœè¿˜ä¸èƒ½å¾—åˆ°é”ï¼Œæ‰ä¼šçœŸå®åœ°å°†çº¿ç¨‹åœ¨æ“ä½œç³»ç»Ÿå±‚é¢æŒ‚èµ·ã€‚\n\n### 4ã€ é”æ¶ˆé™¤\n\né”æ¶ˆé™¤æ˜¯ä¸€ç§æ›´å½»åº•çš„é”ä¼˜åŒ–ã€‚Javaè™šæ‹Ÿæœºåœ¨JITç¼–è¯‘æ—¶ï¼Œé€šè¿‡å¯¹è¿è¡Œä¸Šä¸‹æ–‡çš„æ‰«æï¼Œå»é™¤ä¸å¯èƒ½å­˜åœ¨å…±äº«èµ„æºç«äº‰çš„é”ã€‚é€šè¿‡é”æ¶ˆé™¤ï¼Œå¯ä»¥èŠ‚çœæ¯«æ— æ„ä¹‰çš„è¯·æ±‚é”æ—¶é—´ã€‚\n\nä¸‹é¢è¿™ç§è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬ä½¿ç”¨vectorï¼Œ è€Œvectorå†…éƒ¨ä½¿ç”¨äº†synchronizeè¯·æ±‚é”ã€‚\n\n\n```\npublic String []  createStrings(){\n    Vector<String>  v= new Vector<String>();\n    for(int i=0;i<100;i++){\n        v.add(Integer.toString(i));\n    }\n    return v.toArray(new String[]{});\n}\n```\n\nç”±äºVåªåœ¨å‡½æ•° createStrnigs ä¸­ä½¿ç”¨ï¼Œå› æ­¤å®ƒåªæ˜¯ä¸€ä¸ªå•çº¯çš„å±€éƒ¨å˜é‡ã€‚å±€éƒ¨å˜é‡æ˜¯åœ¨çº¿ç¨‹æ ˆä¸Šåˆ†é…çš„ï¼Œå±äºçº¿ç¨‹ç§æœ‰é¢æ•°æ®ï¼Œå› æ­¤ä¸å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹è®¿é—®ã€‚æ‰€ä»¥ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒVectorå†…éƒ¨æ‰€æœ‰åŠ é”åŒæ­¥éƒ½æ˜¯æ²¡æœ‰å¿…è¦çš„ã€‚å¦‚æœè™šæ‹Ÿæœºæ£€æµ‹åˆ°è¿™ç§æƒ…å†µï¼Œå°±ä¼šå°†è¿™äº›æ— ç”¨çš„é”æ“ä½œå»é™¤ã€‚\n\né”æ¶ˆé™¤æ¶‰åŠçš„ä¸€é¡¹å…³é”®æŠ€æœ¯ä¸ºé€ƒé€¸åˆ†æã€‚æ‰€è°“é€ƒé€¸åˆ†æå°±æ˜¯è§‚å¯ŸæŸä¸€ä¸ªå˜é‡æ˜¯å¦ä¼šé€ƒå‡ºæŸä¸€ä¸ªä½œç”¨åŸŸã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œå˜é‡væ˜¾ç„¶æ²¡æœ‰é€ƒå‡ºcreateString å‡½æ•°ä¹‹å¤–ã€‚ä»¥æ­¤ä¸ºåŸºç¡€ï¼Œè™šæ‹Ÿæœºæ‰å¯ä»¥å¤§èƒ†çš„å°†vå†…éƒ¨çš„åŠ é”æ“ä½œå»é™¤ã€‚å¦‚æœcreateStrings è¿”å›çš„ä¸æ˜¯Stringæ•°ç»„ï¼Œè€Œæ˜¯væœ¬èº«ï¼Œé‚£ä¹ˆå°±è®¤ä¸ºå˜é‡vé€ƒé€¸å‡ºäº†å½“å‰å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´væœ‰å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹è®¿é—®ã€‚å¦‚æ˜¯è¿™æ ·ï¼Œè™šæ‹Ÿæœºå°±ä¸èƒ½æ¶ˆé™¤vä¸­çš„é”æ“ä½œã€‚\n\né€ƒé€¸åˆ†æå¿…é¡»åœ¨ -server æ¨¡å¼ä¸‹è¿›è¡Œï¼Œå¯ä»¥ä½¿ç”¨ -XX:DoEscapeAnalysis å‚æ•°æ‰“å¼€é€ƒé€¸åˆ†æï¼Œä½¿ç”¨ -XX:+EliminateLocks å‚æ•°å¯ä»¥æ‰“å¼€é”æ¶ˆé™¤ã€‚\n\næœ¬æ–‡æ‘˜è‡ªã€ŠJavaé«˜å¹¶å‘ç¨‹åºè®¾è®¡ã€‹ä¸€ä¹¦ã€‚\n\n","slug":"å¤šçº¿ç¨‹/Javaè™šæ‹Ÿæœºå¯¹é”ä¼˜åŒ–æ‰€åšçš„åŠªåŠ›","published":1,"updated":"2025-10-15T07:20:25.052Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076l001vqkd4706abfkz","content":"<p><img src=\"http://img.javastack.cn/18-6-10/54034705.jpg\"></p>\n<p>ä½œä¸ºä¸€æ¬¾å…¬ç”¨å¹³å°ï¼ŒJDK æœ¬èº«ä¹Ÿä¸ºå¹¶å‘ç¨‹åºçš„æ€§èƒ½ç»å°½è„‘æ±ï¼Œåœ¨ JDK å†…éƒ¨ä¹Ÿæƒ³å°½ä¸€åˆ‡åŠæ³•æä¾›å¹¶å‘æ—¶çš„ç³»ç»Ÿååé‡ã€‚è¿™é‡Œï¼Œæˆ‘å°†å‘å¤§å®¶ç®€å•ä»‹ç»å‡ ç§ JDK å†…éƒ¨çš„ â€œé”â€ ä¼˜åŒ–ç­–ç•¥ã€‚</p>\n<h3 id=\"1ã€-é”åå‘\"><a href=\"#1ã€-é”åå‘\" class=\"headerlink\" title=\"1ã€ é”åå‘\"></a>1ã€ é”åå‘</h3><p>é”åå‘æ˜¯ä¸€ç§é’ˆå¯¹åŠ é”æ“ä½œçš„ä¼˜åŒ–æ‰‹æ®µã€‚</p>\n<p>å¦‚æœä¸€ä¸ªçº¿ç¨‹è·å¾—äº†é”ï¼Œé‚£ä¹ˆé”å°±è¿›å…¥åå‘æ¨¡å¼ã€‚å½“è¿™ä¸ªçº¿ç¨‹å†æ¬¡è¯·æ±‚é”æ—¶ï¼Œæ— é¡»å†åšä»»ä½•åŒæ­¥æ“ä½œã€‚è¿™æ ·å°±èŠ‚çœäº†å¤§é‡æœ‰å…³é”ç”³è¯·çš„æ“ä½œï¼Œä»è€Œæé«˜äº†ç¨‹åºæ€§èƒ½ã€‚å› æ­¤ï¼Œå¯¹äºå‡ ä¹æ²¡æœ‰é”ç«äº‰çš„åœºåˆï¼Œåå‘é”æœ‰æ¯”è¾ƒçº¢å•Šçš„ä¼˜åŒ–æ•ˆæœï¼Œå› ä¸ºè¿ç»­å¤šæ¬¡ææœ‰å¯èƒ½æ˜¯åŒä¸€ä¸ªçº¿ç¨‹è¯·æ±‚ç›¸åŒçš„é”ã€‚è€Œå¯¹äºé”ç«äº‰æ¯”è¾ƒæ¿€çƒˆçš„åœºåˆï¼Œå…¶æ•ˆæœä¸ä½³ã€‚å› ä¸ºåœ¨ç«äº‰æ¿€çƒˆçš„åœºåˆï¼Œæœ€æœ‰å¯èƒ½çš„æƒ…å†µæ˜¯æ¯æ¬¡éƒ½æ˜¯ä¸åŒçš„çº¿ç¨‹æ¥è¯·æ±‚ç›¸åŒçš„é”ã€‚</p>\n<h3 id=\"2ã€-è½»é‡çº§é”\"><a href=\"#2ã€-è½»é‡çº§é”\" class=\"headerlink\" title=\"2ã€ è½»é‡çº§é”\"></a>2ã€ è½»é‡çº§é”</h3><p>å¦‚æœåå‘é”å¤±è´¥ï¼Œå³ä¸Šä¸€ä¸ªè¯·æ±‚çš„é”çš„çº¿ç¨‹å’Œè¿™ä¸ªçº¿ç¨‹ä¸æ˜¯åŒä¸€ä¸ªã€‚åå‘é”å¤±è´¥æ„å‘³è€…ä¸èƒ½é¿å…åšåŒæ­¥æ“ä½œã€‚æ­¤æ—¶ï¼Œè™šæ‹Ÿæœºå¹¶ä¸ä¼šç«‹å³æŒ‚èµ·çº¿ç¨‹ã€‚ä»–ä¼šä½¿ç”¨ä¸€ç§æˆä¸ºè½»é‡çº§é”çš„ä¼˜åŒ–æ‰‹æ®µã€‚ è½»é‡çº§é”çš„æ“ä½œä¹Ÿå¾ˆæ–¹ä¾¿ï¼Œå®ƒåªæ˜¯ç®€å•åœ°å°†å¯¹è±¡å¤´éƒ¨ä½œä¸ºæŒ‡é’ˆï¼ŒæŒ‡å‘èš©å°¤é”çš„çº¿ç¨‹å †æ ˆçš„å†…éƒ¨ï¼Œæ¥åˆ¤æ–­ä¸€ä¸ªçº¿ç¨‹æ˜¯å¦æŒæœ‰å¯¹è±¡é”ã€‚ å¦‚æœçº¿ç¨‹è·å¾—è½»é‡çº§é”æˆåŠŸï¼Œåˆ™å¯ä»¥é¡ºåˆ©è¿›å…¥ä¸´ç•ŒåŒºã€‚å¦‚æœè½»é‡çº§é”å¤±è´¥ï¼Œåˆ™è¡¨ç¤ºå…¶ä»–çº¿ç¨‹æŠ¢å…ˆäº‰å¤ºäº†é”ï¼Œé‚£ä¹ˆå½“å‰çº¿ç¨‹çš„é”è¯·æ±‚å°±ä¼šè†¨èƒ€ä¸ºé‡é‡çº§é”ã€‚</p>\n<h3 id=\"3ã€-è‡ªé€‰é”\"><a href=\"#3ã€-è‡ªé€‰é”\" class=\"headerlink\" title=\"3ã€ è‡ªé€‰é”\"></a>3ã€ è‡ªé€‰é”</h3><p>é”è†¨èƒ€åï¼Œè™šæ‹Ÿæœºä¸ºäº†é¿å…çº¿ç¨‹çœŸå®åœ°åœ¨æ“ä½œç³»ç»Ÿå±‚é¢æŒ‚èµ·ï¼Œè™šæ‹Ÿæœºè¿˜ä¼šåœ¨åšæœ€åçš„åŠªåŠ›â€“è‡ªé€‰é”ã€‚ç”±äºå½“å‰çº¿ç¨‹æš‚æ—¶æ— æ³•è·å¾—é”ï¼Œä½†æ˜¯ä»€ä¹ˆæ—¶å€™å¯ä»¥è·å¾—é”æ˜¯ä¸€ä¸ªæœªçŸ¥æ•°ã€‚ä¹Ÿè®¸åœ¨CPUå‡ ä¸ªæ—¶é’Ÿå‘¨æœŸåï¼Œå°±å¯ä»¥å¾—åˆ°é”ã€‚å¦‚æœè¿™æ ·ï¼Œç®€å•ç²—æš´çš„æŒ‚èµ·çº¿ç¨‹å¯èƒ½æ˜¯ä¸€ç§å¾—ä¸å¿å¤±çš„æ“ä½œï¼Œå› æ­¤ç³»ç»Ÿä¼šè¿›è¡Œä¸€æ¬¡èµŒæ³¨ï¼šå®ƒä¼šå‡è®¾åœ¨ä¸ä¹…çš„å°†æ¥ï¼Œçº¿ç¨‹å¯ä»¥å¾—åˆ°è¿™æŠŠé”ã€‚å› æ­¤è™šæ‹Ÿæœºè®©å½“å‰çº¿ç¨‹åšä¸ªç©ºå¾ªç¯ï¼Œåœ¨ç»è¿‡è‹¥å¹²æ¬¡å¾ªç¯åï¼Œå¦‚æœå¯ä»¥å¾—åˆ°é”ï¼Œé‚£ä¹ˆå°±é¡ºåˆ©è¿›å…¥ä¸´ç•ŒåŒºã€‚å¦‚æœè¿˜ä¸èƒ½å¾—åˆ°é”ï¼Œæ‰ä¼šçœŸå®åœ°å°†çº¿ç¨‹åœ¨æ“ä½œç³»ç»Ÿå±‚é¢æŒ‚èµ·ã€‚</p>\n<h3 id=\"4ã€-é”æ¶ˆé™¤\"><a href=\"#4ã€-é”æ¶ˆé™¤\" class=\"headerlink\" title=\"4ã€ é”æ¶ˆé™¤\"></a>4ã€ é”æ¶ˆé™¤</h3><p>é”æ¶ˆé™¤æ˜¯ä¸€ç§æ›´å½»åº•çš„é”ä¼˜åŒ–ã€‚Javaè™šæ‹Ÿæœºåœ¨JITç¼–è¯‘æ—¶ï¼Œé€šè¿‡å¯¹è¿è¡Œä¸Šä¸‹æ–‡çš„æ‰«æï¼Œå»é™¤ä¸å¯èƒ½å­˜åœ¨å…±äº«èµ„æºç«äº‰çš„é”ã€‚é€šè¿‡é”æ¶ˆé™¤ï¼Œå¯ä»¥èŠ‚çœæ¯«æ— æ„ä¹‰çš„è¯·æ±‚é”æ—¶é—´ã€‚</p>\n<p>ä¸‹é¢è¿™ç§è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬ä½¿ç”¨vectorï¼Œ è€Œvectorå†…éƒ¨ä½¿ç”¨äº†synchronizeè¯·æ±‚é”ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public String []  createStrings()&#123;\n    Vector&lt;String&gt;  v&#x3D; new Vector&lt;String&gt;();\n    for(int i&#x3D;0;i&lt;100;i++)&#123;\n        v.add(Integer.toString(i));\n    &#125;\n    return v.toArray(new String[]&#123;&#125;);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç”±äºVåªåœ¨å‡½æ•° createStrnigs ä¸­ä½¿ç”¨ï¼Œå› æ­¤å®ƒåªæ˜¯ä¸€ä¸ªå•çº¯çš„å±€éƒ¨å˜é‡ã€‚å±€éƒ¨å˜é‡æ˜¯åœ¨çº¿ç¨‹æ ˆä¸Šåˆ†é…çš„ï¼Œå±äºçº¿ç¨‹ç§æœ‰é¢æ•°æ®ï¼Œå› æ­¤ä¸å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹è®¿é—®ã€‚æ‰€ä»¥ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒVectorå†…éƒ¨æ‰€æœ‰åŠ é”åŒæ­¥éƒ½æ˜¯æ²¡æœ‰å¿…è¦çš„ã€‚å¦‚æœè™šæ‹Ÿæœºæ£€æµ‹åˆ°è¿™ç§æƒ…å†µï¼Œå°±ä¼šå°†è¿™äº›æ— ç”¨çš„é”æ“ä½œå»é™¤ã€‚</p>\n<p>é”æ¶ˆé™¤æ¶‰åŠçš„ä¸€é¡¹å…³é”®æŠ€æœ¯ä¸ºé€ƒé€¸åˆ†æã€‚æ‰€è°“é€ƒé€¸åˆ†æå°±æ˜¯è§‚å¯ŸæŸä¸€ä¸ªå˜é‡æ˜¯å¦ä¼šé€ƒå‡ºæŸä¸€ä¸ªä½œç”¨åŸŸã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œå˜é‡væ˜¾ç„¶æ²¡æœ‰é€ƒå‡ºcreateString å‡½æ•°ä¹‹å¤–ã€‚ä»¥æ­¤ä¸ºåŸºç¡€ï¼Œè™šæ‹Ÿæœºæ‰å¯ä»¥å¤§èƒ†çš„å°†vå†…éƒ¨çš„åŠ é”æ“ä½œå»é™¤ã€‚å¦‚æœcreateStrings è¿”å›çš„ä¸æ˜¯Stringæ•°ç»„ï¼Œè€Œæ˜¯væœ¬èº«ï¼Œé‚£ä¹ˆå°±è®¤ä¸ºå˜é‡vé€ƒé€¸å‡ºäº†å½“å‰å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´væœ‰å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹è®¿é—®ã€‚å¦‚æ˜¯è¿™æ ·ï¼Œè™šæ‹Ÿæœºå°±ä¸èƒ½æ¶ˆé™¤vä¸­çš„é”æ“ä½œã€‚</p>\n<p>é€ƒé€¸åˆ†æå¿…é¡»åœ¨ -server æ¨¡å¼ä¸‹è¿›è¡Œï¼Œå¯ä»¥ä½¿ç”¨ -XX:DoEscapeAnalysis å‚æ•°æ‰“å¼€é€ƒé€¸åˆ†æï¼Œä½¿ç”¨ -XX:+EliminateLocks å‚æ•°å¯ä»¥æ‰“å¼€é”æ¶ˆé™¤ã€‚</p>\n<p>æœ¬æ–‡æ‘˜è‡ªã€ŠJavaé«˜å¹¶å‘ç¨‹åºè®¾è®¡ã€‹ä¸€ä¹¦ã€‚</p>\n","excerpt":"","more":"<p><img src=\"http://img.javastack.cn/18-6-10/54034705.jpg\"></p>\n<p>ä½œä¸ºä¸€æ¬¾å…¬ç”¨å¹³å°ï¼ŒJDK æœ¬èº«ä¹Ÿä¸ºå¹¶å‘ç¨‹åºçš„æ€§èƒ½ç»å°½è„‘æ±ï¼Œåœ¨ JDK å†…éƒ¨ä¹Ÿæƒ³å°½ä¸€åˆ‡åŠæ³•æä¾›å¹¶å‘æ—¶çš„ç³»ç»Ÿååé‡ã€‚è¿™é‡Œï¼Œæˆ‘å°†å‘å¤§å®¶ç®€å•ä»‹ç»å‡ ç§ JDK å†…éƒ¨çš„ â€œé”â€ ä¼˜åŒ–ç­–ç•¥ã€‚</p>\n<h3 id=\"1ã€-é”åå‘\"><a href=\"#1ã€-é”åå‘\" class=\"headerlink\" title=\"1ã€ é”åå‘\"></a>1ã€ é”åå‘</h3><p>é”åå‘æ˜¯ä¸€ç§é’ˆå¯¹åŠ é”æ“ä½œçš„ä¼˜åŒ–æ‰‹æ®µã€‚</p>\n<p>å¦‚æœä¸€ä¸ªçº¿ç¨‹è·å¾—äº†é”ï¼Œé‚£ä¹ˆé”å°±è¿›å…¥åå‘æ¨¡å¼ã€‚å½“è¿™ä¸ªçº¿ç¨‹å†æ¬¡è¯·æ±‚é”æ—¶ï¼Œæ— é¡»å†åšä»»ä½•åŒæ­¥æ“ä½œã€‚è¿™æ ·å°±èŠ‚çœäº†å¤§é‡æœ‰å…³é”ç”³è¯·çš„æ“ä½œï¼Œä»è€Œæé«˜äº†ç¨‹åºæ€§èƒ½ã€‚å› æ­¤ï¼Œå¯¹äºå‡ ä¹æ²¡æœ‰é”ç«äº‰çš„åœºåˆï¼Œåå‘é”æœ‰æ¯”è¾ƒçº¢å•Šçš„ä¼˜åŒ–æ•ˆæœï¼Œå› ä¸ºè¿ç»­å¤šæ¬¡ææœ‰å¯èƒ½æ˜¯åŒä¸€ä¸ªçº¿ç¨‹è¯·æ±‚ç›¸åŒçš„é”ã€‚è€Œå¯¹äºé”ç«äº‰æ¯”è¾ƒæ¿€çƒˆçš„åœºåˆï¼Œå…¶æ•ˆæœä¸ä½³ã€‚å› ä¸ºåœ¨ç«äº‰æ¿€çƒˆçš„åœºåˆï¼Œæœ€æœ‰å¯èƒ½çš„æƒ…å†µæ˜¯æ¯æ¬¡éƒ½æ˜¯ä¸åŒçš„çº¿ç¨‹æ¥è¯·æ±‚ç›¸åŒçš„é”ã€‚</p>\n<h3 id=\"2ã€-è½»é‡çº§é”\"><a href=\"#2ã€-è½»é‡çº§é”\" class=\"headerlink\" title=\"2ã€ è½»é‡çº§é”\"></a>2ã€ è½»é‡çº§é”</h3><p>å¦‚æœåå‘é”å¤±è´¥ï¼Œå³ä¸Šä¸€ä¸ªè¯·æ±‚çš„é”çš„çº¿ç¨‹å’Œè¿™ä¸ªçº¿ç¨‹ä¸æ˜¯åŒä¸€ä¸ªã€‚åå‘é”å¤±è´¥æ„å‘³è€…ä¸èƒ½é¿å…åšåŒæ­¥æ“ä½œã€‚æ­¤æ—¶ï¼Œè™šæ‹Ÿæœºå¹¶ä¸ä¼šç«‹å³æŒ‚èµ·çº¿ç¨‹ã€‚ä»–ä¼šä½¿ç”¨ä¸€ç§æˆä¸ºè½»é‡çº§é”çš„ä¼˜åŒ–æ‰‹æ®µã€‚ è½»é‡çº§é”çš„æ“ä½œä¹Ÿå¾ˆæ–¹ä¾¿ï¼Œå®ƒåªæ˜¯ç®€å•åœ°å°†å¯¹è±¡å¤´éƒ¨ä½œä¸ºæŒ‡é’ˆï¼ŒæŒ‡å‘èš©å°¤é”çš„çº¿ç¨‹å †æ ˆçš„å†…éƒ¨ï¼Œæ¥åˆ¤æ–­ä¸€ä¸ªçº¿ç¨‹æ˜¯å¦æŒæœ‰å¯¹è±¡é”ã€‚ å¦‚æœçº¿ç¨‹è·å¾—è½»é‡çº§é”æˆåŠŸï¼Œåˆ™å¯ä»¥é¡ºåˆ©è¿›å…¥ä¸´ç•ŒåŒºã€‚å¦‚æœè½»é‡çº§é”å¤±è´¥ï¼Œåˆ™è¡¨ç¤ºå…¶ä»–çº¿ç¨‹æŠ¢å…ˆäº‰å¤ºäº†é”ï¼Œé‚£ä¹ˆå½“å‰çº¿ç¨‹çš„é”è¯·æ±‚å°±ä¼šè†¨èƒ€ä¸ºé‡é‡çº§é”ã€‚</p>\n<h3 id=\"3ã€-è‡ªé€‰é”\"><a href=\"#3ã€-è‡ªé€‰é”\" class=\"headerlink\" title=\"3ã€ è‡ªé€‰é”\"></a>3ã€ è‡ªé€‰é”</h3><p>é”è†¨èƒ€åï¼Œè™šæ‹Ÿæœºä¸ºäº†é¿å…çº¿ç¨‹çœŸå®åœ°åœ¨æ“ä½œç³»ç»Ÿå±‚é¢æŒ‚èµ·ï¼Œè™šæ‹Ÿæœºè¿˜ä¼šåœ¨åšæœ€åçš„åŠªåŠ›â€“è‡ªé€‰é”ã€‚ç”±äºå½“å‰çº¿ç¨‹æš‚æ—¶æ— æ³•è·å¾—é”ï¼Œä½†æ˜¯ä»€ä¹ˆæ—¶å€™å¯ä»¥è·å¾—é”æ˜¯ä¸€ä¸ªæœªçŸ¥æ•°ã€‚ä¹Ÿè®¸åœ¨CPUå‡ ä¸ªæ—¶é’Ÿå‘¨æœŸåï¼Œå°±å¯ä»¥å¾—åˆ°é”ã€‚å¦‚æœè¿™æ ·ï¼Œç®€å•ç²—æš´çš„æŒ‚èµ·çº¿ç¨‹å¯èƒ½æ˜¯ä¸€ç§å¾—ä¸å¿å¤±çš„æ“ä½œï¼Œå› æ­¤ç³»ç»Ÿä¼šè¿›è¡Œä¸€æ¬¡èµŒæ³¨ï¼šå®ƒä¼šå‡è®¾åœ¨ä¸ä¹…çš„å°†æ¥ï¼Œçº¿ç¨‹å¯ä»¥å¾—åˆ°è¿™æŠŠé”ã€‚å› æ­¤è™šæ‹Ÿæœºè®©å½“å‰çº¿ç¨‹åšä¸ªç©ºå¾ªç¯ï¼Œåœ¨ç»è¿‡è‹¥å¹²æ¬¡å¾ªç¯åï¼Œå¦‚æœå¯ä»¥å¾—åˆ°é”ï¼Œé‚£ä¹ˆå°±é¡ºåˆ©è¿›å…¥ä¸´ç•ŒåŒºã€‚å¦‚æœè¿˜ä¸èƒ½å¾—åˆ°é”ï¼Œæ‰ä¼šçœŸå®åœ°å°†çº¿ç¨‹åœ¨æ“ä½œç³»ç»Ÿå±‚é¢æŒ‚èµ·ã€‚</p>\n<h3 id=\"4ã€-é”æ¶ˆé™¤\"><a href=\"#4ã€-é”æ¶ˆé™¤\" class=\"headerlink\" title=\"4ã€ é”æ¶ˆé™¤\"></a>4ã€ é”æ¶ˆé™¤</h3><p>é”æ¶ˆé™¤æ˜¯ä¸€ç§æ›´å½»åº•çš„é”ä¼˜åŒ–ã€‚Javaè™šæ‹Ÿæœºåœ¨JITç¼–è¯‘æ—¶ï¼Œé€šè¿‡å¯¹è¿è¡Œä¸Šä¸‹æ–‡çš„æ‰«æï¼Œå»é™¤ä¸å¯èƒ½å­˜åœ¨å…±äº«èµ„æºç«äº‰çš„é”ã€‚é€šè¿‡é”æ¶ˆé™¤ï¼Œå¯ä»¥èŠ‚çœæ¯«æ— æ„ä¹‰çš„è¯·æ±‚é”æ—¶é—´ã€‚</p>\n<p>ä¸‹é¢è¿™ç§è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬ä½¿ç”¨vectorï¼Œ è€Œvectorå†…éƒ¨ä½¿ç”¨äº†synchronizeè¯·æ±‚é”ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public String []  createStrings()&#123;\n    Vector&lt;String&gt;  v&#x3D; new Vector&lt;String&gt;();\n    for(int i&#x3D;0;i&lt;100;i++)&#123;\n        v.add(Integer.toString(i));\n    &#125;\n    return v.toArray(new String[]&#123;&#125;);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç”±äºVåªåœ¨å‡½æ•° createStrnigs ä¸­ä½¿ç”¨ï¼Œå› æ­¤å®ƒåªæ˜¯ä¸€ä¸ªå•çº¯çš„å±€éƒ¨å˜é‡ã€‚å±€éƒ¨å˜é‡æ˜¯åœ¨çº¿ç¨‹æ ˆä¸Šåˆ†é…çš„ï¼Œå±äºçº¿ç¨‹ç§æœ‰é¢æ•°æ®ï¼Œå› æ­¤ä¸å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹è®¿é—®ã€‚æ‰€ä»¥ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒVectorå†…éƒ¨æ‰€æœ‰åŠ é”åŒæ­¥éƒ½æ˜¯æ²¡æœ‰å¿…è¦çš„ã€‚å¦‚æœè™šæ‹Ÿæœºæ£€æµ‹åˆ°è¿™ç§æƒ…å†µï¼Œå°±ä¼šå°†è¿™äº›æ— ç”¨çš„é”æ“ä½œå»é™¤ã€‚</p>\n<p>é”æ¶ˆé™¤æ¶‰åŠçš„ä¸€é¡¹å…³é”®æŠ€æœ¯ä¸ºé€ƒé€¸åˆ†æã€‚æ‰€è°“é€ƒé€¸åˆ†æå°±æ˜¯è§‚å¯ŸæŸä¸€ä¸ªå˜é‡æ˜¯å¦ä¼šé€ƒå‡ºæŸä¸€ä¸ªä½œç”¨åŸŸã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œå˜é‡væ˜¾ç„¶æ²¡æœ‰é€ƒå‡ºcreateString å‡½æ•°ä¹‹å¤–ã€‚ä»¥æ­¤ä¸ºåŸºç¡€ï¼Œè™šæ‹Ÿæœºæ‰å¯ä»¥å¤§èƒ†çš„å°†vå†…éƒ¨çš„åŠ é”æ“ä½œå»é™¤ã€‚å¦‚æœcreateStrings è¿”å›çš„ä¸æ˜¯Stringæ•°ç»„ï¼Œè€Œæ˜¯væœ¬èº«ï¼Œé‚£ä¹ˆå°±è®¤ä¸ºå˜é‡vé€ƒé€¸å‡ºäº†å½“å‰å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´væœ‰å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹è®¿é—®ã€‚å¦‚æ˜¯è¿™æ ·ï¼Œè™šæ‹Ÿæœºå°±ä¸èƒ½æ¶ˆé™¤vä¸­çš„é”æ“ä½œã€‚</p>\n<p>é€ƒé€¸åˆ†æå¿…é¡»åœ¨ -server æ¨¡å¼ä¸‹è¿›è¡Œï¼Œå¯ä»¥ä½¿ç”¨ -XX:DoEscapeAnalysis å‚æ•°æ‰“å¼€é€ƒé€¸åˆ†æï¼Œä½¿ç”¨ -XX:+EliminateLocks å‚æ•°å¯ä»¥æ‰“å¼€é”æ¶ˆé™¤ã€‚</p>\n<p>æœ¬æ–‡æ‘˜è‡ªã€ŠJavaé«˜å¹¶å‘ç¨‹åºè®¾è®¡ã€‹ä¸€ä¹¦ã€‚</p>\n"},{"title":"Synchronized ä¸ ReentrantLock çš„åŒºåˆ«ï¼","date":"2025-10-14T06:42:34.000Z","_content":"**å¯é‡å…¥æ€§ï¼š**\n\nä»åå­—ä¸Šç†è§£ï¼ŒReenTrantLockçš„å­—é¢æ„æ€å°±æ˜¯å†è¿›å…¥çš„é”ï¼Œå…¶å®synchronizedå…³é”®å­—æ‰€ä½¿ç”¨çš„é”ä¹Ÿæ˜¯å¯é‡å…¥çš„ï¼Œä¸¤è€…å…³äºè¿™ä¸ªçš„åŒºåˆ«ä¸å¤§ã€‚ä¸¤è€…éƒ½æ˜¯åŒä¸€ä¸ªçº¿ç¨‹æ²¡è¿›å…¥ä¸€æ¬¡ï¼Œé”çš„è®¡æ•°å™¨éƒ½è‡ªå¢1ï¼Œæ‰€ä»¥è¦ç­‰åˆ°é”çš„è®¡æ•°å™¨ä¸‹é™ä¸º0æ—¶æ‰èƒ½é‡Šæ”¾é”ã€‚\n\n\n**é”çš„å®ç°ï¼š**\n\nSynchronizedæ˜¯ä¾èµ–äºJVMå®ç°çš„ï¼Œè€ŒReenTrantLockæ˜¯JDKå®ç°çš„ï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œè¯´ç™½äº†å°±ç±»ä¼¼äºæ“ä½œç³»ç»Ÿæ¥æ§åˆ¶å®ç°å’Œç”¨æˆ·è‡ªå·±æ•²ä»£ç å®ç°çš„åŒºåˆ«ã€‚å‰è€…çš„å®ç°æ˜¯æ¯”è¾ƒéš¾è§åˆ°çš„ï¼Œåè€…æœ‰ç›´æ¥çš„æºç å¯ä¾›é˜…è¯»ã€‚\n\n\n**æ€§èƒ½çš„åŒºåˆ«ï¼š**\n\nåœ¨Synchronizedä¼˜åŒ–ä»¥å‰ï¼Œsynchronizedçš„æ€§èƒ½æ˜¯æ¯”ReenTrantLockå·®å¾ˆå¤šçš„ï¼Œä½†æ˜¯è‡ªä»Synchronizedå¼•å…¥äº†åå‘é”ï¼Œè½»é‡çº§é”ï¼ˆè‡ªæ—‹é”ï¼‰åï¼Œä¸¤è€…çš„æ€§èƒ½å°±å·®ä¸å¤šäº†ï¼Œåœ¨ä¸¤ç§æ–¹æ³•éƒ½å¯ç”¨çš„æƒ…å†µä¸‹ï¼Œå®˜æ–¹ç”šè‡³å»ºè®®ä½¿ç”¨synchronizedï¼Œå…¶å®synchronizedçš„ä¼˜åŒ–æˆ‘æ„Ÿè§‰å°±å€Ÿé‰´äº†ReenTrantLockä¸­çš„CASæŠ€æœ¯ã€‚éƒ½æ˜¯è¯•å›¾åœ¨ç”¨æˆ·æ€å°±æŠŠåŠ é”é—®é¢˜è§£å†³ï¼Œé¿å…è¿›å…¥å†…æ ¸æ€çš„çº¿ç¨‹é˜»å¡ã€‚\n\n\n**åŠŸèƒ½åŒºåˆ«ï¼š**\n\nä¾¿åˆ©æ€§ï¼šå¾ˆæ˜æ˜¾Synchronizedçš„ä½¿ç”¨æ¯”è¾ƒæ–¹ä¾¿ç®€æ´ï¼Œå¹¶ä¸”ç”±ç¼–è¯‘å™¨å»ä¿è¯é”çš„åŠ é”å’Œé‡Šæ”¾ï¼Œè€ŒReenTrantLockéœ€è¦æ‰‹å·¥å£°æ˜æ¥åŠ é”å’Œé‡Šæ”¾é”ï¼Œä¸ºäº†é¿å…å¿˜è®°æ‰‹å·¥é‡Šæ”¾é”é€ æˆæ­»é”ï¼Œæ‰€ä»¥æœ€å¥½åœ¨finallyä¸­å£°æ˜é‡Šæ”¾é”ã€‚\n\né”çš„ç»†ç²’åº¦å’Œçµæ´»åº¦ï¼šå¾ˆæ˜æ˜¾ReenTrantLockä¼˜äºSynchronized\n\n\n**ReenTrantLockç‹¬æœ‰çš„èƒ½åŠ›ï¼š**\n\n1.ReenTrantLockå¯ä»¥æŒ‡å®šæ˜¯å…¬å¹³é”è¿˜æ˜¯éå…¬å¹³é”ã€‚è€Œsynchronizedåªèƒ½æ˜¯éå…¬å¹³é”ã€‚æ‰€è°“çš„å…¬å¹³é”å°±æ˜¯å…ˆç­‰å¾…çš„çº¿ç¨‹å…ˆè·å¾—é”ã€‚\n\n2.ReenTrantLockæä¾›äº†ä¸€ä¸ªConditionï¼ˆæ¡ä»¶ï¼‰ç±»ï¼Œç”¨æ¥å®ç°åˆ†ç»„å”¤é†’éœ€è¦å”¤é†’çš„çº¿ç¨‹ä»¬ï¼Œè€Œä¸æ˜¯åƒsynchronizedè¦ä¹ˆéšæœºå”¤é†’ä¸€ä¸ªçº¿ç¨‹è¦ä¹ˆå”¤é†’å…¨éƒ¨çº¿ç¨‹ã€‚\n\n3.ReenTrantLockæä¾›äº†ä¸€ç§èƒ½å¤Ÿä¸­æ–­ç­‰å¾…é”çš„çº¿ç¨‹çš„æœºåˆ¶ï¼Œé€šè¿‡lock.lockInterruptibly()æ¥å®ç°è¿™ä¸ªæœºåˆ¶ã€‚\n\n\n**ReenTrantLockå®ç°çš„åŸç†ï¼š**\n\nåœ¨ç½‘ä¸Šçœ‹åˆ°ç›¸å…³çš„æºç åˆ†æï¼Œæœ¬æ¥è¿™å—åº”è¯¥æ˜¯æœ¬æ–‡çš„æ ¸å¿ƒï¼Œä½†æ˜¯æ„Ÿè§‰æ¯”è¾ƒå¤æ‚å°±ä¸ä¸€ä¸€è¯¦è§£äº†ï¼Œç®€å•æ¥è¯´ï¼ŒReenTrantLockçš„å®ç°æ˜¯ä¸€ç§è‡ªæ—‹é”ï¼Œé€šè¿‡å¾ªç¯è°ƒç”¨CASæ“ä½œæ¥å®ç°åŠ é”ã€‚å®ƒçš„æ€§èƒ½æ¯”è¾ƒå¥½ä¹Ÿæ˜¯å› ä¸ºé¿å…äº†ä½¿çº¿ç¨‹è¿›å…¥å†…æ ¸æ€çš„é˜»å¡çŠ¶æ€ã€‚æƒ³å°½åŠæ³•é¿å…çº¿ç¨‹è¿›å…¥å†…æ ¸çš„é˜»å¡çŠ¶æ€æ˜¯æˆ‘ä»¬å»åˆ†æå’Œç†è§£é”è®¾è®¡çš„å…³é”®é’¥åŒ™ã€‚\n\n\n**ä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨ReenTrantLockï¼š**\n\nç­”æ¡ˆæ˜¯ï¼Œå¦‚æœä½ éœ€è¦å®ç°ReenTrantLockçš„ä¸‰ä¸ªç‹¬æœ‰åŠŸèƒ½æ—¶ã€‚\n\n","source":"_posts/å¤šçº¿ç¨‹/Synchronized ä¸ ReentrantLock çš„åŒºåˆ«ï¼.md","raw":"---\ntitle: Synchronized ä¸ ReentrantLock çš„åŒºåˆ«ï¼\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: å¤šçº¿ç¨‹\n---\n**å¯é‡å…¥æ€§ï¼š**\n\nä»åå­—ä¸Šç†è§£ï¼ŒReenTrantLockçš„å­—é¢æ„æ€å°±æ˜¯å†è¿›å…¥çš„é”ï¼Œå…¶å®synchronizedå…³é”®å­—æ‰€ä½¿ç”¨çš„é”ä¹Ÿæ˜¯å¯é‡å…¥çš„ï¼Œä¸¤è€…å…³äºè¿™ä¸ªçš„åŒºåˆ«ä¸å¤§ã€‚ä¸¤è€…éƒ½æ˜¯åŒä¸€ä¸ªçº¿ç¨‹æ²¡è¿›å…¥ä¸€æ¬¡ï¼Œé”çš„è®¡æ•°å™¨éƒ½è‡ªå¢1ï¼Œæ‰€ä»¥è¦ç­‰åˆ°é”çš„è®¡æ•°å™¨ä¸‹é™ä¸º0æ—¶æ‰èƒ½é‡Šæ”¾é”ã€‚\n\n\n**é”çš„å®ç°ï¼š**\n\nSynchronizedæ˜¯ä¾èµ–äºJVMå®ç°çš„ï¼Œè€ŒReenTrantLockæ˜¯JDKå®ç°çš„ï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œè¯´ç™½äº†å°±ç±»ä¼¼äºæ“ä½œç³»ç»Ÿæ¥æ§åˆ¶å®ç°å’Œç”¨æˆ·è‡ªå·±æ•²ä»£ç å®ç°çš„åŒºåˆ«ã€‚å‰è€…çš„å®ç°æ˜¯æ¯”è¾ƒéš¾è§åˆ°çš„ï¼Œåè€…æœ‰ç›´æ¥çš„æºç å¯ä¾›é˜…è¯»ã€‚\n\n\n**æ€§èƒ½çš„åŒºåˆ«ï¼š**\n\nåœ¨Synchronizedä¼˜åŒ–ä»¥å‰ï¼Œsynchronizedçš„æ€§èƒ½æ˜¯æ¯”ReenTrantLockå·®å¾ˆå¤šçš„ï¼Œä½†æ˜¯è‡ªä»Synchronizedå¼•å…¥äº†åå‘é”ï¼Œè½»é‡çº§é”ï¼ˆè‡ªæ—‹é”ï¼‰åï¼Œä¸¤è€…çš„æ€§èƒ½å°±å·®ä¸å¤šäº†ï¼Œåœ¨ä¸¤ç§æ–¹æ³•éƒ½å¯ç”¨çš„æƒ…å†µä¸‹ï¼Œå®˜æ–¹ç”šè‡³å»ºè®®ä½¿ç”¨synchronizedï¼Œå…¶å®synchronizedçš„ä¼˜åŒ–æˆ‘æ„Ÿè§‰å°±å€Ÿé‰´äº†ReenTrantLockä¸­çš„CASæŠ€æœ¯ã€‚éƒ½æ˜¯è¯•å›¾åœ¨ç”¨æˆ·æ€å°±æŠŠåŠ é”é—®é¢˜è§£å†³ï¼Œé¿å…è¿›å…¥å†…æ ¸æ€çš„çº¿ç¨‹é˜»å¡ã€‚\n\n\n**åŠŸèƒ½åŒºåˆ«ï¼š**\n\nä¾¿åˆ©æ€§ï¼šå¾ˆæ˜æ˜¾Synchronizedçš„ä½¿ç”¨æ¯”è¾ƒæ–¹ä¾¿ç®€æ´ï¼Œå¹¶ä¸”ç”±ç¼–è¯‘å™¨å»ä¿è¯é”çš„åŠ é”å’Œé‡Šæ”¾ï¼Œè€ŒReenTrantLockéœ€è¦æ‰‹å·¥å£°æ˜æ¥åŠ é”å’Œé‡Šæ”¾é”ï¼Œä¸ºäº†é¿å…å¿˜è®°æ‰‹å·¥é‡Šæ”¾é”é€ æˆæ­»é”ï¼Œæ‰€ä»¥æœ€å¥½åœ¨finallyä¸­å£°æ˜é‡Šæ”¾é”ã€‚\n\né”çš„ç»†ç²’åº¦å’Œçµæ´»åº¦ï¼šå¾ˆæ˜æ˜¾ReenTrantLockä¼˜äºSynchronized\n\n\n**ReenTrantLockç‹¬æœ‰çš„èƒ½åŠ›ï¼š**\n\n1.ReenTrantLockå¯ä»¥æŒ‡å®šæ˜¯å…¬å¹³é”è¿˜æ˜¯éå…¬å¹³é”ã€‚è€Œsynchronizedåªèƒ½æ˜¯éå…¬å¹³é”ã€‚æ‰€è°“çš„å…¬å¹³é”å°±æ˜¯å…ˆç­‰å¾…çš„çº¿ç¨‹å…ˆè·å¾—é”ã€‚\n\n2.ReenTrantLockæä¾›äº†ä¸€ä¸ªConditionï¼ˆæ¡ä»¶ï¼‰ç±»ï¼Œç”¨æ¥å®ç°åˆ†ç»„å”¤é†’éœ€è¦å”¤é†’çš„çº¿ç¨‹ä»¬ï¼Œè€Œä¸æ˜¯åƒsynchronizedè¦ä¹ˆéšæœºå”¤é†’ä¸€ä¸ªçº¿ç¨‹è¦ä¹ˆå”¤é†’å…¨éƒ¨çº¿ç¨‹ã€‚\n\n3.ReenTrantLockæä¾›äº†ä¸€ç§èƒ½å¤Ÿä¸­æ–­ç­‰å¾…é”çš„çº¿ç¨‹çš„æœºåˆ¶ï¼Œé€šè¿‡lock.lockInterruptibly()æ¥å®ç°è¿™ä¸ªæœºåˆ¶ã€‚\n\n\n**ReenTrantLockå®ç°çš„åŸç†ï¼š**\n\nåœ¨ç½‘ä¸Šçœ‹åˆ°ç›¸å…³çš„æºç åˆ†æï¼Œæœ¬æ¥è¿™å—åº”è¯¥æ˜¯æœ¬æ–‡çš„æ ¸å¿ƒï¼Œä½†æ˜¯æ„Ÿè§‰æ¯”è¾ƒå¤æ‚å°±ä¸ä¸€ä¸€è¯¦è§£äº†ï¼Œç®€å•æ¥è¯´ï¼ŒReenTrantLockçš„å®ç°æ˜¯ä¸€ç§è‡ªæ—‹é”ï¼Œé€šè¿‡å¾ªç¯è°ƒç”¨CASæ“ä½œæ¥å®ç°åŠ é”ã€‚å®ƒçš„æ€§èƒ½æ¯”è¾ƒå¥½ä¹Ÿæ˜¯å› ä¸ºé¿å…äº†ä½¿çº¿ç¨‹è¿›å…¥å†…æ ¸æ€çš„é˜»å¡çŠ¶æ€ã€‚æƒ³å°½åŠæ³•é¿å…çº¿ç¨‹è¿›å…¥å†…æ ¸çš„é˜»å¡çŠ¶æ€æ˜¯æˆ‘ä»¬å»åˆ†æå’Œç†è§£é”è®¾è®¡çš„å…³é”®é’¥åŒ™ã€‚\n\n\n**ä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨ReenTrantLockï¼š**\n\nç­”æ¡ˆæ˜¯ï¼Œå¦‚æœä½ éœ€è¦å®ç°ReenTrantLockçš„ä¸‰ä¸ªç‹¬æœ‰åŠŸèƒ½æ—¶ã€‚\n\n","slug":"å¤šçº¿ç¨‹/Synchronized ä¸ ReentrantLock çš„åŒºåˆ«ï¼","published":1,"updated":"2025-10-15T07:20:25.073Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076m001yqkd4b6j17olg","content":"<p><strong>å¯é‡å…¥æ€§ï¼š</strong></p>\n<p>ä»åå­—ä¸Šç†è§£ï¼ŒReenTrantLockçš„å­—é¢æ„æ€å°±æ˜¯å†è¿›å…¥çš„é”ï¼Œå…¶å®synchronizedå…³é”®å­—æ‰€ä½¿ç”¨çš„é”ä¹Ÿæ˜¯å¯é‡å…¥çš„ï¼Œä¸¤è€…å…³äºè¿™ä¸ªçš„åŒºåˆ«ä¸å¤§ã€‚ä¸¤è€…éƒ½æ˜¯åŒä¸€ä¸ªçº¿ç¨‹æ²¡è¿›å…¥ä¸€æ¬¡ï¼Œé”çš„è®¡æ•°å™¨éƒ½è‡ªå¢1ï¼Œæ‰€ä»¥è¦ç­‰åˆ°é”çš„è®¡æ•°å™¨ä¸‹é™ä¸º0æ—¶æ‰èƒ½é‡Šæ”¾é”ã€‚</p>\n<p><strong>é”çš„å®ç°ï¼š</strong></p>\n<p>Synchronizedæ˜¯ä¾èµ–äºJVMå®ç°çš„ï¼Œè€ŒReenTrantLockæ˜¯JDKå®ç°çš„ï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œè¯´ç™½äº†å°±ç±»ä¼¼äºæ“ä½œç³»ç»Ÿæ¥æ§åˆ¶å®ç°å’Œç”¨æˆ·è‡ªå·±æ•²ä»£ç å®ç°çš„åŒºåˆ«ã€‚å‰è€…çš„å®ç°æ˜¯æ¯”è¾ƒéš¾è§åˆ°çš„ï¼Œåè€…æœ‰ç›´æ¥çš„æºç å¯ä¾›é˜…è¯»ã€‚</p>\n<p><strong>æ€§èƒ½çš„åŒºåˆ«ï¼š</strong></p>\n<p>åœ¨Synchronizedä¼˜åŒ–ä»¥å‰ï¼Œsynchronizedçš„æ€§èƒ½æ˜¯æ¯”ReenTrantLockå·®å¾ˆå¤šçš„ï¼Œä½†æ˜¯è‡ªä»Synchronizedå¼•å…¥äº†åå‘é”ï¼Œè½»é‡çº§é”ï¼ˆè‡ªæ—‹é”ï¼‰åï¼Œä¸¤è€…çš„æ€§èƒ½å°±å·®ä¸å¤šäº†ï¼Œåœ¨ä¸¤ç§æ–¹æ³•éƒ½å¯ç”¨çš„æƒ…å†µä¸‹ï¼Œå®˜æ–¹ç”šè‡³å»ºè®®ä½¿ç”¨synchronizedï¼Œå…¶å®synchronizedçš„ä¼˜åŒ–æˆ‘æ„Ÿè§‰å°±å€Ÿé‰´äº†ReenTrantLockä¸­çš„CASæŠ€æœ¯ã€‚éƒ½æ˜¯è¯•å›¾åœ¨ç”¨æˆ·æ€å°±æŠŠåŠ é”é—®é¢˜è§£å†³ï¼Œé¿å…è¿›å…¥å†…æ ¸æ€çš„çº¿ç¨‹é˜»å¡ã€‚</p>\n<p><strong>åŠŸèƒ½åŒºåˆ«ï¼š</strong></p>\n<p>ä¾¿åˆ©æ€§ï¼šå¾ˆæ˜æ˜¾Synchronizedçš„ä½¿ç”¨æ¯”è¾ƒæ–¹ä¾¿ç®€æ´ï¼Œå¹¶ä¸”ç”±ç¼–è¯‘å™¨å»ä¿è¯é”çš„åŠ é”å’Œé‡Šæ”¾ï¼Œè€ŒReenTrantLockéœ€è¦æ‰‹å·¥å£°æ˜æ¥åŠ é”å’Œé‡Šæ”¾é”ï¼Œä¸ºäº†é¿å…å¿˜è®°æ‰‹å·¥é‡Šæ”¾é”é€ æˆæ­»é”ï¼Œæ‰€ä»¥æœ€å¥½åœ¨finallyä¸­å£°æ˜é‡Šæ”¾é”ã€‚</p>\n<p>é”çš„ç»†ç²’åº¦å’Œçµæ´»åº¦ï¼šå¾ˆæ˜æ˜¾ReenTrantLockä¼˜äºSynchronized</p>\n<p><strong>ReenTrantLockç‹¬æœ‰çš„èƒ½åŠ›ï¼š</strong></p>\n<p>1.ReenTrantLockå¯ä»¥æŒ‡å®šæ˜¯å…¬å¹³é”è¿˜æ˜¯éå…¬å¹³é”ã€‚è€Œsynchronizedåªèƒ½æ˜¯éå…¬å¹³é”ã€‚æ‰€è°“çš„å…¬å¹³é”å°±æ˜¯å…ˆç­‰å¾…çš„çº¿ç¨‹å…ˆè·å¾—é”ã€‚</p>\n<p>2.ReenTrantLockæä¾›äº†ä¸€ä¸ªConditionï¼ˆæ¡ä»¶ï¼‰ç±»ï¼Œç”¨æ¥å®ç°åˆ†ç»„å”¤é†’éœ€è¦å”¤é†’çš„çº¿ç¨‹ä»¬ï¼Œè€Œä¸æ˜¯åƒsynchronizedè¦ä¹ˆéšæœºå”¤é†’ä¸€ä¸ªçº¿ç¨‹è¦ä¹ˆå”¤é†’å…¨éƒ¨çº¿ç¨‹ã€‚</p>\n<p>3.ReenTrantLockæä¾›äº†ä¸€ç§èƒ½å¤Ÿä¸­æ–­ç­‰å¾…é”çš„çº¿ç¨‹çš„æœºåˆ¶ï¼Œé€šè¿‡lock.lockInterruptibly()æ¥å®ç°è¿™ä¸ªæœºåˆ¶ã€‚</p>\n<p><strong>ReenTrantLockå®ç°çš„åŸç†ï¼š</strong></p>\n<p>åœ¨ç½‘ä¸Šçœ‹åˆ°ç›¸å…³çš„æºç åˆ†æï¼Œæœ¬æ¥è¿™å—åº”è¯¥æ˜¯æœ¬æ–‡çš„æ ¸å¿ƒï¼Œä½†æ˜¯æ„Ÿè§‰æ¯”è¾ƒå¤æ‚å°±ä¸ä¸€ä¸€è¯¦è§£äº†ï¼Œç®€å•æ¥è¯´ï¼ŒReenTrantLockçš„å®ç°æ˜¯ä¸€ç§è‡ªæ—‹é”ï¼Œé€šè¿‡å¾ªç¯è°ƒç”¨CASæ“ä½œæ¥å®ç°åŠ é”ã€‚å®ƒçš„æ€§èƒ½æ¯”è¾ƒå¥½ä¹Ÿæ˜¯å› ä¸ºé¿å…äº†ä½¿çº¿ç¨‹è¿›å…¥å†…æ ¸æ€çš„é˜»å¡çŠ¶æ€ã€‚æƒ³å°½åŠæ³•é¿å…çº¿ç¨‹è¿›å…¥å†…æ ¸çš„é˜»å¡çŠ¶æ€æ˜¯æˆ‘ä»¬å»åˆ†æå’Œç†è§£é”è®¾è®¡çš„å…³é”®é’¥åŒ™ã€‚</p>\n<p><strong>ä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨ReenTrantLockï¼š</strong></p>\n<p>ç­”æ¡ˆæ˜¯ï¼Œå¦‚æœä½ éœ€è¦å®ç°ReenTrantLockçš„ä¸‰ä¸ªç‹¬æœ‰åŠŸèƒ½æ—¶ã€‚</p>\n","excerpt":"","more":"<p><strong>å¯é‡å…¥æ€§ï¼š</strong></p>\n<p>ä»åå­—ä¸Šç†è§£ï¼ŒReenTrantLockçš„å­—é¢æ„æ€å°±æ˜¯å†è¿›å…¥çš„é”ï¼Œå…¶å®synchronizedå…³é”®å­—æ‰€ä½¿ç”¨çš„é”ä¹Ÿæ˜¯å¯é‡å…¥çš„ï¼Œä¸¤è€…å…³äºè¿™ä¸ªçš„åŒºåˆ«ä¸å¤§ã€‚ä¸¤è€…éƒ½æ˜¯åŒä¸€ä¸ªçº¿ç¨‹æ²¡è¿›å…¥ä¸€æ¬¡ï¼Œé”çš„è®¡æ•°å™¨éƒ½è‡ªå¢1ï¼Œæ‰€ä»¥è¦ç­‰åˆ°é”çš„è®¡æ•°å™¨ä¸‹é™ä¸º0æ—¶æ‰èƒ½é‡Šæ”¾é”ã€‚</p>\n<p><strong>é”çš„å®ç°ï¼š</strong></p>\n<p>Synchronizedæ˜¯ä¾èµ–äºJVMå®ç°çš„ï¼Œè€ŒReenTrantLockæ˜¯JDKå®ç°çš„ï¼Œæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œè¯´ç™½äº†å°±ç±»ä¼¼äºæ“ä½œç³»ç»Ÿæ¥æ§åˆ¶å®ç°å’Œç”¨æˆ·è‡ªå·±æ•²ä»£ç å®ç°çš„åŒºåˆ«ã€‚å‰è€…çš„å®ç°æ˜¯æ¯”è¾ƒéš¾è§åˆ°çš„ï¼Œåè€…æœ‰ç›´æ¥çš„æºç å¯ä¾›é˜…è¯»ã€‚</p>\n<p><strong>æ€§èƒ½çš„åŒºåˆ«ï¼š</strong></p>\n<p>åœ¨Synchronizedä¼˜åŒ–ä»¥å‰ï¼Œsynchronizedçš„æ€§èƒ½æ˜¯æ¯”ReenTrantLockå·®å¾ˆå¤šçš„ï¼Œä½†æ˜¯è‡ªä»Synchronizedå¼•å…¥äº†åå‘é”ï¼Œè½»é‡çº§é”ï¼ˆè‡ªæ—‹é”ï¼‰åï¼Œä¸¤è€…çš„æ€§èƒ½å°±å·®ä¸å¤šäº†ï¼Œåœ¨ä¸¤ç§æ–¹æ³•éƒ½å¯ç”¨çš„æƒ…å†µä¸‹ï¼Œå®˜æ–¹ç”šè‡³å»ºè®®ä½¿ç”¨synchronizedï¼Œå…¶å®synchronizedçš„ä¼˜åŒ–æˆ‘æ„Ÿè§‰å°±å€Ÿé‰´äº†ReenTrantLockä¸­çš„CASæŠ€æœ¯ã€‚éƒ½æ˜¯è¯•å›¾åœ¨ç”¨æˆ·æ€å°±æŠŠåŠ é”é—®é¢˜è§£å†³ï¼Œé¿å…è¿›å…¥å†…æ ¸æ€çš„çº¿ç¨‹é˜»å¡ã€‚</p>\n<p><strong>åŠŸèƒ½åŒºåˆ«ï¼š</strong></p>\n<p>ä¾¿åˆ©æ€§ï¼šå¾ˆæ˜æ˜¾Synchronizedçš„ä½¿ç”¨æ¯”è¾ƒæ–¹ä¾¿ç®€æ´ï¼Œå¹¶ä¸”ç”±ç¼–è¯‘å™¨å»ä¿è¯é”çš„åŠ é”å’Œé‡Šæ”¾ï¼Œè€ŒReenTrantLockéœ€è¦æ‰‹å·¥å£°æ˜æ¥åŠ é”å’Œé‡Šæ”¾é”ï¼Œä¸ºäº†é¿å…å¿˜è®°æ‰‹å·¥é‡Šæ”¾é”é€ æˆæ­»é”ï¼Œæ‰€ä»¥æœ€å¥½åœ¨finallyä¸­å£°æ˜é‡Šæ”¾é”ã€‚</p>\n<p>é”çš„ç»†ç²’åº¦å’Œçµæ´»åº¦ï¼šå¾ˆæ˜æ˜¾ReenTrantLockä¼˜äºSynchronized</p>\n<p><strong>ReenTrantLockç‹¬æœ‰çš„èƒ½åŠ›ï¼š</strong></p>\n<p>1.ReenTrantLockå¯ä»¥æŒ‡å®šæ˜¯å…¬å¹³é”è¿˜æ˜¯éå…¬å¹³é”ã€‚è€Œsynchronizedåªèƒ½æ˜¯éå…¬å¹³é”ã€‚æ‰€è°“çš„å…¬å¹³é”å°±æ˜¯å…ˆç­‰å¾…çš„çº¿ç¨‹å…ˆè·å¾—é”ã€‚</p>\n<p>2.ReenTrantLockæä¾›äº†ä¸€ä¸ªConditionï¼ˆæ¡ä»¶ï¼‰ç±»ï¼Œç”¨æ¥å®ç°åˆ†ç»„å”¤é†’éœ€è¦å”¤é†’çš„çº¿ç¨‹ä»¬ï¼Œè€Œä¸æ˜¯åƒsynchronizedè¦ä¹ˆéšæœºå”¤é†’ä¸€ä¸ªçº¿ç¨‹è¦ä¹ˆå”¤é†’å…¨éƒ¨çº¿ç¨‹ã€‚</p>\n<p>3.ReenTrantLockæä¾›äº†ä¸€ç§èƒ½å¤Ÿä¸­æ–­ç­‰å¾…é”çš„çº¿ç¨‹çš„æœºåˆ¶ï¼Œé€šè¿‡lock.lockInterruptibly()æ¥å®ç°è¿™ä¸ªæœºåˆ¶ã€‚</p>\n<p><strong>ReenTrantLockå®ç°çš„åŸç†ï¼š</strong></p>\n<p>åœ¨ç½‘ä¸Šçœ‹åˆ°ç›¸å…³çš„æºç åˆ†æï¼Œæœ¬æ¥è¿™å—åº”è¯¥æ˜¯æœ¬æ–‡çš„æ ¸å¿ƒï¼Œä½†æ˜¯æ„Ÿè§‰æ¯”è¾ƒå¤æ‚å°±ä¸ä¸€ä¸€è¯¦è§£äº†ï¼Œç®€å•æ¥è¯´ï¼ŒReenTrantLockçš„å®ç°æ˜¯ä¸€ç§è‡ªæ—‹é”ï¼Œé€šè¿‡å¾ªç¯è°ƒç”¨CASæ“ä½œæ¥å®ç°åŠ é”ã€‚å®ƒçš„æ€§èƒ½æ¯”è¾ƒå¥½ä¹Ÿæ˜¯å› ä¸ºé¿å…äº†ä½¿çº¿ç¨‹è¿›å…¥å†…æ ¸æ€çš„é˜»å¡çŠ¶æ€ã€‚æƒ³å°½åŠæ³•é¿å…çº¿ç¨‹è¿›å…¥å†…æ ¸çš„é˜»å¡çŠ¶æ€æ˜¯æˆ‘ä»¬å»åˆ†æå’Œç†è§£é”è®¾è®¡çš„å…³é”®é’¥åŒ™ã€‚</p>\n<p><strong>ä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨ReenTrantLockï¼š</strong></p>\n<p>ç­”æ¡ˆæ˜¯ï¼Œå¦‚æœä½ éœ€è¦å®ç°ReenTrantLockçš„ä¸‰ä¸ªç‹¬æœ‰åŠŸèƒ½æ—¶ã€‚</p>\n"},{"title":"Synchronized æœ‰å‡ ç§ç”¨æ³•ï¼Ÿ","date":"2025-10-14T06:42:34.000Z","_content":"\næˆ‘ä»¬éƒ½çŸ¥é“ Synchronized æ˜¯çº¿ç¨‹å®‰å…¨åŒæ­¥ç”¨çš„ï¼Œå¤§éƒ¨åˆ†ç¨‹åºå¯èƒ½åªä¼šç”¨åˆ°åŒæ­¥æ–¹æ³•ä¸Šé¢ã€‚å…¶å® Synchronized å¯ä»¥ç”¨åˆ°æ›´å¤šçš„åœºåˆï¼Œæ ˆé•¿åˆ—ä¸¾äº†ä»¥ä¸‹å‡ ä¸ªç”¨æ³•ã€‚\n\n## **1ã€åŒæ­¥æ™®é€šæ–¹æ³•**\n\nè¿™ä¸ªä¹Ÿæ˜¯æˆ‘ä»¬ç”¨å¾—æœ€å¤šçš„ï¼Œåªè¦æ¶‰åŠçº¿ç¨‹å®‰å…¨ï¼Œä¸Šæ¥å°±ç»™æ–¹æ³•æ¥ä¸ªåŒæ­¥é”ã€‚è¿™ç§æ–¹æ³•ä½¿ç”¨è™½ç„¶æœ€ç®€å•ï¼Œä½†æ˜¯åªèƒ½ä½œç”¨åœ¨å•ä¾‹ä¸Šé¢ï¼Œå¦‚æœä¸æ˜¯å•ä¾‹ï¼ŒåŒæ­¥æ–¹æ³•é”å°†å¤±æ•ˆã€‚\n\n```\n/**\n * ç”¨åœ¨æ™®é€šæ–¹æ³•\n */\nprivate synchronized void synchronizedMethod() {\n\tSystem.out.println(\"synchronizedMethod\");\n\ttry {\n\t\tThread.sleep(2000);\n\t} catch (InterruptedException e) {\n\t\te.printStackTrace();\n\t}\n}\n```\n\næ­¤æ—¶ï¼ŒåŒä¸€ä¸ªå®ä¾‹åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è·å–é”è¿›å…¥è¿™ä¸ªæ–¹æ³•ã€‚\n\n\n## 2ã€åŒæ­¥é™æ€æ–¹æ³•\n\nåŒæ­¥é™æ€æ–¹æ³•ï¼Œä¸ç®¡ä½ æœ‰å¤šå°‘ä¸ªç±»å®ä¾‹ï¼ŒåŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è·å–é”è¿›å…¥è¿™ä¸ªæ–¹æ³•ã€‚\n\n```\n/**\n * ç”¨åœ¨é™æ€æ–¹æ³•\n */\nprivate synchronized static void synchronizedStaticMethod() {\n\tSystem.out.println(\"synchronizedStaticMethod\");\n\ttry {\n\t\tThread.sleep(2000);\n\t} catch (InterruptedException e) {\n\t\te.printStackTrace();\n\t}\n}\n```\n\nåŒæ­¥é™æ€æ–¹æ³•æ˜¯ç±»çº§åˆ«çš„é”ï¼Œä¸€æ—¦ä»»ä½•ä¸€ä¸ªçº¿ç¨‹è¿›å…¥è¿™ä¸ªæ–¹æ³•ï¼Œå…¶ä»–æ‰€æœ‰çº¿ç¨‹å°†æ— æ³•è®¿é—®è¿™ä¸ªç±»çš„ä»»ä½•åŒæ­¥ç±»é”çš„æ–¹æ³•ã€‚\n\n## 3ã€åŒæ­¥ç±»\n\nä¸‹é¢æä¾›äº†ä¸¤ç§åŒæ­¥ç±»çš„æ–¹æ³•ï¼Œé”ä½æ•ˆæœå’ŒåŒæ­¥é™æ€æ–¹æ³•ä¸€æ ·ï¼Œéƒ½æ˜¯ç±»çº§åˆ«çš„é”ï¼ŒåŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è®¿é—®å¸¦æœ‰åŒæ­¥ç±»é”çš„æ–¹æ³•ã€‚\n\n```\n/**\n * ç”¨åœ¨ç±»\n */\nprivate void synchronizedClass() {\n\tsynchronized (TestSynchronized.class) {\n\t\tSystem.out.println(\"synchronizedClass\");\n\t\ttry {\n\t\t\tThread.sleep(2000);\n\t\t} catch (InterruptedException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n}\n\n/**\n * ç”¨åœ¨ç±»\n */\nprivate void synchronizedGetClass() {\n\tsynchronized (this.getClass()) {\n\t\tSystem.out.println(\"synchronizedGetClass\");\n\t\ttry {\n\t\t\tThread.sleep(2000);\n\t\t} catch (InterruptedException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n}\n```\n\nè¿™é‡Œçš„ä¸¤ç§ç”¨æ³•æ˜¯åŒæ­¥å—çš„ç”¨æ³•ï¼Œè¿™é‡Œè¡¨ç¤ºåªæœ‰è·å–åˆ°è¿™ä¸ªç±»é”æ‰èƒ½è¿›å…¥è¿™ä¸ªä»£ç å—ã€‚\n\n## 4ã€åŒæ­¥thiså®ä¾‹\n\nè¿™ä¹Ÿæ˜¯åŒæ­¥å—çš„ç”¨æ³•ï¼Œè¡¨ç¤ºé”ä½æ•´ä¸ªå½“å‰å¯¹è±¡å®ä¾‹ï¼Œåªæœ‰è·å–åˆ°è¿™ä¸ªå®ä¾‹çš„é”æ‰èƒ½è¿›å…¥è¿™ä¸ªæ–¹æ³•ã€‚\n\n```\n/**\n * ç”¨åœ¨this\n */\nprivate void synchronizedThis() {\n\tsynchronized (this) {\n\t\tSystem.out.println(\"synchronizedThis\");\n\t\ttry {\n\t\t\tThread.sleep(2000);\n\t\t} catch (InterruptedException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n}\n```\n\nç”¨æ³•å’ŒåŒæ­¥æ™®é€šæ–¹æ³•é”ä¸€æ ·ï¼Œéƒ½æ˜¯é”ä½æ•´ä¸ªå½“å‰å®ä¾‹ã€‚\n\n## 5ã€åŒæ­¥å¯¹è±¡å®ä¾‹\n\nè¿™ä¹Ÿæ˜¯åŒæ­¥å—çš„ç”¨æ³•ï¼Œå’Œä¸Šé¢çš„é”ä½å½“å‰å®ä¾‹ä¸€æ ·ï¼Œè¿™é‡Œè¡¨ç¤ºé”ä½æ•´ä¸ª LOCK å¯¹è±¡å®ä¾‹ï¼Œåªæœ‰è·å–åˆ°è¿™ä¸ª LOCK å®ä¾‹çš„é”æ‰èƒ½è¿›å…¥è¿™ä¸ªæ–¹æ³•ã€‚\n\n```\n/**\n * ç”¨åœ¨å¯¹è±¡\n */\nprivate void synchronizedInstance() {\n\tsynchronized (LOCK) {\n\t\tSystem.out.println(\"synchronizedInstance\");\n\t\ttry {\n\t\t\tThread.sleep(2000);\n\t\t} catch (InterruptedException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n}\n```\n\nå¦å¤–ï¼Œç±»é”ä¸å®ä¾‹é”ä¸ç›¸äº’é˜»å¡ï¼Œä½†ç›¸åŒçš„ç±»é”ï¼Œç›¸åŒçš„å½“å‰å®ä¾‹é”ï¼Œç›¸åŒçš„å¯¹è±¡é”ä¼šç›¸äº’é˜»å¡ã€‚\n\nå…³äº Synchronized çš„å‡ ç§ç”¨æ³•æ ˆé•¿å°±ä»‹ç»åˆ°è¿™é‡Œäº†ï¼Œå¦‚æœä½ è¿˜çŸ¥é“å…¶ä»–çš„ç”¨æ³•ï¼Œæ¬¢è¿ç•™è¨€ã€‚\n\n\n","source":"_posts/å¤šçº¿ç¨‹/Synchronized æœ‰å‡ ç§ç”¨æ³•ï¼Ÿ.md","raw":"---\ntitle: Synchronized æœ‰å‡ ç§ç”¨æ³•ï¼Ÿ\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: å¤šçº¿ç¨‹\n---\n\næˆ‘ä»¬éƒ½çŸ¥é“ Synchronized æ˜¯çº¿ç¨‹å®‰å…¨åŒæ­¥ç”¨çš„ï¼Œå¤§éƒ¨åˆ†ç¨‹åºå¯èƒ½åªä¼šç”¨åˆ°åŒæ­¥æ–¹æ³•ä¸Šé¢ã€‚å…¶å® Synchronized å¯ä»¥ç”¨åˆ°æ›´å¤šçš„åœºåˆï¼Œæ ˆé•¿åˆ—ä¸¾äº†ä»¥ä¸‹å‡ ä¸ªç”¨æ³•ã€‚\n\n## **1ã€åŒæ­¥æ™®é€šæ–¹æ³•**\n\nè¿™ä¸ªä¹Ÿæ˜¯æˆ‘ä»¬ç”¨å¾—æœ€å¤šçš„ï¼Œåªè¦æ¶‰åŠçº¿ç¨‹å®‰å…¨ï¼Œä¸Šæ¥å°±ç»™æ–¹æ³•æ¥ä¸ªåŒæ­¥é”ã€‚è¿™ç§æ–¹æ³•ä½¿ç”¨è™½ç„¶æœ€ç®€å•ï¼Œä½†æ˜¯åªèƒ½ä½œç”¨åœ¨å•ä¾‹ä¸Šé¢ï¼Œå¦‚æœä¸æ˜¯å•ä¾‹ï¼ŒåŒæ­¥æ–¹æ³•é”å°†å¤±æ•ˆã€‚\n\n```\n/**\n * ç”¨åœ¨æ™®é€šæ–¹æ³•\n */\nprivate synchronized void synchronizedMethod() {\n\tSystem.out.println(\"synchronizedMethod\");\n\ttry {\n\t\tThread.sleep(2000);\n\t} catch (InterruptedException e) {\n\t\te.printStackTrace();\n\t}\n}\n```\n\næ­¤æ—¶ï¼ŒåŒä¸€ä¸ªå®ä¾‹åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è·å–é”è¿›å…¥è¿™ä¸ªæ–¹æ³•ã€‚\n\n\n## 2ã€åŒæ­¥é™æ€æ–¹æ³•\n\nåŒæ­¥é™æ€æ–¹æ³•ï¼Œä¸ç®¡ä½ æœ‰å¤šå°‘ä¸ªç±»å®ä¾‹ï¼ŒåŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è·å–é”è¿›å…¥è¿™ä¸ªæ–¹æ³•ã€‚\n\n```\n/**\n * ç”¨åœ¨é™æ€æ–¹æ³•\n */\nprivate synchronized static void synchronizedStaticMethod() {\n\tSystem.out.println(\"synchronizedStaticMethod\");\n\ttry {\n\t\tThread.sleep(2000);\n\t} catch (InterruptedException e) {\n\t\te.printStackTrace();\n\t}\n}\n```\n\nåŒæ­¥é™æ€æ–¹æ³•æ˜¯ç±»çº§åˆ«çš„é”ï¼Œä¸€æ—¦ä»»ä½•ä¸€ä¸ªçº¿ç¨‹è¿›å…¥è¿™ä¸ªæ–¹æ³•ï¼Œå…¶ä»–æ‰€æœ‰çº¿ç¨‹å°†æ— æ³•è®¿é—®è¿™ä¸ªç±»çš„ä»»ä½•åŒæ­¥ç±»é”çš„æ–¹æ³•ã€‚\n\n## 3ã€åŒæ­¥ç±»\n\nä¸‹é¢æä¾›äº†ä¸¤ç§åŒæ­¥ç±»çš„æ–¹æ³•ï¼Œé”ä½æ•ˆæœå’ŒåŒæ­¥é™æ€æ–¹æ³•ä¸€æ ·ï¼Œéƒ½æ˜¯ç±»çº§åˆ«çš„é”ï¼ŒåŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è®¿é—®å¸¦æœ‰åŒæ­¥ç±»é”çš„æ–¹æ³•ã€‚\n\n```\n/**\n * ç”¨åœ¨ç±»\n */\nprivate void synchronizedClass() {\n\tsynchronized (TestSynchronized.class) {\n\t\tSystem.out.println(\"synchronizedClass\");\n\t\ttry {\n\t\t\tThread.sleep(2000);\n\t\t} catch (InterruptedException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n}\n\n/**\n * ç”¨åœ¨ç±»\n */\nprivate void synchronizedGetClass() {\n\tsynchronized (this.getClass()) {\n\t\tSystem.out.println(\"synchronizedGetClass\");\n\t\ttry {\n\t\t\tThread.sleep(2000);\n\t\t} catch (InterruptedException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n}\n```\n\nè¿™é‡Œçš„ä¸¤ç§ç”¨æ³•æ˜¯åŒæ­¥å—çš„ç”¨æ³•ï¼Œè¿™é‡Œè¡¨ç¤ºåªæœ‰è·å–åˆ°è¿™ä¸ªç±»é”æ‰èƒ½è¿›å…¥è¿™ä¸ªä»£ç å—ã€‚\n\n## 4ã€åŒæ­¥thiså®ä¾‹\n\nè¿™ä¹Ÿæ˜¯åŒæ­¥å—çš„ç”¨æ³•ï¼Œè¡¨ç¤ºé”ä½æ•´ä¸ªå½“å‰å¯¹è±¡å®ä¾‹ï¼Œåªæœ‰è·å–åˆ°è¿™ä¸ªå®ä¾‹çš„é”æ‰èƒ½è¿›å…¥è¿™ä¸ªæ–¹æ³•ã€‚\n\n```\n/**\n * ç”¨åœ¨this\n */\nprivate void synchronizedThis() {\n\tsynchronized (this) {\n\t\tSystem.out.println(\"synchronizedThis\");\n\t\ttry {\n\t\t\tThread.sleep(2000);\n\t\t} catch (InterruptedException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n}\n```\n\nç”¨æ³•å’ŒåŒæ­¥æ™®é€šæ–¹æ³•é”ä¸€æ ·ï¼Œéƒ½æ˜¯é”ä½æ•´ä¸ªå½“å‰å®ä¾‹ã€‚\n\n## 5ã€åŒæ­¥å¯¹è±¡å®ä¾‹\n\nè¿™ä¹Ÿæ˜¯åŒæ­¥å—çš„ç”¨æ³•ï¼Œå’Œä¸Šé¢çš„é”ä½å½“å‰å®ä¾‹ä¸€æ ·ï¼Œè¿™é‡Œè¡¨ç¤ºé”ä½æ•´ä¸ª LOCK å¯¹è±¡å®ä¾‹ï¼Œåªæœ‰è·å–åˆ°è¿™ä¸ª LOCK å®ä¾‹çš„é”æ‰èƒ½è¿›å…¥è¿™ä¸ªæ–¹æ³•ã€‚\n\n```\n/**\n * ç”¨åœ¨å¯¹è±¡\n */\nprivate void synchronizedInstance() {\n\tsynchronized (LOCK) {\n\t\tSystem.out.println(\"synchronizedInstance\");\n\t\ttry {\n\t\t\tThread.sleep(2000);\n\t\t} catch (InterruptedException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n}\n```\n\nå¦å¤–ï¼Œç±»é”ä¸å®ä¾‹é”ä¸ç›¸äº’é˜»å¡ï¼Œä½†ç›¸åŒçš„ç±»é”ï¼Œç›¸åŒçš„å½“å‰å®ä¾‹é”ï¼Œç›¸åŒçš„å¯¹è±¡é”ä¼šç›¸äº’é˜»å¡ã€‚\n\nå…³äº Synchronized çš„å‡ ç§ç”¨æ³•æ ˆé•¿å°±ä»‹ç»åˆ°è¿™é‡Œäº†ï¼Œå¦‚æœä½ è¿˜çŸ¥é“å…¶ä»–çš„ç”¨æ³•ï¼Œæ¬¢è¿ç•™è¨€ã€‚\n\n\n","slug":"å¤šçº¿ç¨‹/Synchronized æœ‰å‡ ç§ç”¨æ³•ï¼Ÿ","published":1,"updated":"2025-10-15T07:20:24.976Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076m0021qkd431iqcc5g","content":"<p>æˆ‘ä»¬éƒ½çŸ¥é“ Synchronized æ˜¯çº¿ç¨‹å®‰å…¨åŒæ­¥ç”¨çš„ï¼Œå¤§éƒ¨åˆ†ç¨‹åºå¯èƒ½åªä¼šç”¨åˆ°åŒæ­¥æ–¹æ³•ä¸Šé¢ã€‚å…¶å® Synchronized å¯ä»¥ç”¨åˆ°æ›´å¤šçš„åœºåˆï¼Œæ ˆé•¿åˆ—ä¸¾äº†ä»¥ä¸‹å‡ ä¸ªç”¨æ³•ã€‚</p>\n<h2 id=\"1ã€åŒæ­¥æ™®é€šæ–¹æ³•\"><a href=\"#1ã€åŒæ­¥æ™®é€šæ–¹æ³•\" class=\"headerlink\" title=\"1ã€åŒæ­¥æ™®é€šæ–¹æ³•\"></a><strong>1ã€åŒæ­¥æ™®é€šæ–¹æ³•</strong></h2><p>è¿™ä¸ªä¹Ÿæ˜¯æˆ‘ä»¬ç”¨å¾—æœ€å¤šçš„ï¼Œåªè¦æ¶‰åŠçº¿ç¨‹å®‰å…¨ï¼Œä¸Šæ¥å°±ç»™æ–¹æ³•æ¥ä¸ªåŒæ­¥é”ã€‚è¿™ç§æ–¹æ³•ä½¿ç”¨è™½ç„¶æœ€ç®€å•ï¼Œä½†æ˜¯åªèƒ½ä½œç”¨åœ¨å•ä¾‹ä¸Šé¢ï¼Œå¦‚æœä¸æ˜¯å•ä¾‹ï¼ŒåŒæ­¥æ–¹æ³•é”å°†å¤±æ•ˆã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * ç”¨åœ¨æ™®é€šæ–¹æ³•\n *&#x2F;\nprivate synchronized void synchronizedMethod() &#123;\n\tSystem.out.println(&quot;synchronizedMethod&quot;);\n\ttry &#123;\n\t\tThread.sleep(2000);\n\t&#125; catch (InterruptedException e) &#123;\n\t\te.printStackTrace();\n\t&#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ­¤æ—¶ï¼ŒåŒä¸€ä¸ªå®ä¾‹åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è·å–é”è¿›å…¥è¿™ä¸ªæ–¹æ³•ã€‚</p>\n<h2 id=\"2ã€åŒæ­¥é™æ€æ–¹æ³•\"><a href=\"#2ã€åŒæ­¥é™æ€æ–¹æ³•\" class=\"headerlink\" title=\"2ã€åŒæ­¥é™æ€æ–¹æ³•\"></a>2ã€åŒæ­¥é™æ€æ–¹æ³•</h2><p>åŒæ­¥é™æ€æ–¹æ³•ï¼Œä¸ç®¡ä½ æœ‰å¤šå°‘ä¸ªç±»å®ä¾‹ï¼ŒåŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è·å–é”è¿›å…¥è¿™ä¸ªæ–¹æ³•ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * ç”¨åœ¨é™æ€æ–¹æ³•\n *&#x2F;\nprivate synchronized static void synchronizedStaticMethod() &#123;\n\tSystem.out.println(&quot;synchronizedStaticMethod&quot;);\n\ttry &#123;\n\t\tThread.sleep(2000);\n\t&#125; catch (InterruptedException e) &#123;\n\t\te.printStackTrace();\n\t&#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>åŒæ­¥é™æ€æ–¹æ³•æ˜¯ç±»çº§åˆ«çš„é”ï¼Œä¸€æ—¦ä»»ä½•ä¸€ä¸ªçº¿ç¨‹è¿›å…¥è¿™ä¸ªæ–¹æ³•ï¼Œå…¶ä»–æ‰€æœ‰çº¿ç¨‹å°†æ— æ³•è®¿é—®è¿™ä¸ªç±»çš„ä»»ä½•åŒæ­¥ç±»é”çš„æ–¹æ³•ã€‚</p>\n<h2 id=\"3ã€åŒæ­¥ç±»\"><a href=\"#3ã€åŒæ­¥ç±»\" class=\"headerlink\" title=\"3ã€åŒæ­¥ç±»\"></a>3ã€åŒæ­¥ç±»</h2><p>ä¸‹é¢æä¾›äº†ä¸¤ç§åŒæ­¥ç±»çš„æ–¹æ³•ï¼Œé”ä½æ•ˆæœå’ŒåŒæ­¥é™æ€æ–¹æ³•ä¸€æ ·ï¼Œéƒ½æ˜¯ç±»çº§åˆ«çš„é”ï¼ŒåŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è®¿é—®å¸¦æœ‰åŒæ­¥ç±»é”çš„æ–¹æ³•ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * ç”¨åœ¨ç±»\n *&#x2F;\nprivate void synchronizedClass() &#123;\n\tsynchronized (TestSynchronized.class) &#123;\n\t\tSystem.out.println(&quot;synchronizedClass&quot;);\n\t\ttry &#123;\n\t\t\tThread.sleep(2000);\n\t\t&#125; catch (InterruptedException e) &#123;\n\t\t\te.printStackTrace();\n\t\t&#125;\n\t&#125;\n&#125;\n\n&#x2F;**\n * ç”¨åœ¨ç±»\n *&#x2F;\nprivate void synchronizedGetClass() &#123;\n\tsynchronized (this.getClass()) &#123;\n\t\tSystem.out.println(&quot;synchronizedGetClass&quot;);\n\t\ttry &#123;\n\t\t\tThread.sleep(2000);\n\t\t&#125; catch (InterruptedException e) &#123;\n\t\t\te.printStackTrace();\n\t\t&#125;\n\t&#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™é‡Œçš„ä¸¤ç§ç”¨æ³•æ˜¯åŒæ­¥å—çš„ç”¨æ³•ï¼Œè¿™é‡Œè¡¨ç¤ºåªæœ‰è·å–åˆ°è¿™ä¸ªç±»é”æ‰èƒ½è¿›å…¥è¿™ä¸ªä»£ç å—ã€‚</p>\n<h2 id=\"4ã€åŒæ­¥thiså®ä¾‹\"><a href=\"#4ã€åŒæ­¥thiså®ä¾‹\" class=\"headerlink\" title=\"4ã€åŒæ­¥thiså®ä¾‹\"></a>4ã€åŒæ­¥thiså®ä¾‹</h2><p>è¿™ä¹Ÿæ˜¯åŒæ­¥å—çš„ç”¨æ³•ï¼Œè¡¨ç¤ºé”ä½æ•´ä¸ªå½“å‰å¯¹è±¡å®ä¾‹ï¼Œåªæœ‰è·å–åˆ°è¿™ä¸ªå®ä¾‹çš„é”æ‰èƒ½è¿›å…¥è¿™ä¸ªæ–¹æ³•ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * ç”¨åœ¨this\n *&#x2F;\nprivate void synchronizedThis() &#123;\n\tsynchronized (this) &#123;\n\t\tSystem.out.println(&quot;synchronizedThis&quot;);\n\t\ttry &#123;\n\t\t\tThread.sleep(2000);\n\t\t&#125; catch (InterruptedException e) &#123;\n\t\t\te.printStackTrace();\n\t\t&#125;\n\t&#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç”¨æ³•å’ŒåŒæ­¥æ™®é€šæ–¹æ³•é”ä¸€æ ·ï¼Œéƒ½æ˜¯é”ä½æ•´ä¸ªå½“å‰å®ä¾‹ã€‚</p>\n<h2 id=\"5ã€åŒæ­¥å¯¹è±¡å®ä¾‹\"><a href=\"#5ã€åŒæ­¥å¯¹è±¡å®ä¾‹\" class=\"headerlink\" title=\"5ã€åŒæ­¥å¯¹è±¡å®ä¾‹\"></a>5ã€åŒæ­¥å¯¹è±¡å®ä¾‹</h2><p>è¿™ä¹Ÿæ˜¯åŒæ­¥å—çš„ç”¨æ³•ï¼Œå’Œä¸Šé¢çš„é”ä½å½“å‰å®ä¾‹ä¸€æ ·ï¼Œè¿™é‡Œè¡¨ç¤ºé”ä½æ•´ä¸ª LOCK å¯¹è±¡å®ä¾‹ï¼Œåªæœ‰è·å–åˆ°è¿™ä¸ª LOCK å®ä¾‹çš„é”æ‰èƒ½è¿›å…¥è¿™ä¸ªæ–¹æ³•ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * ç”¨åœ¨å¯¹è±¡\n *&#x2F;\nprivate void synchronizedInstance() &#123;\n\tsynchronized (LOCK) &#123;\n\t\tSystem.out.println(&quot;synchronizedInstance&quot;);\n\t\ttry &#123;\n\t\t\tThread.sleep(2000);\n\t\t&#125; catch (InterruptedException e) &#123;\n\t\t\te.printStackTrace();\n\t\t&#125;\n\t&#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¦å¤–ï¼Œç±»é”ä¸å®ä¾‹é”ä¸ç›¸äº’é˜»å¡ï¼Œä½†ç›¸åŒçš„ç±»é”ï¼Œç›¸åŒçš„å½“å‰å®ä¾‹é”ï¼Œç›¸åŒçš„å¯¹è±¡é”ä¼šç›¸äº’é˜»å¡ã€‚</p>\n<p>å…³äº Synchronized çš„å‡ ç§ç”¨æ³•æ ˆé•¿å°±ä»‹ç»åˆ°è¿™é‡Œäº†ï¼Œå¦‚æœä½ è¿˜çŸ¥é“å…¶ä»–çš„ç”¨æ³•ï¼Œæ¬¢è¿ç•™è¨€ã€‚</p>\n","excerpt":"","more":"<p>æˆ‘ä»¬éƒ½çŸ¥é“ Synchronized æ˜¯çº¿ç¨‹å®‰å…¨åŒæ­¥ç”¨çš„ï¼Œå¤§éƒ¨åˆ†ç¨‹åºå¯èƒ½åªä¼šç”¨åˆ°åŒæ­¥æ–¹æ³•ä¸Šé¢ã€‚å…¶å® Synchronized å¯ä»¥ç”¨åˆ°æ›´å¤šçš„åœºåˆï¼Œæ ˆé•¿åˆ—ä¸¾äº†ä»¥ä¸‹å‡ ä¸ªç”¨æ³•ã€‚</p>\n<h2 id=\"1ã€åŒæ­¥æ™®é€šæ–¹æ³•\"><a href=\"#1ã€åŒæ­¥æ™®é€šæ–¹æ³•\" class=\"headerlink\" title=\"1ã€åŒæ­¥æ™®é€šæ–¹æ³•\"></a><strong>1ã€åŒæ­¥æ™®é€šæ–¹æ³•</strong></h2><p>è¿™ä¸ªä¹Ÿæ˜¯æˆ‘ä»¬ç”¨å¾—æœ€å¤šçš„ï¼Œåªè¦æ¶‰åŠçº¿ç¨‹å®‰å…¨ï¼Œä¸Šæ¥å°±ç»™æ–¹æ³•æ¥ä¸ªåŒæ­¥é”ã€‚è¿™ç§æ–¹æ³•ä½¿ç”¨è™½ç„¶æœ€ç®€å•ï¼Œä½†æ˜¯åªèƒ½ä½œç”¨åœ¨å•ä¾‹ä¸Šé¢ï¼Œå¦‚æœä¸æ˜¯å•ä¾‹ï¼ŒåŒæ­¥æ–¹æ³•é”å°†å¤±æ•ˆã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * ç”¨åœ¨æ™®é€šæ–¹æ³•\n *&#x2F;\nprivate synchronized void synchronizedMethod() &#123;\n\tSystem.out.println(&quot;synchronizedMethod&quot;);\n\ttry &#123;\n\t\tThread.sleep(2000);\n\t&#125; catch (InterruptedException e) &#123;\n\t\te.printStackTrace();\n\t&#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ­¤æ—¶ï¼ŒåŒä¸€ä¸ªå®ä¾‹åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è·å–é”è¿›å…¥è¿™ä¸ªæ–¹æ³•ã€‚</p>\n<h2 id=\"2ã€åŒæ­¥é™æ€æ–¹æ³•\"><a href=\"#2ã€åŒæ­¥é™æ€æ–¹æ³•\" class=\"headerlink\" title=\"2ã€åŒæ­¥é™æ€æ–¹æ³•\"></a>2ã€åŒæ­¥é™æ€æ–¹æ³•</h2><p>åŒæ­¥é™æ€æ–¹æ³•ï¼Œä¸ç®¡ä½ æœ‰å¤šå°‘ä¸ªç±»å®ä¾‹ï¼ŒåŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è·å–é”è¿›å…¥è¿™ä¸ªæ–¹æ³•ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * ç”¨åœ¨é™æ€æ–¹æ³•\n *&#x2F;\nprivate synchronized static void synchronizedStaticMethod() &#123;\n\tSystem.out.println(&quot;synchronizedStaticMethod&quot;);\n\ttry &#123;\n\t\tThread.sleep(2000);\n\t&#125; catch (InterruptedException e) &#123;\n\t\te.printStackTrace();\n\t&#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>åŒæ­¥é™æ€æ–¹æ³•æ˜¯ç±»çº§åˆ«çš„é”ï¼Œä¸€æ—¦ä»»ä½•ä¸€ä¸ªçº¿ç¨‹è¿›å…¥è¿™ä¸ªæ–¹æ³•ï¼Œå…¶ä»–æ‰€æœ‰çº¿ç¨‹å°†æ— æ³•è®¿é—®è¿™ä¸ªç±»çš„ä»»ä½•åŒæ­¥ç±»é”çš„æ–¹æ³•ã€‚</p>\n<h2 id=\"3ã€åŒæ­¥ç±»\"><a href=\"#3ã€åŒæ­¥ç±»\" class=\"headerlink\" title=\"3ã€åŒæ­¥ç±»\"></a>3ã€åŒæ­¥ç±»</h2><p>ä¸‹é¢æä¾›äº†ä¸¤ç§åŒæ­¥ç±»çš„æ–¹æ³•ï¼Œé”ä½æ•ˆæœå’ŒåŒæ­¥é™æ€æ–¹æ³•ä¸€æ ·ï¼Œéƒ½æ˜¯ç±»çº§åˆ«çš„é”ï¼ŒåŒæ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½è®¿é—®å¸¦æœ‰åŒæ­¥ç±»é”çš„æ–¹æ³•ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * ç”¨åœ¨ç±»\n *&#x2F;\nprivate void synchronizedClass() &#123;\n\tsynchronized (TestSynchronized.class) &#123;\n\t\tSystem.out.println(&quot;synchronizedClass&quot;);\n\t\ttry &#123;\n\t\t\tThread.sleep(2000);\n\t\t&#125; catch (InterruptedException e) &#123;\n\t\t\te.printStackTrace();\n\t\t&#125;\n\t&#125;\n&#125;\n\n&#x2F;**\n * ç”¨åœ¨ç±»\n *&#x2F;\nprivate void synchronizedGetClass() &#123;\n\tsynchronized (this.getClass()) &#123;\n\t\tSystem.out.println(&quot;synchronizedGetClass&quot;);\n\t\ttry &#123;\n\t\t\tThread.sleep(2000);\n\t\t&#125; catch (InterruptedException e) &#123;\n\t\t\te.printStackTrace();\n\t\t&#125;\n\t&#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™é‡Œçš„ä¸¤ç§ç”¨æ³•æ˜¯åŒæ­¥å—çš„ç”¨æ³•ï¼Œè¿™é‡Œè¡¨ç¤ºåªæœ‰è·å–åˆ°è¿™ä¸ªç±»é”æ‰èƒ½è¿›å…¥è¿™ä¸ªä»£ç å—ã€‚</p>\n<h2 id=\"4ã€åŒæ­¥thiså®ä¾‹\"><a href=\"#4ã€åŒæ­¥thiså®ä¾‹\" class=\"headerlink\" title=\"4ã€åŒæ­¥thiså®ä¾‹\"></a>4ã€åŒæ­¥thiså®ä¾‹</h2><p>è¿™ä¹Ÿæ˜¯åŒæ­¥å—çš„ç”¨æ³•ï¼Œè¡¨ç¤ºé”ä½æ•´ä¸ªå½“å‰å¯¹è±¡å®ä¾‹ï¼Œåªæœ‰è·å–åˆ°è¿™ä¸ªå®ä¾‹çš„é”æ‰èƒ½è¿›å…¥è¿™ä¸ªæ–¹æ³•ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * ç”¨åœ¨this\n *&#x2F;\nprivate void synchronizedThis() &#123;\n\tsynchronized (this) &#123;\n\t\tSystem.out.println(&quot;synchronizedThis&quot;);\n\t\ttry &#123;\n\t\t\tThread.sleep(2000);\n\t\t&#125; catch (InterruptedException e) &#123;\n\t\t\te.printStackTrace();\n\t\t&#125;\n\t&#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç”¨æ³•å’ŒåŒæ­¥æ™®é€šæ–¹æ³•é”ä¸€æ ·ï¼Œéƒ½æ˜¯é”ä½æ•´ä¸ªå½“å‰å®ä¾‹ã€‚</p>\n<h2 id=\"5ã€åŒæ­¥å¯¹è±¡å®ä¾‹\"><a href=\"#5ã€åŒæ­¥å¯¹è±¡å®ä¾‹\" class=\"headerlink\" title=\"5ã€åŒæ­¥å¯¹è±¡å®ä¾‹\"></a>5ã€åŒæ­¥å¯¹è±¡å®ä¾‹</h2><p>è¿™ä¹Ÿæ˜¯åŒæ­¥å—çš„ç”¨æ³•ï¼Œå’Œä¸Šé¢çš„é”ä½å½“å‰å®ä¾‹ä¸€æ ·ï¼Œè¿™é‡Œè¡¨ç¤ºé”ä½æ•´ä¸ª LOCK å¯¹è±¡å®ä¾‹ï¼Œåªæœ‰è·å–åˆ°è¿™ä¸ª LOCK å®ä¾‹çš„é”æ‰èƒ½è¿›å…¥è¿™ä¸ªæ–¹æ³•ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * ç”¨åœ¨å¯¹è±¡\n *&#x2F;\nprivate void synchronizedInstance() &#123;\n\tsynchronized (LOCK) &#123;\n\t\tSystem.out.println(&quot;synchronizedInstance&quot;);\n\t\ttry &#123;\n\t\t\tThread.sleep(2000);\n\t\t&#125; catch (InterruptedException e) &#123;\n\t\t\te.printStackTrace();\n\t\t&#125;\n\t&#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¦å¤–ï¼Œç±»é”ä¸å®ä¾‹é”ä¸ç›¸äº’é˜»å¡ï¼Œä½†ç›¸åŒçš„ç±»é”ï¼Œç›¸åŒçš„å½“å‰å®ä¾‹é”ï¼Œç›¸åŒçš„å¯¹è±¡é”ä¼šç›¸äº’é˜»å¡ã€‚</p>\n<p>å…³äº Synchronized çš„å‡ ç§ç”¨æ³•æ ˆé•¿å°±ä»‹ç»åˆ°è¿™é‡Œäº†ï¼Œå¦‚æœä½ è¿˜çŸ¥é“å…¶ä»–çš„ç”¨æ³•ï¼Œæ¬¢è¿ç•™è¨€ã€‚</p>\n"},{"title":"i++æ˜¯çº¿ç¨‹å®‰å…¨çš„å—?","date":"2025-10-14T01:33:33.000Z","_content":"\n![](http://img.javastack.cn/18-6-8/12258861.jpg)\n\n**i++ æ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ**\n\nç›¸ä¿¡å¾ˆå¤šä¸­é«˜çº§çš„ Java é¢è¯•è€…éƒ½é‡åˆ°è¿‡è¿™ä¸ªé—®é¢˜ï¼Œå¾ˆå¤šå¯¹è¿™ä¸ªä¸æ˜¯å¾ˆæ¸…æ¥šçš„è‚¯å®šæ˜¯ä¸€è„¸è’™é€¼ã€‚å†…å¿ƒè‚¯å®šè¿˜åœ¨è´¨ç–‘ï¼Œi++ å±…ç„¶è¿˜æœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Ÿåªèƒ½è¯´è‡ªå·±äº†è§£çš„ä¸å¤Ÿå¤šï¼Œè‡ªå·±çš„æ°´å¹³æœ‰é™ã€‚\n\nå…ˆæ¥çœ‹ä¸‹é¢çš„ç¤ºä¾‹æ¥éªŒè¯ä¸‹ i++ åˆ°åº•æ˜¯ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚\n\n**1000ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡ count è¿›è¡Œ 1000 æ¬¡ ++ æ“ä½œã€‚**\n\n```\nstatic int count = 0;\n\nstatic CountDownLatch cdl = new CountDownLatch(1000);\n\n/**\n* \n*/\npublic static void main(String[] args) throws Exception {\n\tCountRunnable countRunnable = new CountRunnable();\n\tfor (int i = 0; i < 1000; i++) {\n\t\tnew Thread(countRunnable).start();\n\t}\n\tcdl.await();\n\tSystem.out.println(count);\n}\n\nstatic class CountRunnable implements Runnable {\n\n\tprivate void count() {\n\t\tfor (int i = 0; i < 1000; i++) {\n\t\t\tcount++;\n\t\t}\n\t}\n\n\t@Override\n\tpublic void run() {\n\t\tcount();\n\t\tcdl.countDown();\n\t}\n\n}\n```\n\nä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬æœŸæœ›çš„ç»“æœåº”è¯¥æ˜¯ 1000000ï¼Œä½†è¿è¡Œ N éï¼Œä½ ä¼šå‘ç°æ€»æ˜¯ä¸ä¸º 1000000ï¼Œè‡³å°‘ä½ ç°åœ¨çŸ¥é“äº† i++ æ“ä½œå®ƒä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„äº†ã€‚\n\nå…ˆæ¥çœ‹ JMM æ¨¡å‹ä¸­å¯¹å…±äº«å˜é‡çš„è¯»å†™åŸç†å§ã€‚\n\n![](http://img.javastack.cn/18-6-8/60972585.jpg)\n\næ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„å·¥ä½œå†…å­˜ï¼Œæ¯ä¸ªçº¿ç¨‹éœ€è¦å¯¹å…±äº«å˜é‡æ“ä½œæ—¶å¿…é¡»å…ˆæŠŠå…±äº«å˜é‡ä»ä¸»å†…å­˜ load åˆ°è‡ªå·±çš„å·¥ä½œå†…å­˜ï¼Œç­‰å®Œæˆå¯¹å…±äº«å˜é‡çš„æ“ä½œæ—¶å† save åˆ°ä¸»å†…å­˜ã€‚\n\né—®é¢˜å°±å‡ºåœ¨è¿™äº†ï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹è¿ç®—å®Œåè¿˜æ²¡åˆ·åˆ°ä¸»å†…å­˜ï¼Œæ­¤æ—¶è¿™ä¸ªå…±äº«å˜é‡çš„å€¼è¢«å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä»ä¸»å†…å­˜è¯»å–åˆ°äº†ï¼Œè¿™ä¸ªæ—¶å€™è¯»å–çš„æ•°æ®å°±æ˜¯è„æ•°æ®äº†ï¼Œå®ƒä¼šè¦†ç›–å…¶ä»–çº¿ç¨‹è®¡ç®—å®Œçš„å€¼ã€‚ã€‚ã€‚\n\n**è¿™ä¹Ÿæ˜¯ç»å…¸çš„å†…å­˜ä¸å¯è§é—®é¢˜ï¼Œé‚£ä¹ˆæŠŠ count åŠ ä¸Š volatile è®©å†…å­˜å¯è§æ˜¯å¦èƒ½è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ** ç­”æ¡ˆæ˜¯ï¼šä¸èƒ½ã€‚å› ä¸º volatile åªèƒ½ä¿è¯å¯è§æ€§ï¼Œä¸èƒ½ä¿è¯åŸå­æ€§ã€‚å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å–è¿™ä¸ªå…±äº«å˜é‡çš„å€¼ï¼Œå°±ç®—ä¿è¯å…¶ä»–çº¿ç¨‹ä¿®æ”¹çš„å¯è§æ€§ï¼Œä¹Ÿä¸èƒ½ä¿è¯çº¿ç¨‹ä¹‹é—´è¯»å–åˆ°åŒæ ·çš„å€¼ç„¶åç›¸äº’è¦†ç›–å¯¹æ–¹çš„å€¼çš„æƒ…å†µã€‚\n\nå…³äºå¤šçº¿ç¨‹çš„å‡ ç§å…³é”®æ¦‚å¿µè¯·ç¿»é˜…ã€Š[å¤šçº¿ç¨‹ä¹‹åŸå­æ€§ã€å¯è§æ€§ã€æœ‰åºæ€§è¯¦è§£](https://mp.weixin.qq.com/s/DWaxnysIQ8NSWN1NME_HvA)ã€‹è¿™ç¯‡æ–‡ç« ã€‚\n\n#### è§£å†³æ–¹æ¡ˆ\n\nè¯´äº†è¿™ä¹ˆå¤šï¼Œå¯¹äº i++ è¿™ç§çº¿ç¨‹ä¸å®‰å…¨é—®é¢˜æœ‰æ²¡æœ‰å…¶ä»–è§£å†³æ–¹æ¡ˆå‘¢ï¼Ÿå½“ç„¶æœ‰ï¼Œè¯·å‚è€ƒä»¥ä¸‹å‡ ç§è§£å†³æ–¹æ¡ˆã€‚\n\n1ã€å¯¹ i++ æ“ä½œçš„æ–¹æ³•åŠ åŒæ­¥é”ï¼ŒåŒæ—¶åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ i++ æ“ä½œï¼›\n\n2ã€ä½¿ç”¨æ”¯æŒåŸå­æ€§æ“ä½œçš„ç±»ï¼Œå¦‚ `java.util.concurrent.atomic.AtomicInteger`ï¼Œå®ƒä½¿ç”¨çš„æ˜¯ CAS ç®—æ³•ï¼Œæ•ˆç‡ä¼˜äºç¬¬ 1 ç§ï¼›\n\nå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ï¼Œç‚¹ä¸ªèµåˆ†äº«ä¸‹ç»™ä¸ªé¼“åŠ±å§ï¼\n","source":"_posts/å¤šçº¿ç¨‹/i++æ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ.md","raw":"---\ntitle: i++æ˜¯çº¿ç¨‹å®‰å…¨çš„å—?\ndate: 2025-10-14 09:33:33\ncategory: åç«¯\ntags: å¤šçº¿ç¨‹\n---\n\n![](http://img.javastack.cn/18-6-8/12258861.jpg)\n\n**i++ æ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ**\n\nç›¸ä¿¡å¾ˆå¤šä¸­é«˜çº§çš„ Java é¢è¯•è€…éƒ½é‡åˆ°è¿‡è¿™ä¸ªé—®é¢˜ï¼Œå¾ˆå¤šå¯¹è¿™ä¸ªä¸æ˜¯å¾ˆæ¸…æ¥šçš„è‚¯å®šæ˜¯ä¸€è„¸è’™é€¼ã€‚å†…å¿ƒè‚¯å®šè¿˜åœ¨è´¨ç–‘ï¼Œi++ å±…ç„¶è¿˜æœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Ÿåªèƒ½è¯´è‡ªå·±äº†è§£çš„ä¸å¤Ÿå¤šï¼Œè‡ªå·±çš„æ°´å¹³æœ‰é™ã€‚\n\nå…ˆæ¥çœ‹ä¸‹é¢çš„ç¤ºä¾‹æ¥éªŒè¯ä¸‹ i++ åˆ°åº•æ˜¯ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚\n\n**1000ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡ count è¿›è¡Œ 1000 æ¬¡ ++ æ“ä½œã€‚**\n\n```\nstatic int count = 0;\n\nstatic CountDownLatch cdl = new CountDownLatch(1000);\n\n/**\n* \n*/\npublic static void main(String[] args) throws Exception {\n\tCountRunnable countRunnable = new CountRunnable();\n\tfor (int i = 0; i < 1000; i++) {\n\t\tnew Thread(countRunnable).start();\n\t}\n\tcdl.await();\n\tSystem.out.println(count);\n}\n\nstatic class CountRunnable implements Runnable {\n\n\tprivate void count() {\n\t\tfor (int i = 0; i < 1000; i++) {\n\t\t\tcount++;\n\t\t}\n\t}\n\n\t@Override\n\tpublic void run() {\n\t\tcount();\n\t\tcdl.countDown();\n\t}\n\n}\n```\n\nä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬æœŸæœ›çš„ç»“æœåº”è¯¥æ˜¯ 1000000ï¼Œä½†è¿è¡Œ N éï¼Œä½ ä¼šå‘ç°æ€»æ˜¯ä¸ä¸º 1000000ï¼Œè‡³å°‘ä½ ç°åœ¨çŸ¥é“äº† i++ æ“ä½œå®ƒä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„äº†ã€‚\n\nå…ˆæ¥çœ‹ JMM æ¨¡å‹ä¸­å¯¹å…±äº«å˜é‡çš„è¯»å†™åŸç†å§ã€‚\n\n![](http://img.javastack.cn/18-6-8/60972585.jpg)\n\næ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„å·¥ä½œå†…å­˜ï¼Œæ¯ä¸ªçº¿ç¨‹éœ€è¦å¯¹å…±äº«å˜é‡æ“ä½œæ—¶å¿…é¡»å…ˆæŠŠå…±äº«å˜é‡ä»ä¸»å†…å­˜ load åˆ°è‡ªå·±çš„å·¥ä½œå†…å­˜ï¼Œç­‰å®Œæˆå¯¹å…±äº«å˜é‡çš„æ“ä½œæ—¶å† save åˆ°ä¸»å†…å­˜ã€‚\n\né—®é¢˜å°±å‡ºåœ¨è¿™äº†ï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹è¿ç®—å®Œåè¿˜æ²¡åˆ·åˆ°ä¸»å†…å­˜ï¼Œæ­¤æ—¶è¿™ä¸ªå…±äº«å˜é‡çš„å€¼è¢«å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä»ä¸»å†…å­˜è¯»å–åˆ°äº†ï¼Œè¿™ä¸ªæ—¶å€™è¯»å–çš„æ•°æ®å°±æ˜¯è„æ•°æ®äº†ï¼Œå®ƒä¼šè¦†ç›–å…¶ä»–çº¿ç¨‹è®¡ç®—å®Œçš„å€¼ã€‚ã€‚ã€‚\n\n**è¿™ä¹Ÿæ˜¯ç»å…¸çš„å†…å­˜ä¸å¯è§é—®é¢˜ï¼Œé‚£ä¹ˆæŠŠ count åŠ ä¸Š volatile è®©å†…å­˜å¯è§æ˜¯å¦èƒ½è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ** ç­”æ¡ˆæ˜¯ï¼šä¸èƒ½ã€‚å› ä¸º volatile åªèƒ½ä¿è¯å¯è§æ€§ï¼Œä¸èƒ½ä¿è¯åŸå­æ€§ã€‚å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å–è¿™ä¸ªå…±äº«å˜é‡çš„å€¼ï¼Œå°±ç®—ä¿è¯å…¶ä»–çº¿ç¨‹ä¿®æ”¹çš„å¯è§æ€§ï¼Œä¹Ÿä¸èƒ½ä¿è¯çº¿ç¨‹ä¹‹é—´è¯»å–åˆ°åŒæ ·çš„å€¼ç„¶åç›¸äº’è¦†ç›–å¯¹æ–¹çš„å€¼çš„æƒ…å†µã€‚\n\nå…³äºå¤šçº¿ç¨‹çš„å‡ ç§å…³é”®æ¦‚å¿µè¯·ç¿»é˜…ã€Š[å¤šçº¿ç¨‹ä¹‹åŸå­æ€§ã€å¯è§æ€§ã€æœ‰åºæ€§è¯¦è§£](https://mp.weixin.qq.com/s/DWaxnysIQ8NSWN1NME_HvA)ã€‹è¿™ç¯‡æ–‡ç« ã€‚\n\n#### è§£å†³æ–¹æ¡ˆ\n\nè¯´äº†è¿™ä¹ˆå¤šï¼Œå¯¹äº i++ è¿™ç§çº¿ç¨‹ä¸å®‰å…¨é—®é¢˜æœ‰æ²¡æœ‰å…¶ä»–è§£å†³æ–¹æ¡ˆå‘¢ï¼Ÿå½“ç„¶æœ‰ï¼Œè¯·å‚è€ƒä»¥ä¸‹å‡ ç§è§£å†³æ–¹æ¡ˆã€‚\n\n1ã€å¯¹ i++ æ“ä½œçš„æ–¹æ³•åŠ åŒæ­¥é”ï¼ŒåŒæ—¶åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ i++ æ“ä½œï¼›\n\n2ã€ä½¿ç”¨æ”¯æŒåŸå­æ€§æ“ä½œçš„ç±»ï¼Œå¦‚ `java.util.concurrent.atomic.AtomicInteger`ï¼Œå®ƒä½¿ç”¨çš„æ˜¯ CAS ç®—æ³•ï¼Œæ•ˆç‡ä¼˜äºç¬¬ 1 ç§ï¼›\n\nå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ï¼Œç‚¹ä¸ªèµåˆ†äº«ä¸‹ç»™ä¸ªé¼“åŠ±å§ï¼\n","slug":"å¤šçº¿ç¨‹/i++æ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ","published":1,"updated":"2025-10-15T07:20:25.069Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076n0025qkd40r4ecb2t","content":"<p><img src=\"http://img.javastack.cn/18-6-8/12258861.jpg\"></p>\n<p><strong>i++ æ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ</strong></p>\n<p>ç›¸ä¿¡å¾ˆå¤šä¸­é«˜çº§çš„ Java é¢è¯•è€…éƒ½é‡åˆ°è¿‡è¿™ä¸ªé—®é¢˜ï¼Œå¾ˆå¤šå¯¹è¿™ä¸ªä¸æ˜¯å¾ˆæ¸…æ¥šçš„è‚¯å®šæ˜¯ä¸€è„¸è’™é€¼ã€‚å†…å¿ƒè‚¯å®šè¿˜åœ¨è´¨ç–‘ï¼Œi++ å±…ç„¶è¿˜æœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Ÿåªèƒ½è¯´è‡ªå·±äº†è§£çš„ä¸å¤Ÿå¤šï¼Œè‡ªå·±çš„æ°´å¹³æœ‰é™ã€‚</p>\n<p>å…ˆæ¥çœ‹ä¸‹é¢çš„ç¤ºä¾‹æ¥éªŒè¯ä¸‹ i++ åˆ°åº•æ˜¯ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p>\n<p><strong>1000ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡ count è¿›è¡Œ 1000 æ¬¡ ++ æ“ä½œã€‚</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">static int count &#x3D; 0;\n\nstatic CountDownLatch cdl &#x3D; new CountDownLatch(1000);\n\n&#x2F;**\n* \n*&#x2F;\npublic static void main(String[] args) throws Exception &#123;\n\tCountRunnable countRunnable &#x3D; new CountRunnable();\n\tfor (int i &#x3D; 0; i &lt; 1000; i++) &#123;\n\t\tnew Thread(countRunnable).start();\n\t&#125;\n\tcdl.await();\n\tSystem.out.println(count);\n&#125;\n\nstatic class CountRunnable implements Runnable &#123;\n\n\tprivate void count() &#123;\n\t\tfor (int i &#x3D; 0; i &lt; 1000; i++) &#123;\n\t\t\tcount++;\n\t\t&#125;\n\t&#125;\n\n\t@Override\n\tpublic void run() &#123;\n\t\tcount();\n\t\tcdl.countDown();\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬æœŸæœ›çš„ç»“æœåº”è¯¥æ˜¯ 1000000ï¼Œä½†è¿è¡Œ N éï¼Œä½ ä¼šå‘ç°æ€»æ˜¯ä¸ä¸º 1000000ï¼Œè‡³å°‘ä½ ç°åœ¨çŸ¥é“äº† i++ æ“ä½œå®ƒä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„äº†ã€‚</p>\n<p>å…ˆæ¥çœ‹ JMM æ¨¡å‹ä¸­å¯¹å…±äº«å˜é‡çš„è¯»å†™åŸç†å§ã€‚</p>\n<p><img src=\"http://img.javastack.cn/18-6-8/60972585.jpg\"></p>\n<p>æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„å·¥ä½œå†…å­˜ï¼Œæ¯ä¸ªçº¿ç¨‹éœ€è¦å¯¹å…±äº«å˜é‡æ“ä½œæ—¶å¿…é¡»å…ˆæŠŠå…±äº«å˜é‡ä»ä¸»å†…å­˜ load åˆ°è‡ªå·±çš„å·¥ä½œå†…å­˜ï¼Œç­‰å®Œæˆå¯¹å…±äº«å˜é‡çš„æ“ä½œæ—¶å† save åˆ°ä¸»å†…å­˜ã€‚</p>\n<p>é—®é¢˜å°±å‡ºåœ¨è¿™äº†ï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹è¿ç®—å®Œåè¿˜æ²¡åˆ·åˆ°ä¸»å†…å­˜ï¼Œæ­¤æ—¶è¿™ä¸ªå…±äº«å˜é‡çš„å€¼è¢«å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä»ä¸»å†…å­˜è¯»å–åˆ°äº†ï¼Œè¿™ä¸ªæ—¶å€™è¯»å–çš„æ•°æ®å°±æ˜¯è„æ•°æ®äº†ï¼Œå®ƒä¼šè¦†ç›–å…¶ä»–çº¿ç¨‹è®¡ç®—å®Œçš„å€¼ã€‚ã€‚ã€‚</p>\n<p><strong>è¿™ä¹Ÿæ˜¯ç»å…¸çš„å†…å­˜ä¸å¯è§é—®é¢˜ï¼Œé‚£ä¹ˆæŠŠ count åŠ ä¸Š volatile è®©å†…å­˜å¯è§æ˜¯å¦èƒ½è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</strong> ç­”æ¡ˆæ˜¯ï¼šä¸èƒ½ã€‚å› ä¸º volatile åªèƒ½ä¿è¯å¯è§æ€§ï¼Œä¸èƒ½ä¿è¯åŸå­æ€§ã€‚å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å–è¿™ä¸ªå…±äº«å˜é‡çš„å€¼ï¼Œå°±ç®—ä¿è¯å…¶ä»–çº¿ç¨‹ä¿®æ”¹çš„å¯è§æ€§ï¼Œä¹Ÿä¸èƒ½ä¿è¯çº¿ç¨‹ä¹‹é—´è¯»å–åˆ°åŒæ ·çš„å€¼ç„¶åç›¸äº’è¦†ç›–å¯¹æ–¹çš„å€¼çš„æƒ…å†µã€‚</p>\n<p>å…³äºå¤šçº¿ç¨‹çš„å‡ ç§å…³é”®æ¦‚å¿µè¯·ç¿»é˜…ã€Š<a href=\"https://mp.weixin.qq.com/s/DWaxnysIQ8NSWN1NME_HvA\">å¤šçº¿ç¨‹ä¹‹åŸå­æ€§ã€å¯è§æ€§ã€æœ‰åºæ€§è¯¦è§£</a>ã€‹è¿™ç¯‡æ–‡ç« ã€‚</p>\n<h4 id=\"è§£å†³æ–¹æ¡ˆ\"><a href=\"#è§£å†³æ–¹æ¡ˆ\" class=\"headerlink\" title=\"è§£å†³æ–¹æ¡ˆ\"></a>è§£å†³æ–¹æ¡ˆ</h4><p>è¯´äº†è¿™ä¹ˆå¤šï¼Œå¯¹äº i++ è¿™ç§çº¿ç¨‹ä¸å®‰å…¨é—®é¢˜æœ‰æ²¡æœ‰å…¶ä»–è§£å†³æ–¹æ¡ˆå‘¢ï¼Ÿå½“ç„¶æœ‰ï¼Œè¯·å‚è€ƒä»¥ä¸‹å‡ ç§è§£å†³æ–¹æ¡ˆã€‚</p>\n<p>1ã€å¯¹ i++ æ“ä½œçš„æ–¹æ³•åŠ åŒæ­¥é”ï¼ŒåŒæ—¶åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ i++ æ“ä½œï¼›</p>\n<p>2ã€ä½¿ç”¨æ”¯æŒåŸå­æ€§æ“ä½œçš„ç±»ï¼Œå¦‚ <code>java.util.concurrent.atomic.AtomicInteger</code>ï¼Œå®ƒä½¿ç”¨çš„æ˜¯ CAS ç®—æ³•ï¼Œæ•ˆç‡ä¼˜äºç¬¬ 1 ç§ï¼›</p>\n<p>å¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ï¼Œç‚¹ä¸ªèµåˆ†äº«ä¸‹ç»™ä¸ªé¼“åŠ±å§ï¼</p>\n","excerpt":"","more":"<p><img src=\"http://img.javastack.cn/18-6-8/12258861.jpg\"></p>\n<p><strong>i++ æ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ</strong></p>\n<p>ç›¸ä¿¡å¾ˆå¤šä¸­é«˜çº§çš„ Java é¢è¯•è€…éƒ½é‡åˆ°è¿‡è¿™ä¸ªé—®é¢˜ï¼Œå¾ˆå¤šå¯¹è¿™ä¸ªä¸æ˜¯å¾ˆæ¸…æ¥šçš„è‚¯å®šæ˜¯ä¸€è„¸è’™é€¼ã€‚å†…å¿ƒè‚¯å®šè¿˜åœ¨è´¨ç–‘ï¼Œi++ å±…ç„¶è¿˜æœ‰çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Ÿåªèƒ½è¯´è‡ªå·±äº†è§£çš„ä¸å¤Ÿå¤šï¼Œè‡ªå·±çš„æ°´å¹³æœ‰é™ã€‚</p>\n<p>å…ˆæ¥çœ‹ä¸‹é¢çš„ç¤ºä¾‹æ¥éªŒè¯ä¸‹ i++ åˆ°åº•æ˜¯ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p>\n<p><strong>1000ä¸ªçº¿ç¨‹ï¼Œæ¯ä¸ªçº¿ç¨‹å¯¹å…±äº«å˜é‡ count è¿›è¡Œ 1000 æ¬¡ ++ æ“ä½œã€‚</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">static int count &#x3D; 0;\n\nstatic CountDownLatch cdl &#x3D; new CountDownLatch(1000);\n\n&#x2F;**\n* \n*&#x2F;\npublic static void main(String[] args) throws Exception &#123;\n\tCountRunnable countRunnable &#x3D; new CountRunnable();\n\tfor (int i &#x3D; 0; i &lt; 1000; i++) &#123;\n\t\tnew Thread(countRunnable).start();\n\t&#125;\n\tcdl.await();\n\tSystem.out.println(count);\n&#125;\n\nstatic class CountRunnable implements Runnable &#123;\n\n\tprivate void count() &#123;\n\t\tfor (int i &#x3D; 0; i &lt; 1000; i++) &#123;\n\t\t\tcount++;\n\t\t&#125;\n\t&#125;\n\n\t@Override\n\tpublic void run() &#123;\n\t\tcount();\n\t\tcdl.countDown();\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä¸Šé¢çš„ä¾‹å­æˆ‘ä»¬æœŸæœ›çš„ç»“æœåº”è¯¥æ˜¯ 1000000ï¼Œä½†è¿è¡Œ N éï¼Œä½ ä¼šå‘ç°æ€»æ˜¯ä¸ä¸º 1000000ï¼Œè‡³å°‘ä½ ç°åœ¨çŸ¥é“äº† i++ æ“ä½œå®ƒä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„äº†ã€‚</p>\n<p>å…ˆæ¥çœ‹ JMM æ¨¡å‹ä¸­å¯¹å…±äº«å˜é‡çš„è¯»å†™åŸç†å§ã€‚</p>\n<p><img src=\"http://img.javastack.cn/18-6-8/60972585.jpg\"></p>\n<p>æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„å·¥ä½œå†…å­˜ï¼Œæ¯ä¸ªçº¿ç¨‹éœ€è¦å¯¹å…±äº«å˜é‡æ“ä½œæ—¶å¿…é¡»å…ˆæŠŠå…±äº«å˜é‡ä»ä¸»å†…å­˜ load åˆ°è‡ªå·±çš„å·¥ä½œå†…å­˜ï¼Œç­‰å®Œæˆå¯¹å…±äº«å˜é‡çš„æ“ä½œæ—¶å† save åˆ°ä¸»å†…å­˜ã€‚</p>\n<p>é—®é¢˜å°±å‡ºåœ¨è¿™äº†ï¼Œå¦‚æœä¸€ä¸ªçº¿ç¨‹è¿ç®—å®Œåè¿˜æ²¡åˆ·åˆ°ä¸»å†…å­˜ï¼Œæ­¤æ—¶è¿™ä¸ªå…±äº«å˜é‡çš„å€¼è¢«å¦å¤–ä¸€ä¸ªçº¿ç¨‹ä»ä¸»å†…å­˜è¯»å–åˆ°äº†ï¼Œè¿™ä¸ªæ—¶å€™è¯»å–çš„æ•°æ®å°±æ˜¯è„æ•°æ®äº†ï¼Œå®ƒä¼šè¦†ç›–å…¶ä»–çº¿ç¨‹è®¡ç®—å®Œçš„å€¼ã€‚ã€‚ã€‚</p>\n<p><strong>è¿™ä¹Ÿæ˜¯ç»å…¸çš„å†…å­˜ä¸å¯è§é—®é¢˜ï¼Œé‚£ä¹ˆæŠŠ count åŠ ä¸Š volatile è®©å†…å­˜å¯è§æ˜¯å¦èƒ½è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿ</strong> ç­”æ¡ˆæ˜¯ï¼šä¸èƒ½ã€‚å› ä¸º volatile åªèƒ½ä¿è¯å¯è§æ€§ï¼Œä¸èƒ½ä¿è¯åŸå­æ€§ã€‚å¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å–è¿™ä¸ªå…±äº«å˜é‡çš„å€¼ï¼Œå°±ç®—ä¿è¯å…¶ä»–çº¿ç¨‹ä¿®æ”¹çš„å¯è§æ€§ï¼Œä¹Ÿä¸èƒ½ä¿è¯çº¿ç¨‹ä¹‹é—´è¯»å–åˆ°åŒæ ·çš„å€¼ç„¶åç›¸äº’è¦†ç›–å¯¹æ–¹çš„å€¼çš„æƒ…å†µã€‚</p>\n<p>å…³äºå¤šçº¿ç¨‹çš„å‡ ç§å…³é”®æ¦‚å¿µè¯·ç¿»é˜…ã€Š<a href=\"https://mp.weixin.qq.com/s/DWaxnysIQ8NSWN1NME_HvA\">å¤šçº¿ç¨‹ä¹‹åŸå­æ€§ã€å¯è§æ€§ã€æœ‰åºæ€§è¯¦è§£</a>ã€‹è¿™ç¯‡æ–‡ç« ã€‚</p>\n<h4 id=\"è§£å†³æ–¹æ¡ˆ\"><a href=\"#è§£å†³æ–¹æ¡ˆ\" class=\"headerlink\" title=\"è§£å†³æ–¹æ¡ˆ\"></a>è§£å†³æ–¹æ¡ˆ</h4><p>è¯´äº†è¿™ä¹ˆå¤šï¼Œå¯¹äº i++ è¿™ç§çº¿ç¨‹ä¸å®‰å…¨é—®é¢˜æœ‰æ²¡æœ‰å…¶ä»–è§£å†³æ–¹æ¡ˆå‘¢ï¼Ÿå½“ç„¶æœ‰ï¼Œè¯·å‚è€ƒä»¥ä¸‹å‡ ç§è§£å†³æ–¹æ¡ˆã€‚</p>\n<p>1ã€å¯¹ i++ æ“ä½œçš„æ–¹æ³•åŠ åŒæ­¥é”ï¼ŒåŒæ—¶åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œ i++ æ“ä½œï¼›</p>\n<p>2ã€ä½¿ç”¨æ”¯æŒåŸå­æ€§æ“ä½œçš„ç±»ï¼Œå¦‚ <code>java.util.concurrent.atomic.AtomicInteger</code>ï¼Œå®ƒä½¿ç”¨çš„æ˜¯ CAS ç®—æ³•ï¼Œæ•ˆç‡ä¼˜äºç¬¬ 1 ç§ï¼›</p>\n<p>å¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ï¼Œç‚¹ä¸ªèµåˆ†äº«ä¸‹ç»™ä¸ªé¼“åŠ±å§ï¼</p>\n"},{"title":"sleep( )å’Œwait( )çš„è¿™5ä¸ªåŒºåˆ«ï¼Œä½ çŸ¥é“å‡ ä¸ªï¼Ÿ","date":"2025-10-14T06:42:34.000Z","_content":"\nsleep(ä¼‘çœ ) å’Œ wait(ç­‰å¾…) æ–¹æ³•æ˜¯ Java å¤šçº¿ç¨‹ä¸­å¸¸ç”¨çš„ä¸¤ä¸ªæ–¹æ³•ï¼Œå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«åŠä¸€äº›è¯¥æ³¨æ„çš„åœ°æ–¹æœ‰å“ªäº›å‘¢ï¼Ÿä¸‹é¢ç»™å¤§å®¶ä¸€ä¸€åˆ†è§£ã€‚\n\nåœ¨ä¹‹å‰çš„æ–‡ç« ã€Š[Javaå¤šçº¿ç¨‹ç¥å™¨ï¼šjoinä½¿ç”¨åŠåŸç†](https://mp.weixin.qq.com/s/at8NynjnYvqkFw61kn3Apg)ã€‹ä»‹ç»äº†ï¼Œå®ƒå…¶å®ç”¨çš„æ˜¯ wait å®ç°çš„çº¿ç¨‹ç­‰å¾…ã€‚\n\n#### åŒºåˆ«1ï¼šä½¿ç”¨é™åˆ¶\n\nä½¿ç”¨ sleep æ–¹æ³•å¯ä»¥è®©è®©å½“å‰çº¿ç¨‹ä¼‘çœ ï¼Œæ—¶é—´ä¸€åˆ°å½“å‰çº¿ç¨‹ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œåœ¨ä»»ä½•åœ°æ–¹éƒ½èƒ½ä½¿ç”¨ï¼Œä½†éœ€è¦æ•è· InterruptedException å¼‚å¸¸ã€‚\n\n```\ntry {\n\tThread.sleep(3000L);\n} catch (InterruptedException e) {\n\te.printStackTrace();\n}\n```\n\nè€Œä½¿ç”¨ wait æ–¹æ³•åˆ™å¿…é¡»æ”¾åœ¨ synchronized å—é‡Œé¢ï¼ŒåŒæ ·éœ€è¦æ•è· InterruptedException å¼‚å¸¸ï¼Œå¹¶ä¸”éœ€è¦è·å–å¯¹è±¡çš„é”ã€‚\n\n```\nsynchronized (lock){\n    try {\n        lock.wait();\n    } catch (InterruptedException e) {\n        e.printStackTrace();\n    }\n}\n```\n\nè€Œä¸” wait è¿˜éœ€è¦é¢å¤–çš„æ–¹æ³• notify/ notifyAll è¿›è¡Œå”¤é†’ï¼Œå®ƒä»¬åŒæ ·éœ€è¦æ”¾åœ¨ synchronized å—é‡Œé¢ï¼Œä¸”è·å–å¯¹è±¡çš„é”ã€‚ã€‚\n\n\n```\nsynchronized (lock) {\n    // éšæœºå”¤é†’\n    lock.notify();\n    \n    // å”¤é†’å…¨éƒ¨\n    lock.notifyAll();\n}\n```\n\nå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨å¸¦æ—¶é—´çš„ wait(long millis) æ–¹æ³•ï¼Œæ—¶é—´ä¸€åˆ°ï¼Œæ— éœ€å…¶ä»–çº¿ç¨‹å”¤é†’ï¼Œä¹Ÿä¼šé‡æ–°ç«äº‰è·å–å¯¹è±¡çš„é”ç»§ç»­æ‰§è¡Œã€‚\n\n#### åŒºåˆ«2ï¼šä½¿ç”¨åœºæ™¯\n\nsleep ä¸€èˆ¬ç”¨äºå½“å‰çº¿ç¨‹ä¼‘çœ ï¼Œæˆ–è€…è½®å¾ªæš‚åœæ“ä½œï¼Œwait åˆ™å¤šç”¨äºå¤šçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚\n\n#### åŒºåˆ«3ï¼šæ‰€å±ç±»\n\nsleep æ˜¯ Thread ç±»çš„é™æ€æœ¬åœ°æ–¹æ³•ï¼Œwait åˆ™æ˜¯ Object ç±»çš„æœ¬åœ°æ–¹æ³•ã€‚\n\n> java.lang.Thread#sleep\n\n```\npublic static native void sleep(long millis) throws InterruptedException;\n```\n\n> java.lang.Object#wait\n\n```\npublic final native void wait(long timeout) throws InterruptedException;\n```\n\n**ä¸ºä»€ä¹ˆè¦è¿™æ ·è®¾è®¡å‘¢ï¼Ÿ**\n\nå› ä¸º sleep æ˜¯è®©å½“å‰çº¿ç¨‹ä¼‘çœ ï¼Œä¸æ¶‰åŠåˆ°å¯¹è±¡ç±»ï¼Œä¹Ÿä¸éœ€è¦è·å¾—å¯¹è±¡çš„é”ï¼Œæ‰€ä»¥æ˜¯çº¿ç¨‹ç±»çš„æ–¹æ³•ã€‚wait æ˜¯è®©è·å¾—å¯¹è±¡é”çš„çº¿ç¨‹å®ç°ç­‰å¾…ï¼Œå‰ææ˜¯è¦æ¥šè·å¾—å¯¹è±¡çš„é”ï¼Œæ‰€ä»¥æ˜¯ç±»çš„æ–¹æ³•ã€‚\n\n#### åŒºåˆ«4ï¼šé‡Šæ”¾é”\n\n\n```\nObject lock = new Object();\nsynchronized (lock) {\n    try {\n        lock.wait(3000L);\n        Thread.sleep(2000L);\n    } catch (InterruptedException e) {\n        e.printStackTrace();\n    }\n}\n```\n\nå¦‚ä¸Šä»£ç æ‰€ç¤ºï¼Œwait å¯ä»¥é‡Šæ”¾å½“å‰çº¿ç¨‹å¯¹ lock å¯¹è±¡é”çš„æŒæœ‰ï¼Œè€Œ sleep åˆ™ä¸ä¼šã€‚\n\n#### åŒºåˆ«5ï¼šçº¿ç¨‹åˆ‡æ¢\n\nsleep ä¼šè®©å‡º CPU æ‰§è¡Œæ—¶é—´ä¸”å¼ºåˆ¶ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œè€Œ wait åˆ™ä¸ä¸€å®šï¼Œwait åå¯èƒ½è¿˜æ˜¯æœ‰æœºä¼šé‡æ–°ç«äº‰åˆ°é”ç»§ç»­æ‰§è¡Œçš„ã€‚\n\n@ç¨‹åºçŒ¿ ä½ ä»¬è¿˜çŸ¥é“åˆ«çš„å—ï¼Ÿæ¬¢è¿ç•™è¨€ï¼\n","source":"_posts/å¤šçº¿ç¨‹/sleep( )å’Œwait( )çš„è¿™5ä¸ªåŒºåˆ«ï¼Œä½ çŸ¥é“å‡ ä¸ªï¼Ÿ.md","raw":"---\ntitle: sleep( )å’Œwait( )çš„è¿™5ä¸ªåŒºåˆ«ï¼Œä½ çŸ¥é“å‡ ä¸ªï¼Ÿ\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: å¤šçº¿ç¨‹\n---\n\nsleep(ä¼‘çœ ) å’Œ wait(ç­‰å¾…) æ–¹æ³•æ˜¯ Java å¤šçº¿ç¨‹ä¸­å¸¸ç”¨çš„ä¸¤ä¸ªæ–¹æ³•ï¼Œå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«åŠä¸€äº›è¯¥æ³¨æ„çš„åœ°æ–¹æœ‰å“ªäº›å‘¢ï¼Ÿä¸‹é¢ç»™å¤§å®¶ä¸€ä¸€åˆ†è§£ã€‚\n\nåœ¨ä¹‹å‰çš„æ–‡ç« ã€Š[Javaå¤šçº¿ç¨‹ç¥å™¨ï¼šjoinä½¿ç”¨åŠåŸç†](https://mp.weixin.qq.com/s/at8NynjnYvqkFw61kn3Apg)ã€‹ä»‹ç»äº†ï¼Œå®ƒå…¶å®ç”¨çš„æ˜¯ wait å®ç°çš„çº¿ç¨‹ç­‰å¾…ã€‚\n\n#### åŒºåˆ«1ï¼šä½¿ç”¨é™åˆ¶\n\nä½¿ç”¨ sleep æ–¹æ³•å¯ä»¥è®©è®©å½“å‰çº¿ç¨‹ä¼‘çœ ï¼Œæ—¶é—´ä¸€åˆ°å½“å‰çº¿ç¨‹ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œåœ¨ä»»ä½•åœ°æ–¹éƒ½èƒ½ä½¿ç”¨ï¼Œä½†éœ€è¦æ•è· InterruptedException å¼‚å¸¸ã€‚\n\n```\ntry {\n\tThread.sleep(3000L);\n} catch (InterruptedException e) {\n\te.printStackTrace();\n}\n```\n\nè€Œä½¿ç”¨ wait æ–¹æ³•åˆ™å¿…é¡»æ”¾åœ¨ synchronized å—é‡Œé¢ï¼ŒåŒæ ·éœ€è¦æ•è· InterruptedException å¼‚å¸¸ï¼Œå¹¶ä¸”éœ€è¦è·å–å¯¹è±¡çš„é”ã€‚\n\n```\nsynchronized (lock){\n    try {\n        lock.wait();\n    } catch (InterruptedException e) {\n        e.printStackTrace();\n    }\n}\n```\n\nè€Œä¸” wait è¿˜éœ€è¦é¢å¤–çš„æ–¹æ³• notify/ notifyAll è¿›è¡Œå”¤é†’ï¼Œå®ƒä»¬åŒæ ·éœ€è¦æ”¾åœ¨ synchronized å—é‡Œé¢ï¼Œä¸”è·å–å¯¹è±¡çš„é”ã€‚ã€‚\n\n\n```\nsynchronized (lock) {\n    // éšæœºå”¤é†’\n    lock.notify();\n    \n    // å”¤é†’å…¨éƒ¨\n    lock.notifyAll();\n}\n```\n\nå½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨å¸¦æ—¶é—´çš„ wait(long millis) æ–¹æ³•ï¼Œæ—¶é—´ä¸€åˆ°ï¼Œæ— éœ€å…¶ä»–çº¿ç¨‹å”¤é†’ï¼Œä¹Ÿä¼šé‡æ–°ç«äº‰è·å–å¯¹è±¡çš„é”ç»§ç»­æ‰§è¡Œã€‚\n\n#### åŒºåˆ«2ï¼šä½¿ç”¨åœºæ™¯\n\nsleep ä¸€èˆ¬ç”¨äºå½“å‰çº¿ç¨‹ä¼‘çœ ï¼Œæˆ–è€…è½®å¾ªæš‚åœæ“ä½œï¼Œwait åˆ™å¤šç”¨äºå¤šçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚\n\n#### åŒºåˆ«3ï¼šæ‰€å±ç±»\n\nsleep æ˜¯ Thread ç±»çš„é™æ€æœ¬åœ°æ–¹æ³•ï¼Œwait åˆ™æ˜¯ Object ç±»çš„æœ¬åœ°æ–¹æ³•ã€‚\n\n> java.lang.Thread#sleep\n\n```\npublic static native void sleep(long millis) throws InterruptedException;\n```\n\n> java.lang.Object#wait\n\n```\npublic final native void wait(long timeout) throws InterruptedException;\n```\n\n**ä¸ºä»€ä¹ˆè¦è¿™æ ·è®¾è®¡å‘¢ï¼Ÿ**\n\nå› ä¸º sleep æ˜¯è®©å½“å‰çº¿ç¨‹ä¼‘çœ ï¼Œä¸æ¶‰åŠåˆ°å¯¹è±¡ç±»ï¼Œä¹Ÿä¸éœ€è¦è·å¾—å¯¹è±¡çš„é”ï¼Œæ‰€ä»¥æ˜¯çº¿ç¨‹ç±»çš„æ–¹æ³•ã€‚wait æ˜¯è®©è·å¾—å¯¹è±¡é”çš„çº¿ç¨‹å®ç°ç­‰å¾…ï¼Œå‰ææ˜¯è¦æ¥šè·å¾—å¯¹è±¡çš„é”ï¼Œæ‰€ä»¥æ˜¯ç±»çš„æ–¹æ³•ã€‚\n\n#### åŒºåˆ«4ï¼šé‡Šæ”¾é”\n\n\n```\nObject lock = new Object();\nsynchronized (lock) {\n    try {\n        lock.wait(3000L);\n        Thread.sleep(2000L);\n    } catch (InterruptedException e) {\n        e.printStackTrace();\n    }\n}\n```\n\nå¦‚ä¸Šä»£ç æ‰€ç¤ºï¼Œwait å¯ä»¥é‡Šæ”¾å½“å‰çº¿ç¨‹å¯¹ lock å¯¹è±¡é”çš„æŒæœ‰ï¼Œè€Œ sleep åˆ™ä¸ä¼šã€‚\n\n#### åŒºåˆ«5ï¼šçº¿ç¨‹åˆ‡æ¢\n\nsleep ä¼šè®©å‡º CPU æ‰§è¡Œæ—¶é—´ä¸”å¼ºåˆ¶ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œè€Œ wait åˆ™ä¸ä¸€å®šï¼Œwait åå¯èƒ½è¿˜æ˜¯æœ‰æœºä¼šé‡æ–°ç«äº‰åˆ°é”ç»§ç»­æ‰§è¡Œçš„ã€‚\n\n@ç¨‹åºçŒ¿ ä½ ä»¬è¿˜çŸ¥é“åˆ«çš„å—ï¼Ÿæ¬¢è¿ç•™è¨€ï¼\n","slug":"å¤šçº¿ç¨‹/sleep( )å’Œwait( )çš„è¿™5ä¸ªåŒºåˆ«ï¼Œä½ çŸ¥é“å‡ ä¸ªï¼Ÿ","published":1,"updated":"2025-10-15T07:20:25.001Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076n0028qkd42e5y8lqn","content":"<p>sleep(ä¼‘çœ ) å’Œ wait(ç­‰å¾…) æ–¹æ³•æ˜¯ Java å¤šçº¿ç¨‹ä¸­å¸¸ç”¨çš„ä¸¤ä¸ªæ–¹æ³•ï¼Œå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«åŠä¸€äº›è¯¥æ³¨æ„çš„åœ°æ–¹æœ‰å“ªäº›å‘¢ï¼Ÿä¸‹é¢ç»™å¤§å®¶ä¸€ä¸€åˆ†è§£ã€‚</p>\n<p>åœ¨ä¹‹å‰çš„æ–‡ç« ã€Š<a href=\"https://mp.weixin.qq.com/s/at8NynjnYvqkFw61kn3Apg\">Javaå¤šçº¿ç¨‹ç¥å™¨ï¼šjoinä½¿ç”¨åŠåŸç†</a>ã€‹ä»‹ç»äº†ï¼Œå®ƒå…¶å®ç”¨çš„æ˜¯ wait å®ç°çš„çº¿ç¨‹ç­‰å¾…ã€‚</p>\n<h4 id=\"åŒºåˆ«1ï¼šä½¿ç”¨é™åˆ¶\"><a href=\"#åŒºåˆ«1ï¼šä½¿ç”¨é™åˆ¶\" class=\"headerlink\" title=\"åŒºåˆ«1ï¼šä½¿ç”¨é™åˆ¶\"></a>åŒºåˆ«1ï¼šä½¿ç”¨é™åˆ¶</h4><p>ä½¿ç”¨ sleep æ–¹æ³•å¯ä»¥è®©è®©å½“å‰çº¿ç¨‹ä¼‘çœ ï¼Œæ—¶é—´ä¸€åˆ°å½“å‰çº¿ç¨‹ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œåœ¨ä»»ä½•åœ°æ–¹éƒ½èƒ½ä½¿ç”¨ï¼Œä½†éœ€è¦æ•è· InterruptedException å¼‚å¸¸ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">try &#123;\n\tThread.sleep(3000L);\n&#125; catch (InterruptedException e) &#123;\n\te.printStackTrace();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è€Œä½¿ç”¨ wait æ–¹æ³•åˆ™å¿…é¡»æ”¾åœ¨ synchronized å—é‡Œé¢ï¼ŒåŒæ ·éœ€è¦æ•è· InterruptedException å¼‚å¸¸ï¼Œå¹¶ä¸”éœ€è¦è·å–å¯¹è±¡çš„é”ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">synchronized (lock)&#123;\n    try &#123;\n        lock.wait();\n    &#125; catch (InterruptedException e) &#123;\n        e.printStackTrace();\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è€Œä¸” wait è¿˜éœ€è¦é¢å¤–çš„æ–¹æ³• notify&#x2F; notifyAll è¿›è¡Œå”¤é†’ï¼Œå®ƒä»¬åŒæ ·éœ€è¦æ”¾åœ¨ synchronized å—é‡Œé¢ï¼Œä¸”è·å–å¯¹è±¡çš„é”ã€‚ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">synchronized (lock) &#123;\n    &#x2F;&#x2F; éšæœºå”¤é†’\n    lock.notify();\n    \n    &#x2F;&#x2F; å”¤é†’å…¨éƒ¨\n    lock.notifyAll();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨å¸¦æ—¶é—´çš„ wait(long millis) æ–¹æ³•ï¼Œæ—¶é—´ä¸€åˆ°ï¼Œæ— éœ€å…¶ä»–çº¿ç¨‹å”¤é†’ï¼Œä¹Ÿä¼šé‡æ–°ç«äº‰è·å–å¯¹è±¡çš„é”ç»§ç»­æ‰§è¡Œã€‚</p>\n<h4 id=\"åŒºåˆ«2ï¼šä½¿ç”¨åœºæ™¯\"><a href=\"#åŒºåˆ«2ï¼šä½¿ç”¨åœºæ™¯\" class=\"headerlink\" title=\"åŒºåˆ«2ï¼šä½¿ç”¨åœºæ™¯\"></a>åŒºåˆ«2ï¼šä½¿ç”¨åœºæ™¯</h4><p>sleep ä¸€èˆ¬ç”¨äºå½“å‰çº¿ç¨‹ä¼‘çœ ï¼Œæˆ–è€…è½®å¾ªæš‚åœæ“ä½œï¼Œwait åˆ™å¤šç”¨äºå¤šçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚</p>\n<h4 id=\"åŒºåˆ«3ï¼šæ‰€å±ç±»\"><a href=\"#åŒºåˆ«3ï¼šæ‰€å±ç±»\" class=\"headerlink\" title=\"åŒºåˆ«3ï¼šæ‰€å±ç±»\"></a>åŒºåˆ«3ï¼šæ‰€å±ç±»</h4><p>sleep æ˜¯ Thread ç±»çš„é™æ€æœ¬åœ°æ–¹æ³•ï¼Œwait åˆ™æ˜¯ Object ç±»çš„æœ¬åœ°æ–¹æ³•ã€‚</p>\n<blockquote>\n<p>java.lang.Thread#sleep</p>\n</blockquote>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static native void sleep(long millis) throws InterruptedException;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<blockquote>\n<p>java.lang.Object#wait</p>\n</blockquote>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public final native void wait(long timeout) throws InterruptedException;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><strong>ä¸ºä»€ä¹ˆè¦è¿™æ ·è®¾è®¡å‘¢ï¼Ÿ</strong></p>\n<p>å› ä¸º sleep æ˜¯è®©å½“å‰çº¿ç¨‹ä¼‘çœ ï¼Œä¸æ¶‰åŠåˆ°å¯¹è±¡ç±»ï¼Œä¹Ÿä¸éœ€è¦è·å¾—å¯¹è±¡çš„é”ï¼Œæ‰€ä»¥æ˜¯çº¿ç¨‹ç±»çš„æ–¹æ³•ã€‚wait æ˜¯è®©è·å¾—å¯¹è±¡é”çš„çº¿ç¨‹å®ç°ç­‰å¾…ï¼Œå‰ææ˜¯è¦æ¥šè·å¾—å¯¹è±¡çš„é”ï¼Œæ‰€ä»¥æ˜¯ç±»çš„æ–¹æ³•ã€‚</p>\n<h4 id=\"åŒºåˆ«4ï¼šé‡Šæ”¾é”\"><a href=\"#åŒºåˆ«4ï¼šé‡Šæ”¾é”\" class=\"headerlink\" title=\"åŒºåˆ«4ï¼šé‡Šæ”¾é”\"></a>åŒºåˆ«4ï¼šé‡Šæ”¾é”</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">Object lock &#x3D; new Object();\nsynchronized (lock) &#123;\n    try &#123;\n        lock.wait(3000L);\n        Thread.sleep(2000L);\n    &#125; catch (InterruptedException e) &#123;\n        e.printStackTrace();\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼Œwait å¯ä»¥é‡Šæ”¾å½“å‰çº¿ç¨‹å¯¹ lock å¯¹è±¡é”çš„æŒæœ‰ï¼Œè€Œ sleep åˆ™ä¸ä¼šã€‚</p>\n<h4 id=\"åŒºåˆ«5ï¼šçº¿ç¨‹åˆ‡æ¢\"><a href=\"#åŒºåˆ«5ï¼šçº¿ç¨‹åˆ‡æ¢\" class=\"headerlink\" title=\"åŒºåˆ«5ï¼šçº¿ç¨‹åˆ‡æ¢\"></a>åŒºåˆ«5ï¼šçº¿ç¨‹åˆ‡æ¢</h4><p>sleep ä¼šè®©å‡º CPU æ‰§è¡Œæ—¶é—´ä¸”å¼ºåˆ¶ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œè€Œ wait åˆ™ä¸ä¸€å®šï¼Œwait åå¯èƒ½è¿˜æ˜¯æœ‰æœºä¼šé‡æ–°ç«äº‰åˆ°é”ç»§ç»­æ‰§è¡Œçš„ã€‚</p>\n<p>@ç¨‹åºçŒ¿ ä½ ä»¬è¿˜çŸ¥é“åˆ«çš„å—ï¼Ÿæ¬¢è¿ç•™è¨€ï¼</p>\n","excerpt":"","more":"<p>sleep(ä¼‘çœ ) å’Œ wait(ç­‰å¾…) æ–¹æ³•æ˜¯ Java å¤šçº¿ç¨‹ä¸­å¸¸ç”¨çš„ä¸¤ä¸ªæ–¹æ³•ï¼Œå®ƒä»¬æœ‰ä»€ä¹ˆåŒºåˆ«åŠä¸€äº›è¯¥æ³¨æ„çš„åœ°æ–¹æœ‰å“ªäº›å‘¢ï¼Ÿä¸‹é¢ç»™å¤§å®¶ä¸€ä¸€åˆ†è§£ã€‚</p>\n<p>åœ¨ä¹‹å‰çš„æ–‡ç« ã€Š<a href=\"https://mp.weixin.qq.com/s/at8NynjnYvqkFw61kn3Apg\">Javaå¤šçº¿ç¨‹ç¥å™¨ï¼šjoinä½¿ç”¨åŠåŸç†</a>ã€‹ä»‹ç»äº†ï¼Œå®ƒå…¶å®ç”¨çš„æ˜¯ wait å®ç°çš„çº¿ç¨‹ç­‰å¾…ã€‚</p>\n<h4 id=\"åŒºåˆ«1ï¼šä½¿ç”¨é™åˆ¶\"><a href=\"#åŒºåˆ«1ï¼šä½¿ç”¨é™åˆ¶\" class=\"headerlink\" title=\"åŒºåˆ«1ï¼šä½¿ç”¨é™åˆ¶\"></a>åŒºåˆ«1ï¼šä½¿ç”¨é™åˆ¶</h4><p>ä½¿ç”¨ sleep æ–¹æ³•å¯ä»¥è®©è®©å½“å‰çº¿ç¨‹ä¼‘çœ ï¼Œæ—¶é—´ä¸€åˆ°å½“å‰çº¿ç¨‹ç»§ç»­å¾€ä¸‹æ‰§è¡Œï¼Œåœ¨ä»»ä½•åœ°æ–¹éƒ½èƒ½ä½¿ç”¨ï¼Œä½†éœ€è¦æ•è· InterruptedException å¼‚å¸¸ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">try &#123;\n\tThread.sleep(3000L);\n&#125; catch (InterruptedException e) &#123;\n\te.printStackTrace();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è€Œä½¿ç”¨ wait æ–¹æ³•åˆ™å¿…é¡»æ”¾åœ¨ synchronized å—é‡Œé¢ï¼ŒåŒæ ·éœ€è¦æ•è· InterruptedException å¼‚å¸¸ï¼Œå¹¶ä¸”éœ€è¦è·å–å¯¹è±¡çš„é”ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">synchronized (lock)&#123;\n    try &#123;\n        lock.wait();\n    &#125; catch (InterruptedException e) &#123;\n        e.printStackTrace();\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è€Œä¸” wait è¿˜éœ€è¦é¢å¤–çš„æ–¹æ³• notify&#x2F; notifyAll è¿›è¡Œå”¤é†’ï¼Œå®ƒä»¬åŒæ ·éœ€è¦æ”¾åœ¨ synchronized å—é‡Œé¢ï¼Œä¸”è·å–å¯¹è±¡çš„é”ã€‚ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">synchronized (lock) &#123;\n    &#x2F;&#x2F; éšæœºå”¤é†’\n    lock.notify();\n    \n    &#x2F;&#x2F; å”¤é†’å…¨éƒ¨\n    lock.notifyAll();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å½“ç„¶ä¹Ÿå¯ä»¥ä½¿ç”¨å¸¦æ—¶é—´çš„ wait(long millis) æ–¹æ³•ï¼Œæ—¶é—´ä¸€åˆ°ï¼Œæ— éœ€å…¶ä»–çº¿ç¨‹å”¤é†’ï¼Œä¹Ÿä¼šé‡æ–°ç«äº‰è·å–å¯¹è±¡çš„é”ç»§ç»­æ‰§è¡Œã€‚</p>\n<h4 id=\"åŒºåˆ«2ï¼šä½¿ç”¨åœºæ™¯\"><a href=\"#åŒºåˆ«2ï¼šä½¿ç”¨åœºæ™¯\" class=\"headerlink\" title=\"åŒºåˆ«2ï¼šä½¿ç”¨åœºæ™¯\"></a>åŒºåˆ«2ï¼šä½¿ç”¨åœºæ™¯</h4><p>sleep ä¸€èˆ¬ç”¨äºå½“å‰çº¿ç¨‹ä¼‘çœ ï¼Œæˆ–è€…è½®å¾ªæš‚åœæ“ä½œï¼Œwait åˆ™å¤šç”¨äºå¤šçº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚</p>\n<h4 id=\"åŒºåˆ«3ï¼šæ‰€å±ç±»\"><a href=\"#åŒºåˆ«3ï¼šæ‰€å±ç±»\" class=\"headerlink\" title=\"åŒºåˆ«3ï¼šæ‰€å±ç±»\"></a>åŒºåˆ«3ï¼šæ‰€å±ç±»</h4><p>sleep æ˜¯ Thread ç±»çš„é™æ€æœ¬åœ°æ–¹æ³•ï¼Œwait åˆ™æ˜¯ Object ç±»çš„æœ¬åœ°æ–¹æ³•ã€‚</p>\n<blockquote>\n<p>java.lang.Thread#sleep</p>\n</blockquote>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static native void sleep(long millis) throws InterruptedException;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<blockquote>\n<p>java.lang.Object#wait</p>\n</blockquote>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public final native void wait(long timeout) throws InterruptedException;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><strong>ä¸ºä»€ä¹ˆè¦è¿™æ ·è®¾è®¡å‘¢ï¼Ÿ</strong></p>\n<p>å› ä¸º sleep æ˜¯è®©å½“å‰çº¿ç¨‹ä¼‘çœ ï¼Œä¸æ¶‰åŠåˆ°å¯¹è±¡ç±»ï¼Œä¹Ÿä¸éœ€è¦è·å¾—å¯¹è±¡çš„é”ï¼Œæ‰€ä»¥æ˜¯çº¿ç¨‹ç±»çš„æ–¹æ³•ã€‚wait æ˜¯è®©è·å¾—å¯¹è±¡é”çš„çº¿ç¨‹å®ç°ç­‰å¾…ï¼Œå‰ææ˜¯è¦æ¥šè·å¾—å¯¹è±¡çš„é”ï¼Œæ‰€ä»¥æ˜¯ç±»çš„æ–¹æ³•ã€‚</p>\n<h4 id=\"åŒºåˆ«4ï¼šé‡Šæ”¾é”\"><a href=\"#åŒºåˆ«4ï¼šé‡Šæ”¾é”\" class=\"headerlink\" title=\"åŒºåˆ«4ï¼šé‡Šæ”¾é”\"></a>åŒºåˆ«4ï¼šé‡Šæ”¾é”</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">Object lock &#x3D; new Object();\nsynchronized (lock) &#123;\n    try &#123;\n        lock.wait(3000L);\n        Thread.sleep(2000L);\n    &#125; catch (InterruptedException e) &#123;\n        e.printStackTrace();\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¦‚ä¸Šä»£ç æ‰€ç¤ºï¼Œwait å¯ä»¥é‡Šæ”¾å½“å‰çº¿ç¨‹å¯¹ lock å¯¹è±¡é”çš„æŒæœ‰ï¼Œè€Œ sleep åˆ™ä¸ä¼šã€‚</p>\n<h4 id=\"åŒºåˆ«5ï¼šçº¿ç¨‹åˆ‡æ¢\"><a href=\"#åŒºåˆ«5ï¼šçº¿ç¨‹åˆ‡æ¢\" class=\"headerlink\" title=\"åŒºåˆ«5ï¼šçº¿ç¨‹åˆ‡æ¢\"></a>åŒºåˆ«5ï¼šçº¿ç¨‹åˆ‡æ¢</h4><p>sleep ä¼šè®©å‡º CPU æ‰§è¡Œæ—¶é—´ä¸”å¼ºåˆ¶ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œè€Œ wait åˆ™ä¸ä¸€å®šï¼Œwait åå¯èƒ½è¿˜æ˜¯æœ‰æœºä¼šé‡æ–°ç«äº‰åˆ°é”ç»§ç»­æ‰§è¡Œçš„ã€‚</p>\n<p>@ç¨‹åºçŒ¿ ä½ ä»¬è¿˜çŸ¥é“åˆ«çš„å—ï¼Ÿæ¬¢è¿ç•™è¨€ï¼</p>\n"},{"title":"ä¸€æ–‡ææ‡‚ Java çº¿ç¨‹ä¸­æ–­","date":"2025-10-14T06:42:34.000Z","_content":"\n```\ntry {\n\tThread.sleep(3000);\n} catch (InterruptedException e) {\n\te.printStackTrace();\n}\n```\n\næ­¤æ—¶çº¿ç¨‹è¢«æ‰“æ–­åï¼Œä»£ç ä¼šç»§ç»­è¿è¡Œæˆ–è€…æŠ›å‡ºå¼‚å¸¸ç»“æŸè¿è¡Œï¼Œè¿™å¹¶ä¸æ˜¯æˆ‘ä»¬éœ€è¦çš„ä¸­æ–­çº¿ç¨‹çš„ä½œç”¨ã€‚\n\n#### åˆ°åº•æ˜¯ä»€ä¹ˆæ˜¯çº¿ç¨‹ä¸­æ–­ï¼Ÿ\n\nçº¿ç¨‹ä¸­æ–­å³çº¿ç¨‹è¿è¡Œè¿‡ç¨‹ä¸­è¢«å…¶ä»–çº¿ç¨‹ç»™æ‰“æ–­äº†ï¼Œå®ƒä¸ stop æœ€å¤§çš„åŒºåˆ«æ˜¯ï¼šstop æ˜¯ç”±ç³»ç»Ÿå¼ºåˆ¶ç»ˆæ­¢çº¿ç¨‹ï¼Œè€Œçº¿ç¨‹ä¸­æ–­åˆ™æ˜¯ç»™ç›®æ ‡çº¿ç¨‹å‘é€ä¸€ä¸ªä¸­æ–­ä¿¡å·ï¼Œå¦‚æœç›®æ ‡çº¿ç¨‹æ²¡æœ‰æ¥æ”¶çº¿ç¨‹ä¸­æ–­çš„ä¿¡å·å¹¶ç»“æŸçº¿ç¨‹ï¼Œçº¿ç¨‹åˆ™ä¸ä¼šç»ˆæ­¢ï¼Œå…·ä½“æ˜¯å¦é€€å‡ºæˆ–è€…æ‰§è¡Œå…¶ä»–é€»è¾‘ç”±ç›®æ ‡çº¿ç¨‹å†³å®šã€‚\n\næˆ‘ä»¬æ¥çœ‹ä¸‹çº¿ç¨‹ä¸­æ–­æœ€é‡è¦çš„ 3 ä¸ªæ–¹æ³•ï¼Œå®ƒä»¬éƒ½æ˜¯æ¥è‡ª Thread ç±»ï¼\n\n**1ã€java.lang.Thread#interrupt**\n\nä¸­æ–­ç›®æ ‡çº¿ç¨‹ï¼Œç»™ç›®æ ‡çº¿ç¨‹å‘ä¸€ä¸ªä¸­æ–­ä¿¡å·ï¼Œçº¿ç¨‹è¢«æ‰“ä¸Šä¸­æ–­æ ‡è®°ã€‚\n\n**2ã€java.lang.Thread#isInterrupted()**\n\nåˆ¤æ–­ç›®æ ‡çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­ï¼Œä¸ä¼šæ¸…é™¤ä¸­æ–­æ ‡è®°ã€‚\n\n**3ã€java.lang.Thread#interrupted**\n\nåˆ¤æ–­ç›®æ ‡çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­ï¼Œä¼šæ¸…é™¤ä¸­æ–­æ ‡è®°ã€‚\n\n#### çº¿ç¨‹ä¸­æ–­å®æˆ˜\n\næˆ‘ä»¬æ¥å®ä¾‹æ¼”ç¤ºä¸‹çº¿ç¨‹ä¸­æ–­å¦‚ä½•ç”¨ï¼\n\n**ç¤ºä¾‹1ï¼ˆä¸­æ–­å¤±è´¥ï¼‰**\n\n```\n/**\n * \n */\nprivate static void test1() {\n\tThread thread = new Thread(() -> {\n\t\twhile (true) {\n\t\t\tThread.yield();\n\t\t}\n\t});\n\tthread.start();\n\tthread.interrupt();\n}\n```\n\nè¯·é—®ç¤ºä¾‹1ä¸­çš„çº¿ç¨‹ä¼šè¢«ä¸­æ–­å—ï¼Ÿç­”æ¡ˆï¼šä¸ä¼šï¼Œå› ä¸ºè™½ç„¶ç»™çº¿ç¨‹å‘å‡ºäº†ä¸­æ–­ä¿¡å·ï¼Œä½†ç¨‹åºä¸­å¹¶æ²¡æœ‰å“åº”ä¸­æ–­ä¿¡å·çš„é€»è¾‘ï¼Œæ‰€ä»¥ç¨‹åºä¸ä¼šæœ‰ä»»ä½•ååº”ã€‚\n\n**ç¤ºä¾‹2ï¼šï¼ˆä¸­æ–­æˆåŠŸï¼‰**\n\n```\n/**\n * \n */\nprivate static void test2() {\n\tThread thread = new Thread(() -> {\n\t\twhile (true) {\n\t\t\tThread.yield();\n\n\t\t\t// å“åº”ä¸­æ–­\n\t\t\tif (Thread.currentThread().isInterrupted()) {\n\t\t\t\tSystem.out.println(\"JavaæŠ€æœ¯çº¿ç¨‹è¢«ä¸­æ–­ï¼Œç¨‹åºé€€å‡ºã€‚\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t});\n\tthread.start();\n\tthread.interrupt();\n}\n```\n\næˆ‘ä»¬ç»™ç¤ºä¾‹2åŠ ä¸Šäº†å“åº”ä¸­æ–­çš„é€»è¾‘ï¼Œç¨‹åºæ¥æ”¶åˆ°ä¸­æ–­ä¿¡å·æ‰“å°å‡ºä¿¡æ¯åè¿”å›é€€å‡ºã€‚\n\n**ç¤ºä¾‹3ï¼ˆä¸­æ–­å¤±è´¥ï¼‰**\n\n```\n/**\n * \n */\nprivate static void test3() throws InterruptedException {\n\tThread thread = new Thread(() -> {\n\t\twhile (true) {\n\t\t\t// å“åº”ä¸­æ–­\n\t\t\tif (Thread.currentThread().isInterrupted()) {\n\t\t\t\tSystem.out.println(\"JavaæŠ€æœ¯çº¿ç¨‹è¢«ä¸­æ–­ï¼Œç¨‹åºé€€å‡ºã€‚\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tThread.sleep(3000);\n\t\t\t} catch (InterruptedException e) {\n\t\t\t\tSystem.out.println(\"JavaæŠ€æœ¯çº¿ç¨‹ä¼‘çœ è¢«ä¸­æ–­ï¼Œç¨‹åºé€€å‡ºã€‚\");\n\t\t\t}\n\t\t}\n\t});\n\tthread.start();\n\tThread.sleep(2000);\n\tthread.interrupt();\n}\n```\n\nç¤ºä¾‹3 sleep() æ–¹æ³•è¢«ä¸­æ–­ï¼Œå¹¶è¾“å‡ºäº† `JavaæŠ€æœ¯çº¿ç¨‹ä¼‘çœ è¢«ä¸­æ–­ï¼Œç¨‹åºé€€å‡ºã€‚` ç¨‹åºç»§ç»­è¿è¡Œâ€¦â€¦ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ\n\næ¥çœ‹ sleep çš„æºç ï¼š\n\n![](http://img.javastack.cn/18-6-1/1779530.jpg)\n\nå¯ä»¥çœ‹å‡º sleep() æ–¹æ³•è¢«ä¸­æ–­åä¼šæ¸…é™¤ä¸­æ–­æ ‡è®°ï¼Œæ‰€ä»¥å¾ªç¯ä¼šç»§ç»­è¿è¡Œã€‚ã€‚\n\n**ç¤ºä¾‹4ï¼ˆä¸­æ–­æˆåŠŸï¼‰**\n\n```\n/**\n * \n */\nprivate static void test4() throws InterruptedException {\n\tThread thread = new Thread(() -> {\n\t\twhile (true) {\n\t\t\t// å“åº”ä¸­æ–­\n\t\t\tif (Thread.currentThread().isInterrupted()) {\n\t\t\t\tSystem.out.println(\"JavaæŠ€æœ¯çº¿ç¨‹è¢«ä¸­æ–­ï¼Œç¨‹åºé€€å‡ºã€‚\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tThread.sleep(3000);\n\t\t\t} catch (InterruptedException e) {\n\t\t\t\tSystem.out.println(\"JavaæŠ€æœ¯çº¿ç¨‹ä¼‘çœ è¢«ä¸­æ–­ï¼Œç¨‹åºé€€å‡ºã€‚\");\n\t\t\t\tThread.currentThread().interrupt();\n\t\t\t}\n\t\t}\n\t});\n\tthread.start();\n\tThread.sleep(2000);\n\tthread.interrupt();\n}\n```\n\nç¤ºä¾‹4å…¨éƒ¨ä¿¡æ¯è¾“å‡ºå¹¶æ­£å¸¸é€€å‡ºï¼Œåªæ˜¯åœ¨ sleep() æ–¹æ³•è¢«ä¸­æ–­å¹¶æ¸…é™¤æ ‡è®°åæ‰‹åŠ¨é‡æ–°ä¸­æ–­å½“å‰çº¿ç¨‹ï¼Œç„¶åç¨‹åºæ¥æ”¶ä¸­æ–­ä¿¡å·è¿”å›é€€å‡ºã€‚\n\né€šè¿‡ä»¥ä¸Š 4 ä¸ªä¸­æ–­ç¤ºä¾‹ï¼Œç›¸ä¿¡å¯¹ Java çº¿ç¨‹ä¸­æ–­çš„æ¦‚å¿µæœ‰äº†å…¨é¢çš„äº†è§£ã€‚\n\n\n","source":"_posts/å¤šçº¿ç¨‹/ä¸€æ–‡ææ‡‚ Java çº¿ç¨‹ä¸­æ–­.md","raw":"---\ntitle: ä¸€æ–‡ææ‡‚ Java çº¿ç¨‹ä¸­æ–­\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: å¤šçº¿ç¨‹\n---\n\n```\ntry {\n\tThread.sleep(3000);\n} catch (InterruptedException e) {\n\te.printStackTrace();\n}\n```\n\næ­¤æ—¶çº¿ç¨‹è¢«æ‰“æ–­åï¼Œä»£ç ä¼šç»§ç»­è¿è¡Œæˆ–è€…æŠ›å‡ºå¼‚å¸¸ç»“æŸè¿è¡Œï¼Œè¿™å¹¶ä¸æ˜¯æˆ‘ä»¬éœ€è¦çš„ä¸­æ–­çº¿ç¨‹çš„ä½œç”¨ã€‚\n\n#### åˆ°åº•æ˜¯ä»€ä¹ˆæ˜¯çº¿ç¨‹ä¸­æ–­ï¼Ÿ\n\nçº¿ç¨‹ä¸­æ–­å³çº¿ç¨‹è¿è¡Œè¿‡ç¨‹ä¸­è¢«å…¶ä»–çº¿ç¨‹ç»™æ‰“æ–­äº†ï¼Œå®ƒä¸ stop æœ€å¤§çš„åŒºåˆ«æ˜¯ï¼šstop æ˜¯ç”±ç³»ç»Ÿå¼ºåˆ¶ç»ˆæ­¢çº¿ç¨‹ï¼Œè€Œçº¿ç¨‹ä¸­æ–­åˆ™æ˜¯ç»™ç›®æ ‡çº¿ç¨‹å‘é€ä¸€ä¸ªä¸­æ–­ä¿¡å·ï¼Œå¦‚æœç›®æ ‡çº¿ç¨‹æ²¡æœ‰æ¥æ”¶çº¿ç¨‹ä¸­æ–­çš„ä¿¡å·å¹¶ç»“æŸçº¿ç¨‹ï¼Œçº¿ç¨‹åˆ™ä¸ä¼šç»ˆæ­¢ï¼Œå…·ä½“æ˜¯å¦é€€å‡ºæˆ–è€…æ‰§è¡Œå…¶ä»–é€»è¾‘ç”±ç›®æ ‡çº¿ç¨‹å†³å®šã€‚\n\næˆ‘ä»¬æ¥çœ‹ä¸‹çº¿ç¨‹ä¸­æ–­æœ€é‡è¦çš„ 3 ä¸ªæ–¹æ³•ï¼Œå®ƒä»¬éƒ½æ˜¯æ¥è‡ª Thread ç±»ï¼\n\n**1ã€java.lang.Thread#interrupt**\n\nä¸­æ–­ç›®æ ‡çº¿ç¨‹ï¼Œç»™ç›®æ ‡çº¿ç¨‹å‘ä¸€ä¸ªä¸­æ–­ä¿¡å·ï¼Œçº¿ç¨‹è¢«æ‰“ä¸Šä¸­æ–­æ ‡è®°ã€‚\n\n**2ã€java.lang.Thread#isInterrupted()**\n\nåˆ¤æ–­ç›®æ ‡çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­ï¼Œä¸ä¼šæ¸…é™¤ä¸­æ–­æ ‡è®°ã€‚\n\n**3ã€java.lang.Thread#interrupted**\n\nåˆ¤æ–­ç›®æ ‡çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­ï¼Œä¼šæ¸…é™¤ä¸­æ–­æ ‡è®°ã€‚\n\n#### çº¿ç¨‹ä¸­æ–­å®æˆ˜\n\næˆ‘ä»¬æ¥å®ä¾‹æ¼”ç¤ºä¸‹çº¿ç¨‹ä¸­æ–­å¦‚ä½•ç”¨ï¼\n\n**ç¤ºä¾‹1ï¼ˆä¸­æ–­å¤±è´¥ï¼‰**\n\n```\n/**\n * \n */\nprivate static void test1() {\n\tThread thread = new Thread(() -> {\n\t\twhile (true) {\n\t\t\tThread.yield();\n\t\t}\n\t});\n\tthread.start();\n\tthread.interrupt();\n}\n```\n\nè¯·é—®ç¤ºä¾‹1ä¸­çš„çº¿ç¨‹ä¼šè¢«ä¸­æ–­å—ï¼Ÿç­”æ¡ˆï¼šä¸ä¼šï¼Œå› ä¸ºè™½ç„¶ç»™çº¿ç¨‹å‘å‡ºäº†ä¸­æ–­ä¿¡å·ï¼Œä½†ç¨‹åºä¸­å¹¶æ²¡æœ‰å“åº”ä¸­æ–­ä¿¡å·çš„é€»è¾‘ï¼Œæ‰€ä»¥ç¨‹åºä¸ä¼šæœ‰ä»»ä½•ååº”ã€‚\n\n**ç¤ºä¾‹2ï¼šï¼ˆä¸­æ–­æˆåŠŸï¼‰**\n\n```\n/**\n * \n */\nprivate static void test2() {\n\tThread thread = new Thread(() -> {\n\t\twhile (true) {\n\t\t\tThread.yield();\n\n\t\t\t// å“åº”ä¸­æ–­\n\t\t\tif (Thread.currentThread().isInterrupted()) {\n\t\t\t\tSystem.out.println(\"JavaæŠ€æœ¯çº¿ç¨‹è¢«ä¸­æ–­ï¼Œç¨‹åºé€€å‡ºã€‚\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t});\n\tthread.start();\n\tthread.interrupt();\n}\n```\n\næˆ‘ä»¬ç»™ç¤ºä¾‹2åŠ ä¸Šäº†å“åº”ä¸­æ–­çš„é€»è¾‘ï¼Œç¨‹åºæ¥æ”¶åˆ°ä¸­æ–­ä¿¡å·æ‰“å°å‡ºä¿¡æ¯åè¿”å›é€€å‡ºã€‚\n\n**ç¤ºä¾‹3ï¼ˆä¸­æ–­å¤±è´¥ï¼‰**\n\n```\n/**\n * \n */\nprivate static void test3() throws InterruptedException {\n\tThread thread = new Thread(() -> {\n\t\twhile (true) {\n\t\t\t// å“åº”ä¸­æ–­\n\t\t\tif (Thread.currentThread().isInterrupted()) {\n\t\t\t\tSystem.out.println(\"JavaæŠ€æœ¯çº¿ç¨‹è¢«ä¸­æ–­ï¼Œç¨‹åºé€€å‡ºã€‚\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tThread.sleep(3000);\n\t\t\t} catch (InterruptedException e) {\n\t\t\t\tSystem.out.println(\"JavaæŠ€æœ¯çº¿ç¨‹ä¼‘çœ è¢«ä¸­æ–­ï¼Œç¨‹åºé€€å‡ºã€‚\");\n\t\t\t}\n\t\t}\n\t});\n\tthread.start();\n\tThread.sleep(2000);\n\tthread.interrupt();\n}\n```\n\nç¤ºä¾‹3 sleep() æ–¹æ³•è¢«ä¸­æ–­ï¼Œå¹¶è¾“å‡ºäº† `JavaæŠ€æœ¯çº¿ç¨‹ä¼‘çœ è¢«ä¸­æ–­ï¼Œç¨‹åºé€€å‡ºã€‚` ç¨‹åºç»§ç»­è¿è¡Œâ€¦â€¦ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ\n\næ¥çœ‹ sleep çš„æºç ï¼š\n\n![](http://img.javastack.cn/18-6-1/1779530.jpg)\n\nå¯ä»¥çœ‹å‡º sleep() æ–¹æ³•è¢«ä¸­æ–­åä¼šæ¸…é™¤ä¸­æ–­æ ‡è®°ï¼Œæ‰€ä»¥å¾ªç¯ä¼šç»§ç»­è¿è¡Œã€‚ã€‚\n\n**ç¤ºä¾‹4ï¼ˆä¸­æ–­æˆåŠŸï¼‰**\n\n```\n/**\n * \n */\nprivate static void test4() throws InterruptedException {\n\tThread thread = new Thread(() -> {\n\t\twhile (true) {\n\t\t\t// å“åº”ä¸­æ–­\n\t\t\tif (Thread.currentThread().isInterrupted()) {\n\t\t\t\tSystem.out.println(\"JavaæŠ€æœ¯çº¿ç¨‹è¢«ä¸­æ–­ï¼Œç¨‹åºé€€å‡ºã€‚\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tThread.sleep(3000);\n\t\t\t} catch (InterruptedException e) {\n\t\t\t\tSystem.out.println(\"JavaæŠ€æœ¯çº¿ç¨‹ä¼‘çœ è¢«ä¸­æ–­ï¼Œç¨‹åºé€€å‡ºã€‚\");\n\t\t\t\tThread.currentThread().interrupt();\n\t\t\t}\n\t\t}\n\t});\n\tthread.start();\n\tThread.sleep(2000);\n\tthread.interrupt();\n}\n```\n\nç¤ºä¾‹4å…¨éƒ¨ä¿¡æ¯è¾“å‡ºå¹¶æ­£å¸¸é€€å‡ºï¼Œåªæ˜¯åœ¨ sleep() æ–¹æ³•è¢«ä¸­æ–­å¹¶æ¸…é™¤æ ‡è®°åæ‰‹åŠ¨é‡æ–°ä¸­æ–­å½“å‰çº¿ç¨‹ï¼Œç„¶åç¨‹åºæ¥æ”¶ä¸­æ–­ä¿¡å·è¿”å›é€€å‡ºã€‚\n\né€šè¿‡ä»¥ä¸Š 4 ä¸ªä¸­æ–­ç¤ºä¾‹ï¼Œç›¸ä¿¡å¯¹ Java çº¿ç¨‹ä¸­æ–­çš„æ¦‚å¿µæœ‰äº†å…¨é¢çš„äº†è§£ã€‚\n\n\n","slug":"å¤šçº¿ç¨‹/ä¸€æ–‡ææ‡‚ Java çº¿ç¨‹ä¸­æ–­","published":1,"updated":"2025-10-15T07:20:25.065Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076n002cqkd48rqshy9n","content":"<pre class=\"line-numbers language-none\"><code class=\"language-none\">try &#123;\n\tThread.sleep(3000);\n&#125; catch (InterruptedException e) &#123;\n\te.printStackTrace();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ­¤æ—¶çº¿ç¨‹è¢«æ‰“æ–­åï¼Œä»£ç ä¼šç»§ç»­è¿è¡Œæˆ–è€…æŠ›å‡ºå¼‚å¸¸ç»“æŸè¿è¡Œï¼Œè¿™å¹¶ä¸æ˜¯æˆ‘ä»¬éœ€è¦çš„ä¸­æ–­çº¿ç¨‹çš„ä½œç”¨ã€‚</p>\n<h4 id=\"åˆ°åº•æ˜¯ä»€ä¹ˆæ˜¯çº¿ç¨‹ä¸­æ–­ï¼Ÿ\"><a href=\"#åˆ°åº•æ˜¯ä»€ä¹ˆæ˜¯çº¿ç¨‹ä¸­æ–­ï¼Ÿ\" class=\"headerlink\" title=\"åˆ°åº•æ˜¯ä»€ä¹ˆæ˜¯çº¿ç¨‹ä¸­æ–­ï¼Ÿ\"></a>åˆ°åº•æ˜¯ä»€ä¹ˆæ˜¯çº¿ç¨‹ä¸­æ–­ï¼Ÿ</h4><p>çº¿ç¨‹ä¸­æ–­å³çº¿ç¨‹è¿è¡Œè¿‡ç¨‹ä¸­è¢«å…¶ä»–çº¿ç¨‹ç»™æ‰“æ–­äº†ï¼Œå®ƒä¸ stop æœ€å¤§çš„åŒºåˆ«æ˜¯ï¼šstop æ˜¯ç”±ç³»ç»Ÿå¼ºåˆ¶ç»ˆæ­¢çº¿ç¨‹ï¼Œè€Œçº¿ç¨‹ä¸­æ–­åˆ™æ˜¯ç»™ç›®æ ‡çº¿ç¨‹å‘é€ä¸€ä¸ªä¸­æ–­ä¿¡å·ï¼Œå¦‚æœç›®æ ‡çº¿ç¨‹æ²¡æœ‰æ¥æ”¶çº¿ç¨‹ä¸­æ–­çš„ä¿¡å·å¹¶ç»“æŸçº¿ç¨‹ï¼Œçº¿ç¨‹åˆ™ä¸ä¼šç»ˆæ­¢ï¼Œå…·ä½“æ˜¯å¦é€€å‡ºæˆ–è€…æ‰§è¡Œå…¶ä»–é€»è¾‘ç”±ç›®æ ‡çº¿ç¨‹å†³å®šã€‚</p>\n<p>æˆ‘ä»¬æ¥çœ‹ä¸‹çº¿ç¨‹ä¸­æ–­æœ€é‡è¦çš„ 3 ä¸ªæ–¹æ³•ï¼Œå®ƒä»¬éƒ½æ˜¯æ¥è‡ª Thread ç±»ï¼</p>\n<p><strong>1ã€java.lang.Thread#interrupt</strong></p>\n<p>ä¸­æ–­ç›®æ ‡çº¿ç¨‹ï¼Œç»™ç›®æ ‡çº¿ç¨‹å‘ä¸€ä¸ªä¸­æ–­ä¿¡å·ï¼Œçº¿ç¨‹è¢«æ‰“ä¸Šä¸­æ–­æ ‡è®°ã€‚</p>\n<p><strong>2ã€java.lang.Thread#isInterrupted()</strong></p>\n<p>åˆ¤æ–­ç›®æ ‡çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­ï¼Œä¸ä¼šæ¸…é™¤ä¸­æ–­æ ‡è®°ã€‚</p>\n<p><strong>3ã€java.lang.Thread#interrupted</strong></p>\n<p>åˆ¤æ–­ç›®æ ‡çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­ï¼Œä¼šæ¸…é™¤ä¸­æ–­æ ‡è®°ã€‚</p>\n<h4 id=\"çº¿ç¨‹ä¸­æ–­å®æˆ˜\"><a href=\"#çº¿ç¨‹ä¸­æ–­å®æˆ˜\" class=\"headerlink\" title=\"çº¿ç¨‹ä¸­æ–­å®æˆ˜\"></a>çº¿ç¨‹ä¸­æ–­å®æˆ˜</h4><p>æˆ‘ä»¬æ¥å®ä¾‹æ¼”ç¤ºä¸‹çº¿ç¨‹ä¸­æ–­å¦‚ä½•ç”¨ï¼</p>\n<p><strong>ç¤ºä¾‹1ï¼ˆä¸­æ–­å¤±è´¥ï¼‰</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * \n *&#x2F;\nprivate static void test1() &#123;\n\tThread thread &#x3D; new Thread(() -&gt; &#123;\n\t\twhile (true) &#123;\n\t\t\tThread.yield();\n\t\t&#125;\n\t&#125;);\n\tthread.start();\n\tthread.interrupt();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¯·é—®ç¤ºä¾‹1ä¸­çš„çº¿ç¨‹ä¼šè¢«ä¸­æ–­å—ï¼Ÿç­”æ¡ˆï¼šä¸ä¼šï¼Œå› ä¸ºè™½ç„¶ç»™çº¿ç¨‹å‘å‡ºäº†ä¸­æ–­ä¿¡å·ï¼Œä½†ç¨‹åºä¸­å¹¶æ²¡æœ‰å“åº”ä¸­æ–­ä¿¡å·çš„é€»è¾‘ï¼Œæ‰€ä»¥ç¨‹åºä¸ä¼šæœ‰ä»»ä½•ååº”ã€‚</p>\n<p><strong>ç¤ºä¾‹2ï¼šï¼ˆä¸­æ–­æˆåŠŸï¼‰</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * \n *&#x2F;\nprivate static void test2() &#123;\n\tThread thread &#x3D; new Thread(() -&gt; &#123;\n\t\twhile (true) &#123;\n\t\t\tThread.yield();\n\n\t\t\t&#x2F;&#x2F; å“åº”ä¸­æ–­\n\t\t\tif (Thread.currentThread().isInterrupted()) &#123;\n\t\t\t\tSystem.out.println(&quot;JavaæŠ€æœ¯çº¿ç¨‹è¢«ä¸­æ–­ï¼Œç¨‹åºé€€å‡ºã€‚&quot;);\n\t\t\t\treturn;\n\t\t\t&#125;\n\t\t&#125;\n\t&#125;);\n\tthread.start();\n\tthread.interrupt();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æˆ‘ä»¬ç»™ç¤ºä¾‹2åŠ ä¸Šäº†å“åº”ä¸­æ–­çš„é€»è¾‘ï¼Œç¨‹åºæ¥æ”¶åˆ°ä¸­æ–­ä¿¡å·æ‰“å°å‡ºä¿¡æ¯åè¿”å›é€€å‡ºã€‚</p>\n<p><strong>ç¤ºä¾‹3ï¼ˆä¸­æ–­å¤±è´¥ï¼‰</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * \n *&#x2F;\nprivate static void test3() throws InterruptedException &#123;\n\tThread thread &#x3D; new Thread(() -&gt; &#123;\n\t\twhile (true) &#123;\n\t\t\t&#x2F;&#x2F; å“åº”ä¸­æ–­\n\t\t\tif (Thread.currentThread().isInterrupted()) &#123;\n\t\t\t\tSystem.out.println(&quot;JavaæŠ€æœ¯çº¿ç¨‹è¢«ä¸­æ–­ï¼Œç¨‹åºé€€å‡ºã€‚&quot;);\n\t\t\t\treturn;\n\t\t\t&#125;\n\n\t\t\ttry &#123;\n\t\t\t\tThread.sleep(3000);\n\t\t\t&#125; catch (InterruptedException e) &#123;\n\t\t\t\tSystem.out.println(&quot;JavaæŠ€æœ¯çº¿ç¨‹ä¼‘çœ è¢«ä¸­æ–­ï¼Œç¨‹åºé€€å‡ºã€‚&quot;);\n\t\t\t&#125;\n\t\t&#125;\n\t&#125;);\n\tthread.start();\n\tThread.sleep(2000);\n\tthread.interrupt();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¤ºä¾‹3 sleep() æ–¹æ³•è¢«ä¸­æ–­ï¼Œå¹¶è¾“å‡ºäº† <code>JavaæŠ€æœ¯çº¿ç¨‹ä¼‘çœ è¢«ä¸­æ–­ï¼Œç¨‹åºé€€å‡ºã€‚</code> ç¨‹åºç»§ç»­è¿è¡Œâ€¦â€¦ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p>\n<p>æ¥çœ‹ sleep çš„æºç ï¼š</p>\n<p><img src=\"http://img.javastack.cn/18-6-1/1779530.jpg\"></p>\n<p>å¯ä»¥çœ‹å‡º sleep() æ–¹æ³•è¢«ä¸­æ–­åä¼šæ¸…é™¤ä¸­æ–­æ ‡è®°ï¼Œæ‰€ä»¥å¾ªç¯ä¼šç»§ç»­è¿è¡Œã€‚ã€‚</p>\n<p><strong>ç¤ºä¾‹4ï¼ˆä¸­æ–­æˆåŠŸï¼‰</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * \n *&#x2F;\nprivate static void test4() throws InterruptedException &#123;\n\tThread thread &#x3D; new Thread(() -&gt; &#123;\n\t\twhile (true) &#123;\n\t\t\t&#x2F;&#x2F; å“åº”ä¸­æ–­\n\t\t\tif (Thread.currentThread().isInterrupted()) &#123;\n\t\t\t\tSystem.out.println(&quot;JavaæŠ€æœ¯çº¿ç¨‹è¢«ä¸­æ–­ï¼Œç¨‹åºé€€å‡ºã€‚&quot;);\n\t\t\t\treturn;\n\t\t\t&#125;\n\n\t\t\ttry &#123;\n\t\t\t\tThread.sleep(3000);\n\t\t\t&#125; catch (InterruptedException e) &#123;\n\t\t\t\tSystem.out.println(&quot;JavaæŠ€æœ¯çº¿ç¨‹ä¼‘çœ è¢«ä¸­æ–­ï¼Œç¨‹åºé€€å‡ºã€‚&quot;);\n\t\t\t\tThread.currentThread().interrupt();\n\t\t\t&#125;\n\t\t&#125;\n\t&#125;);\n\tthread.start();\n\tThread.sleep(2000);\n\tthread.interrupt();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¤ºä¾‹4å…¨éƒ¨ä¿¡æ¯è¾“å‡ºå¹¶æ­£å¸¸é€€å‡ºï¼Œåªæ˜¯åœ¨ sleep() æ–¹æ³•è¢«ä¸­æ–­å¹¶æ¸…é™¤æ ‡è®°åæ‰‹åŠ¨é‡æ–°ä¸­æ–­å½“å‰çº¿ç¨‹ï¼Œç„¶åç¨‹åºæ¥æ”¶ä¸­æ–­ä¿¡å·è¿”å›é€€å‡ºã€‚</p>\n<p>é€šè¿‡ä»¥ä¸Š 4 ä¸ªä¸­æ–­ç¤ºä¾‹ï¼Œç›¸ä¿¡å¯¹ Java çº¿ç¨‹ä¸­æ–­çš„æ¦‚å¿µæœ‰äº†å…¨é¢çš„äº†è§£ã€‚</p>\n","excerpt":"","more":"<pre class=\"line-numbers language-none\"><code class=\"language-none\">try &#123;\n\tThread.sleep(3000);\n&#125; catch (InterruptedException e) &#123;\n\te.printStackTrace();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ­¤æ—¶çº¿ç¨‹è¢«æ‰“æ–­åï¼Œä»£ç ä¼šç»§ç»­è¿è¡Œæˆ–è€…æŠ›å‡ºå¼‚å¸¸ç»“æŸè¿è¡Œï¼Œè¿™å¹¶ä¸æ˜¯æˆ‘ä»¬éœ€è¦çš„ä¸­æ–­çº¿ç¨‹çš„ä½œç”¨ã€‚</p>\n<h4 id=\"åˆ°åº•æ˜¯ä»€ä¹ˆæ˜¯çº¿ç¨‹ä¸­æ–­ï¼Ÿ\"><a href=\"#åˆ°åº•æ˜¯ä»€ä¹ˆæ˜¯çº¿ç¨‹ä¸­æ–­ï¼Ÿ\" class=\"headerlink\" title=\"åˆ°åº•æ˜¯ä»€ä¹ˆæ˜¯çº¿ç¨‹ä¸­æ–­ï¼Ÿ\"></a>åˆ°åº•æ˜¯ä»€ä¹ˆæ˜¯çº¿ç¨‹ä¸­æ–­ï¼Ÿ</h4><p>çº¿ç¨‹ä¸­æ–­å³çº¿ç¨‹è¿è¡Œè¿‡ç¨‹ä¸­è¢«å…¶ä»–çº¿ç¨‹ç»™æ‰“æ–­äº†ï¼Œå®ƒä¸ stop æœ€å¤§çš„åŒºåˆ«æ˜¯ï¼šstop æ˜¯ç”±ç³»ç»Ÿå¼ºåˆ¶ç»ˆæ­¢çº¿ç¨‹ï¼Œè€Œçº¿ç¨‹ä¸­æ–­åˆ™æ˜¯ç»™ç›®æ ‡çº¿ç¨‹å‘é€ä¸€ä¸ªä¸­æ–­ä¿¡å·ï¼Œå¦‚æœç›®æ ‡çº¿ç¨‹æ²¡æœ‰æ¥æ”¶çº¿ç¨‹ä¸­æ–­çš„ä¿¡å·å¹¶ç»“æŸçº¿ç¨‹ï¼Œçº¿ç¨‹åˆ™ä¸ä¼šç»ˆæ­¢ï¼Œå…·ä½“æ˜¯å¦é€€å‡ºæˆ–è€…æ‰§è¡Œå…¶ä»–é€»è¾‘ç”±ç›®æ ‡çº¿ç¨‹å†³å®šã€‚</p>\n<p>æˆ‘ä»¬æ¥çœ‹ä¸‹çº¿ç¨‹ä¸­æ–­æœ€é‡è¦çš„ 3 ä¸ªæ–¹æ³•ï¼Œå®ƒä»¬éƒ½æ˜¯æ¥è‡ª Thread ç±»ï¼</p>\n<p><strong>1ã€java.lang.Thread#interrupt</strong></p>\n<p>ä¸­æ–­ç›®æ ‡çº¿ç¨‹ï¼Œç»™ç›®æ ‡çº¿ç¨‹å‘ä¸€ä¸ªä¸­æ–­ä¿¡å·ï¼Œçº¿ç¨‹è¢«æ‰“ä¸Šä¸­æ–­æ ‡è®°ã€‚</p>\n<p><strong>2ã€java.lang.Thread#isInterrupted()</strong></p>\n<p>åˆ¤æ–­ç›®æ ‡çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­ï¼Œä¸ä¼šæ¸…é™¤ä¸­æ–­æ ‡è®°ã€‚</p>\n<p><strong>3ã€java.lang.Thread#interrupted</strong></p>\n<p>åˆ¤æ–­ç›®æ ‡çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­ï¼Œä¼šæ¸…é™¤ä¸­æ–­æ ‡è®°ã€‚</p>\n<h4 id=\"çº¿ç¨‹ä¸­æ–­å®æˆ˜\"><a href=\"#çº¿ç¨‹ä¸­æ–­å®æˆ˜\" class=\"headerlink\" title=\"çº¿ç¨‹ä¸­æ–­å®æˆ˜\"></a>çº¿ç¨‹ä¸­æ–­å®æˆ˜</h4><p>æˆ‘ä»¬æ¥å®ä¾‹æ¼”ç¤ºä¸‹çº¿ç¨‹ä¸­æ–­å¦‚ä½•ç”¨ï¼</p>\n<p><strong>ç¤ºä¾‹1ï¼ˆä¸­æ–­å¤±è´¥ï¼‰</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * \n *&#x2F;\nprivate static void test1() &#123;\n\tThread thread &#x3D; new Thread(() -&gt; &#123;\n\t\twhile (true) &#123;\n\t\t\tThread.yield();\n\t\t&#125;\n\t&#125;);\n\tthread.start();\n\tthread.interrupt();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¯·é—®ç¤ºä¾‹1ä¸­çš„çº¿ç¨‹ä¼šè¢«ä¸­æ–­å—ï¼Ÿç­”æ¡ˆï¼šä¸ä¼šï¼Œå› ä¸ºè™½ç„¶ç»™çº¿ç¨‹å‘å‡ºäº†ä¸­æ–­ä¿¡å·ï¼Œä½†ç¨‹åºä¸­å¹¶æ²¡æœ‰å“åº”ä¸­æ–­ä¿¡å·çš„é€»è¾‘ï¼Œæ‰€ä»¥ç¨‹åºä¸ä¼šæœ‰ä»»ä½•ååº”ã€‚</p>\n<p><strong>ç¤ºä¾‹2ï¼šï¼ˆä¸­æ–­æˆåŠŸï¼‰</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * \n *&#x2F;\nprivate static void test2() &#123;\n\tThread thread &#x3D; new Thread(() -&gt; &#123;\n\t\twhile (true) &#123;\n\t\t\tThread.yield();\n\n\t\t\t&#x2F;&#x2F; å“åº”ä¸­æ–­\n\t\t\tif (Thread.currentThread().isInterrupted()) &#123;\n\t\t\t\tSystem.out.println(&quot;JavaæŠ€æœ¯çº¿ç¨‹è¢«ä¸­æ–­ï¼Œç¨‹åºé€€å‡ºã€‚&quot;);\n\t\t\t\treturn;\n\t\t\t&#125;\n\t\t&#125;\n\t&#125;);\n\tthread.start();\n\tthread.interrupt();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æˆ‘ä»¬ç»™ç¤ºä¾‹2åŠ ä¸Šäº†å“åº”ä¸­æ–­çš„é€»è¾‘ï¼Œç¨‹åºæ¥æ”¶åˆ°ä¸­æ–­ä¿¡å·æ‰“å°å‡ºä¿¡æ¯åè¿”å›é€€å‡ºã€‚</p>\n<p><strong>ç¤ºä¾‹3ï¼ˆä¸­æ–­å¤±è´¥ï¼‰</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * \n *&#x2F;\nprivate static void test3() throws InterruptedException &#123;\n\tThread thread &#x3D; new Thread(() -&gt; &#123;\n\t\twhile (true) &#123;\n\t\t\t&#x2F;&#x2F; å“åº”ä¸­æ–­\n\t\t\tif (Thread.currentThread().isInterrupted()) &#123;\n\t\t\t\tSystem.out.println(&quot;JavaæŠ€æœ¯çº¿ç¨‹è¢«ä¸­æ–­ï¼Œç¨‹åºé€€å‡ºã€‚&quot;);\n\t\t\t\treturn;\n\t\t\t&#125;\n\n\t\t\ttry &#123;\n\t\t\t\tThread.sleep(3000);\n\t\t\t&#125; catch (InterruptedException e) &#123;\n\t\t\t\tSystem.out.println(&quot;JavaæŠ€æœ¯çº¿ç¨‹ä¼‘çœ è¢«ä¸­æ–­ï¼Œç¨‹åºé€€å‡ºã€‚&quot;);\n\t\t\t&#125;\n\t\t&#125;\n\t&#125;);\n\tthread.start();\n\tThread.sleep(2000);\n\tthread.interrupt();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¤ºä¾‹3 sleep() æ–¹æ³•è¢«ä¸­æ–­ï¼Œå¹¶è¾“å‡ºäº† <code>JavaæŠ€æœ¯çº¿ç¨‹ä¼‘çœ è¢«ä¸­æ–­ï¼Œç¨‹åºé€€å‡ºã€‚</code> ç¨‹åºç»§ç»­è¿è¡Œâ€¦â€¦ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p>\n<p>æ¥çœ‹ sleep çš„æºç ï¼š</p>\n<p><img src=\"http://img.javastack.cn/18-6-1/1779530.jpg\"></p>\n<p>å¯ä»¥çœ‹å‡º sleep() æ–¹æ³•è¢«ä¸­æ–­åä¼šæ¸…é™¤ä¸­æ–­æ ‡è®°ï¼Œæ‰€ä»¥å¾ªç¯ä¼šç»§ç»­è¿è¡Œã€‚ã€‚</p>\n<p><strong>ç¤ºä¾‹4ï¼ˆä¸­æ–­æˆåŠŸï¼‰</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * \n *&#x2F;\nprivate static void test4() throws InterruptedException &#123;\n\tThread thread &#x3D; new Thread(() -&gt; &#123;\n\t\twhile (true) &#123;\n\t\t\t&#x2F;&#x2F; å“åº”ä¸­æ–­\n\t\t\tif (Thread.currentThread().isInterrupted()) &#123;\n\t\t\t\tSystem.out.println(&quot;JavaæŠ€æœ¯çº¿ç¨‹è¢«ä¸­æ–­ï¼Œç¨‹åºé€€å‡ºã€‚&quot;);\n\t\t\t\treturn;\n\t\t\t&#125;\n\n\t\t\ttry &#123;\n\t\t\t\tThread.sleep(3000);\n\t\t\t&#125; catch (InterruptedException e) &#123;\n\t\t\t\tSystem.out.println(&quot;JavaæŠ€æœ¯çº¿ç¨‹ä¼‘çœ è¢«ä¸­æ–­ï¼Œç¨‹åºé€€å‡ºã€‚&quot;);\n\t\t\t\tThread.currentThread().interrupt();\n\t\t\t&#125;\n\t\t&#125;\n\t&#125;);\n\tthread.start();\n\tThread.sleep(2000);\n\tthread.interrupt();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¤ºä¾‹4å…¨éƒ¨ä¿¡æ¯è¾“å‡ºå¹¶æ­£å¸¸é€€å‡ºï¼Œåªæ˜¯åœ¨ sleep() æ–¹æ³•è¢«ä¸­æ–­å¹¶æ¸…é™¤æ ‡è®°åæ‰‹åŠ¨é‡æ–°ä¸­æ–­å½“å‰çº¿ç¨‹ï¼Œç„¶åç¨‹åºæ¥æ”¶ä¸­æ–­ä¿¡å·è¿”å›é€€å‡ºã€‚</p>\n<p>é€šè¿‡ä»¥ä¸Š 4 ä¸ªä¸­æ–­ç¤ºä¾‹ï¼Œç›¸ä¿¡å¯¹ Java çº¿ç¨‹ä¸­æ–­çš„æ¦‚å¿µæœ‰äº†å…¨é¢çš„äº†è§£ã€‚</p>\n"},{"title":"å‡ºåœºç‡æ¯”è¾ƒé«˜çš„ä¸€é“å¤šçº¿ç¨‹å®‰å…¨é¢è¯•é¢˜","date":"2025-10-14T06:42:34.000Z","_content":"\nå·¥ä½œä¸€ä¸¤å¹´çš„åº”è¯¥éƒ½çŸ¥é“ ArrayList æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œè¦ä½¿ç”¨çº¿ç¨‹å®‰å…¨çš„å°±ä½¿ç”¨ Vectorï¼Œè¿™ä¹Ÿæ˜¯å„ç§ Java é¢è¯•å®å…¸é‡Œé¢æ‰€æåŠçš„ï¼Œå¯èƒ½å¾ˆå¤šå·¥ä½œå¥½å‡ å¹´çš„ç¨‹åºå‘˜éƒ½åœç•™åœ¨è¿™ä¸ªçŸ¥è¯†é¢ä¸Šã€‚\n\nå…ˆè¯´è¯´ä¸ºä»€ä¹ˆ ArrayList æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„å§ï¼Œæ¥çœ‹ä»¥ä¸‹çš„ä»£ç ã€‚\n\n```\n/**\n * \n */\npublic class TestArrayList {\n\n\tprivate static List<Integer> list = new ArrayList<>();\n\n\tpublic static void main(String[] args) throws InterruptedException {\n\t\tfor (int i = 0; i < 10; i++) {\n\t\t\ttestList();\n\t\t\tlist.clear();\n\t\t}\n\t}\n\n\tprivate static void testList() throws InterruptedException {\n\t\tRunnable runnable = () -> {\n\t\t\tfor (int i = 0; i < 10000; i++) {\n\t\t\t\tlist.add(i);\n\t\t\t}\n\t\t};\n\n\t\tThread t1 = new Thread(runnable);\n\t\tThread t2 = new Thread(runnable);\n\t\tThread t3 = new Thread(runnable);\n\n\t\tt1.start();\n\t\tt2.start();\n\t\tt3.start();\n\n\t\tt1.join();\n\t\tt2.join();\n\t\tt3.join();\n\n\t\tSystem.out.println(list.size());\n\t}\n\n}\n```\n\nè¿™æ˜¯å®ƒçš„è¾“å‡ºç»“æœï¼Œæˆ‘ä»¬æœŸæœ›çš„ç»“æœåº”è¯¥éƒ½æ˜¯ï¼š30000ï¼Œç„¶åå¹¶ä¸æ˜¯ï¼Œè¿™å°±æ˜¯ä¼ è¯´ä¸­çš„å¤šçº¿ç¨‹å¹¶å‘é—®é¢˜äº†ã€‚\n\n```\nException in thread \"Thread-1\" java.lang.ArrayIndexOutOfBoundsException: 15786\n\tat java.base/java.util.ArrayList.add(ArrayList.java:468)\n\tat java.base/java.util.ArrayList.add(ArrayList.java:480)\n\tat com.test.thread.TestArrayList.lambda$testList$0(TestArrayList.java:23)\n\tat java.base/java.lang.Thread.run(Thread.java:844)\n20332\n16100\n14941\n23749\n15631\n22118\n27417\n30000\n28691\n27843\n```\n\n#### ç°è±¡åˆ†æ\n\nä»ä»¥ä¸Šç»“æœå¯ä»¥æ€»ç»“å‡º ArrayList åœ¨å¹¶å‘æƒ…å†µä¸‹ä¼šå‡ºç°çš„å‡ ç§ç°è±¡ã€‚\n\n**1ã€å‘ç”Ÿ ArrayIndexOutOfBoundsException å¼‚å¸¸ï¼›**\n\n```\nprivate void add(E e, Object[] elementData, int s) {\n    if (s == elementData.length)\n        elementData = grow();\n    elementData[s] = e;\n    size = s + 1;\n}\n```\n\nå®šä½åˆ°å¼‚å¸¸æ‰€åœ¨æºä»£ç ï¼Œæ¯«æ— ç–‘é—®ï¼Œé—®é¢˜æ˜¯å‡ºç°åœ¨å¤šçº¿ç¨‹å¹¶å‘è®¿é—®ä¸‹ï¼Œç”±äºæ²¡æœ‰åŒæ­¥é”çš„ä¿æŠ¤ï¼Œé€ æˆäº† ArrayList æ‰©å®¹ä¸ä¸€è‡´çš„é—®é¢˜ã€‚\n\n\n**2ã€ç¨‹åºæ­£å¸¸è¿è¡Œï¼Œè¾“å‡ºäº†å°‘äºå®é™…å®¹é‡çš„å¤§å°ï¼›**\n\nè¿™ä¸ªä¹Ÿæ˜¯å¤šçº¿ç¨‹å¹¶å‘èµ‹å€¼æ—¶ï¼Œå¯¹åŒä¸€ä¸ªæ•°ç»„ç´¢å¼•ä½ç½®è¿›è¡Œäº†èµ‹å€¼ï¼Œæ‰€ä»¥å‡ºç°å°‘äºé¢„æœŸå¤§å°çš„æƒ…å†µã€‚\n\n**3ã€ç¨‹åºæ­£å¸¸è¿è¡Œï¼Œè¾“å‡ºäº†é¢„æœŸå®¹é‡çš„å¤§å°ï¼›**\n\nè¿™æ˜¯æ­£å¸¸è¿è¡Œç»“æœï¼Œæœªå‘ç”Ÿå¤šçº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œä½†è¿™æ˜¯ä¸ç¡®å®šæ€§çš„ï¼Œä¸æ˜¯æ¯æ¬¡éƒ½ä¼šè¾¾åˆ°æ­£å¸¸é¢„æœŸçš„ã€‚\n\n#### è§£å†³æ–¹æ¡ˆ\n\næ—¢ç„¶è¿™æ ·ï¼Œé‚£ä¹ˆåœ¨é«˜å¹¶å‘æƒ…å†µä¸‹ï¼Œä½¿ç”¨ä»€ä¹ˆæ ·çš„åˆ—è¡¨é›†åˆä¿æŠ¤çº¿ç¨‹å®‰å…¨å‘¢ï¼Ÿå›åˆ°æ–‡ç« æœ€å¼€å§‹çš„åœ°æ–¹ï¼Œä½¿ç”¨ Vectorï¼Œè¿˜æœ‰åˆ«çš„å—ï¼Ÿå½“ç„¶æœ‰ï¼Œç¯‡å¹…æœ‰é™ï¼Œè¯·å„ä½çœ‹å®˜æœŸå¾…åç»­æ–‡ç« ã€‚\n\nå¦å¤–ï¼Œåƒ HashMap, HashSet ç­‰éƒ½æœ‰ç±»ä¼¼å¤šçº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œåœ¨å¤šçº¿ç¨‹å¹¶å‘ç¯å¢ƒä¸‹é¿å…ä½¿ç”¨è¿™ç§é›†åˆã€‚\n\n","source":"_posts/å¤šçº¿ç¨‹/å‡ºåœºç‡æ¯”è¾ƒé«˜çš„ä¸€é“å¤šçº¿ç¨‹å®‰å…¨é¢è¯•é¢˜.md","raw":"---\ntitle: å‡ºåœºç‡æ¯”è¾ƒé«˜çš„ä¸€é“å¤šçº¿ç¨‹å®‰å…¨é¢è¯•é¢˜\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: å¤šçº¿ç¨‹\n---\n\nå·¥ä½œä¸€ä¸¤å¹´çš„åº”è¯¥éƒ½çŸ¥é“ ArrayList æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œè¦ä½¿ç”¨çº¿ç¨‹å®‰å…¨çš„å°±ä½¿ç”¨ Vectorï¼Œè¿™ä¹Ÿæ˜¯å„ç§ Java é¢è¯•å®å…¸é‡Œé¢æ‰€æåŠçš„ï¼Œå¯èƒ½å¾ˆå¤šå·¥ä½œå¥½å‡ å¹´çš„ç¨‹åºå‘˜éƒ½åœç•™åœ¨è¿™ä¸ªçŸ¥è¯†é¢ä¸Šã€‚\n\nå…ˆè¯´è¯´ä¸ºä»€ä¹ˆ ArrayList æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„å§ï¼Œæ¥çœ‹ä»¥ä¸‹çš„ä»£ç ã€‚\n\n```\n/**\n * \n */\npublic class TestArrayList {\n\n\tprivate static List<Integer> list = new ArrayList<>();\n\n\tpublic static void main(String[] args) throws InterruptedException {\n\t\tfor (int i = 0; i < 10; i++) {\n\t\t\ttestList();\n\t\t\tlist.clear();\n\t\t}\n\t}\n\n\tprivate static void testList() throws InterruptedException {\n\t\tRunnable runnable = () -> {\n\t\t\tfor (int i = 0; i < 10000; i++) {\n\t\t\t\tlist.add(i);\n\t\t\t}\n\t\t};\n\n\t\tThread t1 = new Thread(runnable);\n\t\tThread t2 = new Thread(runnable);\n\t\tThread t3 = new Thread(runnable);\n\n\t\tt1.start();\n\t\tt2.start();\n\t\tt3.start();\n\n\t\tt1.join();\n\t\tt2.join();\n\t\tt3.join();\n\n\t\tSystem.out.println(list.size());\n\t}\n\n}\n```\n\nè¿™æ˜¯å®ƒçš„è¾“å‡ºç»“æœï¼Œæˆ‘ä»¬æœŸæœ›çš„ç»“æœåº”è¯¥éƒ½æ˜¯ï¼š30000ï¼Œç„¶åå¹¶ä¸æ˜¯ï¼Œè¿™å°±æ˜¯ä¼ è¯´ä¸­çš„å¤šçº¿ç¨‹å¹¶å‘é—®é¢˜äº†ã€‚\n\n```\nException in thread \"Thread-1\" java.lang.ArrayIndexOutOfBoundsException: 15786\n\tat java.base/java.util.ArrayList.add(ArrayList.java:468)\n\tat java.base/java.util.ArrayList.add(ArrayList.java:480)\n\tat com.test.thread.TestArrayList.lambda$testList$0(TestArrayList.java:23)\n\tat java.base/java.lang.Thread.run(Thread.java:844)\n20332\n16100\n14941\n23749\n15631\n22118\n27417\n30000\n28691\n27843\n```\n\n#### ç°è±¡åˆ†æ\n\nä»ä»¥ä¸Šç»“æœå¯ä»¥æ€»ç»“å‡º ArrayList åœ¨å¹¶å‘æƒ…å†µä¸‹ä¼šå‡ºç°çš„å‡ ç§ç°è±¡ã€‚\n\n**1ã€å‘ç”Ÿ ArrayIndexOutOfBoundsException å¼‚å¸¸ï¼›**\n\n```\nprivate void add(E e, Object[] elementData, int s) {\n    if (s == elementData.length)\n        elementData = grow();\n    elementData[s] = e;\n    size = s + 1;\n}\n```\n\nå®šä½åˆ°å¼‚å¸¸æ‰€åœ¨æºä»£ç ï¼Œæ¯«æ— ç–‘é—®ï¼Œé—®é¢˜æ˜¯å‡ºç°åœ¨å¤šçº¿ç¨‹å¹¶å‘è®¿é—®ä¸‹ï¼Œç”±äºæ²¡æœ‰åŒæ­¥é”çš„ä¿æŠ¤ï¼Œé€ æˆäº† ArrayList æ‰©å®¹ä¸ä¸€è‡´çš„é—®é¢˜ã€‚\n\n\n**2ã€ç¨‹åºæ­£å¸¸è¿è¡Œï¼Œè¾“å‡ºäº†å°‘äºå®é™…å®¹é‡çš„å¤§å°ï¼›**\n\nè¿™ä¸ªä¹Ÿæ˜¯å¤šçº¿ç¨‹å¹¶å‘èµ‹å€¼æ—¶ï¼Œå¯¹åŒä¸€ä¸ªæ•°ç»„ç´¢å¼•ä½ç½®è¿›è¡Œäº†èµ‹å€¼ï¼Œæ‰€ä»¥å‡ºç°å°‘äºé¢„æœŸå¤§å°çš„æƒ…å†µã€‚\n\n**3ã€ç¨‹åºæ­£å¸¸è¿è¡Œï¼Œè¾“å‡ºäº†é¢„æœŸå®¹é‡çš„å¤§å°ï¼›**\n\nè¿™æ˜¯æ­£å¸¸è¿è¡Œç»“æœï¼Œæœªå‘ç”Ÿå¤šçº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œä½†è¿™æ˜¯ä¸ç¡®å®šæ€§çš„ï¼Œä¸æ˜¯æ¯æ¬¡éƒ½ä¼šè¾¾åˆ°æ­£å¸¸é¢„æœŸçš„ã€‚\n\n#### è§£å†³æ–¹æ¡ˆ\n\næ—¢ç„¶è¿™æ ·ï¼Œé‚£ä¹ˆåœ¨é«˜å¹¶å‘æƒ…å†µä¸‹ï¼Œä½¿ç”¨ä»€ä¹ˆæ ·çš„åˆ—è¡¨é›†åˆä¿æŠ¤çº¿ç¨‹å®‰å…¨å‘¢ï¼Ÿå›åˆ°æ–‡ç« æœ€å¼€å§‹çš„åœ°æ–¹ï¼Œä½¿ç”¨ Vectorï¼Œè¿˜æœ‰åˆ«çš„å—ï¼Ÿå½“ç„¶æœ‰ï¼Œç¯‡å¹…æœ‰é™ï¼Œè¯·å„ä½çœ‹å®˜æœŸå¾…åç»­æ–‡ç« ã€‚\n\nå¦å¤–ï¼Œåƒ HashMap, HashSet ç­‰éƒ½æœ‰ç±»ä¼¼å¤šçº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œåœ¨å¤šçº¿ç¨‹å¹¶å‘ç¯å¢ƒä¸‹é¿å…ä½¿ç”¨è¿™ç§é›†åˆã€‚\n\n","slug":"å¤šçº¿ç¨‹/å‡ºåœºç‡æ¯”è¾ƒé«˜çš„ä¸€é“å¤šçº¿ç¨‹å®‰å…¨é¢è¯•é¢˜","published":1,"updated":"2025-10-15T07:20:25.061Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076o002fqkd4blhv0iwh","content":"<p>å·¥ä½œä¸€ä¸¤å¹´çš„åº”è¯¥éƒ½çŸ¥é“ ArrayList æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œè¦ä½¿ç”¨çº¿ç¨‹å®‰å…¨çš„å°±ä½¿ç”¨ Vectorï¼Œè¿™ä¹Ÿæ˜¯å„ç§ Java é¢è¯•å®å…¸é‡Œé¢æ‰€æåŠçš„ï¼Œå¯èƒ½å¾ˆå¤šå·¥ä½œå¥½å‡ å¹´çš„ç¨‹åºå‘˜éƒ½åœç•™åœ¨è¿™ä¸ªçŸ¥è¯†é¢ä¸Šã€‚</p>\n<p>å…ˆè¯´è¯´ä¸ºä»€ä¹ˆ ArrayList æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„å§ï¼Œæ¥çœ‹ä»¥ä¸‹çš„ä»£ç ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * \n *&#x2F;\npublic class TestArrayList &#123;\n\n\tprivate static List&lt;Integer&gt; list &#x3D; new ArrayList&lt;&gt;();\n\n\tpublic static void main(String[] args) throws InterruptedException &#123;\n\t\tfor (int i &#x3D; 0; i &lt; 10; i++) &#123;\n\t\t\ttestList();\n\t\t\tlist.clear();\n\t\t&#125;\n\t&#125;\n\n\tprivate static void testList() throws InterruptedException &#123;\n\t\tRunnable runnable &#x3D; () -&gt; &#123;\n\t\t\tfor (int i &#x3D; 0; i &lt; 10000; i++) &#123;\n\t\t\t\tlist.add(i);\n\t\t\t&#125;\n\t\t&#125;;\n\n\t\tThread t1 &#x3D; new Thread(runnable);\n\t\tThread t2 &#x3D; new Thread(runnable);\n\t\tThread t3 &#x3D; new Thread(runnable);\n\n\t\tt1.start();\n\t\tt2.start();\n\t\tt3.start();\n\n\t\tt1.join();\n\t\tt2.join();\n\t\tt3.join();\n\n\t\tSystem.out.println(list.size());\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™æ˜¯å®ƒçš„è¾“å‡ºç»“æœï¼Œæˆ‘ä»¬æœŸæœ›çš„ç»“æœåº”è¯¥éƒ½æ˜¯ï¼š30000ï¼Œç„¶åå¹¶ä¸æ˜¯ï¼Œè¿™å°±æ˜¯ä¼ è¯´ä¸­çš„å¤šçº¿ç¨‹å¹¶å‘é—®é¢˜äº†ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Exception in thread &quot;Thread-1&quot; java.lang.ArrayIndexOutOfBoundsException: 15786\n\tat java.base&#x2F;java.util.ArrayList.add(ArrayList.java:468)\n\tat java.base&#x2F;java.util.ArrayList.add(ArrayList.java:480)\n\tat com.test.thread.TestArrayList.lambda$testList$0(TestArrayList.java:23)\n\tat java.base&#x2F;java.lang.Thread.run(Thread.java:844)\n20332\n16100\n14941\n23749\n15631\n22118\n27417\n30000\n28691\n27843<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"ç°è±¡åˆ†æ\"><a href=\"#ç°è±¡åˆ†æ\" class=\"headerlink\" title=\"ç°è±¡åˆ†æ\"></a>ç°è±¡åˆ†æ</h4><p>ä»ä»¥ä¸Šç»“æœå¯ä»¥æ€»ç»“å‡º ArrayList åœ¨å¹¶å‘æƒ…å†µä¸‹ä¼šå‡ºç°çš„å‡ ç§ç°è±¡ã€‚</p>\n<p><strong>1ã€å‘ç”Ÿ ArrayIndexOutOfBoundsException å¼‚å¸¸ï¼›</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private void add(E e, Object[] elementData, int s) &#123;\n    if (s &#x3D;&#x3D; elementData.length)\n        elementData &#x3D; grow();\n    elementData[s] &#x3D; e;\n    size &#x3D; s + 1;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å®šä½åˆ°å¼‚å¸¸æ‰€åœ¨æºä»£ç ï¼Œæ¯«æ— ç–‘é—®ï¼Œé—®é¢˜æ˜¯å‡ºç°åœ¨å¤šçº¿ç¨‹å¹¶å‘è®¿é—®ä¸‹ï¼Œç”±äºæ²¡æœ‰åŒæ­¥é”çš„ä¿æŠ¤ï¼Œé€ æˆäº† ArrayList æ‰©å®¹ä¸ä¸€è‡´çš„é—®é¢˜ã€‚</p>\n<p><strong>2ã€ç¨‹åºæ­£å¸¸è¿è¡Œï¼Œè¾“å‡ºäº†å°‘äºå®é™…å®¹é‡çš„å¤§å°ï¼›</strong></p>\n<p>è¿™ä¸ªä¹Ÿæ˜¯å¤šçº¿ç¨‹å¹¶å‘èµ‹å€¼æ—¶ï¼Œå¯¹åŒä¸€ä¸ªæ•°ç»„ç´¢å¼•ä½ç½®è¿›è¡Œäº†èµ‹å€¼ï¼Œæ‰€ä»¥å‡ºç°å°‘äºé¢„æœŸå¤§å°çš„æƒ…å†µã€‚</p>\n<p><strong>3ã€ç¨‹åºæ­£å¸¸è¿è¡Œï¼Œè¾“å‡ºäº†é¢„æœŸå®¹é‡çš„å¤§å°ï¼›</strong></p>\n<p>è¿™æ˜¯æ­£å¸¸è¿è¡Œç»“æœï¼Œæœªå‘ç”Ÿå¤šçº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œä½†è¿™æ˜¯ä¸ç¡®å®šæ€§çš„ï¼Œä¸æ˜¯æ¯æ¬¡éƒ½ä¼šè¾¾åˆ°æ­£å¸¸é¢„æœŸçš„ã€‚</p>\n<h4 id=\"è§£å†³æ–¹æ¡ˆ\"><a href=\"#è§£å†³æ–¹æ¡ˆ\" class=\"headerlink\" title=\"è§£å†³æ–¹æ¡ˆ\"></a>è§£å†³æ–¹æ¡ˆ</h4><p>æ—¢ç„¶è¿™æ ·ï¼Œé‚£ä¹ˆåœ¨é«˜å¹¶å‘æƒ…å†µä¸‹ï¼Œä½¿ç”¨ä»€ä¹ˆæ ·çš„åˆ—è¡¨é›†åˆä¿æŠ¤çº¿ç¨‹å®‰å…¨å‘¢ï¼Ÿå›åˆ°æ–‡ç« æœ€å¼€å§‹çš„åœ°æ–¹ï¼Œä½¿ç”¨ Vectorï¼Œè¿˜æœ‰åˆ«çš„å—ï¼Ÿå½“ç„¶æœ‰ï¼Œç¯‡å¹…æœ‰é™ï¼Œè¯·å„ä½çœ‹å®˜æœŸå¾…åç»­æ–‡ç« ã€‚</p>\n<p>å¦å¤–ï¼Œåƒ HashMap, HashSet ç­‰éƒ½æœ‰ç±»ä¼¼å¤šçº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œåœ¨å¤šçº¿ç¨‹å¹¶å‘ç¯å¢ƒä¸‹é¿å…ä½¿ç”¨è¿™ç§é›†åˆã€‚</p>\n","excerpt":"","more":"<p>å·¥ä½œä¸€ä¸¤å¹´çš„åº”è¯¥éƒ½çŸ¥é“ ArrayList æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œè¦ä½¿ç”¨çº¿ç¨‹å®‰å…¨çš„å°±ä½¿ç”¨ Vectorï¼Œè¿™ä¹Ÿæ˜¯å„ç§ Java é¢è¯•å®å…¸é‡Œé¢æ‰€æåŠçš„ï¼Œå¯èƒ½å¾ˆå¤šå·¥ä½œå¥½å‡ å¹´çš„ç¨‹åºå‘˜éƒ½åœç•™åœ¨è¿™ä¸ªçŸ¥è¯†é¢ä¸Šã€‚</p>\n<p>å…ˆè¯´è¯´ä¸ºä»€ä¹ˆ ArrayList æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„å§ï¼Œæ¥çœ‹ä»¥ä¸‹çš„ä»£ç ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * \n *&#x2F;\npublic class TestArrayList &#123;\n\n\tprivate static List&lt;Integer&gt; list &#x3D; new ArrayList&lt;&gt;();\n\n\tpublic static void main(String[] args) throws InterruptedException &#123;\n\t\tfor (int i &#x3D; 0; i &lt; 10; i++) &#123;\n\t\t\ttestList();\n\t\t\tlist.clear();\n\t\t&#125;\n\t&#125;\n\n\tprivate static void testList() throws InterruptedException &#123;\n\t\tRunnable runnable &#x3D; () -&gt; &#123;\n\t\t\tfor (int i &#x3D; 0; i &lt; 10000; i++) &#123;\n\t\t\t\tlist.add(i);\n\t\t\t&#125;\n\t\t&#125;;\n\n\t\tThread t1 &#x3D; new Thread(runnable);\n\t\tThread t2 &#x3D; new Thread(runnable);\n\t\tThread t3 &#x3D; new Thread(runnable);\n\n\t\tt1.start();\n\t\tt2.start();\n\t\tt3.start();\n\n\t\tt1.join();\n\t\tt2.join();\n\t\tt3.join();\n\n\t\tSystem.out.println(list.size());\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™æ˜¯å®ƒçš„è¾“å‡ºç»“æœï¼Œæˆ‘ä»¬æœŸæœ›çš„ç»“æœåº”è¯¥éƒ½æ˜¯ï¼š30000ï¼Œç„¶åå¹¶ä¸æ˜¯ï¼Œè¿™å°±æ˜¯ä¼ è¯´ä¸­çš„å¤šçº¿ç¨‹å¹¶å‘é—®é¢˜äº†ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Exception in thread &quot;Thread-1&quot; java.lang.ArrayIndexOutOfBoundsException: 15786\n\tat java.base&#x2F;java.util.ArrayList.add(ArrayList.java:468)\n\tat java.base&#x2F;java.util.ArrayList.add(ArrayList.java:480)\n\tat com.test.thread.TestArrayList.lambda$testList$0(TestArrayList.java:23)\n\tat java.base&#x2F;java.lang.Thread.run(Thread.java:844)\n20332\n16100\n14941\n23749\n15631\n22118\n27417\n30000\n28691\n27843<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"ç°è±¡åˆ†æ\"><a href=\"#ç°è±¡åˆ†æ\" class=\"headerlink\" title=\"ç°è±¡åˆ†æ\"></a>ç°è±¡åˆ†æ</h4><p>ä»ä»¥ä¸Šç»“æœå¯ä»¥æ€»ç»“å‡º ArrayList åœ¨å¹¶å‘æƒ…å†µä¸‹ä¼šå‡ºç°çš„å‡ ç§ç°è±¡ã€‚</p>\n<p><strong>1ã€å‘ç”Ÿ ArrayIndexOutOfBoundsException å¼‚å¸¸ï¼›</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private void add(E e, Object[] elementData, int s) &#123;\n    if (s &#x3D;&#x3D; elementData.length)\n        elementData &#x3D; grow();\n    elementData[s] &#x3D; e;\n    size &#x3D; s + 1;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å®šä½åˆ°å¼‚å¸¸æ‰€åœ¨æºä»£ç ï¼Œæ¯«æ— ç–‘é—®ï¼Œé—®é¢˜æ˜¯å‡ºç°åœ¨å¤šçº¿ç¨‹å¹¶å‘è®¿é—®ä¸‹ï¼Œç”±äºæ²¡æœ‰åŒæ­¥é”çš„ä¿æŠ¤ï¼Œé€ æˆäº† ArrayList æ‰©å®¹ä¸ä¸€è‡´çš„é—®é¢˜ã€‚</p>\n<p><strong>2ã€ç¨‹åºæ­£å¸¸è¿è¡Œï¼Œè¾“å‡ºäº†å°‘äºå®é™…å®¹é‡çš„å¤§å°ï¼›</strong></p>\n<p>è¿™ä¸ªä¹Ÿæ˜¯å¤šçº¿ç¨‹å¹¶å‘èµ‹å€¼æ—¶ï¼Œå¯¹åŒä¸€ä¸ªæ•°ç»„ç´¢å¼•ä½ç½®è¿›è¡Œäº†èµ‹å€¼ï¼Œæ‰€ä»¥å‡ºç°å°‘äºé¢„æœŸå¤§å°çš„æƒ…å†µã€‚</p>\n<p><strong>3ã€ç¨‹åºæ­£å¸¸è¿è¡Œï¼Œè¾“å‡ºäº†é¢„æœŸå®¹é‡çš„å¤§å°ï¼›</strong></p>\n<p>è¿™æ˜¯æ­£å¸¸è¿è¡Œç»“æœï¼Œæœªå‘ç”Ÿå¤šçº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œä½†è¿™æ˜¯ä¸ç¡®å®šæ€§çš„ï¼Œä¸æ˜¯æ¯æ¬¡éƒ½ä¼šè¾¾åˆ°æ­£å¸¸é¢„æœŸçš„ã€‚</p>\n<h4 id=\"è§£å†³æ–¹æ¡ˆ\"><a href=\"#è§£å†³æ–¹æ¡ˆ\" class=\"headerlink\" title=\"è§£å†³æ–¹æ¡ˆ\"></a>è§£å†³æ–¹æ¡ˆ</h4><p>æ—¢ç„¶è¿™æ ·ï¼Œé‚£ä¹ˆåœ¨é«˜å¹¶å‘æƒ…å†µä¸‹ï¼Œä½¿ç”¨ä»€ä¹ˆæ ·çš„åˆ—è¡¨é›†åˆä¿æŠ¤çº¿ç¨‹å®‰å…¨å‘¢ï¼Ÿå›åˆ°æ–‡ç« æœ€å¼€å§‹çš„åœ°æ–¹ï¼Œä½¿ç”¨ Vectorï¼Œè¿˜æœ‰åˆ«çš„å—ï¼Ÿå½“ç„¶æœ‰ï¼Œç¯‡å¹…æœ‰é™ï¼Œè¯·å„ä½çœ‹å®˜æœŸå¾…åç»­æ–‡ç« ã€‚</p>\n<p>å¦å¤–ï¼Œåƒ HashMap, HashSet ç­‰éƒ½æœ‰ç±»ä¼¼å¤šçº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œåœ¨å¤šçº¿ç¨‹å¹¶å‘ç¯å¢ƒä¸‹é¿å…ä½¿ç”¨è¿™ç§é›†åˆã€‚</p>\n"},{"title":"åˆ°åº•ä»€ä¹ˆæ˜¯é‡å…¥é”ï¼Œæ‹œæ‰˜ï¼Œä¸€æ¬¡ææ¸…æ¥šï¼","date":"2025-10-14T06:42:34.000Z","_content":"\n\n#### ä»€ä¹ˆæ˜¯é‡å…¥é”\n\n> java.util.concurrent.locks.ReentrantLock\n\nè¿™ä¸ªæ˜¯ JDK @since 1.5 æ·»åŠ çš„ä¸€ç§é¢—ç²’åº¦æ›´å°çš„é”ï¼Œå®ƒå®Œå…¨å¯ä»¥æ›¿ä»£ synchronized å…³é”®å­—æ¥å®ç°å®ƒçš„æ‰€æœ‰åŠŸèƒ½ï¼Œè€Œä¸” ReentrantLock é”çš„çµæ´»åº¦è¦è¿œè¿œå¤§äº synchronized å…³é”®å­—ã€‚\n\n![](http://img.javastack.cn/ReentrantLock.png)\n\nä»ç±»ç»“æ„å›¾çœ‹å‡ºï¼ŒReentrantLock å®ç°äº† Lock æ¥å£ï¼ŒReentrantLock åªæ˜¯ Lock æ¥å£çš„ä¸€ä¸ªå®ç°è€Œå·²ã€‚\n\n> java.util.concurrent.locks.Lock\n\nå®ƒä»¬éƒ½æ˜¯ java.util.concurrent åŒ…é‡Œé¢çš„å†…å®¹ï¼ˆä¿—ç§° JUCã€å¹¶å‘åŒ…ï¼‰ï¼Œä¹Ÿéƒ½æ˜¯ JDK 1.5 å¼€å§‹åŠ å…¥çš„ã€‚\n\n#### ä¸ºä»€ä¹ˆå«é‡å…¥é”å‘¢ï¼Ÿ\n\nReentrantLockï¼Œæˆ‘ä»¬æŠŠå®ƒæ‹†å¼€æ¥çœ‹å°±æ˜äº†äº†ã€‚\n\nRe-Entrant-Lockï¼šå³è¡¨ç¤ºå¯é‡æ–°åå¤è¿›å…¥çš„é”ï¼Œä½†ä»…é™äºå½“å‰çº¿ç¨‹ï¼›\n\n```\npublic void m() {\n    lock.lock();\n    lock.lock();\n    try {\n      // ... method body\n    } finally {\n      lock.unlock()\n      lock.unlock()\n    }\n}\n```\n\nå¦‚ç¤ºä¾‹ä»£ç æ‰€ç¤ºï¼Œå½“å‰çº¿ç¨‹å¯ä»¥åå¤åŠ é”ï¼Œä½†ä¹Ÿéœ€è¦é‡Šæ”¾åŒæ ·åŠ é”æ¬¡æ•°çš„é”ï¼Œå³é‡å…¥äº†å¤šå°‘æ¬¡ï¼Œå°±è¦é‡Šæ”¾å¤šå°‘æ¬¡ï¼Œä¸ç„¶ä¹Ÿä¼šå¯¼å…¥é”ä¸è¢«é‡Šæ”¾ã€‚\n\nè¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœä¸è®¾è®¡æˆå¯é‡å…¥é”ï¼Œé‚£è‡ªå·±å¦‚æœåå¤ç»™è‡ªå·±åŠ é”ï¼Œä¸æ˜¯ä¼šæŠŠè‡ªå·±åŠ æ­»é”äº†å—ï¼Ÿæ‰€ä»¥ï¼Œåˆ°ç°åœ¨ï¼Œé‡å…¥é”çš„æ¦‚å¿µå¤§æ¦‚åº”è¯¥æ¸…æ¥šäº†å§ï¼Ÿ\n\n#### é‡å…¥é”æœ€é‡è¦çš„å‡ ä¸ªæ–¹æ³•\n\nè¿™å‡ ä¸ªæ–¹æ³•éƒ½æ˜¯ Lock æ¥å£ä¸­å®šä¹‰çš„ï¼š\n\n![](http://img.javastack.cn/Lock.png)\n\n**1ï¼‰lock()**\n\nè·å–é”ï¼Œæœ‰ä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼š\n\n- é”ç©ºé—²ï¼šç›´æ¥è·å–é”å¹¶è¿”å›ï¼ŒåŒæ—¶è®¾ç½®é”æŒæœ‰è€…æ•°é‡ä¸ºï¼š1ï¼›\n- å½“å‰çº¿ç¨‹æŒæœ‰é”ï¼šç›´æ¥è·å–é”å¹¶è¿”å›ï¼ŒåŒæ—¶é”æŒæœ‰è€…æ•°é‡é€’å¢1ï¼›\n- å…¶ä»–çº¿ç¨‹æŒæœ‰é”ï¼šå½“å‰çº¿ç¨‹ä¼šä¼‘çœ ç­‰å¾…ï¼Œç›´è‡³è·å–é”ä¸ºæ­¢ï¼›\n\n**2ï¼‰lockInterruptibly()**\n\nè·å–é”ï¼Œé€»è¾‘å’Œ lock() æ–¹æ³•ä¸€æ ·ï¼Œä½†è¿™ä¸ªæ–¹æ³•åœ¨è·å–é”è¿‡ç¨‹ä¸­èƒ½å“åº”ä¸­æ–­ã€‚\n\n**3ï¼‰tryLock()**\n\nä»å…³é”®å­—å­—é¢ç†è§£ï¼Œè¿™æ˜¯åœ¨å°è¯•è·å–é”ï¼Œè·å–æˆåŠŸè¿”å›ï¼štrueï¼Œè·å–å¤±è´¥è¿”å›ï¼šfalse, è¿™ä¸ªæ–¹æ³•ä¸ä¼šç­‰å¾…ï¼Œæœ‰ä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼š\n\n- é”ç©ºé—²ï¼šç›´æ¥è·å–é”å¹¶è¿”å›ï¼štrueï¼ŒåŒæ—¶è®¾ç½®é”æŒæœ‰è€…æ•°é‡ä¸ºï¼š1ï¼›\n- å½“å‰çº¿ç¨‹æŒæœ‰é”ï¼šç›´æ¥è·å–é”å¹¶è¿”å›ï¼štrueï¼ŒåŒæ—¶é”æŒæœ‰è€…æ•°é‡é€’å¢1ï¼›\n- å…¶ä»–çº¿ç¨‹æŒæœ‰é”ï¼šè·å–é”å¤±è´¥ï¼Œè¿”å›ï¼šfalseï¼›\n\n**4ï¼‰tryLock(long timeout, TimeUnit unit)**\n\né€»è¾‘å’Œ tryLock() å·®ä¸å¤šï¼Œåªæ˜¯è¿™ä¸ªæ–¹æ³•æ˜¯å¸¦æ—¶é—´çš„ã€‚\n\n**5ï¼‰unlock()**\n\né‡Šæ”¾é”ï¼Œæ¯æ¬¡é”æŒæœ‰è€…æ•°é‡é€’å‡ 1ï¼Œç›´åˆ° 0 ä¸ºæ­¢ã€‚æ‰€ä»¥ï¼Œç°åœ¨çŸ¥é“ä¸ºä»€ä¹ˆ lock å¤šå°‘æ¬¡ï¼Œå°±è¦å¯¹åº” unlock å¤šå°‘æ¬¡äº†å§ã€‚\n\n**6ï¼‰newCondition**\n\nè¿”å›ä¸€ä¸ªè¿™ä¸ªé”çš„ Condition å®ä¾‹ï¼Œå¯ä»¥å®ç° synchronized å…³é”®å­—ç±»ä¼¼ wait/ notify å®ç°å¤šçº¿ç¨‹é€šä¿¡çš„åŠŸèƒ½ï¼Œä¸è¿‡è¿™ä¸ªæ¯” wait/ notify è¦æ›´çµæ´»ï¼Œæ›´å¼ºå¤§ï¼\n\n#### é‡å…¥é”å¤§æ¦‚çš„ç”¨æ³•\n\n```\nclass X {\n\n  private final ReentrantLock lock = new ReentrantLock();\n  \n  // ...\n\n  public void m() {\n    lock.lock();  // block until condition holds\n    try {\n      // ... method body\n    } finally {\n      lock.unlock()\n    }\n  }\n  \n}}\n```\n\nçœ‹è§æ²¡æœ‰ï¼ŒåŠ é”å’Œé‡Šæ”¾é”éƒ½åœ¨æ–¹æ³•é‡Œé¢è¿›è¡Œï¼Œå¯ä»¥è‡ªç”±æ§åˆ¶ï¼Œæ¯” synchronized æ›´çµæ´»ï¼Œæ›´æ–¹ä¾¿ã€‚ä½†è¦æ³¨æ„çš„æ˜¯ï¼Œé‡Šæ”¾é”æ“ä½œå¿…é¡»åœ¨ finally é‡Œé¢ï¼Œä¸ç„¶å¦‚æœå‡ºç°å¼‚å¸¸å¯¼è‡´é”ä¸èƒ½è¢«æ­£å¸¸é‡Šæ”¾ï¼Œè¿›è€Œä¼šå¡æ­»åç»­æ‰€æœ‰è®¿é—®è¯¥é”çš„çº¿ç¨‹ã€‚\n\n#### synchronized æ˜¯é‡å…¥é”å—ï¼Ÿ\n\né‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œsynchronized æ˜¯é‡å…¥é”å—ï¼Ÿ\n\nä½ å¯èƒ½ä¼šè¯´ä¸æ˜¯ï¼Œå› ä¸º ReentrantLock æ—¢ç„¶æ˜¯é‡å…¥é”ï¼Œæ ¹æ®æ¨ç†ï¼Œç›¸åï¼Œé‚£ synchronized è‚¯å®šå°±ä¸æ˜¯é‡å…¥é”ï¼Œé‚£ä½ å°±é”™äº†ã€‚\n\nç­”æ¡ˆæ˜¯ï¼šyesï¼Œä¸ºä»€ä¹ˆï¼Ÿçœ‹ä¸‹é¢çš„ä¾‹å­ï¼š\n\n```\npublic synchronized void operation(){\n    add();\n}\n\npublic synchronized void add(){\n\n}\n```\n\noperation æ–¹æ³•è°ƒç”¨äº† add æ–¹æ³•ï¼Œä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯ç”¨ synchronized ä¿®é¥°çš„ï¼Œadd()  æ–¹æ³•å¯ä»¥æˆåŠŸè·å–å½“å‰çº¿ç¨‹ operation() æ–¹æ³•å·²ç»è·å–åˆ°çš„é”ï¼Œè¯´æ˜ synchronized å°±æ˜¯å¯é‡å…¥é”ã€‚\n\né¢è¯•å¸¸é—®çš„Synchronizedçš„å‡ ç§ç”¨æ³•æ¨èçœ‹ä¸‹è¿™ç¯‡æ–‡ç« ï¼š[Synchronized æœ‰å‡ ç§ç”¨æ³•ï¼Ÿ](https://mp.weixin.qq.com/s/9h6VjHAmLA3twD6Y-FqfwA)ã€‚\n\n#### æ€»ç»“\n\n\n","source":"_posts/å¤šçº¿ç¨‹/åˆ°åº•ä»€ä¹ˆæ˜¯é‡å…¥é”ï¼Œæ‹œæ‰˜ï¼Œä¸€æ¬¡ææ¸…æ¥šï¼.md","raw":"---\ntitle: åˆ°åº•ä»€ä¹ˆæ˜¯é‡å…¥é”ï¼Œæ‹œæ‰˜ï¼Œä¸€æ¬¡ææ¸…æ¥šï¼\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: å¤šçº¿ç¨‹\n---\n\n\n#### ä»€ä¹ˆæ˜¯é‡å…¥é”\n\n> java.util.concurrent.locks.ReentrantLock\n\nè¿™ä¸ªæ˜¯ JDK @since 1.5 æ·»åŠ çš„ä¸€ç§é¢—ç²’åº¦æ›´å°çš„é”ï¼Œå®ƒå®Œå…¨å¯ä»¥æ›¿ä»£ synchronized å…³é”®å­—æ¥å®ç°å®ƒçš„æ‰€æœ‰åŠŸèƒ½ï¼Œè€Œä¸” ReentrantLock é”çš„çµæ´»åº¦è¦è¿œè¿œå¤§äº synchronized å…³é”®å­—ã€‚\n\n![](http://img.javastack.cn/ReentrantLock.png)\n\nä»ç±»ç»“æ„å›¾çœ‹å‡ºï¼ŒReentrantLock å®ç°äº† Lock æ¥å£ï¼ŒReentrantLock åªæ˜¯ Lock æ¥å£çš„ä¸€ä¸ªå®ç°è€Œå·²ã€‚\n\n> java.util.concurrent.locks.Lock\n\nå®ƒä»¬éƒ½æ˜¯ java.util.concurrent åŒ…é‡Œé¢çš„å†…å®¹ï¼ˆä¿—ç§° JUCã€å¹¶å‘åŒ…ï¼‰ï¼Œä¹Ÿéƒ½æ˜¯ JDK 1.5 å¼€å§‹åŠ å…¥çš„ã€‚\n\n#### ä¸ºä»€ä¹ˆå«é‡å…¥é”å‘¢ï¼Ÿ\n\nReentrantLockï¼Œæˆ‘ä»¬æŠŠå®ƒæ‹†å¼€æ¥çœ‹å°±æ˜äº†äº†ã€‚\n\nRe-Entrant-Lockï¼šå³è¡¨ç¤ºå¯é‡æ–°åå¤è¿›å…¥çš„é”ï¼Œä½†ä»…é™äºå½“å‰çº¿ç¨‹ï¼›\n\n```\npublic void m() {\n    lock.lock();\n    lock.lock();\n    try {\n      // ... method body\n    } finally {\n      lock.unlock()\n      lock.unlock()\n    }\n}\n```\n\nå¦‚ç¤ºä¾‹ä»£ç æ‰€ç¤ºï¼Œå½“å‰çº¿ç¨‹å¯ä»¥åå¤åŠ é”ï¼Œä½†ä¹Ÿéœ€è¦é‡Šæ”¾åŒæ ·åŠ é”æ¬¡æ•°çš„é”ï¼Œå³é‡å…¥äº†å¤šå°‘æ¬¡ï¼Œå°±è¦é‡Šæ”¾å¤šå°‘æ¬¡ï¼Œä¸ç„¶ä¹Ÿä¼šå¯¼å…¥é”ä¸è¢«é‡Šæ”¾ã€‚\n\nè¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœä¸è®¾è®¡æˆå¯é‡å…¥é”ï¼Œé‚£è‡ªå·±å¦‚æœåå¤ç»™è‡ªå·±åŠ é”ï¼Œä¸æ˜¯ä¼šæŠŠè‡ªå·±åŠ æ­»é”äº†å—ï¼Ÿæ‰€ä»¥ï¼Œåˆ°ç°åœ¨ï¼Œé‡å…¥é”çš„æ¦‚å¿µå¤§æ¦‚åº”è¯¥æ¸…æ¥šäº†å§ï¼Ÿ\n\n#### é‡å…¥é”æœ€é‡è¦çš„å‡ ä¸ªæ–¹æ³•\n\nè¿™å‡ ä¸ªæ–¹æ³•éƒ½æ˜¯ Lock æ¥å£ä¸­å®šä¹‰çš„ï¼š\n\n![](http://img.javastack.cn/Lock.png)\n\n**1ï¼‰lock()**\n\nè·å–é”ï¼Œæœ‰ä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼š\n\n- é”ç©ºé—²ï¼šç›´æ¥è·å–é”å¹¶è¿”å›ï¼ŒåŒæ—¶è®¾ç½®é”æŒæœ‰è€…æ•°é‡ä¸ºï¼š1ï¼›\n- å½“å‰çº¿ç¨‹æŒæœ‰é”ï¼šç›´æ¥è·å–é”å¹¶è¿”å›ï¼ŒåŒæ—¶é”æŒæœ‰è€…æ•°é‡é€’å¢1ï¼›\n- å…¶ä»–çº¿ç¨‹æŒæœ‰é”ï¼šå½“å‰çº¿ç¨‹ä¼šä¼‘çœ ç­‰å¾…ï¼Œç›´è‡³è·å–é”ä¸ºæ­¢ï¼›\n\n**2ï¼‰lockInterruptibly()**\n\nè·å–é”ï¼Œé€»è¾‘å’Œ lock() æ–¹æ³•ä¸€æ ·ï¼Œä½†è¿™ä¸ªæ–¹æ³•åœ¨è·å–é”è¿‡ç¨‹ä¸­èƒ½å“åº”ä¸­æ–­ã€‚\n\n**3ï¼‰tryLock()**\n\nä»å…³é”®å­—å­—é¢ç†è§£ï¼Œè¿™æ˜¯åœ¨å°è¯•è·å–é”ï¼Œè·å–æˆåŠŸè¿”å›ï¼štrueï¼Œè·å–å¤±è´¥è¿”å›ï¼šfalse, è¿™ä¸ªæ–¹æ³•ä¸ä¼šç­‰å¾…ï¼Œæœ‰ä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼š\n\n- é”ç©ºé—²ï¼šç›´æ¥è·å–é”å¹¶è¿”å›ï¼štrueï¼ŒåŒæ—¶è®¾ç½®é”æŒæœ‰è€…æ•°é‡ä¸ºï¼š1ï¼›\n- å½“å‰çº¿ç¨‹æŒæœ‰é”ï¼šç›´æ¥è·å–é”å¹¶è¿”å›ï¼štrueï¼ŒåŒæ—¶é”æŒæœ‰è€…æ•°é‡é€’å¢1ï¼›\n- å…¶ä»–çº¿ç¨‹æŒæœ‰é”ï¼šè·å–é”å¤±è´¥ï¼Œè¿”å›ï¼šfalseï¼›\n\n**4ï¼‰tryLock(long timeout, TimeUnit unit)**\n\né€»è¾‘å’Œ tryLock() å·®ä¸å¤šï¼Œåªæ˜¯è¿™ä¸ªæ–¹æ³•æ˜¯å¸¦æ—¶é—´çš„ã€‚\n\n**5ï¼‰unlock()**\n\né‡Šæ”¾é”ï¼Œæ¯æ¬¡é”æŒæœ‰è€…æ•°é‡é€’å‡ 1ï¼Œç›´åˆ° 0 ä¸ºæ­¢ã€‚æ‰€ä»¥ï¼Œç°åœ¨çŸ¥é“ä¸ºä»€ä¹ˆ lock å¤šå°‘æ¬¡ï¼Œå°±è¦å¯¹åº” unlock å¤šå°‘æ¬¡äº†å§ã€‚\n\n**6ï¼‰newCondition**\n\nè¿”å›ä¸€ä¸ªè¿™ä¸ªé”çš„ Condition å®ä¾‹ï¼Œå¯ä»¥å®ç° synchronized å…³é”®å­—ç±»ä¼¼ wait/ notify å®ç°å¤šçº¿ç¨‹é€šä¿¡çš„åŠŸèƒ½ï¼Œä¸è¿‡è¿™ä¸ªæ¯” wait/ notify è¦æ›´çµæ´»ï¼Œæ›´å¼ºå¤§ï¼\n\n#### é‡å…¥é”å¤§æ¦‚çš„ç”¨æ³•\n\n```\nclass X {\n\n  private final ReentrantLock lock = new ReentrantLock();\n  \n  // ...\n\n  public void m() {\n    lock.lock();  // block until condition holds\n    try {\n      // ... method body\n    } finally {\n      lock.unlock()\n    }\n  }\n  \n}}\n```\n\nçœ‹è§æ²¡æœ‰ï¼ŒåŠ é”å’Œé‡Šæ”¾é”éƒ½åœ¨æ–¹æ³•é‡Œé¢è¿›è¡Œï¼Œå¯ä»¥è‡ªç”±æ§åˆ¶ï¼Œæ¯” synchronized æ›´çµæ´»ï¼Œæ›´æ–¹ä¾¿ã€‚ä½†è¦æ³¨æ„çš„æ˜¯ï¼Œé‡Šæ”¾é”æ“ä½œå¿…é¡»åœ¨ finally é‡Œé¢ï¼Œä¸ç„¶å¦‚æœå‡ºç°å¼‚å¸¸å¯¼è‡´é”ä¸èƒ½è¢«æ­£å¸¸é‡Šæ”¾ï¼Œè¿›è€Œä¼šå¡æ­»åç»­æ‰€æœ‰è®¿é—®è¯¥é”çš„çº¿ç¨‹ã€‚\n\n#### synchronized æ˜¯é‡å…¥é”å—ï¼Ÿ\n\né‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œsynchronized æ˜¯é‡å…¥é”å—ï¼Ÿ\n\nä½ å¯èƒ½ä¼šè¯´ä¸æ˜¯ï¼Œå› ä¸º ReentrantLock æ—¢ç„¶æ˜¯é‡å…¥é”ï¼Œæ ¹æ®æ¨ç†ï¼Œç›¸åï¼Œé‚£ synchronized è‚¯å®šå°±ä¸æ˜¯é‡å…¥é”ï¼Œé‚£ä½ å°±é”™äº†ã€‚\n\nç­”æ¡ˆæ˜¯ï¼šyesï¼Œä¸ºä»€ä¹ˆï¼Ÿçœ‹ä¸‹é¢çš„ä¾‹å­ï¼š\n\n```\npublic synchronized void operation(){\n    add();\n}\n\npublic synchronized void add(){\n\n}\n```\n\noperation æ–¹æ³•è°ƒç”¨äº† add æ–¹æ³•ï¼Œä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯ç”¨ synchronized ä¿®é¥°çš„ï¼Œadd()  æ–¹æ³•å¯ä»¥æˆåŠŸè·å–å½“å‰çº¿ç¨‹ operation() æ–¹æ³•å·²ç»è·å–åˆ°çš„é”ï¼Œè¯´æ˜ synchronized å°±æ˜¯å¯é‡å…¥é”ã€‚\n\né¢è¯•å¸¸é—®çš„Synchronizedçš„å‡ ç§ç”¨æ³•æ¨èçœ‹ä¸‹è¿™ç¯‡æ–‡ç« ï¼š[Synchronized æœ‰å‡ ç§ç”¨æ³•ï¼Ÿ](https://mp.weixin.qq.com/s/9h6VjHAmLA3twD6Y-FqfwA)ã€‚\n\n#### æ€»ç»“\n\n\n","slug":"å¤šçº¿ç¨‹/åˆ°åº•ä»€ä¹ˆæ˜¯é‡å…¥é”ï¼Œæ‹œæ‰˜ï¼Œä¸€æ¬¡ææ¸…æ¥šï¼","published":1,"updated":"2025-10-15T07:20:25.077Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076o002iqkd4296q7rb9","content":"<h4 id=\"ä»€ä¹ˆæ˜¯é‡å…¥é”\"><a href=\"#ä»€ä¹ˆæ˜¯é‡å…¥é”\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯é‡å…¥é”\"></a>ä»€ä¹ˆæ˜¯é‡å…¥é”</h4><blockquote>\n<p>java.util.concurrent.locks.ReentrantLock</p>\n</blockquote>\n<p>è¿™ä¸ªæ˜¯ JDK @since 1.5 æ·»åŠ çš„ä¸€ç§é¢—ç²’åº¦æ›´å°çš„é”ï¼Œå®ƒå®Œå…¨å¯ä»¥æ›¿ä»£ synchronized å…³é”®å­—æ¥å®ç°å®ƒçš„æ‰€æœ‰åŠŸèƒ½ï¼Œè€Œä¸” ReentrantLock é”çš„çµæ´»åº¦è¦è¿œè¿œå¤§äº synchronized å…³é”®å­—ã€‚</p>\n<p><img src=\"http://img.javastack.cn/ReentrantLock.png\"></p>\n<p>ä»ç±»ç»“æ„å›¾çœ‹å‡ºï¼ŒReentrantLock å®ç°äº† Lock æ¥å£ï¼ŒReentrantLock åªæ˜¯ Lock æ¥å£çš„ä¸€ä¸ªå®ç°è€Œå·²ã€‚</p>\n<blockquote>\n<p>java.util.concurrent.locks.Lock</p>\n</blockquote>\n<p>å®ƒä»¬éƒ½æ˜¯ java.util.concurrent åŒ…é‡Œé¢çš„å†…å®¹ï¼ˆä¿—ç§° JUCã€å¹¶å‘åŒ…ï¼‰ï¼Œä¹Ÿéƒ½æ˜¯ JDK 1.5 å¼€å§‹åŠ å…¥çš„ã€‚</p>\n<h4 id=\"ä¸ºä»€ä¹ˆå«é‡å…¥é”å‘¢ï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆå«é‡å…¥é”å‘¢ï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆå«é‡å…¥é”å‘¢ï¼Ÿ\"></a>ä¸ºä»€ä¹ˆå«é‡å…¥é”å‘¢ï¼Ÿ</h4><p>ReentrantLockï¼Œæˆ‘ä»¬æŠŠå®ƒæ‹†å¼€æ¥çœ‹å°±æ˜äº†äº†ã€‚</p>\n<p>Re-Entrant-Lockï¼šå³è¡¨ç¤ºå¯é‡æ–°åå¤è¿›å…¥çš„é”ï¼Œä½†ä»…é™äºå½“å‰çº¿ç¨‹ï¼›</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public void m() &#123;\n    lock.lock();\n    lock.lock();\n    try &#123;\n      &#x2F;&#x2F; ... method body\n    &#125; finally &#123;\n      lock.unlock()\n      lock.unlock()\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¦‚ç¤ºä¾‹ä»£ç æ‰€ç¤ºï¼Œå½“å‰çº¿ç¨‹å¯ä»¥åå¤åŠ é”ï¼Œä½†ä¹Ÿéœ€è¦é‡Šæ”¾åŒæ ·åŠ é”æ¬¡æ•°çš„é”ï¼Œå³é‡å…¥äº†å¤šå°‘æ¬¡ï¼Œå°±è¦é‡Šæ”¾å¤šå°‘æ¬¡ï¼Œä¸ç„¶ä¹Ÿä¼šå¯¼å…¥é”ä¸è¢«é‡Šæ”¾ã€‚</p>\n<p>è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœä¸è®¾è®¡æˆå¯é‡å…¥é”ï¼Œé‚£è‡ªå·±å¦‚æœåå¤ç»™è‡ªå·±åŠ é”ï¼Œä¸æ˜¯ä¼šæŠŠè‡ªå·±åŠ æ­»é”äº†å—ï¼Ÿæ‰€ä»¥ï¼Œåˆ°ç°åœ¨ï¼Œé‡å…¥é”çš„æ¦‚å¿µå¤§æ¦‚åº”è¯¥æ¸…æ¥šäº†å§ï¼Ÿ</p>\n<h4 id=\"é‡å…¥é”æœ€é‡è¦çš„å‡ ä¸ªæ–¹æ³•\"><a href=\"#é‡å…¥é”æœ€é‡è¦çš„å‡ ä¸ªæ–¹æ³•\" class=\"headerlink\" title=\"é‡å…¥é”æœ€é‡è¦çš„å‡ ä¸ªæ–¹æ³•\"></a>é‡å…¥é”æœ€é‡è¦çš„å‡ ä¸ªæ–¹æ³•</h4><p>è¿™å‡ ä¸ªæ–¹æ³•éƒ½æ˜¯ Lock æ¥å£ä¸­å®šä¹‰çš„ï¼š</p>\n<p><img src=\"http://img.javastack.cn/Lock.png\"></p>\n<p><strong>1ï¼‰lock()</strong></p>\n<p>è·å–é”ï¼Œæœ‰ä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼š</p>\n<ul>\n<li>é”ç©ºé—²ï¼šç›´æ¥è·å–é”å¹¶è¿”å›ï¼ŒåŒæ—¶è®¾ç½®é”æŒæœ‰è€…æ•°é‡ä¸ºï¼š1ï¼›</li>\n<li>å½“å‰çº¿ç¨‹æŒæœ‰é”ï¼šç›´æ¥è·å–é”å¹¶è¿”å›ï¼ŒåŒæ—¶é”æŒæœ‰è€…æ•°é‡é€’å¢1ï¼›</li>\n<li>å…¶ä»–çº¿ç¨‹æŒæœ‰é”ï¼šå½“å‰çº¿ç¨‹ä¼šä¼‘çœ ç­‰å¾…ï¼Œç›´è‡³è·å–é”ä¸ºæ­¢ï¼›</li>\n</ul>\n<p><strong>2ï¼‰lockInterruptibly()</strong></p>\n<p>è·å–é”ï¼Œé€»è¾‘å’Œ lock() æ–¹æ³•ä¸€æ ·ï¼Œä½†è¿™ä¸ªæ–¹æ³•åœ¨è·å–é”è¿‡ç¨‹ä¸­èƒ½å“åº”ä¸­æ–­ã€‚</p>\n<p><strong>3ï¼‰tryLock()</strong></p>\n<p>ä»å…³é”®å­—å­—é¢ç†è§£ï¼Œè¿™æ˜¯åœ¨å°è¯•è·å–é”ï¼Œè·å–æˆåŠŸè¿”å›ï¼štrueï¼Œè·å–å¤±è´¥è¿”å›ï¼šfalse, è¿™ä¸ªæ–¹æ³•ä¸ä¼šç­‰å¾…ï¼Œæœ‰ä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼š</p>\n<ul>\n<li>é”ç©ºé—²ï¼šç›´æ¥è·å–é”å¹¶è¿”å›ï¼štrueï¼ŒåŒæ—¶è®¾ç½®é”æŒæœ‰è€…æ•°é‡ä¸ºï¼š1ï¼›</li>\n<li>å½“å‰çº¿ç¨‹æŒæœ‰é”ï¼šç›´æ¥è·å–é”å¹¶è¿”å›ï¼štrueï¼ŒåŒæ—¶é”æŒæœ‰è€…æ•°é‡é€’å¢1ï¼›</li>\n<li>å…¶ä»–çº¿ç¨‹æŒæœ‰é”ï¼šè·å–é”å¤±è´¥ï¼Œè¿”å›ï¼šfalseï¼›</li>\n</ul>\n<p><strong>4ï¼‰tryLock(long timeout, TimeUnit unit)</strong></p>\n<p>é€»è¾‘å’Œ tryLock() å·®ä¸å¤šï¼Œåªæ˜¯è¿™ä¸ªæ–¹æ³•æ˜¯å¸¦æ—¶é—´çš„ã€‚</p>\n<p><strong>5ï¼‰unlock()</strong></p>\n<p>é‡Šæ”¾é”ï¼Œæ¯æ¬¡é”æŒæœ‰è€…æ•°é‡é€’å‡ 1ï¼Œç›´åˆ° 0 ä¸ºæ­¢ã€‚æ‰€ä»¥ï¼Œç°åœ¨çŸ¥é“ä¸ºä»€ä¹ˆ lock å¤šå°‘æ¬¡ï¼Œå°±è¦å¯¹åº” unlock å¤šå°‘æ¬¡äº†å§ã€‚</p>\n<p><strong>6ï¼‰newCondition</strong></p>\n<p>è¿”å›ä¸€ä¸ªè¿™ä¸ªé”çš„ Condition å®ä¾‹ï¼Œå¯ä»¥å®ç° synchronized å…³é”®å­—ç±»ä¼¼ wait&#x2F; notify å®ç°å¤šçº¿ç¨‹é€šä¿¡çš„åŠŸèƒ½ï¼Œä¸è¿‡è¿™ä¸ªæ¯” wait&#x2F; notify è¦æ›´çµæ´»ï¼Œæ›´å¼ºå¤§ï¼</p>\n<h4 id=\"é‡å…¥é”å¤§æ¦‚çš„ç”¨æ³•\"><a href=\"#é‡å…¥é”å¤§æ¦‚çš„ç”¨æ³•\" class=\"headerlink\" title=\"é‡å…¥é”å¤§æ¦‚çš„ç”¨æ³•\"></a>é‡å…¥é”å¤§æ¦‚çš„ç”¨æ³•</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">class X &#123;\n\n  private final ReentrantLock lock &#x3D; new ReentrantLock();\n  \n  &#x2F;&#x2F; ...\n\n  public void m() &#123;\n    lock.lock();  &#x2F;&#x2F; block until condition holds\n    try &#123;\n      &#x2F;&#x2F; ... method body\n    &#125; finally &#123;\n      lock.unlock()\n    &#125;\n  &#125;\n  \n&#125;&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>çœ‹è§æ²¡æœ‰ï¼ŒåŠ é”å’Œé‡Šæ”¾é”éƒ½åœ¨æ–¹æ³•é‡Œé¢è¿›è¡Œï¼Œå¯ä»¥è‡ªç”±æ§åˆ¶ï¼Œæ¯” synchronized æ›´çµæ´»ï¼Œæ›´æ–¹ä¾¿ã€‚ä½†è¦æ³¨æ„çš„æ˜¯ï¼Œé‡Šæ”¾é”æ“ä½œå¿…é¡»åœ¨ finally é‡Œé¢ï¼Œä¸ç„¶å¦‚æœå‡ºç°å¼‚å¸¸å¯¼è‡´é”ä¸èƒ½è¢«æ­£å¸¸é‡Šæ”¾ï¼Œè¿›è€Œä¼šå¡æ­»åç»­æ‰€æœ‰è®¿é—®è¯¥é”çš„çº¿ç¨‹ã€‚</p>\n<h4 id=\"synchronized-æ˜¯é‡å…¥é”å—ï¼Ÿ\"><a href=\"#synchronized-æ˜¯é‡å…¥é”å—ï¼Ÿ\" class=\"headerlink\" title=\"synchronized æ˜¯é‡å…¥é”å—ï¼Ÿ\"></a>synchronized æ˜¯é‡å…¥é”å—ï¼Ÿ</h4><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œsynchronized æ˜¯é‡å…¥é”å—ï¼Ÿ</p>\n<p>ä½ å¯èƒ½ä¼šè¯´ä¸æ˜¯ï¼Œå› ä¸º ReentrantLock æ—¢ç„¶æ˜¯é‡å…¥é”ï¼Œæ ¹æ®æ¨ç†ï¼Œç›¸åï¼Œé‚£ synchronized è‚¯å®šå°±ä¸æ˜¯é‡å…¥é”ï¼Œé‚£ä½ å°±é”™äº†ã€‚</p>\n<p>ç­”æ¡ˆæ˜¯ï¼šyesï¼Œä¸ºä»€ä¹ˆï¼Ÿçœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public synchronized void operation()&#123;\n    add();\n&#125;\n\npublic synchronized void add()&#123;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>operation æ–¹æ³•è°ƒç”¨äº† add æ–¹æ³•ï¼Œä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯ç”¨ synchronized ä¿®é¥°çš„ï¼Œadd()  æ–¹æ³•å¯ä»¥æˆåŠŸè·å–å½“å‰çº¿ç¨‹ operation() æ–¹æ³•å·²ç»è·å–åˆ°çš„é”ï¼Œè¯´æ˜ synchronized å°±æ˜¯å¯é‡å…¥é”ã€‚</p>\n<p>é¢è¯•å¸¸é—®çš„Synchronizedçš„å‡ ç§ç”¨æ³•æ¨èçœ‹ä¸‹è¿™ç¯‡æ–‡ç« ï¼š<a href=\"https://mp.weixin.qq.com/s/9h6VjHAmLA3twD6Y-FqfwA\">Synchronized æœ‰å‡ ç§ç”¨æ³•ï¼Ÿ</a>ã€‚</p>\n<h4 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h4>","excerpt":"","more":"<h4 id=\"ä»€ä¹ˆæ˜¯é‡å…¥é”\"><a href=\"#ä»€ä¹ˆæ˜¯é‡å…¥é”\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯é‡å…¥é”\"></a>ä»€ä¹ˆæ˜¯é‡å…¥é”</h4><blockquote>\n<p>java.util.concurrent.locks.ReentrantLock</p>\n</blockquote>\n<p>è¿™ä¸ªæ˜¯ JDK @since 1.5 æ·»åŠ çš„ä¸€ç§é¢—ç²’åº¦æ›´å°çš„é”ï¼Œå®ƒå®Œå…¨å¯ä»¥æ›¿ä»£ synchronized å…³é”®å­—æ¥å®ç°å®ƒçš„æ‰€æœ‰åŠŸèƒ½ï¼Œè€Œä¸” ReentrantLock é”çš„çµæ´»åº¦è¦è¿œè¿œå¤§äº synchronized å…³é”®å­—ã€‚</p>\n<p><img src=\"http://img.javastack.cn/ReentrantLock.png\"></p>\n<p>ä»ç±»ç»“æ„å›¾çœ‹å‡ºï¼ŒReentrantLock å®ç°äº† Lock æ¥å£ï¼ŒReentrantLock åªæ˜¯ Lock æ¥å£çš„ä¸€ä¸ªå®ç°è€Œå·²ã€‚</p>\n<blockquote>\n<p>java.util.concurrent.locks.Lock</p>\n</blockquote>\n<p>å®ƒä»¬éƒ½æ˜¯ java.util.concurrent åŒ…é‡Œé¢çš„å†…å®¹ï¼ˆä¿—ç§° JUCã€å¹¶å‘åŒ…ï¼‰ï¼Œä¹Ÿéƒ½æ˜¯ JDK 1.5 å¼€å§‹åŠ å…¥çš„ã€‚</p>\n<h4 id=\"ä¸ºä»€ä¹ˆå«é‡å…¥é”å‘¢ï¼Ÿ\"><a href=\"#ä¸ºä»€ä¹ˆå«é‡å…¥é”å‘¢ï¼Ÿ\" class=\"headerlink\" title=\"ä¸ºä»€ä¹ˆå«é‡å…¥é”å‘¢ï¼Ÿ\"></a>ä¸ºä»€ä¹ˆå«é‡å…¥é”å‘¢ï¼Ÿ</h4><p>ReentrantLockï¼Œæˆ‘ä»¬æŠŠå®ƒæ‹†å¼€æ¥çœ‹å°±æ˜äº†äº†ã€‚</p>\n<p>Re-Entrant-Lockï¼šå³è¡¨ç¤ºå¯é‡æ–°åå¤è¿›å…¥çš„é”ï¼Œä½†ä»…é™äºå½“å‰çº¿ç¨‹ï¼›</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public void m() &#123;\n    lock.lock();\n    lock.lock();\n    try &#123;\n      &#x2F;&#x2F; ... method body\n    &#125; finally &#123;\n      lock.unlock()\n      lock.unlock()\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¦‚ç¤ºä¾‹ä»£ç æ‰€ç¤ºï¼Œå½“å‰çº¿ç¨‹å¯ä»¥åå¤åŠ é”ï¼Œä½†ä¹Ÿéœ€è¦é‡Šæ”¾åŒæ ·åŠ é”æ¬¡æ•°çš„é”ï¼Œå³é‡å…¥äº†å¤šå°‘æ¬¡ï¼Œå°±è¦é‡Šæ”¾å¤šå°‘æ¬¡ï¼Œä¸ç„¶ä¹Ÿä¼šå¯¼å…¥é”ä¸è¢«é‡Šæ”¾ã€‚</p>\n<p>è¯•æƒ³ä¸€ä¸‹ï¼Œå¦‚æœä¸è®¾è®¡æˆå¯é‡å…¥é”ï¼Œé‚£è‡ªå·±å¦‚æœåå¤ç»™è‡ªå·±åŠ é”ï¼Œä¸æ˜¯ä¼šæŠŠè‡ªå·±åŠ æ­»é”äº†å—ï¼Ÿæ‰€ä»¥ï¼Œåˆ°ç°åœ¨ï¼Œé‡å…¥é”çš„æ¦‚å¿µå¤§æ¦‚åº”è¯¥æ¸…æ¥šäº†å§ï¼Ÿ</p>\n<h4 id=\"é‡å…¥é”æœ€é‡è¦çš„å‡ ä¸ªæ–¹æ³•\"><a href=\"#é‡å…¥é”æœ€é‡è¦çš„å‡ ä¸ªæ–¹æ³•\" class=\"headerlink\" title=\"é‡å…¥é”æœ€é‡è¦çš„å‡ ä¸ªæ–¹æ³•\"></a>é‡å…¥é”æœ€é‡è¦çš„å‡ ä¸ªæ–¹æ³•</h4><p>è¿™å‡ ä¸ªæ–¹æ³•éƒ½æ˜¯ Lock æ¥å£ä¸­å®šä¹‰çš„ï¼š</p>\n<p><img src=\"http://img.javastack.cn/Lock.png\"></p>\n<p><strong>1ï¼‰lock()</strong></p>\n<p>è·å–é”ï¼Œæœ‰ä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼š</p>\n<ul>\n<li>é”ç©ºé—²ï¼šç›´æ¥è·å–é”å¹¶è¿”å›ï¼ŒåŒæ—¶è®¾ç½®é”æŒæœ‰è€…æ•°é‡ä¸ºï¼š1ï¼›</li>\n<li>å½“å‰çº¿ç¨‹æŒæœ‰é”ï¼šç›´æ¥è·å–é”å¹¶è¿”å›ï¼ŒåŒæ—¶é”æŒæœ‰è€…æ•°é‡é€’å¢1ï¼›</li>\n<li>å…¶ä»–çº¿ç¨‹æŒæœ‰é”ï¼šå½“å‰çº¿ç¨‹ä¼šä¼‘çœ ç­‰å¾…ï¼Œç›´è‡³è·å–é”ä¸ºæ­¢ï¼›</li>\n</ul>\n<p><strong>2ï¼‰lockInterruptibly()</strong></p>\n<p>è·å–é”ï¼Œé€»è¾‘å’Œ lock() æ–¹æ³•ä¸€æ ·ï¼Œä½†è¿™ä¸ªæ–¹æ³•åœ¨è·å–é”è¿‡ç¨‹ä¸­èƒ½å“åº”ä¸­æ–­ã€‚</p>\n<p><strong>3ï¼‰tryLock()</strong></p>\n<p>ä»å…³é”®å­—å­—é¢ç†è§£ï¼Œè¿™æ˜¯åœ¨å°è¯•è·å–é”ï¼Œè·å–æˆåŠŸè¿”å›ï¼štrueï¼Œè·å–å¤±è´¥è¿”å›ï¼šfalse, è¿™ä¸ªæ–¹æ³•ä¸ä¼šç­‰å¾…ï¼Œæœ‰ä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼š</p>\n<ul>\n<li>é”ç©ºé—²ï¼šç›´æ¥è·å–é”å¹¶è¿”å›ï¼štrueï¼ŒåŒæ—¶è®¾ç½®é”æŒæœ‰è€…æ•°é‡ä¸ºï¼š1ï¼›</li>\n<li>å½“å‰çº¿ç¨‹æŒæœ‰é”ï¼šç›´æ¥è·å–é”å¹¶è¿”å›ï¼štrueï¼ŒåŒæ—¶é”æŒæœ‰è€…æ•°é‡é€’å¢1ï¼›</li>\n<li>å…¶ä»–çº¿ç¨‹æŒæœ‰é”ï¼šè·å–é”å¤±è´¥ï¼Œè¿”å›ï¼šfalseï¼›</li>\n</ul>\n<p><strong>4ï¼‰tryLock(long timeout, TimeUnit unit)</strong></p>\n<p>é€»è¾‘å’Œ tryLock() å·®ä¸å¤šï¼Œåªæ˜¯è¿™ä¸ªæ–¹æ³•æ˜¯å¸¦æ—¶é—´çš„ã€‚</p>\n<p><strong>5ï¼‰unlock()</strong></p>\n<p>é‡Šæ”¾é”ï¼Œæ¯æ¬¡é”æŒæœ‰è€…æ•°é‡é€’å‡ 1ï¼Œç›´åˆ° 0 ä¸ºæ­¢ã€‚æ‰€ä»¥ï¼Œç°åœ¨çŸ¥é“ä¸ºä»€ä¹ˆ lock å¤šå°‘æ¬¡ï¼Œå°±è¦å¯¹åº” unlock å¤šå°‘æ¬¡äº†å§ã€‚</p>\n<p><strong>6ï¼‰newCondition</strong></p>\n<p>è¿”å›ä¸€ä¸ªè¿™ä¸ªé”çš„ Condition å®ä¾‹ï¼Œå¯ä»¥å®ç° synchronized å…³é”®å­—ç±»ä¼¼ wait&#x2F; notify å®ç°å¤šçº¿ç¨‹é€šä¿¡çš„åŠŸèƒ½ï¼Œä¸è¿‡è¿™ä¸ªæ¯” wait&#x2F; notify è¦æ›´çµæ´»ï¼Œæ›´å¼ºå¤§ï¼</p>\n<h4 id=\"é‡å…¥é”å¤§æ¦‚çš„ç”¨æ³•\"><a href=\"#é‡å…¥é”å¤§æ¦‚çš„ç”¨æ³•\" class=\"headerlink\" title=\"é‡å…¥é”å¤§æ¦‚çš„ç”¨æ³•\"></a>é‡å…¥é”å¤§æ¦‚çš„ç”¨æ³•</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">class X &#123;\n\n  private final ReentrantLock lock &#x3D; new ReentrantLock();\n  \n  &#x2F;&#x2F; ...\n\n  public void m() &#123;\n    lock.lock();  &#x2F;&#x2F; block until condition holds\n    try &#123;\n      &#x2F;&#x2F; ... method body\n    &#125; finally &#123;\n      lock.unlock()\n    &#125;\n  &#125;\n  \n&#125;&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>çœ‹è§æ²¡æœ‰ï¼ŒåŠ é”å’Œé‡Šæ”¾é”éƒ½åœ¨æ–¹æ³•é‡Œé¢è¿›è¡Œï¼Œå¯ä»¥è‡ªç”±æ§åˆ¶ï¼Œæ¯” synchronized æ›´çµæ´»ï¼Œæ›´æ–¹ä¾¿ã€‚ä½†è¦æ³¨æ„çš„æ˜¯ï¼Œé‡Šæ”¾é”æ“ä½œå¿…é¡»åœ¨ finally é‡Œé¢ï¼Œä¸ç„¶å¦‚æœå‡ºç°å¼‚å¸¸å¯¼è‡´é”ä¸èƒ½è¢«æ­£å¸¸é‡Šæ”¾ï¼Œè¿›è€Œä¼šå¡æ­»åç»­æ‰€æœ‰è®¿é—®è¯¥é”çš„çº¿ç¨‹ã€‚</p>\n<h4 id=\"synchronized-æ˜¯é‡å…¥é”å—ï¼Ÿ\"><a href=\"#synchronized-æ˜¯é‡å…¥é”å—ï¼Ÿ\" class=\"headerlink\" title=\"synchronized æ˜¯é‡å…¥é”å—ï¼Ÿ\"></a>synchronized æ˜¯é‡å…¥é”å—ï¼Ÿ</h4><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œsynchronized æ˜¯é‡å…¥é”å—ï¼Ÿ</p>\n<p>ä½ å¯èƒ½ä¼šè¯´ä¸æ˜¯ï¼Œå› ä¸º ReentrantLock æ—¢ç„¶æ˜¯é‡å…¥é”ï¼Œæ ¹æ®æ¨ç†ï¼Œç›¸åï¼Œé‚£ synchronized è‚¯å®šå°±ä¸æ˜¯é‡å…¥é”ï¼Œé‚£ä½ å°±é”™äº†ã€‚</p>\n<p>ç­”æ¡ˆæ˜¯ï¼šyesï¼Œä¸ºä»€ä¹ˆï¼Ÿçœ‹ä¸‹é¢çš„ä¾‹å­ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public synchronized void operation()&#123;\n    add();\n&#125;\n\npublic synchronized void add()&#123;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>operation æ–¹æ³•è°ƒç”¨äº† add æ–¹æ³•ï¼Œä¸¤ä¸ªæ–¹æ³•éƒ½æ˜¯ç”¨ synchronized ä¿®é¥°çš„ï¼Œadd()  æ–¹æ³•å¯ä»¥æˆåŠŸè·å–å½“å‰çº¿ç¨‹ operation() æ–¹æ³•å·²ç»è·å–åˆ°çš„é”ï¼Œè¯´æ˜ synchronized å°±æ˜¯å¯é‡å…¥é”ã€‚</p>\n<p>é¢è¯•å¸¸é—®çš„Synchronizedçš„å‡ ç§ç”¨æ³•æ¨èçœ‹ä¸‹è¿™ç¯‡æ–‡ç« ï¼š<a href=\"https://mp.weixin.qq.com/s/9h6VjHAmLA3twD6Y-FqfwA\">Synchronized æœ‰å‡ ç§ç”¨æ³•ï¼Ÿ</a>ã€‚</p>\n<h4 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h4>"},{"title":"å¤šçº¿ç¨‹ Thread.yield æ–¹æ³•åˆ°åº•æœ‰ä»€ä¹ˆç”¨ï¼Ÿ","date":"2025-10-14T06:42:34.000Z","_content":"\n## æ¦‚å¿µ\n\næˆ‘ä»¬çŸ¥é“ start() æ–¹æ³•æ˜¯å¯åŠ¨çº¿ç¨‹ï¼Œè®©çº¿ç¨‹å˜æˆå°±ç»ªçŠ¶æ€ç­‰å¾… CPU è°ƒåº¦åæ‰§è¡Œã€‚\n\né‚£ yield() æ–¹æ³•æ˜¯å¹²ä»€ä¹ˆç”¨çš„å‘¢ï¼Ÿæ¥çœ‹ä¸‹æºç ã€‚\n\n```\n/**\n * A hint to the scheduler that the current thread is willing to yield\n * its current use of a processor. The scheduler is free to ignore this\n * hint.\n *\n * <p> Yield is a heuristic attempt to improve relative progression\n * between threads that would otherwise over-utilise a CPU. Its use\n * should be combined with detailed profiling and benchmarking to\n * ensure that it actually has the desired effect.\n *\n * <p> It is rarely appropriate to use this method. It may be useful\n * for debugging or testing purposes, where it may help to reproduce\n * bugs due to race conditions. It may also be useful when designing\n * concurrency control constructs such as the ones in the\n * {@link java.util.concurrent.locks} package.\n */\npublic static native void yield();\n```\n\nyield å³ \"è°¦è®©\"ï¼Œä¹Ÿæ˜¯ Thread ç±»çš„æ–¹æ³•ã€‚å®ƒè®©æ‰å½“å‰çº¿ç¨‹ CPU çš„æ—¶é—´ç‰‡ï¼Œä½¿æ­£åœ¨è¿è¡Œä¸­çš„çº¿ç¨‹é‡æ–°å˜æˆå°±ç»ªçŠ¶æ€ï¼Œå¹¶é‡æ–°ç«äº‰ CPU çš„è°ƒåº¦æƒã€‚å®ƒå¯èƒ½ä¼šè·å–åˆ°ï¼Œä¹Ÿæœ‰å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹è·å–åˆ°ã€‚\n\n## å®æˆ˜\n\nä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ç¤ºä¾‹ã€‚\n\n```\n/**\n * \n */\npublic static void main(String[] args) {\n\tRunnable runnable = () -> {\n\t\tfor (int i = 0; i <= 100; i++) {\n\t\t\tSystem.out.println(Thread.currentThread().getName() + \"-----\" + i);\n\t\t\tif (i % 20 == 0) {\n\t\t\t\tThread.yield();\n\t\t\t}\n\t\t}\n\t};\n\tnew Thread(runnable, \"æ ˆé•¿\").start();\n    new Thread(runnable, \"å°èœœ\").start();\n}\n```\n\nè¿™ä¸ªç¤ºä¾‹æ¯å½“æ‰§è¡Œå®Œ 20 ä¸ªä¹‹åå°±è®©å‡º CPUï¼Œæ¯æ¬¡è°¦è®©åå°±ä¼šé©¬ä¸Šè·å–åˆ°è°ƒåº¦æƒç»§ç»­æ‰§è¡Œã€‚\n\n**è¿è¡Œä»¥ä¸Šç¨‹åºï¼Œå¯ä»¥æœ‰ä»¥ä¸‹ä¸¤ç§ç»“æœã€‚**\n\nç»“æœ1ï¼šæ ˆé•¿è®©å‡ºäº† CPU èµ„æºï¼Œå°èœœæˆåŠŸä¸Šä½ã€‚\n\n```\næ ˆé•¿-----29\næ ˆé•¿-----30\nå°èœœ-----26\næ ˆé•¿-----31\n```\n\nç»“æœ2ï¼šæ ˆé•¿è®©å‡ºäº† CPU èµ„æºï¼Œæ ˆé•¿ç»§ç»­è¿è¡Œã€‚\n\n```\næ ˆé•¿-----28\næ ˆé•¿-----29\næ ˆé•¿-----30\næ ˆé•¿-----31\n```\n\nè€Œå¦‚æœæˆ‘ä»¬æŠŠä¸¤ä¸ªçº¿ç¨‹åŠ ä¸Šçº¿ç¨‹ä¼˜å…ˆçº§ï¼Œé‚£è¾“å‡ºçš„ç»“æœåˆä¸ä¸€æ ·ã€‚\n\n```\nthread1.setPriority(Thread.MIN_PRIORITY);\nthread2.setPriority(Thread.MAX_PRIORITY);\n```\n\nå› ä¸ºç»™å°èœœåŠ äº†æœ€é«˜ä¼˜å…ˆæƒï¼Œæ ˆé•¿åŠ äº†æœ€ä½ä¼˜å…ˆæƒï¼Œå³ä½¿æ ˆé•¿å…ˆå¯åŠ¨ï¼Œé‚£å°èœœè¿˜æ˜¯æœ‰å¾ˆå¤§çš„æ¦‚ç‡æ¯”æ ˆé•¿å…ˆä¼šè¾“å‡ºå®Œçš„ï¼Œå¤§å®¶å¯ä»¥è¯•ä¸€ä¸‹ã€‚\n\n## yield å’Œ sleep çš„å¼‚åŒ\n\n1ï¼‰yield, sleep éƒ½èƒ½æš‚åœå½“å‰çº¿ç¨‹ï¼Œsleep å¯ä»¥æŒ‡å®šå…·ä½“ä¼‘çœ çš„æ—¶é—´ï¼Œè€Œ yield åˆ™ä¾èµ– CPU çš„æ—¶é—´ç‰‡åˆ’åˆ†ã€‚\n\n2ï¼‰yield, sleep ä¸¤ä¸ªåœ¨æš‚åœè¿‡ç¨‹ä¸­ï¼Œå¦‚å·²ç»æŒæœ‰é”ï¼Œåˆ™éƒ½ä¸ä¼šé‡Šæ”¾é”èµ„æºã€‚\n\n3ï¼‰yield ä¸èƒ½è¢«ä¸­æ–­ï¼Œè€Œ sleep åˆ™å¯ä»¥æ¥å—ä¸­æ–­ã€‚\n\n## æ€»ç»“ \n\næ ˆé•¿æ²¡ç”¨è¿‡ yieldï¼Œæ„Ÿè§‰æ²¡ä»€ä¹ˆé¸Ÿç”¨ã€‚\n\nå¦‚æœä¸€å®šè¦ç”¨å®ƒçš„è¯ï¼Œä¸€å¥è¯è§£é‡Šå°±æ˜¯ï¼šyield æ–¹æ³•å¯ä»¥å¾ˆå¥½çš„æ§åˆ¶å¤šçº¿ç¨‹ï¼Œå¦‚æ‰§è¡ŒæŸé¡¹å¤æ‚çš„ä»»åŠ¡æ—¶ï¼Œå¦‚æœæ‹…å¿ƒå ç”¨èµ„æºè¿‡å¤šï¼Œå¯ä»¥åœ¨å®ŒæˆæŸä¸ªé‡è¦çš„å·¥ä½œåä½¿ç”¨ yield æ–¹æ³•è®©æ‰å½“å‰ CPU çš„è°ƒåº¦æƒï¼Œç­‰ä¸‹æ¬¡è·å–åˆ°å†ç»§ç»­æ‰§è¡Œï¼Œè¿™æ ·ä¸ä½†èƒ½å®Œæˆè‡ªå·±çš„é‡è¦å·¥ä½œï¼Œä¹Ÿèƒ½ç»™å…¶ä»–çº¿ç¨‹ä¸€äº›è¿è¡Œçš„æœºä¼šï¼Œé¿å…ä¸€ä¸ªçº¿ç¨‹é•¿æ—¶é—´å æœ‰ CPU èµ„æºã€‚\n\n\n\n","source":"_posts/å¤šçº¿ç¨‹/å¤šçº¿ç¨‹ Thread.yield æ–¹æ³•åˆ°åº•æœ‰ä»€ä¹ˆç”¨ï¼Ÿ.md","raw":"---\ntitle: å¤šçº¿ç¨‹ Thread.yield æ–¹æ³•åˆ°åº•æœ‰ä»€ä¹ˆç”¨ï¼Ÿ\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: å¤šçº¿ç¨‹\n---\n\n## æ¦‚å¿µ\n\næˆ‘ä»¬çŸ¥é“ start() æ–¹æ³•æ˜¯å¯åŠ¨çº¿ç¨‹ï¼Œè®©çº¿ç¨‹å˜æˆå°±ç»ªçŠ¶æ€ç­‰å¾… CPU è°ƒåº¦åæ‰§è¡Œã€‚\n\né‚£ yield() æ–¹æ³•æ˜¯å¹²ä»€ä¹ˆç”¨çš„å‘¢ï¼Ÿæ¥çœ‹ä¸‹æºç ã€‚\n\n```\n/**\n * A hint to the scheduler that the current thread is willing to yield\n * its current use of a processor. The scheduler is free to ignore this\n * hint.\n *\n * <p> Yield is a heuristic attempt to improve relative progression\n * between threads that would otherwise over-utilise a CPU. Its use\n * should be combined with detailed profiling and benchmarking to\n * ensure that it actually has the desired effect.\n *\n * <p> It is rarely appropriate to use this method. It may be useful\n * for debugging or testing purposes, where it may help to reproduce\n * bugs due to race conditions. It may also be useful when designing\n * concurrency control constructs such as the ones in the\n * {@link java.util.concurrent.locks} package.\n */\npublic static native void yield();\n```\n\nyield å³ \"è°¦è®©\"ï¼Œä¹Ÿæ˜¯ Thread ç±»çš„æ–¹æ³•ã€‚å®ƒè®©æ‰å½“å‰çº¿ç¨‹ CPU çš„æ—¶é—´ç‰‡ï¼Œä½¿æ­£åœ¨è¿è¡Œä¸­çš„çº¿ç¨‹é‡æ–°å˜æˆå°±ç»ªçŠ¶æ€ï¼Œå¹¶é‡æ–°ç«äº‰ CPU çš„è°ƒåº¦æƒã€‚å®ƒå¯èƒ½ä¼šè·å–åˆ°ï¼Œä¹Ÿæœ‰å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹è·å–åˆ°ã€‚\n\n## å®æˆ˜\n\nä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ç¤ºä¾‹ã€‚\n\n```\n/**\n * \n */\npublic static void main(String[] args) {\n\tRunnable runnable = () -> {\n\t\tfor (int i = 0; i <= 100; i++) {\n\t\t\tSystem.out.println(Thread.currentThread().getName() + \"-----\" + i);\n\t\t\tif (i % 20 == 0) {\n\t\t\t\tThread.yield();\n\t\t\t}\n\t\t}\n\t};\n\tnew Thread(runnable, \"æ ˆé•¿\").start();\n    new Thread(runnable, \"å°èœœ\").start();\n}\n```\n\nè¿™ä¸ªç¤ºä¾‹æ¯å½“æ‰§è¡Œå®Œ 20 ä¸ªä¹‹åå°±è®©å‡º CPUï¼Œæ¯æ¬¡è°¦è®©åå°±ä¼šé©¬ä¸Šè·å–åˆ°è°ƒåº¦æƒç»§ç»­æ‰§è¡Œã€‚\n\n**è¿è¡Œä»¥ä¸Šç¨‹åºï¼Œå¯ä»¥æœ‰ä»¥ä¸‹ä¸¤ç§ç»“æœã€‚**\n\nç»“æœ1ï¼šæ ˆé•¿è®©å‡ºäº† CPU èµ„æºï¼Œå°èœœæˆåŠŸä¸Šä½ã€‚\n\n```\næ ˆé•¿-----29\næ ˆé•¿-----30\nå°èœœ-----26\næ ˆé•¿-----31\n```\n\nç»“æœ2ï¼šæ ˆé•¿è®©å‡ºäº† CPU èµ„æºï¼Œæ ˆé•¿ç»§ç»­è¿è¡Œã€‚\n\n```\næ ˆé•¿-----28\næ ˆé•¿-----29\næ ˆé•¿-----30\næ ˆé•¿-----31\n```\n\nè€Œå¦‚æœæˆ‘ä»¬æŠŠä¸¤ä¸ªçº¿ç¨‹åŠ ä¸Šçº¿ç¨‹ä¼˜å…ˆçº§ï¼Œé‚£è¾“å‡ºçš„ç»“æœåˆä¸ä¸€æ ·ã€‚\n\n```\nthread1.setPriority(Thread.MIN_PRIORITY);\nthread2.setPriority(Thread.MAX_PRIORITY);\n```\n\nå› ä¸ºç»™å°èœœåŠ äº†æœ€é«˜ä¼˜å…ˆæƒï¼Œæ ˆé•¿åŠ äº†æœ€ä½ä¼˜å…ˆæƒï¼Œå³ä½¿æ ˆé•¿å…ˆå¯åŠ¨ï¼Œé‚£å°èœœè¿˜æ˜¯æœ‰å¾ˆå¤§çš„æ¦‚ç‡æ¯”æ ˆé•¿å…ˆä¼šè¾“å‡ºå®Œçš„ï¼Œå¤§å®¶å¯ä»¥è¯•ä¸€ä¸‹ã€‚\n\n## yield å’Œ sleep çš„å¼‚åŒ\n\n1ï¼‰yield, sleep éƒ½èƒ½æš‚åœå½“å‰çº¿ç¨‹ï¼Œsleep å¯ä»¥æŒ‡å®šå…·ä½“ä¼‘çœ çš„æ—¶é—´ï¼Œè€Œ yield åˆ™ä¾èµ– CPU çš„æ—¶é—´ç‰‡åˆ’åˆ†ã€‚\n\n2ï¼‰yield, sleep ä¸¤ä¸ªåœ¨æš‚åœè¿‡ç¨‹ä¸­ï¼Œå¦‚å·²ç»æŒæœ‰é”ï¼Œåˆ™éƒ½ä¸ä¼šé‡Šæ”¾é”èµ„æºã€‚\n\n3ï¼‰yield ä¸èƒ½è¢«ä¸­æ–­ï¼Œè€Œ sleep åˆ™å¯ä»¥æ¥å—ä¸­æ–­ã€‚\n\n## æ€»ç»“ \n\næ ˆé•¿æ²¡ç”¨è¿‡ yieldï¼Œæ„Ÿè§‰æ²¡ä»€ä¹ˆé¸Ÿç”¨ã€‚\n\nå¦‚æœä¸€å®šè¦ç”¨å®ƒçš„è¯ï¼Œä¸€å¥è¯è§£é‡Šå°±æ˜¯ï¼šyield æ–¹æ³•å¯ä»¥å¾ˆå¥½çš„æ§åˆ¶å¤šçº¿ç¨‹ï¼Œå¦‚æ‰§è¡ŒæŸé¡¹å¤æ‚çš„ä»»åŠ¡æ—¶ï¼Œå¦‚æœæ‹…å¿ƒå ç”¨èµ„æºè¿‡å¤šï¼Œå¯ä»¥åœ¨å®ŒæˆæŸä¸ªé‡è¦çš„å·¥ä½œåä½¿ç”¨ yield æ–¹æ³•è®©æ‰å½“å‰ CPU çš„è°ƒåº¦æƒï¼Œç­‰ä¸‹æ¬¡è·å–åˆ°å†ç»§ç»­æ‰§è¡Œï¼Œè¿™æ ·ä¸ä½†èƒ½å®Œæˆè‡ªå·±çš„é‡è¦å·¥ä½œï¼Œä¹Ÿèƒ½ç»™å…¶ä»–çº¿ç¨‹ä¸€äº›è¿è¡Œçš„æœºä¼šï¼Œé¿å…ä¸€ä¸ªçº¿ç¨‹é•¿æ—¶é—´å æœ‰ CPU èµ„æºã€‚\n\n\n\n","slug":"å¤šçº¿ç¨‹/å¤šçº¿ç¨‹ Thread.yield æ–¹æ³•åˆ°åº•æœ‰ä»€ä¹ˆç”¨ï¼Ÿ","published":1,"updated":"2025-10-15T07:20:25.018Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076p002lqkd437gr0xfm","content":"<h2 id=\"æ¦‚å¿µ\"><a href=\"#æ¦‚å¿µ\" class=\"headerlink\" title=\"æ¦‚å¿µ\"></a>æ¦‚å¿µ</h2><p>æˆ‘ä»¬çŸ¥é“ start() æ–¹æ³•æ˜¯å¯åŠ¨çº¿ç¨‹ï¼Œè®©çº¿ç¨‹å˜æˆå°±ç»ªçŠ¶æ€ç­‰å¾… CPU è°ƒåº¦åæ‰§è¡Œã€‚</p>\n<p>é‚£ yield() æ–¹æ³•æ˜¯å¹²ä»€ä¹ˆç”¨çš„å‘¢ï¼Ÿæ¥çœ‹ä¸‹æºç ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * A hint to the scheduler that the current thread is willing to yield\n * its current use of a processor. The scheduler is free to ignore this\n * hint.\n *\n * &lt;p&gt; Yield is a heuristic attempt to improve relative progression\n * between threads that would otherwise over-utilise a CPU. Its use\n * should be combined with detailed profiling and benchmarking to\n * ensure that it actually has the desired effect.\n *\n * &lt;p&gt; It is rarely appropriate to use this method. It may be useful\n * for debugging or testing purposes, where it may help to reproduce\n * bugs due to race conditions. It may also be useful when designing\n * concurrency control constructs such as the ones in the\n * &#123;@link java.util.concurrent.locks&#125; package.\n *&#x2F;\npublic static native void yield();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>yield å³ â€œè°¦è®©â€ï¼Œä¹Ÿæ˜¯ Thread ç±»çš„æ–¹æ³•ã€‚å®ƒè®©æ‰å½“å‰çº¿ç¨‹ CPU çš„æ—¶é—´ç‰‡ï¼Œä½¿æ­£åœ¨è¿è¡Œä¸­çš„çº¿ç¨‹é‡æ–°å˜æˆå°±ç»ªçŠ¶æ€ï¼Œå¹¶é‡æ–°ç«äº‰ CPU çš„è°ƒåº¦æƒã€‚å®ƒå¯èƒ½ä¼šè·å–åˆ°ï¼Œä¹Ÿæœ‰å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹è·å–åˆ°ã€‚</p>\n<h2 id=\"å®æˆ˜\"><a href=\"#å®æˆ˜\" class=\"headerlink\" title=\"å®æˆ˜\"></a>å®æˆ˜</h2><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ç¤ºä¾‹ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * \n *&#x2F;\npublic static void main(String[] args) &#123;\n\tRunnable runnable &#x3D; () -&gt; &#123;\n\t\tfor (int i &#x3D; 0; i &lt;&#x3D; 100; i++) &#123;\n\t\t\tSystem.out.println(Thread.currentThread().getName() + &quot;-----&quot; + i);\n\t\t\tif (i % 20 &#x3D;&#x3D; 0) &#123;\n\t\t\t\tThread.yield();\n\t\t\t&#125;\n\t\t&#125;\n\t&#125;;\n\tnew Thread(runnable, &quot;æ ˆé•¿&quot;).start();\n    new Thread(runnable, &quot;å°èœœ&quot;).start();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªç¤ºä¾‹æ¯å½“æ‰§è¡Œå®Œ 20 ä¸ªä¹‹åå°±è®©å‡º CPUï¼Œæ¯æ¬¡è°¦è®©åå°±ä¼šé©¬ä¸Šè·å–åˆ°è°ƒåº¦æƒç»§ç»­æ‰§è¡Œã€‚</p>\n<p><strong>è¿è¡Œä»¥ä¸Šç¨‹åºï¼Œå¯ä»¥æœ‰ä»¥ä¸‹ä¸¤ç§ç»“æœã€‚</strong></p>\n<p>ç»“æœ1ï¼šæ ˆé•¿è®©å‡ºäº† CPU èµ„æºï¼Œå°èœœæˆåŠŸä¸Šä½ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">æ ˆé•¿-----29\næ ˆé•¿-----30\nå°èœœ-----26\næ ˆé•¿-----31<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç»“æœ2ï¼šæ ˆé•¿è®©å‡ºäº† CPU èµ„æºï¼Œæ ˆé•¿ç»§ç»­è¿è¡Œã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">æ ˆé•¿-----28\næ ˆé•¿-----29\næ ˆé•¿-----30\næ ˆé•¿-----31<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è€Œå¦‚æœæˆ‘ä»¬æŠŠä¸¤ä¸ªçº¿ç¨‹åŠ ä¸Šçº¿ç¨‹ä¼˜å…ˆçº§ï¼Œé‚£è¾“å‡ºçš„ç»“æœåˆä¸ä¸€æ ·ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">thread1.setPriority(Thread.MIN_PRIORITY);\nthread2.setPriority(Thread.MAX_PRIORITY);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>å› ä¸ºç»™å°èœœåŠ äº†æœ€é«˜ä¼˜å…ˆæƒï¼Œæ ˆé•¿åŠ äº†æœ€ä½ä¼˜å…ˆæƒï¼Œå³ä½¿æ ˆé•¿å…ˆå¯åŠ¨ï¼Œé‚£å°èœœè¿˜æ˜¯æœ‰å¾ˆå¤§çš„æ¦‚ç‡æ¯”æ ˆé•¿å…ˆä¼šè¾“å‡ºå®Œçš„ï¼Œå¤§å®¶å¯ä»¥è¯•ä¸€ä¸‹ã€‚</p>\n<h2 id=\"yield-å’Œ-sleep-çš„å¼‚åŒ\"><a href=\"#yield-å’Œ-sleep-çš„å¼‚åŒ\" class=\"headerlink\" title=\"yield å’Œ sleep çš„å¼‚åŒ\"></a>yield å’Œ sleep çš„å¼‚åŒ</h2><p>1ï¼‰yield, sleep éƒ½èƒ½æš‚åœå½“å‰çº¿ç¨‹ï¼Œsleep å¯ä»¥æŒ‡å®šå…·ä½“ä¼‘çœ çš„æ—¶é—´ï¼Œè€Œ yield åˆ™ä¾èµ– CPU çš„æ—¶é—´ç‰‡åˆ’åˆ†ã€‚</p>\n<p>2ï¼‰yield, sleep ä¸¤ä¸ªåœ¨æš‚åœè¿‡ç¨‹ä¸­ï¼Œå¦‚å·²ç»æŒæœ‰é”ï¼Œåˆ™éƒ½ä¸ä¼šé‡Šæ”¾é”èµ„æºã€‚</p>\n<p>3ï¼‰yield ä¸èƒ½è¢«ä¸­æ–­ï¼Œè€Œ sleep åˆ™å¯ä»¥æ¥å—ä¸­æ–­ã€‚</p>\n<h2 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h2><p>æ ˆé•¿æ²¡ç”¨è¿‡ yieldï¼Œæ„Ÿè§‰æ²¡ä»€ä¹ˆé¸Ÿç”¨ã€‚</p>\n<p>å¦‚æœä¸€å®šè¦ç”¨å®ƒçš„è¯ï¼Œä¸€å¥è¯è§£é‡Šå°±æ˜¯ï¼šyield æ–¹æ³•å¯ä»¥å¾ˆå¥½çš„æ§åˆ¶å¤šçº¿ç¨‹ï¼Œå¦‚æ‰§è¡ŒæŸé¡¹å¤æ‚çš„ä»»åŠ¡æ—¶ï¼Œå¦‚æœæ‹…å¿ƒå ç”¨èµ„æºè¿‡å¤šï¼Œå¯ä»¥åœ¨å®ŒæˆæŸä¸ªé‡è¦çš„å·¥ä½œåä½¿ç”¨ yield æ–¹æ³•è®©æ‰å½“å‰ CPU çš„è°ƒåº¦æƒï¼Œç­‰ä¸‹æ¬¡è·å–åˆ°å†ç»§ç»­æ‰§è¡Œï¼Œè¿™æ ·ä¸ä½†èƒ½å®Œæˆè‡ªå·±çš„é‡è¦å·¥ä½œï¼Œä¹Ÿèƒ½ç»™å…¶ä»–çº¿ç¨‹ä¸€äº›è¿è¡Œçš„æœºä¼šï¼Œé¿å…ä¸€ä¸ªçº¿ç¨‹é•¿æ—¶é—´å æœ‰ CPU èµ„æºã€‚</p>\n","excerpt":"","more":"<h2 id=\"æ¦‚å¿µ\"><a href=\"#æ¦‚å¿µ\" class=\"headerlink\" title=\"æ¦‚å¿µ\"></a>æ¦‚å¿µ</h2><p>æˆ‘ä»¬çŸ¥é“ start() æ–¹æ³•æ˜¯å¯åŠ¨çº¿ç¨‹ï¼Œè®©çº¿ç¨‹å˜æˆå°±ç»ªçŠ¶æ€ç­‰å¾… CPU è°ƒåº¦åæ‰§è¡Œã€‚</p>\n<p>é‚£ yield() æ–¹æ³•æ˜¯å¹²ä»€ä¹ˆç”¨çš„å‘¢ï¼Ÿæ¥çœ‹ä¸‹æºç ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * A hint to the scheduler that the current thread is willing to yield\n * its current use of a processor. The scheduler is free to ignore this\n * hint.\n *\n * &lt;p&gt; Yield is a heuristic attempt to improve relative progression\n * between threads that would otherwise over-utilise a CPU. Its use\n * should be combined with detailed profiling and benchmarking to\n * ensure that it actually has the desired effect.\n *\n * &lt;p&gt; It is rarely appropriate to use this method. It may be useful\n * for debugging or testing purposes, where it may help to reproduce\n * bugs due to race conditions. It may also be useful when designing\n * concurrency control constructs such as the ones in the\n * &#123;@link java.util.concurrent.locks&#125; package.\n *&#x2F;\npublic static native void yield();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>yield å³ â€œè°¦è®©â€ï¼Œä¹Ÿæ˜¯ Thread ç±»çš„æ–¹æ³•ã€‚å®ƒè®©æ‰å½“å‰çº¿ç¨‹ CPU çš„æ—¶é—´ç‰‡ï¼Œä½¿æ­£åœ¨è¿è¡Œä¸­çš„çº¿ç¨‹é‡æ–°å˜æˆå°±ç»ªçŠ¶æ€ï¼Œå¹¶é‡æ–°ç«äº‰ CPU çš„è°ƒåº¦æƒã€‚å®ƒå¯èƒ½ä¼šè·å–åˆ°ï¼Œä¹Ÿæœ‰å¯èƒ½è¢«å…¶ä»–çº¿ç¨‹è·å–åˆ°ã€‚</p>\n<h2 id=\"å®æˆ˜\"><a href=\"#å®æˆ˜\" class=\"headerlink\" title=\"å®æˆ˜\"></a>å®æˆ˜</h2><p>ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ç¤ºä¾‹ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * \n *&#x2F;\npublic static void main(String[] args) &#123;\n\tRunnable runnable &#x3D; () -&gt; &#123;\n\t\tfor (int i &#x3D; 0; i &lt;&#x3D; 100; i++) &#123;\n\t\t\tSystem.out.println(Thread.currentThread().getName() + &quot;-----&quot; + i);\n\t\t\tif (i % 20 &#x3D;&#x3D; 0) &#123;\n\t\t\t\tThread.yield();\n\t\t\t&#125;\n\t\t&#125;\n\t&#125;;\n\tnew Thread(runnable, &quot;æ ˆé•¿&quot;).start();\n    new Thread(runnable, &quot;å°èœœ&quot;).start();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªç¤ºä¾‹æ¯å½“æ‰§è¡Œå®Œ 20 ä¸ªä¹‹åå°±è®©å‡º CPUï¼Œæ¯æ¬¡è°¦è®©åå°±ä¼šé©¬ä¸Šè·å–åˆ°è°ƒåº¦æƒç»§ç»­æ‰§è¡Œã€‚</p>\n<p><strong>è¿è¡Œä»¥ä¸Šç¨‹åºï¼Œå¯ä»¥æœ‰ä»¥ä¸‹ä¸¤ç§ç»“æœã€‚</strong></p>\n<p>ç»“æœ1ï¼šæ ˆé•¿è®©å‡ºäº† CPU èµ„æºï¼Œå°èœœæˆåŠŸä¸Šä½ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">æ ˆé•¿-----29\næ ˆé•¿-----30\nå°èœœ-----26\næ ˆé•¿-----31<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç»“æœ2ï¼šæ ˆé•¿è®©å‡ºäº† CPU èµ„æºï¼Œæ ˆé•¿ç»§ç»­è¿è¡Œã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">æ ˆé•¿-----28\næ ˆé•¿-----29\næ ˆé•¿-----30\næ ˆé•¿-----31<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è€Œå¦‚æœæˆ‘ä»¬æŠŠä¸¤ä¸ªçº¿ç¨‹åŠ ä¸Šçº¿ç¨‹ä¼˜å…ˆçº§ï¼Œé‚£è¾“å‡ºçš„ç»“æœåˆä¸ä¸€æ ·ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">thread1.setPriority(Thread.MIN_PRIORITY);\nthread2.setPriority(Thread.MAX_PRIORITY);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>å› ä¸ºç»™å°èœœåŠ äº†æœ€é«˜ä¼˜å…ˆæƒï¼Œæ ˆé•¿åŠ äº†æœ€ä½ä¼˜å…ˆæƒï¼Œå³ä½¿æ ˆé•¿å…ˆå¯åŠ¨ï¼Œé‚£å°èœœè¿˜æ˜¯æœ‰å¾ˆå¤§çš„æ¦‚ç‡æ¯”æ ˆé•¿å…ˆä¼šè¾“å‡ºå®Œçš„ï¼Œå¤§å®¶å¯ä»¥è¯•ä¸€ä¸‹ã€‚</p>\n<h2 id=\"yield-å’Œ-sleep-çš„å¼‚åŒ\"><a href=\"#yield-å’Œ-sleep-çš„å¼‚åŒ\" class=\"headerlink\" title=\"yield å’Œ sleep çš„å¼‚åŒ\"></a>yield å’Œ sleep çš„å¼‚åŒ</h2><p>1ï¼‰yield, sleep éƒ½èƒ½æš‚åœå½“å‰çº¿ç¨‹ï¼Œsleep å¯ä»¥æŒ‡å®šå…·ä½“ä¼‘çœ çš„æ—¶é—´ï¼Œè€Œ yield åˆ™ä¾èµ– CPU çš„æ—¶é—´ç‰‡åˆ’åˆ†ã€‚</p>\n<p>2ï¼‰yield, sleep ä¸¤ä¸ªåœ¨æš‚åœè¿‡ç¨‹ä¸­ï¼Œå¦‚å·²ç»æŒæœ‰é”ï¼Œåˆ™éƒ½ä¸ä¼šé‡Šæ”¾é”èµ„æºã€‚</p>\n<p>3ï¼‰yield ä¸èƒ½è¢«ä¸­æ–­ï¼Œè€Œ sleep åˆ™å¯ä»¥æ¥å—ä¸­æ–­ã€‚</p>\n<h2 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h2><p>æ ˆé•¿æ²¡ç”¨è¿‡ yieldï¼Œæ„Ÿè§‰æ²¡ä»€ä¹ˆé¸Ÿç”¨ã€‚</p>\n<p>å¦‚æœä¸€å®šè¦ç”¨å®ƒçš„è¯ï¼Œä¸€å¥è¯è§£é‡Šå°±æ˜¯ï¼šyield æ–¹æ³•å¯ä»¥å¾ˆå¥½çš„æ§åˆ¶å¤šçº¿ç¨‹ï¼Œå¦‚æ‰§è¡ŒæŸé¡¹å¤æ‚çš„ä»»åŠ¡æ—¶ï¼Œå¦‚æœæ‹…å¿ƒå ç”¨èµ„æºè¿‡å¤šï¼Œå¯ä»¥åœ¨å®ŒæˆæŸä¸ªé‡è¦çš„å·¥ä½œåä½¿ç”¨ yield æ–¹æ³•è®©æ‰å½“å‰ CPU çš„è°ƒåº¦æƒï¼Œç­‰ä¸‹æ¬¡è·å–åˆ°å†ç»§ç»­æ‰§è¡Œï¼Œè¿™æ ·ä¸ä½†èƒ½å®Œæˆè‡ªå·±çš„é‡è¦å·¥ä½œï¼Œä¹Ÿèƒ½ç»™å…¶ä»–çº¿ç¨‹ä¸€äº›è¿è¡Œçš„æœºä¼šï¼Œé¿å…ä¸€ä¸ªçº¿ç¨‹é•¿æ—¶é—´å æœ‰ CPU èµ„æºã€‚</p>\n"},{"title":"å¤šçº¿ç¨‹ start å’Œ run æ–¹æ³•åˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ","date":"2025-10-14T06:42:34.000Z","_content":"\n**é¦–å…ˆè¦çŸ¥é“å®ç°å¤šçº¿ç¨‹æœ€åŸºæœ¬çš„ä¸¤ç§æ–¹å¼ï¼š**\n\n1ã€ç»§æ‰¿ `java.lang.Thread` ç±»ï¼›\n\n2ã€å®ç° `java.lang.Runnable`æ¥å£ï¼›\n\nå…¶ä¸­ Thread ç±»ä¹Ÿæ˜¯å®ç°äº† Runnable æ¥å£ï¼Œè€Œ Runnable æ¥å£å®šä¹‰äº†å”¯ä¸€çš„ä¸€ä¸ª run() æ–¹æ³•ï¼Œæ‰€ä»¥åŸºäº Thread å’Œ Runnable åˆ›å»ºå¤šçº¿ç¨‹éƒ½éœ€è¦å®ç° run() æ–¹æ³•ï¼Œæ˜¯å¤šçº¿ç¨‹çœŸæ­£è¿è¡Œçš„ä¸»æ–¹æ³•ã€‚\n\n```\n@FunctionalInterface\npublic interface Runnable {\n    public abstract void run();\n}\n```\n\nè€Œ start() æ–¹æ³•åˆ™æ˜¯ Thread ç±»çš„æ–¹æ³•ï¼Œç”¨æ¥å¼‚æ­¥å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼Œç„¶åä¸»çº¿ç¨‹ç«‹åˆ»è¿”å›ã€‚è¯¥å¯åŠ¨çš„çº¿ç¨‹ä¸ä¼šé©¬ä¸Šè¿è¡Œï¼Œä¼šæ”¾åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­ç­‰å¾… CPU è°ƒåº¦ï¼Œåªæœ‰çº¿ç¨‹çœŸæ­£è¢« CPU è°ƒåº¦æ—¶æ‰ä¼šè°ƒç”¨ run() æ–¹æ³•æ‰§è¡Œã€‚\n\næ‰€ä»¥ start() æ–¹æ³•åªæ˜¯æ ‡è¯†çº¿ç¨‹ä¸ºå°±ç»ªçŠ¶æ€çš„ä¸€ä¸ªé™„åŠ æ–¹æ³•ï¼Œä»¥ä¸‹ start() æ–¹æ³•çš„æºç ï¼Œå…¶ä¸­ start0() æ˜¯ä¸€ä¸ªæœ¬åœ° native æ–¹æ³•ã€‚\n\n```\npublic synchronized void start() {\n    if (threadStatus != 0)\n        throw new IllegalThreadStateException();\n\n    group.add(this);\n\n    boolean started = false;\n    try {\n        start0();\n        started = true;\n    } finally {\n        try {\n            if (!started) {\n                group.threadStartFailed(this);\n            }\n        } catch (Throwable ignore) {\n            /* do nothing. If start0 threw a Throwable then\n              it will be passed up the call stack */\n        }\n    }\n}\n```\n\nè¯·æ³¨æ„ï¼Œstart() æ–¹æ³•è¢«æ ‡è¯†ä¸º synchronized çš„ï¼Œå³ä¸ºäº†é˜²æ­¢è¢«å¤šæ¬¡å¯åŠ¨çš„ä¸€ä¸ªåŒæ­¥æ“ä½œã€‚\n\n**é‚£ä¹ˆä½ ä¼šé—®äº†ï¼Œä¸ºä»€ä¹ˆè¦æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼Œç›´æ¥ç”¨ä¸€ä¸ª run() æ–¹æ³•ä¸å°±è¡Œäº†å—ï¼ï¼Ÿ** è¿˜çœŸä¸è¡Œï¼Œå¦‚æœç›´æ¥è°ƒç”¨ run() æ–¹æ³•ï¼Œé‚£å°±ç­‰äºè°ƒç”¨äº†ä¸€ä¸ªæ™®é€šçš„åŒæ­¥æ–¹æ³•ï¼Œè¾¾ä¸åˆ°å¤šçº¿ç¨‹è¿è¡Œçš„å¼‚æ­¥æ‰§è¡Œï¼Œæ¥çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚\n\n```\n/**\n * \n */\npublic static void main(String[] args) {\n\tThread thread = new Thread(() -> {\n\t\ttry {\n\t\t\tThread.sleep(3000);\n\t\t} catch (InterruptedException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t\tSystem.out.println(\"JavaæŠ€æœ¯\");\n\t});\n\n\tlong start = System.currentTimeMillis();\n\tthread.start();\n\tSystem.out.println(System.currentTimeMillis() - start);\n\n\tstart = System.currentTimeMillis();\n\tthread.run();\n\tSystem.out.println(System.currentTimeMillis() - start);\n}\n\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n```\n0\nJavaæŠ€æœ¯\n3000\nJavaæŠ€æœ¯\n```\n\nä»ç¨‹åºè¾“å‡ºç»“æœå¯ä»¥çœ‹å‡ºï¼Œå¯åŠ¨ start æ–¹æ³•å‰ååªç”¨äº† 0 æ¯«ç§’ï¼Œè€Œå¯åŠ¨ run æ–¹æ³•åˆ™é˜»å¡äº† 3000 æ¯«ç§’ç­‰ç¨‹åºæ‰§è¡Œå®Œå†ç»§ç»­æ‰§è¡Œï¼Œè¿™å°±æ˜¯åŒæ­¥ä¸å¼‚æ­¥çš„ä¸€ä¸ªæœ€é‡è¦çš„åŒºåˆ«ã€‚\n\nçœ‹å®Œè¿™ç¯‡ï¼Œä½ åº”è¯¥å¯¹ start å’Œ run æ–¹æ³•æœ‰äº†ä¸€ä¸ªå¤§æ¦‚çš„æŒæ¡å§ï¼Œå†ä¹Ÿä¸æ€•é¢è¯•å®˜é—®ä½ è¿™ä¸¤ä¸ªçš„åŒºåˆ«äº†å§ï¼\n\nåŠ¨æ‰‹è½¬å‘ç»™æ›´å¤šçš„æœ‹å‹å§ï¼\n\n\n","source":"_posts/å¤šçº¿ç¨‹/å¤šçº¿ç¨‹ start å’Œ run æ–¹æ³•åˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ.md","raw":"---\ntitle: å¤šçº¿ç¨‹ start å’Œ run æ–¹æ³•åˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: å¤šçº¿ç¨‹\n---\n\n**é¦–å…ˆè¦çŸ¥é“å®ç°å¤šçº¿ç¨‹æœ€åŸºæœ¬çš„ä¸¤ç§æ–¹å¼ï¼š**\n\n1ã€ç»§æ‰¿ `java.lang.Thread` ç±»ï¼›\n\n2ã€å®ç° `java.lang.Runnable`æ¥å£ï¼›\n\nå…¶ä¸­ Thread ç±»ä¹Ÿæ˜¯å®ç°äº† Runnable æ¥å£ï¼Œè€Œ Runnable æ¥å£å®šä¹‰äº†å”¯ä¸€çš„ä¸€ä¸ª run() æ–¹æ³•ï¼Œæ‰€ä»¥åŸºäº Thread å’Œ Runnable åˆ›å»ºå¤šçº¿ç¨‹éƒ½éœ€è¦å®ç° run() æ–¹æ³•ï¼Œæ˜¯å¤šçº¿ç¨‹çœŸæ­£è¿è¡Œçš„ä¸»æ–¹æ³•ã€‚\n\n```\n@FunctionalInterface\npublic interface Runnable {\n    public abstract void run();\n}\n```\n\nè€Œ start() æ–¹æ³•åˆ™æ˜¯ Thread ç±»çš„æ–¹æ³•ï¼Œç”¨æ¥å¼‚æ­¥å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼Œç„¶åä¸»çº¿ç¨‹ç«‹åˆ»è¿”å›ã€‚è¯¥å¯åŠ¨çš„çº¿ç¨‹ä¸ä¼šé©¬ä¸Šè¿è¡Œï¼Œä¼šæ”¾åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­ç­‰å¾… CPU è°ƒåº¦ï¼Œåªæœ‰çº¿ç¨‹çœŸæ­£è¢« CPU è°ƒåº¦æ—¶æ‰ä¼šè°ƒç”¨ run() æ–¹æ³•æ‰§è¡Œã€‚\n\næ‰€ä»¥ start() æ–¹æ³•åªæ˜¯æ ‡è¯†çº¿ç¨‹ä¸ºå°±ç»ªçŠ¶æ€çš„ä¸€ä¸ªé™„åŠ æ–¹æ³•ï¼Œä»¥ä¸‹ start() æ–¹æ³•çš„æºç ï¼Œå…¶ä¸­ start0() æ˜¯ä¸€ä¸ªæœ¬åœ° native æ–¹æ³•ã€‚\n\n```\npublic synchronized void start() {\n    if (threadStatus != 0)\n        throw new IllegalThreadStateException();\n\n    group.add(this);\n\n    boolean started = false;\n    try {\n        start0();\n        started = true;\n    } finally {\n        try {\n            if (!started) {\n                group.threadStartFailed(this);\n            }\n        } catch (Throwable ignore) {\n            /* do nothing. If start0 threw a Throwable then\n              it will be passed up the call stack */\n        }\n    }\n}\n```\n\nè¯·æ³¨æ„ï¼Œstart() æ–¹æ³•è¢«æ ‡è¯†ä¸º synchronized çš„ï¼Œå³ä¸ºäº†é˜²æ­¢è¢«å¤šæ¬¡å¯åŠ¨çš„ä¸€ä¸ªåŒæ­¥æ“ä½œã€‚\n\n**é‚£ä¹ˆä½ ä¼šé—®äº†ï¼Œä¸ºä»€ä¹ˆè¦æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼Œç›´æ¥ç”¨ä¸€ä¸ª run() æ–¹æ³•ä¸å°±è¡Œäº†å—ï¼ï¼Ÿ** è¿˜çœŸä¸è¡Œï¼Œå¦‚æœç›´æ¥è°ƒç”¨ run() æ–¹æ³•ï¼Œé‚£å°±ç­‰äºè°ƒç”¨äº†ä¸€ä¸ªæ™®é€šçš„åŒæ­¥æ–¹æ³•ï¼Œè¾¾ä¸åˆ°å¤šçº¿ç¨‹è¿è¡Œçš„å¼‚æ­¥æ‰§è¡Œï¼Œæ¥çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚\n\n```\n/**\n * \n */\npublic static void main(String[] args) {\n\tThread thread = new Thread(() -> {\n\t\ttry {\n\t\t\tThread.sleep(3000);\n\t\t} catch (InterruptedException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t\tSystem.out.println(\"JavaæŠ€æœ¯\");\n\t});\n\n\tlong start = System.currentTimeMillis();\n\tthread.start();\n\tSystem.out.println(System.currentTimeMillis() - start);\n\n\tstart = System.currentTimeMillis();\n\tthread.run();\n\tSystem.out.println(System.currentTimeMillis() - start);\n}\n\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n```\n0\nJavaæŠ€æœ¯\n3000\nJavaæŠ€æœ¯\n```\n\nä»ç¨‹åºè¾“å‡ºç»“æœå¯ä»¥çœ‹å‡ºï¼Œå¯åŠ¨ start æ–¹æ³•å‰ååªç”¨äº† 0 æ¯«ç§’ï¼Œè€Œå¯åŠ¨ run æ–¹æ³•åˆ™é˜»å¡äº† 3000 æ¯«ç§’ç­‰ç¨‹åºæ‰§è¡Œå®Œå†ç»§ç»­æ‰§è¡Œï¼Œè¿™å°±æ˜¯åŒæ­¥ä¸å¼‚æ­¥çš„ä¸€ä¸ªæœ€é‡è¦çš„åŒºåˆ«ã€‚\n\nçœ‹å®Œè¿™ç¯‡ï¼Œä½ åº”è¯¥å¯¹ start å’Œ run æ–¹æ³•æœ‰äº†ä¸€ä¸ªå¤§æ¦‚çš„æŒæ¡å§ï¼Œå†ä¹Ÿä¸æ€•é¢è¯•å®˜é—®ä½ è¿™ä¸¤ä¸ªçš„åŒºåˆ«äº†å§ï¼\n\nåŠ¨æ‰‹è½¬å‘ç»™æ›´å¤šçš„æœ‹å‹å§ï¼\n\n\n","slug":"å¤šçº¿ç¨‹/å¤šçº¿ç¨‹ start å’Œ run æ–¹æ³•åˆ°åº•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ","published":1,"updated":"2025-10-15T07:20:24.991Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076q002oqkd411tz6n5b","content":"<p><strong>é¦–å…ˆè¦çŸ¥é“å®ç°å¤šçº¿ç¨‹æœ€åŸºæœ¬çš„ä¸¤ç§æ–¹å¼ï¼š</strong></p>\n<p>1ã€ç»§æ‰¿ <code>java.lang.Thread</code> ç±»ï¼›</p>\n<p>2ã€å®ç° <code>java.lang.Runnable</code>æ¥å£ï¼›</p>\n<p>å…¶ä¸­ Thread ç±»ä¹Ÿæ˜¯å®ç°äº† Runnable æ¥å£ï¼Œè€Œ Runnable æ¥å£å®šä¹‰äº†å”¯ä¸€çš„ä¸€ä¸ª run() æ–¹æ³•ï¼Œæ‰€ä»¥åŸºäº Thread å’Œ Runnable åˆ›å»ºå¤šçº¿ç¨‹éƒ½éœ€è¦å®ç° run() æ–¹æ³•ï¼Œæ˜¯å¤šçº¿ç¨‹çœŸæ­£è¿è¡Œçš„ä¸»æ–¹æ³•ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@FunctionalInterface\npublic interface Runnable &#123;\n    public abstract void run();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è€Œ start() æ–¹æ³•åˆ™æ˜¯ Thread ç±»çš„æ–¹æ³•ï¼Œç”¨æ¥å¼‚æ­¥å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼Œç„¶åä¸»çº¿ç¨‹ç«‹åˆ»è¿”å›ã€‚è¯¥å¯åŠ¨çš„çº¿ç¨‹ä¸ä¼šé©¬ä¸Šè¿è¡Œï¼Œä¼šæ”¾åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­ç­‰å¾… CPU è°ƒåº¦ï¼Œåªæœ‰çº¿ç¨‹çœŸæ­£è¢« CPU è°ƒåº¦æ—¶æ‰ä¼šè°ƒç”¨ run() æ–¹æ³•æ‰§è¡Œã€‚</p>\n<p>æ‰€ä»¥ start() æ–¹æ³•åªæ˜¯æ ‡è¯†çº¿ç¨‹ä¸ºå°±ç»ªçŠ¶æ€çš„ä¸€ä¸ªé™„åŠ æ–¹æ³•ï¼Œä»¥ä¸‹ start() æ–¹æ³•çš„æºç ï¼Œå…¶ä¸­ start0() æ˜¯ä¸€ä¸ªæœ¬åœ° native æ–¹æ³•ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public synchronized void start() &#123;\n    if (threadStatus !&#x3D; 0)\n        throw new IllegalThreadStateException();\n\n    group.add(this);\n\n    boolean started &#x3D; false;\n    try &#123;\n        start0();\n        started &#x3D; true;\n    &#125; finally &#123;\n        try &#123;\n            if (!started) &#123;\n                group.threadStartFailed(this);\n            &#125;\n        &#125; catch (Throwable ignore) &#123;\n            &#x2F;* do nothing. If start0 threw a Throwable then\n              it will be passed up the call stack *&#x2F;\n        &#125;\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¯·æ³¨æ„ï¼Œstart() æ–¹æ³•è¢«æ ‡è¯†ä¸º synchronized çš„ï¼Œå³ä¸ºäº†é˜²æ­¢è¢«å¤šæ¬¡å¯åŠ¨çš„ä¸€ä¸ªåŒæ­¥æ“ä½œã€‚</p>\n<p><strong>é‚£ä¹ˆä½ ä¼šé—®äº†ï¼Œä¸ºä»€ä¹ˆè¦æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼Œç›´æ¥ç”¨ä¸€ä¸ª run() æ–¹æ³•ä¸å°±è¡Œäº†å—ï¼ï¼Ÿ</strong> è¿˜çœŸä¸è¡Œï¼Œå¦‚æœç›´æ¥è°ƒç”¨ run() æ–¹æ³•ï¼Œé‚£å°±ç­‰äºè°ƒç”¨äº†ä¸€ä¸ªæ™®é€šçš„åŒæ­¥æ–¹æ³•ï¼Œè¾¾ä¸åˆ°å¤šçº¿ç¨‹è¿è¡Œçš„å¼‚æ­¥æ‰§è¡Œï¼Œæ¥çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * \n *&#x2F;\npublic static void main(String[] args) &#123;\n\tThread thread &#x3D; new Thread(() -&gt; &#123;\n\t\ttry &#123;\n\t\t\tThread.sleep(3000);\n\t\t&#125; catch (InterruptedException e) &#123;\n\t\t\te.printStackTrace();\n\t\t&#125;\n\t\tSystem.out.println(&quot;JavaæŠ€æœ¯&quot;);\n\t&#125;);\n\n\tlong start &#x3D; System.currentTimeMillis();\n\tthread.start();\n\tSystem.out.println(System.currentTimeMillis() - start);\n\n\tstart &#x3D; System.currentTimeMillis();\n\tthread.run();\n\tSystem.out.println(System.currentTimeMillis() - start);\n&#125;\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">0\nJavaæŠ€æœ¯\n3000\nJavaæŠ€æœ¯<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä»ç¨‹åºè¾“å‡ºç»“æœå¯ä»¥çœ‹å‡ºï¼Œå¯åŠ¨ start æ–¹æ³•å‰ååªç”¨äº† 0 æ¯«ç§’ï¼Œè€Œå¯åŠ¨ run æ–¹æ³•åˆ™é˜»å¡äº† 3000 æ¯«ç§’ç­‰ç¨‹åºæ‰§è¡Œå®Œå†ç»§ç»­æ‰§è¡Œï¼Œè¿™å°±æ˜¯åŒæ­¥ä¸å¼‚æ­¥çš„ä¸€ä¸ªæœ€é‡è¦çš„åŒºåˆ«ã€‚</p>\n<p>çœ‹å®Œè¿™ç¯‡ï¼Œä½ åº”è¯¥å¯¹ start å’Œ run æ–¹æ³•æœ‰äº†ä¸€ä¸ªå¤§æ¦‚çš„æŒæ¡å§ï¼Œå†ä¹Ÿä¸æ€•é¢è¯•å®˜é—®ä½ è¿™ä¸¤ä¸ªçš„åŒºåˆ«äº†å§ï¼</p>\n<p>åŠ¨æ‰‹è½¬å‘ç»™æ›´å¤šçš„æœ‹å‹å§ï¼</p>\n","excerpt":"","more":"<p><strong>é¦–å…ˆè¦çŸ¥é“å®ç°å¤šçº¿ç¨‹æœ€åŸºæœ¬çš„ä¸¤ç§æ–¹å¼ï¼š</strong></p>\n<p>1ã€ç»§æ‰¿ <code>java.lang.Thread</code> ç±»ï¼›</p>\n<p>2ã€å®ç° <code>java.lang.Runnable</code>æ¥å£ï¼›</p>\n<p>å…¶ä¸­ Thread ç±»ä¹Ÿæ˜¯å®ç°äº† Runnable æ¥å£ï¼Œè€Œ Runnable æ¥å£å®šä¹‰äº†å”¯ä¸€çš„ä¸€ä¸ª run() æ–¹æ³•ï¼Œæ‰€ä»¥åŸºäº Thread å’Œ Runnable åˆ›å»ºå¤šçº¿ç¨‹éƒ½éœ€è¦å®ç° run() æ–¹æ³•ï¼Œæ˜¯å¤šçº¿ç¨‹çœŸæ­£è¿è¡Œçš„ä¸»æ–¹æ³•ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@FunctionalInterface\npublic interface Runnable &#123;\n    public abstract void run();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è€Œ start() æ–¹æ³•åˆ™æ˜¯ Thread ç±»çš„æ–¹æ³•ï¼Œç”¨æ¥å¼‚æ­¥å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼Œç„¶åä¸»çº¿ç¨‹ç«‹åˆ»è¿”å›ã€‚è¯¥å¯åŠ¨çš„çº¿ç¨‹ä¸ä¼šé©¬ä¸Šè¿è¡Œï¼Œä¼šæ”¾åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­ç­‰å¾… CPU è°ƒåº¦ï¼Œåªæœ‰çº¿ç¨‹çœŸæ­£è¢« CPU è°ƒåº¦æ—¶æ‰ä¼šè°ƒç”¨ run() æ–¹æ³•æ‰§è¡Œã€‚</p>\n<p>æ‰€ä»¥ start() æ–¹æ³•åªæ˜¯æ ‡è¯†çº¿ç¨‹ä¸ºå°±ç»ªçŠ¶æ€çš„ä¸€ä¸ªé™„åŠ æ–¹æ³•ï¼Œä»¥ä¸‹ start() æ–¹æ³•çš„æºç ï¼Œå…¶ä¸­ start0() æ˜¯ä¸€ä¸ªæœ¬åœ° native æ–¹æ³•ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public synchronized void start() &#123;\n    if (threadStatus !&#x3D; 0)\n        throw new IllegalThreadStateException();\n\n    group.add(this);\n\n    boolean started &#x3D; false;\n    try &#123;\n        start0();\n        started &#x3D; true;\n    &#125; finally &#123;\n        try &#123;\n            if (!started) &#123;\n                group.threadStartFailed(this);\n            &#125;\n        &#125; catch (Throwable ignore) &#123;\n            &#x2F;* do nothing. If start0 threw a Throwable then\n              it will be passed up the call stack *&#x2F;\n        &#125;\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¯·æ³¨æ„ï¼Œstart() æ–¹æ³•è¢«æ ‡è¯†ä¸º synchronized çš„ï¼Œå³ä¸ºäº†é˜²æ­¢è¢«å¤šæ¬¡å¯åŠ¨çš„ä¸€ä¸ªåŒæ­¥æ“ä½œã€‚</p>\n<p><strong>é‚£ä¹ˆä½ ä¼šé—®äº†ï¼Œä¸ºä»€ä¹ˆè¦æœ‰ä¸¤ä¸ªæ–¹æ³•ï¼Œç›´æ¥ç”¨ä¸€ä¸ª run() æ–¹æ³•ä¸å°±è¡Œäº†å—ï¼ï¼Ÿ</strong> è¿˜çœŸä¸è¡Œï¼Œå¦‚æœç›´æ¥è°ƒç”¨ run() æ–¹æ³•ï¼Œé‚£å°±ç­‰äºè°ƒç”¨äº†ä¸€ä¸ªæ™®é€šçš„åŒæ­¥æ–¹æ³•ï¼Œè¾¾ä¸åˆ°å¤šçº¿ç¨‹è¿è¡Œçš„å¼‚æ­¥æ‰§è¡Œï¼Œæ¥çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * \n *&#x2F;\npublic static void main(String[] args) &#123;\n\tThread thread &#x3D; new Thread(() -&gt; &#123;\n\t\ttry &#123;\n\t\t\tThread.sleep(3000);\n\t\t&#125; catch (InterruptedException e) &#123;\n\t\t\te.printStackTrace();\n\t\t&#125;\n\t\tSystem.out.println(&quot;JavaæŠ€æœ¯&quot;);\n\t&#125;);\n\n\tlong start &#x3D; System.currentTimeMillis();\n\tthread.start();\n\tSystem.out.println(System.currentTimeMillis() - start);\n\n\tstart &#x3D; System.currentTimeMillis();\n\tthread.run();\n\tSystem.out.println(System.currentTimeMillis() - start);\n&#125;\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">0\nJavaæŠ€æœ¯\n3000\nJavaæŠ€æœ¯<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä»ç¨‹åºè¾“å‡ºç»“æœå¯ä»¥çœ‹å‡ºï¼Œå¯åŠ¨ start æ–¹æ³•å‰ååªç”¨äº† 0 æ¯«ç§’ï¼Œè€Œå¯åŠ¨ run æ–¹æ³•åˆ™é˜»å¡äº† 3000 æ¯«ç§’ç­‰ç¨‹åºæ‰§è¡Œå®Œå†ç»§ç»­æ‰§è¡Œï¼Œè¿™å°±æ˜¯åŒæ­¥ä¸å¼‚æ­¥çš„ä¸€ä¸ªæœ€é‡è¦çš„åŒºåˆ«ã€‚</p>\n<p>çœ‹å®Œè¿™ç¯‡ï¼Œä½ åº”è¯¥å¯¹ start å’Œ run æ–¹æ³•æœ‰äº†ä¸€ä¸ªå¤§æ¦‚çš„æŒæ¡å§ï¼Œå†ä¹Ÿä¸æ€•é¢è¯•å®˜é—®ä½ è¿™ä¸¤ä¸ªçš„åŒºåˆ«äº†å§ï¼</p>\n<p>åŠ¨æ‰‹è½¬å‘ç»™æ›´å¤šçš„æœ‹å‹å§ï¼</p>\n"},{"title":"å¤šçº¿ç¨‹é€šä¿¡çš„ä¸‰å¤§æ³•å™¨ï¼Œä½ çœŸçš„ä¼šç”¨å—ï¼Ÿ","date":"2025-10-14T06:42:34.000Z","_content":"\nwait, notify, notifyAll æ˜¯å¤šçº¿ç¨‹ä¹‹é—´é€šä¿¡æœ€é‡è¦çš„ 3 ä¸ªæ–¹æ³•ï¼Œä»Šå¤©ï¼Œæ ˆé•¿ç»™å¤§å®¶æ™®åŠä¸€ä¸‹å®ƒä»¬çš„çŸ¥è¯†è¦ç‚¹åŠåº”ç”¨å®æˆ˜ã€‚\n\n## å®šä¹‰\n\nwaitï¼šè®©æŒæœ‰è¯¥å¯¹è±¡é”çš„çº¿ç¨‹ç­‰å¾…ï¼›\n\nnotify: å”¤é†’ä»»ä½•ä¸€ä¸ªæŒæœ‰è¯¥å¯¹è±¡é”çš„çº¿ç¨‹ï¼›\n\nnotify: å”¤é†’æ‰€æœ‰æŒæœ‰è¯¥å¯¹è±¡é”çš„çº¿ç¨‹ï¼›\n\nå®ƒä»¬ 3 ä¸ªçš„å…³ç³»æ˜¯ï¼Œè°ƒç”¨å¯¹è±¡çš„ wait æ–¹æ³•ä½¿çº¿ç¨‹æš‚åœè¿è¡Œï¼Œé€šè¿‡ notify/ notifyAll æ–¹æ³•å”¤é†’è°ƒç”¨ wait æš‚æ—¶çš„çº¿ç¨‹ã€‚\n\n**ç„¶è€Œï¼Œå®ƒä»¬å¹¶ä¸æ˜¯ Thread ç±»ä¸­çš„æ–¹æ³•ï¼Œè€Œæ˜¯ Object ç±»ä¸­çš„ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼ï¼Ÿ** å› ä¸ºæ¯ä¸ªå¯¹è±¡éƒ½æœ‰ç›‘è§†é”ï¼Œçº¿ç¨‹è¦æ“ä½œæŸä¸ªå¯¹è±¡å½“ç„¶æ˜¯è¦è·å–æŸä¸ªå¯¹è±¡çš„é”äº†ï¼Œè€Œä¸æ˜¯çº¿ç¨‹çš„é”ã€‚\n\n![](http://qianniu.javastack.cn/18-6-1/82637503.jpg)\n\nå¦‚å›¾æ‰€ç¤ºï¼Œwait å¸¦æ—¶é—´è¡¨ç¤ºæœ€å¤§è¶…æ—¶æ—¶é—´ï¼Œè¿‡äº†æ—¶é—´è¿˜ä¸å”¤é†’å°±ä¼šè‡ªåŠ¨å”¤é†’çº¿ç¨‹é‡æ–°ç«äº‰å¯¹è±¡é”ã€‚\n\n## å‡ ä¸ªé‡è¦çš„ç‚¹\n\n1ã€è°ƒç”¨å¯¹è±¡çš„ wait, notify, notifyAll æ–¹æ³•éœ€è¦æ‹¥æœ‰å¯¹è±¡çš„ç›‘è§†å™¨é”ï¼Œå³å®ƒä»¬åªèƒ½åœ¨åŒæ­¥æ–¹æ³•ï¼ˆå—ï¼‰ä¸­ä½¿ç”¨ï¼›\n\n2ã€è°ƒç”¨ wait æ–¹æ³•ä¼šä½¿ç”¨çº¿ç¨‹æš‚åœå¹¶è®©å‡º CPU èµ„æºï¼ŒåŒæ—¶é‡Šæ”¾æŒæœ‰çš„å¯¹è±¡çš„é”ï¼›\n\n3ã€å¤šçº¿ç¨‹ä½¿ç”¨ notify å®¹æ˜“å‘ç”Ÿæ­»é”ï¼Œä¸€èˆ¬ä½¿ç”¨ notifyAllï¼›\n\n4ã€å…³äº wait å’Œ sleep çš„è¯¦ç»†åŒºåˆ«è¯·ç¿»é˜… ã€Š[å¤šçº¿ç¨‹ sleep å’Œ wait çš„ 5 ä¸ªåŒºåˆ«](https://mp.weixin.qq.com/s/gvaksKy2ss90bsybCnajpQ)ã€‹è¿™ç¯‡æ–‡ç« ã€‚\n\n## å®æˆ˜\n\n```\n/**\n * \n */\npublic static void main(String[] args) {\n\tObject lock = new Object();\n\tThread t1 = new Thread(() -> {\n\t\tsynchronized (lock) {\n\t\t\tfor (int i = 0; i < 20; i++) {\n\t\t\t\tSystem.out.print(i);\n\t\t\t\tif (i == 10) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tlock.wait();\n\t\t\t\t\t} catch (InterruptedException e) {\n\t\t\t\t\t\te.printStackTrace();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\tThread t2 = new Thread(() -> {\n\t\tsynchronized (lock) {\n\t\t\ttry {\n\t\t\t\tThread.sleep(5000);\n\t\t\t} catch (InterruptedException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t\tSystem.out.print(\"JavaæŠ€æœ¯\");\n\t\t\tlock.notifyAll();\n\t\t}\n\t});\n\n\tt1.start();\n\tt2.start();\n}\n```\n\nä¸Šé¢çš„ä¾‹å­ç»“åˆ wait/ notifyAll æ¥æ¼”ç¤ºäº†å®ƒä»¬çš„ç›¸äº’ä½œç”¨ã€‚\n\nçº¿ç¨‹ t1 é¦–å…ˆè¾“å‡º `012345678910`ï¼Œ5ç§’åç»§ç»­è¾“å‡º `JavaæŠ€æœ¯111213141516171819`ã€‚\n\n","source":"_posts/å¤šçº¿ç¨‹/å¤šçº¿ç¨‹é€šä¿¡çš„ä¸‰å¤§æ³•å™¨ï¼Œä½ çœŸçš„ä¼šç”¨å—ï¼Ÿ.md","raw":"---\ntitle: å¤šçº¿ç¨‹é€šä¿¡çš„ä¸‰å¤§æ³•å™¨ï¼Œä½ çœŸçš„ä¼šç”¨å—ï¼Ÿ\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: å¤šçº¿ç¨‹\n---\n\nwait, notify, notifyAll æ˜¯å¤šçº¿ç¨‹ä¹‹é—´é€šä¿¡æœ€é‡è¦çš„ 3 ä¸ªæ–¹æ³•ï¼Œä»Šå¤©ï¼Œæ ˆé•¿ç»™å¤§å®¶æ™®åŠä¸€ä¸‹å®ƒä»¬çš„çŸ¥è¯†è¦ç‚¹åŠåº”ç”¨å®æˆ˜ã€‚\n\n## å®šä¹‰\n\nwaitï¼šè®©æŒæœ‰è¯¥å¯¹è±¡é”çš„çº¿ç¨‹ç­‰å¾…ï¼›\n\nnotify: å”¤é†’ä»»ä½•ä¸€ä¸ªæŒæœ‰è¯¥å¯¹è±¡é”çš„çº¿ç¨‹ï¼›\n\nnotify: å”¤é†’æ‰€æœ‰æŒæœ‰è¯¥å¯¹è±¡é”çš„çº¿ç¨‹ï¼›\n\nå®ƒä»¬ 3 ä¸ªçš„å…³ç³»æ˜¯ï¼Œè°ƒç”¨å¯¹è±¡çš„ wait æ–¹æ³•ä½¿çº¿ç¨‹æš‚åœè¿è¡Œï¼Œé€šè¿‡ notify/ notifyAll æ–¹æ³•å”¤é†’è°ƒç”¨ wait æš‚æ—¶çš„çº¿ç¨‹ã€‚\n\n**ç„¶è€Œï¼Œå®ƒä»¬å¹¶ä¸æ˜¯ Thread ç±»ä¸­çš„æ–¹æ³•ï¼Œè€Œæ˜¯ Object ç±»ä¸­çš„ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼ï¼Ÿ** å› ä¸ºæ¯ä¸ªå¯¹è±¡éƒ½æœ‰ç›‘è§†é”ï¼Œçº¿ç¨‹è¦æ“ä½œæŸä¸ªå¯¹è±¡å½“ç„¶æ˜¯è¦è·å–æŸä¸ªå¯¹è±¡çš„é”äº†ï¼Œè€Œä¸æ˜¯çº¿ç¨‹çš„é”ã€‚\n\n![](http://qianniu.javastack.cn/18-6-1/82637503.jpg)\n\nå¦‚å›¾æ‰€ç¤ºï¼Œwait å¸¦æ—¶é—´è¡¨ç¤ºæœ€å¤§è¶…æ—¶æ—¶é—´ï¼Œè¿‡äº†æ—¶é—´è¿˜ä¸å”¤é†’å°±ä¼šè‡ªåŠ¨å”¤é†’çº¿ç¨‹é‡æ–°ç«äº‰å¯¹è±¡é”ã€‚\n\n## å‡ ä¸ªé‡è¦çš„ç‚¹\n\n1ã€è°ƒç”¨å¯¹è±¡çš„ wait, notify, notifyAll æ–¹æ³•éœ€è¦æ‹¥æœ‰å¯¹è±¡çš„ç›‘è§†å™¨é”ï¼Œå³å®ƒä»¬åªèƒ½åœ¨åŒæ­¥æ–¹æ³•ï¼ˆå—ï¼‰ä¸­ä½¿ç”¨ï¼›\n\n2ã€è°ƒç”¨ wait æ–¹æ³•ä¼šä½¿ç”¨çº¿ç¨‹æš‚åœå¹¶è®©å‡º CPU èµ„æºï¼ŒåŒæ—¶é‡Šæ”¾æŒæœ‰çš„å¯¹è±¡çš„é”ï¼›\n\n3ã€å¤šçº¿ç¨‹ä½¿ç”¨ notify å®¹æ˜“å‘ç”Ÿæ­»é”ï¼Œä¸€èˆ¬ä½¿ç”¨ notifyAllï¼›\n\n4ã€å…³äº wait å’Œ sleep çš„è¯¦ç»†åŒºåˆ«è¯·ç¿»é˜… ã€Š[å¤šçº¿ç¨‹ sleep å’Œ wait çš„ 5 ä¸ªåŒºåˆ«](https://mp.weixin.qq.com/s/gvaksKy2ss90bsybCnajpQ)ã€‹è¿™ç¯‡æ–‡ç« ã€‚\n\n## å®æˆ˜\n\n```\n/**\n * \n */\npublic static void main(String[] args) {\n\tObject lock = new Object();\n\tThread t1 = new Thread(() -> {\n\t\tsynchronized (lock) {\n\t\t\tfor (int i = 0; i < 20; i++) {\n\t\t\t\tSystem.out.print(i);\n\t\t\t\tif (i == 10) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tlock.wait();\n\t\t\t\t\t} catch (InterruptedException e) {\n\t\t\t\t\t\te.printStackTrace();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\n\tThread t2 = new Thread(() -> {\n\t\tsynchronized (lock) {\n\t\t\ttry {\n\t\t\t\tThread.sleep(5000);\n\t\t\t} catch (InterruptedException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t\tSystem.out.print(\"JavaæŠ€æœ¯\");\n\t\t\tlock.notifyAll();\n\t\t}\n\t});\n\n\tt1.start();\n\tt2.start();\n}\n```\n\nä¸Šé¢çš„ä¾‹å­ç»“åˆ wait/ notifyAll æ¥æ¼”ç¤ºäº†å®ƒä»¬çš„ç›¸äº’ä½œç”¨ã€‚\n\nçº¿ç¨‹ t1 é¦–å…ˆè¾“å‡º `012345678910`ï¼Œ5ç§’åç»§ç»­è¾“å‡º `JavaæŠ€æœ¯111213141516171819`ã€‚\n\n","slug":"å¤šçº¿ç¨‹/å¤šçº¿ç¨‹é€šä¿¡çš„ä¸‰å¤§æ³•å™¨ï¼Œä½ çœŸçš„ä¼šç”¨å—ï¼Ÿ","published":1,"updated":"2025-10-15T07:20:25.005Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076r002rqkd42p0o7veo","content":"<p>wait, notify, notifyAll æ˜¯å¤šçº¿ç¨‹ä¹‹é—´é€šä¿¡æœ€é‡è¦çš„ 3 ä¸ªæ–¹æ³•ï¼Œä»Šå¤©ï¼Œæ ˆé•¿ç»™å¤§å®¶æ™®åŠä¸€ä¸‹å®ƒä»¬çš„çŸ¥è¯†è¦ç‚¹åŠåº”ç”¨å®æˆ˜ã€‚</p>\n<h2 id=\"å®šä¹‰\"><a href=\"#å®šä¹‰\" class=\"headerlink\" title=\"å®šä¹‰\"></a>å®šä¹‰</h2><p>waitï¼šè®©æŒæœ‰è¯¥å¯¹è±¡é”çš„çº¿ç¨‹ç­‰å¾…ï¼›</p>\n<p>notify: å”¤é†’ä»»ä½•ä¸€ä¸ªæŒæœ‰è¯¥å¯¹è±¡é”çš„çº¿ç¨‹ï¼›</p>\n<p>notify: å”¤é†’æ‰€æœ‰æŒæœ‰è¯¥å¯¹è±¡é”çš„çº¿ç¨‹ï¼›</p>\n<p>å®ƒä»¬ 3 ä¸ªçš„å…³ç³»æ˜¯ï¼Œè°ƒç”¨å¯¹è±¡çš„ wait æ–¹æ³•ä½¿çº¿ç¨‹æš‚åœè¿è¡Œï¼Œé€šè¿‡ notify&#x2F; notifyAll æ–¹æ³•å”¤é†’è°ƒç”¨ wait æš‚æ—¶çš„çº¿ç¨‹ã€‚</p>\n<p><strong>ç„¶è€Œï¼Œå®ƒä»¬å¹¶ä¸æ˜¯ Thread ç±»ä¸­çš„æ–¹æ³•ï¼Œè€Œæ˜¯ Object ç±»ä¸­çš„ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼ï¼Ÿ</strong> å› ä¸ºæ¯ä¸ªå¯¹è±¡éƒ½æœ‰ç›‘è§†é”ï¼Œçº¿ç¨‹è¦æ“ä½œæŸä¸ªå¯¹è±¡å½“ç„¶æ˜¯è¦è·å–æŸä¸ªå¯¹è±¡çš„é”äº†ï¼Œè€Œä¸æ˜¯çº¿ç¨‹çš„é”ã€‚</p>\n<p><img src=\"http://qianniu.javastack.cn/18-6-1/82637503.jpg\"></p>\n<p>å¦‚å›¾æ‰€ç¤ºï¼Œwait å¸¦æ—¶é—´è¡¨ç¤ºæœ€å¤§è¶…æ—¶æ—¶é—´ï¼Œè¿‡äº†æ—¶é—´è¿˜ä¸å”¤é†’å°±ä¼šè‡ªåŠ¨å”¤é†’çº¿ç¨‹é‡æ–°ç«äº‰å¯¹è±¡é”ã€‚</p>\n<h2 id=\"å‡ ä¸ªé‡è¦çš„ç‚¹\"><a href=\"#å‡ ä¸ªé‡è¦çš„ç‚¹\" class=\"headerlink\" title=\"å‡ ä¸ªé‡è¦çš„ç‚¹\"></a>å‡ ä¸ªé‡è¦çš„ç‚¹</h2><p>1ã€è°ƒç”¨å¯¹è±¡çš„ wait, notify, notifyAll æ–¹æ³•éœ€è¦æ‹¥æœ‰å¯¹è±¡çš„ç›‘è§†å™¨é”ï¼Œå³å®ƒä»¬åªèƒ½åœ¨åŒæ­¥æ–¹æ³•ï¼ˆå—ï¼‰ä¸­ä½¿ç”¨ï¼›</p>\n<p>2ã€è°ƒç”¨ wait æ–¹æ³•ä¼šä½¿ç”¨çº¿ç¨‹æš‚åœå¹¶è®©å‡º CPU èµ„æºï¼ŒåŒæ—¶é‡Šæ”¾æŒæœ‰çš„å¯¹è±¡çš„é”ï¼›</p>\n<p>3ã€å¤šçº¿ç¨‹ä½¿ç”¨ notify å®¹æ˜“å‘ç”Ÿæ­»é”ï¼Œä¸€èˆ¬ä½¿ç”¨ notifyAllï¼›</p>\n<p>4ã€å…³äº wait å’Œ sleep çš„è¯¦ç»†åŒºåˆ«è¯·ç¿»é˜… ã€Š<a href=\"https://mp.weixin.qq.com/s/gvaksKy2ss90bsybCnajpQ\">å¤šçº¿ç¨‹ sleep å’Œ wait çš„ 5 ä¸ªåŒºåˆ«</a>ã€‹è¿™ç¯‡æ–‡ç« ã€‚</p>\n<h2 id=\"å®æˆ˜\"><a href=\"#å®æˆ˜\" class=\"headerlink\" title=\"å®æˆ˜\"></a>å®æˆ˜</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * \n *&#x2F;\npublic static void main(String[] args) &#123;\n\tObject lock &#x3D; new Object();\n\tThread t1 &#x3D; new Thread(() -&gt; &#123;\n\t\tsynchronized (lock) &#123;\n\t\t\tfor (int i &#x3D; 0; i &lt; 20; i++) &#123;\n\t\t\t\tSystem.out.print(i);\n\t\t\t\tif (i &#x3D;&#x3D; 10) &#123;\n\t\t\t\t\ttry &#123;\n\t\t\t\t\t\tlock.wait();\n\t\t\t\t\t&#125; catch (InterruptedException e) &#123;\n\t\t\t\t\t\te.printStackTrace();\n\t\t\t\t\t&#125;\n\t\t\t\t&#125;\n\t\t\t&#125;\n\t\t&#125;\n\t&#125;);\n\n\tThread t2 &#x3D; new Thread(() -&gt; &#123;\n\t\tsynchronized (lock) &#123;\n\t\t\ttry &#123;\n\t\t\t\tThread.sleep(5000);\n\t\t\t&#125; catch (InterruptedException e) &#123;\n\t\t\t\te.printStackTrace();\n\t\t\t&#125;\n\t\t\tSystem.out.print(&quot;JavaæŠ€æœ¯&quot;);\n\t\t\tlock.notifyAll();\n\t\t&#125;\n\t&#125;);\n\n\tt1.start();\n\tt2.start();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä¸Šé¢çš„ä¾‹å­ç»“åˆ wait&#x2F; notifyAll æ¥æ¼”ç¤ºäº†å®ƒä»¬çš„ç›¸äº’ä½œç”¨ã€‚</p>\n<p>çº¿ç¨‹ t1 é¦–å…ˆè¾“å‡º <code>012345678910</code>ï¼Œ5ç§’åç»§ç»­è¾“å‡º <code>JavaæŠ€æœ¯111213141516171819</code>ã€‚</p>\n","excerpt":"","more":"<p>wait, notify, notifyAll æ˜¯å¤šçº¿ç¨‹ä¹‹é—´é€šä¿¡æœ€é‡è¦çš„ 3 ä¸ªæ–¹æ³•ï¼Œä»Šå¤©ï¼Œæ ˆé•¿ç»™å¤§å®¶æ™®åŠä¸€ä¸‹å®ƒä»¬çš„çŸ¥è¯†è¦ç‚¹åŠåº”ç”¨å®æˆ˜ã€‚</p>\n<h2 id=\"å®šä¹‰\"><a href=\"#å®šä¹‰\" class=\"headerlink\" title=\"å®šä¹‰\"></a>å®šä¹‰</h2><p>waitï¼šè®©æŒæœ‰è¯¥å¯¹è±¡é”çš„çº¿ç¨‹ç­‰å¾…ï¼›</p>\n<p>notify: å”¤é†’ä»»ä½•ä¸€ä¸ªæŒæœ‰è¯¥å¯¹è±¡é”çš„çº¿ç¨‹ï¼›</p>\n<p>notify: å”¤é†’æ‰€æœ‰æŒæœ‰è¯¥å¯¹è±¡é”çš„çº¿ç¨‹ï¼›</p>\n<p>å®ƒä»¬ 3 ä¸ªçš„å…³ç³»æ˜¯ï¼Œè°ƒç”¨å¯¹è±¡çš„ wait æ–¹æ³•ä½¿çº¿ç¨‹æš‚åœè¿è¡Œï¼Œé€šè¿‡ notify&#x2F; notifyAll æ–¹æ³•å”¤é†’è°ƒç”¨ wait æš‚æ—¶çš„çº¿ç¨‹ã€‚</p>\n<p><strong>ç„¶è€Œï¼Œå®ƒä»¬å¹¶ä¸æ˜¯ Thread ç±»ä¸­çš„æ–¹æ³•ï¼Œè€Œæ˜¯ Object ç±»ä¸­çš„ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼ï¼Ÿ</strong> å› ä¸ºæ¯ä¸ªå¯¹è±¡éƒ½æœ‰ç›‘è§†é”ï¼Œçº¿ç¨‹è¦æ“ä½œæŸä¸ªå¯¹è±¡å½“ç„¶æ˜¯è¦è·å–æŸä¸ªå¯¹è±¡çš„é”äº†ï¼Œè€Œä¸æ˜¯çº¿ç¨‹çš„é”ã€‚</p>\n<p><img src=\"http://qianniu.javastack.cn/18-6-1/82637503.jpg\"></p>\n<p>å¦‚å›¾æ‰€ç¤ºï¼Œwait å¸¦æ—¶é—´è¡¨ç¤ºæœ€å¤§è¶…æ—¶æ—¶é—´ï¼Œè¿‡äº†æ—¶é—´è¿˜ä¸å”¤é†’å°±ä¼šè‡ªåŠ¨å”¤é†’çº¿ç¨‹é‡æ–°ç«äº‰å¯¹è±¡é”ã€‚</p>\n<h2 id=\"å‡ ä¸ªé‡è¦çš„ç‚¹\"><a href=\"#å‡ ä¸ªé‡è¦çš„ç‚¹\" class=\"headerlink\" title=\"å‡ ä¸ªé‡è¦çš„ç‚¹\"></a>å‡ ä¸ªé‡è¦çš„ç‚¹</h2><p>1ã€è°ƒç”¨å¯¹è±¡çš„ wait, notify, notifyAll æ–¹æ³•éœ€è¦æ‹¥æœ‰å¯¹è±¡çš„ç›‘è§†å™¨é”ï¼Œå³å®ƒä»¬åªèƒ½åœ¨åŒæ­¥æ–¹æ³•ï¼ˆå—ï¼‰ä¸­ä½¿ç”¨ï¼›</p>\n<p>2ã€è°ƒç”¨ wait æ–¹æ³•ä¼šä½¿ç”¨çº¿ç¨‹æš‚åœå¹¶è®©å‡º CPU èµ„æºï¼ŒåŒæ—¶é‡Šæ”¾æŒæœ‰çš„å¯¹è±¡çš„é”ï¼›</p>\n<p>3ã€å¤šçº¿ç¨‹ä½¿ç”¨ notify å®¹æ˜“å‘ç”Ÿæ­»é”ï¼Œä¸€èˆ¬ä½¿ç”¨ notifyAllï¼›</p>\n<p>4ã€å…³äº wait å’Œ sleep çš„è¯¦ç»†åŒºåˆ«è¯·ç¿»é˜… ã€Š<a href=\"https://mp.weixin.qq.com/s/gvaksKy2ss90bsybCnajpQ\">å¤šçº¿ç¨‹ sleep å’Œ wait çš„ 5 ä¸ªåŒºåˆ«</a>ã€‹è¿™ç¯‡æ–‡ç« ã€‚</p>\n<h2 id=\"å®æˆ˜\"><a href=\"#å®æˆ˜\" class=\"headerlink\" title=\"å®æˆ˜\"></a>å®æˆ˜</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * \n *&#x2F;\npublic static void main(String[] args) &#123;\n\tObject lock &#x3D; new Object();\n\tThread t1 &#x3D; new Thread(() -&gt; &#123;\n\t\tsynchronized (lock) &#123;\n\t\t\tfor (int i &#x3D; 0; i &lt; 20; i++) &#123;\n\t\t\t\tSystem.out.print(i);\n\t\t\t\tif (i &#x3D;&#x3D; 10) &#123;\n\t\t\t\t\ttry &#123;\n\t\t\t\t\t\tlock.wait();\n\t\t\t\t\t&#125; catch (InterruptedException e) &#123;\n\t\t\t\t\t\te.printStackTrace();\n\t\t\t\t\t&#125;\n\t\t\t\t&#125;\n\t\t\t&#125;\n\t\t&#125;\n\t&#125;);\n\n\tThread t2 &#x3D; new Thread(() -&gt; &#123;\n\t\tsynchronized (lock) &#123;\n\t\t\ttry &#123;\n\t\t\t\tThread.sleep(5000);\n\t\t\t&#125; catch (InterruptedException e) &#123;\n\t\t\t\te.printStackTrace();\n\t\t\t&#125;\n\t\t\tSystem.out.print(&quot;JavaæŠ€æœ¯&quot;);\n\t\t\tlock.notifyAll();\n\t\t&#125;\n\t&#125;);\n\n\tt1.start();\n\tt2.start();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä¸Šé¢çš„ä¾‹å­ç»“åˆ wait&#x2F; notifyAll æ¥æ¼”ç¤ºäº†å®ƒä»¬çš„ç›¸äº’ä½œç”¨ã€‚</p>\n<p>çº¿ç¨‹ t1 é¦–å…ˆè¾“å‡º <code>012345678910</code>ï¼Œ5ç§’åç»§ç»­è¾“å‡º <code>JavaæŠ€æœ¯111213141516171819</code>ã€‚</p>\n"},{"title":"å¹¶è¡Œä»»åŠ¡æ‰§è¡Œç¥å™¨ Fork & Join å®æˆ˜","date":"2025-10-14T06:42:34.000Z","_content":"\n#### Fork/Joinæ˜¯ä»€ä¹ˆï¼Ÿ\n\nFork/Joinæ¡†æ¶æ˜¯Java7æä¾›çš„å¹¶è¡Œæ‰§è¡Œä»»åŠ¡æ¡†æ¶ï¼Œæ€æƒ³æ˜¯å°†å¤§ä»»åŠ¡åˆ†è§£æˆå°ä»»åŠ¡ï¼Œç„¶åå°ä»»åŠ¡åˆå¯ä»¥ç»§ç»­åˆ†è§£ï¼Œç„¶åæ¯ä¸ªå°ä»»åŠ¡åˆ†åˆ«è®¡ç®—å‡ºç»“æœå†åˆå¹¶èµ·æ¥ï¼Œæœ€åå°†æ±‡æ€»çš„ç»“æœä½œä¸ºå¤§ä»»åŠ¡ç»“æœã€‚å…¶æ€æƒ³å’ŒMapReduceçš„æ€æƒ³éå¸¸ç±»ä¼¼ã€‚å¯¹äºä»»åŠ¡çš„åˆ†å‰²ï¼Œè¦æ±‚å„ä¸ªå­ä»»åŠ¡ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œèƒ½å¤Ÿå¹¶è¡Œç‹¬ç«‹åœ°æ‰§è¡Œä»»åŠ¡ï¼Œäº’ç›¸ä¹‹é—´ä¸å½±å“ã€‚\n\n**Fork/Joinçš„è¿è¡Œæµç¨‹å›¾å¦‚ä¸‹ï¼š**\n\n![image](https://res.infoq.com/articles/fork-join-introduction/zh/resources/21.png)\n\næˆ‘ä»¬å¯ä»¥é€šè¿‡Fork/Joinå•è¯å­—é¢ä¸Šçš„æ„æ€å»ç†è§£è¿™ä¸ªæ¡†æ¶ã€‚Forkæ˜¯å‰å­åˆ†å‰çš„æ„æ€ï¼Œå³å°†å¤§ä»»åŠ¡åˆ†è§£æˆå¹¶è¡Œçš„å°ä»»åŠ¡ï¼ŒJoinæ˜¯è¿æ¥ç»“åˆçš„æ„æ€ï¼Œå³å°†æ‰€æœ‰å¹¶è¡Œçš„å°ä»»åŠ¡çš„æ‰§è¡Œç»“æœæ±‡æ€»èµ·æ¥ã€‚\n\n![image](http://java.boot.by/ocpjp7-upgrade/images/040501.gif)\n\n#### å·¥ä½œçªƒå–ç®—æ³•\n\nForkJoiné‡‡ç”¨äº†å·¥ä½œçªƒå–ï¼ˆwork-stealingï¼‰ç®—æ³•ï¼Œè‹¥ä¸€ä¸ªå·¥ä½œçº¿ç¨‹çš„ä»»åŠ¡é˜Ÿåˆ—ä¸ºç©ºæ²¡æœ‰ä»»åŠ¡æ‰§è¡Œæ—¶ï¼Œä¾¿ä»å…¶ä»–å·¥ä½œçº¿ç¨‹ä¸­è·å–ä»»åŠ¡ä¸»åŠ¨æ‰§è¡Œã€‚ä¸ºäº†å®ç°å·¥ä½œçªƒå–ï¼Œåœ¨å·¥ä½œçº¿ç¨‹ä¸­ç»´æŠ¤äº†åŒç«¯é˜Ÿåˆ—ï¼Œçªƒå–ä»»åŠ¡çº¿ç¨‹ä»é˜Ÿå°¾è·å–ä»»åŠ¡ï¼Œè¢«çªƒå–ä»»åŠ¡çº¿ç¨‹ä»é˜Ÿå¤´è·å–ä»»åŠ¡ã€‚è¿™ç§æœºåˆ¶å……åˆ†åˆ©ç”¨çº¿ç¨‹è¿›è¡Œå¹¶è¡Œè®¡ç®—ï¼Œå‡å°‘äº†çº¿ç¨‹ç«äº‰ã€‚ä½†æ˜¯å½“é˜Ÿåˆ—ä¸­åªå­˜åœ¨ä¸€ä¸ªä»»åŠ¡äº†æ—¶ï¼Œä¸¤ä¸ªçº¿ç¨‹å»å–åè€Œä¼šé€ æˆèµ„æºæµªè´¹ã€‚\n\n**å·¥ä½œçªƒå–çš„è¿è¡Œæµç¨‹å›¾å¦‚ä¸‹ï¼š**\n\n![image](https://res.infoq.com/articles/fork-join-introduction/zh/resources/image3.png)\n\n#### Fork/Joinæ ¸å¿ƒç±»\n\nFork/Joinæ¡†æ¶ä¸»è¦ç”±å­ä»»åŠ¡ã€ä»»åŠ¡è°ƒåº¦ä¸¤éƒ¨åˆ†ç»„æˆï¼Œç±»å±‚æ¬¡å›¾å¦‚ä¸‹ã€‚\n\n![image](http://img.blog.csdn.net/20160720172854109)\n\n- **ForkJoinPool**\n\nForkJoinPoolæ˜¯ForkJoinæ¡†æ¶ä¸­çš„ä»»åŠ¡è°ƒåº¦å™¨ï¼Œå’ŒThreadPoolExecutorä¸€æ ·å®ç°äº†è‡ªå·±çš„çº¿ç¨‹æ± ï¼Œæä¾›äº†ä¸‰ç§è°ƒåº¦å­ä»»åŠ¡çš„æ–¹æ³•ï¼š\n\n1. executeï¼šå¼‚æ­¥æ‰§è¡ŒæŒ‡å®šä»»åŠ¡ï¼Œæ— è¿”å›ç»“æœï¼›\n1. invokeã€invokeAllï¼šå¼‚æ­¥æ‰§è¡ŒæŒ‡å®šä»»åŠ¡ï¼Œç­‰å¾…å®Œæˆæ‰è¿”å›ç»“æœï¼›\n1. submitï¼šå¼‚æ­¥æ‰§è¡ŒæŒ‡å®šä»»åŠ¡ï¼Œå¹¶ç«‹å³è¿”å›ä¸€ä¸ªFutureå¯¹è±¡ï¼›\n\n- **ForkJoinTask**\n\nFork/Joinæ¡†æ¶ä¸­çš„å®é™…çš„æ‰§è¡Œä»»åŠ¡ç±»ï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§å®ç°ï¼Œä¸€èˆ¬ç»§æ‰¿è¿™ä¸¤ç§å®ç°ç±»å³å¯ã€‚\n\n1. RecursiveActionï¼šç”¨äºæ— ç»“æœè¿”å›çš„å­ä»»åŠ¡ï¼›\n1. RecursiveTaskï¼šç”¨äºæœ‰ç»“æœè¿”å›çš„å­ä»»åŠ¡ï¼›\n\n#### Fork/Joinæ¡†æ¶å®æˆ˜\n\nä¸‹é¢å®ç°ä¸€ä¸ªFork/Joinå°ä¾‹å­ï¼Œä»1+2+...10äº¿ï¼Œæ¯ä¸ªä»»åŠ¡åªèƒ½å¤„ç†1000ä¸ªæ•°ç›¸åŠ ï¼Œè¶…è¿‡1000ä¸ªçš„è‡ªåŠ¨åˆ†è§£æˆå°ä»»åŠ¡å¹¶è¡Œå¤„ç†ï¼›å¹¶å±•ç¤ºäº†é€šè¿‡ä¸ä½¿ç”¨Fork/Joinå’Œä½¿ç”¨æ—¶çš„æ—¶é—´æŸè€—å¯¹æ¯”ã€‚\n\n```\nimport java.util.concurrent.ForkJoinPool;\nimport java.util.concurrent.RecursiveTask;\n\npublic class ForkJoinTask extends RecursiveTask<Long> {\n\n\tprivate static final long MAX = 1000000000L;\n\tprivate static final long THRESHOLD = 1000L;\n\tprivate long start;\n\tprivate long end;\n\n\tpublic ForkJoinTask(long start, long end) {\n\t\tthis.start = start;\n\t\tthis.end = end;\n\t}\n\n\tpublic static void main(String[] args) {\n\t\ttest();\n\t\tSystem.out.println(\"--------------------\");\n\t\ttestForkJoin();\n\t}\n\n\tprivate static void test() {\n\t\tSystem.out.println(\"test\");\n\t\tlong start = System.currentTimeMillis();\n\t\tLong sum = 0L;\n\t\tfor (long i = 0L; i <= MAX; i++) {\n\t\t\tsum += i;\n\t\t}\n\t\tSystem.out.println(sum);\n\t\tSystem.out.println(System.currentTimeMillis() - start + \"ms\");\n\t}\n\n\tprivate static void testForkJoin() {\n\t\tSystem.out.println(\"testForkJoin\");\n\t\tlong start = System.currentTimeMillis();\n\t\tForkJoinPool forkJoinPool = new ForkJoinPool();\n\t\tLong sum = forkJoinPool.invoke(new ForkJoinTask(1, MAX));\n\t\tSystem.out.println(sum);\n\t\tSystem.out.println(System.currentTimeMillis() - start + \"ms\");\n\t}\n\n\t@Override\n\tprotected Long compute() {\n\t\tlong sum = 0;\n\t\tif (end - start <= THRESHOLD) {\n\t\t\tfor (long i = start; i <= end; i++) {\n\t\t\t\tsum += i;\n\t\t\t}\n\t\t\treturn sum;\n\t\t} else {\n\t\t\tlong mid = (start + end) / 2;\n\n\t\t\tForkJoinTask task1 = new ForkJoinTask(start, mid);\n\t\t\ttask1.fork();\n\n\t\t\tForkJoinTask task2 = new ForkJoinTask(mid + 1, end);\n\t\t\ttask2.fork();\n\n\t\t\treturn task1.join() + task2.join();\n\t\t}\n\t}\n\n}\n```\n\nè¿™é‡Œéœ€è¦è®¡ç®—ç»“æœï¼Œæ‰€ä»¥ä»»åŠ¡ç»§æ‰¿çš„æ˜¯RecursiveTaskç±»ã€‚ForkJoinTaskéœ€è¦å®ç°computeæ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•é‡Œé¦–å…ˆéœ€è¦åˆ¤æ–­ä»»åŠ¡æ˜¯å¦å°äºç­‰äºé˜ˆå€¼1000ï¼Œå¦‚æœæ˜¯å°±ç›´æ¥æ‰§è¡Œä»»åŠ¡ã€‚å¦åˆ™åˆ†å‰²æˆä¸¤ä¸ªå­ä»»åŠ¡ï¼Œæ¯ä¸ªå­ä»»åŠ¡åœ¨è°ƒç”¨forkæ–¹æ³•æ—¶ï¼Œåˆä¼šè¿›å…¥computeæ–¹æ³•ï¼Œçœ‹çœ‹å½“å‰å­ä»»åŠ¡æ˜¯å¦éœ€è¦ç»§ç»­åˆ†å‰²æˆå­™ä»»åŠ¡ï¼Œå¦‚æœä¸éœ€è¦ç»§ç»­åˆ†å‰²ï¼Œåˆ™æ‰§è¡Œå½“å‰å­ä»»åŠ¡å¹¶è¿”å›ç»“æœã€‚ä½¿ç”¨joinæ–¹æ³•ä¼šé˜»å¡å¹¶ç­‰å¾…å­ä»»åŠ¡æ‰§è¡Œå®Œå¹¶å¾—åˆ°å…¶ç»“æœã€‚\n\nç¨‹åºè¾“å‡ºï¼š\n\n```\ntest\n500000000500000000\n4992ms\n--------------------\ntestForkJoin\n500000000500000000\n508ms\n```\nä»ç»“æœçœ‹å‡ºï¼Œå¹¶è¡Œçš„æ—¶é—´æŸè€—æ˜æ˜¾è¦å°‘äºä¸²è¡Œçš„ï¼Œè¿™å°±æ˜¯å¹¶è¡Œä»»åŠ¡çš„å¥½å¤„ã€‚\n\nå°½ç®¡å¦‚æ­¤ï¼Œåœ¨ä½¿ç”¨Fork/Joinæ—¶ä¹Ÿå¾—æ³¨æ„ï¼Œä¸è¦ç›²ç›®ä½¿ç”¨ã€‚\n\n1. å¦‚æœä»»åŠ¡æ‹†è§£çš„å¾ˆæ·±ï¼Œç³»ç»Ÿå†…çš„çº¿ç¨‹æ•°é‡å †ç§¯ï¼Œå¯¼è‡´ç³»ç»Ÿæ€§èƒ½æ€§èƒ½ä¸¥é‡ä¸‹é™ï¼›\n1. å¦‚æœå‡½æ•°çš„è°ƒç”¨æ ˆå¾ˆæ·±ï¼Œä¼šå¯¼è‡´æ ˆå†…å­˜æº¢å‡ºï¼›","source":"_posts/å¤šçº¿ç¨‹/å¹¶è¡Œä»»åŠ¡æ‰§è¡Œç¥å™¨ Fork & Join å®æˆ˜.md","raw":"---\ntitle: å¹¶è¡Œä»»åŠ¡æ‰§è¡Œç¥å™¨ Fork & Join å®æˆ˜\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: å¤šçº¿ç¨‹\n---\n\n#### Fork/Joinæ˜¯ä»€ä¹ˆï¼Ÿ\n\nFork/Joinæ¡†æ¶æ˜¯Java7æä¾›çš„å¹¶è¡Œæ‰§è¡Œä»»åŠ¡æ¡†æ¶ï¼Œæ€æƒ³æ˜¯å°†å¤§ä»»åŠ¡åˆ†è§£æˆå°ä»»åŠ¡ï¼Œç„¶åå°ä»»åŠ¡åˆå¯ä»¥ç»§ç»­åˆ†è§£ï¼Œç„¶åæ¯ä¸ªå°ä»»åŠ¡åˆ†åˆ«è®¡ç®—å‡ºç»“æœå†åˆå¹¶èµ·æ¥ï¼Œæœ€åå°†æ±‡æ€»çš„ç»“æœä½œä¸ºå¤§ä»»åŠ¡ç»“æœã€‚å…¶æ€æƒ³å’ŒMapReduceçš„æ€æƒ³éå¸¸ç±»ä¼¼ã€‚å¯¹äºä»»åŠ¡çš„åˆ†å‰²ï¼Œè¦æ±‚å„ä¸ªå­ä»»åŠ¡ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œèƒ½å¤Ÿå¹¶è¡Œç‹¬ç«‹åœ°æ‰§è¡Œä»»åŠ¡ï¼Œäº’ç›¸ä¹‹é—´ä¸å½±å“ã€‚\n\n**Fork/Joinçš„è¿è¡Œæµç¨‹å›¾å¦‚ä¸‹ï¼š**\n\n![image](https://res.infoq.com/articles/fork-join-introduction/zh/resources/21.png)\n\næˆ‘ä»¬å¯ä»¥é€šè¿‡Fork/Joinå•è¯å­—é¢ä¸Šçš„æ„æ€å»ç†è§£è¿™ä¸ªæ¡†æ¶ã€‚Forkæ˜¯å‰å­åˆ†å‰çš„æ„æ€ï¼Œå³å°†å¤§ä»»åŠ¡åˆ†è§£æˆå¹¶è¡Œçš„å°ä»»åŠ¡ï¼ŒJoinæ˜¯è¿æ¥ç»“åˆçš„æ„æ€ï¼Œå³å°†æ‰€æœ‰å¹¶è¡Œçš„å°ä»»åŠ¡çš„æ‰§è¡Œç»“æœæ±‡æ€»èµ·æ¥ã€‚\n\n![image](http://java.boot.by/ocpjp7-upgrade/images/040501.gif)\n\n#### å·¥ä½œçªƒå–ç®—æ³•\n\nForkJoiné‡‡ç”¨äº†å·¥ä½œçªƒå–ï¼ˆwork-stealingï¼‰ç®—æ³•ï¼Œè‹¥ä¸€ä¸ªå·¥ä½œçº¿ç¨‹çš„ä»»åŠ¡é˜Ÿåˆ—ä¸ºç©ºæ²¡æœ‰ä»»åŠ¡æ‰§è¡Œæ—¶ï¼Œä¾¿ä»å…¶ä»–å·¥ä½œçº¿ç¨‹ä¸­è·å–ä»»åŠ¡ä¸»åŠ¨æ‰§è¡Œã€‚ä¸ºäº†å®ç°å·¥ä½œçªƒå–ï¼Œåœ¨å·¥ä½œçº¿ç¨‹ä¸­ç»´æŠ¤äº†åŒç«¯é˜Ÿåˆ—ï¼Œçªƒå–ä»»åŠ¡çº¿ç¨‹ä»é˜Ÿå°¾è·å–ä»»åŠ¡ï¼Œè¢«çªƒå–ä»»åŠ¡çº¿ç¨‹ä»é˜Ÿå¤´è·å–ä»»åŠ¡ã€‚è¿™ç§æœºåˆ¶å……åˆ†åˆ©ç”¨çº¿ç¨‹è¿›è¡Œå¹¶è¡Œè®¡ç®—ï¼Œå‡å°‘äº†çº¿ç¨‹ç«äº‰ã€‚ä½†æ˜¯å½“é˜Ÿåˆ—ä¸­åªå­˜åœ¨ä¸€ä¸ªä»»åŠ¡äº†æ—¶ï¼Œä¸¤ä¸ªçº¿ç¨‹å»å–åè€Œä¼šé€ æˆèµ„æºæµªè´¹ã€‚\n\n**å·¥ä½œçªƒå–çš„è¿è¡Œæµç¨‹å›¾å¦‚ä¸‹ï¼š**\n\n![image](https://res.infoq.com/articles/fork-join-introduction/zh/resources/image3.png)\n\n#### Fork/Joinæ ¸å¿ƒç±»\n\nFork/Joinæ¡†æ¶ä¸»è¦ç”±å­ä»»åŠ¡ã€ä»»åŠ¡è°ƒåº¦ä¸¤éƒ¨åˆ†ç»„æˆï¼Œç±»å±‚æ¬¡å›¾å¦‚ä¸‹ã€‚\n\n![image](http://img.blog.csdn.net/20160720172854109)\n\n- **ForkJoinPool**\n\nForkJoinPoolæ˜¯ForkJoinæ¡†æ¶ä¸­çš„ä»»åŠ¡è°ƒåº¦å™¨ï¼Œå’ŒThreadPoolExecutorä¸€æ ·å®ç°äº†è‡ªå·±çš„çº¿ç¨‹æ± ï¼Œæä¾›äº†ä¸‰ç§è°ƒåº¦å­ä»»åŠ¡çš„æ–¹æ³•ï¼š\n\n1. executeï¼šå¼‚æ­¥æ‰§è¡ŒæŒ‡å®šä»»åŠ¡ï¼Œæ— è¿”å›ç»“æœï¼›\n1. invokeã€invokeAllï¼šå¼‚æ­¥æ‰§è¡ŒæŒ‡å®šä»»åŠ¡ï¼Œç­‰å¾…å®Œæˆæ‰è¿”å›ç»“æœï¼›\n1. submitï¼šå¼‚æ­¥æ‰§è¡ŒæŒ‡å®šä»»åŠ¡ï¼Œå¹¶ç«‹å³è¿”å›ä¸€ä¸ªFutureå¯¹è±¡ï¼›\n\n- **ForkJoinTask**\n\nFork/Joinæ¡†æ¶ä¸­çš„å®é™…çš„æ‰§è¡Œä»»åŠ¡ç±»ï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§å®ç°ï¼Œä¸€èˆ¬ç»§æ‰¿è¿™ä¸¤ç§å®ç°ç±»å³å¯ã€‚\n\n1. RecursiveActionï¼šç”¨äºæ— ç»“æœè¿”å›çš„å­ä»»åŠ¡ï¼›\n1. RecursiveTaskï¼šç”¨äºæœ‰ç»“æœè¿”å›çš„å­ä»»åŠ¡ï¼›\n\n#### Fork/Joinæ¡†æ¶å®æˆ˜\n\nä¸‹é¢å®ç°ä¸€ä¸ªFork/Joinå°ä¾‹å­ï¼Œä»1+2+...10äº¿ï¼Œæ¯ä¸ªä»»åŠ¡åªèƒ½å¤„ç†1000ä¸ªæ•°ç›¸åŠ ï¼Œè¶…è¿‡1000ä¸ªçš„è‡ªåŠ¨åˆ†è§£æˆå°ä»»åŠ¡å¹¶è¡Œå¤„ç†ï¼›å¹¶å±•ç¤ºäº†é€šè¿‡ä¸ä½¿ç”¨Fork/Joinå’Œä½¿ç”¨æ—¶çš„æ—¶é—´æŸè€—å¯¹æ¯”ã€‚\n\n```\nimport java.util.concurrent.ForkJoinPool;\nimport java.util.concurrent.RecursiveTask;\n\npublic class ForkJoinTask extends RecursiveTask<Long> {\n\n\tprivate static final long MAX = 1000000000L;\n\tprivate static final long THRESHOLD = 1000L;\n\tprivate long start;\n\tprivate long end;\n\n\tpublic ForkJoinTask(long start, long end) {\n\t\tthis.start = start;\n\t\tthis.end = end;\n\t}\n\n\tpublic static void main(String[] args) {\n\t\ttest();\n\t\tSystem.out.println(\"--------------------\");\n\t\ttestForkJoin();\n\t}\n\n\tprivate static void test() {\n\t\tSystem.out.println(\"test\");\n\t\tlong start = System.currentTimeMillis();\n\t\tLong sum = 0L;\n\t\tfor (long i = 0L; i <= MAX; i++) {\n\t\t\tsum += i;\n\t\t}\n\t\tSystem.out.println(sum);\n\t\tSystem.out.println(System.currentTimeMillis() - start + \"ms\");\n\t}\n\n\tprivate static void testForkJoin() {\n\t\tSystem.out.println(\"testForkJoin\");\n\t\tlong start = System.currentTimeMillis();\n\t\tForkJoinPool forkJoinPool = new ForkJoinPool();\n\t\tLong sum = forkJoinPool.invoke(new ForkJoinTask(1, MAX));\n\t\tSystem.out.println(sum);\n\t\tSystem.out.println(System.currentTimeMillis() - start + \"ms\");\n\t}\n\n\t@Override\n\tprotected Long compute() {\n\t\tlong sum = 0;\n\t\tif (end - start <= THRESHOLD) {\n\t\t\tfor (long i = start; i <= end; i++) {\n\t\t\t\tsum += i;\n\t\t\t}\n\t\t\treturn sum;\n\t\t} else {\n\t\t\tlong mid = (start + end) / 2;\n\n\t\t\tForkJoinTask task1 = new ForkJoinTask(start, mid);\n\t\t\ttask1.fork();\n\n\t\t\tForkJoinTask task2 = new ForkJoinTask(mid + 1, end);\n\t\t\ttask2.fork();\n\n\t\t\treturn task1.join() + task2.join();\n\t\t}\n\t}\n\n}\n```\n\nè¿™é‡Œéœ€è¦è®¡ç®—ç»“æœï¼Œæ‰€ä»¥ä»»åŠ¡ç»§æ‰¿çš„æ˜¯RecursiveTaskç±»ã€‚ForkJoinTaskéœ€è¦å®ç°computeæ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•é‡Œé¦–å…ˆéœ€è¦åˆ¤æ–­ä»»åŠ¡æ˜¯å¦å°äºç­‰äºé˜ˆå€¼1000ï¼Œå¦‚æœæ˜¯å°±ç›´æ¥æ‰§è¡Œä»»åŠ¡ã€‚å¦åˆ™åˆ†å‰²æˆä¸¤ä¸ªå­ä»»åŠ¡ï¼Œæ¯ä¸ªå­ä»»åŠ¡åœ¨è°ƒç”¨forkæ–¹æ³•æ—¶ï¼Œåˆä¼šè¿›å…¥computeæ–¹æ³•ï¼Œçœ‹çœ‹å½“å‰å­ä»»åŠ¡æ˜¯å¦éœ€è¦ç»§ç»­åˆ†å‰²æˆå­™ä»»åŠ¡ï¼Œå¦‚æœä¸éœ€è¦ç»§ç»­åˆ†å‰²ï¼Œåˆ™æ‰§è¡Œå½“å‰å­ä»»åŠ¡å¹¶è¿”å›ç»“æœã€‚ä½¿ç”¨joinæ–¹æ³•ä¼šé˜»å¡å¹¶ç­‰å¾…å­ä»»åŠ¡æ‰§è¡Œå®Œå¹¶å¾—åˆ°å…¶ç»“æœã€‚\n\nç¨‹åºè¾“å‡ºï¼š\n\n```\ntest\n500000000500000000\n4992ms\n--------------------\ntestForkJoin\n500000000500000000\n508ms\n```\nä»ç»“æœçœ‹å‡ºï¼Œå¹¶è¡Œçš„æ—¶é—´æŸè€—æ˜æ˜¾è¦å°‘äºä¸²è¡Œçš„ï¼Œè¿™å°±æ˜¯å¹¶è¡Œä»»åŠ¡çš„å¥½å¤„ã€‚\n\nå°½ç®¡å¦‚æ­¤ï¼Œåœ¨ä½¿ç”¨Fork/Joinæ—¶ä¹Ÿå¾—æ³¨æ„ï¼Œä¸è¦ç›²ç›®ä½¿ç”¨ã€‚\n\n1. å¦‚æœä»»åŠ¡æ‹†è§£çš„å¾ˆæ·±ï¼Œç³»ç»Ÿå†…çš„çº¿ç¨‹æ•°é‡å †ç§¯ï¼Œå¯¼è‡´ç³»ç»Ÿæ€§èƒ½æ€§èƒ½ä¸¥é‡ä¸‹é™ï¼›\n1. å¦‚æœå‡½æ•°çš„è°ƒç”¨æ ˆå¾ˆæ·±ï¼Œä¼šå¯¼è‡´æ ˆå†…å­˜æº¢å‡ºï¼›","slug":"å¤šçº¿ç¨‹/å¹¶è¡Œä»»åŠ¡æ‰§è¡Œç¥å™¨ Fork & Join å®æˆ˜","published":1,"updated":"2025-10-15T07:20:24.981Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076r002uqkd4gvoxcw3r","content":"<h4 id=\"Fork-Joinæ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#Fork-Joinæ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"Fork&#x2F;Joinæ˜¯ä»€ä¹ˆï¼Ÿ\"></a>Fork&#x2F;Joinæ˜¯ä»€ä¹ˆï¼Ÿ</h4><p>Fork&#x2F;Joinæ¡†æ¶æ˜¯Java7æä¾›çš„å¹¶è¡Œæ‰§è¡Œä»»åŠ¡æ¡†æ¶ï¼Œæ€æƒ³æ˜¯å°†å¤§ä»»åŠ¡åˆ†è§£æˆå°ä»»åŠ¡ï¼Œç„¶åå°ä»»åŠ¡åˆå¯ä»¥ç»§ç»­åˆ†è§£ï¼Œç„¶åæ¯ä¸ªå°ä»»åŠ¡åˆ†åˆ«è®¡ç®—å‡ºç»“æœå†åˆå¹¶èµ·æ¥ï¼Œæœ€åå°†æ±‡æ€»çš„ç»“æœä½œä¸ºå¤§ä»»åŠ¡ç»“æœã€‚å…¶æ€æƒ³å’ŒMapReduceçš„æ€æƒ³éå¸¸ç±»ä¼¼ã€‚å¯¹äºä»»åŠ¡çš„åˆ†å‰²ï¼Œè¦æ±‚å„ä¸ªå­ä»»åŠ¡ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œèƒ½å¤Ÿå¹¶è¡Œç‹¬ç«‹åœ°æ‰§è¡Œä»»åŠ¡ï¼Œäº’ç›¸ä¹‹é—´ä¸å½±å“ã€‚</p>\n<p><strong>Fork&#x2F;Joinçš„è¿è¡Œæµç¨‹å›¾å¦‚ä¸‹ï¼š</strong></p>\n<p><img src=\"https://res.infoq.com/articles/fork-join-introduction/zh/resources/21.png\" alt=\"image\"></p>\n<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡Fork&#x2F;Joinå•è¯å­—é¢ä¸Šçš„æ„æ€å»ç†è§£è¿™ä¸ªæ¡†æ¶ã€‚Forkæ˜¯å‰å­åˆ†å‰çš„æ„æ€ï¼Œå³å°†å¤§ä»»åŠ¡åˆ†è§£æˆå¹¶è¡Œçš„å°ä»»åŠ¡ï¼ŒJoinæ˜¯è¿æ¥ç»“åˆçš„æ„æ€ï¼Œå³å°†æ‰€æœ‰å¹¶è¡Œçš„å°ä»»åŠ¡çš„æ‰§è¡Œç»“æœæ±‡æ€»èµ·æ¥ã€‚</p>\n<p><img src=\"http://java.boot.by/ocpjp7-upgrade/images/040501.gif\" alt=\"image\"></p>\n<h4 id=\"å·¥ä½œçªƒå–ç®—æ³•\"><a href=\"#å·¥ä½œçªƒå–ç®—æ³•\" class=\"headerlink\" title=\"å·¥ä½œçªƒå–ç®—æ³•\"></a>å·¥ä½œçªƒå–ç®—æ³•</h4><p>ForkJoiné‡‡ç”¨äº†å·¥ä½œçªƒå–ï¼ˆwork-stealingï¼‰ç®—æ³•ï¼Œè‹¥ä¸€ä¸ªå·¥ä½œçº¿ç¨‹çš„ä»»åŠ¡é˜Ÿåˆ—ä¸ºç©ºæ²¡æœ‰ä»»åŠ¡æ‰§è¡Œæ—¶ï¼Œä¾¿ä»å…¶ä»–å·¥ä½œçº¿ç¨‹ä¸­è·å–ä»»åŠ¡ä¸»åŠ¨æ‰§è¡Œã€‚ä¸ºäº†å®ç°å·¥ä½œçªƒå–ï¼Œåœ¨å·¥ä½œçº¿ç¨‹ä¸­ç»´æŠ¤äº†åŒç«¯é˜Ÿåˆ—ï¼Œçªƒå–ä»»åŠ¡çº¿ç¨‹ä»é˜Ÿå°¾è·å–ä»»åŠ¡ï¼Œè¢«çªƒå–ä»»åŠ¡çº¿ç¨‹ä»é˜Ÿå¤´è·å–ä»»åŠ¡ã€‚è¿™ç§æœºåˆ¶å……åˆ†åˆ©ç”¨çº¿ç¨‹è¿›è¡Œå¹¶è¡Œè®¡ç®—ï¼Œå‡å°‘äº†çº¿ç¨‹ç«äº‰ã€‚ä½†æ˜¯å½“é˜Ÿåˆ—ä¸­åªå­˜åœ¨ä¸€ä¸ªä»»åŠ¡äº†æ—¶ï¼Œä¸¤ä¸ªçº¿ç¨‹å»å–åè€Œä¼šé€ æˆèµ„æºæµªè´¹ã€‚</p>\n<p><strong>å·¥ä½œçªƒå–çš„è¿è¡Œæµç¨‹å›¾å¦‚ä¸‹ï¼š</strong></p>\n<p><img src=\"https://res.infoq.com/articles/fork-join-introduction/zh/resources/image3.png\" alt=\"image\"></p>\n<h4 id=\"Fork-Joinæ ¸å¿ƒç±»\"><a href=\"#Fork-Joinæ ¸å¿ƒç±»\" class=\"headerlink\" title=\"Fork&#x2F;Joinæ ¸å¿ƒç±»\"></a>Fork&#x2F;Joinæ ¸å¿ƒç±»</h4><p>Fork&#x2F;Joinæ¡†æ¶ä¸»è¦ç”±å­ä»»åŠ¡ã€ä»»åŠ¡è°ƒåº¦ä¸¤éƒ¨åˆ†ç»„æˆï¼Œç±»å±‚æ¬¡å›¾å¦‚ä¸‹ã€‚</p>\n<p><img src=\"http://img.blog.csdn.net/20160720172854109\" alt=\"image\"></p>\n<ul>\n<li><strong>ForkJoinPool</strong></li>\n</ul>\n<p>ForkJoinPoolæ˜¯ForkJoinæ¡†æ¶ä¸­çš„ä»»åŠ¡è°ƒåº¦å™¨ï¼Œå’ŒThreadPoolExecutorä¸€æ ·å®ç°äº†è‡ªå·±çš„çº¿ç¨‹æ± ï¼Œæä¾›äº†ä¸‰ç§è°ƒåº¦å­ä»»åŠ¡çš„æ–¹æ³•ï¼š</p>\n<ol>\n<li>executeï¼šå¼‚æ­¥æ‰§è¡ŒæŒ‡å®šä»»åŠ¡ï¼Œæ— è¿”å›ç»“æœï¼›</li>\n<li>invokeã€invokeAllï¼šå¼‚æ­¥æ‰§è¡ŒæŒ‡å®šä»»åŠ¡ï¼Œç­‰å¾…å®Œæˆæ‰è¿”å›ç»“æœï¼›</li>\n<li>submitï¼šå¼‚æ­¥æ‰§è¡ŒæŒ‡å®šä»»åŠ¡ï¼Œå¹¶ç«‹å³è¿”å›ä¸€ä¸ªFutureå¯¹è±¡ï¼›</li>\n</ol>\n<ul>\n<li><strong>ForkJoinTask</strong></li>\n</ul>\n<p>Fork&#x2F;Joinæ¡†æ¶ä¸­çš„å®é™…çš„æ‰§è¡Œä»»åŠ¡ç±»ï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§å®ç°ï¼Œä¸€èˆ¬ç»§æ‰¿è¿™ä¸¤ç§å®ç°ç±»å³å¯ã€‚</p>\n<ol>\n<li>RecursiveActionï¼šç”¨äºæ— ç»“æœè¿”å›çš„å­ä»»åŠ¡ï¼›</li>\n<li>RecursiveTaskï¼šç”¨äºæœ‰ç»“æœè¿”å›çš„å­ä»»åŠ¡ï¼›</li>\n</ol>\n<h4 id=\"Fork-Joinæ¡†æ¶å®æˆ˜\"><a href=\"#Fork-Joinæ¡†æ¶å®æˆ˜\" class=\"headerlink\" title=\"Fork&#x2F;Joinæ¡†æ¶å®æˆ˜\"></a>Fork&#x2F;Joinæ¡†æ¶å®æˆ˜</h4><p>ä¸‹é¢å®ç°ä¸€ä¸ªFork&#x2F;Joinå°ä¾‹å­ï¼Œä»1+2+â€¦10äº¿ï¼Œæ¯ä¸ªä»»åŠ¡åªèƒ½å¤„ç†1000ä¸ªæ•°ç›¸åŠ ï¼Œè¶…è¿‡1000ä¸ªçš„è‡ªåŠ¨åˆ†è§£æˆå°ä»»åŠ¡å¹¶è¡Œå¤„ç†ï¼›å¹¶å±•ç¤ºäº†é€šè¿‡ä¸ä½¿ç”¨Fork&#x2F;Joinå’Œä½¿ç”¨æ—¶çš„æ—¶é—´æŸè€—å¯¹æ¯”ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">import java.util.concurrent.ForkJoinPool;\nimport java.util.concurrent.RecursiveTask;\n\npublic class ForkJoinTask extends RecursiveTask&lt;Long&gt; &#123;\n\n\tprivate static final long MAX &#x3D; 1000000000L;\n\tprivate static final long THRESHOLD &#x3D; 1000L;\n\tprivate long start;\n\tprivate long end;\n\n\tpublic ForkJoinTask(long start, long end) &#123;\n\t\tthis.start &#x3D; start;\n\t\tthis.end &#x3D; end;\n\t&#125;\n\n\tpublic static void main(String[] args) &#123;\n\t\ttest();\n\t\tSystem.out.println(&quot;--------------------&quot;);\n\t\ttestForkJoin();\n\t&#125;\n\n\tprivate static void test() &#123;\n\t\tSystem.out.println(&quot;test&quot;);\n\t\tlong start &#x3D; System.currentTimeMillis();\n\t\tLong sum &#x3D; 0L;\n\t\tfor (long i &#x3D; 0L; i &lt;&#x3D; MAX; i++) &#123;\n\t\t\tsum +&#x3D; i;\n\t\t&#125;\n\t\tSystem.out.println(sum);\n\t\tSystem.out.println(System.currentTimeMillis() - start + &quot;ms&quot;);\n\t&#125;\n\n\tprivate static void testForkJoin() &#123;\n\t\tSystem.out.println(&quot;testForkJoin&quot;);\n\t\tlong start &#x3D; System.currentTimeMillis();\n\t\tForkJoinPool forkJoinPool &#x3D; new ForkJoinPool();\n\t\tLong sum &#x3D; forkJoinPool.invoke(new ForkJoinTask(1, MAX));\n\t\tSystem.out.println(sum);\n\t\tSystem.out.println(System.currentTimeMillis() - start + &quot;ms&quot;);\n\t&#125;\n\n\t@Override\n\tprotected Long compute() &#123;\n\t\tlong sum &#x3D; 0;\n\t\tif (end - start &lt;&#x3D; THRESHOLD) &#123;\n\t\t\tfor (long i &#x3D; start; i &lt;&#x3D; end; i++) &#123;\n\t\t\t\tsum +&#x3D; i;\n\t\t\t&#125;\n\t\t\treturn sum;\n\t\t&#125; else &#123;\n\t\t\tlong mid &#x3D; (start + end) &#x2F; 2;\n\n\t\t\tForkJoinTask task1 &#x3D; new ForkJoinTask(start, mid);\n\t\t\ttask1.fork();\n\n\t\t\tForkJoinTask task2 &#x3D; new ForkJoinTask(mid + 1, end);\n\t\t\ttask2.fork();\n\n\t\t\treturn task1.join() + task2.join();\n\t\t&#125;\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™é‡Œéœ€è¦è®¡ç®—ç»“æœï¼Œæ‰€ä»¥ä»»åŠ¡ç»§æ‰¿çš„æ˜¯RecursiveTaskç±»ã€‚ForkJoinTaskéœ€è¦å®ç°computeæ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•é‡Œé¦–å…ˆéœ€è¦åˆ¤æ–­ä»»åŠ¡æ˜¯å¦å°äºç­‰äºé˜ˆå€¼1000ï¼Œå¦‚æœæ˜¯å°±ç›´æ¥æ‰§è¡Œä»»åŠ¡ã€‚å¦åˆ™åˆ†å‰²æˆä¸¤ä¸ªå­ä»»åŠ¡ï¼Œæ¯ä¸ªå­ä»»åŠ¡åœ¨è°ƒç”¨forkæ–¹æ³•æ—¶ï¼Œåˆä¼šè¿›å…¥computeæ–¹æ³•ï¼Œçœ‹çœ‹å½“å‰å­ä»»åŠ¡æ˜¯å¦éœ€è¦ç»§ç»­åˆ†å‰²æˆå­™ä»»åŠ¡ï¼Œå¦‚æœä¸éœ€è¦ç»§ç»­åˆ†å‰²ï¼Œåˆ™æ‰§è¡Œå½“å‰å­ä»»åŠ¡å¹¶è¿”å›ç»“æœã€‚ä½¿ç”¨joinæ–¹æ³•ä¼šé˜»å¡å¹¶ç­‰å¾…å­ä»»åŠ¡æ‰§è¡Œå®Œå¹¶å¾—åˆ°å…¶ç»“æœã€‚</p>\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">test\n500000000500000000\n4992ms\n--------------------\ntestForkJoin\n500000000500000000\n508ms<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>ä»ç»“æœçœ‹å‡ºï¼Œå¹¶è¡Œçš„æ—¶é—´æŸè€—æ˜æ˜¾è¦å°‘äºä¸²è¡Œçš„ï¼Œè¿™å°±æ˜¯å¹¶è¡Œä»»åŠ¡çš„å¥½å¤„ã€‚</p>\n<p>å°½ç®¡å¦‚æ­¤ï¼Œåœ¨ä½¿ç”¨Fork&#x2F;Joinæ—¶ä¹Ÿå¾—æ³¨æ„ï¼Œä¸è¦ç›²ç›®ä½¿ç”¨ã€‚</p>\n<ol>\n<li>å¦‚æœä»»åŠ¡æ‹†è§£çš„å¾ˆæ·±ï¼Œç³»ç»Ÿå†…çš„çº¿ç¨‹æ•°é‡å †ç§¯ï¼Œå¯¼è‡´ç³»ç»Ÿæ€§èƒ½æ€§èƒ½ä¸¥é‡ä¸‹é™ï¼›</li>\n<li>å¦‚æœå‡½æ•°çš„è°ƒç”¨æ ˆå¾ˆæ·±ï¼Œä¼šå¯¼è‡´æ ˆå†…å­˜æº¢å‡ºï¼›</li>\n</ol>\n","excerpt":"","more":"<h4 id=\"Fork-Joinæ˜¯ä»€ä¹ˆï¼Ÿ\"><a href=\"#Fork-Joinæ˜¯ä»€ä¹ˆï¼Ÿ\" class=\"headerlink\" title=\"Fork&#x2F;Joinæ˜¯ä»€ä¹ˆï¼Ÿ\"></a>Fork&#x2F;Joinæ˜¯ä»€ä¹ˆï¼Ÿ</h4><p>Fork&#x2F;Joinæ¡†æ¶æ˜¯Java7æä¾›çš„å¹¶è¡Œæ‰§è¡Œä»»åŠ¡æ¡†æ¶ï¼Œæ€æƒ³æ˜¯å°†å¤§ä»»åŠ¡åˆ†è§£æˆå°ä»»åŠ¡ï¼Œç„¶åå°ä»»åŠ¡åˆå¯ä»¥ç»§ç»­åˆ†è§£ï¼Œç„¶åæ¯ä¸ªå°ä»»åŠ¡åˆ†åˆ«è®¡ç®—å‡ºç»“æœå†åˆå¹¶èµ·æ¥ï¼Œæœ€åå°†æ±‡æ€»çš„ç»“æœä½œä¸ºå¤§ä»»åŠ¡ç»“æœã€‚å…¶æ€æƒ³å’ŒMapReduceçš„æ€æƒ³éå¸¸ç±»ä¼¼ã€‚å¯¹äºä»»åŠ¡çš„åˆ†å‰²ï¼Œè¦æ±‚å„ä¸ªå­ä»»åŠ¡ä¹‹é—´ç›¸äº’ç‹¬ç«‹ï¼Œèƒ½å¤Ÿå¹¶è¡Œç‹¬ç«‹åœ°æ‰§è¡Œä»»åŠ¡ï¼Œäº’ç›¸ä¹‹é—´ä¸å½±å“ã€‚</p>\n<p><strong>Fork&#x2F;Joinçš„è¿è¡Œæµç¨‹å›¾å¦‚ä¸‹ï¼š</strong></p>\n<p><img src=\"https://res.infoq.com/articles/fork-join-introduction/zh/resources/21.png\" alt=\"image\"></p>\n<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡Fork&#x2F;Joinå•è¯å­—é¢ä¸Šçš„æ„æ€å»ç†è§£è¿™ä¸ªæ¡†æ¶ã€‚Forkæ˜¯å‰å­åˆ†å‰çš„æ„æ€ï¼Œå³å°†å¤§ä»»åŠ¡åˆ†è§£æˆå¹¶è¡Œçš„å°ä»»åŠ¡ï¼ŒJoinæ˜¯è¿æ¥ç»“åˆçš„æ„æ€ï¼Œå³å°†æ‰€æœ‰å¹¶è¡Œçš„å°ä»»åŠ¡çš„æ‰§è¡Œç»“æœæ±‡æ€»èµ·æ¥ã€‚</p>\n<p><img src=\"http://java.boot.by/ocpjp7-upgrade/images/040501.gif\" alt=\"image\"></p>\n<h4 id=\"å·¥ä½œçªƒå–ç®—æ³•\"><a href=\"#å·¥ä½œçªƒå–ç®—æ³•\" class=\"headerlink\" title=\"å·¥ä½œçªƒå–ç®—æ³•\"></a>å·¥ä½œçªƒå–ç®—æ³•</h4><p>ForkJoiné‡‡ç”¨äº†å·¥ä½œçªƒå–ï¼ˆwork-stealingï¼‰ç®—æ³•ï¼Œè‹¥ä¸€ä¸ªå·¥ä½œçº¿ç¨‹çš„ä»»åŠ¡é˜Ÿåˆ—ä¸ºç©ºæ²¡æœ‰ä»»åŠ¡æ‰§è¡Œæ—¶ï¼Œä¾¿ä»å…¶ä»–å·¥ä½œçº¿ç¨‹ä¸­è·å–ä»»åŠ¡ä¸»åŠ¨æ‰§è¡Œã€‚ä¸ºäº†å®ç°å·¥ä½œçªƒå–ï¼Œåœ¨å·¥ä½œçº¿ç¨‹ä¸­ç»´æŠ¤äº†åŒç«¯é˜Ÿåˆ—ï¼Œçªƒå–ä»»åŠ¡çº¿ç¨‹ä»é˜Ÿå°¾è·å–ä»»åŠ¡ï¼Œè¢«çªƒå–ä»»åŠ¡çº¿ç¨‹ä»é˜Ÿå¤´è·å–ä»»åŠ¡ã€‚è¿™ç§æœºåˆ¶å……åˆ†åˆ©ç”¨çº¿ç¨‹è¿›è¡Œå¹¶è¡Œè®¡ç®—ï¼Œå‡å°‘äº†çº¿ç¨‹ç«äº‰ã€‚ä½†æ˜¯å½“é˜Ÿåˆ—ä¸­åªå­˜åœ¨ä¸€ä¸ªä»»åŠ¡äº†æ—¶ï¼Œä¸¤ä¸ªçº¿ç¨‹å»å–åè€Œä¼šé€ æˆèµ„æºæµªè´¹ã€‚</p>\n<p><strong>å·¥ä½œçªƒå–çš„è¿è¡Œæµç¨‹å›¾å¦‚ä¸‹ï¼š</strong></p>\n<p><img src=\"https://res.infoq.com/articles/fork-join-introduction/zh/resources/image3.png\" alt=\"image\"></p>\n<h4 id=\"Fork-Joinæ ¸å¿ƒç±»\"><a href=\"#Fork-Joinæ ¸å¿ƒç±»\" class=\"headerlink\" title=\"Fork&#x2F;Joinæ ¸å¿ƒç±»\"></a>Fork&#x2F;Joinæ ¸å¿ƒç±»</h4><p>Fork&#x2F;Joinæ¡†æ¶ä¸»è¦ç”±å­ä»»åŠ¡ã€ä»»åŠ¡è°ƒåº¦ä¸¤éƒ¨åˆ†ç»„æˆï¼Œç±»å±‚æ¬¡å›¾å¦‚ä¸‹ã€‚</p>\n<p><img src=\"http://img.blog.csdn.net/20160720172854109\" alt=\"image\"></p>\n<ul>\n<li><strong>ForkJoinPool</strong></li>\n</ul>\n<p>ForkJoinPoolæ˜¯ForkJoinæ¡†æ¶ä¸­çš„ä»»åŠ¡è°ƒåº¦å™¨ï¼Œå’ŒThreadPoolExecutorä¸€æ ·å®ç°äº†è‡ªå·±çš„çº¿ç¨‹æ± ï¼Œæä¾›äº†ä¸‰ç§è°ƒåº¦å­ä»»åŠ¡çš„æ–¹æ³•ï¼š</p>\n<ol>\n<li>executeï¼šå¼‚æ­¥æ‰§è¡ŒæŒ‡å®šä»»åŠ¡ï¼Œæ— è¿”å›ç»“æœï¼›</li>\n<li>invokeã€invokeAllï¼šå¼‚æ­¥æ‰§è¡ŒæŒ‡å®šä»»åŠ¡ï¼Œç­‰å¾…å®Œæˆæ‰è¿”å›ç»“æœï¼›</li>\n<li>submitï¼šå¼‚æ­¥æ‰§è¡ŒæŒ‡å®šä»»åŠ¡ï¼Œå¹¶ç«‹å³è¿”å›ä¸€ä¸ªFutureå¯¹è±¡ï¼›</li>\n</ol>\n<ul>\n<li><strong>ForkJoinTask</strong></li>\n</ul>\n<p>Fork&#x2F;Joinæ¡†æ¶ä¸­çš„å®é™…çš„æ‰§è¡Œä»»åŠ¡ç±»ï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§å®ç°ï¼Œä¸€èˆ¬ç»§æ‰¿è¿™ä¸¤ç§å®ç°ç±»å³å¯ã€‚</p>\n<ol>\n<li>RecursiveActionï¼šç”¨äºæ— ç»“æœè¿”å›çš„å­ä»»åŠ¡ï¼›</li>\n<li>RecursiveTaskï¼šç”¨äºæœ‰ç»“æœè¿”å›çš„å­ä»»åŠ¡ï¼›</li>\n</ol>\n<h4 id=\"Fork-Joinæ¡†æ¶å®æˆ˜\"><a href=\"#Fork-Joinæ¡†æ¶å®æˆ˜\" class=\"headerlink\" title=\"Fork&#x2F;Joinæ¡†æ¶å®æˆ˜\"></a>Fork&#x2F;Joinæ¡†æ¶å®æˆ˜</h4><p>ä¸‹é¢å®ç°ä¸€ä¸ªFork&#x2F;Joinå°ä¾‹å­ï¼Œä»1+2+â€¦10äº¿ï¼Œæ¯ä¸ªä»»åŠ¡åªèƒ½å¤„ç†1000ä¸ªæ•°ç›¸åŠ ï¼Œè¶…è¿‡1000ä¸ªçš„è‡ªåŠ¨åˆ†è§£æˆå°ä»»åŠ¡å¹¶è¡Œå¤„ç†ï¼›å¹¶å±•ç¤ºäº†é€šè¿‡ä¸ä½¿ç”¨Fork&#x2F;Joinå’Œä½¿ç”¨æ—¶çš„æ—¶é—´æŸè€—å¯¹æ¯”ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">import java.util.concurrent.ForkJoinPool;\nimport java.util.concurrent.RecursiveTask;\n\npublic class ForkJoinTask extends RecursiveTask&lt;Long&gt; &#123;\n\n\tprivate static final long MAX &#x3D; 1000000000L;\n\tprivate static final long THRESHOLD &#x3D; 1000L;\n\tprivate long start;\n\tprivate long end;\n\n\tpublic ForkJoinTask(long start, long end) &#123;\n\t\tthis.start &#x3D; start;\n\t\tthis.end &#x3D; end;\n\t&#125;\n\n\tpublic static void main(String[] args) &#123;\n\t\ttest();\n\t\tSystem.out.println(&quot;--------------------&quot;);\n\t\ttestForkJoin();\n\t&#125;\n\n\tprivate static void test() &#123;\n\t\tSystem.out.println(&quot;test&quot;);\n\t\tlong start &#x3D; System.currentTimeMillis();\n\t\tLong sum &#x3D; 0L;\n\t\tfor (long i &#x3D; 0L; i &lt;&#x3D; MAX; i++) &#123;\n\t\t\tsum +&#x3D; i;\n\t\t&#125;\n\t\tSystem.out.println(sum);\n\t\tSystem.out.println(System.currentTimeMillis() - start + &quot;ms&quot;);\n\t&#125;\n\n\tprivate static void testForkJoin() &#123;\n\t\tSystem.out.println(&quot;testForkJoin&quot;);\n\t\tlong start &#x3D; System.currentTimeMillis();\n\t\tForkJoinPool forkJoinPool &#x3D; new ForkJoinPool();\n\t\tLong sum &#x3D; forkJoinPool.invoke(new ForkJoinTask(1, MAX));\n\t\tSystem.out.println(sum);\n\t\tSystem.out.println(System.currentTimeMillis() - start + &quot;ms&quot;);\n\t&#125;\n\n\t@Override\n\tprotected Long compute() &#123;\n\t\tlong sum &#x3D; 0;\n\t\tif (end - start &lt;&#x3D; THRESHOLD) &#123;\n\t\t\tfor (long i &#x3D; start; i &lt;&#x3D; end; i++) &#123;\n\t\t\t\tsum +&#x3D; i;\n\t\t\t&#125;\n\t\t\treturn sum;\n\t\t&#125; else &#123;\n\t\t\tlong mid &#x3D; (start + end) &#x2F; 2;\n\n\t\t\tForkJoinTask task1 &#x3D; new ForkJoinTask(start, mid);\n\t\t\ttask1.fork();\n\n\t\t\tForkJoinTask task2 &#x3D; new ForkJoinTask(mid + 1, end);\n\t\t\ttask2.fork();\n\n\t\t\treturn task1.join() + task2.join();\n\t\t&#125;\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™é‡Œéœ€è¦è®¡ç®—ç»“æœï¼Œæ‰€ä»¥ä»»åŠ¡ç»§æ‰¿çš„æ˜¯RecursiveTaskç±»ã€‚ForkJoinTaskéœ€è¦å®ç°computeæ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•é‡Œé¦–å…ˆéœ€è¦åˆ¤æ–­ä»»åŠ¡æ˜¯å¦å°äºç­‰äºé˜ˆå€¼1000ï¼Œå¦‚æœæ˜¯å°±ç›´æ¥æ‰§è¡Œä»»åŠ¡ã€‚å¦åˆ™åˆ†å‰²æˆä¸¤ä¸ªå­ä»»åŠ¡ï¼Œæ¯ä¸ªå­ä»»åŠ¡åœ¨è°ƒç”¨forkæ–¹æ³•æ—¶ï¼Œåˆä¼šè¿›å…¥computeæ–¹æ³•ï¼Œçœ‹çœ‹å½“å‰å­ä»»åŠ¡æ˜¯å¦éœ€è¦ç»§ç»­åˆ†å‰²æˆå­™ä»»åŠ¡ï¼Œå¦‚æœä¸éœ€è¦ç»§ç»­åˆ†å‰²ï¼Œåˆ™æ‰§è¡Œå½“å‰å­ä»»åŠ¡å¹¶è¿”å›ç»“æœã€‚ä½¿ç”¨joinæ–¹æ³•ä¼šé˜»å¡å¹¶ç­‰å¾…å­ä»»åŠ¡æ‰§è¡Œå®Œå¹¶å¾—åˆ°å…¶ç»“æœã€‚</p>\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">test\n500000000500000000\n4992ms\n--------------------\ntestForkJoin\n500000000500000000\n508ms<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>ä»ç»“æœçœ‹å‡ºï¼Œå¹¶è¡Œçš„æ—¶é—´æŸè€—æ˜æ˜¾è¦å°‘äºä¸²è¡Œçš„ï¼Œè¿™å°±æ˜¯å¹¶è¡Œä»»åŠ¡çš„å¥½å¤„ã€‚</p>\n<p>å°½ç®¡å¦‚æ­¤ï¼Œåœ¨ä½¿ç”¨Fork&#x2F;Joinæ—¶ä¹Ÿå¾—æ³¨æ„ï¼Œä¸è¦ç›²ç›®ä½¿ç”¨ã€‚</p>\n<ol>\n<li>å¦‚æœä»»åŠ¡æ‹†è§£çš„å¾ˆæ·±ï¼Œç³»ç»Ÿå†…çš„çº¿ç¨‹æ•°é‡å †ç§¯ï¼Œå¯¼è‡´ç³»ç»Ÿæ€§èƒ½æ€§èƒ½ä¸¥é‡ä¸‹é™ï¼›</li>\n<li>å¦‚æœå‡½æ•°çš„è°ƒç”¨æ ˆå¾ˆæ·±ï¼Œä¼šå¯¼è‡´æ ˆå†…å­˜æº¢å‡ºï¼›</li>\n</ol>\n"},{"title":"æ•™ä½ å¦‚ä½•ç›‘æ§ Java çº¿ç¨‹æ± è¿è¡ŒçŠ¶æ€","date":"2025-10-14T06:42:34.000Z","_content":"\n\n\nå¦‚æœä½ æƒ³ç›‘æ§æŸä¸€ä¸ªçº¿ç¨‹æ± çš„æ‰§è¡ŒçŠ¶æ€ï¼Œçº¿ç¨‹æ± æ‰§è¡Œç±» `ThreadPoolExecutor ` ä¹Ÿç»™å‡ºäº†ç›¸å…³çš„ API, èƒ½å®æ—¶è·å–çº¿ç¨‹æ± çš„å½“å‰æ´»åŠ¨çº¿ç¨‹æ•°ã€æ­£åœ¨æ’é˜Ÿä¸­çš„çº¿ç¨‹æ•°ã€å·²ç»æ‰§è¡Œå®Œæˆçš„çº¿ç¨‹æ•°ã€æ€»çº¿ç¨‹æ•°ç­‰ã€‚\n\n> æ€»çº¿ç¨‹æ•° = æ’é˜Ÿçº¿ç¨‹æ•° + æ´»åŠ¨çº¿ç¨‹æ•° +  æ‰§è¡Œå®Œæˆçš„çº¿ç¨‹æ•°ã€‚\n\nä¸‹é¢ç»™å‡ºä¸€ä¸ªçº¿ç¨‹æ± ä½¿ç”¨ç¤ºä¾‹ï¼ŒåŠæ•™ä½ è·å–çº¿ç¨‹æ± çŠ¶æ€ã€‚\n\n\n```\nprivate static ExecutorService es = new ThreadPoolExecutor(50, 100, 0L, TimeUnit.MILLISECONDS,\n\t\t\tnew LinkedBlockingQueue<Runnable>(100000));\n\npublic static void main(String[] args) throws Exception {\n\tfor (int i = 0; i < 100000; i++) {\n\t\tes.execute(() -> {\n\t\t\tSystem.out.print(1);\n\t\t\ttry {\n\t\t\t\tThread.sleep(1000);\n\t\t\t} catch (InterruptedException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t});\n\t}\n\n\tThreadPoolExecutor tpe = ((ThreadPoolExecutor) es);\n\n\twhile (true) {\n\t\tSystem.out.println();\n\n\t\tint queueSize = tpe.getQueue().size();\n\t\tSystem.out.println(\"å½“å‰æ’é˜Ÿçº¿ç¨‹æ•°ï¼š\" + queueSize);\n\n\t\tint activeCount = tpe.getActiveCount();\n\t\tSystem.out.println(\"å½“å‰æ´»åŠ¨çº¿ç¨‹æ•°ï¼š\" + activeCount);\n\n\t\tlong completedTaskCount = tpe.getCompletedTaskCount();\n\t\tSystem.out.println(\"æ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼š\" + completedTaskCount);\n\n\t\tlong taskCount = tpe.getTaskCount();\n\t\tSystem.out.println(\"æ€»çº¿ç¨‹æ•°ï¼š\" + taskCount);\n\n\t\tThread.sleep(3000);\n\t}\n\n}\n```\n\nçº¿ç¨‹æ± æäº¤äº† 100000 ä¸ªä»»åŠ¡ï¼Œä½†åŒæ—¶åªæœ‰ 50 ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œå·¥ä½œï¼Œæˆ‘ä»¬æ¯é™‹ 3 ç§’æ¥è·å–å½“å‰çº¿ç¨‹æ± çš„è¿è¡ŒçŠ¶æ€ã€‚\n\nç¬¬ä¸€æ¬¡ç¨‹åºè¾“å‡ºï¼š\n\n```\nå½“å‰æ’é˜Ÿçº¿ç¨‹æ•°ï¼š99950\nå½“å‰æ´»åŠ¨çº¿ç¨‹æ•°ï¼š50\næ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼š0\næ€»çº¿ç¨‹æ•°ï¼ˆæ’é˜Ÿçº¿ç¨‹æ•° + æ´»åŠ¨çº¿ç¨‹æ•° +  æ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼‰ï¼š100000\n```\n\nç¬¬äºŒæ¬¡ç¨‹åºè¾“å‡ºï¼š\n\n```\nå½“å‰æ’é˜Ÿçº¿ç¨‹æ•°ï¼š99800\nå½“å‰æ´»åŠ¨çº¿ç¨‹æ•°ï¼š50\næ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼š150\næ€»çº¿ç¨‹æ•°ï¼ˆæ’é˜Ÿçº¿ç¨‹æ•° + æ´»åŠ¨çº¿ç¨‹æ•° +  æ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼‰ï¼š100000\n```\n\næ´»åŠ¨çº¿ç¨‹æ•°å’Œæ€»çº¿ç¨‹æ•°æ˜¯ä¸å˜çš„ï¼Œæ’é˜Ÿä¸­çš„çº¿ç¨‹æ•°å’Œæ‰§è¡Œå®Œæˆçš„çº¿ç¨‹æ•°ä¸æ–­åœ¨å˜åŒ–ï¼Œç›´åˆ°æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œæœ€åè¾“å‡ºï¼š\n\n```\nå½“å‰æ’é˜Ÿçº¿ç¨‹æ•°ï¼š0\nå½“å‰æ´»åŠ¨çº¿ç¨‹æ•°ï¼š0\næ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼š100000\næ€»çº¿ç¨‹æ•°ï¼ˆæ’é˜Ÿçº¿ç¨‹æ•° + æ´»åŠ¨çº¿ç¨‹æ•° +  æ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼‰ï¼š100000\n```\n\nè¿™æ ·ï¼Œä½ äº†è§£äº†è¿™äº› API çš„ä½¿ç”¨æ–¹æ³•ï¼Œä½ æƒ³ç›‘æ§çº¿ç¨‹æ± çš„çŠ¶æ€å°±éå¸¸æ–¹ä¾¿äº†ã€‚\n\n","source":"_posts/å¤šçº¿ç¨‹/æ•™ä½ å¦‚ä½•ç›‘æ§ Java çº¿ç¨‹æ± è¿è¡ŒçŠ¶æ€.md","raw":"---\ntitle: æ•™ä½ å¦‚ä½•ç›‘æ§ Java çº¿ç¨‹æ± è¿è¡ŒçŠ¶æ€\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: å¤šçº¿ç¨‹\n---\n\n\n\nå¦‚æœä½ æƒ³ç›‘æ§æŸä¸€ä¸ªçº¿ç¨‹æ± çš„æ‰§è¡ŒçŠ¶æ€ï¼Œçº¿ç¨‹æ± æ‰§è¡Œç±» `ThreadPoolExecutor ` ä¹Ÿç»™å‡ºäº†ç›¸å…³çš„ API, èƒ½å®æ—¶è·å–çº¿ç¨‹æ± çš„å½“å‰æ´»åŠ¨çº¿ç¨‹æ•°ã€æ­£åœ¨æ’é˜Ÿä¸­çš„çº¿ç¨‹æ•°ã€å·²ç»æ‰§è¡Œå®Œæˆçš„çº¿ç¨‹æ•°ã€æ€»çº¿ç¨‹æ•°ç­‰ã€‚\n\n> æ€»çº¿ç¨‹æ•° = æ’é˜Ÿçº¿ç¨‹æ•° + æ´»åŠ¨çº¿ç¨‹æ•° +  æ‰§è¡Œå®Œæˆçš„çº¿ç¨‹æ•°ã€‚\n\nä¸‹é¢ç»™å‡ºä¸€ä¸ªçº¿ç¨‹æ± ä½¿ç”¨ç¤ºä¾‹ï¼ŒåŠæ•™ä½ è·å–çº¿ç¨‹æ± çŠ¶æ€ã€‚\n\n\n```\nprivate static ExecutorService es = new ThreadPoolExecutor(50, 100, 0L, TimeUnit.MILLISECONDS,\n\t\t\tnew LinkedBlockingQueue<Runnable>(100000));\n\npublic static void main(String[] args) throws Exception {\n\tfor (int i = 0; i < 100000; i++) {\n\t\tes.execute(() -> {\n\t\t\tSystem.out.print(1);\n\t\t\ttry {\n\t\t\t\tThread.sleep(1000);\n\t\t\t} catch (InterruptedException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t});\n\t}\n\n\tThreadPoolExecutor tpe = ((ThreadPoolExecutor) es);\n\n\twhile (true) {\n\t\tSystem.out.println();\n\n\t\tint queueSize = tpe.getQueue().size();\n\t\tSystem.out.println(\"å½“å‰æ’é˜Ÿçº¿ç¨‹æ•°ï¼š\" + queueSize);\n\n\t\tint activeCount = tpe.getActiveCount();\n\t\tSystem.out.println(\"å½“å‰æ´»åŠ¨çº¿ç¨‹æ•°ï¼š\" + activeCount);\n\n\t\tlong completedTaskCount = tpe.getCompletedTaskCount();\n\t\tSystem.out.println(\"æ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼š\" + completedTaskCount);\n\n\t\tlong taskCount = tpe.getTaskCount();\n\t\tSystem.out.println(\"æ€»çº¿ç¨‹æ•°ï¼š\" + taskCount);\n\n\t\tThread.sleep(3000);\n\t}\n\n}\n```\n\nçº¿ç¨‹æ± æäº¤äº† 100000 ä¸ªä»»åŠ¡ï¼Œä½†åŒæ—¶åªæœ‰ 50 ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œå·¥ä½œï¼Œæˆ‘ä»¬æ¯é™‹ 3 ç§’æ¥è·å–å½“å‰çº¿ç¨‹æ± çš„è¿è¡ŒçŠ¶æ€ã€‚\n\nç¬¬ä¸€æ¬¡ç¨‹åºè¾“å‡ºï¼š\n\n```\nå½“å‰æ’é˜Ÿçº¿ç¨‹æ•°ï¼š99950\nå½“å‰æ´»åŠ¨çº¿ç¨‹æ•°ï¼š50\næ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼š0\næ€»çº¿ç¨‹æ•°ï¼ˆæ’é˜Ÿçº¿ç¨‹æ•° + æ´»åŠ¨çº¿ç¨‹æ•° +  æ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼‰ï¼š100000\n```\n\nç¬¬äºŒæ¬¡ç¨‹åºè¾“å‡ºï¼š\n\n```\nå½“å‰æ’é˜Ÿçº¿ç¨‹æ•°ï¼š99800\nå½“å‰æ´»åŠ¨çº¿ç¨‹æ•°ï¼š50\næ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼š150\næ€»çº¿ç¨‹æ•°ï¼ˆæ’é˜Ÿçº¿ç¨‹æ•° + æ´»åŠ¨çº¿ç¨‹æ•° +  æ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼‰ï¼š100000\n```\n\næ´»åŠ¨çº¿ç¨‹æ•°å’Œæ€»çº¿ç¨‹æ•°æ˜¯ä¸å˜çš„ï¼Œæ’é˜Ÿä¸­çš„çº¿ç¨‹æ•°å’Œæ‰§è¡Œå®Œæˆçš„çº¿ç¨‹æ•°ä¸æ–­åœ¨å˜åŒ–ï¼Œç›´åˆ°æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œæœ€åè¾“å‡ºï¼š\n\n```\nå½“å‰æ’é˜Ÿçº¿ç¨‹æ•°ï¼š0\nå½“å‰æ´»åŠ¨çº¿ç¨‹æ•°ï¼š0\næ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼š100000\næ€»çº¿ç¨‹æ•°ï¼ˆæ’é˜Ÿçº¿ç¨‹æ•° + æ´»åŠ¨çº¿ç¨‹æ•° +  æ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼‰ï¼š100000\n```\n\nè¿™æ ·ï¼Œä½ äº†è§£äº†è¿™äº› API çš„ä½¿ç”¨æ–¹æ³•ï¼Œä½ æƒ³ç›‘æ§çº¿ç¨‹æ± çš„çŠ¶æ€å°±éå¸¸æ–¹ä¾¿äº†ã€‚\n\n","slug":"å¤šçº¿ç¨‹/æ•™ä½ å¦‚ä½•ç›‘æ§ Java çº¿ç¨‹æ± è¿è¡ŒçŠ¶æ€","published":1,"updated":"2025-10-15T07:20:24.986Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076r002xqkd40why35oe","content":"<p>å¦‚æœä½ æƒ³ç›‘æ§æŸä¸€ä¸ªçº¿ç¨‹æ± çš„æ‰§è¡ŒçŠ¶æ€ï¼Œçº¿ç¨‹æ± æ‰§è¡Œç±» <code>ThreadPoolExecutor </code> ä¹Ÿç»™å‡ºäº†ç›¸å…³çš„ API, èƒ½å®æ—¶è·å–çº¿ç¨‹æ± çš„å½“å‰æ´»åŠ¨çº¿ç¨‹æ•°ã€æ­£åœ¨æ’é˜Ÿä¸­çš„çº¿ç¨‹æ•°ã€å·²ç»æ‰§è¡Œå®Œæˆçš„çº¿ç¨‹æ•°ã€æ€»çº¿ç¨‹æ•°ç­‰ã€‚</p>\n<blockquote>\n<p>æ€»çº¿ç¨‹æ•° &#x3D; æ’é˜Ÿçº¿ç¨‹æ•° + æ´»åŠ¨çº¿ç¨‹æ•° +  æ‰§è¡Œå®Œæˆçš„çº¿ç¨‹æ•°ã€‚</p>\n</blockquote>\n<p>ä¸‹é¢ç»™å‡ºä¸€ä¸ªçº¿ç¨‹æ± ä½¿ç”¨ç¤ºä¾‹ï¼ŒåŠæ•™ä½ è·å–çº¿ç¨‹æ± çŠ¶æ€ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static ExecutorService es &#x3D; new ThreadPoolExecutor(50, 100, 0L, TimeUnit.MILLISECONDS,\n\t\t\tnew LinkedBlockingQueue&lt;Runnable&gt;(100000));\n\npublic static void main(String[] args) throws Exception &#123;\n\tfor (int i &#x3D; 0; i &lt; 100000; i++) &#123;\n\t\tes.execute(() -&gt; &#123;\n\t\t\tSystem.out.print(1);\n\t\t\ttry &#123;\n\t\t\t\tThread.sleep(1000);\n\t\t\t&#125; catch (InterruptedException e) &#123;\n\t\t\t\te.printStackTrace();\n\t\t\t&#125;\n\t\t&#125;);\n\t&#125;\n\n\tThreadPoolExecutor tpe &#x3D; ((ThreadPoolExecutor) es);\n\n\twhile (true) &#123;\n\t\tSystem.out.println();\n\n\t\tint queueSize &#x3D; tpe.getQueue().size();\n\t\tSystem.out.println(&quot;å½“å‰æ’é˜Ÿçº¿ç¨‹æ•°ï¼š&quot; + queueSize);\n\n\t\tint activeCount &#x3D; tpe.getActiveCount();\n\t\tSystem.out.println(&quot;å½“å‰æ´»åŠ¨çº¿ç¨‹æ•°ï¼š&quot; + activeCount);\n\n\t\tlong completedTaskCount &#x3D; tpe.getCompletedTaskCount();\n\t\tSystem.out.println(&quot;æ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼š&quot; + completedTaskCount);\n\n\t\tlong taskCount &#x3D; tpe.getTaskCount();\n\t\tSystem.out.println(&quot;æ€»çº¿ç¨‹æ•°ï¼š&quot; + taskCount);\n\n\t\tThread.sleep(3000);\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>çº¿ç¨‹æ± æäº¤äº† 100000 ä¸ªä»»åŠ¡ï¼Œä½†åŒæ—¶åªæœ‰ 50 ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œå·¥ä½œï¼Œæˆ‘ä»¬æ¯é™‹ 3 ç§’æ¥è·å–å½“å‰çº¿ç¨‹æ± çš„è¿è¡ŒçŠ¶æ€ã€‚</p>\n<p>ç¬¬ä¸€æ¬¡ç¨‹åºè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">å½“å‰æ’é˜Ÿçº¿ç¨‹æ•°ï¼š99950\nå½“å‰æ´»åŠ¨çº¿ç¨‹æ•°ï¼š50\næ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼š0\næ€»çº¿ç¨‹æ•°ï¼ˆæ’é˜Ÿçº¿ç¨‹æ•° + æ´»åŠ¨çº¿ç¨‹æ•° +  æ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼‰ï¼š100000<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¬¬äºŒæ¬¡ç¨‹åºè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">å½“å‰æ’é˜Ÿçº¿ç¨‹æ•°ï¼š99800\nå½“å‰æ´»åŠ¨çº¿ç¨‹æ•°ï¼š50\næ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼š150\næ€»çº¿ç¨‹æ•°ï¼ˆæ’é˜Ÿçº¿ç¨‹æ•° + æ´»åŠ¨çº¿ç¨‹æ•° +  æ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼‰ï¼š100000<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ´»åŠ¨çº¿ç¨‹æ•°å’Œæ€»çº¿ç¨‹æ•°æ˜¯ä¸å˜çš„ï¼Œæ’é˜Ÿä¸­çš„çº¿ç¨‹æ•°å’Œæ‰§è¡Œå®Œæˆçš„çº¿ç¨‹æ•°ä¸æ–­åœ¨å˜åŒ–ï¼Œç›´åˆ°æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œæœ€åè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">å½“å‰æ’é˜Ÿçº¿ç¨‹æ•°ï¼š0\nå½“å‰æ´»åŠ¨çº¿ç¨‹æ•°ï¼š0\næ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼š100000\næ€»çº¿ç¨‹æ•°ï¼ˆæ’é˜Ÿçº¿ç¨‹æ•° + æ´»åŠ¨çº¿ç¨‹æ•° +  æ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼‰ï¼š100000<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™æ ·ï¼Œä½ äº†è§£äº†è¿™äº› API çš„ä½¿ç”¨æ–¹æ³•ï¼Œä½ æƒ³ç›‘æ§çº¿ç¨‹æ± çš„çŠ¶æ€å°±éå¸¸æ–¹ä¾¿äº†ã€‚</p>\n","excerpt":"","more":"<p>å¦‚æœä½ æƒ³ç›‘æ§æŸä¸€ä¸ªçº¿ç¨‹æ± çš„æ‰§è¡ŒçŠ¶æ€ï¼Œçº¿ç¨‹æ± æ‰§è¡Œç±» <code>ThreadPoolExecutor </code> ä¹Ÿç»™å‡ºäº†ç›¸å…³çš„ API, èƒ½å®æ—¶è·å–çº¿ç¨‹æ± çš„å½“å‰æ´»åŠ¨çº¿ç¨‹æ•°ã€æ­£åœ¨æ’é˜Ÿä¸­çš„çº¿ç¨‹æ•°ã€å·²ç»æ‰§è¡Œå®Œæˆçš„çº¿ç¨‹æ•°ã€æ€»çº¿ç¨‹æ•°ç­‰ã€‚</p>\n<blockquote>\n<p>æ€»çº¿ç¨‹æ•° &#x3D; æ’é˜Ÿçº¿ç¨‹æ•° + æ´»åŠ¨çº¿ç¨‹æ•° +  æ‰§è¡Œå®Œæˆçš„çº¿ç¨‹æ•°ã€‚</p>\n</blockquote>\n<p>ä¸‹é¢ç»™å‡ºä¸€ä¸ªçº¿ç¨‹æ± ä½¿ç”¨ç¤ºä¾‹ï¼ŒåŠæ•™ä½ è·å–çº¿ç¨‹æ± çŠ¶æ€ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static ExecutorService es &#x3D; new ThreadPoolExecutor(50, 100, 0L, TimeUnit.MILLISECONDS,\n\t\t\tnew LinkedBlockingQueue&lt;Runnable&gt;(100000));\n\npublic static void main(String[] args) throws Exception &#123;\n\tfor (int i &#x3D; 0; i &lt; 100000; i++) &#123;\n\t\tes.execute(() -&gt; &#123;\n\t\t\tSystem.out.print(1);\n\t\t\ttry &#123;\n\t\t\t\tThread.sleep(1000);\n\t\t\t&#125; catch (InterruptedException e) &#123;\n\t\t\t\te.printStackTrace();\n\t\t\t&#125;\n\t\t&#125;);\n\t&#125;\n\n\tThreadPoolExecutor tpe &#x3D; ((ThreadPoolExecutor) es);\n\n\twhile (true) &#123;\n\t\tSystem.out.println();\n\n\t\tint queueSize &#x3D; tpe.getQueue().size();\n\t\tSystem.out.println(&quot;å½“å‰æ’é˜Ÿçº¿ç¨‹æ•°ï¼š&quot; + queueSize);\n\n\t\tint activeCount &#x3D; tpe.getActiveCount();\n\t\tSystem.out.println(&quot;å½“å‰æ´»åŠ¨çº¿ç¨‹æ•°ï¼š&quot; + activeCount);\n\n\t\tlong completedTaskCount &#x3D; tpe.getCompletedTaskCount();\n\t\tSystem.out.println(&quot;æ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼š&quot; + completedTaskCount);\n\n\t\tlong taskCount &#x3D; tpe.getTaskCount();\n\t\tSystem.out.println(&quot;æ€»çº¿ç¨‹æ•°ï¼š&quot; + taskCount);\n\n\t\tThread.sleep(3000);\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>çº¿ç¨‹æ± æäº¤äº† 100000 ä¸ªä»»åŠ¡ï¼Œä½†åŒæ—¶åªæœ‰ 50 ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œå·¥ä½œï¼Œæˆ‘ä»¬æ¯é™‹ 3 ç§’æ¥è·å–å½“å‰çº¿ç¨‹æ± çš„è¿è¡ŒçŠ¶æ€ã€‚</p>\n<p>ç¬¬ä¸€æ¬¡ç¨‹åºè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">å½“å‰æ’é˜Ÿçº¿ç¨‹æ•°ï¼š99950\nå½“å‰æ´»åŠ¨çº¿ç¨‹æ•°ï¼š50\næ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼š0\næ€»çº¿ç¨‹æ•°ï¼ˆæ’é˜Ÿçº¿ç¨‹æ•° + æ´»åŠ¨çº¿ç¨‹æ•° +  æ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼‰ï¼š100000<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¬¬äºŒæ¬¡ç¨‹åºè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">å½“å‰æ’é˜Ÿçº¿ç¨‹æ•°ï¼š99800\nå½“å‰æ´»åŠ¨çº¿ç¨‹æ•°ï¼š50\næ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼š150\næ€»çº¿ç¨‹æ•°ï¼ˆæ’é˜Ÿçº¿ç¨‹æ•° + æ´»åŠ¨çº¿ç¨‹æ•° +  æ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼‰ï¼š100000<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ´»åŠ¨çº¿ç¨‹æ•°å’Œæ€»çº¿ç¨‹æ•°æ˜¯ä¸å˜çš„ï¼Œæ’é˜Ÿä¸­çš„çº¿ç¨‹æ•°å’Œæ‰§è¡Œå®Œæˆçš„çº¿ç¨‹æ•°ä¸æ–­åœ¨å˜åŒ–ï¼Œç›´åˆ°æ‰€æœ‰ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œæœ€åè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">å½“å‰æ’é˜Ÿçº¿ç¨‹æ•°ï¼š0\nå½“å‰æ´»åŠ¨çº¿ç¨‹æ•°ï¼š0\næ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼š100000\næ€»çº¿ç¨‹æ•°ï¼ˆæ’é˜Ÿçº¿ç¨‹æ•° + æ´»åŠ¨çº¿ç¨‹æ•° +  æ‰§è¡Œå®Œæˆçº¿ç¨‹æ•°ï¼‰ï¼š100000<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™æ ·ï¼Œä½ äº†è§£äº†è¿™äº› API çš„ä½¿ç”¨æ–¹æ³•ï¼Œä½ æƒ³ç›‘æ§çº¿ç¨‹æ± çš„çŠ¶æ€å°±éå¸¸æ–¹ä¾¿äº†ã€‚</p>\n"},{"title":"çº¿ç¨‹ä¼‘çœ åªä¼šç”¨Thread.sleepï¼Ÿé‚£å°±å¼±çˆ†äº†ï¼","date":"2025-10-14T06:42:34.000Z","_content":"\nçº¿ç¨‹ä¼‘çœ æ˜¯ Java å¼€å‘ç»å¸¸ä¼šç”¨åˆ°çš„ä¸€ä¸ªæ‰‹æ®µï¼Œå°±æ˜¯è®©å½“å‰çº¿ç¨‹ç¡ä¸€ä¼šå„¿ï¼Œç¡é†’ä¹‹åå†ç»§ç»­è¿è¡Œã€‚\n\nå’±å¤§å¤šæ•°ç¨‹åºå‘˜ï¼Œå¤šçº¿ç¨‹è™½ç„¶å­¦å¾—ä¸å¥½ï¼Œä½†çº¿ç¨‹ä¼‘çœ ï¼Œæ— äººä¸çŸ¥ï¼Œæ— äººä¸æ™“ï¼Œä¹Ÿéƒ½ä¼šç”¨ï¼Œä¸å°±æ˜¯ç”¨ Thread.sleep æ–¹æ³•å˜›ï¼è€Œä¸”è¿˜å°†å®ƒç”¨åˆ°é‚£ä¹ˆç»ï¼Œä¹‹å‰ä¸æ˜¯è¿˜æœ‰äººå†™è¿‡ä¼‘çœ æ’åºç®—æ³•å’Œä¼‘çœ å–æ—¶é—´çš„ç®—æ³•ï¼Œå†æ¥å›å‘³ä¸‹è¿™ä¹ˆè„‘æ´å¤§å¼€çš„ä¸¤ä¸ªç®—æ³•ï¼š\n\n- [ä¼‘çœ æ’åºç®—æ³•](https://mp.weixin.qq.com/s/Or3q3souk1GGVNB2qvEY2Q)\n- [ä¼‘çœ å–æ—¶é—´ç®—æ³•](https://mp.weixin.qq.com/s/Or3q3souk1GGVNB2qvEY2Q)\n\nç¬‘è¿‡ä¹‹åï¼Œå½“ç„¶ï¼Œè¿™ä¸æ˜¯å’‹ä»Šå¤©è¦è®²çš„ä¸»é¢˜ï¼Œæ ˆé•¿ä»Šå¤©è¦è®²çš„æ˜¯å¦‚ä½•æ›´ä¼˜é›…çš„è®©çº¿ç¨‹ä¼‘çœ ã€‚\n\n**æ¥çœ‹ä¸‹é¢çš„ä¼‘çœ ç¨‹åºï¼š**\n\n```\nThread.sleep(87000000);\n```\n\nä½ çŸ¥é“ä¼‘çœ å¤šä¹…å—ï¼Ÿ\n\né†‰äº†â€¦â€¦\n\n**å†æŠŠä¸Šé¢çš„ç¨å¾®æ”¹è£…ä¸‹ï¼š**\n\n```\nThread.sleep(24 * 60 * 60 * 1000 + 10 * 60 * 1000);\n```\n\nç°åœ¨ä½ ä¼°è®¡å¤§æ¦‚èƒ½çŸ¥é“ä¼‘çœ å¤šä¹…äº†ï¼Œä½†è¿˜æ˜¯å¾ˆèŒ«ç„¶ï¼Œå¾ˆæ— åŠ©ï¼Œä¸å†™æ³¨é‡Šï¼Œè°çŸ¥é“ä¼‘çœ å¤šä¹…ï¼Ÿå•ä½è¿˜æ˜¯æ¯«ç§’ã€‚ã€‚\n\nå…¶å®å°±æ˜¯ä¼‘çœ  24 å°æ—¶ 10 åˆ†é’Ÿï¼Œä½•å¿…æ•´è¿™ä¹ˆéº»çƒ¦å‘¢ï¼Ÿ\n\n**ä¼˜é›…åˆç®€å•çš„æ–¹å¼æ¥äº†ï¼š**\n\n```\nTimeUnit.DAYS.sleep(1);\nTimeUnit.MINUTES.sleep(10);\n\næˆ–è€… \n\nTimeUnit.HOURS.sleep(24);\nTimeUnit.MINUTES.sleep(10);\n```\n\nä½¿ç”¨ `java.util.concurrent.TimeUnit` ç±»å°±å¯ä»¥ä¼˜é›…çš„æå®šï¼Œä¸éœ€è¦è¿‡å¤šçš„å•ä½è¿ç®—åŠä¿®é¥°ï¼Œæ˜¯ä¸æ˜¯å¾ˆä¼˜é›…ï¼Œå¾ˆç®€å•ï¼Ÿ\n\nä¸Šé¢æ¼”ç¤ºäº† HOURSã€MINUTESï¼Œè¿˜æœ‰æ›´å¤šçš„æšä¸¾å¯ä»¥ç”¨ã€‚\n\n**æ¥çœ‹ä¸‹ TimeUnit çš„è¯¦ç»†æ–¹æ³•å’Œæšä¸¾å€¼ï¼š**\n\n![](http://img.javastack.cn/TimeUnit.png)\n\nå…¶å® TimeUnit è¿˜å¯ä»¥ç”¨æ¥åšæ—¶é—´å•ä½è½¬æ¢ï¼ŒTimeUnit æä¾›äº†å„ç§ä¸°å¯Œçš„æ—¶é—´å•ä½è½¬æ¢æ–¹æ³•ã€‚\n\næˆ‘ä»¬éšä¾¿æ¥çœ‹ä¸€ä¸ªæšä¸¾å€¼ï¼š\n\n```\nMINUTES {\n    public long toNanos(long d)   { return x(d, C4/C0, MAX/(C4/C0)); }\n    public long toMicros(long d)  { return x(d, C4/C1, MAX/(C4/C1)); }\n    public long toMillis(long d)  { return x(d, C4/C2, MAX/(C4/C2)); }\n    public long toSeconds(long d) { return x(d, C4/C3, MAX/(C4/C3)); }\n    public long toMinutes(long d) { return d; }\n    public long toHours(long d)   { return d/(C5/C4); }\n    public long toDays(long d)    { return d/(C6/C4); }\n    public long convert(long d, TimeUnit u) { return u.toMinutes(d); }\n    int excessNanos(long d, long m) { return 0; }\n}\n```\n\nå¯ä»¥å¾ˆæ–¹ä¾¿çš„æŠŠåˆ†é’Ÿè½¬æ¢æˆå„ç§å•ä½çš„å€¼ã€‚\n\n**å†æ¥çœ‹ä¸€ä¸‹ TimeUnit ä¼‘çœ çš„åŸç†ï¼š**\n\n```\npublic void sleep(long timeout) throws InterruptedException {\n    if (timeout > 0) {\n        long ms = toMillis(timeout);\n        int ns = excessNanos(timeout, ms);\n        Thread.sleep(ms, ns);\n    }\n}\n```\n\nå…¶å® TimeUnit çš„ä¼‘çœ å°±æ˜¯è°ƒç”¨äº† Thread.sleep ä¼‘çœ æ–¹æ³•ï¼Œå“ˆå“ˆï¼Œåªæ˜¯æŠŠ Thread.sleep å°è£…äº†ï¼Œè¿™æ ·ï¼Œç”¨èµ·æ¥å¾ˆç®€å•æ–¹ä¾¿ï¼Œä¹Ÿæé«˜äº†å¯è¯»æ€§ã€‚\n\n\n","source":"_posts/å¤šçº¿ç¨‹/çº¿ç¨‹ä¼‘çœ åªä¼šç”¨Thread.sleepï¼Ÿé‚£å°±å¼±çˆ†äº†ï¼.md","raw":"---\ntitle: çº¿ç¨‹ä¼‘çœ åªä¼šç”¨Thread.sleepï¼Ÿé‚£å°±å¼±çˆ†äº†ï¼\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: å¤šçº¿ç¨‹\n---\n\nçº¿ç¨‹ä¼‘çœ æ˜¯ Java å¼€å‘ç»å¸¸ä¼šç”¨åˆ°çš„ä¸€ä¸ªæ‰‹æ®µï¼Œå°±æ˜¯è®©å½“å‰çº¿ç¨‹ç¡ä¸€ä¼šå„¿ï¼Œç¡é†’ä¹‹åå†ç»§ç»­è¿è¡Œã€‚\n\nå’±å¤§å¤šæ•°ç¨‹åºå‘˜ï¼Œå¤šçº¿ç¨‹è™½ç„¶å­¦å¾—ä¸å¥½ï¼Œä½†çº¿ç¨‹ä¼‘çœ ï¼Œæ— äººä¸çŸ¥ï¼Œæ— äººä¸æ™“ï¼Œä¹Ÿéƒ½ä¼šç”¨ï¼Œä¸å°±æ˜¯ç”¨ Thread.sleep æ–¹æ³•å˜›ï¼è€Œä¸”è¿˜å°†å®ƒç”¨åˆ°é‚£ä¹ˆç»ï¼Œä¹‹å‰ä¸æ˜¯è¿˜æœ‰äººå†™è¿‡ä¼‘çœ æ’åºç®—æ³•å’Œä¼‘çœ å–æ—¶é—´çš„ç®—æ³•ï¼Œå†æ¥å›å‘³ä¸‹è¿™ä¹ˆè„‘æ´å¤§å¼€çš„ä¸¤ä¸ªç®—æ³•ï¼š\n\n- [ä¼‘çœ æ’åºç®—æ³•](https://mp.weixin.qq.com/s/Or3q3souk1GGVNB2qvEY2Q)\n- [ä¼‘çœ å–æ—¶é—´ç®—æ³•](https://mp.weixin.qq.com/s/Or3q3souk1GGVNB2qvEY2Q)\n\nç¬‘è¿‡ä¹‹åï¼Œå½“ç„¶ï¼Œè¿™ä¸æ˜¯å’‹ä»Šå¤©è¦è®²çš„ä¸»é¢˜ï¼Œæ ˆé•¿ä»Šå¤©è¦è®²çš„æ˜¯å¦‚ä½•æ›´ä¼˜é›…çš„è®©çº¿ç¨‹ä¼‘çœ ã€‚\n\n**æ¥çœ‹ä¸‹é¢çš„ä¼‘çœ ç¨‹åºï¼š**\n\n```\nThread.sleep(87000000);\n```\n\nä½ çŸ¥é“ä¼‘çœ å¤šä¹…å—ï¼Ÿ\n\né†‰äº†â€¦â€¦\n\n**å†æŠŠä¸Šé¢çš„ç¨å¾®æ”¹è£…ä¸‹ï¼š**\n\n```\nThread.sleep(24 * 60 * 60 * 1000 + 10 * 60 * 1000);\n```\n\nç°åœ¨ä½ ä¼°è®¡å¤§æ¦‚èƒ½çŸ¥é“ä¼‘çœ å¤šä¹…äº†ï¼Œä½†è¿˜æ˜¯å¾ˆèŒ«ç„¶ï¼Œå¾ˆæ— åŠ©ï¼Œä¸å†™æ³¨é‡Šï¼Œè°çŸ¥é“ä¼‘çœ å¤šä¹…ï¼Ÿå•ä½è¿˜æ˜¯æ¯«ç§’ã€‚ã€‚\n\nå…¶å®å°±æ˜¯ä¼‘çœ  24 å°æ—¶ 10 åˆ†é’Ÿï¼Œä½•å¿…æ•´è¿™ä¹ˆéº»çƒ¦å‘¢ï¼Ÿ\n\n**ä¼˜é›…åˆç®€å•çš„æ–¹å¼æ¥äº†ï¼š**\n\n```\nTimeUnit.DAYS.sleep(1);\nTimeUnit.MINUTES.sleep(10);\n\næˆ–è€… \n\nTimeUnit.HOURS.sleep(24);\nTimeUnit.MINUTES.sleep(10);\n```\n\nä½¿ç”¨ `java.util.concurrent.TimeUnit` ç±»å°±å¯ä»¥ä¼˜é›…çš„æå®šï¼Œä¸éœ€è¦è¿‡å¤šçš„å•ä½è¿ç®—åŠä¿®é¥°ï¼Œæ˜¯ä¸æ˜¯å¾ˆä¼˜é›…ï¼Œå¾ˆç®€å•ï¼Ÿ\n\nä¸Šé¢æ¼”ç¤ºäº† HOURSã€MINUTESï¼Œè¿˜æœ‰æ›´å¤šçš„æšä¸¾å¯ä»¥ç”¨ã€‚\n\n**æ¥çœ‹ä¸‹ TimeUnit çš„è¯¦ç»†æ–¹æ³•å’Œæšä¸¾å€¼ï¼š**\n\n![](http://img.javastack.cn/TimeUnit.png)\n\nå…¶å® TimeUnit è¿˜å¯ä»¥ç”¨æ¥åšæ—¶é—´å•ä½è½¬æ¢ï¼ŒTimeUnit æä¾›äº†å„ç§ä¸°å¯Œçš„æ—¶é—´å•ä½è½¬æ¢æ–¹æ³•ã€‚\n\næˆ‘ä»¬éšä¾¿æ¥çœ‹ä¸€ä¸ªæšä¸¾å€¼ï¼š\n\n```\nMINUTES {\n    public long toNanos(long d)   { return x(d, C4/C0, MAX/(C4/C0)); }\n    public long toMicros(long d)  { return x(d, C4/C1, MAX/(C4/C1)); }\n    public long toMillis(long d)  { return x(d, C4/C2, MAX/(C4/C2)); }\n    public long toSeconds(long d) { return x(d, C4/C3, MAX/(C4/C3)); }\n    public long toMinutes(long d) { return d; }\n    public long toHours(long d)   { return d/(C5/C4); }\n    public long toDays(long d)    { return d/(C6/C4); }\n    public long convert(long d, TimeUnit u) { return u.toMinutes(d); }\n    int excessNanos(long d, long m) { return 0; }\n}\n```\n\nå¯ä»¥å¾ˆæ–¹ä¾¿çš„æŠŠåˆ†é’Ÿè½¬æ¢æˆå„ç§å•ä½çš„å€¼ã€‚\n\n**å†æ¥çœ‹ä¸€ä¸‹ TimeUnit ä¼‘çœ çš„åŸç†ï¼š**\n\n```\npublic void sleep(long timeout) throws InterruptedException {\n    if (timeout > 0) {\n        long ms = toMillis(timeout);\n        int ns = excessNanos(timeout, ms);\n        Thread.sleep(ms, ns);\n    }\n}\n```\n\nå…¶å® TimeUnit çš„ä¼‘çœ å°±æ˜¯è°ƒç”¨äº† Thread.sleep ä¼‘çœ æ–¹æ³•ï¼Œå“ˆå“ˆï¼Œåªæ˜¯æŠŠ Thread.sleep å°è£…äº†ï¼Œè¿™æ ·ï¼Œç”¨èµ·æ¥å¾ˆç®€å•æ–¹ä¾¿ï¼Œä¹Ÿæé«˜äº†å¯è¯»æ€§ã€‚\n\n\n","slug":"å¤šçº¿ç¨‹/çº¿ç¨‹ä¼‘çœ åªä¼šç”¨Thread.sleepï¼Ÿé‚£å°±å¼±çˆ†äº†ï¼","published":1,"updated":"2025-10-15T07:20:25.009Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076s0030qkd4f7mb7dqg","content":"<p>çº¿ç¨‹ä¼‘çœ æ˜¯ Java å¼€å‘ç»å¸¸ä¼šç”¨åˆ°çš„ä¸€ä¸ªæ‰‹æ®µï¼Œå°±æ˜¯è®©å½“å‰çº¿ç¨‹ç¡ä¸€ä¼šå„¿ï¼Œç¡é†’ä¹‹åå†ç»§ç»­è¿è¡Œã€‚</p>\n<p>å’±å¤§å¤šæ•°ç¨‹åºå‘˜ï¼Œå¤šçº¿ç¨‹è™½ç„¶å­¦å¾—ä¸å¥½ï¼Œä½†çº¿ç¨‹ä¼‘çœ ï¼Œæ— äººä¸çŸ¥ï¼Œæ— äººä¸æ™“ï¼Œä¹Ÿéƒ½ä¼šç”¨ï¼Œä¸å°±æ˜¯ç”¨ Thread.sleep æ–¹æ³•å˜›ï¼è€Œä¸”è¿˜å°†å®ƒç”¨åˆ°é‚£ä¹ˆç»ï¼Œä¹‹å‰ä¸æ˜¯è¿˜æœ‰äººå†™è¿‡ä¼‘çœ æ’åºç®—æ³•å’Œä¼‘çœ å–æ—¶é—´çš„ç®—æ³•ï¼Œå†æ¥å›å‘³ä¸‹è¿™ä¹ˆè„‘æ´å¤§å¼€çš„ä¸¤ä¸ªç®—æ³•ï¼š</p>\n<ul>\n<li><a href=\"https://mp.weixin.qq.com/s/Or3q3souk1GGVNB2qvEY2Q\">ä¼‘çœ æ’åºç®—æ³•</a></li>\n<li><a href=\"https://mp.weixin.qq.com/s/Or3q3souk1GGVNB2qvEY2Q\">ä¼‘çœ å–æ—¶é—´ç®—æ³•</a></li>\n</ul>\n<p>ç¬‘è¿‡ä¹‹åï¼Œå½“ç„¶ï¼Œè¿™ä¸æ˜¯å’‹ä»Šå¤©è¦è®²çš„ä¸»é¢˜ï¼Œæ ˆé•¿ä»Šå¤©è¦è®²çš„æ˜¯å¦‚ä½•æ›´ä¼˜é›…çš„è®©çº¿ç¨‹ä¼‘çœ ã€‚</p>\n<p><strong>æ¥çœ‹ä¸‹é¢çš„ä¼‘çœ ç¨‹åºï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Thread.sleep(87000000);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>ä½ çŸ¥é“ä¼‘çœ å¤šä¹…å—ï¼Ÿ</p>\n<p>é†‰äº†â€¦â€¦</p>\n<p><strong>å†æŠŠä¸Šé¢çš„ç¨å¾®æ”¹è£…ä¸‹ï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Thread.sleep(24 * 60 * 60 * 1000 + 10 * 60 * 1000);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>ç°åœ¨ä½ ä¼°è®¡å¤§æ¦‚èƒ½çŸ¥é“ä¼‘çœ å¤šä¹…äº†ï¼Œä½†è¿˜æ˜¯å¾ˆèŒ«ç„¶ï¼Œå¾ˆæ— åŠ©ï¼Œä¸å†™æ³¨é‡Šï¼Œè°çŸ¥é“ä¼‘çœ å¤šä¹…ï¼Ÿå•ä½è¿˜æ˜¯æ¯«ç§’ã€‚ã€‚</p>\n<p>å…¶å®å°±æ˜¯ä¼‘çœ  24 å°æ—¶ 10 åˆ†é’Ÿï¼Œä½•å¿…æ•´è¿™ä¹ˆéº»çƒ¦å‘¢ï¼Ÿ</p>\n<p><strong>ä¼˜é›…åˆç®€å•çš„æ–¹å¼æ¥äº†ï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">TimeUnit.DAYS.sleep(1);\nTimeUnit.MINUTES.sleep(10);\n\næˆ–è€… \n\nTimeUnit.HOURS.sleep(24);\nTimeUnit.MINUTES.sleep(10);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä½¿ç”¨ <code>java.util.concurrent.TimeUnit</code> ç±»å°±å¯ä»¥ä¼˜é›…çš„æå®šï¼Œä¸éœ€è¦è¿‡å¤šçš„å•ä½è¿ç®—åŠä¿®é¥°ï¼Œæ˜¯ä¸æ˜¯å¾ˆä¼˜é›…ï¼Œå¾ˆç®€å•ï¼Ÿ</p>\n<p>ä¸Šé¢æ¼”ç¤ºäº† HOURSã€MINUTESï¼Œè¿˜æœ‰æ›´å¤šçš„æšä¸¾å¯ä»¥ç”¨ã€‚</p>\n<p><strong>æ¥çœ‹ä¸‹ TimeUnit çš„è¯¦ç»†æ–¹æ³•å’Œæšä¸¾å€¼ï¼š</strong></p>\n<p><img src=\"http://img.javastack.cn/TimeUnit.png\"></p>\n<p>å…¶å® TimeUnit è¿˜å¯ä»¥ç”¨æ¥åšæ—¶é—´å•ä½è½¬æ¢ï¼ŒTimeUnit æä¾›äº†å„ç§ä¸°å¯Œçš„æ—¶é—´å•ä½è½¬æ¢æ–¹æ³•ã€‚</p>\n<p>æˆ‘ä»¬éšä¾¿æ¥çœ‹ä¸€ä¸ªæšä¸¾å€¼ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">MINUTES &#123;\n    public long toNanos(long d)   &#123; return x(d, C4&#x2F;C0, MAX&#x2F;(C4&#x2F;C0)); &#125;\n    public long toMicros(long d)  &#123; return x(d, C4&#x2F;C1, MAX&#x2F;(C4&#x2F;C1)); &#125;\n    public long toMillis(long d)  &#123; return x(d, C4&#x2F;C2, MAX&#x2F;(C4&#x2F;C2)); &#125;\n    public long toSeconds(long d) &#123; return x(d, C4&#x2F;C3, MAX&#x2F;(C4&#x2F;C3)); &#125;\n    public long toMinutes(long d) &#123; return d; &#125;\n    public long toHours(long d)   &#123; return d&#x2F;(C5&#x2F;C4); &#125;\n    public long toDays(long d)    &#123; return d&#x2F;(C6&#x2F;C4); &#125;\n    public long convert(long d, TimeUnit u) &#123; return u.toMinutes(d); &#125;\n    int excessNanos(long d, long m) &#123; return 0; &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥å¾ˆæ–¹ä¾¿çš„æŠŠåˆ†é’Ÿè½¬æ¢æˆå„ç§å•ä½çš„å€¼ã€‚</p>\n<p><strong>å†æ¥çœ‹ä¸€ä¸‹ TimeUnit ä¼‘çœ çš„åŸç†ï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public void sleep(long timeout) throws InterruptedException &#123;\n    if (timeout &gt; 0) &#123;\n        long ms &#x3D; toMillis(timeout);\n        int ns &#x3D; excessNanos(timeout, ms);\n        Thread.sleep(ms, ns);\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å…¶å® TimeUnit çš„ä¼‘çœ å°±æ˜¯è°ƒç”¨äº† Thread.sleep ä¼‘çœ æ–¹æ³•ï¼Œå“ˆå“ˆï¼Œåªæ˜¯æŠŠ Thread.sleep å°è£…äº†ï¼Œè¿™æ ·ï¼Œç”¨èµ·æ¥å¾ˆç®€å•æ–¹ä¾¿ï¼Œä¹Ÿæé«˜äº†å¯è¯»æ€§ã€‚</p>\n","excerpt":"","more":"<p>çº¿ç¨‹ä¼‘çœ æ˜¯ Java å¼€å‘ç»å¸¸ä¼šç”¨åˆ°çš„ä¸€ä¸ªæ‰‹æ®µï¼Œå°±æ˜¯è®©å½“å‰çº¿ç¨‹ç¡ä¸€ä¼šå„¿ï¼Œç¡é†’ä¹‹åå†ç»§ç»­è¿è¡Œã€‚</p>\n<p>å’±å¤§å¤šæ•°ç¨‹åºå‘˜ï¼Œå¤šçº¿ç¨‹è™½ç„¶å­¦å¾—ä¸å¥½ï¼Œä½†çº¿ç¨‹ä¼‘çœ ï¼Œæ— äººä¸çŸ¥ï¼Œæ— äººä¸æ™“ï¼Œä¹Ÿéƒ½ä¼šç”¨ï¼Œä¸å°±æ˜¯ç”¨ Thread.sleep æ–¹æ³•å˜›ï¼è€Œä¸”è¿˜å°†å®ƒç”¨åˆ°é‚£ä¹ˆç»ï¼Œä¹‹å‰ä¸æ˜¯è¿˜æœ‰äººå†™è¿‡ä¼‘çœ æ’åºç®—æ³•å’Œä¼‘çœ å–æ—¶é—´çš„ç®—æ³•ï¼Œå†æ¥å›å‘³ä¸‹è¿™ä¹ˆè„‘æ´å¤§å¼€çš„ä¸¤ä¸ªç®—æ³•ï¼š</p>\n<ul>\n<li><a href=\"https://mp.weixin.qq.com/s/Or3q3souk1GGVNB2qvEY2Q\">ä¼‘çœ æ’åºç®—æ³•</a></li>\n<li><a href=\"https://mp.weixin.qq.com/s/Or3q3souk1GGVNB2qvEY2Q\">ä¼‘çœ å–æ—¶é—´ç®—æ³•</a></li>\n</ul>\n<p>ç¬‘è¿‡ä¹‹åï¼Œå½“ç„¶ï¼Œè¿™ä¸æ˜¯å’‹ä»Šå¤©è¦è®²çš„ä¸»é¢˜ï¼Œæ ˆé•¿ä»Šå¤©è¦è®²çš„æ˜¯å¦‚ä½•æ›´ä¼˜é›…çš„è®©çº¿ç¨‹ä¼‘çœ ã€‚</p>\n<p><strong>æ¥çœ‹ä¸‹é¢çš„ä¼‘çœ ç¨‹åºï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Thread.sleep(87000000);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>ä½ çŸ¥é“ä¼‘çœ å¤šä¹…å—ï¼Ÿ</p>\n<p>é†‰äº†â€¦â€¦</p>\n<p><strong>å†æŠŠä¸Šé¢çš„ç¨å¾®æ”¹è£…ä¸‹ï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Thread.sleep(24 * 60 * 60 * 1000 + 10 * 60 * 1000);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>ç°åœ¨ä½ ä¼°è®¡å¤§æ¦‚èƒ½çŸ¥é“ä¼‘çœ å¤šä¹…äº†ï¼Œä½†è¿˜æ˜¯å¾ˆèŒ«ç„¶ï¼Œå¾ˆæ— åŠ©ï¼Œä¸å†™æ³¨é‡Šï¼Œè°çŸ¥é“ä¼‘çœ å¤šä¹…ï¼Ÿå•ä½è¿˜æ˜¯æ¯«ç§’ã€‚ã€‚</p>\n<p>å…¶å®å°±æ˜¯ä¼‘çœ  24 å°æ—¶ 10 åˆ†é’Ÿï¼Œä½•å¿…æ•´è¿™ä¹ˆéº»çƒ¦å‘¢ï¼Ÿ</p>\n<p><strong>ä¼˜é›…åˆç®€å•çš„æ–¹å¼æ¥äº†ï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">TimeUnit.DAYS.sleep(1);\nTimeUnit.MINUTES.sleep(10);\n\næˆ–è€… \n\nTimeUnit.HOURS.sleep(24);\nTimeUnit.MINUTES.sleep(10);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä½¿ç”¨ <code>java.util.concurrent.TimeUnit</code> ç±»å°±å¯ä»¥ä¼˜é›…çš„æå®šï¼Œä¸éœ€è¦è¿‡å¤šçš„å•ä½è¿ç®—åŠä¿®é¥°ï¼Œæ˜¯ä¸æ˜¯å¾ˆä¼˜é›…ï¼Œå¾ˆç®€å•ï¼Ÿ</p>\n<p>ä¸Šé¢æ¼”ç¤ºäº† HOURSã€MINUTESï¼Œè¿˜æœ‰æ›´å¤šçš„æšä¸¾å¯ä»¥ç”¨ã€‚</p>\n<p><strong>æ¥çœ‹ä¸‹ TimeUnit çš„è¯¦ç»†æ–¹æ³•å’Œæšä¸¾å€¼ï¼š</strong></p>\n<p><img src=\"http://img.javastack.cn/TimeUnit.png\"></p>\n<p>å…¶å® TimeUnit è¿˜å¯ä»¥ç”¨æ¥åšæ—¶é—´å•ä½è½¬æ¢ï¼ŒTimeUnit æä¾›äº†å„ç§ä¸°å¯Œçš„æ—¶é—´å•ä½è½¬æ¢æ–¹æ³•ã€‚</p>\n<p>æˆ‘ä»¬éšä¾¿æ¥çœ‹ä¸€ä¸ªæšä¸¾å€¼ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">MINUTES &#123;\n    public long toNanos(long d)   &#123; return x(d, C4&#x2F;C0, MAX&#x2F;(C4&#x2F;C0)); &#125;\n    public long toMicros(long d)  &#123; return x(d, C4&#x2F;C1, MAX&#x2F;(C4&#x2F;C1)); &#125;\n    public long toMillis(long d)  &#123; return x(d, C4&#x2F;C2, MAX&#x2F;(C4&#x2F;C2)); &#125;\n    public long toSeconds(long d) &#123; return x(d, C4&#x2F;C3, MAX&#x2F;(C4&#x2F;C3)); &#125;\n    public long toMinutes(long d) &#123; return d; &#125;\n    public long toHours(long d)   &#123; return d&#x2F;(C5&#x2F;C4); &#125;\n    public long toDays(long d)    &#123; return d&#x2F;(C6&#x2F;C4); &#125;\n    public long convert(long d, TimeUnit u) &#123; return u.toMinutes(d); &#125;\n    int excessNanos(long d, long m) &#123; return 0; &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥å¾ˆæ–¹ä¾¿çš„æŠŠåˆ†é’Ÿè½¬æ¢æˆå„ç§å•ä½çš„å€¼ã€‚</p>\n<p><strong>å†æ¥çœ‹ä¸€ä¸‹ TimeUnit ä¼‘çœ çš„åŸç†ï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public void sleep(long timeout) throws InterruptedException &#123;\n    if (timeout &gt; 0) &#123;\n        long ms &#x3D; toMillis(timeout);\n        int ns &#x3D; excessNanos(timeout, ms);\n        Thread.sleep(ms, ns);\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å…¶å® TimeUnit çš„ä¼‘çœ å°±æ˜¯è°ƒç”¨äº† Thread.sleep ä¼‘çœ æ–¹æ³•ï¼Œå“ˆå“ˆï¼Œåªæ˜¯æŠŠ Thread.sleep å°è£…äº†ï¼Œè¿™æ ·ï¼Œç”¨èµ·æ¥å¾ˆç®€å•æ–¹ä¾¿ï¼Œä¹Ÿæé«˜äº†å¯è¯»æ€§ã€‚</p>\n"},{"title":"é¢è¯•å®˜é—®çº¿ç¨‹å®‰å…¨çš„Listï¼Œçœ‹å®Œå†ä¹Ÿä¸æ€•äº†ï¼","date":"2025-10-14T06:42:34.000Z","_content":"\næœ€è¿‘åœ¨JavaæŠ€æœ¯çŸ¥è¯†æ˜Ÿçƒé‡Œé¢æœ‰çƒå‹é—®åˆ°äº†çº¿ç¨‹å®‰å…¨çš„ Listï¼š\n\n![](http://img.javastack.cn/20190927184141.png)\n\næ‰«ç æŸ¥çœ‹ç­”æ¡ˆæˆ–åŠ å…¥çŸ¥è¯†æ˜Ÿçƒ\n\næ ˆé•¿åœ¨ä¹‹å‰çš„æ–‡ç« ã€Š[å‡ºåœºç‡æ¯”è¾ƒé«˜çš„ä¸€é“å¤šçº¿ç¨‹å®‰å…¨é¢è¯•é¢˜](https://mp.weixin.qq.com/s/oA-uEbzNYA4KYwLtRWXRVw)ã€‹é‡Œé¢è®²è¿‡ ArrayList çš„ä¸å®‰å…¨æ€§ã€‚\n\né‚£ä¹ˆé¢è¯•å®˜ä¼šé—®ä½ ï¼Œæ—¢ç„¶ ArrayList æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œæ€ä¹ˆä¿è¯å®ƒçš„çº¿ç¨‹å®‰å…¨æ€§å‘¢ï¼Ÿæˆ–è€…æœ‰ä»€ä¹ˆæ›¿ä»£æ–¹æ¡ˆï¼Ÿ\n\nå¾€ä¸‹çœ‹ï¼Œçœ‹æˆ‘å¦‚ä½•ç¢¾å‹ä»–ï¼\n\nå¤§éƒ¨åˆ†äººä¼šè„±å£è€Œå‡ºï¼šç”¨Vectorï¼Œè¿™æ ·åªä¼šè®©é¢è¯•å®˜é„™è§†ï¼é™¤äº†Vectorï¼Œä½ è¿˜ä¼šåˆ«çš„å—ï¼Ÿ\n\nä½ è‡³å°‘è¿˜å¾—è¯´å¾—ä¸Šè¿™ç§ï¼š\n\n> java.util.Collections.SynchronizedList\n\nå®ƒèƒ½æŠŠæ‰€æœ‰ List æ¥å£çš„å®ç°ç±»è½¬æ¢æˆçº¿ç¨‹å®‰å…¨çš„Listï¼Œæ¯” Vector æœ‰æ›´å¥½çš„æ‰©å±•æ€§å’Œå…¼å®¹æ€§ï¼ŒSynchronizedListçš„æ„é€ æ–¹æ³•å¦‚ä¸‹ï¼š\n\n```\nfinal List<E> list;\n\nSynchronizedList(List<E> list) {\n    super(list);\n    this.list = list;\n}\n```\n\nSynchronizedListçš„éƒ¨åˆ†æ–¹æ³•æºç å¦‚ä¸‹ï¼š\n\n```\npublic E get(int index) {\n    synchronized (mutex) {return list.get(index);}\n}\npublic E set(int index, E element) {\n    synchronized (mutex) {return list.set(index, element);}\n}\npublic void add(int index, E element) {\n    synchronized (mutex) {list.add(index, element);}\n}\npublic E remove(int index) {\n    synchronized (mutex) {return list.remove(index);}\n}\n```\n\nå¾ˆå¯æƒœï¼Œå®ƒæ‰€æœ‰æ–¹æ³•éƒ½æ˜¯å¸¦åŒæ­¥å¯¹è±¡é”çš„ï¼Œå’Œ Vector ä¸€æ ·ï¼Œå®ƒä¸æ˜¯æ€§èƒ½æœ€ä¼˜çš„ã€‚å³ä½¿ä½ èƒ½è¯´åˆ°è¿™é‡Œï¼Œé¢è¯•å®˜è¿˜ä¼šç»§ç»­å¾€ä¸‹è¿½é—®ï¼Œæ¯”å¦‚åœ¨è¯»å¤šå†™å°‘çš„æƒ…å†µï¼ŒSynchronizedListè¿™ç§é›†åˆæ€§èƒ½éå¸¸å·®ï¼Œè¿˜æœ‰æ²¡æœ‰æ›´åˆé€‚çš„æ–¹æ¡ˆï¼Ÿ\n\nä»‹ç»ä¸¤ä¸ªå¹¶å‘åŒ…é‡Œé¢çš„å¹¶å‘é›†åˆç±»ï¼š\n\n> java.util.concurrent.CopyOnWriteArrayList\n> java.util.concurrent.CopyOnWriteArraySet\n\nCopyOnWriteé›†åˆç±»ä¹Ÿå°±è¿™ä¸¤ä¸ªï¼ŒJava 1.5 å¼€å§‹åŠ å…¥ï¼Œä½ è¦èƒ½è¯´å¾—ä¸Šè¿™ä¸¤ä¸ªæ‰èƒ½è®©é¢è¯•å®˜ä¿¡æœã€‚\n\n#### CopyOnWriteArrayList\n\nCopyOnWriteï¼ˆç®€ç§°ï¼šCOWï¼‰ï¼šå³å¤åˆ¶å†å†™å…¥ï¼Œå°±æ˜¯åœ¨æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œå…ˆæŠŠåŸ List åˆ—è¡¨å¤åˆ¶ä¸€ä»½ï¼Œå†æ·»åŠ æ–°çš„å…ƒç´ ã€‚\n\n\nå…ˆæ¥çœ‹ä¸‹å®ƒçš„ add æ–¹æ³•æºç ï¼š\n\n```\npublic boolean add(E e) {\n    // åŠ é”\n    final ReentrantLock lock = this.lock;\n    lock.lock();\n    try {\n        // è·å–åŸå§‹é›†åˆ\n        Object[] elements = getArray();\n        int len = elements.length;\n        \n        // å¤åˆ¶ä¸€ä¸ªæ–°é›†åˆ\n        Object[] newElements = Arrays.copyOf(elements, len + 1);\n        newElements[len] = e;\n        \n        // æ›¿æ¢åŸå§‹é›†åˆä¸ºæ–°é›†åˆ\n        setArray(newElements);\n        return true;\n    } finally {\n        // é‡Šæ”¾é”\n        lock.unlock();\n    }\n}\n```\n\næ·»åŠ å…ƒç´ æ—¶ï¼Œå…ˆåŠ é”ï¼Œå†è¿›è¡Œå¤åˆ¶æ›¿æ¢æ“ä½œï¼Œæœ€åå†é‡Šæ”¾é”ã€‚\n\nå†æ¥çœ‹ä¸‹å®ƒçš„ get æ–¹æ³•æºç ï¼š\n\n```\nprivate E get(Object[] a, int index) {\n    return (E) a[index];\n}\n\npublic E get(int index) {\n    return get(getArray(), index);\n}\n```\n\nå¯ä»¥çœ‹åˆ°ï¼Œè·å–å…ƒç´ å¹¶æ²¡æœ‰åŠ é”ã€‚\n\nè¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œåœ¨é«˜å¹¶å‘æƒ…å†µä¸‹ï¼Œè¯»å–å…ƒç´ æ—¶å°±ä¸ç”¨åŠ é”ï¼Œå†™æ•°æ®æ—¶æ‰åŠ é”ï¼Œå¤§å¤§æå‡äº†è¯»å–æ€§èƒ½ã€‚\n\n#### CopyOnWriteArraySet\n\nCopyOnWriteArraySeté€»è¾‘å°±æ›´ç®€å•äº†ï¼Œå°±æ˜¯ä½¿ç”¨ CopyOnWriteArrayList çš„ addIfAbsent æ–¹æ³•æ¥å»é‡çš„ï¼Œæ·»åŠ å…ƒç´ çš„æ—¶å€™åˆ¤æ–­å¯¹è±¡æ˜¯å¦å·²ç»å­˜åœ¨ï¼Œä¸å­˜åœ¨æ‰æ·»åŠ è¿›é›†åˆã€‚\n\n```\n/**\n * Appends the element, if not present.\n *\n * @param e element to be added to this list, if absent\n * @return {@code true} if the element was added\n */\npublic boolean addIfAbsent(E e) {\n    Object[] snapshot = getArray();\n    return indexOf(e, snapshot, 0, snapshot.length) >= 0 ? false :\n        addIfAbsent(e, snapshot);\n}\n```\n\nè¿™ä¸¤ç§å¹¶å‘é›†åˆï¼Œè™½ç„¶ç‰›é€¼ï¼Œä½†åªé€‚åˆäºè¯»å¤šå†™å°‘çš„æƒ…å†µï¼Œå¦‚æœå†™å¤šè¯»å°‘ï¼Œä½¿ç”¨è¿™ä¸ªå°±æ²¡æ„ä¹‰äº†ï¼Œå› ä¸ºæ¯æ¬¡å†™æ“ä½œéƒ½è¦è¿›è¡Œé›†åˆå†…å­˜å¤åˆ¶ï¼Œæ€§èƒ½å¼€é”€å¾ˆå¤§ï¼Œå¦‚æœé›†åˆè¾ƒå¤§ï¼Œå¾ˆå®¹æ˜“é€ æˆå†…å­˜æº¢å‡ºã€‚\n\n#### æ€»ç»“\n\nä¸‹æ¬¡é¢è¯•å®˜é—®ä½ çº¿ç¨‹å®‰å…¨çš„ Listï¼Œä½ å¯ä»¥ä» Vector > SynchronizedList > CopyOnWriteArrayList è¿™æ ·çš„é¡ºåºä¾æ¬¡è¯´ä¸Šæ¥ï¼Œè¿™æ ·æ‰æœ‰å¸¦å…¥æ„Ÿï¼Œä¹Ÿèƒ½ä½“ç°ä½ å¯¹çŸ¥è¯†ç‚¹çš„æŒæ¡ç¨‹åº¦ã€‚\n\nçœ‹å®Œæœ‰æ²¡æœ‰æ”¶è·å‘¢ï¼Ÿä¸‹æ¬¡é¢è¯•åº”è¯¥èƒ½ç§’æ€é¢è¯•å®˜äº†å§ï¼\n\n","source":"_posts/å¤šçº¿ç¨‹/é¢è¯•å®˜é—®çº¿ç¨‹å®‰å…¨çš„Listï¼Œçœ‹å®Œå†ä¹Ÿä¸æ€•äº†ï¼.md","raw":"---\ntitle: é¢è¯•å®˜é—®çº¿ç¨‹å®‰å…¨çš„Listï¼Œçœ‹å®Œå†ä¹Ÿä¸æ€•äº†ï¼\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: å¤šçº¿ç¨‹\n---\n\næœ€è¿‘åœ¨JavaæŠ€æœ¯çŸ¥è¯†æ˜Ÿçƒé‡Œé¢æœ‰çƒå‹é—®åˆ°äº†çº¿ç¨‹å®‰å…¨çš„ Listï¼š\n\n![](http://img.javastack.cn/20190927184141.png)\n\næ‰«ç æŸ¥çœ‹ç­”æ¡ˆæˆ–åŠ å…¥çŸ¥è¯†æ˜Ÿçƒ\n\næ ˆé•¿åœ¨ä¹‹å‰çš„æ–‡ç« ã€Š[å‡ºåœºç‡æ¯”è¾ƒé«˜çš„ä¸€é“å¤šçº¿ç¨‹å®‰å…¨é¢è¯•é¢˜](https://mp.weixin.qq.com/s/oA-uEbzNYA4KYwLtRWXRVw)ã€‹é‡Œé¢è®²è¿‡ ArrayList çš„ä¸å®‰å…¨æ€§ã€‚\n\né‚£ä¹ˆé¢è¯•å®˜ä¼šé—®ä½ ï¼Œæ—¢ç„¶ ArrayList æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œæ€ä¹ˆä¿è¯å®ƒçš„çº¿ç¨‹å®‰å…¨æ€§å‘¢ï¼Ÿæˆ–è€…æœ‰ä»€ä¹ˆæ›¿ä»£æ–¹æ¡ˆï¼Ÿ\n\nå¾€ä¸‹çœ‹ï¼Œçœ‹æˆ‘å¦‚ä½•ç¢¾å‹ä»–ï¼\n\nå¤§éƒ¨åˆ†äººä¼šè„±å£è€Œå‡ºï¼šç”¨Vectorï¼Œè¿™æ ·åªä¼šè®©é¢è¯•å®˜é„™è§†ï¼é™¤äº†Vectorï¼Œä½ è¿˜ä¼šåˆ«çš„å—ï¼Ÿ\n\nä½ è‡³å°‘è¿˜å¾—è¯´å¾—ä¸Šè¿™ç§ï¼š\n\n> java.util.Collections.SynchronizedList\n\nå®ƒèƒ½æŠŠæ‰€æœ‰ List æ¥å£çš„å®ç°ç±»è½¬æ¢æˆçº¿ç¨‹å®‰å…¨çš„Listï¼Œæ¯” Vector æœ‰æ›´å¥½çš„æ‰©å±•æ€§å’Œå…¼å®¹æ€§ï¼ŒSynchronizedListçš„æ„é€ æ–¹æ³•å¦‚ä¸‹ï¼š\n\n```\nfinal List<E> list;\n\nSynchronizedList(List<E> list) {\n    super(list);\n    this.list = list;\n}\n```\n\nSynchronizedListçš„éƒ¨åˆ†æ–¹æ³•æºç å¦‚ä¸‹ï¼š\n\n```\npublic E get(int index) {\n    synchronized (mutex) {return list.get(index);}\n}\npublic E set(int index, E element) {\n    synchronized (mutex) {return list.set(index, element);}\n}\npublic void add(int index, E element) {\n    synchronized (mutex) {list.add(index, element);}\n}\npublic E remove(int index) {\n    synchronized (mutex) {return list.remove(index);}\n}\n```\n\nå¾ˆå¯æƒœï¼Œå®ƒæ‰€æœ‰æ–¹æ³•éƒ½æ˜¯å¸¦åŒæ­¥å¯¹è±¡é”çš„ï¼Œå’Œ Vector ä¸€æ ·ï¼Œå®ƒä¸æ˜¯æ€§èƒ½æœ€ä¼˜çš„ã€‚å³ä½¿ä½ èƒ½è¯´åˆ°è¿™é‡Œï¼Œé¢è¯•å®˜è¿˜ä¼šç»§ç»­å¾€ä¸‹è¿½é—®ï¼Œæ¯”å¦‚åœ¨è¯»å¤šå†™å°‘çš„æƒ…å†µï¼ŒSynchronizedListè¿™ç§é›†åˆæ€§èƒ½éå¸¸å·®ï¼Œè¿˜æœ‰æ²¡æœ‰æ›´åˆé€‚çš„æ–¹æ¡ˆï¼Ÿ\n\nä»‹ç»ä¸¤ä¸ªå¹¶å‘åŒ…é‡Œé¢çš„å¹¶å‘é›†åˆç±»ï¼š\n\n> java.util.concurrent.CopyOnWriteArrayList\n> java.util.concurrent.CopyOnWriteArraySet\n\nCopyOnWriteé›†åˆç±»ä¹Ÿå°±è¿™ä¸¤ä¸ªï¼ŒJava 1.5 å¼€å§‹åŠ å…¥ï¼Œä½ è¦èƒ½è¯´å¾—ä¸Šè¿™ä¸¤ä¸ªæ‰èƒ½è®©é¢è¯•å®˜ä¿¡æœã€‚\n\n#### CopyOnWriteArrayList\n\nCopyOnWriteï¼ˆç®€ç§°ï¼šCOWï¼‰ï¼šå³å¤åˆ¶å†å†™å…¥ï¼Œå°±æ˜¯åœ¨æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œå…ˆæŠŠåŸ List åˆ—è¡¨å¤åˆ¶ä¸€ä»½ï¼Œå†æ·»åŠ æ–°çš„å…ƒç´ ã€‚\n\n\nå…ˆæ¥çœ‹ä¸‹å®ƒçš„ add æ–¹æ³•æºç ï¼š\n\n```\npublic boolean add(E e) {\n    // åŠ é”\n    final ReentrantLock lock = this.lock;\n    lock.lock();\n    try {\n        // è·å–åŸå§‹é›†åˆ\n        Object[] elements = getArray();\n        int len = elements.length;\n        \n        // å¤åˆ¶ä¸€ä¸ªæ–°é›†åˆ\n        Object[] newElements = Arrays.copyOf(elements, len + 1);\n        newElements[len] = e;\n        \n        // æ›¿æ¢åŸå§‹é›†åˆä¸ºæ–°é›†åˆ\n        setArray(newElements);\n        return true;\n    } finally {\n        // é‡Šæ”¾é”\n        lock.unlock();\n    }\n}\n```\n\næ·»åŠ å…ƒç´ æ—¶ï¼Œå…ˆåŠ é”ï¼Œå†è¿›è¡Œå¤åˆ¶æ›¿æ¢æ“ä½œï¼Œæœ€åå†é‡Šæ”¾é”ã€‚\n\nå†æ¥çœ‹ä¸‹å®ƒçš„ get æ–¹æ³•æºç ï¼š\n\n```\nprivate E get(Object[] a, int index) {\n    return (E) a[index];\n}\n\npublic E get(int index) {\n    return get(getArray(), index);\n}\n```\n\nå¯ä»¥çœ‹åˆ°ï¼Œè·å–å…ƒç´ å¹¶æ²¡æœ‰åŠ é”ã€‚\n\nè¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œåœ¨é«˜å¹¶å‘æƒ…å†µä¸‹ï¼Œè¯»å–å…ƒç´ æ—¶å°±ä¸ç”¨åŠ é”ï¼Œå†™æ•°æ®æ—¶æ‰åŠ é”ï¼Œå¤§å¤§æå‡äº†è¯»å–æ€§èƒ½ã€‚\n\n#### CopyOnWriteArraySet\n\nCopyOnWriteArraySeté€»è¾‘å°±æ›´ç®€å•äº†ï¼Œå°±æ˜¯ä½¿ç”¨ CopyOnWriteArrayList çš„ addIfAbsent æ–¹æ³•æ¥å»é‡çš„ï¼Œæ·»åŠ å…ƒç´ çš„æ—¶å€™åˆ¤æ–­å¯¹è±¡æ˜¯å¦å·²ç»å­˜åœ¨ï¼Œä¸å­˜åœ¨æ‰æ·»åŠ è¿›é›†åˆã€‚\n\n```\n/**\n * Appends the element, if not present.\n *\n * @param e element to be added to this list, if absent\n * @return {@code true} if the element was added\n */\npublic boolean addIfAbsent(E e) {\n    Object[] snapshot = getArray();\n    return indexOf(e, snapshot, 0, snapshot.length) >= 0 ? false :\n        addIfAbsent(e, snapshot);\n}\n```\n\nè¿™ä¸¤ç§å¹¶å‘é›†åˆï¼Œè™½ç„¶ç‰›é€¼ï¼Œä½†åªé€‚åˆäºè¯»å¤šå†™å°‘çš„æƒ…å†µï¼Œå¦‚æœå†™å¤šè¯»å°‘ï¼Œä½¿ç”¨è¿™ä¸ªå°±æ²¡æ„ä¹‰äº†ï¼Œå› ä¸ºæ¯æ¬¡å†™æ“ä½œéƒ½è¦è¿›è¡Œé›†åˆå†…å­˜å¤åˆ¶ï¼Œæ€§èƒ½å¼€é”€å¾ˆå¤§ï¼Œå¦‚æœé›†åˆè¾ƒå¤§ï¼Œå¾ˆå®¹æ˜“é€ æˆå†…å­˜æº¢å‡ºã€‚\n\n#### æ€»ç»“\n\nä¸‹æ¬¡é¢è¯•å®˜é—®ä½ çº¿ç¨‹å®‰å…¨çš„ Listï¼Œä½ å¯ä»¥ä» Vector > SynchronizedList > CopyOnWriteArrayList è¿™æ ·çš„é¡ºåºä¾æ¬¡è¯´ä¸Šæ¥ï¼Œè¿™æ ·æ‰æœ‰å¸¦å…¥æ„Ÿï¼Œä¹Ÿèƒ½ä½“ç°ä½ å¯¹çŸ¥è¯†ç‚¹çš„æŒæ¡ç¨‹åº¦ã€‚\n\nçœ‹å®Œæœ‰æ²¡æœ‰æ”¶è·å‘¢ï¼Ÿä¸‹æ¬¡é¢è¯•åº”è¯¥èƒ½ç§’æ€é¢è¯•å®˜äº†å§ï¼\n\n","slug":"å¤šçº¿ç¨‹/é¢è¯•å®˜é—®çº¿ç¨‹å®‰å…¨çš„Listï¼Œçœ‹å®Œå†ä¹Ÿä¸æ€•äº†ï¼","published":1,"updated":"2025-10-15T07:20:25.014Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076s0033qkd4ddwdap0i","content":"<p>æœ€è¿‘åœ¨JavaæŠ€æœ¯çŸ¥è¯†æ˜Ÿçƒé‡Œé¢æœ‰çƒå‹é—®åˆ°äº†çº¿ç¨‹å®‰å…¨çš„ Listï¼š</p>\n<p><img src=\"http://img.javastack.cn/20190927184141.png\"></p>\n<p>æ‰«ç æŸ¥çœ‹ç­”æ¡ˆæˆ–åŠ å…¥çŸ¥è¯†æ˜Ÿçƒ</p>\n<p>æ ˆé•¿åœ¨ä¹‹å‰çš„æ–‡ç« ã€Š<a href=\"https://mp.weixin.qq.com/s/oA-uEbzNYA4KYwLtRWXRVw\">å‡ºåœºç‡æ¯”è¾ƒé«˜çš„ä¸€é“å¤šçº¿ç¨‹å®‰å…¨é¢è¯•é¢˜</a>ã€‹é‡Œé¢è®²è¿‡ ArrayList çš„ä¸å®‰å…¨æ€§ã€‚</p>\n<p>é‚£ä¹ˆé¢è¯•å®˜ä¼šé—®ä½ ï¼Œæ—¢ç„¶ ArrayList æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œæ€ä¹ˆä¿è¯å®ƒçš„çº¿ç¨‹å®‰å…¨æ€§å‘¢ï¼Ÿæˆ–è€…æœ‰ä»€ä¹ˆæ›¿ä»£æ–¹æ¡ˆï¼Ÿ</p>\n<p>å¾€ä¸‹çœ‹ï¼Œçœ‹æˆ‘å¦‚ä½•ç¢¾å‹ä»–ï¼</p>\n<p>å¤§éƒ¨åˆ†äººä¼šè„±å£è€Œå‡ºï¼šç”¨Vectorï¼Œè¿™æ ·åªä¼šè®©é¢è¯•å®˜é„™è§†ï¼é™¤äº†Vectorï¼Œä½ è¿˜ä¼šåˆ«çš„å—ï¼Ÿ</p>\n<p>ä½ è‡³å°‘è¿˜å¾—è¯´å¾—ä¸Šè¿™ç§ï¼š</p>\n<blockquote>\n<p>java.util.Collections.SynchronizedList</p>\n</blockquote>\n<p>å®ƒèƒ½æŠŠæ‰€æœ‰ List æ¥å£çš„å®ç°ç±»è½¬æ¢æˆçº¿ç¨‹å®‰å…¨çš„Listï¼Œæ¯” Vector æœ‰æ›´å¥½çš„æ‰©å±•æ€§å’Œå…¼å®¹æ€§ï¼ŒSynchronizedListçš„æ„é€ æ–¹æ³•å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">final List&lt;E&gt; list;\n\nSynchronizedList(List&lt;E&gt; list) &#123;\n    super(list);\n    this.list &#x3D; list;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>SynchronizedListçš„éƒ¨åˆ†æ–¹æ³•æºç å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public E get(int index) &#123;\n    synchronized (mutex) &#123;return list.get(index);&#125;\n&#125;\npublic E set(int index, E element) &#123;\n    synchronized (mutex) &#123;return list.set(index, element);&#125;\n&#125;\npublic void add(int index, E element) &#123;\n    synchronized (mutex) &#123;list.add(index, element);&#125;\n&#125;\npublic E remove(int index) &#123;\n    synchronized (mutex) &#123;return list.remove(index);&#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¾ˆå¯æƒœï¼Œå®ƒæ‰€æœ‰æ–¹æ³•éƒ½æ˜¯å¸¦åŒæ­¥å¯¹è±¡é”çš„ï¼Œå’Œ Vector ä¸€æ ·ï¼Œå®ƒä¸æ˜¯æ€§èƒ½æœ€ä¼˜çš„ã€‚å³ä½¿ä½ èƒ½è¯´åˆ°è¿™é‡Œï¼Œé¢è¯•å®˜è¿˜ä¼šç»§ç»­å¾€ä¸‹è¿½é—®ï¼Œæ¯”å¦‚åœ¨è¯»å¤šå†™å°‘çš„æƒ…å†µï¼ŒSynchronizedListè¿™ç§é›†åˆæ€§èƒ½éå¸¸å·®ï¼Œè¿˜æœ‰æ²¡æœ‰æ›´åˆé€‚çš„æ–¹æ¡ˆï¼Ÿ</p>\n<p>ä»‹ç»ä¸¤ä¸ªå¹¶å‘åŒ…é‡Œé¢çš„å¹¶å‘é›†åˆç±»ï¼š</p>\n<blockquote>\n<p>java.util.concurrent.CopyOnWriteArrayList<br>java.util.concurrent.CopyOnWriteArraySet</p>\n</blockquote>\n<p>CopyOnWriteé›†åˆç±»ä¹Ÿå°±è¿™ä¸¤ä¸ªï¼ŒJava 1.5 å¼€å§‹åŠ å…¥ï¼Œä½ è¦èƒ½è¯´å¾—ä¸Šè¿™ä¸¤ä¸ªæ‰èƒ½è®©é¢è¯•å®˜ä¿¡æœã€‚</p>\n<h4 id=\"CopyOnWriteArrayList\"><a href=\"#CopyOnWriteArrayList\" class=\"headerlink\" title=\"CopyOnWriteArrayList\"></a>CopyOnWriteArrayList</h4><p>CopyOnWriteï¼ˆç®€ç§°ï¼šCOWï¼‰ï¼šå³å¤åˆ¶å†å†™å…¥ï¼Œå°±æ˜¯åœ¨æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œå…ˆæŠŠåŸ List åˆ—è¡¨å¤åˆ¶ä¸€ä»½ï¼Œå†æ·»åŠ æ–°çš„å…ƒç´ ã€‚</p>\n<p>å…ˆæ¥çœ‹ä¸‹å®ƒçš„ add æ–¹æ³•æºç ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public boolean add(E e) &#123;\n    &#x2F;&#x2F; åŠ é”\n    final ReentrantLock lock &#x3D; this.lock;\n    lock.lock();\n    try &#123;\n        &#x2F;&#x2F; è·å–åŸå§‹é›†åˆ\n        Object[] elements &#x3D; getArray();\n        int len &#x3D; elements.length;\n        \n        &#x2F;&#x2F; å¤åˆ¶ä¸€ä¸ªæ–°é›†åˆ\n        Object[] newElements &#x3D; Arrays.copyOf(elements, len + 1);\n        newElements[len] &#x3D; e;\n        \n        &#x2F;&#x2F; æ›¿æ¢åŸå§‹é›†åˆä¸ºæ–°é›†åˆ\n        setArray(newElements);\n        return true;\n    &#125; finally &#123;\n        &#x2F;&#x2F; é‡Šæ”¾é”\n        lock.unlock();\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ·»åŠ å…ƒç´ æ—¶ï¼Œå…ˆåŠ é”ï¼Œå†è¿›è¡Œå¤åˆ¶æ›¿æ¢æ“ä½œï¼Œæœ€åå†é‡Šæ”¾é”ã€‚</p>\n<p>å†æ¥çœ‹ä¸‹å®ƒçš„ get æ–¹æ³•æºç ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private E get(Object[] a, int index) &#123;\n    return (E) a[index];\n&#125;\n\npublic E get(int index) &#123;\n    return get(getArray(), index);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥çœ‹åˆ°ï¼Œè·å–å…ƒç´ å¹¶æ²¡æœ‰åŠ é”ã€‚</p>\n<p>è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œåœ¨é«˜å¹¶å‘æƒ…å†µä¸‹ï¼Œè¯»å–å…ƒç´ æ—¶å°±ä¸ç”¨åŠ é”ï¼Œå†™æ•°æ®æ—¶æ‰åŠ é”ï¼Œå¤§å¤§æå‡äº†è¯»å–æ€§èƒ½ã€‚</p>\n<h4 id=\"CopyOnWriteArraySet\"><a href=\"#CopyOnWriteArraySet\" class=\"headerlink\" title=\"CopyOnWriteArraySet\"></a>CopyOnWriteArraySet</h4><p>CopyOnWriteArraySeté€»è¾‘å°±æ›´ç®€å•äº†ï¼Œå°±æ˜¯ä½¿ç”¨ CopyOnWriteArrayList çš„ addIfAbsent æ–¹æ³•æ¥å»é‡çš„ï¼Œæ·»åŠ å…ƒç´ çš„æ—¶å€™åˆ¤æ–­å¯¹è±¡æ˜¯å¦å·²ç»å­˜åœ¨ï¼Œä¸å­˜åœ¨æ‰æ·»åŠ è¿›é›†åˆã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * Appends the element, if not present.\n *\n * @param e element to be added to this list, if absent\n * @return &#123;@code true&#125; if the element was added\n *&#x2F;\npublic boolean addIfAbsent(E e) &#123;\n    Object[] snapshot &#x3D; getArray();\n    return indexOf(e, snapshot, 0, snapshot.length) &gt;&#x3D; 0 ? false :\n        addIfAbsent(e, snapshot);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸¤ç§å¹¶å‘é›†åˆï¼Œè™½ç„¶ç‰›é€¼ï¼Œä½†åªé€‚åˆäºè¯»å¤šå†™å°‘çš„æƒ…å†µï¼Œå¦‚æœå†™å¤šè¯»å°‘ï¼Œä½¿ç”¨è¿™ä¸ªå°±æ²¡æ„ä¹‰äº†ï¼Œå› ä¸ºæ¯æ¬¡å†™æ“ä½œéƒ½è¦è¿›è¡Œé›†åˆå†…å­˜å¤åˆ¶ï¼Œæ€§èƒ½å¼€é”€å¾ˆå¤§ï¼Œå¦‚æœé›†åˆè¾ƒå¤§ï¼Œå¾ˆå®¹æ˜“é€ æˆå†…å­˜æº¢å‡ºã€‚</p>\n<h4 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h4><p>ä¸‹æ¬¡é¢è¯•å®˜é—®ä½ çº¿ç¨‹å®‰å…¨çš„ Listï¼Œä½ å¯ä»¥ä» Vector &gt; SynchronizedList &gt; CopyOnWriteArrayList è¿™æ ·çš„é¡ºåºä¾æ¬¡è¯´ä¸Šæ¥ï¼Œè¿™æ ·æ‰æœ‰å¸¦å…¥æ„Ÿï¼Œä¹Ÿèƒ½ä½“ç°ä½ å¯¹çŸ¥è¯†ç‚¹çš„æŒæ¡ç¨‹åº¦ã€‚</p>\n<p>çœ‹å®Œæœ‰æ²¡æœ‰æ”¶è·å‘¢ï¼Ÿä¸‹æ¬¡é¢è¯•åº”è¯¥èƒ½ç§’æ€é¢è¯•å®˜äº†å§ï¼</p>\n","excerpt":"","more":"<p>æœ€è¿‘åœ¨JavaæŠ€æœ¯çŸ¥è¯†æ˜Ÿçƒé‡Œé¢æœ‰çƒå‹é—®åˆ°äº†çº¿ç¨‹å®‰å…¨çš„ Listï¼š</p>\n<p><img src=\"http://img.javastack.cn/20190927184141.png\"></p>\n<p>æ‰«ç æŸ¥çœ‹ç­”æ¡ˆæˆ–åŠ å…¥çŸ¥è¯†æ˜Ÿçƒ</p>\n<p>æ ˆé•¿åœ¨ä¹‹å‰çš„æ–‡ç« ã€Š<a href=\"https://mp.weixin.qq.com/s/oA-uEbzNYA4KYwLtRWXRVw\">å‡ºåœºç‡æ¯”è¾ƒé«˜çš„ä¸€é“å¤šçº¿ç¨‹å®‰å…¨é¢è¯•é¢˜</a>ã€‹é‡Œé¢è®²è¿‡ ArrayList çš„ä¸å®‰å…¨æ€§ã€‚</p>\n<p>é‚£ä¹ˆé¢è¯•å®˜ä¼šé—®ä½ ï¼Œæ—¢ç„¶ ArrayList æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œæ€ä¹ˆä¿è¯å®ƒçš„çº¿ç¨‹å®‰å…¨æ€§å‘¢ï¼Ÿæˆ–è€…æœ‰ä»€ä¹ˆæ›¿ä»£æ–¹æ¡ˆï¼Ÿ</p>\n<p>å¾€ä¸‹çœ‹ï¼Œçœ‹æˆ‘å¦‚ä½•ç¢¾å‹ä»–ï¼</p>\n<p>å¤§éƒ¨åˆ†äººä¼šè„±å£è€Œå‡ºï¼šç”¨Vectorï¼Œè¿™æ ·åªä¼šè®©é¢è¯•å®˜é„™è§†ï¼é™¤äº†Vectorï¼Œä½ è¿˜ä¼šåˆ«çš„å—ï¼Ÿ</p>\n<p>ä½ è‡³å°‘è¿˜å¾—è¯´å¾—ä¸Šè¿™ç§ï¼š</p>\n<blockquote>\n<p>java.util.Collections.SynchronizedList</p>\n</blockquote>\n<p>å®ƒèƒ½æŠŠæ‰€æœ‰ List æ¥å£çš„å®ç°ç±»è½¬æ¢æˆçº¿ç¨‹å®‰å…¨çš„Listï¼Œæ¯” Vector æœ‰æ›´å¥½çš„æ‰©å±•æ€§å’Œå…¼å®¹æ€§ï¼ŒSynchronizedListçš„æ„é€ æ–¹æ³•å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">final List&lt;E&gt; list;\n\nSynchronizedList(List&lt;E&gt; list) &#123;\n    super(list);\n    this.list &#x3D; list;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>SynchronizedListçš„éƒ¨åˆ†æ–¹æ³•æºç å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public E get(int index) &#123;\n    synchronized (mutex) &#123;return list.get(index);&#125;\n&#125;\npublic E set(int index, E element) &#123;\n    synchronized (mutex) &#123;return list.set(index, element);&#125;\n&#125;\npublic void add(int index, E element) &#123;\n    synchronized (mutex) &#123;list.add(index, element);&#125;\n&#125;\npublic E remove(int index) &#123;\n    synchronized (mutex) &#123;return list.remove(index);&#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¾ˆå¯æƒœï¼Œå®ƒæ‰€æœ‰æ–¹æ³•éƒ½æ˜¯å¸¦åŒæ­¥å¯¹è±¡é”çš„ï¼Œå’Œ Vector ä¸€æ ·ï¼Œå®ƒä¸æ˜¯æ€§èƒ½æœ€ä¼˜çš„ã€‚å³ä½¿ä½ èƒ½è¯´åˆ°è¿™é‡Œï¼Œé¢è¯•å®˜è¿˜ä¼šç»§ç»­å¾€ä¸‹è¿½é—®ï¼Œæ¯”å¦‚åœ¨è¯»å¤šå†™å°‘çš„æƒ…å†µï¼ŒSynchronizedListè¿™ç§é›†åˆæ€§èƒ½éå¸¸å·®ï¼Œè¿˜æœ‰æ²¡æœ‰æ›´åˆé€‚çš„æ–¹æ¡ˆï¼Ÿ</p>\n<p>ä»‹ç»ä¸¤ä¸ªå¹¶å‘åŒ…é‡Œé¢çš„å¹¶å‘é›†åˆç±»ï¼š</p>\n<blockquote>\n<p>java.util.concurrent.CopyOnWriteArrayList<br>java.util.concurrent.CopyOnWriteArraySet</p>\n</blockquote>\n<p>CopyOnWriteé›†åˆç±»ä¹Ÿå°±è¿™ä¸¤ä¸ªï¼ŒJava 1.5 å¼€å§‹åŠ å…¥ï¼Œä½ è¦èƒ½è¯´å¾—ä¸Šè¿™ä¸¤ä¸ªæ‰èƒ½è®©é¢è¯•å®˜ä¿¡æœã€‚</p>\n<h4 id=\"CopyOnWriteArrayList\"><a href=\"#CopyOnWriteArrayList\" class=\"headerlink\" title=\"CopyOnWriteArrayList\"></a>CopyOnWriteArrayList</h4><p>CopyOnWriteï¼ˆç®€ç§°ï¼šCOWï¼‰ï¼šå³å¤åˆ¶å†å†™å…¥ï¼Œå°±æ˜¯åœ¨æ·»åŠ å…ƒç´ çš„æ—¶å€™ï¼Œå…ˆæŠŠåŸ List åˆ—è¡¨å¤åˆ¶ä¸€ä»½ï¼Œå†æ·»åŠ æ–°çš„å…ƒç´ ã€‚</p>\n<p>å…ˆæ¥çœ‹ä¸‹å®ƒçš„ add æ–¹æ³•æºç ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public boolean add(E e) &#123;\n    &#x2F;&#x2F; åŠ é”\n    final ReentrantLock lock &#x3D; this.lock;\n    lock.lock();\n    try &#123;\n        &#x2F;&#x2F; è·å–åŸå§‹é›†åˆ\n        Object[] elements &#x3D; getArray();\n        int len &#x3D; elements.length;\n        \n        &#x2F;&#x2F; å¤åˆ¶ä¸€ä¸ªæ–°é›†åˆ\n        Object[] newElements &#x3D; Arrays.copyOf(elements, len + 1);\n        newElements[len] &#x3D; e;\n        \n        &#x2F;&#x2F; æ›¿æ¢åŸå§‹é›†åˆä¸ºæ–°é›†åˆ\n        setArray(newElements);\n        return true;\n    &#125; finally &#123;\n        &#x2F;&#x2F; é‡Šæ”¾é”\n        lock.unlock();\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ·»åŠ å…ƒç´ æ—¶ï¼Œå…ˆåŠ é”ï¼Œå†è¿›è¡Œå¤åˆ¶æ›¿æ¢æ“ä½œï¼Œæœ€åå†é‡Šæ”¾é”ã€‚</p>\n<p>å†æ¥çœ‹ä¸‹å®ƒçš„ get æ–¹æ³•æºç ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private E get(Object[] a, int index) &#123;\n    return (E) a[index];\n&#125;\n\npublic E get(int index) &#123;\n    return get(getArray(), index);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥çœ‹åˆ°ï¼Œè·å–å…ƒç´ å¹¶æ²¡æœ‰åŠ é”ã€‚</p>\n<p>è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œåœ¨é«˜å¹¶å‘æƒ…å†µä¸‹ï¼Œè¯»å–å…ƒç´ æ—¶å°±ä¸ç”¨åŠ é”ï¼Œå†™æ•°æ®æ—¶æ‰åŠ é”ï¼Œå¤§å¤§æå‡äº†è¯»å–æ€§èƒ½ã€‚</p>\n<h4 id=\"CopyOnWriteArraySet\"><a href=\"#CopyOnWriteArraySet\" class=\"headerlink\" title=\"CopyOnWriteArraySet\"></a>CopyOnWriteArraySet</h4><p>CopyOnWriteArraySeté€»è¾‘å°±æ›´ç®€å•äº†ï¼Œå°±æ˜¯ä½¿ç”¨ CopyOnWriteArrayList çš„ addIfAbsent æ–¹æ³•æ¥å»é‡çš„ï¼Œæ·»åŠ å…ƒç´ çš„æ—¶å€™åˆ¤æ–­å¯¹è±¡æ˜¯å¦å·²ç»å­˜åœ¨ï¼Œä¸å­˜åœ¨æ‰æ·»åŠ è¿›é›†åˆã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * Appends the element, if not present.\n *\n * @param e element to be added to this list, if absent\n * @return &#123;@code true&#125; if the element was added\n *&#x2F;\npublic boolean addIfAbsent(E e) &#123;\n    Object[] snapshot &#x3D; getArray();\n    return indexOf(e, snapshot, 0, snapshot.length) &gt;&#x3D; 0 ? false :\n        addIfAbsent(e, snapshot);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸¤ç§å¹¶å‘é›†åˆï¼Œè™½ç„¶ç‰›é€¼ï¼Œä½†åªé€‚åˆäºè¯»å¤šå†™å°‘çš„æƒ…å†µï¼Œå¦‚æœå†™å¤šè¯»å°‘ï¼Œä½¿ç”¨è¿™ä¸ªå°±æ²¡æ„ä¹‰äº†ï¼Œå› ä¸ºæ¯æ¬¡å†™æ“ä½œéƒ½è¦è¿›è¡Œé›†åˆå†…å­˜å¤åˆ¶ï¼Œæ€§èƒ½å¼€é”€å¾ˆå¤§ï¼Œå¦‚æœé›†åˆè¾ƒå¤§ï¼Œå¾ˆå®¹æ˜“é€ æˆå†…å­˜æº¢å‡ºã€‚</p>\n<h4 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h4><p>ä¸‹æ¬¡é¢è¯•å®˜é—®ä½ çº¿ç¨‹å®‰å…¨çš„ Listï¼Œä½ å¯ä»¥ä» Vector &gt; SynchronizedList &gt; CopyOnWriteArrayList è¿™æ ·çš„é¡ºåºä¾æ¬¡è¯´ä¸Šæ¥ï¼Œè¿™æ ·æ‰æœ‰å¸¦å…¥æ„Ÿï¼Œä¹Ÿèƒ½ä½“ç°ä½ å¯¹çŸ¥è¯†ç‚¹çš„æŒæ¡ç¨‹åº¦ã€‚</p>\n<p>çœ‹å®Œæœ‰æ²¡æœ‰æ”¶è·å‘¢ï¼Ÿä¸‹æ¬¡é¢è¯•åº”è¯¥èƒ½ç§’æ€é¢è¯•å®˜äº†å§ï¼</p>\n"},{"title":"10 ä¸ªæ·±æ¶ç—›ç»çš„ Java å¼‚å¸¸","date":"2025-10-14T06:42:34.000Z","_content":"\nå¼‚å¸¸æ˜¯ Java ç¨‹åºä¸­ç»å¸¸é‡åˆ°çš„é—®é¢˜ï¼Œæˆ‘æƒ³æ¯ä¸€ä¸ª Java ç¨‹åºå‘˜éƒ½è®¨åŒå¼‚å¸¸ï¼Œä¸€ ä¸ªå¼‚å¸¸å°±æ˜¯ä¸€ä¸ª BUGï¼Œå°±è¦èŠ±å¾ˆå¤šæ—¶é—´æ¥å®šä½å¼‚å¸¸é—®é¢˜ã€‚\n\n> ä»€ä¹ˆæ˜¯å¼‚å¸¸åŠå¼‚å¸¸çš„åˆ†ç±»è¯·çœ‹è¿™ç¯‡æ–‡ç« ï¼š[ä¸€å¼ å›¾ææ¸…æ¥š Java å¼‚å¸¸æœºåˆ¶](https://mp.weixin.qq.com/s/xbopgxZ5BEDdSvwO9ad9Xg)ã€‚\n\nä»Šå¤©ï¼Œæ ˆé•¿æ¥åˆ—ä¸€ä¸‹ Java ä¸­ç»å¸¸é‡åˆ°çš„å‰ 10 ä¸ªå¼‚å¸¸ï¼Œæ’åä¸åˆ†å…ˆåã€‚\n\n## 1ã€NullPointerException\n\nç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œæ“ä½œä¸€ä¸ª null å¯¹è±¡çš„æ–¹æ³•æˆ–å±æ€§æ—¶ä¼šæŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ã€‚å…·ä½“çœ‹è¿™ç¯‡æ–‡ç« ï¼š[Java é¿å…ç©ºæŒ‡é’ˆçš„ 5 ä¸ªæ¡ˆä¾‹](https://mp.weixin.qq.com/s/cmkKuhEZl1qx6TXPxvA5pw)ã€‚\n\n## 2ã€OutOfMemoryError\n\nå†…å­˜å¼‚å¸¸å¼‚å¸¸ï¼Œè¿™ä¸æ˜¯ç¨‹åºèƒ½æ§åˆ¶çš„ï¼Œæ˜¯æŒ‡è¦åˆ†é…çš„å¯¹è±¡çš„å†…å­˜è¶…å‡ºäº†å½“å‰æœ€å¤§çš„å †å†…å­˜ï¼Œéœ€è¦è°ƒæ•´å †å†…å­˜å¤§å°ï¼ˆ-Xmxï¼‰ä»¥åŠä¼˜åŒ–ç¨‹åºã€‚\n\n## 3ã€IOException\n\nIOï¼Œå³ï¼šinput, outputï¼Œæˆ‘ä»¬åœ¨è¯»å†™ç£ç›˜æ–‡ä»¶ã€ç½‘ç»œå†…å®¹çš„æ—¶å€™ç»å¸¸ä¼šç”Ÿçš„ä¸€ç§å¼‚å¸¸ï¼Œè¿™ç§å¼‚å¸¸æ˜¯å—æ£€æŸ¥å¼‚å¸¸ï¼Œéœ€è¦è¿›è¡Œæ‰‹å·¥æ•è·ã€‚\n\nå¦‚æ–‡ä»¶è¯»å†™ä¼šæŠ›å‡º IOExceptionï¼š\n\n```\npublic int read() throws IOException\npublic void write(int b) throws IOException\n```\n\n## 4ã€FileNotFoundException\n\næ–‡ä»¶æ‰¾ä¸åˆ°å¼‚å¸¸ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨å°±ä¼šæŠ›å‡ºè¿™ç§å¼‚å¸¸ã€‚\n\nå¦‚å®šä¹‰è¾“å…¥è¾“å‡ºæ–‡ä»¶æµï¼Œæ–‡ä»¶ä¸å­˜åœ¨ä¼šæŠ¥é”™ï¼š\n\n```\npublic FileInputStream(File file) throws FileNotFoundException\npublic FileOutputStream(File file) throws FileNotFoundException\n```\n\nFileNotFoundException å…¶å®æ˜¯ IOException çš„å­ç±»ï¼ŒåŒæ ·æ˜¯å—æ£€æŸ¥å¼‚å¸¸ï¼Œéœ€è¦è¿›è¡Œæ‰‹å·¥æ•è·ã€‚\n\n## 5ã€ClassNotFoundException\n\nç±»æ‰¾ä¸åˆ°å¼‚å¸¸ï¼ŒJavaå¼€å‘ä¸­ç»å¸¸é‡åˆ°ï¼Œæ˜¯ä¸æ˜¯å¾ˆç»æœ›ï¼Ÿè¿™æ˜¯åœ¨åŠ è½½ç±»çš„æ—¶å€™æŠ›å‡ºæ¥çš„ï¼Œå³åœ¨ç±»è·¯å¾„ä¸‹ä¸èƒ½åŠ è½½æŒ‡å®šçš„ç±»ã€‚\n\nçœ‹ä¸€ä¸ªç¤ºä¾‹ï¼š\n\n```\npublic static <T> Class<T> getExistingClass(ClassLoader classLoader, String className) {\n  try {\n     return (Class<T>) Class.forName(className, true, classLoader);\n  }\n  catch (ClassNotFoundException e) {\n     return null;\n  }\n}\n```\n\nå®ƒæ˜¯å—æ£€æŸ¥å¼‚å¸¸ï¼Œéœ€è¦è¿›è¡Œæ‰‹å·¥æ•è·ã€‚\n\n## 6ã€ClassCastException\n\nç±»è½¬æ¢å¼‚å¸¸ï¼Œå°†ä¸€ä¸ªä¸æ˜¯è¯¥ç±»çš„å®ä¾‹è½¬æ¢æˆè¿™ä¸ªç±»å°±ä¼šæŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ã€‚\n\nå¦‚å°†ä¸€ä¸ªæ•°å­—å¼ºåˆ¶è½¬æ¢æˆå­—ç¬¦ä¸²å°±ä¼šæŠ¥è¿™ä¸ªå¼‚å¸¸ï¼š\n\n```\nObject x = new Integer(0);\nSystem.out.println((String)x);\n```\n\nè¿™æ˜¯è¿è¡Œæ—¶å¼‚å¸¸ï¼Œä¸éœ€è¦æ‰‹å·¥æ•è·ã€‚\n\n## 7ã€NoSuchMethodException\n\næ²¡æœ‰è¿™ä¸ªæ–¹æ³•å¼‚å¸¸ï¼Œä¸€èˆ¬å‘ç”Ÿåœ¨åå°„è°ƒç”¨æ–¹æ³•çš„æ—¶å€™ï¼Œå¦‚ï¼š\n\n```\npublic Method getMethod(String name, Class<?>... parameterTypes)\n    throws NoSuchMethodException, SecurityException {\n    checkMemberAccess(Member.PUBLIC, Reflection.getCallerClass(), true);\n    Method method = getMethod0(name, parameterTypes, true);\n    if (method == null) {\n        throw new NoSuchMethodException(getName() + \".\" + name + argumentTypesToString(parameterTypes));\n    }\n    return method;\n}\n```\n\nå®ƒæ˜¯å—æ£€æŸ¥å¼‚å¸¸ï¼Œéœ€è¦è¿›è¡Œæ‰‹å·¥æ•è·ã€‚\n\n## 8ã€IndexOutOfBoundsException\n\nç´¢å¼•è¶Šç•Œå¼‚å¸¸ï¼Œå½“æ“ä½œä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…æ•°ç»„çš„æ—¶å€™ç»å¸¸é‡åˆ°çš„å¼‚å¸¸ã€‚\n\n![](http://qianniu.javastack.cn/18-12-12/80818264.jpg)\n\nå¦‚å›¾æ‰€ç¤ºï¼Œå®ƒæ˜¯è¿è¡Œæ—¶å¼‚å¸¸ï¼Œä¸éœ€è¦æ‰‹å·¥æ•è·ã€‚\n\n## 9ã€ArithmeticException\n\nç®—æœ¯å¼‚å¸¸ï¼Œå‘ç”Ÿåœ¨æ•°å­—çš„ç®—æœ¯è¿ç®—æ—¶çš„å¼‚å¸¸ï¼Œå¦‚ä¸€ä¸ªæ•°å­—é™¤ä»¥ 0 å°±ä¼šæŠ¥è¿™ä¸ªé”™ã€‚\n\n```\ndouble n = 3 / 0;\n```\n\nè¿™ä¸ªå¼‚å¸¸è™½ç„¶æ˜¯è¿è¡Œæ—¶å¼‚å¸¸ï¼Œå¯ä»¥æ‰‹å·¥æ•è·æŠ›å‡ºè‡ªå®šä¹‰çš„å¼‚å¸¸ï¼Œå¦‚ï¼š\n\n```\npublic static Timestamp from(Instant instant) {\n    try {\n        Timestamp stamp = new Timestamp(instant.getEpochSecond() * MILLIS_PER_SECOND);\n        stamp.nanos = instant.getNano();\n        return stamp;\n    } catch (ArithmeticException ex) {\n        throw new IllegalArgumentException(ex);\n    }\n}\n```\n\n## 10ã€SQLException\n\nSQLå¼‚å¸¸ï¼Œå‘ç”Ÿåœ¨æ“ä½œæ•°æ®åº“æ—¶çš„å¼‚å¸¸ã€‚\n\nå¦‚ä¸‹é¢çš„è·å–è¿æ¥ï¼š\n\n```\npublic Connection getConnection() throws SQLException {\n    if (getUser() == null) {\n        return DriverManager.getConnection(url);\n    } else {\n        return DriverManager.getConnection(url, getUser(), getPassword());\n    }\n}\n```\n\nåˆæˆ–è€…æ˜¯è·å–ä¸‹ä¸€æ¡è®°å½•çš„æ—¶å€™ï¼š\n\n```\nboolean next() throws SQLException;\n```\n\nå®ƒæ˜¯å—æ£€æŸ¥å¼‚å¸¸ï¼Œéœ€è¦è¿›è¡Œæ‰‹å·¥æ•è·ã€‚\n\n\n","source":"_posts/åŸºç¡€/10 ä¸ªæ·±æ¶ç—›ç»çš„ Java å¼‚å¸¸.md","raw":"---\ntitle: 10 ä¸ªæ·±æ¶ç—›ç»çš„ Java å¼‚å¸¸\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: åŸºç¡€\n---\n\nå¼‚å¸¸æ˜¯ Java ç¨‹åºä¸­ç»å¸¸é‡åˆ°çš„é—®é¢˜ï¼Œæˆ‘æƒ³æ¯ä¸€ä¸ª Java ç¨‹åºå‘˜éƒ½è®¨åŒå¼‚å¸¸ï¼Œä¸€ ä¸ªå¼‚å¸¸å°±æ˜¯ä¸€ä¸ª BUGï¼Œå°±è¦èŠ±å¾ˆå¤šæ—¶é—´æ¥å®šä½å¼‚å¸¸é—®é¢˜ã€‚\n\n> ä»€ä¹ˆæ˜¯å¼‚å¸¸åŠå¼‚å¸¸çš„åˆ†ç±»è¯·çœ‹è¿™ç¯‡æ–‡ç« ï¼š[ä¸€å¼ å›¾ææ¸…æ¥š Java å¼‚å¸¸æœºåˆ¶](https://mp.weixin.qq.com/s/xbopgxZ5BEDdSvwO9ad9Xg)ã€‚\n\nä»Šå¤©ï¼Œæ ˆé•¿æ¥åˆ—ä¸€ä¸‹ Java ä¸­ç»å¸¸é‡åˆ°çš„å‰ 10 ä¸ªå¼‚å¸¸ï¼Œæ’åä¸åˆ†å…ˆåã€‚\n\n## 1ã€NullPointerException\n\nç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œæ“ä½œä¸€ä¸ª null å¯¹è±¡çš„æ–¹æ³•æˆ–å±æ€§æ—¶ä¼šæŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ã€‚å…·ä½“çœ‹è¿™ç¯‡æ–‡ç« ï¼š[Java é¿å…ç©ºæŒ‡é’ˆçš„ 5 ä¸ªæ¡ˆä¾‹](https://mp.weixin.qq.com/s/cmkKuhEZl1qx6TXPxvA5pw)ã€‚\n\n## 2ã€OutOfMemoryError\n\nå†…å­˜å¼‚å¸¸å¼‚å¸¸ï¼Œè¿™ä¸æ˜¯ç¨‹åºèƒ½æ§åˆ¶çš„ï¼Œæ˜¯æŒ‡è¦åˆ†é…çš„å¯¹è±¡çš„å†…å­˜è¶…å‡ºäº†å½“å‰æœ€å¤§çš„å †å†…å­˜ï¼Œéœ€è¦è°ƒæ•´å †å†…å­˜å¤§å°ï¼ˆ-Xmxï¼‰ä»¥åŠä¼˜åŒ–ç¨‹åºã€‚\n\n## 3ã€IOException\n\nIOï¼Œå³ï¼šinput, outputï¼Œæˆ‘ä»¬åœ¨è¯»å†™ç£ç›˜æ–‡ä»¶ã€ç½‘ç»œå†…å®¹çš„æ—¶å€™ç»å¸¸ä¼šç”Ÿçš„ä¸€ç§å¼‚å¸¸ï¼Œè¿™ç§å¼‚å¸¸æ˜¯å—æ£€æŸ¥å¼‚å¸¸ï¼Œéœ€è¦è¿›è¡Œæ‰‹å·¥æ•è·ã€‚\n\nå¦‚æ–‡ä»¶è¯»å†™ä¼šæŠ›å‡º IOExceptionï¼š\n\n```\npublic int read() throws IOException\npublic void write(int b) throws IOException\n```\n\n## 4ã€FileNotFoundException\n\næ–‡ä»¶æ‰¾ä¸åˆ°å¼‚å¸¸ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨å°±ä¼šæŠ›å‡ºè¿™ç§å¼‚å¸¸ã€‚\n\nå¦‚å®šä¹‰è¾“å…¥è¾“å‡ºæ–‡ä»¶æµï¼Œæ–‡ä»¶ä¸å­˜åœ¨ä¼šæŠ¥é”™ï¼š\n\n```\npublic FileInputStream(File file) throws FileNotFoundException\npublic FileOutputStream(File file) throws FileNotFoundException\n```\n\nFileNotFoundException å…¶å®æ˜¯ IOException çš„å­ç±»ï¼ŒåŒæ ·æ˜¯å—æ£€æŸ¥å¼‚å¸¸ï¼Œéœ€è¦è¿›è¡Œæ‰‹å·¥æ•è·ã€‚\n\n## 5ã€ClassNotFoundException\n\nç±»æ‰¾ä¸åˆ°å¼‚å¸¸ï¼ŒJavaå¼€å‘ä¸­ç»å¸¸é‡åˆ°ï¼Œæ˜¯ä¸æ˜¯å¾ˆç»æœ›ï¼Ÿè¿™æ˜¯åœ¨åŠ è½½ç±»çš„æ—¶å€™æŠ›å‡ºæ¥çš„ï¼Œå³åœ¨ç±»è·¯å¾„ä¸‹ä¸èƒ½åŠ è½½æŒ‡å®šçš„ç±»ã€‚\n\nçœ‹ä¸€ä¸ªç¤ºä¾‹ï¼š\n\n```\npublic static <T> Class<T> getExistingClass(ClassLoader classLoader, String className) {\n  try {\n     return (Class<T>) Class.forName(className, true, classLoader);\n  }\n  catch (ClassNotFoundException e) {\n     return null;\n  }\n}\n```\n\nå®ƒæ˜¯å—æ£€æŸ¥å¼‚å¸¸ï¼Œéœ€è¦è¿›è¡Œæ‰‹å·¥æ•è·ã€‚\n\n## 6ã€ClassCastException\n\nç±»è½¬æ¢å¼‚å¸¸ï¼Œå°†ä¸€ä¸ªä¸æ˜¯è¯¥ç±»çš„å®ä¾‹è½¬æ¢æˆè¿™ä¸ªç±»å°±ä¼šæŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ã€‚\n\nå¦‚å°†ä¸€ä¸ªæ•°å­—å¼ºåˆ¶è½¬æ¢æˆå­—ç¬¦ä¸²å°±ä¼šæŠ¥è¿™ä¸ªå¼‚å¸¸ï¼š\n\n```\nObject x = new Integer(0);\nSystem.out.println((String)x);\n```\n\nè¿™æ˜¯è¿è¡Œæ—¶å¼‚å¸¸ï¼Œä¸éœ€è¦æ‰‹å·¥æ•è·ã€‚\n\n## 7ã€NoSuchMethodException\n\næ²¡æœ‰è¿™ä¸ªæ–¹æ³•å¼‚å¸¸ï¼Œä¸€èˆ¬å‘ç”Ÿåœ¨åå°„è°ƒç”¨æ–¹æ³•çš„æ—¶å€™ï¼Œå¦‚ï¼š\n\n```\npublic Method getMethod(String name, Class<?>... parameterTypes)\n    throws NoSuchMethodException, SecurityException {\n    checkMemberAccess(Member.PUBLIC, Reflection.getCallerClass(), true);\n    Method method = getMethod0(name, parameterTypes, true);\n    if (method == null) {\n        throw new NoSuchMethodException(getName() + \".\" + name + argumentTypesToString(parameterTypes));\n    }\n    return method;\n}\n```\n\nå®ƒæ˜¯å—æ£€æŸ¥å¼‚å¸¸ï¼Œéœ€è¦è¿›è¡Œæ‰‹å·¥æ•è·ã€‚\n\n## 8ã€IndexOutOfBoundsException\n\nç´¢å¼•è¶Šç•Œå¼‚å¸¸ï¼Œå½“æ“ä½œä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…æ•°ç»„çš„æ—¶å€™ç»å¸¸é‡åˆ°çš„å¼‚å¸¸ã€‚\n\n![](http://qianniu.javastack.cn/18-12-12/80818264.jpg)\n\nå¦‚å›¾æ‰€ç¤ºï¼Œå®ƒæ˜¯è¿è¡Œæ—¶å¼‚å¸¸ï¼Œä¸éœ€è¦æ‰‹å·¥æ•è·ã€‚\n\n## 9ã€ArithmeticException\n\nç®—æœ¯å¼‚å¸¸ï¼Œå‘ç”Ÿåœ¨æ•°å­—çš„ç®—æœ¯è¿ç®—æ—¶çš„å¼‚å¸¸ï¼Œå¦‚ä¸€ä¸ªæ•°å­—é™¤ä»¥ 0 å°±ä¼šæŠ¥è¿™ä¸ªé”™ã€‚\n\n```\ndouble n = 3 / 0;\n```\n\nè¿™ä¸ªå¼‚å¸¸è™½ç„¶æ˜¯è¿è¡Œæ—¶å¼‚å¸¸ï¼Œå¯ä»¥æ‰‹å·¥æ•è·æŠ›å‡ºè‡ªå®šä¹‰çš„å¼‚å¸¸ï¼Œå¦‚ï¼š\n\n```\npublic static Timestamp from(Instant instant) {\n    try {\n        Timestamp stamp = new Timestamp(instant.getEpochSecond() * MILLIS_PER_SECOND);\n        stamp.nanos = instant.getNano();\n        return stamp;\n    } catch (ArithmeticException ex) {\n        throw new IllegalArgumentException(ex);\n    }\n}\n```\n\n## 10ã€SQLException\n\nSQLå¼‚å¸¸ï¼Œå‘ç”Ÿåœ¨æ“ä½œæ•°æ®åº“æ—¶çš„å¼‚å¸¸ã€‚\n\nå¦‚ä¸‹é¢çš„è·å–è¿æ¥ï¼š\n\n```\npublic Connection getConnection() throws SQLException {\n    if (getUser() == null) {\n        return DriverManager.getConnection(url);\n    } else {\n        return DriverManager.getConnection(url, getUser(), getPassword());\n    }\n}\n```\n\nåˆæˆ–è€…æ˜¯è·å–ä¸‹ä¸€æ¡è®°å½•çš„æ—¶å€™ï¼š\n\n```\nboolean next() throws SQLException;\n```\n\nå®ƒæ˜¯å—æ£€æŸ¥å¼‚å¸¸ï¼Œéœ€è¦è¿›è¡Œæ‰‹å·¥æ•è·ã€‚\n\n\n","slug":"åŸºç¡€/10 ä¸ªæ·±æ¶ç—›ç»çš„ Java å¼‚å¸¸","published":1,"updated":"2025-10-15T07:19:51.879Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076s0036qkd4h11xeyed","content":"<p>å¼‚å¸¸æ˜¯ Java ç¨‹åºä¸­ç»å¸¸é‡åˆ°çš„é—®é¢˜ï¼Œæˆ‘æƒ³æ¯ä¸€ä¸ª Java ç¨‹åºå‘˜éƒ½è®¨åŒå¼‚å¸¸ï¼Œä¸€ ä¸ªå¼‚å¸¸å°±æ˜¯ä¸€ä¸ª BUGï¼Œå°±è¦èŠ±å¾ˆå¤šæ—¶é—´æ¥å®šä½å¼‚å¸¸é—®é¢˜ã€‚</p>\n<blockquote>\n<p>ä»€ä¹ˆæ˜¯å¼‚å¸¸åŠå¼‚å¸¸çš„åˆ†ç±»è¯·çœ‹è¿™ç¯‡æ–‡ç« ï¼š<a href=\"https://mp.weixin.qq.com/s/xbopgxZ5BEDdSvwO9ad9Xg\">ä¸€å¼ å›¾ææ¸…æ¥š Java å¼‚å¸¸æœºåˆ¶</a>ã€‚</p>\n</blockquote>\n<p>ä»Šå¤©ï¼Œæ ˆé•¿æ¥åˆ—ä¸€ä¸‹ Java ä¸­ç»å¸¸é‡åˆ°çš„å‰ 10 ä¸ªå¼‚å¸¸ï¼Œæ’åä¸åˆ†å…ˆåã€‚</p>\n<h2 id=\"1ã€NullPointerException\"><a href=\"#1ã€NullPointerException\" class=\"headerlink\" title=\"1ã€NullPointerException\"></a>1ã€NullPointerException</h2><p>ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œæ“ä½œä¸€ä¸ª null å¯¹è±¡çš„æ–¹æ³•æˆ–å±æ€§æ—¶ä¼šæŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ã€‚å…·ä½“çœ‹è¿™ç¯‡æ–‡ç« ï¼š<a href=\"https://mp.weixin.qq.com/s/cmkKuhEZl1qx6TXPxvA5pw\">Java é¿å…ç©ºæŒ‡é’ˆçš„ 5 ä¸ªæ¡ˆä¾‹</a>ã€‚</p>\n<h2 id=\"2ã€OutOfMemoryError\"><a href=\"#2ã€OutOfMemoryError\" class=\"headerlink\" title=\"2ã€OutOfMemoryError\"></a>2ã€OutOfMemoryError</h2><p>å†…å­˜å¼‚å¸¸å¼‚å¸¸ï¼Œè¿™ä¸æ˜¯ç¨‹åºèƒ½æ§åˆ¶çš„ï¼Œæ˜¯æŒ‡è¦åˆ†é…çš„å¯¹è±¡çš„å†…å­˜è¶…å‡ºäº†å½“å‰æœ€å¤§çš„å †å†…å­˜ï¼Œéœ€è¦è°ƒæ•´å †å†…å­˜å¤§å°ï¼ˆ-Xmxï¼‰ä»¥åŠä¼˜åŒ–ç¨‹åºã€‚</p>\n<h2 id=\"3ã€IOException\"><a href=\"#3ã€IOException\" class=\"headerlink\" title=\"3ã€IOException\"></a>3ã€IOException</h2><p>IOï¼Œå³ï¼šinput, outputï¼Œæˆ‘ä»¬åœ¨è¯»å†™ç£ç›˜æ–‡ä»¶ã€ç½‘ç»œå†…å®¹çš„æ—¶å€™ç»å¸¸ä¼šç”Ÿçš„ä¸€ç§å¼‚å¸¸ï¼Œè¿™ç§å¼‚å¸¸æ˜¯å—æ£€æŸ¥å¼‚å¸¸ï¼Œéœ€è¦è¿›è¡Œæ‰‹å·¥æ•è·ã€‚</p>\n<p>å¦‚æ–‡ä»¶è¯»å†™ä¼šæŠ›å‡º IOExceptionï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public int read() throws IOException\npublic void write(int b) throws IOException<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h2 id=\"4ã€FileNotFoundException\"><a href=\"#4ã€FileNotFoundException\" class=\"headerlink\" title=\"4ã€FileNotFoundException\"></a>4ã€FileNotFoundException</h2><p>æ–‡ä»¶æ‰¾ä¸åˆ°å¼‚å¸¸ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨å°±ä¼šæŠ›å‡ºè¿™ç§å¼‚å¸¸ã€‚</p>\n<p>å¦‚å®šä¹‰è¾“å…¥è¾“å‡ºæ–‡ä»¶æµï¼Œæ–‡ä»¶ä¸å­˜åœ¨ä¼šæŠ¥é”™ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public FileInputStream(File file) throws FileNotFoundException\npublic FileOutputStream(File file) throws FileNotFoundException<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>FileNotFoundException å…¶å®æ˜¯ IOException çš„å­ç±»ï¼ŒåŒæ ·æ˜¯å—æ£€æŸ¥å¼‚å¸¸ï¼Œéœ€è¦è¿›è¡Œæ‰‹å·¥æ•è·ã€‚</p>\n<h2 id=\"5ã€ClassNotFoundException\"><a href=\"#5ã€ClassNotFoundException\" class=\"headerlink\" title=\"5ã€ClassNotFoundException\"></a>5ã€ClassNotFoundException</h2><p>ç±»æ‰¾ä¸åˆ°å¼‚å¸¸ï¼ŒJavaå¼€å‘ä¸­ç»å¸¸é‡åˆ°ï¼Œæ˜¯ä¸æ˜¯å¾ˆç»æœ›ï¼Ÿè¿™æ˜¯åœ¨åŠ è½½ç±»çš„æ—¶å€™æŠ›å‡ºæ¥çš„ï¼Œå³åœ¨ç±»è·¯å¾„ä¸‹ä¸èƒ½åŠ è½½æŒ‡å®šçš„ç±»ã€‚</p>\n<p>çœ‹ä¸€ä¸ªç¤ºä¾‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static &lt;T&gt; Class&lt;T&gt; getExistingClass(ClassLoader classLoader, String className) &#123;\n  try &#123;\n     return (Class&lt;T&gt;) Class.forName(className, true, classLoader);\n  &#125;\n  catch (ClassNotFoundException e) &#123;\n     return null;\n  &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å®ƒæ˜¯å—æ£€æŸ¥å¼‚å¸¸ï¼Œéœ€è¦è¿›è¡Œæ‰‹å·¥æ•è·ã€‚</p>\n<h2 id=\"6ã€ClassCastException\"><a href=\"#6ã€ClassCastException\" class=\"headerlink\" title=\"6ã€ClassCastException\"></a>6ã€ClassCastException</h2><p>ç±»è½¬æ¢å¼‚å¸¸ï¼Œå°†ä¸€ä¸ªä¸æ˜¯è¯¥ç±»çš„å®ä¾‹è½¬æ¢æˆè¿™ä¸ªç±»å°±ä¼šæŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ã€‚</p>\n<p>å¦‚å°†ä¸€ä¸ªæ•°å­—å¼ºåˆ¶è½¬æ¢æˆå­—ç¬¦ä¸²å°±ä¼šæŠ¥è¿™ä¸ªå¼‚å¸¸ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Object x &#x3D; new Integer(0);\nSystem.out.println((String)x);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>è¿™æ˜¯è¿è¡Œæ—¶å¼‚å¸¸ï¼Œä¸éœ€è¦æ‰‹å·¥æ•è·ã€‚</p>\n<h2 id=\"7ã€NoSuchMethodException\"><a href=\"#7ã€NoSuchMethodException\" class=\"headerlink\" title=\"7ã€NoSuchMethodException\"></a>7ã€NoSuchMethodException</h2><p>æ²¡æœ‰è¿™ä¸ªæ–¹æ³•å¼‚å¸¸ï¼Œä¸€èˆ¬å‘ç”Ÿåœ¨åå°„è°ƒç”¨æ–¹æ³•çš„æ—¶å€™ï¼Œå¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public Method getMethod(String name, Class&lt;?&gt;... parameterTypes)\n    throws NoSuchMethodException, SecurityException &#123;\n    checkMemberAccess(Member.PUBLIC, Reflection.getCallerClass(), true);\n    Method method &#x3D; getMethod0(name, parameterTypes, true);\n    if (method &#x3D;&#x3D; null) &#123;\n        throw new NoSuchMethodException(getName() + &quot;.&quot; + name + argumentTypesToString(parameterTypes));\n    &#125;\n    return method;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å®ƒæ˜¯å—æ£€æŸ¥å¼‚å¸¸ï¼Œéœ€è¦è¿›è¡Œæ‰‹å·¥æ•è·ã€‚</p>\n<h2 id=\"8ã€IndexOutOfBoundsException\"><a href=\"#8ã€IndexOutOfBoundsException\" class=\"headerlink\" title=\"8ã€IndexOutOfBoundsException\"></a>8ã€IndexOutOfBoundsException</h2><p>ç´¢å¼•è¶Šç•Œå¼‚å¸¸ï¼Œå½“æ“ä½œä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…æ•°ç»„çš„æ—¶å€™ç»å¸¸é‡åˆ°çš„å¼‚å¸¸ã€‚</p>\n<p><img src=\"http://qianniu.javastack.cn/18-12-12/80818264.jpg\"></p>\n<p>å¦‚å›¾æ‰€ç¤ºï¼Œå®ƒæ˜¯è¿è¡Œæ—¶å¼‚å¸¸ï¼Œä¸éœ€è¦æ‰‹å·¥æ•è·ã€‚</p>\n<h2 id=\"9ã€ArithmeticException\"><a href=\"#9ã€ArithmeticException\" class=\"headerlink\" title=\"9ã€ArithmeticException\"></a>9ã€ArithmeticException</h2><p>ç®—æœ¯å¼‚å¸¸ï¼Œå‘ç”Ÿåœ¨æ•°å­—çš„ç®—æœ¯è¿ç®—æ—¶çš„å¼‚å¸¸ï¼Œå¦‚ä¸€ä¸ªæ•°å­—é™¤ä»¥ 0 å°±ä¼šæŠ¥è¿™ä¸ªé”™ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">double n &#x3D; 3 &#x2F; 0;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>è¿™ä¸ªå¼‚å¸¸è™½ç„¶æ˜¯è¿è¡Œæ—¶å¼‚å¸¸ï¼Œå¯ä»¥æ‰‹å·¥æ•è·æŠ›å‡ºè‡ªå®šä¹‰çš„å¼‚å¸¸ï¼Œå¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static Timestamp from(Instant instant) &#123;\n    try &#123;\n        Timestamp stamp &#x3D; new Timestamp(instant.getEpochSecond() * MILLIS_PER_SECOND);\n        stamp.nanos &#x3D; instant.getNano();\n        return stamp;\n    &#125; catch (ArithmeticException ex) &#123;\n        throw new IllegalArgumentException(ex);\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"10ã€SQLException\"><a href=\"#10ã€SQLException\" class=\"headerlink\" title=\"10ã€SQLException\"></a>10ã€SQLException</h2><p>SQLå¼‚å¸¸ï¼Œå‘ç”Ÿåœ¨æ“ä½œæ•°æ®åº“æ—¶çš„å¼‚å¸¸ã€‚</p>\n<p>å¦‚ä¸‹é¢çš„è·å–è¿æ¥ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public Connection getConnection() throws SQLException &#123;\n    if (getUser() &#x3D;&#x3D; null) &#123;\n        return DriverManager.getConnection(url);\n    &#125; else &#123;\n        return DriverManager.getConnection(url, getUser(), getPassword());\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>åˆæˆ–è€…æ˜¯è·å–ä¸‹ä¸€æ¡è®°å½•çš„æ—¶å€™ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">boolean next() throws SQLException;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>å®ƒæ˜¯å—æ£€æŸ¥å¼‚å¸¸ï¼Œéœ€è¦è¿›è¡Œæ‰‹å·¥æ•è·ã€‚</p>\n","excerpt":"","more":"<p>å¼‚å¸¸æ˜¯ Java ç¨‹åºä¸­ç»å¸¸é‡åˆ°çš„é—®é¢˜ï¼Œæˆ‘æƒ³æ¯ä¸€ä¸ª Java ç¨‹åºå‘˜éƒ½è®¨åŒå¼‚å¸¸ï¼Œä¸€ ä¸ªå¼‚å¸¸å°±æ˜¯ä¸€ä¸ª BUGï¼Œå°±è¦èŠ±å¾ˆå¤šæ—¶é—´æ¥å®šä½å¼‚å¸¸é—®é¢˜ã€‚</p>\n<blockquote>\n<p>ä»€ä¹ˆæ˜¯å¼‚å¸¸åŠå¼‚å¸¸çš„åˆ†ç±»è¯·çœ‹è¿™ç¯‡æ–‡ç« ï¼š<a href=\"https://mp.weixin.qq.com/s/xbopgxZ5BEDdSvwO9ad9Xg\">ä¸€å¼ å›¾ææ¸…æ¥š Java å¼‚å¸¸æœºåˆ¶</a>ã€‚</p>\n</blockquote>\n<p>ä»Šå¤©ï¼Œæ ˆé•¿æ¥åˆ—ä¸€ä¸‹ Java ä¸­ç»å¸¸é‡åˆ°çš„å‰ 10 ä¸ªå¼‚å¸¸ï¼Œæ’åä¸åˆ†å…ˆåã€‚</p>\n<h2 id=\"1ã€NullPointerException\"><a href=\"#1ã€NullPointerException\" class=\"headerlink\" title=\"1ã€NullPointerException\"></a>1ã€NullPointerException</h2><p>ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œæ“ä½œä¸€ä¸ª null å¯¹è±¡çš„æ–¹æ³•æˆ–å±æ€§æ—¶ä¼šæŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ã€‚å…·ä½“çœ‹è¿™ç¯‡æ–‡ç« ï¼š<a href=\"https://mp.weixin.qq.com/s/cmkKuhEZl1qx6TXPxvA5pw\">Java é¿å…ç©ºæŒ‡é’ˆçš„ 5 ä¸ªæ¡ˆä¾‹</a>ã€‚</p>\n<h2 id=\"2ã€OutOfMemoryError\"><a href=\"#2ã€OutOfMemoryError\" class=\"headerlink\" title=\"2ã€OutOfMemoryError\"></a>2ã€OutOfMemoryError</h2><p>å†…å­˜å¼‚å¸¸å¼‚å¸¸ï¼Œè¿™ä¸æ˜¯ç¨‹åºèƒ½æ§åˆ¶çš„ï¼Œæ˜¯æŒ‡è¦åˆ†é…çš„å¯¹è±¡çš„å†…å­˜è¶…å‡ºäº†å½“å‰æœ€å¤§çš„å †å†…å­˜ï¼Œéœ€è¦è°ƒæ•´å †å†…å­˜å¤§å°ï¼ˆ-Xmxï¼‰ä»¥åŠä¼˜åŒ–ç¨‹åºã€‚</p>\n<h2 id=\"3ã€IOException\"><a href=\"#3ã€IOException\" class=\"headerlink\" title=\"3ã€IOException\"></a>3ã€IOException</h2><p>IOï¼Œå³ï¼šinput, outputï¼Œæˆ‘ä»¬åœ¨è¯»å†™ç£ç›˜æ–‡ä»¶ã€ç½‘ç»œå†…å®¹çš„æ—¶å€™ç»å¸¸ä¼šç”Ÿçš„ä¸€ç§å¼‚å¸¸ï¼Œè¿™ç§å¼‚å¸¸æ˜¯å—æ£€æŸ¥å¼‚å¸¸ï¼Œéœ€è¦è¿›è¡Œæ‰‹å·¥æ•è·ã€‚</p>\n<p>å¦‚æ–‡ä»¶è¯»å†™ä¼šæŠ›å‡º IOExceptionï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public int read() throws IOException\npublic void write(int b) throws IOException<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h2 id=\"4ã€FileNotFoundException\"><a href=\"#4ã€FileNotFoundException\" class=\"headerlink\" title=\"4ã€FileNotFoundException\"></a>4ã€FileNotFoundException</h2><p>æ–‡ä»¶æ‰¾ä¸åˆ°å¼‚å¸¸ï¼Œå¦‚æœæ–‡ä»¶ä¸å­˜åœ¨å°±ä¼šæŠ›å‡ºè¿™ç§å¼‚å¸¸ã€‚</p>\n<p>å¦‚å®šä¹‰è¾“å…¥è¾“å‡ºæ–‡ä»¶æµï¼Œæ–‡ä»¶ä¸å­˜åœ¨ä¼šæŠ¥é”™ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public FileInputStream(File file) throws FileNotFoundException\npublic FileOutputStream(File file) throws FileNotFoundException<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>FileNotFoundException å…¶å®æ˜¯ IOException çš„å­ç±»ï¼ŒåŒæ ·æ˜¯å—æ£€æŸ¥å¼‚å¸¸ï¼Œéœ€è¦è¿›è¡Œæ‰‹å·¥æ•è·ã€‚</p>\n<h2 id=\"5ã€ClassNotFoundException\"><a href=\"#5ã€ClassNotFoundException\" class=\"headerlink\" title=\"5ã€ClassNotFoundException\"></a>5ã€ClassNotFoundException</h2><p>ç±»æ‰¾ä¸åˆ°å¼‚å¸¸ï¼ŒJavaå¼€å‘ä¸­ç»å¸¸é‡åˆ°ï¼Œæ˜¯ä¸æ˜¯å¾ˆç»æœ›ï¼Ÿè¿™æ˜¯åœ¨åŠ è½½ç±»çš„æ—¶å€™æŠ›å‡ºæ¥çš„ï¼Œå³åœ¨ç±»è·¯å¾„ä¸‹ä¸èƒ½åŠ è½½æŒ‡å®šçš„ç±»ã€‚</p>\n<p>çœ‹ä¸€ä¸ªç¤ºä¾‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static &lt;T&gt; Class&lt;T&gt; getExistingClass(ClassLoader classLoader, String className) &#123;\n  try &#123;\n     return (Class&lt;T&gt;) Class.forName(className, true, classLoader);\n  &#125;\n  catch (ClassNotFoundException e) &#123;\n     return null;\n  &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å®ƒæ˜¯å—æ£€æŸ¥å¼‚å¸¸ï¼Œéœ€è¦è¿›è¡Œæ‰‹å·¥æ•è·ã€‚</p>\n<h2 id=\"6ã€ClassCastException\"><a href=\"#6ã€ClassCastException\" class=\"headerlink\" title=\"6ã€ClassCastException\"></a>6ã€ClassCastException</h2><p>ç±»è½¬æ¢å¼‚å¸¸ï¼Œå°†ä¸€ä¸ªä¸æ˜¯è¯¥ç±»çš„å®ä¾‹è½¬æ¢æˆè¿™ä¸ªç±»å°±ä¼šæŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ã€‚</p>\n<p>å¦‚å°†ä¸€ä¸ªæ•°å­—å¼ºåˆ¶è½¬æ¢æˆå­—ç¬¦ä¸²å°±ä¼šæŠ¥è¿™ä¸ªå¼‚å¸¸ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Object x &#x3D; new Integer(0);\nSystem.out.println((String)x);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>è¿™æ˜¯è¿è¡Œæ—¶å¼‚å¸¸ï¼Œä¸éœ€è¦æ‰‹å·¥æ•è·ã€‚</p>\n<h2 id=\"7ã€NoSuchMethodException\"><a href=\"#7ã€NoSuchMethodException\" class=\"headerlink\" title=\"7ã€NoSuchMethodException\"></a>7ã€NoSuchMethodException</h2><p>æ²¡æœ‰è¿™ä¸ªæ–¹æ³•å¼‚å¸¸ï¼Œä¸€èˆ¬å‘ç”Ÿåœ¨åå°„è°ƒç”¨æ–¹æ³•çš„æ—¶å€™ï¼Œå¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public Method getMethod(String name, Class&lt;?&gt;... parameterTypes)\n    throws NoSuchMethodException, SecurityException &#123;\n    checkMemberAccess(Member.PUBLIC, Reflection.getCallerClass(), true);\n    Method method &#x3D; getMethod0(name, parameterTypes, true);\n    if (method &#x3D;&#x3D; null) &#123;\n        throw new NoSuchMethodException(getName() + &quot;.&quot; + name + argumentTypesToString(parameterTypes));\n    &#125;\n    return method;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å®ƒæ˜¯å—æ£€æŸ¥å¼‚å¸¸ï¼Œéœ€è¦è¿›è¡Œæ‰‹å·¥æ•è·ã€‚</p>\n<h2 id=\"8ã€IndexOutOfBoundsException\"><a href=\"#8ã€IndexOutOfBoundsException\" class=\"headerlink\" title=\"8ã€IndexOutOfBoundsException\"></a>8ã€IndexOutOfBoundsException</h2><p>ç´¢å¼•è¶Šç•Œå¼‚å¸¸ï¼Œå½“æ“ä½œä¸€ä¸ªå­—ç¬¦ä¸²æˆ–è€…æ•°ç»„çš„æ—¶å€™ç»å¸¸é‡åˆ°çš„å¼‚å¸¸ã€‚</p>\n<p><img src=\"http://qianniu.javastack.cn/18-12-12/80818264.jpg\"></p>\n<p>å¦‚å›¾æ‰€ç¤ºï¼Œå®ƒæ˜¯è¿è¡Œæ—¶å¼‚å¸¸ï¼Œä¸éœ€è¦æ‰‹å·¥æ•è·ã€‚</p>\n<h2 id=\"9ã€ArithmeticException\"><a href=\"#9ã€ArithmeticException\" class=\"headerlink\" title=\"9ã€ArithmeticException\"></a>9ã€ArithmeticException</h2><p>ç®—æœ¯å¼‚å¸¸ï¼Œå‘ç”Ÿåœ¨æ•°å­—çš„ç®—æœ¯è¿ç®—æ—¶çš„å¼‚å¸¸ï¼Œå¦‚ä¸€ä¸ªæ•°å­—é™¤ä»¥ 0 å°±ä¼šæŠ¥è¿™ä¸ªé”™ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">double n &#x3D; 3 &#x2F; 0;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>è¿™ä¸ªå¼‚å¸¸è™½ç„¶æ˜¯è¿è¡Œæ—¶å¼‚å¸¸ï¼Œå¯ä»¥æ‰‹å·¥æ•è·æŠ›å‡ºè‡ªå®šä¹‰çš„å¼‚å¸¸ï¼Œå¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static Timestamp from(Instant instant) &#123;\n    try &#123;\n        Timestamp stamp &#x3D; new Timestamp(instant.getEpochSecond() * MILLIS_PER_SECOND);\n        stamp.nanos &#x3D; instant.getNano();\n        return stamp;\n    &#125; catch (ArithmeticException ex) &#123;\n        throw new IllegalArgumentException(ex);\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"10ã€SQLException\"><a href=\"#10ã€SQLException\" class=\"headerlink\" title=\"10ã€SQLException\"></a>10ã€SQLException</h2><p>SQLå¼‚å¸¸ï¼Œå‘ç”Ÿåœ¨æ“ä½œæ•°æ®åº“æ—¶çš„å¼‚å¸¸ã€‚</p>\n<p>å¦‚ä¸‹é¢çš„è·å–è¿æ¥ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public Connection getConnection() throws SQLException &#123;\n    if (getUser() &#x3D;&#x3D; null) &#123;\n        return DriverManager.getConnection(url);\n    &#125; else &#123;\n        return DriverManager.getConnection(url, getUser(), getPassword());\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>åˆæˆ–è€…æ˜¯è·å–ä¸‹ä¸€æ¡è®°å½•çš„æ—¶å€™ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">boolean next() throws SQLException;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>å®ƒæ˜¯å—æ£€æŸ¥å¼‚å¸¸ï¼Œéœ€è¦è¿›è¡Œæ‰‹å·¥æ•è·ã€‚</p>\n"},{"title":"Java Base64 ç¼–ç è§£ç æ–¹æ¡ˆæ€»ç»“","date":"2025-10-14T06:42:34.000Z","_content":"\nBase64æ˜¯ä¸€ç§èƒ½å°†ä»»æ„Binaryèµ„æ–™ç”¨64ç§å­—å…ƒç»„åˆæˆå­—ä¸²çš„æ–¹æ³•ï¼Œè€Œè¿™ä¸ªBinaryèµ„æ–™å’Œå­—ä¸²èµ„æ–™å½¼æ­¤ä¹‹é—´æ˜¯å¯ä»¥äº’ç›¸è½¬æ¢çš„ï¼Œååˆ†æ–¹ä¾¿ã€‚åœ¨å®é™…åº”ç”¨ä¸Šï¼ŒBase64é™¤äº†èƒ½å°†Binaryèµ„æ–™å¯è§†åŒ–ä¹‹å¤–ï¼Œä¹Ÿå¸¸ç”¨æ¥è¡¨ç¤ºå­—ä¸²åŠ å¯†è¿‡åçš„å†…å®¹ã€‚å¦‚æœè¦ä½¿ç”¨Java ç¨‹å¼è¯­è¨€æ¥å®ä½œBase64çš„ç¼–ç ä¸è§£ç åŠŸèƒ½ï¼Œå¯ä»¥å‚è€ƒæœ¬ç¯‡æ–‡ç« çš„ä½œæ³•ã€‚\n\n#### æ—©æœŸä½œæ³•\n\næ—©æœŸåœ¨Javaä¸ŠåšBase64çš„ç¼–ç ä¸è§£ç ï¼Œä¼šä½¿ç”¨åˆ°JDKé‡Œsun.miscå¥—ä»¶ä¸‹çš„BASE64Encoderå’ŒBASE64Decoderè¿™ä¸¤ä¸ªç±»åˆ«ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š\n\n```\nfinal BASE64Encoder encoder = new BASE64Encoder();\nfinal BASE64Decoder decoder = new BASE64Decoder();\nfinal String text = \"JavaæŠ€æœ¯\";\nfinal byte[] textByte = text.getBytes(\"UTF-8\");\n\n//ç¼–ç \nfinal String encodedText = encoder.encode(textByte);\nSystem.out.println(encodedText);\n\n//è§£ç \nSystem.out.println(new String(decoder.decodeBuffer(encodedText), \"UTF-8\"));\n\nfinal BASE64Encoder encoder = new BASE64Encoder();\nfinal BASE64Decoder decoder = new BASE64Decoder();\nfinal String text = \"JavaæŠ€æœ¯\";\nfinal byte[] textByte = text.getBytes(\"UTF-8\");\n\n//ç¼–ç \nfinal String encodedText = encoder.encode(textByte);\nSystem.out.println(encodedText);\n\n//è§£ç \nSystem.out.println(new String(decoder.decodeBuffer(encodedText), \"UTF-8\"));\n```\n\n\nä»ä»¥ä¸Šç¨‹å¼å¯ä»¥å‘ç°ï¼Œåœ¨Javaç”¨Base64ä¸€ç‚¹éƒ½ä¸éš¾ï¼Œä¸ç”¨å‡ è¡Œç¨‹å¼ç å°±è§£å†³äº†ï¼åªæ˜¯è¿™ä¸ªsun.mis cå¥—ä»¶æ‰€æä¾›çš„Base64åŠŸèƒ½ï¼Œç¼–ç å’Œè§£ç çš„æ•ˆç‡å¹¶ä¸å¤ªå¥½ï¼Œè€Œä¸”åœ¨ä»¥åçš„Javaç‰ˆæœ¬å¯èƒ½å°±ä¸è¢«æ”¯æ´äº†ï¼Œå®Œå…¨ä¸å»ºè®®ä½¿ç”¨ã€‚\n\n#### Apache Commons Codecä½œæ³•\n\nApache Commons Codecæœ‰æä¾›Base64çš„ç¼–ç ä¸è§£ç åŠŸèƒ½ï¼Œä¼šä½¿ç”¨åˆ°org.apache.commons.codec.binaryå¥—ä»¶ä¸‹çš„Base64ç±»åˆ«ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š\n\n```\nfinal Base64 base64 = new Base64();\nfinal String text = \"JavaæŠ€æœ¯\";\nfinal byte[] textByte = text.getBytes(\"UTF-8\");\n\n//ç¼–ç \nfinal String encodedText = base64.encodeToString(textByte);\nSystem.out.println(encodedText);\n\n//è§£ç \nSystem.out.println(new String(base64.decode(encodedText), \"UTF-8\"));\n\nfinal Base64 base64 = new Base64();\nfinal String text = \"JavaæŠ€æœ¯\";\nfinal byte[] textByte = text.getBytes(\"UTF-8\");\n\n//ç¼–ç \nfinal String encodedText = base64.encodeToString(textByte);\nSystem.out.println(encodedText);\n\n//è§£ç \nSystem.out.println(new String(base64.decode(encodedText), \"UTF-8\"));\n```\n\nä»¥ä¸Šçš„ç¨‹å¼ç çœ‹èµ·æ¥åˆæ¯”æ—©æœŸç”¨sun.mis cå¥—ä»¶è¿˜è¦æ›´ç²¾ç®€ï¼Œæ•ˆèƒ½å®é™…æ‰§è¡Œèµ·æ¥ä¹Ÿå¿«äº†ä¸å°‘ã€‚ç¼ºç‚¹æ˜¯éœ€è¦å¼•ç”¨Apache Commons Codecï¼Œå¾ˆéº»çƒ¦ã€‚\n\n#### Java 8ä¹‹åçš„ä½œæ³•\n\nJava 8çš„java.utilå¥—ä»¶ä¸­ï¼Œæ–°å¢äº†Base64çš„ç±»åˆ«ï¼Œå¯ä»¥ç”¨æ¥å¤„ç†Base64çš„ç¼–ç ä¸è§£ç ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š\n\n```\nfinal Base64.Decoder decoder = Base64.getDecoder();\nfinal Base64.Encoder encoder = Base64.getEncoder();\nfinal String text = \"JavaæŠ€æœ¯\";\nfinal byte[] textByte = text.getBytes(\"UTF-8\");\n\n//ç¼–ç \nfinal String encodedText = encoder.encodeToString(textByte);\nSystem.out.println(encodedText);\n\n//è§£ç \nSystem.out.println(new String(decoder.decode(encodedText), \"UTF-8\"));\n\nfinal Base64.Decoder decoder = Base64.getDecoder();\nfinal Base64.Encoder encoder = Base64.getEncoder();\nfinal String text = \"JavaæŠ€æœ¯\";\nfinal byte[] textByte = text.getBytes(\"UTF-8\");\n\n//ç¼–ç \nfinal String encodedText = encoder.encodeToString(textByte);\nSystem.out.println(encodedText);\n\n//è§£ç \nSystem.out.println(new String(decoder.decode(encodedText), \"UTF-8\"));\n```\n\n\nä¸sun.mis cå¥—ä»¶å’ŒApache Commons Codecæ‰€æä¾›çš„Base64ç¼–è§£ç å™¨æ¥æ¯”è¾ƒçš„è¯ï¼ŒJava 8æä¾›çš„Base64æ‹¥æœ‰æ›´å¥½çš„æ•ˆèƒ½ã€‚å®é™…æµ‹è¯•ç¼–ç ä¸è§£ç é€Ÿåº¦çš„è¯ï¼ŒJava 8æä¾›çš„Base64ï¼Œè¦æ¯”sun.mis cå¥—ä»¶æä¾›çš„è¿˜è¦å¿«è‡³å°‘11å€ï¼Œæ¯”Apache Commons Codecæä¾›çš„è¿˜è¦å¿«è‡³å°‘3å€ã€‚**å› æ­¤åœ¨Javaä¸Šè‹¥è¦ä½¿ç”¨Base64ï¼Œè¿™ä¸ªJava 8åº•ä¸‹çš„java .utilå¥—ä»¶æ‰€æä¾›çš„Base64ç±»åˆ«ç»å¯¹æ˜¯é¦–é€‰ï¼**\n\n","source":"_posts/åŸºç¡€/Java Base64 ç¼–ç è§£ç æ–¹æ¡ˆæ€»ç»“.md","raw":"---\ntitle: Java Base64 ç¼–ç è§£ç æ–¹æ¡ˆæ€»ç»“\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: åŸºç¡€\n---\n\nBase64æ˜¯ä¸€ç§èƒ½å°†ä»»æ„Binaryèµ„æ–™ç”¨64ç§å­—å…ƒç»„åˆæˆå­—ä¸²çš„æ–¹æ³•ï¼Œè€Œè¿™ä¸ªBinaryèµ„æ–™å’Œå­—ä¸²èµ„æ–™å½¼æ­¤ä¹‹é—´æ˜¯å¯ä»¥äº’ç›¸è½¬æ¢çš„ï¼Œååˆ†æ–¹ä¾¿ã€‚åœ¨å®é™…åº”ç”¨ä¸Šï¼ŒBase64é™¤äº†èƒ½å°†Binaryèµ„æ–™å¯è§†åŒ–ä¹‹å¤–ï¼Œä¹Ÿå¸¸ç”¨æ¥è¡¨ç¤ºå­—ä¸²åŠ å¯†è¿‡åçš„å†…å®¹ã€‚å¦‚æœè¦ä½¿ç”¨Java ç¨‹å¼è¯­è¨€æ¥å®ä½œBase64çš„ç¼–ç ä¸è§£ç åŠŸèƒ½ï¼Œå¯ä»¥å‚è€ƒæœ¬ç¯‡æ–‡ç« çš„ä½œæ³•ã€‚\n\n#### æ—©æœŸä½œæ³•\n\næ—©æœŸåœ¨Javaä¸ŠåšBase64çš„ç¼–ç ä¸è§£ç ï¼Œä¼šä½¿ç”¨åˆ°JDKé‡Œsun.miscå¥—ä»¶ä¸‹çš„BASE64Encoderå’ŒBASE64Decoderè¿™ä¸¤ä¸ªç±»åˆ«ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š\n\n```\nfinal BASE64Encoder encoder = new BASE64Encoder();\nfinal BASE64Decoder decoder = new BASE64Decoder();\nfinal String text = \"JavaæŠ€æœ¯\";\nfinal byte[] textByte = text.getBytes(\"UTF-8\");\n\n//ç¼–ç \nfinal String encodedText = encoder.encode(textByte);\nSystem.out.println(encodedText);\n\n//è§£ç \nSystem.out.println(new String(decoder.decodeBuffer(encodedText), \"UTF-8\"));\n\nfinal BASE64Encoder encoder = new BASE64Encoder();\nfinal BASE64Decoder decoder = new BASE64Decoder();\nfinal String text = \"JavaæŠ€æœ¯\";\nfinal byte[] textByte = text.getBytes(\"UTF-8\");\n\n//ç¼–ç \nfinal String encodedText = encoder.encode(textByte);\nSystem.out.println(encodedText);\n\n//è§£ç \nSystem.out.println(new String(decoder.decodeBuffer(encodedText), \"UTF-8\"));\n```\n\n\nä»ä»¥ä¸Šç¨‹å¼å¯ä»¥å‘ç°ï¼Œåœ¨Javaç”¨Base64ä¸€ç‚¹éƒ½ä¸éš¾ï¼Œä¸ç”¨å‡ è¡Œç¨‹å¼ç å°±è§£å†³äº†ï¼åªæ˜¯è¿™ä¸ªsun.mis cå¥—ä»¶æ‰€æä¾›çš„Base64åŠŸèƒ½ï¼Œç¼–ç å’Œè§£ç çš„æ•ˆç‡å¹¶ä¸å¤ªå¥½ï¼Œè€Œä¸”åœ¨ä»¥åçš„Javaç‰ˆæœ¬å¯èƒ½å°±ä¸è¢«æ”¯æ´äº†ï¼Œå®Œå…¨ä¸å»ºè®®ä½¿ç”¨ã€‚\n\n#### Apache Commons Codecä½œæ³•\n\nApache Commons Codecæœ‰æä¾›Base64çš„ç¼–ç ä¸è§£ç åŠŸèƒ½ï¼Œä¼šä½¿ç”¨åˆ°org.apache.commons.codec.binaryå¥—ä»¶ä¸‹çš„Base64ç±»åˆ«ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š\n\n```\nfinal Base64 base64 = new Base64();\nfinal String text = \"JavaæŠ€æœ¯\";\nfinal byte[] textByte = text.getBytes(\"UTF-8\");\n\n//ç¼–ç \nfinal String encodedText = base64.encodeToString(textByte);\nSystem.out.println(encodedText);\n\n//è§£ç \nSystem.out.println(new String(base64.decode(encodedText), \"UTF-8\"));\n\nfinal Base64 base64 = new Base64();\nfinal String text = \"JavaæŠ€æœ¯\";\nfinal byte[] textByte = text.getBytes(\"UTF-8\");\n\n//ç¼–ç \nfinal String encodedText = base64.encodeToString(textByte);\nSystem.out.println(encodedText);\n\n//è§£ç \nSystem.out.println(new String(base64.decode(encodedText), \"UTF-8\"));\n```\n\nä»¥ä¸Šçš„ç¨‹å¼ç çœ‹èµ·æ¥åˆæ¯”æ—©æœŸç”¨sun.mis cå¥—ä»¶è¿˜è¦æ›´ç²¾ç®€ï¼Œæ•ˆèƒ½å®é™…æ‰§è¡Œèµ·æ¥ä¹Ÿå¿«äº†ä¸å°‘ã€‚ç¼ºç‚¹æ˜¯éœ€è¦å¼•ç”¨Apache Commons Codecï¼Œå¾ˆéº»çƒ¦ã€‚\n\n#### Java 8ä¹‹åçš„ä½œæ³•\n\nJava 8çš„java.utilå¥—ä»¶ä¸­ï¼Œæ–°å¢äº†Base64çš„ç±»åˆ«ï¼Œå¯ä»¥ç”¨æ¥å¤„ç†Base64çš„ç¼–ç ä¸è§£ç ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š\n\n```\nfinal Base64.Decoder decoder = Base64.getDecoder();\nfinal Base64.Encoder encoder = Base64.getEncoder();\nfinal String text = \"JavaæŠ€æœ¯\";\nfinal byte[] textByte = text.getBytes(\"UTF-8\");\n\n//ç¼–ç \nfinal String encodedText = encoder.encodeToString(textByte);\nSystem.out.println(encodedText);\n\n//è§£ç \nSystem.out.println(new String(decoder.decode(encodedText), \"UTF-8\"));\n\nfinal Base64.Decoder decoder = Base64.getDecoder();\nfinal Base64.Encoder encoder = Base64.getEncoder();\nfinal String text = \"JavaæŠ€æœ¯\";\nfinal byte[] textByte = text.getBytes(\"UTF-8\");\n\n//ç¼–ç \nfinal String encodedText = encoder.encodeToString(textByte);\nSystem.out.println(encodedText);\n\n//è§£ç \nSystem.out.println(new String(decoder.decode(encodedText), \"UTF-8\"));\n```\n\n\nä¸sun.mis cå¥—ä»¶å’ŒApache Commons Codecæ‰€æä¾›çš„Base64ç¼–è§£ç å™¨æ¥æ¯”è¾ƒçš„è¯ï¼ŒJava 8æä¾›çš„Base64æ‹¥æœ‰æ›´å¥½çš„æ•ˆèƒ½ã€‚å®é™…æµ‹è¯•ç¼–ç ä¸è§£ç é€Ÿåº¦çš„è¯ï¼ŒJava 8æä¾›çš„Base64ï¼Œè¦æ¯”sun.mis cå¥—ä»¶æä¾›çš„è¿˜è¦å¿«è‡³å°‘11å€ï¼Œæ¯”Apache Commons Codecæä¾›çš„è¿˜è¦å¿«è‡³å°‘3å€ã€‚**å› æ­¤åœ¨Javaä¸Šè‹¥è¦ä½¿ç”¨Base64ï¼Œè¿™ä¸ªJava 8åº•ä¸‹çš„java .utilå¥—ä»¶æ‰€æä¾›çš„Base64ç±»åˆ«ç»å¯¹æ˜¯é¦–é€‰ï¼**\n\n","slug":"åŸºç¡€/Java Base64 ç¼–ç è§£ç æ–¹æ¡ˆæ€»ç»“","published":1,"updated":"2025-10-15T07:19:51.820Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076t0039qkd43yqc2emq","content":"<p>Base64æ˜¯ä¸€ç§èƒ½å°†ä»»æ„Binaryèµ„æ–™ç”¨64ç§å­—å…ƒç»„åˆæˆå­—ä¸²çš„æ–¹æ³•ï¼Œè€Œè¿™ä¸ªBinaryèµ„æ–™å’Œå­—ä¸²èµ„æ–™å½¼æ­¤ä¹‹é—´æ˜¯å¯ä»¥äº’ç›¸è½¬æ¢çš„ï¼Œååˆ†æ–¹ä¾¿ã€‚åœ¨å®é™…åº”ç”¨ä¸Šï¼ŒBase64é™¤äº†èƒ½å°†Binaryèµ„æ–™å¯è§†åŒ–ä¹‹å¤–ï¼Œä¹Ÿå¸¸ç”¨æ¥è¡¨ç¤ºå­—ä¸²åŠ å¯†è¿‡åçš„å†…å®¹ã€‚å¦‚æœè¦ä½¿ç”¨Java ç¨‹å¼è¯­è¨€æ¥å®ä½œBase64çš„ç¼–ç ä¸è§£ç åŠŸèƒ½ï¼Œå¯ä»¥å‚è€ƒæœ¬ç¯‡æ–‡ç« çš„ä½œæ³•ã€‚</p>\n<h4 id=\"æ—©æœŸä½œæ³•\"><a href=\"#æ—©æœŸä½œæ³•\" class=\"headerlink\" title=\"æ—©æœŸä½œæ³•\"></a>æ—©æœŸä½œæ³•</h4><p>æ—©æœŸåœ¨Javaä¸ŠåšBase64çš„ç¼–ç ä¸è§£ç ï¼Œä¼šä½¿ç”¨åˆ°JDKé‡Œsun.miscå¥—ä»¶ä¸‹çš„BASE64Encoderå’ŒBASE64Decoderè¿™ä¸¤ä¸ªç±»åˆ«ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">final BASE64Encoder encoder &#x3D; new BASE64Encoder();\nfinal BASE64Decoder decoder &#x3D; new BASE64Decoder();\nfinal String text &#x3D; &quot;JavaæŠ€æœ¯&quot;;\nfinal byte[] textByte &#x3D; text.getBytes(&quot;UTF-8&quot;);\n\n&#x2F;&#x2F;ç¼–ç \nfinal String encodedText &#x3D; encoder.encode(textByte);\nSystem.out.println(encodedText);\n\n&#x2F;&#x2F;è§£ç \nSystem.out.println(new String(decoder.decodeBuffer(encodedText), &quot;UTF-8&quot;));\n\nfinal BASE64Encoder encoder &#x3D; new BASE64Encoder();\nfinal BASE64Decoder decoder &#x3D; new BASE64Decoder();\nfinal String text &#x3D; &quot;JavaæŠ€æœ¯&quot;;\nfinal byte[] textByte &#x3D; text.getBytes(&quot;UTF-8&quot;);\n\n&#x2F;&#x2F;ç¼–ç \nfinal String encodedText &#x3D; encoder.encode(textByte);\nSystem.out.println(encodedText);\n\n&#x2F;&#x2F;è§£ç \nSystem.out.println(new String(decoder.decodeBuffer(encodedText), &quot;UTF-8&quot;));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n<p>ä»ä»¥ä¸Šç¨‹å¼å¯ä»¥å‘ç°ï¼Œåœ¨Javaç”¨Base64ä¸€ç‚¹éƒ½ä¸éš¾ï¼Œä¸ç”¨å‡ è¡Œç¨‹å¼ç å°±è§£å†³äº†ï¼åªæ˜¯è¿™ä¸ªsun.mis cå¥—ä»¶æ‰€æä¾›çš„Base64åŠŸèƒ½ï¼Œç¼–ç å’Œè§£ç çš„æ•ˆç‡å¹¶ä¸å¤ªå¥½ï¼Œè€Œä¸”åœ¨ä»¥åçš„Javaç‰ˆæœ¬å¯èƒ½å°±ä¸è¢«æ”¯æ´äº†ï¼Œå®Œå…¨ä¸å»ºè®®ä½¿ç”¨ã€‚</p>\n<h4 id=\"Apache-Commons-Codecä½œæ³•\"><a href=\"#Apache-Commons-Codecä½œæ³•\" class=\"headerlink\" title=\"Apache Commons Codecä½œæ³•\"></a>Apache Commons Codecä½œæ³•</h4><p>Apache Commons Codecæœ‰æä¾›Base64çš„ç¼–ç ä¸è§£ç åŠŸèƒ½ï¼Œä¼šä½¿ç”¨åˆ°org.apache.commons.codec.binaryå¥—ä»¶ä¸‹çš„Base64ç±»åˆ«ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">final Base64 base64 &#x3D; new Base64();\nfinal String text &#x3D; &quot;JavaæŠ€æœ¯&quot;;\nfinal byte[] textByte &#x3D; text.getBytes(&quot;UTF-8&quot;);\n\n&#x2F;&#x2F;ç¼–ç \nfinal String encodedText &#x3D; base64.encodeToString(textByte);\nSystem.out.println(encodedText);\n\n&#x2F;&#x2F;è§£ç \nSystem.out.println(new String(base64.decode(encodedText), &quot;UTF-8&quot;));\n\nfinal Base64 base64 &#x3D; new Base64();\nfinal String text &#x3D; &quot;JavaæŠ€æœ¯&quot;;\nfinal byte[] textByte &#x3D; text.getBytes(&quot;UTF-8&quot;);\n\n&#x2F;&#x2F;ç¼–ç \nfinal String encodedText &#x3D; base64.encodeToString(textByte);\nSystem.out.println(encodedText);\n\n&#x2F;&#x2F;è§£ç \nSystem.out.println(new String(base64.decode(encodedText), &quot;UTF-8&quot;));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä»¥ä¸Šçš„ç¨‹å¼ç çœ‹èµ·æ¥åˆæ¯”æ—©æœŸç”¨sun.mis cå¥—ä»¶è¿˜è¦æ›´ç²¾ç®€ï¼Œæ•ˆèƒ½å®é™…æ‰§è¡Œèµ·æ¥ä¹Ÿå¿«äº†ä¸å°‘ã€‚ç¼ºç‚¹æ˜¯éœ€è¦å¼•ç”¨Apache Commons Codecï¼Œå¾ˆéº»çƒ¦ã€‚</p>\n<h4 id=\"Java-8ä¹‹åçš„ä½œæ³•\"><a href=\"#Java-8ä¹‹åçš„ä½œæ³•\" class=\"headerlink\" title=\"Java 8ä¹‹åçš„ä½œæ³•\"></a>Java 8ä¹‹åçš„ä½œæ³•</h4><p>Java 8çš„java.utilå¥—ä»¶ä¸­ï¼Œæ–°å¢äº†Base64çš„ç±»åˆ«ï¼Œå¯ä»¥ç”¨æ¥å¤„ç†Base64çš„ç¼–ç ä¸è§£ç ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">final Base64.Decoder decoder &#x3D; Base64.getDecoder();\nfinal Base64.Encoder encoder &#x3D; Base64.getEncoder();\nfinal String text &#x3D; &quot;JavaæŠ€æœ¯&quot;;\nfinal byte[] textByte &#x3D; text.getBytes(&quot;UTF-8&quot;);\n\n&#x2F;&#x2F;ç¼–ç \nfinal String encodedText &#x3D; encoder.encodeToString(textByte);\nSystem.out.println(encodedText);\n\n&#x2F;&#x2F;è§£ç \nSystem.out.println(new String(decoder.decode(encodedText), &quot;UTF-8&quot;));\n\nfinal Base64.Decoder decoder &#x3D; Base64.getDecoder();\nfinal Base64.Encoder encoder &#x3D; Base64.getEncoder();\nfinal String text &#x3D; &quot;JavaæŠ€æœ¯&quot;;\nfinal byte[] textByte &#x3D; text.getBytes(&quot;UTF-8&quot;);\n\n&#x2F;&#x2F;ç¼–ç \nfinal String encodedText &#x3D; encoder.encodeToString(textByte);\nSystem.out.println(encodedText);\n\n&#x2F;&#x2F;è§£ç \nSystem.out.println(new String(decoder.decode(encodedText), &quot;UTF-8&quot;));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n<p>ä¸sun.mis cå¥—ä»¶å’ŒApache Commons Codecæ‰€æä¾›çš„Base64ç¼–è§£ç å™¨æ¥æ¯”è¾ƒçš„è¯ï¼ŒJava 8æä¾›çš„Base64æ‹¥æœ‰æ›´å¥½çš„æ•ˆèƒ½ã€‚å®é™…æµ‹è¯•ç¼–ç ä¸è§£ç é€Ÿåº¦çš„è¯ï¼ŒJava 8æä¾›çš„Base64ï¼Œè¦æ¯”sun.mis cå¥—ä»¶æä¾›çš„è¿˜è¦å¿«è‡³å°‘11å€ï¼Œæ¯”Apache Commons Codecæä¾›çš„è¿˜è¦å¿«è‡³å°‘3å€ã€‚<strong>å› æ­¤åœ¨Javaä¸Šè‹¥è¦ä½¿ç”¨Base64ï¼Œè¿™ä¸ªJava 8åº•ä¸‹çš„java .utilå¥—ä»¶æ‰€æä¾›çš„Base64ç±»åˆ«ç»å¯¹æ˜¯é¦–é€‰ï¼</strong></p>\n","excerpt":"","more":"<p>Base64æ˜¯ä¸€ç§èƒ½å°†ä»»æ„Binaryèµ„æ–™ç”¨64ç§å­—å…ƒç»„åˆæˆå­—ä¸²çš„æ–¹æ³•ï¼Œè€Œè¿™ä¸ªBinaryèµ„æ–™å’Œå­—ä¸²èµ„æ–™å½¼æ­¤ä¹‹é—´æ˜¯å¯ä»¥äº’ç›¸è½¬æ¢çš„ï¼Œååˆ†æ–¹ä¾¿ã€‚åœ¨å®é™…åº”ç”¨ä¸Šï¼ŒBase64é™¤äº†èƒ½å°†Binaryèµ„æ–™å¯è§†åŒ–ä¹‹å¤–ï¼Œä¹Ÿå¸¸ç”¨æ¥è¡¨ç¤ºå­—ä¸²åŠ å¯†è¿‡åçš„å†…å®¹ã€‚å¦‚æœè¦ä½¿ç”¨Java ç¨‹å¼è¯­è¨€æ¥å®ä½œBase64çš„ç¼–ç ä¸è§£ç åŠŸèƒ½ï¼Œå¯ä»¥å‚è€ƒæœ¬ç¯‡æ–‡ç« çš„ä½œæ³•ã€‚</p>\n<h4 id=\"æ—©æœŸä½œæ³•\"><a href=\"#æ—©æœŸä½œæ³•\" class=\"headerlink\" title=\"æ—©æœŸä½œæ³•\"></a>æ—©æœŸä½œæ³•</h4><p>æ—©æœŸåœ¨Javaä¸ŠåšBase64çš„ç¼–ç ä¸è§£ç ï¼Œä¼šä½¿ç”¨åˆ°JDKé‡Œsun.miscå¥—ä»¶ä¸‹çš„BASE64Encoderå’ŒBASE64Decoderè¿™ä¸¤ä¸ªç±»åˆ«ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">final BASE64Encoder encoder &#x3D; new BASE64Encoder();\nfinal BASE64Decoder decoder &#x3D; new BASE64Decoder();\nfinal String text &#x3D; &quot;JavaæŠ€æœ¯&quot;;\nfinal byte[] textByte &#x3D; text.getBytes(&quot;UTF-8&quot;);\n\n&#x2F;&#x2F;ç¼–ç \nfinal String encodedText &#x3D; encoder.encode(textByte);\nSystem.out.println(encodedText);\n\n&#x2F;&#x2F;è§£ç \nSystem.out.println(new String(decoder.decodeBuffer(encodedText), &quot;UTF-8&quot;));\n\nfinal BASE64Encoder encoder &#x3D; new BASE64Encoder();\nfinal BASE64Decoder decoder &#x3D; new BASE64Decoder();\nfinal String text &#x3D; &quot;JavaæŠ€æœ¯&quot;;\nfinal byte[] textByte &#x3D; text.getBytes(&quot;UTF-8&quot;);\n\n&#x2F;&#x2F;ç¼–ç \nfinal String encodedText &#x3D; encoder.encode(textByte);\nSystem.out.println(encodedText);\n\n&#x2F;&#x2F;è§£ç \nSystem.out.println(new String(decoder.decodeBuffer(encodedText), &quot;UTF-8&quot;));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n<p>ä»ä»¥ä¸Šç¨‹å¼å¯ä»¥å‘ç°ï¼Œåœ¨Javaç”¨Base64ä¸€ç‚¹éƒ½ä¸éš¾ï¼Œä¸ç”¨å‡ è¡Œç¨‹å¼ç å°±è§£å†³äº†ï¼åªæ˜¯è¿™ä¸ªsun.mis cå¥—ä»¶æ‰€æä¾›çš„Base64åŠŸèƒ½ï¼Œç¼–ç å’Œè§£ç çš„æ•ˆç‡å¹¶ä¸å¤ªå¥½ï¼Œè€Œä¸”åœ¨ä»¥åçš„Javaç‰ˆæœ¬å¯èƒ½å°±ä¸è¢«æ”¯æ´äº†ï¼Œå®Œå…¨ä¸å»ºè®®ä½¿ç”¨ã€‚</p>\n<h4 id=\"Apache-Commons-Codecä½œæ³•\"><a href=\"#Apache-Commons-Codecä½œæ³•\" class=\"headerlink\" title=\"Apache Commons Codecä½œæ³•\"></a>Apache Commons Codecä½œæ³•</h4><p>Apache Commons Codecæœ‰æä¾›Base64çš„ç¼–ç ä¸è§£ç åŠŸèƒ½ï¼Œä¼šä½¿ç”¨åˆ°org.apache.commons.codec.binaryå¥—ä»¶ä¸‹çš„Base64ç±»åˆ«ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">final Base64 base64 &#x3D; new Base64();\nfinal String text &#x3D; &quot;JavaæŠ€æœ¯&quot;;\nfinal byte[] textByte &#x3D; text.getBytes(&quot;UTF-8&quot;);\n\n&#x2F;&#x2F;ç¼–ç \nfinal String encodedText &#x3D; base64.encodeToString(textByte);\nSystem.out.println(encodedText);\n\n&#x2F;&#x2F;è§£ç \nSystem.out.println(new String(base64.decode(encodedText), &quot;UTF-8&quot;));\n\nfinal Base64 base64 &#x3D; new Base64();\nfinal String text &#x3D; &quot;JavaæŠ€æœ¯&quot;;\nfinal byte[] textByte &#x3D; text.getBytes(&quot;UTF-8&quot;);\n\n&#x2F;&#x2F;ç¼–ç \nfinal String encodedText &#x3D; base64.encodeToString(textByte);\nSystem.out.println(encodedText);\n\n&#x2F;&#x2F;è§£ç \nSystem.out.println(new String(base64.decode(encodedText), &quot;UTF-8&quot;));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä»¥ä¸Šçš„ç¨‹å¼ç çœ‹èµ·æ¥åˆæ¯”æ—©æœŸç”¨sun.mis cå¥—ä»¶è¿˜è¦æ›´ç²¾ç®€ï¼Œæ•ˆèƒ½å®é™…æ‰§è¡Œèµ·æ¥ä¹Ÿå¿«äº†ä¸å°‘ã€‚ç¼ºç‚¹æ˜¯éœ€è¦å¼•ç”¨Apache Commons Codecï¼Œå¾ˆéº»çƒ¦ã€‚</p>\n<h4 id=\"Java-8ä¹‹åçš„ä½œæ³•\"><a href=\"#Java-8ä¹‹åçš„ä½œæ³•\" class=\"headerlink\" title=\"Java 8ä¹‹åçš„ä½œæ³•\"></a>Java 8ä¹‹åçš„ä½œæ³•</h4><p>Java 8çš„java.utilå¥—ä»¶ä¸­ï¼Œæ–°å¢äº†Base64çš„ç±»åˆ«ï¼Œå¯ä»¥ç”¨æ¥å¤„ç†Base64çš„ç¼–ç ä¸è§£ç ï¼Œç”¨æ³•å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">final Base64.Decoder decoder &#x3D; Base64.getDecoder();\nfinal Base64.Encoder encoder &#x3D; Base64.getEncoder();\nfinal String text &#x3D; &quot;JavaæŠ€æœ¯&quot;;\nfinal byte[] textByte &#x3D; text.getBytes(&quot;UTF-8&quot;);\n\n&#x2F;&#x2F;ç¼–ç \nfinal String encodedText &#x3D; encoder.encodeToString(textByte);\nSystem.out.println(encodedText);\n\n&#x2F;&#x2F;è§£ç \nSystem.out.println(new String(decoder.decode(encodedText), &quot;UTF-8&quot;));\n\nfinal Base64.Decoder decoder &#x3D; Base64.getDecoder();\nfinal Base64.Encoder encoder &#x3D; Base64.getEncoder();\nfinal String text &#x3D; &quot;JavaæŠ€æœ¯&quot;;\nfinal byte[] textByte &#x3D; text.getBytes(&quot;UTF-8&quot;);\n\n&#x2F;&#x2F;ç¼–ç \nfinal String encodedText &#x3D; encoder.encodeToString(textByte);\nSystem.out.println(encodedText);\n\n&#x2F;&#x2F;è§£ç \nSystem.out.println(new String(decoder.decode(encodedText), &quot;UTF-8&quot;));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n<p>ä¸sun.mis cå¥—ä»¶å’ŒApache Commons Codecæ‰€æä¾›çš„Base64ç¼–è§£ç å™¨æ¥æ¯”è¾ƒçš„è¯ï¼ŒJava 8æä¾›çš„Base64æ‹¥æœ‰æ›´å¥½çš„æ•ˆèƒ½ã€‚å®é™…æµ‹è¯•ç¼–ç ä¸è§£ç é€Ÿåº¦çš„è¯ï¼ŒJava 8æä¾›çš„Base64ï¼Œè¦æ¯”sun.mis cå¥—ä»¶æä¾›çš„è¿˜è¦å¿«è‡³å°‘11å€ï¼Œæ¯”Apache Commons Codecæä¾›çš„è¿˜è¦å¿«è‡³å°‘3å€ã€‚<strong>å› æ­¤åœ¨Javaä¸Šè‹¥è¦ä½¿ç”¨Base64ï¼Œè¿™ä¸ªJava 8åº•ä¸‹çš„java .utilå¥—ä»¶æ‰€æä¾›çš„Base64ç±»åˆ«ç»å¯¹æ˜¯é¦–é€‰ï¼</strong></p>\n"},{"title":"Java ä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹è½¬æ¢è¯¦è§£","date":"2025-10-14T06:42:34.000Z","_content":"\n![](http://img.javastack.cn/18-4-3/88886519.jpg)\n\nè¯´åŸºæœ¬æ•°æ®ç±»å‹è½¬æ¢ä¹‹å‰ï¼Œå…ˆäº†è§£ä¸‹ Java ä¸­çš„ 8 ç§åŸºæœ¬æ•°æ®ç±»å‹ï¼Œä»¥åŠå®ƒä»¬çš„å å†…å­˜çš„å®¹é‡å¤§å°å’Œè¡¨ç¤ºçš„èŒƒå›´ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\n\n![](http://img.javastack.cn/18-4-3/32808656.jpg)\n\nä¹‹å‰åˆ†äº«è¿‡ã€Š[æ·±å…¥æµ…å‡º Java ä¸­çš„åŒ…è£…ç±»](https://mp.weixin.qq.com/s/uoNVT9IoRQmWnmy8w22UUQ)ã€‹ï¼Œç°åœ¨é‡æ–°æ¸©æ•…äº†ä¸‹åŸå§‹æ•°æ®ç±»å‹ï¼Œç°åœ¨æ¥è§£é‡Šä¸‹å®ƒä»¬ä¹‹é—´çš„è½¬æ¢å…³ç³»ã€‚\n\n#### è‡ªåŠ¨ç±»å‹è½¬æ¢\n\nè‡ªåŠ¨ç±»å‹è½¬æ¢æ˜¯æŒ‡ï¼šæ•°å­—è¡¨ç¤ºèŒƒå›´å°çš„æ•°æ®ç±»å‹å¯ä»¥è‡ªåŠ¨è½¬æ¢æˆèŒƒå›´å¤§çš„æ•°æ®ç±»å‹ã€‚\n\nå¦‚ï¼š\n\n```\nlong l = 100;\n\nint i = 200;\nlong ll = i;\n```\n\nå…·ä½“è‡ªåŠ¨è½¬æ¢å¦‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\n\n![](http://img.javastack.cn/18-4-3/42423859.jpg)\n\nå®çº¿è¡¨ç¤ºè‡ªåŠ¨è½¬æ¢æ—¶ä¸ä¼šé€ æˆæ•°æ®ä¸¢å¤±ï¼Œè™šçº¿åˆ™å¯èƒ½ä¼šå‡ºç°æ•°æ®ä¸¢å¤±é—®é¢˜ã€‚\n\n**è‡ªåŠ¨è½¬æ¢ä¹Ÿè¦å°å¿ƒæ•°æ®æº¢å‡ºé—®é¢˜ï¼Œçœ‹ä¸‹é¢çš„ä¾‹å­ã€‚**\n\n```\nint count = 100000000;\nint price = 1999;\nlong totalPrice = count * price;\n```\n\nç¼–è¯‘æ²¡ä»»ä½•é—®é¢˜ï¼Œä½†ç»“æœå´è¾“å‡ºçš„æ˜¯è´Ÿæ•°ï¼Œè¿™æ˜¯å› ä¸ºä¸¤ä¸ª int ç›¸ä¹˜å¾—åˆ°çš„ç»“æœæ˜¯ int, ç›¸ä¹˜çš„ç»“æœè¶…å‡ºäº† int çš„ä»£è¡¨èŒƒå›´ã€‚è¿™ç§æƒ…å†µï¼Œä¸€èˆ¬æŠŠç¬¬ä¸€ä¸ªæ•°æ®è½¬æ¢æˆèŒƒå›´å¤§çš„æ•°æ®ç±»å‹å†å’Œå…¶ä»–çš„æ•°æ®è¿›è¡Œè¿ç®—ã€‚\n\n```\nint count = 100000000;\nint price = 1999;\nlong totalPrice = (long) count * price;\n```\n\nå¦å¤–ï¼Œå‘ä¸‹è½¬æ¢æ—¶å¯ä»¥ç›´æ¥å°† int å¸¸é‡å­—é¢é‡èµ‹å€¼ç»™ byteã€shortã€char ç­‰æ•°æ®ç±»å‹ï¼Œè€Œä¸éœ€è¦å¼ºåˆ¶è½¬æ¢ï¼Œåªè¦è¯¥å¸¸é‡å€¼ä¸è¶…è¿‡è¯¥ç±»å‹çš„è¡¨ç¤ºèŒƒå›´éƒ½èƒ½è‡ªåŠ¨è½¬æ¢ã€‚\n\n#### å¼ºåˆ¶ç±»å‹è½¬æ¢\n\nå¼ºåˆ¶ç±»å‹è½¬æ¢æˆ‘ä»¬å†æ¸…æ¥šä¸è¿‡äº†ï¼Œå³å¼ºåˆ¶æ˜¾ç¤ºçš„æŠŠä¸€ä¸ªæ•°æ®ç±»å‹è½¬æ¢ä¸ºå¦å¤–ä¸€ç§æ•°æ®ç±»å‹ã€‚\n\nå¦‚ï¼š\n\n```\nshort s = 199;\nint i = s;// 199\n\ndouble d = 10.24;\nlong ll = (long) d;// 10\n```\n\nä»¥ä¸Šçš„è½¬æ¢ç»“æœéƒ½åœ¨æˆ‘ä»¬çš„é¢„æœŸä¹‹å†…ï¼Œå±äºæ­£å¸¸çš„è½¬æ¢å’Œä¸¢å¤±ç²¾åº¦çš„æƒ…å†µï¼Œä¸‹é¢çš„ä¾‹å­å°±ä¸€æ ·å±äºæ•°æ®æº¢å‡ºçš„æƒ…å†µã€‚\n\n```\nint ii = 300;\nbyte b = (byte)ii;\n```\n\n300 å·²ç»è¶…å‡ºäº† byte ç±»å‹è¡¨ç¤ºçš„èŒƒå›´ï¼Œæ‰€ä»¥ä¼šè½¬æ¢æˆä¸€ä¸ªæ¯«æ— æ„ä¹‰çš„æ•°å­—ã€‚\n\n#### ç±»å‹æå‡\n\næ‰€è°“ç±»å‹æå‡å°±æ˜¯æŒ‡åœ¨å¤šç§ä¸åŒæ•°æ®ç±»å‹çš„è¡¨è¾¾å¼ä¸­ï¼Œç±»å‹ä¼šè‡ªåŠ¨å‘èŒƒå›´è¡¨ç¤ºå¤§çš„å€¼çš„æ•°æ®ç±»å‹æå‡ã€‚\n\næŠŠä¸Šé¢çš„æº¢å‡ºçš„ä¾‹å­å†æ”¹ä¸‹ã€‚\n\n```\nlong count = 100000000;\nint price = 1999;\nlong totalPrice = price * count;\n```\n\nprice ä¸º int å‹ï¼Œcount ä¸º long å‹ï¼Œè¿ç®—ç»“æœä¸º long å‹ï¼Œè¿ç®—ç»“æœæ­£å¸¸ï¼Œæ²¡æœ‰å‡ºç°æº¢å‡ºçš„æƒ…å†µã€‚\n\n","source":"_posts/åŸºç¡€/Java ä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹è½¬æ¢è¯¦è§£.md","raw":"---\ntitle: Java ä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹è½¬æ¢è¯¦è§£\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: åŸºç¡€\n---\n\n![](http://img.javastack.cn/18-4-3/88886519.jpg)\n\nè¯´åŸºæœ¬æ•°æ®ç±»å‹è½¬æ¢ä¹‹å‰ï¼Œå…ˆäº†è§£ä¸‹ Java ä¸­çš„ 8 ç§åŸºæœ¬æ•°æ®ç±»å‹ï¼Œä»¥åŠå®ƒä»¬çš„å å†…å­˜çš„å®¹é‡å¤§å°å’Œè¡¨ç¤ºçš„èŒƒå›´ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\n\n![](http://img.javastack.cn/18-4-3/32808656.jpg)\n\nä¹‹å‰åˆ†äº«è¿‡ã€Š[æ·±å…¥æµ…å‡º Java ä¸­çš„åŒ…è£…ç±»](https://mp.weixin.qq.com/s/uoNVT9IoRQmWnmy8w22UUQ)ã€‹ï¼Œç°åœ¨é‡æ–°æ¸©æ•…äº†ä¸‹åŸå§‹æ•°æ®ç±»å‹ï¼Œç°åœ¨æ¥è§£é‡Šä¸‹å®ƒä»¬ä¹‹é—´çš„è½¬æ¢å…³ç³»ã€‚\n\n#### è‡ªåŠ¨ç±»å‹è½¬æ¢\n\nè‡ªåŠ¨ç±»å‹è½¬æ¢æ˜¯æŒ‡ï¼šæ•°å­—è¡¨ç¤ºèŒƒå›´å°çš„æ•°æ®ç±»å‹å¯ä»¥è‡ªåŠ¨è½¬æ¢æˆèŒƒå›´å¤§çš„æ•°æ®ç±»å‹ã€‚\n\nå¦‚ï¼š\n\n```\nlong l = 100;\n\nint i = 200;\nlong ll = i;\n```\n\nå…·ä½“è‡ªåŠ¨è½¬æ¢å¦‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\n\n![](http://img.javastack.cn/18-4-3/42423859.jpg)\n\nå®çº¿è¡¨ç¤ºè‡ªåŠ¨è½¬æ¢æ—¶ä¸ä¼šé€ æˆæ•°æ®ä¸¢å¤±ï¼Œè™šçº¿åˆ™å¯èƒ½ä¼šå‡ºç°æ•°æ®ä¸¢å¤±é—®é¢˜ã€‚\n\n**è‡ªåŠ¨è½¬æ¢ä¹Ÿè¦å°å¿ƒæ•°æ®æº¢å‡ºé—®é¢˜ï¼Œçœ‹ä¸‹é¢çš„ä¾‹å­ã€‚**\n\n```\nint count = 100000000;\nint price = 1999;\nlong totalPrice = count * price;\n```\n\nç¼–è¯‘æ²¡ä»»ä½•é—®é¢˜ï¼Œä½†ç»“æœå´è¾“å‡ºçš„æ˜¯è´Ÿæ•°ï¼Œè¿™æ˜¯å› ä¸ºä¸¤ä¸ª int ç›¸ä¹˜å¾—åˆ°çš„ç»“æœæ˜¯ int, ç›¸ä¹˜çš„ç»“æœè¶…å‡ºäº† int çš„ä»£è¡¨èŒƒå›´ã€‚è¿™ç§æƒ…å†µï¼Œä¸€èˆ¬æŠŠç¬¬ä¸€ä¸ªæ•°æ®è½¬æ¢æˆèŒƒå›´å¤§çš„æ•°æ®ç±»å‹å†å’Œå…¶ä»–çš„æ•°æ®è¿›è¡Œè¿ç®—ã€‚\n\n```\nint count = 100000000;\nint price = 1999;\nlong totalPrice = (long) count * price;\n```\n\nå¦å¤–ï¼Œå‘ä¸‹è½¬æ¢æ—¶å¯ä»¥ç›´æ¥å°† int å¸¸é‡å­—é¢é‡èµ‹å€¼ç»™ byteã€shortã€char ç­‰æ•°æ®ç±»å‹ï¼Œè€Œä¸éœ€è¦å¼ºåˆ¶è½¬æ¢ï¼Œåªè¦è¯¥å¸¸é‡å€¼ä¸è¶…è¿‡è¯¥ç±»å‹çš„è¡¨ç¤ºèŒƒå›´éƒ½èƒ½è‡ªåŠ¨è½¬æ¢ã€‚\n\n#### å¼ºåˆ¶ç±»å‹è½¬æ¢\n\nå¼ºåˆ¶ç±»å‹è½¬æ¢æˆ‘ä»¬å†æ¸…æ¥šä¸è¿‡äº†ï¼Œå³å¼ºåˆ¶æ˜¾ç¤ºçš„æŠŠä¸€ä¸ªæ•°æ®ç±»å‹è½¬æ¢ä¸ºå¦å¤–ä¸€ç§æ•°æ®ç±»å‹ã€‚\n\nå¦‚ï¼š\n\n```\nshort s = 199;\nint i = s;// 199\n\ndouble d = 10.24;\nlong ll = (long) d;// 10\n```\n\nä»¥ä¸Šçš„è½¬æ¢ç»“æœéƒ½åœ¨æˆ‘ä»¬çš„é¢„æœŸä¹‹å†…ï¼Œå±äºæ­£å¸¸çš„è½¬æ¢å’Œä¸¢å¤±ç²¾åº¦çš„æƒ…å†µï¼Œä¸‹é¢çš„ä¾‹å­å°±ä¸€æ ·å±äºæ•°æ®æº¢å‡ºçš„æƒ…å†µã€‚\n\n```\nint ii = 300;\nbyte b = (byte)ii;\n```\n\n300 å·²ç»è¶…å‡ºäº† byte ç±»å‹è¡¨ç¤ºçš„èŒƒå›´ï¼Œæ‰€ä»¥ä¼šè½¬æ¢æˆä¸€ä¸ªæ¯«æ— æ„ä¹‰çš„æ•°å­—ã€‚\n\n#### ç±»å‹æå‡\n\næ‰€è°“ç±»å‹æå‡å°±æ˜¯æŒ‡åœ¨å¤šç§ä¸åŒæ•°æ®ç±»å‹çš„è¡¨è¾¾å¼ä¸­ï¼Œç±»å‹ä¼šè‡ªåŠ¨å‘èŒƒå›´è¡¨ç¤ºå¤§çš„å€¼çš„æ•°æ®ç±»å‹æå‡ã€‚\n\næŠŠä¸Šé¢çš„æº¢å‡ºçš„ä¾‹å­å†æ”¹ä¸‹ã€‚\n\n```\nlong count = 100000000;\nint price = 1999;\nlong totalPrice = price * count;\n```\n\nprice ä¸º int å‹ï¼Œcount ä¸º long å‹ï¼Œè¿ç®—ç»“æœä¸º long å‹ï¼Œè¿ç®—ç»“æœæ­£å¸¸ï¼Œæ²¡æœ‰å‡ºç°æº¢å‡ºçš„æƒ…å†µã€‚\n\n","slug":"åŸºç¡€/Java ä¸­çš„åŸºæœ¬æ•°æ®ç±»å‹è½¬æ¢è¯¦è§£","published":1,"updated":"2025-10-15T07:19:51.795Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076t003dqkd4alg39ec5","content":"<p><img src=\"http://img.javastack.cn/18-4-3/88886519.jpg\"></p>\n<p>è¯´åŸºæœ¬æ•°æ®ç±»å‹è½¬æ¢ä¹‹å‰ï¼Œå…ˆäº†è§£ä¸‹ Java ä¸­çš„ 8 ç§åŸºæœ¬æ•°æ®ç±»å‹ï¼Œä»¥åŠå®ƒä»¬çš„å å†…å­˜çš„å®¹é‡å¤§å°å’Œè¡¨ç¤ºçš„èŒƒå›´ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>\n<p><img src=\"http://img.javastack.cn/18-4-3/32808656.jpg\"></p>\n<p>ä¹‹å‰åˆ†äº«è¿‡ã€Š<a href=\"https://mp.weixin.qq.com/s/uoNVT9IoRQmWnmy8w22UUQ\">æ·±å…¥æµ…å‡º Java ä¸­çš„åŒ…è£…ç±»</a>ã€‹ï¼Œç°åœ¨é‡æ–°æ¸©æ•…äº†ä¸‹åŸå§‹æ•°æ®ç±»å‹ï¼Œç°åœ¨æ¥è§£é‡Šä¸‹å®ƒä»¬ä¹‹é—´çš„è½¬æ¢å…³ç³»ã€‚</p>\n<h4 id=\"è‡ªåŠ¨ç±»å‹è½¬æ¢\"><a href=\"#è‡ªåŠ¨ç±»å‹è½¬æ¢\" class=\"headerlink\" title=\"è‡ªåŠ¨ç±»å‹è½¬æ¢\"></a>è‡ªåŠ¨ç±»å‹è½¬æ¢</h4><p>è‡ªåŠ¨ç±»å‹è½¬æ¢æ˜¯æŒ‡ï¼šæ•°å­—è¡¨ç¤ºèŒƒå›´å°çš„æ•°æ®ç±»å‹å¯ä»¥è‡ªåŠ¨è½¬æ¢æˆèŒƒå›´å¤§çš„æ•°æ®ç±»å‹ã€‚</p>\n<p>å¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">long l &#x3D; 100;\n\nint i &#x3D; 200;\nlong ll &#x3D; i;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å…·ä½“è‡ªåŠ¨è½¬æ¢å¦‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>\n<p><img src=\"http://img.javastack.cn/18-4-3/42423859.jpg\"></p>\n<p>å®çº¿è¡¨ç¤ºè‡ªåŠ¨è½¬æ¢æ—¶ä¸ä¼šé€ æˆæ•°æ®ä¸¢å¤±ï¼Œè™šçº¿åˆ™å¯èƒ½ä¼šå‡ºç°æ•°æ®ä¸¢å¤±é—®é¢˜ã€‚</p>\n<p><strong>è‡ªåŠ¨è½¬æ¢ä¹Ÿè¦å°å¿ƒæ•°æ®æº¢å‡ºé—®é¢˜ï¼Œçœ‹ä¸‹é¢çš„ä¾‹å­ã€‚</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">int count &#x3D; 100000000;\nint price &#x3D; 1999;\nlong totalPrice &#x3D; count * price;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¼–è¯‘æ²¡ä»»ä½•é—®é¢˜ï¼Œä½†ç»“æœå´è¾“å‡ºçš„æ˜¯è´Ÿæ•°ï¼Œè¿™æ˜¯å› ä¸ºä¸¤ä¸ª int ç›¸ä¹˜å¾—åˆ°çš„ç»“æœæ˜¯ int, ç›¸ä¹˜çš„ç»“æœè¶…å‡ºäº† int çš„ä»£è¡¨èŒƒå›´ã€‚è¿™ç§æƒ…å†µï¼Œä¸€èˆ¬æŠŠç¬¬ä¸€ä¸ªæ•°æ®è½¬æ¢æˆèŒƒå›´å¤§çš„æ•°æ®ç±»å‹å†å’Œå…¶ä»–çš„æ•°æ®è¿›è¡Œè¿ç®—ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">int count &#x3D; 100000000;\nint price &#x3D; 1999;\nlong totalPrice &#x3D; (long) count * price;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>å¦å¤–ï¼Œå‘ä¸‹è½¬æ¢æ—¶å¯ä»¥ç›´æ¥å°† int å¸¸é‡å­—é¢é‡èµ‹å€¼ç»™ byteã€shortã€char ç­‰æ•°æ®ç±»å‹ï¼Œè€Œä¸éœ€è¦å¼ºåˆ¶è½¬æ¢ï¼Œåªè¦è¯¥å¸¸é‡å€¼ä¸è¶…è¿‡è¯¥ç±»å‹çš„è¡¨ç¤ºèŒƒå›´éƒ½èƒ½è‡ªåŠ¨è½¬æ¢ã€‚</p>\n<h4 id=\"å¼ºåˆ¶ç±»å‹è½¬æ¢\"><a href=\"#å¼ºåˆ¶ç±»å‹è½¬æ¢\" class=\"headerlink\" title=\"å¼ºåˆ¶ç±»å‹è½¬æ¢\"></a>å¼ºåˆ¶ç±»å‹è½¬æ¢</h4><p>å¼ºåˆ¶ç±»å‹è½¬æ¢æˆ‘ä»¬å†æ¸…æ¥šä¸è¿‡äº†ï¼Œå³å¼ºåˆ¶æ˜¾ç¤ºçš„æŠŠä¸€ä¸ªæ•°æ®ç±»å‹è½¬æ¢ä¸ºå¦å¤–ä¸€ç§æ•°æ®ç±»å‹ã€‚</p>\n<p>å¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">short s &#x3D; 199;\nint i &#x3D; s;&#x2F;&#x2F; 199\n\ndouble d &#x3D; 10.24;\nlong ll &#x3D; (long) d;&#x2F;&#x2F; 10<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä»¥ä¸Šçš„è½¬æ¢ç»“æœéƒ½åœ¨æˆ‘ä»¬çš„é¢„æœŸä¹‹å†…ï¼Œå±äºæ­£å¸¸çš„è½¬æ¢å’Œä¸¢å¤±ç²¾åº¦çš„æƒ…å†µï¼Œä¸‹é¢çš„ä¾‹å­å°±ä¸€æ ·å±äºæ•°æ®æº¢å‡ºçš„æƒ…å†µã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">int ii &#x3D; 300;\nbyte b &#x3D; (byte)ii;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>300 å·²ç»è¶…å‡ºäº† byte ç±»å‹è¡¨ç¤ºçš„èŒƒå›´ï¼Œæ‰€ä»¥ä¼šè½¬æ¢æˆä¸€ä¸ªæ¯«æ— æ„ä¹‰çš„æ•°å­—ã€‚</p>\n<h4 id=\"ç±»å‹æå‡\"><a href=\"#ç±»å‹æå‡\" class=\"headerlink\" title=\"ç±»å‹æå‡\"></a>ç±»å‹æå‡</h4><p>æ‰€è°“ç±»å‹æå‡å°±æ˜¯æŒ‡åœ¨å¤šç§ä¸åŒæ•°æ®ç±»å‹çš„è¡¨è¾¾å¼ä¸­ï¼Œç±»å‹ä¼šè‡ªåŠ¨å‘èŒƒå›´è¡¨ç¤ºå¤§çš„å€¼çš„æ•°æ®ç±»å‹æå‡ã€‚</p>\n<p>æŠŠä¸Šé¢çš„æº¢å‡ºçš„ä¾‹å­å†æ”¹ä¸‹ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">long count &#x3D; 100000000;\nint price &#x3D; 1999;\nlong totalPrice &#x3D; price * count;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>price ä¸º int å‹ï¼Œcount ä¸º long å‹ï¼Œè¿ç®—ç»“æœä¸º long å‹ï¼Œè¿ç®—ç»“æœæ­£å¸¸ï¼Œæ²¡æœ‰å‡ºç°æº¢å‡ºçš„æƒ…å†µã€‚</p>\n","excerpt":"","more":"<p><img src=\"http://img.javastack.cn/18-4-3/88886519.jpg\"></p>\n<p>è¯´åŸºæœ¬æ•°æ®ç±»å‹è½¬æ¢ä¹‹å‰ï¼Œå…ˆäº†è§£ä¸‹ Java ä¸­çš„ 8 ç§åŸºæœ¬æ•°æ®ç±»å‹ï¼Œä»¥åŠå®ƒä»¬çš„å å†…å­˜çš„å®¹é‡å¤§å°å’Œè¡¨ç¤ºçš„èŒƒå›´ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>\n<p><img src=\"http://img.javastack.cn/18-4-3/32808656.jpg\"></p>\n<p>ä¹‹å‰åˆ†äº«è¿‡ã€Š<a href=\"https://mp.weixin.qq.com/s/uoNVT9IoRQmWnmy8w22UUQ\">æ·±å…¥æµ…å‡º Java ä¸­çš„åŒ…è£…ç±»</a>ã€‹ï¼Œç°åœ¨é‡æ–°æ¸©æ•…äº†ä¸‹åŸå§‹æ•°æ®ç±»å‹ï¼Œç°åœ¨æ¥è§£é‡Šä¸‹å®ƒä»¬ä¹‹é—´çš„è½¬æ¢å…³ç³»ã€‚</p>\n<h4 id=\"è‡ªåŠ¨ç±»å‹è½¬æ¢\"><a href=\"#è‡ªåŠ¨ç±»å‹è½¬æ¢\" class=\"headerlink\" title=\"è‡ªåŠ¨ç±»å‹è½¬æ¢\"></a>è‡ªåŠ¨ç±»å‹è½¬æ¢</h4><p>è‡ªåŠ¨ç±»å‹è½¬æ¢æ˜¯æŒ‡ï¼šæ•°å­—è¡¨ç¤ºèŒƒå›´å°çš„æ•°æ®ç±»å‹å¯ä»¥è‡ªåŠ¨è½¬æ¢æˆèŒƒå›´å¤§çš„æ•°æ®ç±»å‹ã€‚</p>\n<p>å¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">long l &#x3D; 100;\n\nint i &#x3D; 200;\nlong ll &#x3D; i;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å…·ä½“è‡ªåŠ¨è½¬æ¢å¦‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>\n<p><img src=\"http://img.javastack.cn/18-4-3/42423859.jpg\"></p>\n<p>å®çº¿è¡¨ç¤ºè‡ªåŠ¨è½¬æ¢æ—¶ä¸ä¼šé€ æˆæ•°æ®ä¸¢å¤±ï¼Œè™šçº¿åˆ™å¯èƒ½ä¼šå‡ºç°æ•°æ®ä¸¢å¤±é—®é¢˜ã€‚</p>\n<p><strong>è‡ªåŠ¨è½¬æ¢ä¹Ÿè¦å°å¿ƒæ•°æ®æº¢å‡ºé—®é¢˜ï¼Œçœ‹ä¸‹é¢çš„ä¾‹å­ã€‚</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">int count &#x3D; 100000000;\nint price &#x3D; 1999;\nlong totalPrice &#x3D; count * price;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¼–è¯‘æ²¡ä»»ä½•é—®é¢˜ï¼Œä½†ç»“æœå´è¾“å‡ºçš„æ˜¯è´Ÿæ•°ï¼Œè¿™æ˜¯å› ä¸ºä¸¤ä¸ª int ç›¸ä¹˜å¾—åˆ°çš„ç»“æœæ˜¯ int, ç›¸ä¹˜çš„ç»“æœè¶…å‡ºäº† int çš„ä»£è¡¨èŒƒå›´ã€‚è¿™ç§æƒ…å†µï¼Œä¸€èˆ¬æŠŠç¬¬ä¸€ä¸ªæ•°æ®è½¬æ¢æˆèŒƒå›´å¤§çš„æ•°æ®ç±»å‹å†å’Œå…¶ä»–çš„æ•°æ®è¿›è¡Œè¿ç®—ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">int count &#x3D; 100000000;\nint price &#x3D; 1999;\nlong totalPrice &#x3D; (long) count * price;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>å¦å¤–ï¼Œå‘ä¸‹è½¬æ¢æ—¶å¯ä»¥ç›´æ¥å°† int å¸¸é‡å­—é¢é‡èµ‹å€¼ç»™ byteã€shortã€char ç­‰æ•°æ®ç±»å‹ï¼Œè€Œä¸éœ€è¦å¼ºåˆ¶è½¬æ¢ï¼Œåªè¦è¯¥å¸¸é‡å€¼ä¸è¶…è¿‡è¯¥ç±»å‹çš„è¡¨ç¤ºèŒƒå›´éƒ½èƒ½è‡ªåŠ¨è½¬æ¢ã€‚</p>\n<h4 id=\"å¼ºåˆ¶ç±»å‹è½¬æ¢\"><a href=\"#å¼ºåˆ¶ç±»å‹è½¬æ¢\" class=\"headerlink\" title=\"å¼ºåˆ¶ç±»å‹è½¬æ¢\"></a>å¼ºåˆ¶ç±»å‹è½¬æ¢</h4><p>å¼ºåˆ¶ç±»å‹è½¬æ¢æˆ‘ä»¬å†æ¸…æ¥šä¸è¿‡äº†ï¼Œå³å¼ºåˆ¶æ˜¾ç¤ºçš„æŠŠä¸€ä¸ªæ•°æ®ç±»å‹è½¬æ¢ä¸ºå¦å¤–ä¸€ç§æ•°æ®ç±»å‹ã€‚</p>\n<p>å¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">short s &#x3D; 199;\nint i &#x3D; s;&#x2F;&#x2F; 199\n\ndouble d &#x3D; 10.24;\nlong ll &#x3D; (long) d;&#x2F;&#x2F; 10<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä»¥ä¸Šçš„è½¬æ¢ç»“æœéƒ½åœ¨æˆ‘ä»¬çš„é¢„æœŸä¹‹å†…ï¼Œå±äºæ­£å¸¸çš„è½¬æ¢å’Œä¸¢å¤±ç²¾åº¦çš„æƒ…å†µï¼Œä¸‹é¢çš„ä¾‹å­å°±ä¸€æ ·å±äºæ•°æ®æº¢å‡ºçš„æƒ…å†µã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">int ii &#x3D; 300;\nbyte b &#x3D; (byte)ii;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>300 å·²ç»è¶…å‡ºäº† byte ç±»å‹è¡¨ç¤ºçš„èŒƒå›´ï¼Œæ‰€ä»¥ä¼šè½¬æ¢æˆä¸€ä¸ªæ¯«æ— æ„ä¹‰çš„æ•°å­—ã€‚</p>\n<h4 id=\"ç±»å‹æå‡\"><a href=\"#ç±»å‹æå‡\" class=\"headerlink\" title=\"ç±»å‹æå‡\"></a>ç±»å‹æå‡</h4><p>æ‰€è°“ç±»å‹æå‡å°±æ˜¯æŒ‡åœ¨å¤šç§ä¸åŒæ•°æ®ç±»å‹çš„è¡¨è¾¾å¼ä¸­ï¼Œç±»å‹ä¼šè‡ªåŠ¨å‘èŒƒå›´è¡¨ç¤ºå¤§çš„å€¼çš„æ•°æ®ç±»å‹æå‡ã€‚</p>\n<p>æŠŠä¸Šé¢çš„æº¢å‡ºçš„ä¾‹å­å†æ”¹ä¸‹ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">long count &#x3D; 100000000;\nint price &#x3D; 1999;\nlong totalPrice &#x3D; price * count;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>price ä¸º int å‹ï¼Œcount ä¸º long å‹ï¼Œè¿ç®—ç»“æœä¸º long å‹ï¼Œè¿ç®—ç»“æœæ­£å¸¸ï¼Œæ²¡æœ‰å‡ºç°æº¢å‡ºçš„æƒ…å†µã€‚</p>\n"},{"title":"Java JaråŒ…å‹ç¼©ã€è§£å‹ä½¿ç”¨æŒ‡å—","date":"2025-10-14T06:42:34.000Z","_content":"\n![](http://img.javastack.cn/18-2-27/79692618.jpg)\n\n#### ä»€ä¹ˆæ˜¯jaråŒ…\n\nJARï¼ˆJava Archiveï¼‰æ˜¯Javaçš„å½’æ¡£æ–‡ä»¶ï¼Œå®ƒæ˜¯ä¸€ç§ä¸å¹³å°æ— å…³çš„æ–‡ä»¶æ ¼å¼ï¼Œå®ƒå…è®¸å°†è®¸å¤šæ–‡ä»¶ç»„åˆæˆä¸€ä¸ªå‹ç¼©æ–‡ä»¶ã€‚\n\n#### å¦‚ä½•æ‰“/è§£åŒ…\n\nä½¿ç”¨jdk/bin/jar.exeå·¥å…·ï¼Œé…ç½®å®Œç¯å¢ƒå˜é‡åç›´æ¥ä½¿å¾—jarå‘½ä»¤å³å¯ã€‚\n\n#### jarå‘½ä»¤æ ¼å¼\n\njar {c t x u f }[ v m e 0 M i ][-C ç›®å½•]æ–‡ä»¶å...\n \n{ctxu}ï¼Œè¿™å››ä¸ªå‚æ•°å¿…é¡»é€‰é€‰å…¶ä¸€ã€‚\n\n[v f m e 0 M i]ï¼Œè¿™å‡ ä¸ªæ˜¯å¯é€‰å‚æ•°ï¼Œæ–‡ä»¶åä¹Ÿæ˜¯å¿…é¡»çš„ã€‚\n\nå‚æ•° | è¯´æ˜\n---|---\n-c | åˆ›å»ºä¸€ä¸ªjaråŒ…\n-t | æ˜¾ç¤ºjarä¸­çš„å†…å®¹åˆ—è¡¨\n-x | è§£å‹jaråŒ…\n-u | æ·»åŠ æ–‡ä»¶åˆ°jaråŒ…ä¸­\n-f | æŒ‡å®šjaråŒ…çš„æ–‡ä»¶å\n-v | è¾“å‡ºè¯¦ç»†æŠ¥å‘Š\n-m | æŒ‡å®šMANIFEST.MFæ–‡ä»¶\n-0 | ç”ŸæˆjaråŒ…æ—¶ä¸å‹ç¼©å†…å®¹\n-M | ä¸ç”Ÿæˆæ¸…å•æ–‡ä»¶MANIFEST.MF\n-i | ä¸ºæŒ‡å®šçš„jaræ–‡ä»¶åˆ›å»ºç´¢å¼•æ–‡ä»¶\n-C | å¯åœ¨ç›¸åº”çš„ç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤\n\nå…³äºMANIFEST.MFå®šä¹‰ï¼š\n> https://baike.baidu.com/item/MANIFEST.MF\n\n#### æ¼”ç¤º\n\n**å¾€jaråŒ…æ·»åŠ æ–‡ä»¶**\n\n> jar uf xxx.jar BOOT-INF/classes/application.yml\n\n**è§£å‹jaråŒ…**\n\n> jar -xvf xxx.jar\n\n**æ‰“jaråŒ…ï¼Œä¸ç”Ÿæˆæ¸…å•æ–‡ä»¶ï¼Œä¸å‹ç¼©**\n\n> jar -cvfM0 xxx.jar BOOT-INF/ META-INF/ org/\n\næˆ–è€…\n\n> jar -cvfM0 xxx.jar *\n\nå¦‚æœè¦å¾€çº¿ä¸ŠjaråŒ…æ·»åŠ ã€æ›´æ–°éƒ¨åˆ†æ–‡ä»¶åˆ°jaråŒ…ï¼Œè¿™äº›å‘½ä»¤ä¹Ÿè®¸å¯¹ä½ æœ‰ç”¨ã€‚\n","source":"_posts/åŸºç¡€/Java JaråŒ…å‹ç¼©ã€è§£å‹ä½¿ç”¨æŒ‡å—.md","raw":"---\ntitle: Java JaråŒ…å‹ç¼©ã€è§£å‹ä½¿ç”¨æŒ‡å—\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\n---\n\n![](http://img.javastack.cn/18-2-27/79692618.jpg)\n\n#### ä»€ä¹ˆæ˜¯jaråŒ…\n\nJARï¼ˆJava Archiveï¼‰æ˜¯Javaçš„å½’æ¡£æ–‡ä»¶ï¼Œå®ƒæ˜¯ä¸€ç§ä¸å¹³å°æ— å…³çš„æ–‡ä»¶æ ¼å¼ï¼Œå®ƒå…è®¸å°†è®¸å¤šæ–‡ä»¶ç»„åˆæˆä¸€ä¸ªå‹ç¼©æ–‡ä»¶ã€‚\n\n#### å¦‚ä½•æ‰“/è§£åŒ…\n\nä½¿ç”¨jdk/bin/jar.exeå·¥å…·ï¼Œé…ç½®å®Œç¯å¢ƒå˜é‡åç›´æ¥ä½¿å¾—jarå‘½ä»¤å³å¯ã€‚\n\n#### jarå‘½ä»¤æ ¼å¼\n\njar {c t x u f }[ v m e 0 M i ][-C ç›®å½•]æ–‡ä»¶å...\n \n{ctxu}ï¼Œè¿™å››ä¸ªå‚æ•°å¿…é¡»é€‰é€‰å…¶ä¸€ã€‚\n\n[v f m e 0 M i]ï¼Œè¿™å‡ ä¸ªæ˜¯å¯é€‰å‚æ•°ï¼Œæ–‡ä»¶åä¹Ÿæ˜¯å¿…é¡»çš„ã€‚\n\nå‚æ•° | è¯´æ˜\n---|---\n-c | åˆ›å»ºä¸€ä¸ªjaråŒ…\n-t | æ˜¾ç¤ºjarä¸­çš„å†…å®¹åˆ—è¡¨\n-x | è§£å‹jaråŒ…\n-u | æ·»åŠ æ–‡ä»¶åˆ°jaråŒ…ä¸­\n-f | æŒ‡å®šjaråŒ…çš„æ–‡ä»¶å\n-v | è¾“å‡ºè¯¦ç»†æŠ¥å‘Š\n-m | æŒ‡å®šMANIFEST.MFæ–‡ä»¶\n-0 | ç”ŸæˆjaråŒ…æ—¶ä¸å‹ç¼©å†…å®¹\n-M | ä¸ç”Ÿæˆæ¸…å•æ–‡ä»¶MANIFEST.MF\n-i | ä¸ºæŒ‡å®šçš„jaræ–‡ä»¶åˆ›å»ºç´¢å¼•æ–‡ä»¶\n-C | å¯åœ¨ç›¸åº”çš„ç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤\n\nå…³äºMANIFEST.MFå®šä¹‰ï¼š\n> https://baike.baidu.com/item/MANIFEST.MF\n\n#### æ¼”ç¤º\n\n**å¾€jaråŒ…æ·»åŠ æ–‡ä»¶**\n\n> jar uf xxx.jar BOOT-INF/classes/application.yml\n\n**è§£å‹jaråŒ…**\n\n> jar -xvf xxx.jar\n\n**æ‰“jaråŒ…ï¼Œä¸ç”Ÿæˆæ¸…å•æ–‡ä»¶ï¼Œä¸å‹ç¼©**\n\n> jar -cvfM0 xxx.jar BOOT-INF/ META-INF/ org/\n\næˆ–è€…\n\n> jar -cvfM0 xxx.jar *\n\nå¦‚æœè¦å¾€çº¿ä¸ŠjaråŒ…æ·»åŠ ã€æ›´æ–°éƒ¨åˆ†æ–‡ä»¶åˆ°jaråŒ…ï¼Œè¿™äº›å‘½ä»¤ä¹Ÿè®¸å¯¹ä½ æœ‰ç”¨ã€‚\n","slug":"åŸºç¡€/Java JaråŒ…å‹ç¼©ã€è§£å‹ä½¿ç”¨æŒ‡å—","published":1,"updated":"2025-10-15T07:13:51.265Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076t003gqkd4fn3f1uhe","content":"<p><img src=\"http://img.javastack.cn/18-2-27/79692618.jpg\"></p>\n<h4 id=\"ä»€ä¹ˆæ˜¯jaråŒ…\"><a href=\"#ä»€ä¹ˆæ˜¯jaråŒ…\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯jaråŒ…\"></a>ä»€ä¹ˆæ˜¯jaråŒ…</h4><p>JARï¼ˆJava Archiveï¼‰æ˜¯Javaçš„å½’æ¡£æ–‡ä»¶ï¼Œå®ƒæ˜¯ä¸€ç§ä¸å¹³å°æ— å…³çš„æ–‡ä»¶æ ¼å¼ï¼Œå®ƒå…è®¸å°†è®¸å¤šæ–‡ä»¶ç»„åˆæˆä¸€ä¸ªå‹ç¼©æ–‡ä»¶ã€‚</p>\n<h4 id=\"å¦‚ä½•æ‰“-è§£åŒ…\"><a href=\"#å¦‚ä½•æ‰“-è§£åŒ…\" class=\"headerlink\" title=\"å¦‚ä½•æ‰“&#x2F;è§£åŒ…\"></a>å¦‚ä½•æ‰“&#x2F;è§£åŒ…</h4><p>ä½¿ç”¨jdk&#x2F;bin&#x2F;jar.exeå·¥å…·ï¼Œé…ç½®å®Œç¯å¢ƒå˜é‡åç›´æ¥ä½¿å¾—jarå‘½ä»¤å³å¯ã€‚</p>\n<h4 id=\"jarå‘½ä»¤æ ¼å¼\"><a href=\"#jarå‘½ä»¤æ ¼å¼\" class=\"headerlink\" title=\"jarå‘½ä»¤æ ¼å¼\"></a>jarå‘½ä»¤æ ¼å¼</h4><p>jar {c t x u f }[ v m e 0 M i ][-C ç›®å½•]æ–‡ä»¶åâ€¦</p>\n<p>{ctxu}ï¼Œè¿™å››ä¸ªå‚æ•°å¿…é¡»é€‰é€‰å…¶ä¸€ã€‚</p>\n<p>[v f m e 0 M i]ï¼Œè¿™å‡ ä¸ªæ˜¯å¯é€‰å‚æ•°ï¼Œæ–‡ä»¶åä¹Ÿæ˜¯å¿…é¡»çš„ã€‚</p>\n<table>\n<thead>\n<tr>\n<th>å‚æ•°</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>-c</td>\n<td>åˆ›å»ºä¸€ä¸ªjaråŒ…</td>\n</tr>\n<tr>\n<td>-t</td>\n<td>æ˜¾ç¤ºjarä¸­çš„å†…å®¹åˆ—è¡¨</td>\n</tr>\n<tr>\n<td>-x</td>\n<td>è§£å‹jaråŒ…</td>\n</tr>\n<tr>\n<td>-u</td>\n<td>æ·»åŠ æ–‡ä»¶åˆ°jaråŒ…ä¸­</td>\n</tr>\n<tr>\n<td>-f</td>\n<td>æŒ‡å®šjaråŒ…çš„æ–‡ä»¶å</td>\n</tr>\n<tr>\n<td>-v</td>\n<td>è¾“å‡ºè¯¦ç»†æŠ¥å‘Š</td>\n</tr>\n<tr>\n<td>-m</td>\n<td>æŒ‡å®šMANIFEST.MFæ–‡ä»¶</td>\n</tr>\n<tr>\n<td>-0</td>\n<td>ç”ŸæˆjaråŒ…æ—¶ä¸å‹ç¼©å†…å®¹</td>\n</tr>\n<tr>\n<td>-M</td>\n<td>ä¸ç”Ÿæˆæ¸…å•æ–‡ä»¶MANIFEST.MF</td>\n</tr>\n<tr>\n<td>-i</td>\n<td>ä¸ºæŒ‡å®šçš„jaræ–‡ä»¶åˆ›å»ºç´¢å¼•æ–‡ä»¶</td>\n</tr>\n<tr>\n<td>-C</td>\n<td>å¯åœ¨ç›¸åº”çš„ç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤</td>\n</tr>\n</tbody></table>\n<p>å…³äºMANIFEST.MFå®šä¹‰ï¼š</p>\n<blockquote>\n<p><a href=\"https://baike.baidu.com/item/MANIFEST.MF\">https://baike.baidu.com/item/MANIFEST.MF</a></p>\n</blockquote>\n<h4 id=\"æ¼”ç¤º\"><a href=\"#æ¼”ç¤º\" class=\"headerlink\" title=\"æ¼”ç¤º\"></a>æ¼”ç¤º</h4><p><strong>å¾€jaråŒ…æ·»åŠ æ–‡ä»¶</strong></p>\n<blockquote>\n<p>jar uf xxx.jar BOOT-INF&#x2F;classes&#x2F;application.yml</p>\n</blockquote>\n<p><strong>è§£å‹jaråŒ…</strong></p>\n<blockquote>\n<p>jar -xvf xxx.jar</p>\n</blockquote>\n<p><strong>æ‰“jaråŒ…ï¼Œä¸ç”Ÿæˆæ¸…å•æ–‡ä»¶ï¼Œä¸å‹ç¼©</strong></p>\n<blockquote>\n<p>jar -cvfM0 xxx.jar BOOT-INF&#x2F; META-INF&#x2F; org&#x2F;</p>\n</blockquote>\n<p>æˆ–è€…</p>\n<blockquote>\n<p>jar -cvfM0 xxx.jar *</p>\n</blockquote>\n<p>å¦‚æœè¦å¾€çº¿ä¸ŠjaråŒ…æ·»åŠ ã€æ›´æ–°éƒ¨åˆ†æ–‡ä»¶åˆ°jaråŒ…ï¼Œè¿™äº›å‘½ä»¤ä¹Ÿè®¸å¯¹ä½ æœ‰ç”¨ã€‚</p>\n","excerpt":"","more":"<p><img src=\"http://img.javastack.cn/18-2-27/79692618.jpg\"></p>\n<h4 id=\"ä»€ä¹ˆæ˜¯jaråŒ…\"><a href=\"#ä»€ä¹ˆæ˜¯jaråŒ…\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯jaråŒ…\"></a>ä»€ä¹ˆæ˜¯jaråŒ…</h4><p>JARï¼ˆJava Archiveï¼‰æ˜¯Javaçš„å½’æ¡£æ–‡ä»¶ï¼Œå®ƒæ˜¯ä¸€ç§ä¸å¹³å°æ— å…³çš„æ–‡ä»¶æ ¼å¼ï¼Œå®ƒå…è®¸å°†è®¸å¤šæ–‡ä»¶ç»„åˆæˆä¸€ä¸ªå‹ç¼©æ–‡ä»¶ã€‚</p>\n<h4 id=\"å¦‚ä½•æ‰“-è§£åŒ…\"><a href=\"#å¦‚ä½•æ‰“-è§£åŒ…\" class=\"headerlink\" title=\"å¦‚ä½•æ‰“&#x2F;è§£åŒ…\"></a>å¦‚ä½•æ‰“&#x2F;è§£åŒ…</h4><p>ä½¿ç”¨jdk&#x2F;bin&#x2F;jar.exeå·¥å…·ï¼Œé…ç½®å®Œç¯å¢ƒå˜é‡åç›´æ¥ä½¿å¾—jarå‘½ä»¤å³å¯ã€‚</p>\n<h4 id=\"jarå‘½ä»¤æ ¼å¼\"><a href=\"#jarå‘½ä»¤æ ¼å¼\" class=\"headerlink\" title=\"jarå‘½ä»¤æ ¼å¼\"></a>jarå‘½ä»¤æ ¼å¼</h4><p>jar {c t x u f }[ v m e 0 M i ][-C ç›®å½•]æ–‡ä»¶åâ€¦</p>\n<p>{ctxu}ï¼Œè¿™å››ä¸ªå‚æ•°å¿…é¡»é€‰é€‰å…¶ä¸€ã€‚</p>\n<p>[v f m e 0 M i]ï¼Œè¿™å‡ ä¸ªæ˜¯å¯é€‰å‚æ•°ï¼Œæ–‡ä»¶åä¹Ÿæ˜¯å¿…é¡»çš„ã€‚</p>\n<table>\n<thead>\n<tr>\n<th>å‚æ•°</th>\n<th>è¯´æ˜</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>-c</td>\n<td>åˆ›å»ºä¸€ä¸ªjaråŒ…</td>\n</tr>\n<tr>\n<td>-t</td>\n<td>æ˜¾ç¤ºjarä¸­çš„å†…å®¹åˆ—è¡¨</td>\n</tr>\n<tr>\n<td>-x</td>\n<td>è§£å‹jaråŒ…</td>\n</tr>\n<tr>\n<td>-u</td>\n<td>æ·»åŠ æ–‡ä»¶åˆ°jaråŒ…ä¸­</td>\n</tr>\n<tr>\n<td>-f</td>\n<td>æŒ‡å®šjaråŒ…çš„æ–‡ä»¶å</td>\n</tr>\n<tr>\n<td>-v</td>\n<td>è¾“å‡ºè¯¦ç»†æŠ¥å‘Š</td>\n</tr>\n<tr>\n<td>-m</td>\n<td>æŒ‡å®šMANIFEST.MFæ–‡ä»¶</td>\n</tr>\n<tr>\n<td>-0</td>\n<td>ç”ŸæˆjaråŒ…æ—¶ä¸å‹ç¼©å†…å®¹</td>\n</tr>\n<tr>\n<td>-M</td>\n<td>ä¸ç”Ÿæˆæ¸…å•æ–‡ä»¶MANIFEST.MF</td>\n</tr>\n<tr>\n<td>-i</td>\n<td>ä¸ºæŒ‡å®šçš„jaræ–‡ä»¶åˆ›å»ºç´¢å¼•æ–‡ä»¶</td>\n</tr>\n<tr>\n<td>-C</td>\n<td>å¯åœ¨ç›¸åº”çš„ç›®å½•ä¸‹æ‰§è¡Œå‘½ä»¤</td>\n</tr>\n</tbody></table>\n<p>å…³äºMANIFEST.MFå®šä¹‰ï¼š</p>\n<blockquote>\n<p><a href=\"https://baike.baidu.com/item/MANIFEST.MF\">https://baike.baidu.com/item/MANIFEST.MF</a></p>\n</blockquote>\n<h4 id=\"æ¼”ç¤º\"><a href=\"#æ¼”ç¤º\" class=\"headerlink\" title=\"æ¼”ç¤º\"></a>æ¼”ç¤º</h4><p><strong>å¾€jaråŒ…æ·»åŠ æ–‡ä»¶</strong></p>\n<blockquote>\n<p>jar uf xxx.jar BOOT-INF&#x2F;classes&#x2F;application.yml</p>\n</blockquote>\n<p><strong>è§£å‹jaråŒ…</strong></p>\n<blockquote>\n<p>jar -xvf xxx.jar</p>\n</blockquote>\n<p><strong>æ‰“jaråŒ…ï¼Œä¸ç”Ÿæˆæ¸…å•æ–‡ä»¶ï¼Œä¸å‹ç¼©</strong></p>\n<blockquote>\n<p>jar -cvfM0 xxx.jar BOOT-INF&#x2F; META-INF&#x2F; org&#x2F;</p>\n</blockquote>\n<p>æˆ–è€…</p>\n<blockquote>\n<p>jar -cvfM0 xxx.jar *</p>\n</blockquote>\n<p>å¦‚æœè¦å¾€çº¿ä¸ŠjaråŒ…æ·»åŠ ã€æ›´æ–°éƒ¨åˆ†æ–‡ä»¶åˆ°jaråŒ…ï¼Œè¿™äº›å‘½ä»¤ä¹Ÿè®¸å¯¹ä½ æœ‰ç”¨ã€‚</p>\n"},{"title":"Java çˆ¶ç±»å¼ºåˆ¶è½¬æ¢å­ç±»åŸåˆ™","date":"2025-10-14T06:42:34.000Z","_content":"\n![image](http://img.javastack.cn/17-12-20/25802617.jpg)\n\næœ€è¿‘ï¼Œå¾®ä¿¡ç¾¤å‹åœ¨è®¨è®ºå­ç±»çˆ¶ç±»çš„è½¬æ¢é—®é¢˜ï¼Œå…¶å®ä¸éš¾ï¼Œç»™å¤§å®¶ç”¨å®ä¾‹æ¥è¯´æ˜ä¸€ä¸‹å°±å¾ˆæ˜äº†äº†ã€‚\n\næˆ‘ä»¬çŸ¥é“Javaä¸­å­ç±»è½¬æ¢æˆçˆ¶ç±»æ˜¯æ²¡æœ‰ä»»ä½•é—®é¢˜çš„ï¼Œé‚£çˆ¶ç±»å¯ä»¥è½¬æ¢æˆå­ç±»å—ï¼Ÿ\n\næ¥çœ‹ä¸‹é¢è¿™æ®µç¨‹åºï¼š\n\n```\npublic class TestObjectConvert {\n\n\tpublic static void main(String[] args) {\n\t\ttest1();\n\t\ttest2();\n\t}\n\n\tprivate static void test1() {\n\t\tFruit fruit1 = new Fruit();\n\t\tApple apple1 = new Apple();\n\t\tapple1 = (Apple) fruit1; // java.lang.ClassCastException\n\t}\n\n\tprivate static void test2() {\n\t\tFruit fruit1 = new Apple();\n\t\tApple apple1 = new Apple();\n\t\tapple1 = (Apple) fruit1;\n\t}\n\n\tstatic class Fruit {\n\n\t}\n\n\tstatic class Apple extends Fruit {\n\n\t}\n\n}\n```\n\nç»“æœæ˜¯ï¼š\n\n```\ntest1ï¼šæŠ¥ç±»è½¬å¼‚å¸¸ï¼›\ntest2ï¼šè½¬æ¢æ­£å¸¸ã€‚\n```\n\n**æ‰€ä»¥ï¼Œæƒ³è®©çˆ¶ç±»å¼ºåˆ¶è½¬æ¢æˆå­ç±»ï¼Œä¸æ˜¯æ²¡æœ‰å¯èƒ½ï¼Œé™¤éçˆ¶ç±»æ˜¯å­ç±»æ„é€ å‡ºæ¥çš„å®ä¾‹ï¼Œä¸ç„¶æ˜¯ä¸èƒ½å¼ºè½¬çš„ã€‚**\n\nä¸ºä»€ä¹ˆå‘¢ï¼Ÿ\n\nå¦‚ä¸Šä»£ç ï¼Œå¦‚æœçˆ¶ç±»å®ä¾‹å‡ºæ¥çš„å¯¹è±¡æ˜¯Orangeï¼ŒOrangeå½“ç„¶ä¸èƒ½å¼ºåˆ¶è½¬æˆAppleï¼Œæ‰€ä»¥è¯´çˆ¶ç±»åªæœ‰è¯¥å­ç±»å¯¹åº”çš„å®ä¾‹æ‰èƒ½å¼ºè½¬ã€‚\n\n\n","source":"_posts/åŸºç¡€/Java çˆ¶ç±»å¼ºåˆ¶è½¬æ¢å­ç±»åŸåˆ™.md","raw":"---\ntitle: Java çˆ¶ç±»å¼ºåˆ¶è½¬æ¢å­ç±»åŸåˆ™\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: åŸºç¡€\n---\n\n![image](http://img.javastack.cn/17-12-20/25802617.jpg)\n\næœ€è¿‘ï¼Œå¾®ä¿¡ç¾¤å‹åœ¨è®¨è®ºå­ç±»çˆ¶ç±»çš„è½¬æ¢é—®é¢˜ï¼Œå…¶å®ä¸éš¾ï¼Œç»™å¤§å®¶ç”¨å®ä¾‹æ¥è¯´æ˜ä¸€ä¸‹å°±å¾ˆæ˜äº†äº†ã€‚\n\næˆ‘ä»¬çŸ¥é“Javaä¸­å­ç±»è½¬æ¢æˆçˆ¶ç±»æ˜¯æ²¡æœ‰ä»»ä½•é—®é¢˜çš„ï¼Œé‚£çˆ¶ç±»å¯ä»¥è½¬æ¢æˆå­ç±»å—ï¼Ÿ\n\næ¥çœ‹ä¸‹é¢è¿™æ®µç¨‹åºï¼š\n\n```\npublic class TestObjectConvert {\n\n\tpublic static void main(String[] args) {\n\t\ttest1();\n\t\ttest2();\n\t}\n\n\tprivate static void test1() {\n\t\tFruit fruit1 = new Fruit();\n\t\tApple apple1 = new Apple();\n\t\tapple1 = (Apple) fruit1; // java.lang.ClassCastException\n\t}\n\n\tprivate static void test2() {\n\t\tFruit fruit1 = new Apple();\n\t\tApple apple1 = new Apple();\n\t\tapple1 = (Apple) fruit1;\n\t}\n\n\tstatic class Fruit {\n\n\t}\n\n\tstatic class Apple extends Fruit {\n\n\t}\n\n}\n```\n\nç»“æœæ˜¯ï¼š\n\n```\ntest1ï¼šæŠ¥ç±»è½¬å¼‚å¸¸ï¼›\ntest2ï¼šè½¬æ¢æ­£å¸¸ã€‚\n```\n\n**æ‰€ä»¥ï¼Œæƒ³è®©çˆ¶ç±»å¼ºåˆ¶è½¬æ¢æˆå­ç±»ï¼Œä¸æ˜¯æ²¡æœ‰å¯èƒ½ï¼Œé™¤éçˆ¶ç±»æ˜¯å­ç±»æ„é€ å‡ºæ¥çš„å®ä¾‹ï¼Œä¸ç„¶æ˜¯ä¸èƒ½å¼ºè½¬çš„ã€‚**\n\nä¸ºä»€ä¹ˆå‘¢ï¼Ÿ\n\nå¦‚ä¸Šä»£ç ï¼Œå¦‚æœçˆ¶ç±»å®ä¾‹å‡ºæ¥çš„å¯¹è±¡æ˜¯Orangeï¼ŒOrangeå½“ç„¶ä¸èƒ½å¼ºåˆ¶è½¬æˆAppleï¼Œæ‰€ä»¥è¯´çˆ¶ç±»åªæœ‰è¯¥å­ç±»å¯¹åº”çš„å®ä¾‹æ‰èƒ½å¼ºè½¬ã€‚\n\n\n","slug":"åŸºç¡€/Java çˆ¶ç±»å¼ºåˆ¶è½¬æ¢å­ç±»åŸåˆ™","published":1,"updated":"2025-10-15T07:19:51.800Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076u003jqkd49t6tc10h","content":"<p><img src=\"http://img.javastack.cn/17-12-20/25802617.jpg\" alt=\"image\"></p>\n<p>æœ€è¿‘ï¼Œå¾®ä¿¡ç¾¤å‹åœ¨è®¨è®ºå­ç±»çˆ¶ç±»çš„è½¬æ¢é—®é¢˜ï¼Œå…¶å®ä¸éš¾ï¼Œç»™å¤§å®¶ç”¨å®ä¾‹æ¥è¯´æ˜ä¸€ä¸‹å°±å¾ˆæ˜äº†äº†ã€‚</p>\n<p>æˆ‘ä»¬çŸ¥é“Javaä¸­å­ç±»è½¬æ¢æˆçˆ¶ç±»æ˜¯æ²¡æœ‰ä»»ä½•é—®é¢˜çš„ï¼Œé‚£çˆ¶ç±»å¯ä»¥è½¬æ¢æˆå­ç±»å—ï¼Ÿ</p>\n<p>æ¥çœ‹ä¸‹é¢è¿™æ®µç¨‹åºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class TestObjectConvert &#123;\n\n\tpublic static void main(String[] args) &#123;\n\t\ttest1();\n\t\ttest2();\n\t&#125;\n\n\tprivate static void test1() &#123;\n\t\tFruit fruit1 &#x3D; new Fruit();\n\t\tApple apple1 &#x3D; new Apple();\n\t\tapple1 &#x3D; (Apple) fruit1; &#x2F;&#x2F; java.lang.ClassCastException\n\t&#125;\n\n\tprivate static void test2() &#123;\n\t\tFruit fruit1 &#x3D; new Apple();\n\t\tApple apple1 &#x3D; new Apple();\n\t\tapple1 &#x3D; (Apple) fruit1;\n\t&#125;\n\n\tstatic class Fruit &#123;\n\n\t&#125;\n\n\tstatic class Apple extends Fruit &#123;\n\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç»“æœæ˜¯ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">test1ï¼šæŠ¥ç±»è½¬å¼‚å¸¸ï¼›\ntest2ï¼šè½¬æ¢æ­£å¸¸ã€‚<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p><strong>æ‰€ä»¥ï¼Œæƒ³è®©çˆ¶ç±»å¼ºåˆ¶è½¬æ¢æˆå­ç±»ï¼Œä¸æ˜¯æ²¡æœ‰å¯èƒ½ï¼Œé™¤éçˆ¶ç±»æ˜¯å­ç±»æ„é€ å‡ºæ¥çš„å®ä¾‹ï¼Œä¸ç„¶æ˜¯ä¸èƒ½å¼ºè½¬çš„ã€‚</strong></p>\n<p>ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p>\n<p>å¦‚ä¸Šä»£ç ï¼Œå¦‚æœçˆ¶ç±»å®ä¾‹å‡ºæ¥çš„å¯¹è±¡æ˜¯Orangeï¼ŒOrangeå½“ç„¶ä¸èƒ½å¼ºåˆ¶è½¬æˆAppleï¼Œæ‰€ä»¥è¯´çˆ¶ç±»åªæœ‰è¯¥å­ç±»å¯¹åº”çš„å®ä¾‹æ‰èƒ½å¼ºè½¬ã€‚</p>\n","excerpt":"","more":"<p><img src=\"http://img.javastack.cn/17-12-20/25802617.jpg\" alt=\"image\"></p>\n<p>æœ€è¿‘ï¼Œå¾®ä¿¡ç¾¤å‹åœ¨è®¨è®ºå­ç±»çˆ¶ç±»çš„è½¬æ¢é—®é¢˜ï¼Œå…¶å®ä¸éš¾ï¼Œç»™å¤§å®¶ç”¨å®ä¾‹æ¥è¯´æ˜ä¸€ä¸‹å°±å¾ˆæ˜äº†äº†ã€‚</p>\n<p>æˆ‘ä»¬çŸ¥é“Javaä¸­å­ç±»è½¬æ¢æˆçˆ¶ç±»æ˜¯æ²¡æœ‰ä»»ä½•é—®é¢˜çš„ï¼Œé‚£çˆ¶ç±»å¯ä»¥è½¬æ¢æˆå­ç±»å—ï¼Ÿ</p>\n<p>æ¥çœ‹ä¸‹é¢è¿™æ®µç¨‹åºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class TestObjectConvert &#123;\n\n\tpublic static void main(String[] args) &#123;\n\t\ttest1();\n\t\ttest2();\n\t&#125;\n\n\tprivate static void test1() &#123;\n\t\tFruit fruit1 &#x3D; new Fruit();\n\t\tApple apple1 &#x3D; new Apple();\n\t\tapple1 &#x3D; (Apple) fruit1; &#x2F;&#x2F; java.lang.ClassCastException\n\t&#125;\n\n\tprivate static void test2() &#123;\n\t\tFruit fruit1 &#x3D; new Apple();\n\t\tApple apple1 &#x3D; new Apple();\n\t\tapple1 &#x3D; (Apple) fruit1;\n\t&#125;\n\n\tstatic class Fruit &#123;\n\n\t&#125;\n\n\tstatic class Apple extends Fruit &#123;\n\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç»“æœæ˜¯ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">test1ï¼šæŠ¥ç±»è½¬å¼‚å¸¸ï¼›\ntest2ï¼šè½¬æ¢æ­£å¸¸ã€‚<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p><strong>æ‰€ä»¥ï¼Œæƒ³è®©çˆ¶ç±»å¼ºåˆ¶è½¬æ¢æˆå­ç±»ï¼Œä¸æ˜¯æ²¡æœ‰å¯èƒ½ï¼Œé™¤éçˆ¶ç±»æ˜¯å­ç±»æ„é€ å‡ºæ¥çš„å®ä¾‹ï¼Œä¸ç„¶æ˜¯ä¸èƒ½å¼ºè½¬çš„ã€‚</strong></p>\n<p>ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p>\n<p>å¦‚ä¸Šä»£ç ï¼Œå¦‚æœçˆ¶ç±»å®ä¾‹å‡ºæ¥çš„å¯¹è±¡æ˜¯Orangeï¼ŒOrangeå½“ç„¶ä¸èƒ½å¼ºåˆ¶è½¬æˆAppleï¼Œæ‰€ä»¥è¯´çˆ¶ç±»åªæœ‰è¯¥å­ç±»å¯¹åº”çš„å®ä¾‹æ‰èƒ½å¼ºè½¬ã€‚</p>\n"},{"title":"StringBuffer å’Œ StringBuilder çš„ 3 ä¸ªåŒºåˆ«","date":"2025-10-14T06:42:34.000Z","_content":"\nStringBuffer å’Œ StringBuilder å®ƒä»¬éƒ½æ˜¯å¯å˜çš„å­—ç¬¦ä¸²ï¼Œä¸è¿‡å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ Java åˆä¸­çº§é¢è¯•å‡ºç°å‡ ç‡ååˆ†é«˜çš„ä¸€é“é¢˜ã€‚è¿™ä¹ˆç®€å•çš„ä¸€é“é¢˜ï¼Œæ ˆé•¿åœ¨æœ€è¿‘çš„é¢è¯•è¿‡ç¨‹ä¸­ï¼Œå´ç»å¸¸é‡åˆ°å¾ˆå¤šæ±‚èŒè€…è¯´åï¼Œæä¸æ¸…ä½¿ç”¨åœºæ™¯çš„æƒ…å†µã€‚\n\nä»Šå¤©ï¼Œæ ˆé•¿æˆ‘å¸¦å¤§å®¶å½»åº•ææ‡‚ StringBuffer å’Œ StringBuilder çš„å‡ ä¸ªåŒºåˆ«å’Œå®ƒä»¬çš„åº”ç”¨åœºæ™¯ï¼Œå¦‚æœä½ æ˜¯å¤§ç‰›ï¼Œè¯·ç•¥è¿‡ï¼Œå¦‚æœä½ æ˜¯èœé¸Ÿï¼Œæˆ–è€…å¯¹è¿™ä¸¤ä¸ªä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œå¯ä»¥å­¦ä¹ ä¸€ä¸‹ï¼Œä¹Ÿå¯ä»¥ä¸ºå¹´åº•çš„é¢è¯•åŠ æ²¹å†²åˆºã€‚\n\nå…ˆçœ‹çœ‹ StringBuffer å’Œ StringBuilder çš„ç±»ç»“æ„å§ï¼š\n\n![](http://img.javastack.cn/18-12-29/23490736.jpg)\n\nå…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯ç»§æ‰¿äº†ä¸€ä¸ªæŠ½è±¡çš„å­—ç¬¦ä¸²çˆ¶ç±»ï¼š`AbstractStringBuilder`ã€‚ä¸‹é¢æˆ‘ä»¬å†æ¥çœ‹çœ‹å®ƒä»¬çš„ä¸‰ä¸ªåŒºåˆ«ã€‚\n\n## åŒºåˆ«1ï¼šçº¿ç¨‹å®‰å…¨\n\nStringBufferï¼šçº¿ç¨‹å®‰å…¨ï¼ŒStringBuilderï¼šçº¿ç¨‹ä¸å®‰å…¨ã€‚å› ä¸º StringBuffer çš„æ‰€æœ‰å…¬å¼€æ–¹æ³•éƒ½æ˜¯ synchronized ä¿®é¥°çš„ï¼Œè€Œ StringBuilder å¹¶æ²¡æœ‰ StringBuilder ä¿®é¥°ã€‚\n\n**StringBuffer ä»£ç ç‰‡æ®µï¼š**\n\n```\n@Override\npublic synchronized StringBuffer append(String str) {\n    toStringCache = null;\n    super.append(str);\n    return this;\n}\n```\n\n## åŒºåˆ«2ï¼šç¼“å†²åŒº\n\n**StringBuffer ä»£ç ç‰‡æ®µï¼š**\n\n```\nprivate transient char[] toStringCache;\n\n@Override\npublic synchronized String toString() {\n    if (toStringCache == null) {\n        toStringCache = Arrays.copyOfRange(value, 0, count);\n    }\n    return new String(toStringCache, true);\n}\n```\n\n**StringBuilder ä»£ç ç‰‡æ®µï¼š**\n\n```\n@Override\npublic String toString() {\n    // Create a copy, don't share the array\n    return new String(value, 0, count);\n}\n```\n\nå¯ä»¥çœ‹å‡ºï¼ŒStringBuffer æ¯æ¬¡è·å– toString éƒ½ä¼šç›´æ¥ä½¿ç”¨ç¼“å­˜åŒºçš„ toStringCache å€¼æ¥æ„é€ ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚\n\nè€Œ StringBuilder åˆ™æ¯æ¬¡éƒ½éœ€è¦å¤åˆ¶ä¸€æ¬¡å­—ç¬¦æ•°ç»„ï¼Œå†æ„é€ ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚\n\næ‰€ä»¥ï¼Œç¼“å­˜å†²è¿™ä¹Ÿæ˜¯å¯¹ StringBuffer çš„ä¸€ä¸ªä¼˜åŒ–å§ï¼Œä¸è¿‡ StringBuffer çš„è¿™ä¸ªtoString æ–¹æ³•ä»ç„¶æ˜¯åŒæ­¥çš„ã€‚\n\n## åŒºåˆ«3ï¼šæ€§èƒ½\n\næ—¢ç„¶ StringBuffer æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå®ƒçš„æ‰€æœ‰å…¬å¼€æ–¹æ³•éƒ½æ˜¯åŒæ­¥çš„ï¼ŒStringBuilder æ˜¯æ²¡æœ‰å¯¹æ–¹æ³•åŠ é”åŒæ­¥çš„ï¼Œæ‰€ä»¥æ¯«æ— ç–‘é—®ï¼ŒStringBuilder çš„æ€§èƒ½è¦è¿œå¤§äº StringBufferã€‚\n\n## æ€»ç»“\n\næ‰€ä»¥ï¼ŒStringBuffer é€‚ç”¨äºç”¨åœ¨å¤šçº¿ç¨‹æ“ä½œåŒä¸€ä¸ª StringBuffer çš„åœºæ™¯ï¼Œå¦‚æœæ˜¯å•çº¿ç¨‹åœºåˆ StringBuilder æ›´é€‚åˆã€‚\n\nä»¥æ­¤é€ç»™æ­£åœ¨é¢è¯•æˆ–è€…å³å°†å»é¢è¯•çš„ Java ç¨‹åºçŒ¿ä»¬ï¼Œå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ï¼Œä¹Ÿæ¬¢è¿åˆ†äº«ç»™èº«è¾¹çš„æœ‹å‹ä»¬ï¼Œè®©å¤§å®¶å°‘èµ°å¼¯è·¯ã€‚\n\n","source":"_posts/åŸºç¡€/StringBuffer å’Œ StringBuilder çš„ 3 ä¸ªåŒºåˆ«.md","raw":"---\ntitle: StringBuffer å’Œ StringBuilder çš„ 3 ä¸ªåŒºåˆ«\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: åŸºç¡€\n---\n\nStringBuffer å’Œ StringBuilder å®ƒä»¬éƒ½æ˜¯å¯å˜çš„å­—ç¬¦ä¸²ï¼Œä¸è¿‡å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ Java åˆä¸­çº§é¢è¯•å‡ºç°å‡ ç‡ååˆ†é«˜çš„ä¸€é“é¢˜ã€‚è¿™ä¹ˆç®€å•çš„ä¸€é“é¢˜ï¼Œæ ˆé•¿åœ¨æœ€è¿‘çš„é¢è¯•è¿‡ç¨‹ä¸­ï¼Œå´ç»å¸¸é‡åˆ°å¾ˆå¤šæ±‚èŒè€…è¯´åï¼Œæä¸æ¸…ä½¿ç”¨åœºæ™¯çš„æƒ…å†µã€‚\n\nä»Šå¤©ï¼Œæ ˆé•¿æˆ‘å¸¦å¤§å®¶å½»åº•ææ‡‚ StringBuffer å’Œ StringBuilder çš„å‡ ä¸ªåŒºåˆ«å’Œå®ƒä»¬çš„åº”ç”¨åœºæ™¯ï¼Œå¦‚æœä½ æ˜¯å¤§ç‰›ï¼Œè¯·ç•¥è¿‡ï¼Œå¦‚æœä½ æ˜¯èœé¸Ÿï¼Œæˆ–è€…å¯¹è¿™ä¸¤ä¸ªä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œå¯ä»¥å­¦ä¹ ä¸€ä¸‹ï¼Œä¹Ÿå¯ä»¥ä¸ºå¹´åº•çš„é¢è¯•åŠ æ²¹å†²åˆºã€‚\n\nå…ˆçœ‹çœ‹ StringBuffer å’Œ StringBuilder çš„ç±»ç»“æ„å§ï¼š\n\n![](http://img.javastack.cn/18-12-29/23490736.jpg)\n\nå…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯ç»§æ‰¿äº†ä¸€ä¸ªæŠ½è±¡çš„å­—ç¬¦ä¸²çˆ¶ç±»ï¼š`AbstractStringBuilder`ã€‚ä¸‹é¢æˆ‘ä»¬å†æ¥çœ‹çœ‹å®ƒä»¬çš„ä¸‰ä¸ªåŒºåˆ«ã€‚\n\n## åŒºåˆ«1ï¼šçº¿ç¨‹å®‰å…¨\n\nStringBufferï¼šçº¿ç¨‹å®‰å…¨ï¼ŒStringBuilderï¼šçº¿ç¨‹ä¸å®‰å…¨ã€‚å› ä¸º StringBuffer çš„æ‰€æœ‰å…¬å¼€æ–¹æ³•éƒ½æ˜¯ synchronized ä¿®é¥°çš„ï¼Œè€Œ StringBuilder å¹¶æ²¡æœ‰ StringBuilder ä¿®é¥°ã€‚\n\n**StringBuffer ä»£ç ç‰‡æ®µï¼š**\n\n```\n@Override\npublic synchronized StringBuffer append(String str) {\n    toStringCache = null;\n    super.append(str);\n    return this;\n}\n```\n\n## åŒºåˆ«2ï¼šç¼“å†²åŒº\n\n**StringBuffer ä»£ç ç‰‡æ®µï¼š**\n\n```\nprivate transient char[] toStringCache;\n\n@Override\npublic synchronized String toString() {\n    if (toStringCache == null) {\n        toStringCache = Arrays.copyOfRange(value, 0, count);\n    }\n    return new String(toStringCache, true);\n}\n```\n\n**StringBuilder ä»£ç ç‰‡æ®µï¼š**\n\n```\n@Override\npublic String toString() {\n    // Create a copy, don't share the array\n    return new String(value, 0, count);\n}\n```\n\nå¯ä»¥çœ‹å‡ºï¼ŒStringBuffer æ¯æ¬¡è·å– toString éƒ½ä¼šç›´æ¥ä½¿ç”¨ç¼“å­˜åŒºçš„ toStringCache å€¼æ¥æ„é€ ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚\n\nè€Œ StringBuilder åˆ™æ¯æ¬¡éƒ½éœ€è¦å¤åˆ¶ä¸€æ¬¡å­—ç¬¦æ•°ç»„ï¼Œå†æ„é€ ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚\n\næ‰€ä»¥ï¼Œç¼“å­˜å†²è¿™ä¹Ÿæ˜¯å¯¹ StringBuffer çš„ä¸€ä¸ªä¼˜åŒ–å§ï¼Œä¸è¿‡ StringBuffer çš„è¿™ä¸ªtoString æ–¹æ³•ä»ç„¶æ˜¯åŒæ­¥çš„ã€‚\n\n## åŒºåˆ«3ï¼šæ€§èƒ½\n\næ—¢ç„¶ StringBuffer æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå®ƒçš„æ‰€æœ‰å…¬å¼€æ–¹æ³•éƒ½æ˜¯åŒæ­¥çš„ï¼ŒStringBuilder æ˜¯æ²¡æœ‰å¯¹æ–¹æ³•åŠ é”åŒæ­¥çš„ï¼Œæ‰€ä»¥æ¯«æ— ç–‘é—®ï¼ŒStringBuilder çš„æ€§èƒ½è¦è¿œå¤§äº StringBufferã€‚\n\n## æ€»ç»“\n\næ‰€ä»¥ï¼ŒStringBuffer é€‚ç”¨äºç”¨åœ¨å¤šçº¿ç¨‹æ“ä½œåŒä¸€ä¸ª StringBuffer çš„åœºæ™¯ï¼Œå¦‚æœæ˜¯å•çº¿ç¨‹åœºåˆ StringBuilder æ›´é€‚åˆã€‚\n\nä»¥æ­¤é€ç»™æ­£åœ¨é¢è¯•æˆ–è€…å³å°†å»é¢è¯•çš„ Java ç¨‹åºçŒ¿ä»¬ï¼Œå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ï¼Œä¹Ÿæ¬¢è¿åˆ†äº«ç»™èº«è¾¹çš„æœ‹å‹ä»¬ï¼Œè®©å¤§å®¶å°‘èµ°å¼¯è·¯ã€‚\n\n","slug":"åŸºç¡€/StringBuffer å’Œ StringBuilder çš„ 3 ä¸ªåŒºåˆ«","published":1,"updated":"2025-10-15T07:19:51.814Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076u003nqkd48kavh4lg","content":"<p>StringBuffer å’Œ StringBuilder å®ƒä»¬éƒ½æ˜¯å¯å˜çš„å­—ç¬¦ä¸²ï¼Œä¸è¿‡å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ Java åˆä¸­çº§é¢è¯•å‡ºç°å‡ ç‡ååˆ†é«˜çš„ä¸€é“é¢˜ã€‚è¿™ä¹ˆç®€å•çš„ä¸€é“é¢˜ï¼Œæ ˆé•¿åœ¨æœ€è¿‘çš„é¢è¯•è¿‡ç¨‹ä¸­ï¼Œå´ç»å¸¸é‡åˆ°å¾ˆå¤šæ±‚èŒè€…è¯´åï¼Œæä¸æ¸…ä½¿ç”¨åœºæ™¯çš„æƒ…å†µã€‚</p>\n<p>ä»Šå¤©ï¼Œæ ˆé•¿æˆ‘å¸¦å¤§å®¶å½»åº•ææ‡‚ StringBuffer å’Œ StringBuilder çš„å‡ ä¸ªåŒºåˆ«å’Œå®ƒä»¬çš„åº”ç”¨åœºæ™¯ï¼Œå¦‚æœä½ æ˜¯å¤§ç‰›ï¼Œè¯·ç•¥è¿‡ï¼Œå¦‚æœä½ æ˜¯èœé¸Ÿï¼Œæˆ–è€…å¯¹è¿™ä¸¤ä¸ªä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œå¯ä»¥å­¦ä¹ ä¸€ä¸‹ï¼Œä¹Ÿå¯ä»¥ä¸ºå¹´åº•çš„é¢è¯•åŠ æ²¹å†²åˆºã€‚</p>\n<p>å…ˆçœ‹çœ‹ StringBuffer å’Œ StringBuilder çš„ç±»ç»“æ„å§ï¼š</p>\n<p><img src=\"http://img.javastack.cn/18-12-29/23490736.jpg\"></p>\n<p>å…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯ç»§æ‰¿äº†ä¸€ä¸ªæŠ½è±¡çš„å­—ç¬¦ä¸²çˆ¶ç±»ï¼š<code>AbstractStringBuilder</code>ã€‚ä¸‹é¢æˆ‘ä»¬å†æ¥çœ‹çœ‹å®ƒä»¬çš„ä¸‰ä¸ªåŒºåˆ«ã€‚</p>\n<h2 id=\"åŒºåˆ«1ï¼šçº¿ç¨‹å®‰å…¨\"><a href=\"#åŒºåˆ«1ï¼šçº¿ç¨‹å®‰å…¨\" class=\"headerlink\" title=\"åŒºåˆ«1ï¼šçº¿ç¨‹å®‰å…¨\"></a>åŒºåˆ«1ï¼šçº¿ç¨‹å®‰å…¨</h2><p>StringBufferï¼šçº¿ç¨‹å®‰å…¨ï¼ŒStringBuilderï¼šçº¿ç¨‹ä¸å®‰å…¨ã€‚å› ä¸º StringBuffer çš„æ‰€æœ‰å…¬å¼€æ–¹æ³•éƒ½æ˜¯ synchronized ä¿®é¥°çš„ï¼Œè€Œ StringBuilder å¹¶æ²¡æœ‰ StringBuilder ä¿®é¥°ã€‚</p>\n<p><strong>StringBuffer ä»£ç ç‰‡æ®µï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@Override\npublic synchronized StringBuffer append(String str) &#123;\n    toStringCache &#x3D; null;\n    super.append(str);\n    return this;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"åŒºåˆ«2ï¼šç¼“å†²åŒº\"><a href=\"#åŒºåˆ«2ï¼šç¼“å†²åŒº\" class=\"headerlink\" title=\"åŒºåˆ«2ï¼šç¼“å†²åŒº\"></a>åŒºåˆ«2ï¼šç¼“å†²åŒº</h2><p><strong>StringBuffer ä»£ç ç‰‡æ®µï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private transient char[] toStringCache;\n\n@Override\npublic synchronized String toString() &#123;\n    if (toStringCache &#x3D;&#x3D; null) &#123;\n        toStringCache &#x3D; Arrays.copyOfRange(value, 0, count);\n    &#125;\n    return new String(toStringCache, true);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>StringBuilder ä»£ç ç‰‡æ®µï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@Override\npublic String toString() &#123;\n    &#x2F;&#x2F; Create a copy, don&#39;t share the array\n    return new String(value, 0, count);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥çœ‹å‡ºï¼ŒStringBuffer æ¯æ¬¡è·å– toString éƒ½ä¼šç›´æ¥ä½¿ç”¨ç¼“å­˜åŒºçš„ toStringCache å€¼æ¥æ„é€ ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>\n<p>è€Œ StringBuilder åˆ™æ¯æ¬¡éƒ½éœ€è¦å¤åˆ¶ä¸€æ¬¡å­—ç¬¦æ•°ç»„ï¼Œå†æ„é€ ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>\n<p>æ‰€ä»¥ï¼Œç¼“å­˜å†²è¿™ä¹Ÿæ˜¯å¯¹ StringBuffer çš„ä¸€ä¸ªä¼˜åŒ–å§ï¼Œä¸è¿‡ StringBuffer çš„è¿™ä¸ªtoString æ–¹æ³•ä»ç„¶æ˜¯åŒæ­¥çš„ã€‚</p>\n<h2 id=\"åŒºåˆ«3ï¼šæ€§èƒ½\"><a href=\"#åŒºåˆ«3ï¼šæ€§èƒ½\" class=\"headerlink\" title=\"åŒºåˆ«3ï¼šæ€§èƒ½\"></a>åŒºåˆ«3ï¼šæ€§èƒ½</h2><p>æ—¢ç„¶ StringBuffer æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå®ƒçš„æ‰€æœ‰å…¬å¼€æ–¹æ³•éƒ½æ˜¯åŒæ­¥çš„ï¼ŒStringBuilder æ˜¯æ²¡æœ‰å¯¹æ–¹æ³•åŠ é”åŒæ­¥çš„ï¼Œæ‰€ä»¥æ¯«æ— ç–‘é—®ï¼ŒStringBuilder çš„æ€§èƒ½è¦è¿œå¤§äº StringBufferã€‚</p>\n<h2 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h2><p>æ‰€ä»¥ï¼ŒStringBuffer é€‚ç”¨äºç”¨åœ¨å¤šçº¿ç¨‹æ“ä½œåŒä¸€ä¸ª StringBuffer çš„åœºæ™¯ï¼Œå¦‚æœæ˜¯å•çº¿ç¨‹åœºåˆ StringBuilder æ›´é€‚åˆã€‚</p>\n<p>ä»¥æ­¤é€ç»™æ­£åœ¨é¢è¯•æˆ–è€…å³å°†å»é¢è¯•çš„ Java ç¨‹åºçŒ¿ä»¬ï¼Œå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ï¼Œä¹Ÿæ¬¢è¿åˆ†äº«ç»™èº«è¾¹çš„æœ‹å‹ä»¬ï¼Œè®©å¤§å®¶å°‘èµ°å¼¯è·¯ã€‚</p>\n","excerpt":"","more":"<p>StringBuffer å’Œ StringBuilder å®ƒä»¬éƒ½æ˜¯å¯å˜çš„å­—ç¬¦ä¸²ï¼Œä¸è¿‡å®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ Java åˆä¸­çº§é¢è¯•å‡ºç°å‡ ç‡ååˆ†é«˜çš„ä¸€é“é¢˜ã€‚è¿™ä¹ˆç®€å•çš„ä¸€é“é¢˜ï¼Œæ ˆé•¿åœ¨æœ€è¿‘çš„é¢è¯•è¿‡ç¨‹ä¸­ï¼Œå´ç»å¸¸é‡åˆ°å¾ˆå¤šæ±‚èŒè€…è¯´åï¼Œæä¸æ¸…ä½¿ç”¨åœºæ™¯çš„æƒ…å†µã€‚</p>\n<p>ä»Šå¤©ï¼Œæ ˆé•¿æˆ‘å¸¦å¤§å®¶å½»åº•ææ‡‚ StringBuffer å’Œ StringBuilder çš„å‡ ä¸ªåŒºåˆ«å’Œå®ƒä»¬çš„åº”ç”¨åœºæ™¯ï¼Œå¦‚æœä½ æ˜¯å¤§ç‰›ï¼Œè¯·ç•¥è¿‡ï¼Œå¦‚æœä½ æ˜¯èœé¸Ÿï¼Œæˆ–è€…å¯¹è¿™ä¸¤ä¸ªä¸æ˜¯å¾ˆæ¸…æ¥šï¼Œå¯ä»¥å­¦ä¹ ä¸€ä¸‹ï¼Œä¹Ÿå¯ä»¥ä¸ºå¹´åº•çš„é¢è¯•åŠ æ²¹å†²åˆºã€‚</p>\n<p>å…ˆçœ‹çœ‹ StringBuffer å’Œ StringBuilder çš„ç±»ç»“æ„å§ï¼š</p>\n<p><img src=\"http://img.javastack.cn/18-12-29/23490736.jpg\"></p>\n<p>å…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯ç»§æ‰¿äº†ä¸€ä¸ªæŠ½è±¡çš„å­—ç¬¦ä¸²çˆ¶ç±»ï¼š<code>AbstractStringBuilder</code>ã€‚ä¸‹é¢æˆ‘ä»¬å†æ¥çœ‹çœ‹å®ƒä»¬çš„ä¸‰ä¸ªåŒºåˆ«ã€‚</p>\n<h2 id=\"åŒºåˆ«1ï¼šçº¿ç¨‹å®‰å…¨\"><a href=\"#åŒºåˆ«1ï¼šçº¿ç¨‹å®‰å…¨\" class=\"headerlink\" title=\"åŒºåˆ«1ï¼šçº¿ç¨‹å®‰å…¨\"></a>åŒºåˆ«1ï¼šçº¿ç¨‹å®‰å…¨</h2><p>StringBufferï¼šçº¿ç¨‹å®‰å…¨ï¼ŒStringBuilderï¼šçº¿ç¨‹ä¸å®‰å…¨ã€‚å› ä¸º StringBuffer çš„æ‰€æœ‰å…¬å¼€æ–¹æ³•éƒ½æ˜¯ synchronized ä¿®é¥°çš„ï¼Œè€Œ StringBuilder å¹¶æ²¡æœ‰ StringBuilder ä¿®é¥°ã€‚</p>\n<p><strong>StringBuffer ä»£ç ç‰‡æ®µï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@Override\npublic synchronized StringBuffer append(String str) &#123;\n    toStringCache &#x3D; null;\n    super.append(str);\n    return this;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"åŒºåˆ«2ï¼šç¼“å†²åŒº\"><a href=\"#åŒºåˆ«2ï¼šç¼“å†²åŒº\" class=\"headerlink\" title=\"åŒºåˆ«2ï¼šç¼“å†²åŒº\"></a>åŒºåˆ«2ï¼šç¼“å†²åŒº</h2><p><strong>StringBuffer ä»£ç ç‰‡æ®µï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private transient char[] toStringCache;\n\n@Override\npublic synchronized String toString() &#123;\n    if (toStringCache &#x3D;&#x3D; null) &#123;\n        toStringCache &#x3D; Arrays.copyOfRange(value, 0, count);\n    &#125;\n    return new String(toStringCache, true);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>StringBuilder ä»£ç ç‰‡æ®µï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@Override\npublic String toString() &#123;\n    &#x2F;&#x2F; Create a copy, don&#39;t share the array\n    return new String(value, 0, count);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥çœ‹å‡ºï¼ŒStringBuffer æ¯æ¬¡è·å– toString éƒ½ä¼šç›´æ¥ä½¿ç”¨ç¼“å­˜åŒºçš„ toStringCache å€¼æ¥æ„é€ ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>\n<p>è€Œ StringBuilder åˆ™æ¯æ¬¡éƒ½éœ€è¦å¤åˆ¶ä¸€æ¬¡å­—ç¬¦æ•°ç»„ï¼Œå†æ„é€ ä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</p>\n<p>æ‰€ä»¥ï¼Œç¼“å­˜å†²è¿™ä¹Ÿæ˜¯å¯¹ StringBuffer çš„ä¸€ä¸ªä¼˜åŒ–å§ï¼Œä¸è¿‡ StringBuffer çš„è¿™ä¸ªtoString æ–¹æ³•ä»ç„¶æ˜¯åŒæ­¥çš„ã€‚</p>\n<h2 id=\"åŒºåˆ«3ï¼šæ€§èƒ½\"><a href=\"#åŒºåˆ«3ï¼šæ€§èƒ½\" class=\"headerlink\" title=\"åŒºåˆ«3ï¼šæ€§èƒ½\"></a>åŒºåˆ«3ï¼šæ€§èƒ½</h2><p>æ—¢ç„¶ StringBuffer æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå®ƒçš„æ‰€æœ‰å…¬å¼€æ–¹æ³•éƒ½æ˜¯åŒæ­¥çš„ï¼ŒStringBuilder æ˜¯æ²¡æœ‰å¯¹æ–¹æ³•åŠ é”åŒæ­¥çš„ï¼Œæ‰€ä»¥æ¯«æ— ç–‘é—®ï¼ŒStringBuilder çš„æ€§èƒ½è¦è¿œå¤§äº StringBufferã€‚</p>\n<h2 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h2><p>æ‰€ä»¥ï¼ŒStringBuffer é€‚ç”¨äºç”¨åœ¨å¤šçº¿ç¨‹æ“ä½œåŒä¸€ä¸ª StringBuffer çš„åœºæ™¯ï¼Œå¦‚æœæ˜¯å•çº¿ç¨‹åœºåˆ StringBuilder æ›´é€‚åˆã€‚</p>\n<p>ä»¥æ­¤é€ç»™æ­£åœ¨é¢è¯•æˆ–è€…å³å°†å»é¢è¯•çš„ Java ç¨‹åºçŒ¿ä»¬ï¼Œå¦‚æœå¯¹ä½ æœ‰å¸®åŠ©ï¼Œä¹Ÿæ¬¢è¿åˆ†äº«ç»™èº«è¾¹çš„æœ‹å‹ä»¬ï¼Œè®©å¤§å®¶å°‘èµ°å¼¯è·¯ã€‚</p>\n"},{"title":"switch case æ”¯æŒçš„ 6 ç§æ•°æ®ç±»å‹ï¼","date":"2025-10-14T06:42:34.000Z","_content":"\n**Java ä¸­ switch case è¯­å¥ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªå˜é‡ä¸ä¸€ç³»åˆ—å€¼ä¸­æŸä¸ªå€¼æ˜¯å¦ç›¸ç­‰ï¼Œæ¯ä¸ªå€¼ç§°ä¸ºä¸€ä¸ªåˆ†æ”¯ã€‚**\n\n**è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š**\n\n```\nswitch(expression){\n    case value :\n       //è¯­å¥\n       break; //å¯é€‰\n    case value :\n       //è¯­å¥\n       break; //å¯é€‰\n    //ä½ å¯ä»¥æœ‰ä»»æ„æ•°é‡çš„caseè¯­å¥\n    default : //å¯é€‰\n       //è¯­å¥\n}\n```\n\n**è¿™é‡Œçš„ `expression` éƒ½æ”¯æŒå“ªäº›ç±»å‹å‘¢ï¼Ÿ**\n\n- åŸºæœ¬æ•°æ®ç±»å‹ï¼šbyte, short, char, int\n\n- åŒ…è£…æ•°æ®ç±»å‹ï¼šByte, Short, Character, Integer\n\n- æšä¸¾ç±»å‹ï¼šEnum\n\n- å­—ç¬¦ä¸²ç±»å‹ï¼šStringï¼ˆJdk 7+ å¼€å§‹æ”¯æŒï¼‰\n\nåŸºæœ¬æ•°æ®ç±»å‹å’Œå­—ç¬¦ä¸²å¾ˆç®€å•ä¸ç”¨è¯´ï¼Œä¸‹é¢ä¸¾ä¸€ä¸ªä½¿ç”¨åŒ…è£…ç±»å‹å’Œæšä¸¾çš„ï¼Œå…¶å®ä¹Ÿä¸éš¾ï¼Œæ³¨æ„åªèƒ½ç”¨åœ¨ switch å—é‡Œé¢ã€‚\n\n```\n// ä½¿ç”¨åŒ…è£…ç±»å‹\nInteger value = 5;\nswitch (value) {\n\tcase 3:\n\t\tSystem.out.println(\"3\");\n\t\tbreak;\n\tcase 5:\n\t\tSystem.out.println(\"5\");\n\t\tbreak;\n\tdefault:\n\t\tSystem.out.println(\"default\");\n}\n\n// ä½¿ç”¨æšä¸¾ç±»å‹\nStatus status = Status.PROCESSING;\nswitch (status) {\n\tcase OPEN:\n\t\tSystem.out.println(\"open\");\n\t\tbreak;\n\tcase PROCESSING:\n\t\tSystem.out.println(\"processing\");\n\t\tbreak;\n\tcase CLOSE:\n\t\tSystem.out.println(\"close\");\n\t\tbreak;\n\tdefault:\n\t\tSystem.out.println(\"default\");\n}\n```\n\nä»¥ä¸‹ä¸ºå®˜ç½‘çš„ä»‹ç»æ–‡æ¡£ã€‚\n> https://docs.oracle.com/javase/tutorial/java/nutsandbolts/switch.html\n\nåŒ…è£…ç±»ä¸æ‡‚çš„çœ‹è¿™ç¯‡æ–‡ç« ã€Š[æ·±å…¥æµ…å‡º Java ä¸­çš„åŒ…è£…ç±»](https://mp.weixin.qq.com/s/uoNVT9IoRQmWnmy8w22UUQ)ã€‹ã€‚\n\n**ä½¿ç”¨ switch case è¯­å¥ä¹Ÿæœ‰ä»¥ä¸‹å‡ ç‚¹éœ€è¦æ³¨æ„ã€‚**\n\n1. case é‡Œé¢å¿…é¡»è·Ÿ breakï¼Œä¸ç„¶ç¨‹åºä¼šä¸€ä¸ªä¸ª case æ‰§è¡Œä¸‹å»ï¼Œç›´åˆ°æœ€åä¸€ä¸ª break çš„ case æˆ–è€… default å‡ºç°ã€‚\n\n2. case æ¡ä»¶é‡Œé¢åªèƒ½æ˜¯å¸¸é‡æˆ–è€…å­—é¢å¸¸é‡ã€‚\n\n3. default è¯­å¥å¯æœ‰å¯æ— ï¼Œæœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªã€‚\n\næœ‰é—®é¢˜è¯·ç•™è¨€ï¼Œå¸Œæœ›æœ¬æ–‡èƒ½å¯¹ä½ æœ‰æœ‰æ‰€å¸®åŠ©ï¼\n\n","source":"_posts/åŸºç¡€/switch case æ”¯æŒçš„ 6 ç§æ•°æ®ç±»å‹ï¼.md","raw":"---\ntitle: switch case æ”¯æŒçš„ 6 ç§æ•°æ®ç±»å‹ï¼\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: åŸºç¡€\n---\n\n**Java ä¸­ switch case è¯­å¥ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªå˜é‡ä¸ä¸€ç³»åˆ—å€¼ä¸­æŸä¸ªå€¼æ˜¯å¦ç›¸ç­‰ï¼Œæ¯ä¸ªå€¼ç§°ä¸ºä¸€ä¸ªåˆ†æ”¯ã€‚**\n\n**è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š**\n\n```\nswitch(expression){\n    case value :\n       //è¯­å¥\n       break; //å¯é€‰\n    case value :\n       //è¯­å¥\n       break; //å¯é€‰\n    //ä½ å¯ä»¥æœ‰ä»»æ„æ•°é‡çš„caseè¯­å¥\n    default : //å¯é€‰\n       //è¯­å¥\n}\n```\n\n**è¿™é‡Œçš„ `expression` éƒ½æ”¯æŒå“ªäº›ç±»å‹å‘¢ï¼Ÿ**\n\n- åŸºæœ¬æ•°æ®ç±»å‹ï¼šbyte, short, char, int\n\n- åŒ…è£…æ•°æ®ç±»å‹ï¼šByte, Short, Character, Integer\n\n- æšä¸¾ç±»å‹ï¼šEnum\n\n- å­—ç¬¦ä¸²ç±»å‹ï¼šStringï¼ˆJdk 7+ å¼€å§‹æ”¯æŒï¼‰\n\nåŸºæœ¬æ•°æ®ç±»å‹å’Œå­—ç¬¦ä¸²å¾ˆç®€å•ä¸ç”¨è¯´ï¼Œä¸‹é¢ä¸¾ä¸€ä¸ªä½¿ç”¨åŒ…è£…ç±»å‹å’Œæšä¸¾çš„ï¼Œå…¶å®ä¹Ÿä¸éš¾ï¼Œæ³¨æ„åªèƒ½ç”¨åœ¨ switch å—é‡Œé¢ã€‚\n\n```\n// ä½¿ç”¨åŒ…è£…ç±»å‹\nInteger value = 5;\nswitch (value) {\n\tcase 3:\n\t\tSystem.out.println(\"3\");\n\t\tbreak;\n\tcase 5:\n\t\tSystem.out.println(\"5\");\n\t\tbreak;\n\tdefault:\n\t\tSystem.out.println(\"default\");\n}\n\n// ä½¿ç”¨æšä¸¾ç±»å‹\nStatus status = Status.PROCESSING;\nswitch (status) {\n\tcase OPEN:\n\t\tSystem.out.println(\"open\");\n\t\tbreak;\n\tcase PROCESSING:\n\t\tSystem.out.println(\"processing\");\n\t\tbreak;\n\tcase CLOSE:\n\t\tSystem.out.println(\"close\");\n\t\tbreak;\n\tdefault:\n\t\tSystem.out.println(\"default\");\n}\n```\n\nä»¥ä¸‹ä¸ºå®˜ç½‘çš„ä»‹ç»æ–‡æ¡£ã€‚\n> https://docs.oracle.com/javase/tutorial/java/nutsandbolts/switch.html\n\nåŒ…è£…ç±»ä¸æ‡‚çš„çœ‹è¿™ç¯‡æ–‡ç« ã€Š[æ·±å…¥æµ…å‡º Java ä¸­çš„åŒ…è£…ç±»](https://mp.weixin.qq.com/s/uoNVT9IoRQmWnmy8w22UUQ)ã€‹ã€‚\n\n**ä½¿ç”¨ switch case è¯­å¥ä¹Ÿæœ‰ä»¥ä¸‹å‡ ç‚¹éœ€è¦æ³¨æ„ã€‚**\n\n1. case é‡Œé¢å¿…é¡»è·Ÿ breakï¼Œä¸ç„¶ç¨‹åºä¼šä¸€ä¸ªä¸ª case æ‰§è¡Œä¸‹å»ï¼Œç›´åˆ°æœ€åä¸€ä¸ª break çš„ case æˆ–è€… default å‡ºç°ã€‚\n\n2. case æ¡ä»¶é‡Œé¢åªèƒ½æ˜¯å¸¸é‡æˆ–è€…å­—é¢å¸¸é‡ã€‚\n\n3. default è¯­å¥å¯æœ‰å¯æ— ï¼Œæœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªã€‚\n\næœ‰é—®é¢˜è¯·ç•™è¨€ï¼Œå¸Œæœ›æœ¬æ–‡èƒ½å¯¹ä½ æœ‰æœ‰æ‰€å¸®åŠ©ï¼\n\n","slug":"åŸºç¡€/switch case æ”¯æŒçš„ 6 ç§æ•°æ®ç±»å‹ï¼","published":1,"updated":"2025-10-15T07:19:51.810Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076v003qqkd4cndjac5l","content":"<p><strong>Java ä¸­ switch case è¯­å¥ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªå˜é‡ä¸ä¸€ç³»åˆ—å€¼ä¸­æŸä¸ªå€¼æ˜¯å¦ç›¸ç­‰ï¼Œæ¯ä¸ªå€¼ç§°ä¸ºä¸€ä¸ªåˆ†æ”¯ã€‚</strong></p>\n<p><strong>è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">switch(expression)&#123;\n    case value :\n       &#x2F;&#x2F;è¯­å¥\n       break; &#x2F;&#x2F;å¯é€‰\n    case value :\n       &#x2F;&#x2F;è¯­å¥\n       break; &#x2F;&#x2F;å¯é€‰\n    &#x2F;&#x2F;ä½ å¯ä»¥æœ‰ä»»æ„æ•°é‡çš„caseè¯­å¥\n    default : &#x2F;&#x2F;å¯é€‰\n       &#x2F;&#x2F;è¯­å¥\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>è¿™é‡Œçš„ <code>expression</code> éƒ½æ”¯æŒå“ªäº›ç±»å‹å‘¢ï¼Ÿ</strong></p>\n<ul>\n<li><p>åŸºæœ¬æ•°æ®ç±»å‹ï¼šbyte, short, char, int</p>\n</li>\n<li><p>åŒ…è£…æ•°æ®ç±»å‹ï¼šByte, Short, Character, Integer</p>\n</li>\n<li><p>æšä¸¾ç±»å‹ï¼šEnum</p>\n</li>\n<li><p>å­—ç¬¦ä¸²ç±»å‹ï¼šStringï¼ˆJdk 7+ å¼€å§‹æ”¯æŒï¼‰</p>\n</li>\n</ul>\n<p>åŸºæœ¬æ•°æ®ç±»å‹å’Œå­—ç¬¦ä¸²å¾ˆç®€å•ä¸ç”¨è¯´ï¼Œä¸‹é¢ä¸¾ä¸€ä¸ªä½¿ç”¨åŒ…è£…ç±»å‹å’Œæšä¸¾çš„ï¼Œå…¶å®ä¹Ÿä¸éš¾ï¼Œæ³¨æ„åªèƒ½ç”¨åœ¨ switch å—é‡Œé¢ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; ä½¿ç”¨åŒ…è£…ç±»å‹\nInteger value &#x3D; 5;\nswitch (value) &#123;\n\tcase 3:\n\t\tSystem.out.println(&quot;3&quot;);\n\t\tbreak;\n\tcase 5:\n\t\tSystem.out.println(&quot;5&quot;);\n\t\tbreak;\n\tdefault:\n\t\tSystem.out.println(&quot;default&quot;);\n&#125;\n\n&#x2F;&#x2F; ä½¿ç”¨æšä¸¾ç±»å‹\nStatus status &#x3D; Status.PROCESSING;\nswitch (status) &#123;\n\tcase OPEN:\n\t\tSystem.out.println(&quot;open&quot;);\n\t\tbreak;\n\tcase PROCESSING:\n\t\tSystem.out.println(&quot;processing&quot;);\n\t\tbreak;\n\tcase CLOSE:\n\t\tSystem.out.println(&quot;close&quot;);\n\t\tbreak;\n\tdefault:\n\t\tSystem.out.println(&quot;default&quot;);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä»¥ä¸‹ä¸ºå®˜ç½‘çš„ä»‹ç»æ–‡æ¡£ã€‚</p>\n<blockquote>\n<p><a href=\"https://docs.oracle.com/javase/tutorial/java/nutsandbolts/switch.html\">https://docs.oracle.com/javase/tutorial/java/nutsandbolts/switch.html</a></p>\n</blockquote>\n<p>åŒ…è£…ç±»ä¸æ‡‚çš„çœ‹è¿™ç¯‡æ–‡ç« ã€Š<a href=\"https://mp.weixin.qq.com/s/uoNVT9IoRQmWnmy8w22UUQ\">æ·±å…¥æµ…å‡º Java ä¸­çš„åŒ…è£…ç±»</a>ã€‹ã€‚</p>\n<p><strong>ä½¿ç”¨ switch case è¯­å¥ä¹Ÿæœ‰ä»¥ä¸‹å‡ ç‚¹éœ€è¦æ³¨æ„ã€‚</strong></p>\n<ol>\n<li><p>case é‡Œé¢å¿…é¡»è·Ÿ breakï¼Œä¸ç„¶ç¨‹åºä¼šä¸€ä¸ªä¸ª case æ‰§è¡Œä¸‹å»ï¼Œç›´åˆ°æœ€åä¸€ä¸ª break çš„ case æˆ–è€… default å‡ºç°ã€‚</p>\n</li>\n<li><p>case æ¡ä»¶é‡Œé¢åªèƒ½æ˜¯å¸¸é‡æˆ–è€…å­—é¢å¸¸é‡ã€‚</p>\n</li>\n<li><p>default è¯­å¥å¯æœ‰å¯æ— ï¼Œæœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªã€‚</p>\n</li>\n</ol>\n<p>æœ‰é—®é¢˜è¯·ç•™è¨€ï¼Œå¸Œæœ›æœ¬æ–‡èƒ½å¯¹ä½ æœ‰æœ‰æ‰€å¸®åŠ©ï¼</p>\n","excerpt":"","more":"<p><strong>Java ä¸­ switch case è¯­å¥ç”¨æ¥åˆ¤æ–­ä¸€ä¸ªå˜é‡ä¸ä¸€ç³»åˆ—å€¼ä¸­æŸä¸ªå€¼æ˜¯å¦ç›¸ç­‰ï¼Œæ¯ä¸ªå€¼ç§°ä¸ºä¸€ä¸ªåˆ†æ”¯ã€‚</strong></p>\n<p><strong>è¯­æ³•æ ¼å¼å¦‚ä¸‹ï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">switch(expression)&#123;\n    case value :\n       &#x2F;&#x2F;è¯­å¥\n       break; &#x2F;&#x2F;å¯é€‰\n    case value :\n       &#x2F;&#x2F;è¯­å¥\n       break; &#x2F;&#x2F;å¯é€‰\n    &#x2F;&#x2F;ä½ å¯ä»¥æœ‰ä»»æ„æ•°é‡çš„caseè¯­å¥\n    default : &#x2F;&#x2F;å¯é€‰\n       &#x2F;&#x2F;è¯­å¥\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>è¿™é‡Œçš„ <code>expression</code> éƒ½æ”¯æŒå“ªäº›ç±»å‹å‘¢ï¼Ÿ</strong></p>\n<ul>\n<li><p>åŸºæœ¬æ•°æ®ç±»å‹ï¼šbyte, short, char, int</p>\n</li>\n<li><p>åŒ…è£…æ•°æ®ç±»å‹ï¼šByte, Short, Character, Integer</p>\n</li>\n<li><p>æšä¸¾ç±»å‹ï¼šEnum</p>\n</li>\n<li><p>å­—ç¬¦ä¸²ç±»å‹ï¼šStringï¼ˆJdk 7+ å¼€å§‹æ”¯æŒï¼‰</p>\n</li>\n</ul>\n<p>åŸºæœ¬æ•°æ®ç±»å‹å’Œå­—ç¬¦ä¸²å¾ˆç®€å•ä¸ç”¨è¯´ï¼Œä¸‹é¢ä¸¾ä¸€ä¸ªä½¿ç”¨åŒ…è£…ç±»å‹å’Œæšä¸¾çš„ï¼Œå…¶å®ä¹Ÿä¸éš¾ï¼Œæ³¨æ„åªèƒ½ç”¨åœ¨ switch å—é‡Œé¢ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; ä½¿ç”¨åŒ…è£…ç±»å‹\nInteger value &#x3D; 5;\nswitch (value) &#123;\n\tcase 3:\n\t\tSystem.out.println(&quot;3&quot;);\n\t\tbreak;\n\tcase 5:\n\t\tSystem.out.println(&quot;5&quot;);\n\t\tbreak;\n\tdefault:\n\t\tSystem.out.println(&quot;default&quot;);\n&#125;\n\n&#x2F;&#x2F; ä½¿ç”¨æšä¸¾ç±»å‹\nStatus status &#x3D; Status.PROCESSING;\nswitch (status) &#123;\n\tcase OPEN:\n\t\tSystem.out.println(&quot;open&quot;);\n\t\tbreak;\n\tcase PROCESSING:\n\t\tSystem.out.println(&quot;processing&quot;);\n\t\tbreak;\n\tcase CLOSE:\n\t\tSystem.out.println(&quot;close&quot;);\n\t\tbreak;\n\tdefault:\n\t\tSystem.out.println(&quot;default&quot;);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä»¥ä¸‹ä¸ºå®˜ç½‘çš„ä»‹ç»æ–‡æ¡£ã€‚</p>\n<blockquote>\n<p><a href=\"https://docs.oracle.com/javase/tutorial/java/nutsandbolts/switch.html\">https://docs.oracle.com/javase/tutorial/java/nutsandbolts/switch.html</a></p>\n</blockquote>\n<p>åŒ…è£…ç±»ä¸æ‡‚çš„çœ‹è¿™ç¯‡æ–‡ç« ã€Š<a href=\"https://mp.weixin.qq.com/s/uoNVT9IoRQmWnmy8w22UUQ\">æ·±å…¥æµ…å‡º Java ä¸­çš„åŒ…è£…ç±»</a>ã€‹ã€‚</p>\n<p><strong>ä½¿ç”¨ switch case è¯­å¥ä¹Ÿæœ‰ä»¥ä¸‹å‡ ç‚¹éœ€è¦æ³¨æ„ã€‚</strong></p>\n<ol>\n<li><p>case é‡Œé¢å¿…é¡»è·Ÿ breakï¼Œä¸ç„¶ç¨‹åºä¼šä¸€ä¸ªä¸ª case æ‰§è¡Œä¸‹å»ï¼Œç›´åˆ°æœ€åä¸€ä¸ª break çš„ case æˆ–è€… default å‡ºç°ã€‚</p>\n</li>\n<li><p>case æ¡ä»¶é‡Œé¢åªèƒ½æ˜¯å¸¸é‡æˆ–è€…å­—é¢å¸¸é‡ã€‚</p>\n</li>\n<li><p>default è¯­å¥å¯æœ‰å¯æ— ï¼Œæœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªã€‚</p>\n</li>\n</ol>\n<p>æœ‰é—®é¢˜è¯·ç•™è¨€ï¼Œå¸Œæœ›æœ¬æ–‡èƒ½å¯¹ä½ æœ‰æœ‰æ‰€å¸®åŠ©ï¼</p>\n"},{"title":"switchå¤šå€¼åŒ¹é…éªšæ“ä½œï¼Œå¸¦ä½ æ¶¨å§¿åŠ¿ï¼","date":"2025-10-14T06:42:34.000Z","_content":"\næˆ‘ä»¬éƒ½çŸ¥é“ `switch` ç”¨æ¥èµ°æµç¨‹åˆ†æ”¯ï¼Œå¤§å¤šæƒ…å†µä¸‹ç”¨æ¥åŒ¹é…å•ä¸ªå€¼ï¼Œå¦‚ä¸‹é¢çš„ä¾‹å­æ‰€ç¤ºï¼š\n\n```\n/**\n * @from \n * @author æ ˆé•¿\n */\nprivate static void test(int value) {\n    switch (value) {\n        case 1:\n            System.out.println(\"1\");\n            break;\n        case 2:\n            System.out.println(\"1\");\n            break;\n        case 3:\n            System.out.println(\"1\");\n            break;\n        case 4:\n            System.out.println(\"1\");\n            break;\n        case 5:\n            System.out.println(\"1\");\n            break;\n        case 6:\n            System.out.println(\"0\");\n            break;\n        case 7:\n            System.out.println(\"0\");\n            break;\n        default:\n            System.out.println(\"-1\");\n    }\n}\n```\n\nç›¸å…³é˜…è¯»ï¼š[switch case æ”¯æŒçš„ 6 ç§æ•°æ®ç±»å‹](https://mp.weixin.qq.com/s/QuchavZfEexwAgUS5qgB_Q)ã€‚\n\nå¤§æ¦‚çš„æ„æ€å°±æ˜¯ï¼Œå‘¨ä¸€åˆ°å‘¨äº”è¾“å‡ºï¼š1ï¼Œå‘¨å…­åˆ°å‘¨æ—¥è¾“å‡ºï¼š0ï¼Œé»˜è®¤è¾“å‡º-1ã€‚\n\nè¿™æ ·å†™ï¼Œå¾ˆå¤šé‡å¤çš„é€»è¾‘ï¼Œå†—ä½™äº†ã€‚\n\nä¹Ÿè®¸è¿™ä¸ªä¾‹å­ä¸æ˜¯å¾ˆåˆé€‚ï¼Œç”¨ if/ else æ›´æ°å½“ï¼Œä½†è¿™åªæ˜¯ä¸ªä¾‹å­ï¼Œå®é™…å¼€å‘ä¸­è‚¯å®šä¼šæœ‰æŸå‡ ä¸ª case åŒ¹é…åŒä¸€æ®µé€»è¾‘çš„æƒ…å†µã€‚\n\né‚£ä¹ˆï¼Œå¦‚ä½•è®©å¤šä¸ª case åŒ¹é…åŒä¸€æ®µé€»è¾‘å‘¢ï¼Ÿ\n\nå¦‚ä¸‹é¢ä¾‹å­æ‰€ç¤ºï¼š\n\n```\n/**\n * \n * @author æ ˆé•¿\n */\nprivate static void test(int value) {\n    switch (value) {\n        case 1: case 2: case 3: case 4: case 5:\n            System.out.println(\"1\");\n            break;\n        case 6: case 7:\n            System.out.println(\"0\");\n            break;\n        default:\n            System.out.println(\"-1\");\n    }\n}\n```\n\næŠŠç›¸åŒé€»è¾‘çš„ case æ”¾ä¸€èµ·ï¼Œæœ€åä¸€ä¸ª case å†™é€»è¾‘å°±è¡Œäº†ã€‚\n\næ ¼å¼åŒ–åå°±æ˜¯è¿™æ ·äº†ï¼š\n\n```\n/**\n * \n * @author æ ˆé•¿\n */\nprivate static void test(int value) {\n    switch (value) {\n        case 1: \n        case 2: \n        case 3: \n        case 4: \n        case 5:\n            System.out.println(\"1\");\n            break;\n        case 6: \n        case 7:\n            System.out.println(\"0\");\n            break;\n        default:\n            System.out.println(\"-1\");\n    }\n}\n```\n\næ˜¯ä¸æ˜¯å¾ˆéªšï¼Ÿ\n\nå…¶å®è¿™ä¸æ˜¯æœ€åˆé€‚çš„æœ€å¥½çš„å†™æ³•ï¼Œåœ¨ Java 12 ä¸­è¿˜å¯ä»¥æ›´éªšã€‚\n\nåœ¨ Java 12 ä¸­å¯ä»¥ç”¨é€—å·æ¥åˆ†å¼€å¤šä¸ªå€¼ï¼Œè¿˜èƒ½ç”¨ `lambda` è¡¨è¾¾å¼ï¼Œç”šè‡³è¿˜èƒ½çœç•¥ breakï¼Œä½¿ç”¨ `switch` æ›´æ–¹ä¾¿ã€‚\n\n","source":"_posts/åŸºç¡€/switchå¤šå€¼åŒ¹é…éªšæ“ä½œï¼Œå¸¦ä½ æ¶¨å§¿åŠ¿ï¼.md","raw":"---\ntitle: switchå¤šå€¼åŒ¹é…éªšæ“ä½œï¼Œå¸¦ä½ æ¶¨å§¿åŠ¿ï¼\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: åŸºç¡€\n---\n\næˆ‘ä»¬éƒ½çŸ¥é“ `switch` ç”¨æ¥èµ°æµç¨‹åˆ†æ”¯ï¼Œå¤§å¤šæƒ…å†µä¸‹ç”¨æ¥åŒ¹é…å•ä¸ªå€¼ï¼Œå¦‚ä¸‹é¢çš„ä¾‹å­æ‰€ç¤ºï¼š\n\n```\n/**\n * @from \n * @author æ ˆé•¿\n */\nprivate static void test(int value) {\n    switch (value) {\n        case 1:\n            System.out.println(\"1\");\n            break;\n        case 2:\n            System.out.println(\"1\");\n            break;\n        case 3:\n            System.out.println(\"1\");\n            break;\n        case 4:\n            System.out.println(\"1\");\n            break;\n        case 5:\n            System.out.println(\"1\");\n            break;\n        case 6:\n            System.out.println(\"0\");\n            break;\n        case 7:\n            System.out.println(\"0\");\n            break;\n        default:\n            System.out.println(\"-1\");\n    }\n}\n```\n\nç›¸å…³é˜…è¯»ï¼š[switch case æ”¯æŒçš„ 6 ç§æ•°æ®ç±»å‹](https://mp.weixin.qq.com/s/QuchavZfEexwAgUS5qgB_Q)ã€‚\n\nå¤§æ¦‚çš„æ„æ€å°±æ˜¯ï¼Œå‘¨ä¸€åˆ°å‘¨äº”è¾“å‡ºï¼š1ï¼Œå‘¨å…­åˆ°å‘¨æ—¥è¾“å‡ºï¼š0ï¼Œé»˜è®¤è¾“å‡º-1ã€‚\n\nè¿™æ ·å†™ï¼Œå¾ˆå¤šé‡å¤çš„é€»è¾‘ï¼Œå†—ä½™äº†ã€‚\n\nä¹Ÿè®¸è¿™ä¸ªä¾‹å­ä¸æ˜¯å¾ˆåˆé€‚ï¼Œç”¨ if/ else æ›´æ°å½“ï¼Œä½†è¿™åªæ˜¯ä¸ªä¾‹å­ï¼Œå®é™…å¼€å‘ä¸­è‚¯å®šä¼šæœ‰æŸå‡ ä¸ª case åŒ¹é…åŒä¸€æ®µé€»è¾‘çš„æƒ…å†µã€‚\n\né‚£ä¹ˆï¼Œå¦‚ä½•è®©å¤šä¸ª case åŒ¹é…åŒä¸€æ®µé€»è¾‘å‘¢ï¼Ÿ\n\nå¦‚ä¸‹é¢ä¾‹å­æ‰€ç¤ºï¼š\n\n```\n/**\n * \n * @author æ ˆé•¿\n */\nprivate static void test(int value) {\n    switch (value) {\n        case 1: case 2: case 3: case 4: case 5:\n            System.out.println(\"1\");\n            break;\n        case 6: case 7:\n            System.out.println(\"0\");\n            break;\n        default:\n            System.out.println(\"-1\");\n    }\n}\n```\n\næŠŠç›¸åŒé€»è¾‘çš„ case æ”¾ä¸€èµ·ï¼Œæœ€åä¸€ä¸ª case å†™é€»è¾‘å°±è¡Œäº†ã€‚\n\næ ¼å¼åŒ–åå°±æ˜¯è¿™æ ·äº†ï¼š\n\n```\n/**\n * \n * @author æ ˆé•¿\n */\nprivate static void test(int value) {\n    switch (value) {\n        case 1: \n        case 2: \n        case 3: \n        case 4: \n        case 5:\n            System.out.println(\"1\");\n            break;\n        case 6: \n        case 7:\n            System.out.println(\"0\");\n            break;\n        default:\n            System.out.println(\"-1\");\n    }\n}\n```\n\næ˜¯ä¸æ˜¯å¾ˆéªšï¼Ÿ\n\nå…¶å®è¿™ä¸æ˜¯æœ€åˆé€‚çš„æœ€å¥½çš„å†™æ³•ï¼Œåœ¨ Java 12 ä¸­è¿˜å¯ä»¥æ›´éªšã€‚\n\nåœ¨ Java 12 ä¸­å¯ä»¥ç”¨é€—å·æ¥åˆ†å¼€å¤šä¸ªå€¼ï¼Œè¿˜èƒ½ç”¨ `lambda` è¡¨è¾¾å¼ï¼Œç”šè‡³è¿˜èƒ½çœç•¥ breakï¼Œä½¿ç”¨ `switch` æ›´æ–¹ä¾¿ã€‚\n\n","slug":"åŸºç¡€/switchå¤šå€¼åŒ¹é…éªšæ“ä½œï¼Œå¸¦ä½ æ¶¨å§¿åŠ¿ï¼","published":1,"updated":"2025-10-15T07:19:51.833Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076v003uqkd49gus83ml","content":"<p>æˆ‘ä»¬éƒ½çŸ¥é“ <code>switch</code> ç”¨æ¥èµ°æµç¨‹åˆ†æ”¯ï¼Œå¤§å¤šæƒ…å†µä¸‹ç”¨æ¥åŒ¹é…å•ä¸ªå€¼ï¼Œå¦‚ä¸‹é¢çš„ä¾‹å­æ‰€ç¤ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * @from \n * @author æ ˆé•¿\n *&#x2F;\nprivate static void test(int value) &#123;\n    switch (value) &#123;\n        case 1:\n            System.out.println(&quot;1&quot;);\n            break;\n        case 2:\n            System.out.println(&quot;1&quot;);\n            break;\n        case 3:\n            System.out.println(&quot;1&quot;);\n            break;\n        case 4:\n            System.out.println(&quot;1&quot;);\n            break;\n        case 5:\n            System.out.println(&quot;1&quot;);\n            break;\n        case 6:\n            System.out.println(&quot;0&quot;);\n            break;\n        case 7:\n            System.out.println(&quot;0&quot;);\n            break;\n        default:\n            System.out.println(&quot;-1&quot;);\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç›¸å…³é˜…è¯»ï¼š<a href=\"https://mp.weixin.qq.com/s/QuchavZfEexwAgUS5qgB_Q\">switch case æ”¯æŒçš„ 6 ç§æ•°æ®ç±»å‹</a>ã€‚</p>\n<p>å¤§æ¦‚çš„æ„æ€å°±æ˜¯ï¼Œå‘¨ä¸€åˆ°å‘¨äº”è¾“å‡ºï¼š1ï¼Œå‘¨å…­åˆ°å‘¨æ—¥è¾“å‡ºï¼š0ï¼Œé»˜è®¤è¾“å‡º-1ã€‚</p>\n<p>è¿™æ ·å†™ï¼Œå¾ˆå¤šé‡å¤çš„é€»è¾‘ï¼Œå†—ä½™äº†ã€‚</p>\n<p>ä¹Ÿè®¸è¿™ä¸ªä¾‹å­ä¸æ˜¯å¾ˆåˆé€‚ï¼Œç”¨ if&#x2F; else æ›´æ°å½“ï¼Œä½†è¿™åªæ˜¯ä¸ªä¾‹å­ï¼Œå®é™…å¼€å‘ä¸­è‚¯å®šä¼šæœ‰æŸå‡ ä¸ª case åŒ¹é…åŒä¸€æ®µé€»è¾‘çš„æƒ…å†µã€‚</p>\n<p>é‚£ä¹ˆï¼Œå¦‚ä½•è®©å¤šä¸ª case åŒ¹é…åŒä¸€æ®µé€»è¾‘å‘¢ï¼Ÿ</p>\n<p>å¦‚ä¸‹é¢ä¾‹å­æ‰€ç¤ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * \n * @author æ ˆé•¿\n *&#x2F;\nprivate static void test(int value) &#123;\n    switch (value) &#123;\n        case 1: case 2: case 3: case 4: case 5:\n            System.out.println(&quot;1&quot;);\n            break;\n        case 6: case 7:\n            System.out.println(&quot;0&quot;);\n            break;\n        default:\n            System.out.println(&quot;-1&quot;);\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æŠŠç›¸åŒé€»è¾‘çš„ case æ”¾ä¸€èµ·ï¼Œæœ€åä¸€ä¸ª case å†™é€»è¾‘å°±è¡Œäº†ã€‚</p>\n<p>æ ¼å¼åŒ–åå°±æ˜¯è¿™æ ·äº†ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * \n * @author æ ˆé•¿\n *&#x2F;\nprivate static void test(int value) &#123;\n    switch (value) &#123;\n        case 1: \n        case 2: \n        case 3: \n        case 4: \n        case 5:\n            System.out.println(&quot;1&quot;);\n            break;\n        case 6: \n        case 7:\n            System.out.println(&quot;0&quot;);\n            break;\n        default:\n            System.out.println(&quot;-1&quot;);\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ˜¯ä¸æ˜¯å¾ˆéªšï¼Ÿ</p>\n<p>å…¶å®è¿™ä¸æ˜¯æœ€åˆé€‚çš„æœ€å¥½çš„å†™æ³•ï¼Œåœ¨ Java 12 ä¸­è¿˜å¯ä»¥æ›´éªšã€‚</p>\n<p>åœ¨ Java 12 ä¸­å¯ä»¥ç”¨é€—å·æ¥åˆ†å¼€å¤šä¸ªå€¼ï¼Œè¿˜èƒ½ç”¨ <code>lambda</code> è¡¨è¾¾å¼ï¼Œç”šè‡³è¿˜èƒ½çœç•¥ breakï¼Œä½¿ç”¨ <code>switch</code> æ›´æ–¹ä¾¿ã€‚</p>\n","excerpt":"","more":"<p>æˆ‘ä»¬éƒ½çŸ¥é“ <code>switch</code> ç”¨æ¥èµ°æµç¨‹åˆ†æ”¯ï¼Œå¤§å¤šæƒ…å†µä¸‹ç”¨æ¥åŒ¹é…å•ä¸ªå€¼ï¼Œå¦‚ä¸‹é¢çš„ä¾‹å­æ‰€ç¤ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * @from \n * @author æ ˆé•¿\n *&#x2F;\nprivate static void test(int value) &#123;\n    switch (value) &#123;\n        case 1:\n            System.out.println(&quot;1&quot;);\n            break;\n        case 2:\n            System.out.println(&quot;1&quot;);\n            break;\n        case 3:\n            System.out.println(&quot;1&quot;);\n            break;\n        case 4:\n            System.out.println(&quot;1&quot;);\n            break;\n        case 5:\n            System.out.println(&quot;1&quot;);\n            break;\n        case 6:\n            System.out.println(&quot;0&quot;);\n            break;\n        case 7:\n            System.out.println(&quot;0&quot;);\n            break;\n        default:\n            System.out.println(&quot;-1&quot;);\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç›¸å…³é˜…è¯»ï¼š<a href=\"https://mp.weixin.qq.com/s/QuchavZfEexwAgUS5qgB_Q\">switch case æ”¯æŒçš„ 6 ç§æ•°æ®ç±»å‹</a>ã€‚</p>\n<p>å¤§æ¦‚çš„æ„æ€å°±æ˜¯ï¼Œå‘¨ä¸€åˆ°å‘¨äº”è¾“å‡ºï¼š1ï¼Œå‘¨å…­åˆ°å‘¨æ—¥è¾“å‡ºï¼š0ï¼Œé»˜è®¤è¾“å‡º-1ã€‚</p>\n<p>è¿™æ ·å†™ï¼Œå¾ˆå¤šé‡å¤çš„é€»è¾‘ï¼Œå†—ä½™äº†ã€‚</p>\n<p>ä¹Ÿè®¸è¿™ä¸ªä¾‹å­ä¸æ˜¯å¾ˆåˆé€‚ï¼Œç”¨ if&#x2F; else æ›´æ°å½“ï¼Œä½†è¿™åªæ˜¯ä¸ªä¾‹å­ï¼Œå®é™…å¼€å‘ä¸­è‚¯å®šä¼šæœ‰æŸå‡ ä¸ª case åŒ¹é…åŒä¸€æ®µé€»è¾‘çš„æƒ…å†µã€‚</p>\n<p>é‚£ä¹ˆï¼Œå¦‚ä½•è®©å¤šä¸ª case åŒ¹é…åŒä¸€æ®µé€»è¾‘å‘¢ï¼Ÿ</p>\n<p>å¦‚ä¸‹é¢ä¾‹å­æ‰€ç¤ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * \n * @author æ ˆé•¿\n *&#x2F;\nprivate static void test(int value) &#123;\n    switch (value) &#123;\n        case 1: case 2: case 3: case 4: case 5:\n            System.out.println(&quot;1&quot;);\n            break;\n        case 6: case 7:\n            System.out.println(&quot;0&quot;);\n            break;\n        default:\n            System.out.println(&quot;-1&quot;);\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æŠŠç›¸åŒé€»è¾‘çš„ case æ”¾ä¸€èµ·ï¼Œæœ€åä¸€ä¸ª case å†™é€»è¾‘å°±è¡Œäº†ã€‚</p>\n<p>æ ¼å¼åŒ–åå°±æ˜¯è¿™æ ·äº†ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * \n * @author æ ˆé•¿\n *&#x2F;\nprivate static void test(int value) &#123;\n    switch (value) &#123;\n        case 1: \n        case 2: \n        case 3: \n        case 4: \n        case 5:\n            System.out.println(&quot;1&quot;);\n            break;\n        case 6: \n        case 7:\n            System.out.println(&quot;0&quot;);\n            break;\n        default:\n            System.out.println(&quot;-1&quot;);\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ˜¯ä¸æ˜¯å¾ˆéªšï¼Ÿ</p>\n<p>å…¶å®è¿™ä¸æ˜¯æœ€åˆé€‚çš„æœ€å¥½çš„å†™æ³•ï¼Œåœ¨ Java 12 ä¸­è¿˜å¯ä»¥æ›´éªšã€‚</p>\n<p>åœ¨ Java 12 ä¸­å¯ä»¥ç”¨é€—å·æ¥åˆ†å¼€å¤šä¸ªå€¼ï¼Œè¿˜èƒ½ç”¨ <code>lambda</code> è¡¨è¾¾å¼ï¼Œç”šè‡³è¿˜èƒ½çœç•¥ breakï¼Œä½¿ç”¨ <code>switch</code> æ›´æ–¹ä¾¿ã€‚</p>\n"},{"title":"ä¸€å¼ å›¾ææ¸…æ¥šJavaå¼‚å¸¸æœºåˆ¶","date":"2025-10-14T06:42:34.000Z","_content":"\nä¸‹é¢æ˜¯Javaå¼‚å¸¸ç±»çš„ç»„ç»‡ç»“æ„ï¼Œçº¢è‰²åŒºåŸŸçš„å¼‚å¸¸ç±»è¡¨ç¤ºæ˜¯ç¨‹åºéœ€è¦æ˜¾ç¤ºæ•æ‰æˆ–è€…æŠ›å‡ºçš„ã€‚\n\n![image](https://www.programcreek.com/wp-content/uploads/2009/02/Exception-Hierarchy-Diagram.jpeg)\n\n### Throwable\nThrowableæ˜¯Javaå¼‚å¸¸çš„é¡¶çº§ç±»ï¼Œæ‰€æœ‰çš„å¼‚å¸¸éƒ½ç»§æ‰¿äºè¿™ä¸ªç±»ã€‚\n\nErrorï¼ŒExceptionæ˜¯å¼‚å¸¸ç±»çš„ä¸¤ä¸ªå¤§åˆ†ç±»ã€‚\n\n### Error\n\nErroræ˜¯éç¨‹åºå¼‚å¸¸ï¼Œå³ç¨‹åºä¸èƒ½æ•è·çš„å¼‚å¸¸ï¼Œä¸€èˆ¬æ˜¯ç¼–è¯‘æˆ–è€…ç³»ç»Ÿæ€§çš„é”™è¯¯ï¼Œå¦‚OutOfMemorryå†…å­˜æº¢å‡ºå¼‚å¸¸ç­‰ã€‚\n\n### Exception\nExceptionæ˜¯ç¨‹åºå¼‚å¸¸ç±»ï¼Œç”±ç¨‹åºå†…éƒ¨äº§ç”Ÿã€‚Exceptionåˆåˆ†ä¸ºè¿è¡Œæ—¶å¼‚å¸¸ã€éè¿è¡Œæ—¶å¼‚å¸¸ã€‚\n\n#### è¿è¡Œæ—¶å¼‚å¸¸\n\nè¿è¡Œæ—¶å¼‚å¸¸çš„ç‰¹ç‚¹æ˜¯Javaç¼–è¯‘å™¨ä¸ä¼šæ£€æŸ¥å®ƒï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ç¨‹åºä¸­å¯èƒ½å‡ºç°è¿™ç±»å¼‚å¸¸ï¼Œå³ä½¿æ²¡æœ‰ç”¨try-catchè¯­å¥æ•è·å®ƒï¼Œä¹Ÿæ²¡æœ‰ç”¨throwså­å¥å£°æ˜æŠ›å‡ºå®ƒï¼Œä¹Ÿä¼šç¼–è¯‘é€šè¿‡ï¼Œè¿è¡Œæ—¶å¼‚å¸¸å¯å¤„ç†æˆ–è€…ä¸å¤„ç†ã€‚è¿è¡Œæ—¶å¼‚å¸¸ä¸€èˆ¬å¸¸å‡ºæ¥å®šä¹‰ç³»ç»Ÿçš„è‡ªå®šä¹‰å¼‚å¸¸ï¼Œä¸šåŠ¡æ ¹æ®è‡ªå®šä¹‰å¼‚å¸¸åšå‡ºä¸åŒçš„å¤„ç†ã€‚\n\nå¸¸è§çš„è¿è¡Œæ—¶å¼‚å¸¸å¦‚NullPointExceptionã€ArrayIndexOutOfBoundsExceptionç­‰ã€‚\n\n#### éè¿è¡Œæ—¶å¼‚å¸¸\n\néè¿è¡Œæ—¶å¼‚å¸¸æ˜¯ç¨‹åºå¿…é¡»è¿›è¡Œå¤„ç†çš„å¼‚å¸¸ï¼Œæ•è·æˆ–è€…æŠ›å‡ºï¼Œå¦‚æœä¸å¤„ç†ç¨‹åºå°±ä¸èƒ½ç¼–è¯‘é€šè¿‡ã€‚å¦‚å¸¸è§çš„IOExceptionã€ClassNotFoundExceptionç­‰ã€‚\n\n","source":"_posts/åŸºç¡€/ä¸€å¼ å›¾ææ¸…æ¥šJavaå¼‚å¸¸æœºåˆ¶.md","raw":"---\ntitle: ä¸€å¼ å›¾ææ¸…æ¥šJavaå¼‚å¸¸æœºåˆ¶\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: åŸºç¡€\n---\n\nä¸‹é¢æ˜¯Javaå¼‚å¸¸ç±»çš„ç»„ç»‡ç»“æ„ï¼Œçº¢è‰²åŒºåŸŸçš„å¼‚å¸¸ç±»è¡¨ç¤ºæ˜¯ç¨‹åºéœ€è¦æ˜¾ç¤ºæ•æ‰æˆ–è€…æŠ›å‡ºçš„ã€‚\n\n![image](https://www.programcreek.com/wp-content/uploads/2009/02/Exception-Hierarchy-Diagram.jpeg)\n\n### Throwable\nThrowableæ˜¯Javaå¼‚å¸¸çš„é¡¶çº§ç±»ï¼Œæ‰€æœ‰çš„å¼‚å¸¸éƒ½ç»§æ‰¿äºè¿™ä¸ªç±»ã€‚\n\nErrorï¼ŒExceptionæ˜¯å¼‚å¸¸ç±»çš„ä¸¤ä¸ªå¤§åˆ†ç±»ã€‚\n\n### Error\n\nErroræ˜¯éç¨‹åºå¼‚å¸¸ï¼Œå³ç¨‹åºä¸èƒ½æ•è·çš„å¼‚å¸¸ï¼Œä¸€èˆ¬æ˜¯ç¼–è¯‘æˆ–è€…ç³»ç»Ÿæ€§çš„é”™è¯¯ï¼Œå¦‚OutOfMemorryå†…å­˜æº¢å‡ºå¼‚å¸¸ç­‰ã€‚\n\n### Exception\nExceptionæ˜¯ç¨‹åºå¼‚å¸¸ç±»ï¼Œç”±ç¨‹åºå†…éƒ¨äº§ç”Ÿã€‚Exceptionåˆåˆ†ä¸ºè¿è¡Œæ—¶å¼‚å¸¸ã€éè¿è¡Œæ—¶å¼‚å¸¸ã€‚\n\n#### è¿è¡Œæ—¶å¼‚å¸¸\n\nè¿è¡Œæ—¶å¼‚å¸¸çš„ç‰¹ç‚¹æ˜¯Javaç¼–è¯‘å™¨ä¸ä¼šæ£€æŸ¥å®ƒï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ç¨‹åºä¸­å¯èƒ½å‡ºç°è¿™ç±»å¼‚å¸¸ï¼Œå³ä½¿æ²¡æœ‰ç”¨try-catchè¯­å¥æ•è·å®ƒï¼Œä¹Ÿæ²¡æœ‰ç”¨throwså­å¥å£°æ˜æŠ›å‡ºå®ƒï¼Œä¹Ÿä¼šç¼–è¯‘é€šè¿‡ï¼Œè¿è¡Œæ—¶å¼‚å¸¸å¯å¤„ç†æˆ–è€…ä¸å¤„ç†ã€‚è¿è¡Œæ—¶å¼‚å¸¸ä¸€èˆ¬å¸¸å‡ºæ¥å®šä¹‰ç³»ç»Ÿçš„è‡ªå®šä¹‰å¼‚å¸¸ï¼Œä¸šåŠ¡æ ¹æ®è‡ªå®šä¹‰å¼‚å¸¸åšå‡ºä¸åŒçš„å¤„ç†ã€‚\n\nå¸¸è§çš„è¿è¡Œæ—¶å¼‚å¸¸å¦‚NullPointExceptionã€ArrayIndexOutOfBoundsExceptionç­‰ã€‚\n\n#### éè¿è¡Œæ—¶å¼‚å¸¸\n\néè¿è¡Œæ—¶å¼‚å¸¸æ˜¯ç¨‹åºå¿…é¡»è¿›è¡Œå¤„ç†çš„å¼‚å¸¸ï¼Œæ•è·æˆ–è€…æŠ›å‡ºï¼Œå¦‚æœä¸å¤„ç†ç¨‹åºå°±ä¸èƒ½ç¼–è¯‘é€šè¿‡ã€‚å¦‚å¸¸è§çš„IOExceptionã€ClassNotFoundExceptionç­‰ã€‚\n\n","slug":"åŸºç¡€/ä¸€å¼ å›¾ææ¸…æ¥šJavaå¼‚å¸¸æœºåˆ¶","published":1,"updated":"2025-10-15T07:19:51.824Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076v003xqkd4ajswdron","content":"<p>ä¸‹é¢æ˜¯Javaå¼‚å¸¸ç±»çš„ç»„ç»‡ç»“æ„ï¼Œçº¢è‰²åŒºåŸŸçš„å¼‚å¸¸ç±»è¡¨ç¤ºæ˜¯ç¨‹åºéœ€è¦æ˜¾ç¤ºæ•æ‰æˆ–è€…æŠ›å‡ºçš„ã€‚</p>\n<p><img src=\"https://www.programcreek.com/wp-content/uploads/2009/02/Exception-Hierarchy-Diagram.jpeg\" alt=\"image\"></p>\n<h3 id=\"Throwable\"><a href=\"#Throwable\" class=\"headerlink\" title=\"Throwable\"></a>Throwable</h3><p>Throwableæ˜¯Javaå¼‚å¸¸çš„é¡¶çº§ç±»ï¼Œæ‰€æœ‰çš„å¼‚å¸¸éƒ½ç»§æ‰¿äºè¿™ä¸ªç±»ã€‚</p>\n<p>Errorï¼ŒExceptionæ˜¯å¼‚å¸¸ç±»çš„ä¸¤ä¸ªå¤§åˆ†ç±»ã€‚</p>\n<h3 id=\"Error\"><a href=\"#Error\" class=\"headerlink\" title=\"Error\"></a>Error</h3><p>Erroræ˜¯éç¨‹åºå¼‚å¸¸ï¼Œå³ç¨‹åºä¸èƒ½æ•è·çš„å¼‚å¸¸ï¼Œä¸€èˆ¬æ˜¯ç¼–è¯‘æˆ–è€…ç³»ç»Ÿæ€§çš„é”™è¯¯ï¼Œå¦‚OutOfMemorryå†…å­˜æº¢å‡ºå¼‚å¸¸ç­‰ã€‚</p>\n<h3 id=\"Exception\"><a href=\"#Exception\" class=\"headerlink\" title=\"Exception\"></a>Exception</h3><p>Exceptionæ˜¯ç¨‹åºå¼‚å¸¸ç±»ï¼Œç”±ç¨‹åºå†…éƒ¨äº§ç”Ÿã€‚Exceptionåˆåˆ†ä¸ºè¿è¡Œæ—¶å¼‚å¸¸ã€éè¿è¡Œæ—¶å¼‚å¸¸ã€‚</p>\n<h4 id=\"è¿è¡Œæ—¶å¼‚å¸¸\"><a href=\"#è¿è¡Œæ—¶å¼‚å¸¸\" class=\"headerlink\" title=\"è¿è¡Œæ—¶å¼‚å¸¸\"></a>è¿è¡Œæ—¶å¼‚å¸¸</h4><p>è¿è¡Œæ—¶å¼‚å¸¸çš„ç‰¹ç‚¹æ˜¯Javaç¼–è¯‘å™¨ä¸ä¼šæ£€æŸ¥å®ƒï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ç¨‹åºä¸­å¯èƒ½å‡ºç°è¿™ç±»å¼‚å¸¸ï¼Œå³ä½¿æ²¡æœ‰ç”¨try-catchè¯­å¥æ•è·å®ƒï¼Œä¹Ÿæ²¡æœ‰ç”¨throwså­å¥å£°æ˜æŠ›å‡ºå®ƒï¼Œä¹Ÿä¼šç¼–è¯‘é€šè¿‡ï¼Œè¿è¡Œæ—¶å¼‚å¸¸å¯å¤„ç†æˆ–è€…ä¸å¤„ç†ã€‚è¿è¡Œæ—¶å¼‚å¸¸ä¸€èˆ¬å¸¸å‡ºæ¥å®šä¹‰ç³»ç»Ÿçš„è‡ªå®šä¹‰å¼‚å¸¸ï¼Œä¸šåŠ¡æ ¹æ®è‡ªå®šä¹‰å¼‚å¸¸åšå‡ºä¸åŒçš„å¤„ç†ã€‚</p>\n<p>å¸¸è§çš„è¿è¡Œæ—¶å¼‚å¸¸å¦‚NullPointExceptionã€ArrayIndexOutOfBoundsExceptionç­‰ã€‚</p>\n<h4 id=\"éè¿è¡Œæ—¶å¼‚å¸¸\"><a href=\"#éè¿è¡Œæ—¶å¼‚å¸¸\" class=\"headerlink\" title=\"éè¿è¡Œæ—¶å¼‚å¸¸\"></a>éè¿è¡Œæ—¶å¼‚å¸¸</h4><p>éè¿è¡Œæ—¶å¼‚å¸¸æ˜¯ç¨‹åºå¿…é¡»è¿›è¡Œå¤„ç†çš„å¼‚å¸¸ï¼Œæ•è·æˆ–è€…æŠ›å‡ºï¼Œå¦‚æœä¸å¤„ç†ç¨‹åºå°±ä¸èƒ½ç¼–è¯‘é€šè¿‡ã€‚å¦‚å¸¸è§çš„IOExceptionã€ClassNotFoundExceptionç­‰ã€‚</p>\n","excerpt":"","more":"<p>ä¸‹é¢æ˜¯Javaå¼‚å¸¸ç±»çš„ç»„ç»‡ç»“æ„ï¼Œçº¢è‰²åŒºåŸŸçš„å¼‚å¸¸ç±»è¡¨ç¤ºæ˜¯ç¨‹åºéœ€è¦æ˜¾ç¤ºæ•æ‰æˆ–è€…æŠ›å‡ºçš„ã€‚</p>\n<p><img src=\"https://www.programcreek.com/wp-content/uploads/2009/02/Exception-Hierarchy-Diagram.jpeg\" alt=\"image\"></p>\n<h3 id=\"Throwable\"><a href=\"#Throwable\" class=\"headerlink\" title=\"Throwable\"></a>Throwable</h3><p>Throwableæ˜¯Javaå¼‚å¸¸çš„é¡¶çº§ç±»ï¼Œæ‰€æœ‰çš„å¼‚å¸¸éƒ½ç»§æ‰¿äºè¿™ä¸ªç±»ã€‚</p>\n<p>Errorï¼ŒExceptionæ˜¯å¼‚å¸¸ç±»çš„ä¸¤ä¸ªå¤§åˆ†ç±»ã€‚</p>\n<h3 id=\"Error\"><a href=\"#Error\" class=\"headerlink\" title=\"Error\"></a>Error</h3><p>Erroræ˜¯éç¨‹åºå¼‚å¸¸ï¼Œå³ç¨‹åºä¸èƒ½æ•è·çš„å¼‚å¸¸ï¼Œä¸€èˆ¬æ˜¯ç¼–è¯‘æˆ–è€…ç³»ç»Ÿæ€§çš„é”™è¯¯ï¼Œå¦‚OutOfMemorryå†…å­˜æº¢å‡ºå¼‚å¸¸ç­‰ã€‚</p>\n<h3 id=\"Exception\"><a href=\"#Exception\" class=\"headerlink\" title=\"Exception\"></a>Exception</h3><p>Exceptionæ˜¯ç¨‹åºå¼‚å¸¸ç±»ï¼Œç”±ç¨‹åºå†…éƒ¨äº§ç”Ÿã€‚Exceptionåˆåˆ†ä¸ºè¿è¡Œæ—¶å¼‚å¸¸ã€éè¿è¡Œæ—¶å¼‚å¸¸ã€‚</p>\n<h4 id=\"è¿è¡Œæ—¶å¼‚å¸¸\"><a href=\"#è¿è¡Œæ—¶å¼‚å¸¸\" class=\"headerlink\" title=\"è¿è¡Œæ—¶å¼‚å¸¸\"></a>è¿è¡Œæ—¶å¼‚å¸¸</h4><p>è¿è¡Œæ—¶å¼‚å¸¸çš„ç‰¹ç‚¹æ˜¯Javaç¼–è¯‘å™¨ä¸ä¼šæ£€æŸ¥å®ƒï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå½“ç¨‹åºä¸­å¯èƒ½å‡ºç°è¿™ç±»å¼‚å¸¸ï¼Œå³ä½¿æ²¡æœ‰ç”¨try-catchè¯­å¥æ•è·å®ƒï¼Œä¹Ÿæ²¡æœ‰ç”¨throwså­å¥å£°æ˜æŠ›å‡ºå®ƒï¼Œä¹Ÿä¼šç¼–è¯‘é€šè¿‡ï¼Œè¿è¡Œæ—¶å¼‚å¸¸å¯å¤„ç†æˆ–è€…ä¸å¤„ç†ã€‚è¿è¡Œæ—¶å¼‚å¸¸ä¸€èˆ¬å¸¸å‡ºæ¥å®šä¹‰ç³»ç»Ÿçš„è‡ªå®šä¹‰å¼‚å¸¸ï¼Œä¸šåŠ¡æ ¹æ®è‡ªå®šä¹‰å¼‚å¸¸åšå‡ºä¸åŒçš„å¤„ç†ã€‚</p>\n<p>å¸¸è§çš„è¿è¡Œæ—¶å¼‚å¸¸å¦‚NullPointExceptionã€ArrayIndexOutOfBoundsExceptionç­‰ã€‚</p>\n<h4 id=\"éè¿è¡Œæ—¶å¼‚å¸¸\"><a href=\"#éè¿è¡Œæ—¶å¼‚å¸¸\" class=\"headerlink\" title=\"éè¿è¡Œæ—¶å¼‚å¸¸\"></a>éè¿è¡Œæ—¶å¼‚å¸¸</h4><p>éè¿è¡Œæ—¶å¼‚å¸¸æ˜¯ç¨‹åºå¿…é¡»è¿›è¡Œå¤„ç†çš„å¼‚å¸¸ï¼Œæ•è·æˆ–è€…æŠ›å‡ºï¼Œå¦‚æœä¸å¤„ç†ç¨‹åºå°±ä¸èƒ½ç¼–è¯‘é€šè¿‡ã€‚å¦‚å¸¸è§çš„IOExceptionã€ClassNotFoundExceptionç­‰ã€‚</p>\n"},{"title":"ä½ çœŸçš„ææ‡‚ transient  å…³é”®å­—äº†å—ï¼Ÿ","date":"2025-10-14T06:42:34.000Z","_content":"\n## å…ˆè§£é‡Šä¸‹ä»€ä¹ˆæ˜¯åºåˆ—åŒ–\n\næˆ‘ä»¬çš„å¯¹è±¡å¹¶ä¸åªæ˜¯å­˜åœ¨å†…å­˜ä¸­ï¼Œè¿˜éœ€è¦ä¼ è¾“ç½‘ç»œï¼Œæˆ–è€…ä¿å­˜èµ·æ¥ä¸‹æ¬¡å†åŠ è½½å‡ºæ¥ç”¨ï¼Œæ‰€ä»¥éœ€è¦Javaåºåˆ—åŒ–æŠ€æœ¯ã€‚\n\nJavaåºåˆ—åŒ–æŠ€æœ¯æ­£æ˜¯å°†å¯¹è±¡è½¬å˜æˆä¸€ä¸²ç”±äºŒè¿›åˆ¶å­—èŠ‚ç»„æˆçš„æ•°ç»„ï¼Œå¯ä»¥é€šè¿‡å°†äºŒè¿›åˆ¶æ•°æ®ä¿å­˜åˆ°ç£ç›˜æˆ–è€…ä¼ è¾“ç½‘ç»œï¼Œç£ç›˜æˆ–è€…ç½‘ç»œæ¥æ”¶è€…å¯ä»¥åœ¨å¯¹è±¡çš„å±ç±»çš„æ¨¡æ¿ä¸Šæ¥ååºåˆ—åŒ–ç±»çš„å¯¹è±¡ï¼Œè¾¾åˆ°å¯¹è±¡æŒä¹…åŒ–çš„ç›®çš„ã€‚\n\næ›´å¤šåºåˆ—åŒ–è¯·å‚è€ƒï¼šã€Š[å…³äºJavaåºåˆ—åŒ–ä½ åº”è¯¥çŸ¥é“çš„ä¸€åˆ‡](https://mp.weixin.qq.com/s/wHmK1kKyne6gCkIxt0NERQ)ã€‹è¿™ç¯‡æ–‡ç« ã€‚\n\n## ä»€ä¹ˆæ˜¯ transientï¼Ÿ\n\nç®€å•æ¥è¯´å°±æ˜¯ï¼Œè¢« transient ä¿®é¥°çš„å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ã€‚\n\n**å…·ä½“æ¥çœ‹ä¸‹é¢çš„ç¤ºä¾‹1**\n\n```\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutputStream;\nimport java.io.Serializable;\n\n/**\n * @author \n */\npublic class TransientTest {\n\n\tpublic static void main(String[] args) throws Exception {\n\n\t\tUser user = new User();\n\t\tuser.setUsername(\"JavaæŠ€æœ¯\");\n\t\tuser.setId(\"javastack\");\n\n\t\tSystem.out.println(\"\\nåºåˆ—åŒ–ä¹‹å‰\");\n\t\tSystem.out.println(\"username: \" + user.getUsername());\n\t\tSystem.out.println(\"id: \" + user.getId());\n\n\t\tObjectOutputStream os = new ObjectOutputStream(new FileOutputStream(\"d:/user.txt\"));\n\t\tos.writeObject(user);\n\t\tos.flush();\n\t\tos.close();\n\n\t\tObjectInputStream is = new ObjectInputStream(new FileInputStream(\"d:/user.txt\"));\n\t\tuser = (User) is.readObject();\n\t\tis.close();\n\n\t\tSystem.out.println(\"\\nåºåˆ—åŒ–ä¹‹å\");\n\t\tSystem.out.println(\"username: \" + user.getUsername());\n\t\tSystem.out.println(\"id: \" + user.getId());\n\n\t}\n}\n\n/**\n * @author \n */\nclass User implements Serializable {\n\n\tprivate static final long serialVersionUID = 1L;\n\n\tprivate String username;\n\tprivate transient String id;\n\n\tpublic String getUsername() {\n\t\treturn username;\n\t}\n\n\tpublic void setUsername(String username) {\n\t\tthis.username = username;\n\t}\n\n\tpublic String getId() {\n\t\treturn id;\n\t}\n\n\tpublic void setId(String id) {\n\t\tthis.id = id;\n\t}\n\n}\n```\n\n**è¾“å‡ºç»“æœï¼š**\n\n```\nåºåˆ—åŒ–ä¹‹å‰\nusername: JavaæŠ€æœ¯\nid: javastack\n\nåºåˆ—åŒ–ä¹‹å\nusername: JavaæŠ€æœ¯\nid: null\n```\n\nç¤ºä¾‹1åœ¨ id å­—æ®µä¸ŠåŠ äº† transient å…³é”®å­—ä¿®é¥°ï¼Œååºåˆ—åŒ–å‡ºæ¥ä¹‹åå€¼ä¸º nullï¼Œè¯´æ˜äº†è¢« transient ä¿®é¥°çš„å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ã€‚\n\n## é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\n\nè¿™ä¸ªè¯é¢˜ä¹Ÿæ˜¯æœ€è¿‘æ ˆé•¿çš„JavaæŠ€æœ¯vipç¾¤é‡Œé¢è®¨è®ºçš„ï¼Œå¤§å®¶å¯¹è¿™ä¸ªçŸ¥è¯†ç‚¹æ¯”è¾ƒæ¨¡ç³Šï¼Œæˆ‘å°±å†™äº†è¿™ç¯‡æ–‡ç« æµ‹è¯•æ€»ç»“ä¸€ä¸‹ã€‚\n\n![](http://img.javastack.cn/å¾®ä¿¡å›¾ç‰‡_20190214162351.png)\n\n> å¦‚æœä½ ä¹Ÿæƒ³åŠ å…¥æˆ‘ä»¬çš„JavaæŠ€æœ¯vipç¾¤å’Œå„ä½å¤§ç‰›ä¸€èµ·è®¨è®ºæŠ€æœ¯ï¼Œé‚£ç‚¹å‡»[è¿™ä¸ªé“¾æ¥](https://mp.weixin.qq.com/s/iqCLAduVzDqt19L6D4FCUQ)äº†è§£åŠ å…¥å§ã€‚\n\né‚£ä¹ˆï¼Œåˆ°åº•é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼ŸåºŸè¯å°‘è¯´ï¼Œå…ˆåŠ¨æ‰‹æµ‹è¯•ä¸‹å§ï¼\n\nç¤ºä¾‹2ï¼š\n\n```\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutputStream;\nimport java.io.Serializable;\n\n/**\n * @author \n */\npublic class TransientStaticTest {\n\n\tpublic static void main(String[] args) throws Exception {\n\n\t\tUser2 user = new User2();\n\t\tUser2.username = \"JavaæŠ€æœ¯1\";\n\t\tuser.setId(\"javastack\");\n\n\t\tSystem.out.println(\"\\nåºåˆ—åŒ–ä¹‹å‰\");\n\t\tSystem.out.println(\"username: \" + user.getUsername());\n\t\tSystem.out.println(\"id: \" + user.getId());\n\n\t\tObjectOutputStream os = new ObjectOutputStream(new FileOutputStream(\"d:/user.txt\"));\n\t\tos.writeObject(user);\n\t\tos.flush();\n\t\tos.close();\n\t\t\n\t\t// åœ¨ååºåˆ—åŒ–å‡ºæ¥ä¹‹å‰ï¼Œæ”¹å˜é™æ€å˜é‡çš„å€¼\n\t\tUser2.username = \"JavaæŠ€æœ¯2\";\n\n\t\tObjectInputStream is = new ObjectInputStream(new FileInputStream(\"d:/user.txt\"));\n\t\tuser = (User2) is.readObject();\n\t\tis.close();\n\n\t\tSystem.out.println(\"\\nåºåˆ—åŒ–ä¹‹å\");\n\t\tSystem.out.println(\"username: \" + user.getUsername());\n\t\tSystem.out.println(\"id: \" + user.getId());\n\n\t}\n}\n\n/**\n * @author \n */\nclass User2 implements Serializable {\n\n\tprivate static final long serialVersionUID = 1L;\n\n\tpublic static String username;\n\tprivate transient String id;\n\n\tpublic String getUsername() {\n\t\treturn username;\n\t}\n\n\tpublic String getId() {\n\t\treturn id;\n\t}\n\n\tpublic void setId(String id) {\n\t\tthis.id = id;\n\t}\n\n}\n```\n\n**è¾“å‡ºç»“æœï¼š**\n\n```\nåºåˆ—åŒ–ä¹‹å‰\nusername: JavaæŠ€æœ¯1\nid: javastack\n\nåºåˆ—åŒ–ä¹‹å\nusername: JavaæŠ€æœ¯2\nid: null\n```\n\nç¤ºä¾‹2æŠŠ username æ”¹ä¸ºäº† public static, å¹¶åœ¨ååºåˆ—åŒ–å‡ºæ¥ä¹‹å‰æ”¹å˜äº†é™æ€å˜é‡çš„å€¼ï¼Œç»“æœå¯ä»¥çœ‹å‡ºåºåˆ—åŒ–ä¹‹åçš„å€¼å¹¶éåºåˆ—åŒ–è¿›å»æ—¶çš„å€¼ã€‚\n\nç”±ä»¥ä¸Šç»“æœåˆ†æå¯çŸ¥ï¼Œé™æ€å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ï¼Œç¤ºä¾‹2è¯»å–å‡ºæ¥çš„æ˜¯ username åœ¨ JVM å†…å­˜ä¸­å­˜å‚¨çš„å€¼ã€‚\n\n## transient çœŸä¸èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\n\nç»§ç»­æ¥çœ‹ç¤ºä¾‹3ï¼š\n\n```\nimport java.io.Externalizable;\nimport java.io.File;\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.IOException;\nimport java.io.ObjectInput;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutput;\nimport java.io.ObjectOutputStream;\n\n/**\n * @author \n */\npublic class ExternalizableTest {\n\n\tpublic static void main(String[] args) throws Exception {\n\n\t\tUser3 user = new User3();\n\t\tuser.setUsername(\"JavaæŠ€æœ¯\");\n\t\tuser.setId(\"javastack\");\n\t\tObjectOutput objectOutput = new ObjectOutputStream(new FileOutputStream(new File(\"javastack\")));\n\t\tobjectOutput.writeObject(user);\n\n\t\tObjectInput objectInput = new ObjectInputStream(new FileInputStream(new File(\"javastack\")));\n\t\tuser = (User3) objectInput.readObject();\n\n\t\tSystem.out.println(user.getUsername());\n\t\tSystem.out.println(user.getId());\n\n\t\tobjectOutput.close();\n\t\tobjectInput.close();\n\t}\n\n}\n\n/**\n * @author \n */\nclass User3 implements Externalizable {\n\n\tprivate static final long serialVersionUID = 1L;\n\n\tpublic User3() {\n\n\t}\n\n\tprivate String username;\n\tprivate transient String id;\n\n\tpublic String getUsername() {\n\t\treturn username;\n\t}\n\n\tpublic void setUsername(String username) {\n\t\tthis.username = username;\n\t}\n\n\tpublic String getId() {\n\t\treturn id;\n\t}\n\n\tpublic void setId(String id) {\n\t\tthis.id = id;\n\t}\n\n\t@Override\n\tpublic void writeExternal(ObjectOutput objectOutput) throws IOException {\n\t\tobjectOutput.writeObject(id);\n\t}\n\n\t@Override\n\tpublic void readExternal(ObjectInput objectInput) throws IOException, ClassNotFoundException {\n\t\tid = (String) objectInput.readObject();\n\t}\n\n}\n```\n\n**è¾“å‡ºç»“æœï¼š**\n\n```\nnull\njavastack\n```\n\nç¤ºä¾‹3çš„ id è¢« transient ä¿®æ”¹äº†ï¼Œä¸ºä»€ä¹ˆè¿˜èƒ½åºåˆ—åŒ–å‡ºæ¥ï¼Ÿé‚£æ˜¯å› ä¸º User3 å®ç°äº†æ¥å£ Externalizableï¼Œè€Œä¸æ˜¯ Serializableã€‚\n\nåœ¨ Java ä¸­æœ‰ä¸¤ç§å®ç°åºåˆ—åŒ–çš„æ–¹å¼ï¼ŒSerializable å’Œ Externalizableï¼Œå¯èƒ½å¤§éƒ¨åˆ†äººåªçŸ¥é“ Serializable è€Œä¸çŸ¥é“ Externalizableã€‚\n\nè¿™ä¸¤ç§åºåˆ—åŒ–æ–¹å¼çš„åŒºåˆ«æ˜¯ï¼šå®ç°äº† Serializable æ¥å£æ˜¯è‡ªåŠ¨åºåˆ—åŒ–çš„ï¼Œå®ç° Externalizable åˆ™éœ€è¦æ‰‹åŠ¨åºåˆ—åŒ–ï¼Œé€šè¿‡ writeExternal å’Œ readExternal æ–¹æ³•æ‰‹åŠ¨è¿›è¡Œï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸Šé¢çš„ username ä¸º null çš„åŸå› äº†ã€‚\n\n## transient å…³é”®å­—æ€»ç»“\n\n1ï¼‰transientä¿®é¥°çš„å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ï¼›\n\n2ï¼‰transientåªä½œç”¨äºå®ç° Serializable æ¥å£ï¼›\n\n3ï¼‰transientåªèƒ½ç”¨æ¥ä¿®é¥°æ™®é€šæˆå‘˜å˜é‡å­—æ®µï¼›\n\n4ï¼‰ä¸ç®¡æœ‰æ²¡æœ‰ transient ä¿®é¥°ï¼Œé™æ€å˜é‡éƒ½ä¸èƒ½è¢«åºåˆ—åŒ–ï¼›\n\n\n\n","source":"_posts/åŸºç¡€/ä½ çœŸçš„ææ‡‚ transient  å…³é”®å­—äº†å—ï¼Ÿ.md","raw":"---\ntitle: ä½ çœŸçš„ææ‡‚ transient  å…³é”®å­—äº†å—ï¼Ÿ\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: åŸºç¡€\n---\n\n## å…ˆè§£é‡Šä¸‹ä»€ä¹ˆæ˜¯åºåˆ—åŒ–\n\næˆ‘ä»¬çš„å¯¹è±¡å¹¶ä¸åªæ˜¯å­˜åœ¨å†…å­˜ä¸­ï¼Œè¿˜éœ€è¦ä¼ è¾“ç½‘ç»œï¼Œæˆ–è€…ä¿å­˜èµ·æ¥ä¸‹æ¬¡å†åŠ è½½å‡ºæ¥ç”¨ï¼Œæ‰€ä»¥éœ€è¦Javaåºåˆ—åŒ–æŠ€æœ¯ã€‚\n\nJavaåºåˆ—åŒ–æŠ€æœ¯æ­£æ˜¯å°†å¯¹è±¡è½¬å˜æˆä¸€ä¸²ç”±äºŒè¿›åˆ¶å­—èŠ‚ç»„æˆçš„æ•°ç»„ï¼Œå¯ä»¥é€šè¿‡å°†äºŒè¿›åˆ¶æ•°æ®ä¿å­˜åˆ°ç£ç›˜æˆ–è€…ä¼ è¾“ç½‘ç»œï¼Œç£ç›˜æˆ–è€…ç½‘ç»œæ¥æ”¶è€…å¯ä»¥åœ¨å¯¹è±¡çš„å±ç±»çš„æ¨¡æ¿ä¸Šæ¥ååºåˆ—åŒ–ç±»çš„å¯¹è±¡ï¼Œè¾¾åˆ°å¯¹è±¡æŒä¹…åŒ–çš„ç›®çš„ã€‚\n\næ›´å¤šåºåˆ—åŒ–è¯·å‚è€ƒï¼šã€Š[å…³äºJavaåºåˆ—åŒ–ä½ åº”è¯¥çŸ¥é“çš„ä¸€åˆ‡](https://mp.weixin.qq.com/s/wHmK1kKyne6gCkIxt0NERQ)ã€‹è¿™ç¯‡æ–‡ç« ã€‚\n\n## ä»€ä¹ˆæ˜¯ transientï¼Ÿ\n\nç®€å•æ¥è¯´å°±æ˜¯ï¼Œè¢« transient ä¿®é¥°çš„å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ã€‚\n\n**å…·ä½“æ¥çœ‹ä¸‹é¢çš„ç¤ºä¾‹1**\n\n```\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutputStream;\nimport java.io.Serializable;\n\n/**\n * @author \n */\npublic class TransientTest {\n\n\tpublic static void main(String[] args) throws Exception {\n\n\t\tUser user = new User();\n\t\tuser.setUsername(\"JavaæŠ€æœ¯\");\n\t\tuser.setId(\"javastack\");\n\n\t\tSystem.out.println(\"\\nåºåˆ—åŒ–ä¹‹å‰\");\n\t\tSystem.out.println(\"username: \" + user.getUsername());\n\t\tSystem.out.println(\"id: \" + user.getId());\n\n\t\tObjectOutputStream os = new ObjectOutputStream(new FileOutputStream(\"d:/user.txt\"));\n\t\tos.writeObject(user);\n\t\tos.flush();\n\t\tos.close();\n\n\t\tObjectInputStream is = new ObjectInputStream(new FileInputStream(\"d:/user.txt\"));\n\t\tuser = (User) is.readObject();\n\t\tis.close();\n\n\t\tSystem.out.println(\"\\nåºåˆ—åŒ–ä¹‹å\");\n\t\tSystem.out.println(\"username: \" + user.getUsername());\n\t\tSystem.out.println(\"id: \" + user.getId());\n\n\t}\n}\n\n/**\n * @author \n */\nclass User implements Serializable {\n\n\tprivate static final long serialVersionUID = 1L;\n\n\tprivate String username;\n\tprivate transient String id;\n\n\tpublic String getUsername() {\n\t\treturn username;\n\t}\n\n\tpublic void setUsername(String username) {\n\t\tthis.username = username;\n\t}\n\n\tpublic String getId() {\n\t\treturn id;\n\t}\n\n\tpublic void setId(String id) {\n\t\tthis.id = id;\n\t}\n\n}\n```\n\n**è¾“å‡ºç»“æœï¼š**\n\n```\nåºåˆ—åŒ–ä¹‹å‰\nusername: JavaæŠ€æœ¯\nid: javastack\n\nåºåˆ—åŒ–ä¹‹å\nusername: JavaæŠ€æœ¯\nid: null\n```\n\nç¤ºä¾‹1åœ¨ id å­—æ®µä¸ŠåŠ äº† transient å…³é”®å­—ä¿®é¥°ï¼Œååºåˆ—åŒ–å‡ºæ¥ä¹‹åå€¼ä¸º nullï¼Œè¯´æ˜äº†è¢« transient ä¿®é¥°çš„å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ã€‚\n\n## é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\n\nè¿™ä¸ªè¯é¢˜ä¹Ÿæ˜¯æœ€è¿‘æ ˆé•¿çš„JavaæŠ€æœ¯vipç¾¤é‡Œé¢è®¨è®ºçš„ï¼Œå¤§å®¶å¯¹è¿™ä¸ªçŸ¥è¯†ç‚¹æ¯”è¾ƒæ¨¡ç³Šï¼Œæˆ‘å°±å†™äº†è¿™ç¯‡æ–‡ç« æµ‹è¯•æ€»ç»“ä¸€ä¸‹ã€‚\n\n![](http://img.javastack.cn/å¾®ä¿¡å›¾ç‰‡_20190214162351.png)\n\n> å¦‚æœä½ ä¹Ÿæƒ³åŠ å…¥æˆ‘ä»¬çš„JavaæŠ€æœ¯vipç¾¤å’Œå„ä½å¤§ç‰›ä¸€èµ·è®¨è®ºæŠ€æœ¯ï¼Œé‚£ç‚¹å‡»[è¿™ä¸ªé“¾æ¥](https://mp.weixin.qq.com/s/iqCLAduVzDqt19L6D4FCUQ)äº†è§£åŠ å…¥å§ã€‚\n\né‚£ä¹ˆï¼Œåˆ°åº•é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼ŸåºŸè¯å°‘è¯´ï¼Œå…ˆåŠ¨æ‰‹æµ‹è¯•ä¸‹å§ï¼\n\nç¤ºä¾‹2ï¼š\n\n```\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutputStream;\nimport java.io.Serializable;\n\n/**\n * @author \n */\npublic class TransientStaticTest {\n\n\tpublic static void main(String[] args) throws Exception {\n\n\t\tUser2 user = new User2();\n\t\tUser2.username = \"JavaæŠ€æœ¯1\";\n\t\tuser.setId(\"javastack\");\n\n\t\tSystem.out.println(\"\\nåºåˆ—åŒ–ä¹‹å‰\");\n\t\tSystem.out.println(\"username: \" + user.getUsername());\n\t\tSystem.out.println(\"id: \" + user.getId());\n\n\t\tObjectOutputStream os = new ObjectOutputStream(new FileOutputStream(\"d:/user.txt\"));\n\t\tos.writeObject(user);\n\t\tos.flush();\n\t\tos.close();\n\t\t\n\t\t// åœ¨ååºåˆ—åŒ–å‡ºæ¥ä¹‹å‰ï¼Œæ”¹å˜é™æ€å˜é‡çš„å€¼\n\t\tUser2.username = \"JavaæŠ€æœ¯2\";\n\n\t\tObjectInputStream is = new ObjectInputStream(new FileInputStream(\"d:/user.txt\"));\n\t\tuser = (User2) is.readObject();\n\t\tis.close();\n\n\t\tSystem.out.println(\"\\nåºåˆ—åŒ–ä¹‹å\");\n\t\tSystem.out.println(\"username: \" + user.getUsername());\n\t\tSystem.out.println(\"id: \" + user.getId());\n\n\t}\n}\n\n/**\n * @author \n */\nclass User2 implements Serializable {\n\n\tprivate static final long serialVersionUID = 1L;\n\n\tpublic static String username;\n\tprivate transient String id;\n\n\tpublic String getUsername() {\n\t\treturn username;\n\t}\n\n\tpublic String getId() {\n\t\treturn id;\n\t}\n\n\tpublic void setId(String id) {\n\t\tthis.id = id;\n\t}\n\n}\n```\n\n**è¾“å‡ºç»“æœï¼š**\n\n```\nåºåˆ—åŒ–ä¹‹å‰\nusername: JavaæŠ€æœ¯1\nid: javastack\n\nåºåˆ—åŒ–ä¹‹å\nusername: JavaæŠ€æœ¯2\nid: null\n```\n\nç¤ºä¾‹2æŠŠ username æ”¹ä¸ºäº† public static, å¹¶åœ¨ååºåˆ—åŒ–å‡ºæ¥ä¹‹å‰æ”¹å˜äº†é™æ€å˜é‡çš„å€¼ï¼Œç»“æœå¯ä»¥çœ‹å‡ºåºåˆ—åŒ–ä¹‹åçš„å€¼å¹¶éåºåˆ—åŒ–è¿›å»æ—¶çš„å€¼ã€‚\n\nç”±ä»¥ä¸Šç»“æœåˆ†æå¯çŸ¥ï¼Œé™æ€å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ï¼Œç¤ºä¾‹2è¯»å–å‡ºæ¥çš„æ˜¯ username åœ¨ JVM å†…å­˜ä¸­å­˜å‚¨çš„å€¼ã€‚\n\n## transient çœŸä¸èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\n\nç»§ç»­æ¥çœ‹ç¤ºä¾‹3ï¼š\n\n```\nimport java.io.Externalizable;\nimport java.io.File;\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.IOException;\nimport java.io.ObjectInput;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutput;\nimport java.io.ObjectOutputStream;\n\n/**\n * @author \n */\npublic class ExternalizableTest {\n\n\tpublic static void main(String[] args) throws Exception {\n\n\t\tUser3 user = new User3();\n\t\tuser.setUsername(\"JavaæŠ€æœ¯\");\n\t\tuser.setId(\"javastack\");\n\t\tObjectOutput objectOutput = new ObjectOutputStream(new FileOutputStream(new File(\"javastack\")));\n\t\tobjectOutput.writeObject(user);\n\n\t\tObjectInput objectInput = new ObjectInputStream(new FileInputStream(new File(\"javastack\")));\n\t\tuser = (User3) objectInput.readObject();\n\n\t\tSystem.out.println(user.getUsername());\n\t\tSystem.out.println(user.getId());\n\n\t\tobjectOutput.close();\n\t\tobjectInput.close();\n\t}\n\n}\n\n/**\n * @author \n */\nclass User3 implements Externalizable {\n\n\tprivate static final long serialVersionUID = 1L;\n\n\tpublic User3() {\n\n\t}\n\n\tprivate String username;\n\tprivate transient String id;\n\n\tpublic String getUsername() {\n\t\treturn username;\n\t}\n\n\tpublic void setUsername(String username) {\n\t\tthis.username = username;\n\t}\n\n\tpublic String getId() {\n\t\treturn id;\n\t}\n\n\tpublic void setId(String id) {\n\t\tthis.id = id;\n\t}\n\n\t@Override\n\tpublic void writeExternal(ObjectOutput objectOutput) throws IOException {\n\t\tobjectOutput.writeObject(id);\n\t}\n\n\t@Override\n\tpublic void readExternal(ObjectInput objectInput) throws IOException, ClassNotFoundException {\n\t\tid = (String) objectInput.readObject();\n\t}\n\n}\n```\n\n**è¾“å‡ºç»“æœï¼š**\n\n```\nnull\njavastack\n```\n\nç¤ºä¾‹3çš„ id è¢« transient ä¿®æ”¹äº†ï¼Œä¸ºä»€ä¹ˆè¿˜èƒ½åºåˆ—åŒ–å‡ºæ¥ï¼Ÿé‚£æ˜¯å› ä¸º User3 å®ç°äº†æ¥å£ Externalizableï¼Œè€Œä¸æ˜¯ Serializableã€‚\n\nåœ¨ Java ä¸­æœ‰ä¸¤ç§å®ç°åºåˆ—åŒ–çš„æ–¹å¼ï¼ŒSerializable å’Œ Externalizableï¼Œå¯èƒ½å¤§éƒ¨åˆ†äººåªçŸ¥é“ Serializable è€Œä¸çŸ¥é“ Externalizableã€‚\n\nè¿™ä¸¤ç§åºåˆ—åŒ–æ–¹å¼çš„åŒºåˆ«æ˜¯ï¼šå®ç°äº† Serializable æ¥å£æ˜¯è‡ªåŠ¨åºåˆ—åŒ–çš„ï¼Œå®ç° Externalizable åˆ™éœ€è¦æ‰‹åŠ¨åºåˆ—åŒ–ï¼Œé€šè¿‡ writeExternal å’Œ readExternal æ–¹æ³•æ‰‹åŠ¨è¿›è¡Œï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸Šé¢çš„ username ä¸º null çš„åŸå› äº†ã€‚\n\n## transient å…³é”®å­—æ€»ç»“\n\n1ï¼‰transientä¿®é¥°çš„å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ï¼›\n\n2ï¼‰transientåªä½œç”¨äºå®ç° Serializable æ¥å£ï¼›\n\n3ï¼‰transientåªèƒ½ç”¨æ¥ä¿®é¥°æ™®é€šæˆå‘˜å˜é‡å­—æ®µï¼›\n\n4ï¼‰ä¸ç®¡æœ‰æ²¡æœ‰ transient ä¿®é¥°ï¼Œé™æ€å˜é‡éƒ½ä¸èƒ½è¢«åºåˆ—åŒ–ï¼›\n\n\n\n","slug":"åŸºç¡€/ä½ çœŸçš„ææ‡‚ transient  å…³é”®å­—äº†å—ï¼Ÿ","published":1,"updated":"2025-10-15T07:19:51.838Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076w0040qkd45oqzaqxy","content":"<h2 id=\"å…ˆè§£é‡Šä¸‹ä»€ä¹ˆæ˜¯åºåˆ—åŒ–\"><a href=\"#å…ˆè§£é‡Šä¸‹ä»€ä¹ˆæ˜¯åºåˆ—åŒ–\" class=\"headerlink\" title=\"å…ˆè§£é‡Šä¸‹ä»€ä¹ˆæ˜¯åºåˆ—åŒ–\"></a>å…ˆè§£é‡Šä¸‹ä»€ä¹ˆæ˜¯åºåˆ—åŒ–</h2><p>æˆ‘ä»¬çš„å¯¹è±¡å¹¶ä¸åªæ˜¯å­˜åœ¨å†…å­˜ä¸­ï¼Œè¿˜éœ€è¦ä¼ è¾“ç½‘ç»œï¼Œæˆ–è€…ä¿å­˜èµ·æ¥ä¸‹æ¬¡å†åŠ è½½å‡ºæ¥ç”¨ï¼Œæ‰€ä»¥éœ€è¦Javaåºåˆ—åŒ–æŠ€æœ¯ã€‚</p>\n<p>Javaåºåˆ—åŒ–æŠ€æœ¯æ­£æ˜¯å°†å¯¹è±¡è½¬å˜æˆä¸€ä¸²ç”±äºŒè¿›åˆ¶å­—èŠ‚ç»„æˆçš„æ•°ç»„ï¼Œå¯ä»¥é€šè¿‡å°†äºŒè¿›åˆ¶æ•°æ®ä¿å­˜åˆ°ç£ç›˜æˆ–è€…ä¼ è¾“ç½‘ç»œï¼Œç£ç›˜æˆ–è€…ç½‘ç»œæ¥æ”¶è€…å¯ä»¥åœ¨å¯¹è±¡çš„å±ç±»çš„æ¨¡æ¿ä¸Šæ¥ååºåˆ—åŒ–ç±»çš„å¯¹è±¡ï¼Œè¾¾åˆ°å¯¹è±¡æŒä¹…åŒ–çš„ç›®çš„ã€‚</p>\n<p>æ›´å¤šåºåˆ—åŒ–è¯·å‚è€ƒï¼šã€Š<a href=\"https://mp.weixin.qq.com/s/wHmK1kKyne6gCkIxt0NERQ\">å…³äºJavaåºåˆ—åŒ–ä½ åº”è¯¥çŸ¥é“çš„ä¸€åˆ‡</a>ã€‹è¿™ç¯‡æ–‡ç« ã€‚</p>\n<h2 id=\"ä»€ä¹ˆæ˜¯-transientï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯-transientï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ transientï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯ transientï¼Ÿ</h2><p>ç®€å•æ¥è¯´å°±æ˜¯ï¼Œè¢« transient ä¿®é¥°çš„å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ã€‚</p>\n<p><strong>å…·ä½“æ¥çœ‹ä¸‹é¢çš„ç¤ºä¾‹1</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">import java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutputStream;\nimport java.io.Serializable;\n\n&#x2F;**\n * @author \n *&#x2F;\npublic class TransientTest &#123;\n\n\tpublic static void main(String[] args) throws Exception &#123;\n\n\t\tUser user &#x3D; new User();\n\t\tuser.setUsername(&quot;JavaæŠ€æœ¯&quot;);\n\t\tuser.setId(&quot;javastack&quot;);\n\n\t\tSystem.out.println(&quot;\\nåºåˆ—åŒ–ä¹‹å‰&quot;);\n\t\tSystem.out.println(&quot;username: &quot; + user.getUsername());\n\t\tSystem.out.println(&quot;id: &quot; + user.getId());\n\n\t\tObjectOutputStream os &#x3D; new ObjectOutputStream(new FileOutputStream(&quot;d:&#x2F;user.txt&quot;));\n\t\tos.writeObject(user);\n\t\tos.flush();\n\t\tos.close();\n\n\t\tObjectInputStream is &#x3D; new ObjectInputStream(new FileInputStream(&quot;d:&#x2F;user.txt&quot;));\n\t\tuser &#x3D; (User) is.readObject();\n\t\tis.close();\n\n\t\tSystem.out.println(&quot;\\nåºåˆ—åŒ–ä¹‹å&quot;);\n\t\tSystem.out.println(&quot;username: &quot; + user.getUsername());\n\t\tSystem.out.println(&quot;id: &quot; + user.getId());\n\n\t&#125;\n&#125;\n\n&#x2F;**\n * @author \n *&#x2F;\nclass User implements Serializable &#123;\n\n\tprivate static final long serialVersionUID &#x3D; 1L;\n\n\tprivate String username;\n\tprivate transient String id;\n\n\tpublic String getUsername() &#123;\n\t\treturn username;\n\t&#125;\n\n\tpublic void setUsername(String username) &#123;\n\t\tthis.username &#x3D; username;\n\t&#125;\n\n\tpublic String getId() &#123;\n\t\treturn id;\n\t&#125;\n\n\tpublic void setId(String id) &#123;\n\t\tthis.id &#x3D; id;\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>è¾“å‡ºç»“æœï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">åºåˆ—åŒ–ä¹‹å‰\nusername: JavaæŠ€æœ¯\nid: javastack\n\nåºåˆ—åŒ–ä¹‹å\nusername: JavaæŠ€æœ¯\nid: null<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¤ºä¾‹1åœ¨ id å­—æ®µä¸ŠåŠ äº† transient å…³é”®å­—ä¿®é¥°ï¼Œååºåˆ—åŒ–å‡ºæ¥ä¹‹åå€¼ä¸º nullï¼Œè¯´æ˜äº†è¢« transient ä¿®é¥°çš„å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ã€‚</p>\n<h2 id=\"é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\"><a href=\"#é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\" class=\"headerlink\" title=\"é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\"></a>é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ</h2><p>è¿™ä¸ªè¯é¢˜ä¹Ÿæ˜¯æœ€è¿‘æ ˆé•¿çš„JavaæŠ€æœ¯vipç¾¤é‡Œé¢è®¨è®ºçš„ï¼Œå¤§å®¶å¯¹è¿™ä¸ªçŸ¥è¯†ç‚¹æ¯”è¾ƒæ¨¡ç³Šï¼Œæˆ‘å°±å†™äº†è¿™ç¯‡æ–‡ç« æµ‹è¯•æ€»ç»“ä¸€ä¸‹ã€‚</p>\n<p><img src=\"http://img.javastack.cn/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190214162351.png\"></p>\n<blockquote>\n<p>å¦‚æœä½ ä¹Ÿæƒ³åŠ å…¥æˆ‘ä»¬çš„JavaæŠ€æœ¯vipç¾¤å’Œå„ä½å¤§ç‰›ä¸€èµ·è®¨è®ºæŠ€æœ¯ï¼Œé‚£ç‚¹å‡»<a href=\"https://mp.weixin.qq.com/s/iqCLAduVzDqt19L6D4FCUQ\">è¿™ä¸ªé“¾æ¥</a>äº†è§£åŠ å…¥å§ã€‚</p>\n</blockquote>\n<p>é‚£ä¹ˆï¼Œåˆ°åº•é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼ŸåºŸè¯å°‘è¯´ï¼Œå…ˆåŠ¨æ‰‹æµ‹è¯•ä¸‹å§ï¼</p>\n<p>ç¤ºä¾‹2ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">import java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutputStream;\nimport java.io.Serializable;\n\n&#x2F;**\n * @author \n *&#x2F;\npublic class TransientStaticTest &#123;\n\n\tpublic static void main(String[] args) throws Exception &#123;\n\n\t\tUser2 user &#x3D; new User2();\n\t\tUser2.username &#x3D; &quot;JavaæŠ€æœ¯1&quot;;\n\t\tuser.setId(&quot;javastack&quot;);\n\n\t\tSystem.out.println(&quot;\\nåºåˆ—åŒ–ä¹‹å‰&quot;);\n\t\tSystem.out.println(&quot;username: &quot; + user.getUsername());\n\t\tSystem.out.println(&quot;id: &quot; + user.getId());\n\n\t\tObjectOutputStream os &#x3D; new ObjectOutputStream(new FileOutputStream(&quot;d:&#x2F;user.txt&quot;));\n\t\tos.writeObject(user);\n\t\tos.flush();\n\t\tos.close();\n\t\t\n\t\t&#x2F;&#x2F; åœ¨ååºåˆ—åŒ–å‡ºæ¥ä¹‹å‰ï¼Œæ”¹å˜é™æ€å˜é‡çš„å€¼\n\t\tUser2.username &#x3D; &quot;JavaæŠ€æœ¯2&quot;;\n\n\t\tObjectInputStream is &#x3D; new ObjectInputStream(new FileInputStream(&quot;d:&#x2F;user.txt&quot;));\n\t\tuser &#x3D; (User2) is.readObject();\n\t\tis.close();\n\n\t\tSystem.out.println(&quot;\\nåºåˆ—åŒ–ä¹‹å&quot;);\n\t\tSystem.out.println(&quot;username: &quot; + user.getUsername());\n\t\tSystem.out.println(&quot;id: &quot; + user.getId());\n\n\t&#125;\n&#125;\n\n&#x2F;**\n * @author \n *&#x2F;\nclass User2 implements Serializable &#123;\n\n\tprivate static final long serialVersionUID &#x3D; 1L;\n\n\tpublic static String username;\n\tprivate transient String id;\n\n\tpublic String getUsername() &#123;\n\t\treturn username;\n\t&#125;\n\n\tpublic String getId() &#123;\n\t\treturn id;\n\t&#125;\n\n\tpublic void setId(String id) &#123;\n\t\tthis.id &#x3D; id;\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>è¾“å‡ºç»“æœï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">åºåˆ—åŒ–ä¹‹å‰\nusername: JavaæŠ€æœ¯1\nid: javastack\n\nåºåˆ—åŒ–ä¹‹å\nusername: JavaæŠ€æœ¯2\nid: null<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¤ºä¾‹2æŠŠ username æ”¹ä¸ºäº† public static, å¹¶åœ¨ååºåˆ—åŒ–å‡ºæ¥ä¹‹å‰æ”¹å˜äº†é™æ€å˜é‡çš„å€¼ï¼Œç»“æœå¯ä»¥çœ‹å‡ºåºåˆ—åŒ–ä¹‹åçš„å€¼å¹¶éåºåˆ—åŒ–è¿›å»æ—¶çš„å€¼ã€‚</p>\n<p>ç”±ä»¥ä¸Šç»“æœåˆ†æå¯çŸ¥ï¼Œé™æ€å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ï¼Œç¤ºä¾‹2è¯»å–å‡ºæ¥çš„æ˜¯ username åœ¨ JVM å†…å­˜ä¸­å­˜å‚¨çš„å€¼ã€‚</p>\n<h2 id=\"transient-çœŸä¸èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\"><a href=\"#transient-çœŸä¸èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\" class=\"headerlink\" title=\"transient çœŸä¸èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\"></a>transient çœŸä¸èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ</h2><p>ç»§ç»­æ¥çœ‹ç¤ºä¾‹3ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">import java.io.Externalizable;\nimport java.io.File;\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.IOException;\nimport java.io.ObjectInput;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutput;\nimport java.io.ObjectOutputStream;\n\n&#x2F;**\n * @author \n *&#x2F;\npublic class ExternalizableTest &#123;\n\n\tpublic static void main(String[] args) throws Exception &#123;\n\n\t\tUser3 user &#x3D; new User3();\n\t\tuser.setUsername(&quot;JavaæŠ€æœ¯&quot;);\n\t\tuser.setId(&quot;javastack&quot;);\n\t\tObjectOutput objectOutput &#x3D; new ObjectOutputStream(new FileOutputStream(new File(&quot;javastack&quot;)));\n\t\tobjectOutput.writeObject(user);\n\n\t\tObjectInput objectInput &#x3D; new ObjectInputStream(new FileInputStream(new File(&quot;javastack&quot;)));\n\t\tuser &#x3D; (User3) objectInput.readObject();\n\n\t\tSystem.out.println(user.getUsername());\n\t\tSystem.out.println(user.getId());\n\n\t\tobjectOutput.close();\n\t\tobjectInput.close();\n\t&#125;\n\n&#125;\n\n&#x2F;**\n * @author \n *&#x2F;\nclass User3 implements Externalizable &#123;\n\n\tprivate static final long serialVersionUID &#x3D; 1L;\n\n\tpublic User3() &#123;\n\n\t&#125;\n\n\tprivate String username;\n\tprivate transient String id;\n\n\tpublic String getUsername() &#123;\n\t\treturn username;\n\t&#125;\n\n\tpublic void setUsername(String username) &#123;\n\t\tthis.username &#x3D; username;\n\t&#125;\n\n\tpublic String getId() &#123;\n\t\treturn id;\n\t&#125;\n\n\tpublic void setId(String id) &#123;\n\t\tthis.id &#x3D; id;\n\t&#125;\n\n\t@Override\n\tpublic void writeExternal(ObjectOutput objectOutput) throws IOException &#123;\n\t\tobjectOutput.writeObject(id);\n\t&#125;\n\n\t@Override\n\tpublic void readExternal(ObjectInput objectInput) throws IOException, ClassNotFoundException &#123;\n\t\tid &#x3D; (String) objectInput.readObject();\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>è¾“å‡ºç»“æœï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">null\njavastack<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>ç¤ºä¾‹3çš„ id è¢« transient ä¿®æ”¹äº†ï¼Œä¸ºä»€ä¹ˆè¿˜èƒ½åºåˆ—åŒ–å‡ºæ¥ï¼Ÿé‚£æ˜¯å› ä¸º User3 å®ç°äº†æ¥å£ Externalizableï¼Œè€Œä¸æ˜¯ Serializableã€‚</p>\n<p>åœ¨ Java ä¸­æœ‰ä¸¤ç§å®ç°åºåˆ—åŒ–çš„æ–¹å¼ï¼ŒSerializable å’Œ Externalizableï¼Œå¯èƒ½å¤§éƒ¨åˆ†äººåªçŸ¥é“ Serializable è€Œä¸çŸ¥é“ Externalizableã€‚</p>\n<p>è¿™ä¸¤ç§åºåˆ—åŒ–æ–¹å¼çš„åŒºåˆ«æ˜¯ï¼šå®ç°äº† Serializable æ¥å£æ˜¯è‡ªåŠ¨åºåˆ—åŒ–çš„ï¼Œå®ç° Externalizable åˆ™éœ€è¦æ‰‹åŠ¨åºåˆ—åŒ–ï¼Œé€šè¿‡ writeExternal å’Œ readExternal æ–¹æ³•æ‰‹åŠ¨è¿›è¡Œï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸Šé¢çš„ username ä¸º null çš„åŸå› äº†ã€‚</p>\n<h2 id=\"transient-å…³é”®å­—æ€»ç»“\"><a href=\"#transient-å…³é”®å­—æ€»ç»“\" class=\"headerlink\" title=\"transient å…³é”®å­—æ€»ç»“\"></a>transient å…³é”®å­—æ€»ç»“</h2><p>1ï¼‰transientä¿®é¥°çš„å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ï¼›</p>\n<p>2ï¼‰transientåªä½œç”¨äºå®ç° Serializable æ¥å£ï¼›</p>\n<p>3ï¼‰transientåªèƒ½ç”¨æ¥ä¿®é¥°æ™®é€šæˆå‘˜å˜é‡å­—æ®µï¼›</p>\n<p>4ï¼‰ä¸ç®¡æœ‰æ²¡æœ‰ transient ä¿®é¥°ï¼Œé™æ€å˜é‡éƒ½ä¸èƒ½è¢«åºåˆ—åŒ–ï¼›</p>\n","excerpt":"","more":"<h2 id=\"å…ˆè§£é‡Šä¸‹ä»€ä¹ˆæ˜¯åºåˆ—åŒ–\"><a href=\"#å…ˆè§£é‡Šä¸‹ä»€ä¹ˆæ˜¯åºåˆ—åŒ–\" class=\"headerlink\" title=\"å…ˆè§£é‡Šä¸‹ä»€ä¹ˆæ˜¯åºåˆ—åŒ–\"></a>å…ˆè§£é‡Šä¸‹ä»€ä¹ˆæ˜¯åºåˆ—åŒ–</h2><p>æˆ‘ä»¬çš„å¯¹è±¡å¹¶ä¸åªæ˜¯å­˜åœ¨å†…å­˜ä¸­ï¼Œè¿˜éœ€è¦ä¼ è¾“ç½‘ç»œï¼Œæˆ–è€…ä¿å­˜èµ·æ¥ä¸‹æ¬¡å†åŠ è½½å‡ºæ¥ç”¨ï¼Œæ‰€ä»¥éœ€è¦Javaåºåˆ—åŒ–æŠ€æœ¯ã€‚</p>\n<p>Javaåºåˆ—åŒ–æŠ€æœ¯æ­£æ˜¯å°†å¯¹è±¡è½¬å˜æˆä¸€ä¸²ç”±äºŒè¿›åˆ¶å­—èŠ‚ç»„æˆçš„æ•°ç»„ï¼Œå¯ä»¥é€šè¿‡å°†äºŒè¿›åˆ¶æ•°æ®ä¿å­˜åˆ°ç£ç›˜æˆ–è€…ä¼ è¾“ç½‘ç»œï¼Œç£ç›˜æˆ–è€…ç½‘ç»œæ¥æ”¶è€…å¯ä»¥åœ¨å¯¹è±¡çš„å±ç±»çš„æ¨¡æ¿ä¸Šæ¥ååºåˆ—åŒ–ç±»çš„å¯¹è±¡ï¼Œè¾¾åˆ°å¯¹è±¡æŒä¹…åŒ–çš„ç›®çš„ã€‚</p>\n<p>æ›´å¤šåºåˆ—åŒ–è¯·å‚è€ƒï¼šã€Š<a href=\"https://mp.weixin.qq.com/s/wHmK1kKyne6gCkIxt0NERQ\">å…³äºJavaåºåˆ—åŒ–ä½ åº”è¯¥çŸ¥é“çš„ä¸€åˆ‡</a>ã€‹è¿™ç¯‡æ–‡ç« ã€‚</p>\n<h2 id=\"ä»€ä¹ˆæ˜¯-transientï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯-transientï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ transientï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯ transientï¼Ÿ</h2><p>ç®€å•æ¥è¯´å°±æ˜¯ï¼Œè¢« transient ä¿®é¥°çš„å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ã€‚</p>\n<p><strong>å…·ä½“æ¥çœ‹ä¸‹é¢çš„ç¤ºä¾‹1</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">import java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutputStream;\nimport java.io.Serializable;\n\n&#x2F;**\n * @author \n *&#x2F;\npublic class TransientTest &#123;\n\n\tpublic static void main(String[] args) throws Exception &#123;\n\n\t\tUser user &#x3D; new User();\n\t\tuser.setUsername(&quot;JavaæŠ€æœ¯&quot;);\n\t\tuser.setId(&quot;javastack&quot;);\n\n\t\tSystem.out.println(&quot;\\nåºåˆ—åŒ–ä¹‹å‰&quot;);\n\t\tSystem.out.println(&quot;username: &quot; + user.getUsername());\n\t\tSystem.out.println(&quot;id: &quot; + user.getId());\n\n\t\tObjectOutputStream os &#x3D; new ObjectOutputStream(new FileOutputStream(&quot;d:&#x2F;user.txt&quot;));\n\t\tos.writeObject(user);\n\t\tos.flush();\n\t\tos.close();\n\n\t\tObjectInputStream is &#x3D; new ObjectInputStream(new FileInputStream(&quot;d:&#x2F;user.txt&quot;));\n\t\tuser &#x3D; (User) is.readObject();\n\t\tis.close();\n\n\t\tSystem.out.println(&quot;\\nåºåˆ—åŒ–ä¹‹å&quot;);\n\t\tSystem.out.println(&quot;username: &quot; + user.getUsername());\n\t\tSystem.out.println(&quot;id: &quot; + user.getId());\n\n\t&#125;\n&#125;\n\n&#x2F;**\n * @author \n *&#x2F;\nclass User implements Serializable &#123;\n\n\tprivate static final long serialVersionUID &#x3D; 1L;\n\n\tprivate String username;\n\tprivate transient String id;\n\n\tpublic String getUsername() &#123;\n\t\treturn username;\n\t&#125;\n\n\tpublic void setUsername(String username) &#123;\n\t\tthis.username &#x3D; username;\n\t&#125;\n\n\tpublic String getId() &#123;\n\t\treturn id;\n\t&#125;\n\n\tpublic void setId(String id) &#123;\n\t\tthis.id &#x3D; id;\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>è¾“å‡ºç»“æœï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">åºåˆ—åŒ–ä¹‹å‰\nusername: JavaæŠ€æœ¯\nid: javastack\n\nåºåˆ—åŒ–ä¹‹å\nusername: JavaæŠ€æœ¯\nid: null<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¤ºä¾‹1åœ¨ id å­—æ®µä¸ŠåŠ äº† transient å…³é”®å­—ä¿®é¥°ï¼Œååºåˆ—åŒ–å‡ºæ¥ä¹‹åå€¼ä¸º nullï¼Œè¯´æ˜äº†è¢« transient ä¿®é¥°çš„å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ã€‚</p>\n<h2 id=\"é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\"><a href=\"#é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\" class=\"headerlink\" title=\"é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\"></a>é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ</h2><p>è¿™ä¸ªè¯é¢˜ä¹Ÿæ˜¯æœ€è¿‘æ ˆé•¿çš„JavaæŠ€æœ¯vipç¾¤é‡Œé¢è®¨è®ºçš„ï¼Œå¤§å®¶å¯¹è¿™ä¸ªçŸ¥è¯†ç‚¹æ¯”è¾ƒæ¨¡ç³Šï¼Œæˆ‘å°±å†™äº†è¿™ç¯‡æ–‡ç« æµ‹è¯•æ€»ç»“ä¸€ä¸‹ã€‚</p>\n<p><img src=\"http://img.javastack.cn/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190214162351.png\"></p>\n<blockquote>\n<p>å¦‚æœä½ ä¹Ÿæƒ³åŠ å…¥æˆ‘ä»¬çš„JavaæŠ€æœ¯vipç¾¤å’Œå„ä½å¤§ç‰›ä¸€èµ·è®¨è®ºæŠ€æœ¯ï¼Œé‚£ç‚¹å‡»<a href=\"https://mp.weixin.qq.com/s/iqCLAduVzDqt19L6D4FCUQ\">è¿™ä¸ªé“¾æ¥</a>äº†è§£åŠ å…¥å§ã€‚</p>\n</blockquote>\n<p>é‚£ä¹ˆï¼Œåˆ°åº•é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼ŸåºŸè¯å°‘è¯´ï¼Œå…ˆåŠ¨æ‰‹æµ‹è¯•ä¸‹å§ï¼</p>\n<p>ç¤ºä¾‹2ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">import java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutputStream;\nimport java.io.Serializable;\n\n&#x2F;**\n * @author \n *&#x2F;\npublic class TransientStaticTest &#123;\n\n\tpublic static void main(String[] args) throws Exception &#123;\n\n\t\tUser2 user &#x3D; new User2();\n\t\tUser2.username &#x3D; &quot;JavaæŠ€æœ¯1&quot;;\n\t\tuser.setId(&quot;javastack&quot;);\n\n\t\tSystem.out.println(&quot;\\nåºåˆ—åŒ–ä¹‹å‰&quot;);\n\t\tSystem.out.println(&quot;username: &quot; + user.getUsername());\n\t\tSystem.out.println(&quot;id: &quot; + user.getId());\n\n\t\tObjectOutputStream os &#x3D; new ObjectOutputStream(new FileOutputStream(&quot;d:&#x2F;user.txt&quot;));\n\t\tos.writeObject(user);\n\t\tos.flush();\n\t\tos.close();\n\t\t\n\t\t&#x2F;&#x2F; åœ¨ååºåˆ—åŒ–å‡ºæ¥ä¹‹å‰ï¼Œæ”¹å˜é™æ€å˜é‡çš„å€¼\n\t\tUser2.username &#x3D; &quot;JavaæŠ€æœ¯2&quot;;\n\n\t\tObjectInputStream is &#x3D; new ObjectInputStream(new FileInputStream(&quot;d:&#x2F;user.txt&quot;));\n\t\tuser &#x3D; (User2) is.readObject();\n\t\tis.close();\n\n\t\tSystem.out.println(&quot;\\nåºåˆ—åŒ–ä¹‹å&quot;);\n\t\tSystem.out.println(&quot;username: &quot; + user.getUsername());\n\t\tSystem.out.println(&quot;id: &quot; + user.getId());\n\n\t&#125;\n&#125;\n\n&#x2F;**\n * @author \n *&#x2F;\nclass User2 implements Serializable &#123;\n\n\tprivate static final long serialVersionUID &#x3D; 1L;\n\n\tpublic static String username;\n\tprivate transient String id;\n\n\tpublic String getUsername() &#123;\n\t\treturn username;\n\t&#125;\n\n\tpublic String getId() &#123;\n\t\treturn id;\n\t&#125;\n\n\tpublic void setId(String id) &#123;\n\t\tthis.id &#x3D; id;\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>è¾“å‡ºç»“æœï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">åºåˆ—åŒ–ä¹‹å‰\nusername: JavaæŠ€æœ¯1\nid: javastack\n\nåºåˆ—åŒ–ä¹‹å\nusername: JavaæŠ€æœ¯2\nid: null<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¤ºä¾‹2æŠŠ username æ”¹ä¸ºäº† public static, å¹¶åœ¨ååºåˆ—åŒ–å‡ºæ¥ä¹‹å‰æ”¹å˜äº†é™æ€å˜é‡çš„å€¼ï¼Œç»“æœå¯ä»¥çœ‹å‡ºåºåˆ—åŒ–ä¹‹åçš„å€¼å¹¶éåºåˆ—åŒ–è¿›å»æ—¶çš„å€¼ã€‚</p>\n<p>ç”±ä»¥ä¸Šç»“æœåˆ†æå¯çŸ¥ï¼Œé™æ€å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ï¼Œç¤ºä¾‹2è¯»å–å‡ºæ¥çš„æ˜¯ username åœ¨ JVM å†…å­˜ä¸­å­˜å‚¨çš„å€¼ã€‚</p>\n<h2 id=\"transient-çœŸä¸èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\"><a href=\"#transient-çœŸä¸èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\" class=\"headerlink\" title=\"transient çœŸä¸èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\"></a>transient çœŸä¸èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ</h2><p>ç»§ç»­æ¥çœ‹ç¤ºä¾‹3ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">import java.io.Externalizable;\nimport java.io.File;\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.IOException;\nimport java.io.ObjectInput;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutput;\nimport java.io.ObjectOutputStream;\n\n&#x2F;**\n * @author \n *&#x2F;\npublic class ExternalizableTest &#123;\n\n\tpublic static void main(String[] args) throws Exception &#123;\n\n\t\tUser3 user &#x3D; new User3();\n\t\tuser.setUsername(&quot;JavaæŠ€æœ¯&quot;);\n\t\tuser.setId(&quot;javastack&quot;);\n\t\tObjectOutput objectOutput &#x3D; new ObjectOutputStream(new FileOutputStream(new File(&quot;javastack&quot;)));\n\t\tobjectOutput.writeObject(user);\n\n\t\tObjectInput objectInput &#x3D; new ObjectInputStream(new FileInputStream(new File(&quot;javastack&quot;)));\n\t\tuser &#x3D; (User3) objectInput.readObject();\n\n\t\tSystem.out.println(user.getUsername());\n\t\tSystem.out.println(user.getId());\n\n\t\tobjectOutput.close();\n\t\tobjectInput.close();\n\t&#125;\n\n&#125;\n\n&#x2F;**\n * @author \n *&#x2F;\nclass User3 implements Externalizable &#123;\n\n\tprivate static final long serialVersionUID &#x3D; 1L;\n\n\tpublic User3() &#123;\n\n\t&#125;\n\n\tprivate String username;\n\tprivate transient String id;\n\n\tpublic String getUsername() &#123;\n\t\treturn username;\n\t&#125;\n\n\tpublic void setUsername(String username) &#123;\n\t\tthis.username &#x3D; username;\n\t&#125;\n\n\tpublic String getId() &#123;\n\t\treturn id;\n\t&#125;\n\n\tpublic void setId(String id) &#123;\n\t\tthis.id &#x3D; id;\n\t&#125;\n\n\t@Override\n\tpublic void writeExternal(ObjectOutput objectOutput) throws IOException &#123;\n\t\tobjectOutput.writeObject(id);\n\t&#125;\n\n\t@Override\n\tpublic void readExternal(ObjectInput objectInput) throws IOException, ClassNotFoundException &#123;\n\t\tid &#x3D; (String) objectInput.readObject();\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>è¾“å‡ºç»“æœï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">null\njavastack<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>ç¤ºä¾‹3çš„ id è¢« transient ä¿®æ”¹äº†ï¼Œä¸ºä»€ä¹ˆè¿˜èƒ½åºåˆ—åŒ–å‡ºæ¥ï¼Ÿé‚£æ˜¯å› ä¸º User3 å®ç°äº†æ¥å£ Externalizableï¼Œè€Œä¸æ˜¯ Serializableã€‚</p>\n<p>åœ¨ Java ä¸­æœ‰ä¸¤ç§å®ç°åºåˆ—åŒ–çš„æ–¹å¼ï¼ŒSerializable å’Œ Externalizableï¼Œå¯èƒ½å¤§éƒ¨åˆ†äººåªçŸ¥é“ Serializable è€Œä¸çŸ¥é“ Externalizableã€‚</p>\n<p>è¿™ä¸¤ç§åºåˆ—åŒ–æ–¹å¼çš„åŒºåˆ«æ˜¯ï¼šå®ç°äº† Serializable æ¥å£æ˜¯è‡ªåŠ¨åºåˆ—åŒ–çš„ï¼Œå®ç° Externalizable åˆ™éœ€è¦æ‰‹åŠ¨åºåˆ—åŒ–ï¼Œé€šè¿‡ writeExternal å’Œ readExternal æ–¹æ³•æ‰‹åŠ¨è¿›è¡Œï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸Šé¢çš„ username ä¸º null çš„åŸå› äº†ã€‚</p>\n<h2 id=\"transient-å…³é”®å­—æ€»ç»“\"><a href=\"#transient-å…³é”®å­—æ€»ç»“\" class=\"headerlink\" title=\"transient å…³é”®å­—æ€»ç»“\"></a>transient å…³é”®å­—æ€»ç»“</h2><p>1ï¼‰transientä¿®é¥°çš„å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ï¼›</p>\n<p>2ï¼‰transientåªä½œç”¨äºå®ç° Serializable æ¥å£ï¼›</p>\n<p>3ï¼‰transientåªèƒ½ç”¨æ¥ä¿®é¥°æ™®é€šæˆå‘˜å˜é‡å­—æ®µï¼›</p>\n<p>4ï¼‰ä¸ç®¡æœ‰æ²¡æœ‰ transient ä¿®é¥°ï¼Œé™æ€å˜é‡éƒ½ä¸èƒ½è¢«åºåˆ—åŒ–ï¼›</p>\n"},{"title":"ä½ çœŸçš„ææ‡‚ transient å…³é”®å­—äº†å—ï¼Ÿ","date":"2025-10-14T06:42:34.000Z","_content":"\n## å…ˆè§£é‡Šä¸‹ä»€ä¹ˆæ˜¯åºåˆ—åŒ–\n\næˆ‘ä»¬çš„å¯¹è±¡å¹¶ä¸åªæ˜¯å­˜åœ¨å†…å­˜ä¸­ï¼Œè¿˜éœ€è¦ä¼ è¾“ç½‘ç»œï¼Œæˆ–è€…ä¿å­˜èµ·æ¥ä¸‹æ¬¡å†åŠ è½½å‡ºæ¥ç”¨ï¼Œæ‰€ä»¥éœ€è¦Javaåºåˆ—åŒ–æŠ€æœ¯ã€‚\n\nJavaåºåˆ—åŒ–æŠ€æœ¯æ­£æ˜¯å°†å¯¹è±¡è½¬å˜æˆä¸€ä¸²ç”±äºŒè¿›åˆ¶å­—èŠ‚ç»„æˆçš„æ•°ç»„ï¼Œå¯ä»¥é€šè¿‡å°†äºŒè¿›åˆ¶æ•°æ®ä¿å­˜åˆ°ç£ç›˜æˆ–è€…ä¼ è¾“ç½‘ç»œï¼Œç£ç›˜æˆ–è€…ç½‘ç»œæ¥æ”¶è€…å¯ä»¥åœ¨å¯¹è±¡çš„å±ç±»çš„æ¨¡æ¿ä¸Šæ¥ååºåˆ—åŒ–ç±»çš„å¯¹è±¡ï¼Œè¾¾åˆ°å¯¹è±¡æŒä¹…åŒ–çš„ç›®çš„ã€‚\n\næ›´å¤šåºåˆ—åŒ–è¯·å‚è€ƒï¼šã€Š[å…³äºJavaåºåˆ—åŒ–ä½ åº”è¯¥çŸ¥é“çš„ä¸€åˆ‡](https://mp.weixin.qq.com/s/wHmK1kKyne6gCkIxt0NERQ)ã€‹è¿™ç¯‡æ–‡ç« ã€‚\n\n## ä»€ä¹ˆæ˜¯ transientï¼Ÿ\n\nç®€å•æ¥è¯´å°±æ˜¯ï¼Œè¢« transient ä¿®é¥°çš„å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ã€‚\n\n**å…·ä½“æ¥çœ‹ä¸‹é¢çš„ç¤ºä¾‹1**\n\n```\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutputStream;\nimport java.io.Serializable;\n\n/**\n * @author \n */\npublic class TransientTest {\n\n\tpublic static void main(String[] args) throws Exception {\n\n\t\tUser user = new User();\n\t\tuser.setUsername(\"JavaæŠ€æœ¯\");\n\t\tuser.setId(\"javastack\");\n\n\t\tSystem.out.println(\"\\nåºåˆ—åŒ–ä¹‹å‰\");\n\t\tSystem.out.println(\"username: \" + user.getUsername());\n\t\tSystem.out.println(\"id: \" + user.getId());\n\n\t\tObjectOutputStream os = new ObjectOutputStream(new FileOutputStream(\"d:/user.txt\"));\n\t\tos.writeObject(user);\n\t\tos.flush();\n\t\tos.close();\n\n\t\tObjectInputStream is = new ObjectInputStream(new FileInputStream(\"d:/user.txt\"));\n\t\tuser = (User) is.readObject();\n\t\tis.close();\n\n\t\tSystem.out.println(\"\\nåºåˆ—åŒ–ä¹‹å\");\n\t\tSystem.out.println(\"username: \" + user.getUsername());\n\t\tSystem.out.println(\"id: \" + user.getId());\n\n\t}\n}\n\n/**\n * @author \n */\nclass User implements Serializable {\n\n\tprivate static final long serialVersionUID = 1L;\n\n\tprivate String username;\n\tprivate transient String id;\n\n\tpublic String getUsername() {\n\t\treturn username;\n\t}\n\n\tpublic void setUsername(String username) {\n\t\tthis.username = username;\n\t}\n\n\tpublic String getId() {\n\t\treturn id;\n\t}\n\n\tpublic void setId(String id) {\n\t\tthis.id = id;\n\t}\n\n}\n```\n\n**è¾“å‡ºç»“æœï¼š**\n\n```\nåºåˆ—åŒ–ä¹‹å‰\nusername: JavaæŠ€æœ¯\nid: javastack\n\nåºåˆ—åŒ–ä¹‹å\nusername: JavaæŠ€æœ¯\nid: null\n```\n\nç¤ºä¾‹1åœ¨ id å­—æ®µä¸ŠåŠ äº† transient å…³é”®å­—ä¿®é¥°ï¼Œååºåˆ—åŒ–å‡ºæ¥ä¹‹åå€¼ä¸º nullï¼Œè¯´æ˜äº†è¢« transient ä¿®é¥°çš„å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ã€‚\n\n## é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\n\nè¿™ä¸ªè¯é¢˜ä¹Ÿæ˜¯æœ€è¿‘æ ˆé•¿çš„JavaæŠ€æœ¯vipç¾¤é‡Œé¢è®¨è®ºçš„ï¼Œå¤§å®¶å¯¹è¿™ä¸ªçŸ¥è¯†ç‚¹æ¯”è¾ƒæ¨¡ç³Šï¼Œæˆ‘å°±å†™äº†è¿™ç¯‡æ–‡ç« æµ‹è¯•æ€»ç»“ä¸€ä¸‹ã€‚\n\n![](http://img.javastack.cn/å¾®ä¿¡å›¾ç‰‡_20190214162351.png)\n\n> å¦‚æœä½ ä¹Ÿæƒ³åŠ å…¥æˆ‘ä»¬çš„JavaæŠ€æœ¯vipç¾¤å’Œå„ä½å¤§ç‰›ä¸€èµ·è®¨è®ºæŠ€æœ¯ï¼Œé‚£ç‚¹å‡»[è¿™ä¸ªé“¾æ¥](https://mp.weixin.qq.com/s/iqCLAduVzDqt19L6D4FCUQ)äº†è§£åŠ å…¥å§ã€‚\n\né‚£ä¹ˆï¼Œåˆ°åº•é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼ŸåºŸè¯å°‘è¯´ï¼Œå…ˆåŠ¨æ‰‹æµ‹è¯•ä¸‹å§ï¼\n\nç¤ºä¾‹2ï¼š\n\n```\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutputStream;\nimport java.io.Serializable;\n\n/**\n * @author \n */\npublic class TransientStaticTest {\n\n\tpublic static void main(String[] args) throws Exception {\n\n\t\tUser2 user = new User2();\n\t\tUser2.username = \"JavaæŠ€æœ¯1\";\n\t\tuser.setId(\"javastack\");\n\n\t\tSystem.out.println(\"\\nåºåˆ—åŒ–ä¹‹å‰\");\n\t\tSystem.out.println(\"username: \" + user.getUsername());\n\t\tSystem.out.println(\"id: \" + user.getId());\n\n\t\tObjectOutputStream os = new ObjectOutputStream(new FileOutputStream(\"d:/user.txt\"));\n\t\tos.writeObject(user);\n\t\tos.flush();\n\t\tos.close();\n\t\t\n\t\t// åœ¨ååºåˆ—åŒ–å‡ºæ¥ä¹‹å‰ï¼Œæ”¹å˜é™æ€å˜é‡çš„å€¼\n\t\tUser2.username = \"JavaæŠ€æœ¯2\";\n\n\t\tObjectInputStream is = new ObjectInputStream(new FileInputStream(\"d:/user.txt\"));\n\t\tuser = (User2) is.readObject();\n\t\tis.close();\n\n\t\tSystem.out.println(\"\\nåºåˆ—åŒ–ä¹‹å\");\n\t\tSystem.out.println(\"username: \" + user.getUsername());\n\t\tSystem.out.println(\"id: \" + user.getId());\n\n\t}\n}\n\n/**\n * @author \n */\nclass User2 implements Serializable {\n\n\tprivate static final long serialVersionUID = 1L;\n\n\tpublic static String username;\n\tprivate transient String id;\n\n\tpublic String getUsername() {\n\t\treturn username;\n\t}\n\n\tpublic String getId() {\n\t\treturn id;\n\t}\n\n\tpublic void setId(String id) {\n\t\tthis.id = id;\n\t}\n\n}\n```\n\n**è¾“å‡ºç»“æœï¼š**\n\n```\nåºåˆ—åŒ–ä¹‹å‰\nusername: JavaæŠ€æœ¯1\nid: javastack\n\nåºåˆ—åŒ–ä¹‹å\nusername: JavaæŠ€æœ¯2\nid: null\n```\n\nç¤ºä¾‹2æŠŠ username æ”¹ä¸ºäº† public static, å¹¶åœ¨ååºåˆ—åŒ–å‡ºæ¥ä¹‹å‰æ”¹å˜äº†é™æ€å˜é‡çš„å€¼ï¼Œç»“æœå¯ä»¥çœ‹å‡ºåºåˆ—åŒ–ä¹‹åçš„å€¼å¹¶éåºåˆ—åŒ–è¿›å»æ—¶çš„å€¼ã€‚\n\nç”±ä»¥ä¸Šç»“æœåˆ†æå¯çŸ¥ï¼Œé™æ€å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ï¼Œç¤ºä¾‹2è¯»å–å‡ºæ¥çš„æ˜¯ username åœ¨ JVM å†…å­˜ä¸­å­˜å‚¨çš„å€¼ã€‚\n\n## transient çœŸä¸èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\n\nç»§ç»­æ¥çœ‹ç¤ºä¾‹3ï¼š\n\n```\nimport java.io.Externalizable;\nimport java.io.File;\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.IOException;\nimport java.io.ObjectInput;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutput;\nimport java.io.ObjectOutputStream;\n\n/**\n * @author \n */\npublic class ExternalizableTest {\n\n\tpublic static void main(String[] args) throws Exception {\n\n\t\tUser3 user = new User3();\n\t\tuser.setUsername(\"JavaæŠ€æœ¯\");\n\t\tuser.setId(\"javastack\");\n\t\tObjectOutput objectOutput = new ObjectOutputStream(new FileOutputStream(new File(\"javastack\")));\n\t\tobjectOutput.writeObject(user);\n\n\t\tObjectInput objectInput = new ObjectInputStream(new FileInputStream(new File(\"javastack\")));\n\t\tuser = (User3) objectInput.readObject();\n\n\t\tSystem.out.println(user.getUsername());\n\t\tSystem.out.println(user.getId());\n\n\t\tobjectOutput.close();\n\t\tobjectInput.close();\n\t}\n\n}\n\n/**\n * @author \n */\nclass User3 implements Externalizable {\n\n\tprivate static final long serialVersionUID = 1L;\n\n\tpublic User3() {\n\n\t}\n\n\tprivate String username;\n\tprivate transient String id;\n\n\tpublic String getUsername() {\n\t\treturn username;\n\t}\n\n\tpublic void setUsername(String username) {\n\t\tthis.username = username;\n\t}\n\n\tpublic String getId() {\n\t\treturn id;\n\t}\n\n\tpublic void setId(String id) {\n\t\tthis.id = id;\n\t}\n\n\t@Override\n\tpublic void writeExternal(ObjectOutput objectOutput) throws IOException {\n\t\tobjectOutput.writeObject(id);\n\t}\n\n\t@Override\n\tpublic void readExternal(ObjectInput objectInput) throws IOException, ClassNotFoundException {\n\t\tid = (String) objectInput.readObject();\n\t}\n\n}\n```\n\n**è¾“å‡ºç»“æœï¼š**\n\n```\nnull\njavastack\n```\n\nç¤ºä¾‹3çš„ id è¢« transient ä¿®æ”¹äº†ï¼Œä¸ºä»€ä¹ˆè¿˜èƒ½åºåˆ—åŒ–å‡ºæ¥ï¼Ÿé‚£æ˜¯å› ä¸º User3 å®ç°äº†æ¥å£ Externalizableï¼Œè€Œä¸æ˜¯ Serializableã€‚\n\nåœ¨ Java ä¸­æœ‰ä¸¤ç§å®ç°åºåˆ—åŒ–çš„æ–¹å¼ï¼ŒSerializable å’Œ Externalizableï¼Œå¯èƒ½å¤§éƒ¨åˆ†äººåªçŸ¥é“ Serializable è€Œä¸çŸ¥é“ Externalizableã€‚\n\nè¿™ä¸¤ç§åºåˆ—åŒ–æ–¹å¼çš„åŒºåˆ«æ˜¯ï¼šå®ç°äº† Serializable æ¥å£æ˜¯è‡ªåŠ¨åºåˆ—åŒ–çš„ï¼Œå®ç° Externalizable åˆ™éœ€è¦æ‰‹åŠ¨åºåˆ—åŒ–ï¼Œé€šè¿‡ writeExternal å’Œ readExternal æ–¹æ³•æ‰‹åŠ¨è¿›è¡Œï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸Šé¢çš„ username ä¸º null çš„åŸå› äº†ã€‚\n\n## transient å…³é”®å­—æ€»ç»“\n\n1ï¼‰transientä¿®é¥°çš„å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ï¼›\n\n2ï¼‰transientåªä½œç”¨äºå®ç° Serializable æ¥å£ï¼›\n\n3ï¼‰transientåªèƒ½ç”¨æ¥ä¿®é¥°æ™®é€šæˆå‘˜å˜é‡å­—æ®µï¼›\n\n4ï¼‰ä¸ç®¡æœ‰æ²¡æœ‰ transient ä¿®é¥°ï¼Œé™æ€å˜é‡éƒ½ä¸èƒ½è¢«åºåˆ—åŒ–ï¼›\n\n\n\n","source":"_posts/åŸºç¡€/ä½ çœŸçš„ææ‡‚ transient å…³é”®å­—äº†å—ï¼Ÿ.md","raw":"---\ntitle: ä½ çœŸçš„ææ‡‚ transient å…³é”®å­—äº†å—ï¼Ÿ\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: åŸºç¡€\n---\n\n## å…ˆè§£é‡Šä¸‹ä»€ä¹ˆæ˜¯åºåˆ—åŒ–\n\næˆ‘ä»¬çš„å¯¹è±¡å¹¶ä¸åªæ˜¯å­˜åœ¨å†…å­˜ä¸­ï¼Œè¿˜éœ€è¦ä¼ è¾“ç½‘ç»œï¼Œæˆ–è€…ä¿å­˜èµ·æ¥ä¸‹æ¬¡å†åŠ è½½å‡ºæ¥ç”¨ï¼Œæ‰€ä»¥éœ€è¦Javaåºåˆ—åŒ–æŠ€æœ¯ã€‚\n\nJavaåºåˆ—åŒ–æŠ€æœ¯æ­£æ˜¯å°†å¯¹è±¡è½¬å˜æˆä¸€ä¸²ç”±äºŒè¿›åˆ¶å­—èŠ‚ç»„æˆçš„æ•°ç»„ï¼Œå¯ä»¥é€šè¿‡å°†äºŒè¿›åˆ¶æ•°æ®ä¿å­˜åˆ°ç£ç›˜æˆ–è€…ä¼ è¾“ç½‘ç»œï¼Œç£ç›˜æˆ–è€…ç½‘ç»œæ¥æ”¶è€…å¯ä»¥åœ¨å¯¹è±¡çš„å±ç±»çš„æ¨¡æ¿ä¸Šæ¥ååºåˆ—åŒ–ç±»çš„å¯¹è±¡ï¼Œè¾¾åˆ°å¯¹è±¡æŒä¹…åŒ–çš„ç›®çš„ã€‚\n\næ›´å¤šåºåˆ—åŒ–è¯·å‚è€ƒï¼šã€Š[å…³äºJavaåºåˆ—åŒ–ä½ åº”è¯¥çŸ¥é“çš„ä¸€åˆ‡](https://mp.weixin.qq.com/s/wHmK1kKyne6gCkIxt0NERQ)ã€‹è¿™ç¯‡æ–‡ç« ã€‚\n\n## ä»€ä¹ˆæ˜¯ transientï¼Ÿ\n\nç®€å•æ¥è¯´å°±æ˜¯ï¼Œè¢« transient ä¿®é¥°çš„å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ã€‚\n\n**å…·ä½“æ¥çœ‹ä¸‹é¢çš„ç¤ºä¾‹1**\n\n```\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutputStream;\nimport java.io.Serializable;\n\n/**\n * @author \n */\npublic class TransientTest {\n\n\tpublic static void main(String[] args) throws Exception {\n\n\t\tUser user = new User();\n\t\tuser.setUsername(\"JavaæŠ€æœ¯\");\n\t\tuser.setId(\"javastack\");\n\n\t\tSystem.out.println(\"\\nåºåˆ—åŒ–ä¹‹å‰\");\n\t\tSystem.out.println(\"username: \" + user.getUsername());\n\t\tSystem.out.println(\"id: \" + user.getId());\n\n\t\tObjectOutputStream os = new ObjectOutputStream(new FileOutputStream(\"d:/user.txt\"));\n\t\tos.writeObject(user);\n\t\tos.flush();\n\t\tos.close();\n\n\t\tObjectInputStream is = new ObjectInputStream(new FileInputStream(\"d:/user.txt\"));\n\t\tuser = (User) is.readObject();\n\t\tis.close();\n\n\t\tSystem.out.println(\"\\nåºåˆ—åŒ–ä¹‹å\");\n\t\tSystem.out.println(\"username: \" + user.getUsername());\n\t\tSystem.out.println(\"id: \" + user.getId());\n\n\t}\n}\n\n/**\n * @author \n */\nclass User implements Serializable {\n\n\tprivate static final long serialVersionUID = 1L;\n\n\tprivate String username;\n\tprivate transient String id;\n\n\tpublic String getUsername() {\n\t\treturn username;\n\t}\n\n\tpublic void setUsername(String username) {\n\t\tthis.username = username;\n\t}\n\n\tpublic String getId() {\n\t\treturn id;\n\t}\n\n\tpublic void setId(String id) {\n\t\tthis.id = id;\n\t}\n\n}\n```\n\n**è¾“å‡ºç»“æœï¼š**\n\n```\nåºåˆ—åŒ–ä¹‹å‰\nusername: JavaæŠ€æœ¯\nid: javastack\n\nåºåˆ—åŒ–ä¹‹å\nusername: JavaæŠ€æœ¯\nid: null\n```\n\nç¤ºä¾‹1åœ¨ id å­—æ®µä¸ŠåŠ äº† transient å…³é”®å­—ä¿®é¥°ï¼Œååºåˆ—åŒ–å‡ºæ¥ä¹‹åå€¼ä¸º nullï¼Œè¯´æ˜äº†è¢« transient ä¿®é¥°çš„å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ã€‚\n\n## é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\n\nè¿™ä¸ªè¯é¢˜ä¹Ÿæ˜¯æœ€è¿‘æ ˆé•¿çš„JavaæŠ€æœ¯vipç¾¤é‡Œé¢è®¨è®ºçš„ï¼Œå¤§å®¶å¯¹è¿™ä¸ªçŸ¥è¯†ç‚¹æ¯”è¾ƒæ¨¡ç³Šï¼Œæˆ‘å°±å†™äº†è¿™ç¯‡æ–‡ç« æµ‹è¯•æ€»ç»“ä¸€ä¸‹ã€‚\n\n![](http://img.javastack.cn/å¾®ä¿¡å›¾ç‰‡_20190214162351.png)\n\n> å¦‚æœä½ ä¹Ÿæƒ³åŠ å…¥æˆ‘ä»¬çš„JavaæŠ€æœ¯vipç¾¤å’Œå„ä½å¤§ç‰›ä¸€èµ·è®¨è®ºæŠ€æœ¯ï¼Œé‚£ç‚¹å‡»[è¿™ä¸ªé“¾æ¥](https://mp.weixin.qq.com/s/iqCLAduVzDqt19L6D4FCUQ)äº†è§£åŠ å…¥å§ã€‚\n\né‚£ä¹ˆï¼Œåˆ°åº•é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼ŸåºŸè¯å°‘è¯´ï¼Œå…ˆåŠ¨æ‰‹æµ‹è¯•ä¸‹å§ï¼\n\nç¤ºä¾‹2ï¼š\n\n```\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutputStream;\nimport java.io.Serializable;\n\n/**\n * @author \n */\npublic class TransientStaticTest {\n\n\tpublic static void main(String[] args) throws Exception {\n\n\t\tUser2 user = new User2();\n\t\tUser2.username = \"JavaæŠ€æœ¯1\";\n\t\tuser.setId(\"javastack\");\n\n\t\tSystem.out.println(\"\\nåºåˆ—åŒ–ä¹‹å‰\");\n\t\tSystem.out.println(\"username: \" + user.getUsername());\n\t\tSystem.out.println(\"id: \" + user.getId());\n\n\t\tObjectOutputStream os = new ObjectOutputStream(new FileOutputStream(\"d:/user.txt\"));\n\t\tos.writeObject(user);\n\t\tos.flush();\n\t\tos.close();\n\t\t\n\t\t// åœ¨ååºåˆ—åŒ–å‡ºæ¥ä¹‹å‰ï¼Œæ”¹å˜é™æ€å˜é‡çš„å€¼\n\t\tUser2.username = \"JavaæŠ€æœ¯2\";\n\n\t\tObjectInputStream is = new ObjectInputStream(new FileInputStream(\"d:/user.txt\"));\n\t\tuser = (User2) is.readObject();\n\t\tis.close();\n\n\t\tSystem.out.println(\"\\nåºåˆ—åŒ–ä¹‹å\");\n\t\tSystem.out.println(\"username: \" + user.getUsername());\n\t\tSystem.out.println(\"id: \" + user.getId());\n\n\t}\n}\n\n/**\n * @author \n */\nclass User2 implements Serializable {\n\n\tprivate static final long serialVersionUID = 1L;\n\n\tpublic static String username;\n\tprivate transient String id;\n\n\tpublic String getUsername() {\n\t\treturn username;\n\t}\n\n\tpublic String getId() {\n\t\treturn id;\n\t}\n\n\tpublic void setId(String id) {\n\t\tthis.id = id;\n\t}\n\n}\n```\n\n**è¾“å‡ºç»“æœï¼š**\n\n```\nåºåˆ—åŒ–ä¹‹å‰\nusername: JavaæŠ€æœ¯1\nid: javastack\n\nåºåˆ—åŒ–ä¹‹å\nusername: JavaæŠ€æœ¯2\nid: null\n```\n\nç¤ºä¾‹2æŠŠ username æ”¹ä¸ºäº† public static, å¹¶åœ¨ååºåˆ—åŒ–å‡ºæ¥ä¹‹å‰æ”¹å˜äº†é™æ€å˜é‡çš„å€¼ï¼Œç»“æœå¯ä»¥çœ‹å‡ºåºåˆ—åŒ–ä¹‹åçš„å€¼å¹¶éåºåˆ—åŒ–è¿›å»æ—¶çš„å€¼ã€‚\n\nç”±ä»¥ä¸Šç»“æœåˆ†æå¯çŸ¥ï¼Œé™æ€å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ï¼Œç¤ºä¾‹2è¯»å–å‡ºæ¥çš„æ˜¯ username åœ¨ JVM å†…å­˜ä¸­å­˜å‚¨çš„å€¼ã€‚\n\n## transient çœŸä¸èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\n\nç»§ç»­æ¥çœ‹ç¤ºä¾‹3ï¼š\n\n```\nimport java.io.Externalizable;\nimport java.io.File;\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.IOException;\nimport java.io.ObjectInput;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutput;\nimport java.io.ObjectOutputStream;\n\n/**\n * @author \n */\npublic class ExternalizableTest {\n\n\tpublic static void main(String[] args) throws Exception {\n\n\t\tUser3 user = new User3();\n\t\tuser.setUsername(\"JavaæŠ€æœ¯\");\n\t\tuser.setId(\"javastack\");\n\t\tObjectOutput objectOutput = new ObjectOutputStream(new FileOutputStream(new File(\"javastack\")));\n\t\tobjectOutput.writeObject(user);\n\n\t\tObjectInput objectInput = new ObjectInputStream(new FileInputStream(new File(\"javastack\")));\n\t\tuser = (User3) objectInput.readObject();\n\n\t\tSystem.out.println(user.getUsername());\n\t\tSystem.out.println(user.getId());\n\n\t\tobjectOutput.close();\n\t\tobjectInput.close();\n\t}\n\n}\n\n/**\n * @author \n */\nclass User3 implements Externalizable {\n\n\tprivate static final long serialVersionUID = 1L;\n\n\tpublic User3() {\n\n\t}\n\n\tprivate String username;\n\tprivate transient String id;\n\n\tpublic String getUsername() {\n\t\treturn username;\n\t}\n\n\tpublic void setUsername(String username) {\n\t\tthis.username = username;\n\t}\n\n\tpublic String getId() {\n\t\treturn id;\n\t}\n\n\tpublic void setId(String id) {\n\t\tthis.id = id;\n\t}\n\n\t@Override\n\tpublic void writeExternal(ObjectOutput objectOutput) throws IOException {\n\t\tobjectOutput.writeObject(id);\n\t}\n\n\t@Override\n\tpublic void readExternal(ObjectInput objectInput) throws IOException, ClassNotFoundException {\n\t\tid = (String) objectInput.readObject();\n\t}\n\n}\n```\n\n**è¾“å‡ºç»“æœï¼š**\n\n```\nnull\njavastack\n```\n\nç¤ºä¾‹3çš„ id è¢« transient ä¿®æ”¹äº†ï¼Œä¸ºä»€ä¹ˆè¿˜èƒ½åºåˆ—åŒ–å‡ºæ¥ï¼Ÿé‚£æ˜¯å› ä¸º User3 å®ç°äº†æ¥å£ Externalizableï¼Œè€Œä¸æ˜¯ Serializableã€‚\n\nåœ¨ Java ä¸­æœ‰ä¸¤ç§å®ç°åºåˆ—åŒ–çš„æ–¹å¼ï¼ŒSerializable å’Œ Externalizableï¼Œå¯èƒ½å¤§éƒ¨åˆ†äººåªçŸ¥é“ Serializable è€Œä¸çŸ¥é“ Externalizableã€‚\n\nè¿™ä¸¤ç§åºåˆ—åŒ–æ–¹å¼çš„åŒºåˆ«æ˜¯ï¼šå®ç°äº† Serializable æ¥å£æ˜¯è‡ªåŠ¨åºåˆ—åŒ–çš„ï¼Œå®ç° Externalizable åˆ™éœ€è¦æ‰‹åŠ¨åºåˆ—åŒ–ï¼Œé€šè¿‡ writeExternal å’Œ readExternal æ–¹æ³•æ‰‹åŠ¨è¿›è¡Œï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸Šé¢çš„ username ä¸º null çš„åŸå› äº†ã€‚\n\n## transient å…³é”®å­—æ€»ç»“\n\n1ï¼‰transientä¿®é¥°çš„å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ï¼›\n\n2ï¼‰transientåªä½œç”¨äºå®ç° Serializable æ¥å£ï¼›\n\n3ï¼‰transientåªèƒ½ç”¨æ¥ä¿®é¥°æ™®é€šæˆå‘˜å˜é‡å­—æ®µï¼›\n\n4ï¼‰ä¸ç®¡æœ‰æ²¡æœ‰ transient ä¿®é¥°ï¼Œé™æ€å˜é‡éƒ½ä¸èƒ½è¢«åºåˆ—åŒ–ï¼›\n\n\n\n","slug":"åŸºç¡€/ä½ çœŸçš„ææ‡‚ transient å…³é”®å­—äº†å—ï¼Ÿ","published":1,"updated":"2025-10-15T07:19:51.829Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076w0043qkd420r86rm2","content":"<h2 id=\"å…ˆè§£é‡Šä¸‹ä»€ä¹ˆæ˜¯åºåˆ—åŒ–\"><a href=\"#å…ˆè§£é‡Šä¸‹ä»€ä¹ˆæ˜¯åºåˆ—åŒ–\" class=\"headerlink\" title=\"å…ˆè§£é‡Šä¸‹ä»€ä¹ˆæ˜¯åºåˆ—åŒ–\"></a>å…ˆè§£é‡Šä¸‹ä»€ä¹ˆæ˜¯åºåˆ—åŒ–</h2><p>æˆ‘ä»¬çš„å¯¹è±¡å¹¶ä¸åªæ˜¯å­˜åœ¨å†…å­˜ä¸­ï¼Œè¿˜éœ€è¦ä¼ è¾“ç½‘ç»œï¼Œæˆ–è€…ä¿å­˜èµ·æ¥ä¸‹æ¬¡å†åŠ è½½å‡ºæ¥ç”¨ï¼Œæ‰€ä»¥éœ€è¦Javaåºåˆ—åŒ–æŠ€æœ¯ã€‚</p>\n<p>Javaåºåˆ—åŒ–æŠ€æœ¯æ­£æ˜¯å°†å¯¹è±¡è½¬å˜æˆä¸€ä¸²ç”±äºŒè¿›åˆ¶å­—èŠ‚ç»„æˆçš„æ•°ç»„ï¼Œå¯ä»¥é€šè¿‡å°†äºŒè¿›åˆ¶æ•°æ®ä¿å­˜åˆ°ç£ç›˜æˆ–è€…ä¼ è¾“ç½‘ç»œï¼Œç£ç›˜æˆ–è€…ç½‘ç»œæ¥æ”¶è€…å¯ä»¥åœ¨å¯¹è±¡çš„å±ç±»çš„æ¨¡æ¿ä¸Šæ¥ååºåˆ—åŒ–ç±»çš„å¯¹è±¡ï¼Œè¾¾åˆ°å¯¹è±¡æŒä¹…åŒ–çš„ç›®çš„ã€‚</p>\n<p>æ›´å¤šåºåˆ—åŒ–è¯·å‚è€ƒï¼šã€Š<a href=\"https://mp.weixin.qq.com/s/wHmK1kKyne6gCkIxt0NERQ\">å…³äºJavaåºåˆ—åŒ–ä½ åº”è¯¥çŸ¥é“çš„ä¸€åˆ‡</a>ã€‹è¿™ç¯‡æ–‡ç« ã€‚</p>\n<h2 id=\"ä»€ä¹ˆæ˜¯-transientï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯-transientï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ transientï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯ transientï¼Ÿ</h2><p>ç®€å•æ¥è¯´å°±æ˜¯ï¼Œè¢« transient ä¿®é¥°çš„å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ã€‚</p>\n<p><strong>å…·ä½“æ¥çœ‹ä¸‹é¢çš„ç¤ºä¾‹1</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">import java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutputStream;\nimport java.io.Serializable;\n\n&#x2F;**\n * @author \n *&#x2F;\npublic class TransientTest &#123;\n\n\tpublic static void main(String[] args) throws Exception &#123;\n\n\t\tUser user &#x3D; new User();\n\t\tuser.setUsername(&quot;JavaæŠ€æœ¯&quot;);\n\t\tuser.setId(&quot;javastack&quot;);\n\n\t\tSystem.out.println(&quot;\\nåºåˆ—åŒ–ä¹‹å‰&quot;);\n\t\tSystem.out.println(&quot;username: &quot; + user.getUsername());\n\t\tSystem.out.println(&quot;id: &quot; + user.getId());\n\n\t\tObjectOutputStream os &#x3D; new ObjectOutputStream(new FileOutputStream(&quot;d:&#x2F;user.txt&quot;));\n\t\tos.writeObject(user);\n\t\tos.flush();\n\t\tos.close();\n\n\t\tObjectInputStream is &#x3D; new ObjectInputStream(new FileInputStream(&quot;d:&#x2F;user.txt&quot;));\n\t\tuser &#x3D; (User) is.readObject();\n\t\tis.close();\n\n\t\tSystem.out.println(&quot;\\nåºåˆ—åŒ–ä¹‹å&quot;);\n\t\tSystem.out.println(&quot;username: &quot; + user.getUsername());\n\t\tSystem.out.println(&quot;id: &quot; + user.getId());\n\n\t&#125;\n&#125;\n\n&#x2F;**\n * @author \n *&#x2F;\nclass User implements Serializable &#123;\n\n\tprivate static final long serialVersionUID &#x3D; 1L;\n\n\tprivate String username;\n\tprivate transient String id;\n\n\tpublic String getUsername() &#123;\n\t\treturn username;\n\t&#125;\n\n\tpublic void setUsername(String username) &#123;\n\t\tthis.username &#x3D; username;\n\t&#125;\n\n\tpublic String getId() &#123;\n\t\treturn id;\n\t&#125;\n\n\tpublic void setId(String id) &#123;\n\t\tthis.id &#x3D; id;\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>è¾“å‡ºç»“æœï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">åºåˆ—åŒ–ä¹‹å‰\nusername: JavaæŠ€æœ¯\nid: javastack\n\nåºåˆ—åŒ–ä¹‹å\nusername: JavaæŠ€æœ¯\nid: null<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¤ºä¾‹1åœ¨ id å­—æ®µä¸ŠåŠ äº† transient å…³é”®å­—ä¿®é¥°ï¼Œååºåˆ—åŒ–å‡ºæ¥ä¹‹åå€¼ä¸º nullï¼Œè¯´æ˜äº†è¢« transient ä¿®é¥°çš„å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ã€‚</p>\n<h2 id=\"é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\"><a href=\"#é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\" class=\"headerlink\" title=\"é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\"></a>é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ</h2><p>è¿™ä¸ªè¯é¢˜ä¹Ÿæ˜¯æœ€è¿‘æ ˆé•¿çš„JavaæŠ€æœ¯vipç¾¤é‡Œé¢è®¨è®ºçš„ï¼Œå¤§å®¶å¯¹è¿™ä¸ªçŸ¥è¯†ç‚¹æ¯”è¾ƒæ¨¡ç³Šï¼Œæˆ‘å°±å†™äº†è¿™ç¯‡æ–‡ç« æµ‹è¯•æ€»ç»“ä¸€ä¸‹ã€‚</p>\n<p><img src=\"http://img.javastack.cn/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190214162351.png\"></p>\n<blockquote>\n<p>å¦‚æœä½ ä¹Ÿæƒ³åŠ å…¥æˆ‘ä»¬çš„JavaæŠ€æœ¯vipç¾¤å’Œå„ä½å¤§ç‰›ä¸€èµ·è®¨è®ºæŠ€æœ¯ï¼Œé‚£ç‚¹å‡»<a href=\"https://mp.weixin.qq.com/s/iqCLAduVzDqt19L6D4FCUQ\">è¿™ä¸ªé“¾æ¥</a>äº†è§£åŠ å…¥å§ã€‚</p>\n</blockquote>\n<p>é‚£ä¹ˆï¼Œåˆ°åº•é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼ŸåºŸè¯å°‘è¯´ï¼Œå…ˆåŠ¨æ‰‹æµ‹è¯•ä¸‹å§ï¼</p>\n<p>ç¤ºä¾‹2ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">import java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutputStream;\nimport java.io.Serializable;\n\n&#x2F;**\n * @author \n *&#x2F;\npublic class TransientStaticTest &#123;\n\n\tpublic static void main(String[] args) throws Exception &#123;\n\n\t\tUser2 user &#x3D; new User2();\n\t\tUser2.username &#x3D; &quot;JavaæŠ€æœ¯1&quot;;\n\t\tuser.setId(&quot;javastack&quot;);\n\n\t\tSystem.out.println(&quot;\\nåºåˆ—åŒ–ä¹‹å‰&quot;);\n\t\tSystem.out.println(&quot;username: &quot; + user.getUsername());\n\t\tSystem.out.println(&quot;id: &quot; + user.getId());\n\n\t\tObjectOutputStream os &#x3D; new ObjectOutputStream(new FileOutputStream(&quot;d:&#x2F;user.txt&quot;));\n\t\tos.writeObject(user);\n\t\tos.flush();\n\t\tos.close();\n\t\t\n\t\t&#x2F;&#x2F; åœ¨ååºåˆ—åŒ–å‡ºæ¥ä¹‹å‰ï¼Œæ”¹å˜é™æ€å˜é‡çš„å€¼\n\t\tUser2.username &#x3D; &quot;JavaæŠ€æœ¯2&quot;;\n\n\t\tObjectInputStream is &#x3D; new ObjectInputStream(new FileInputStream(&quot;d:&#x2F;user.txt&quot;));\n\t\tuser &#x3D; (User2) is.readObject();\n\t\tis.close();\n\n\t\tSystem.out.println(&quot;\\nåºåˆ—åŒ–ä¹‹å&quot;);\n\t\tSystem.out.println(&quot;username: &quot; + user.getUsername());\n\t\tSystem.out.println(&quot;id: &quot; + user.getId());\n\n\t&#125;\n&#125;\n\n&#x2F;**\n * @author \n *&#x2F;\nclass User2 implements Serializable &#123;\n\n\tprivate static final long serialVersionUID &#x3D; 1L;\n\n\tpublic static String username;\n\tprivate transient String id;\n\n\tpublic String getUsername() &#123;\n\t\treturn username;\n\t&#125;\n\n\tpublic String getId() &#123;\n\t\treturn id;\n\t&#125;\n\n\tpublic void setId(String id) &#123;\n\t\tthis.id &#x3D; id;\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>è¾“å‡ºç»“æœï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">åºåˆ—åŒ–ä¹‹å‰\nusername: JavaæŠ€æœ¯1\nid: javastack\n\nåºåˆ—åŒ–ä¹‹å\nusername: JavaæŠ€æœ¯2\nid: null<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¤ºä¾‹2æŠŠ username æ”¹ä¸ºäº† public static, å¹¶åœ¨ååºåˆ—åŒ–å‡ºæ¥ä¹‹å‰æ”¹å˜äº†é™æ€å˜é‡çš„å€¼ï¼Œç»“æœå¯ä»¥çœ‹å‡ºåºåˆ—åŒ–ä¹‹åçš„å€¼å¹¶éåºåˆ—åŒ–è¿›å»æ—¶çš„å€¼ã€‚</p>\n<p>ç”±ä»¥ä¸Šç»“æœåˆ†æå¯çŸ¥ï¼Œé™æ€å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ï¼Œç¤ºä¾‹2è¯»å–å‡ºæ¥çš„æ˜¯ username åœ¨ JVM å†…å­˜ä¸­å­˜å‚¨çš„å€¼ã€‚</p>\n<h2 id=\"transient-çœŸä¸èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\"><a href=\"#transient-çœŸä¸èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\" class=\"headerlink\" title=\"transient çœŸä¸èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\"></a>transient çœŸä¸èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ</h2><p>ç»§ç»­æ¥çœ‹ç¤ºä¾‹3ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">import java.io.Externalizable;\nimport java.io.File;\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.IOException;\nimport java.io.ObjectInput;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutput;\nimport java.io.ObjectOutputStream;\n\n&#x2F;**\n * @author \n *&#x2F;\npublic class ExternalizableTest &#123;\n\n\tpublic static void main(String[] args) throws Exception &#123;\n\n\t\tUser3 user &#x3D; new User3();\n\t\tuser.setUsername(&quot;JavaæŠ€æœ¯&quot;);\n\t\tuser.setId(&quot;javastack&quot;);\n\t\tObjectOutput objectOutput &#x3D; new ObjectOutputStream(new FileOutputStream(new File(&quot;javastack&quot;)));\n\t\tobjectOutput.writeObject(user);\n\n\t\tObjectInput objectInput &#x3D; new ObjectInputStream(new FileInputStream(new File(&quot;javastack&quot;)));\n\t\tuser &#x3D; (User3) objectInput.readObject();\n\n\t\tSystem.out.println(user.getUsername());\n\t\tSystem.out.println(user.getId());\n\n\t\tobjectOutput.close();\n\t\tobjectInput.close();\n\t&#125;\n\n&#125;\n\n&#x2F;**\n * @author \n *&#x2F;\nclass User3 implements Externalizable &#123;\n\n\tprivate static final long serialVersionUID &#x3D; 1L;\n\n\tpublic User3() &#123;\n\n\t&#125;\n\n\tprivate String username;\n\tprivate transient String id;\n\n\tpublic String getUsername() &#123;\n\t\treturn username;\n\t&#125;\n\n\tpublic void setUsername(String username) &#123;\n\t\tthis.username &#x3D; username;\n\t&#125;\n\n\tpublic String getId() &#123;\n\t\treturn id;\n\t&#125;\n\n\tpublic void setId(String id) &#123;\n\t\tthis.id &#x3D; id;\n\t&#125;\n\n\t@Override\n\tpublic void writeExternal(ObjectOutput objectOutput) throws IOException &#123;\n\t\tobjectOutput.writeObject(id);\n\t&#125;\n\n\t@Override\n\tpublic void readExternal(ObjectInput objectInput) throws IOException, ClassNotFoundException &#123;\n\t\tid &#x3D; (String) objectInput.readObject();\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>è¾“å‡ºç»“æœï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">null\njavastack<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>ç¤ºä¾‹3çš„ id è¢« transient ä¿®æ”¹äº†ï¼Œä¸ºä»€ä¹ˆè¿˜èƒ½åºåˆ—åŒ–å‡ºæ¥ï¼Ÿé‚£æ˜¯å› ä¸º User3 å®ç°äº†æ¥å£ Externalizableï¼Œè€Œä¸æ˜¯ Serializableã€‚</p>\n<p>åœ¨ Java ä¸­æœ‰ä¸¤ç§å®ç°åºåˆ—åŒ–çš„æ–¹å¼ï¼ŒSerializable å’Œ Externalizableï¼Œå¯èƒ½å¤§éƒ¨åˆ†äººåªçŸ¥é“ Serializable è€Œä¸çŸ¥é“ Externalizableã€‚</p>\n<p>è¿™ä¸¤ç§åºåˆ—åŒ–æ–¹å¼çš„åŒºåˆ«æ˜¯ï¼šå®ç°äº† Serializable æ¥å£æ˜¯è‡ªåŠ¨åºåˆ—åŒ–çš„ï¼Œå®ç° Externalizable åˆ™éœ€è¦æ‰‹åŠ¨åºåˆ—åŒ–ï¼Œé€šè¿‡ writeExternal å’Œ readExternal æ–¹æ³•æ‰‹åŠ¨è¿›è¡Œï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸Šé¢çš„ username ä¸º null çš„åŸå› äº†ã€‚</p>\n<h2 id=\"transient-å…³é”®å­—æ€»ç»“\"><a href=\"#transient-å…³é”®å­—æ€»ç»“\" class=\"headerlink\" title=\"transient å…³é”®å­—æ€»ç»“\"></a>transient å…³é”®å­—æ€»ç»“</h2><p>1ï¼‰transientä¿®é¥°çš„å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ï¼›</p>\n<p>2ï¼‰transientåªä½œç”¨äºå®ç° Serializable æ¥å£ï¼›</p>\n<p>3ï¼‰transientåªèƒ½ç”¨æ¥ä¿®é¥°æ™®é€šæˆå‘˜å˜é‡å­—æ®µï¼›</p>\n<p>4ï¼‰ä¸ç®¡æœ‰æ²¡æœ‰ transient ä¿®é¥°ï¼Œé™æ€å˜é‡éƒ½ä¸èƒ½è¢«åºåˆ—åŒ–ï¼›</p>\n","excerpt":"","more":"<h2 id=\"å…ˆè§£é‡Šä¸‹ä»€ä¹ˆæ˜¯åºåˆ—åŒ–\"><a href=\"#å…ˆè§£é‡Šä¸‹ä»€ä¹ˆæ˜¯åºåˆ—åŒ–\" class=\"headerlink\" title=\"å…ˆè§£é‡Šä¸‹ä»€ä¹ˆæ˜¯åºåˆ—åŒ–\"></a>å…ˆè§£é‡Šä¸‹ä»€ä¹ˆæ˜¯åºåˆ—åŒ–</h2><p>æˆ‘ä»¬çš„å¯¹è±¡å¹¶ä¸åªæ˜¯å­˜åœ¨å†…å­˜ä¸­ï¼Œè¿˜éœ€è¦ä¼ è¾“ç½‘ç»œï¼Œæˆ–è€…ä¿å­˜èµ·æ¥ä¸‹æ¬¡å†åŠ è½½å‡ºæ¥ç”¨ï¼Œæ‰€ä»¥éœ€è¦Javaåºåˆ—åŒ–æŠ€æœ¯ã€‚</p>\n<p>Javaåºåˆ—åŒ–æŠ€æœ¯æ­£æ˜¯å°†å¯¹è±¡è½¬å˜æˆä¸€ä¸²ç”±äºŒè¿›åˆ¶å­—èŠ‚ç»„æˆçš„æ•°ç»„ï¼Œå¯ä»¥é€šè¿‡å°†äºŒè¿›åˆ¶æ•°æ®ä¿å­˜åˆ°ç£ç›˜æˆ–è€…ä¼ è¾“ç½‘ç»œï¼Œç£ç›˜æˆ–è€…ç½‘ç»œæ¥æ”¶è€…å¯ä»¥åœ¨å¯¹è±¡çš„å±ç±»çš„æ¨¡æ¿ä¸Šæ¥ååºåˆ—åŒ–ç±»çš„å¯¹è±¡ï¼Œè¾¾åˆ°å¯¹è±¡æŒä¹…åŒ–çš„ç›®çš„ã€‚</p>\n<p>æ›´å¤šåºåˆ—åŒ–è¯·å‚è€ƒï¼šã€Š<a href=\"https://mp.weixin.qq.com/s/wHmK1kKyne6gCkIxt0NERQ\">å…³äºJavaåºåˆ—åŒ–ä½ åº”è¯¥çŸ¥é“çš„ä¸€åˆ‡</a>ã€‹è¿™ç¯‡æ–‡ç« ã€‚</p>\n<h2 id=\"ä»€ä¹ˆæ˜¯-transientï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯-transientï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯ transientï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯ transientï¼Ÿ</h2><p>ç®€å•æ¥è¯´å°±æ˜¯ï¼Œè¢« transient ä¿®é¥°çš„å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ã€‚</p>\n<p><strong>å…·ä½“æ¥çœ‹ä¸‹é¢çš„ç¤ºä¾‹1</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">import java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutputStream;\nimport java.io.Serializable;\n\n&#x2F;**\n * @author \n *&#x2F;\npublic class TransientTest &#123;\n\n\tpublic static void main(String[] args) throws Exception &#123;\n\n\t\tUser user &#x3D; new User();\n\t\tuser.setUsername(&quot;JavaæŠ€æœ¯&quot;);\n\t\tuser.setId(&quot;javastack&quot;);\n\n\t\tSystem.out.println(&quot;\\nåºåˆ—åŒ–ä¹‹å‰&quot;);\n\t\tSystem.out.println(&quot;username: &quot; + user.getUsername());\n\t\tSystem.out.println(&quot;id: &quot; + user.getId());\n\n\t\tObjectOutputStream os &#x3D; new ObjectOutputStream(new FileOutputStream(&quot;d:&#x2F;user.txt&quot;));\n\t\tos.writeObject(user);\n\t\tos.flush();\n\t\tos.close();\n\n\t\tObjectInputStream is &#x3D; new ObjectInputStream(new FileInputStream(&quot;d:&#x2F;user.txt&quot;));\n\t\tuser &#x3D; (User) is.readObject();\n\t\tis.close();\n\n\t\tSystem.out.println(&quot;\\nåºåˆ—åŒ–ä¹‹å&quot;);\n\t\tSystem.out.println(&quot;username: &quot; + user.getUsername());\n\t\tSystem.out.println(&quot;id: &quot; + user.getId());\n\n\t&#125;\n&#125;\n\n&#x2F;**\n * @author \n *&#x2F;\nclass User implements Serializable &#123;\n\n\tprivate static final long serialVersionUID &#x3D; 1L;\n\n\tprivate String username;\n\tprivate transient String id;\n\n\tpublic String getUsername() &#123;\n\t\treturn username;\n\t&#125;\n\n\tpublic void setUsername(String username) &#123;\n\t\tthis.username &#x3D; username;\n\t&#125;\n\n\tpublic String getId() &#123;\n\t\treturn id;\n\t&#125;\n\n\tpublic void setId(String id) &#123;\n\t\tthis.id &#x3D; id;\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>è¾“å‡ºç»“æœï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">åºåˆ—åŒ–ä¹‹å‰\nusername: JavaæŠ€æœ¯\nid: javastack\n\nåºåˆ—åŒ–ä¹‹å\nusername: JavaæŠ€æœ¯\nid: null<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¤ºä¾‹1åœ¨ id å­—æ®µä¸ŠåŠ äº† transient å…³é”®å­—ä¿®é¥°ï¼Œååºåˆ—åŒ–å‡ºæ¥ä¹‹åå€¼ä¸º nullï¼Œè¯´æ˜äº†è¢« transient ä¿®é¥°çš„å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ã€‚</p>\n<h2 id=\"é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\"><a href=\"#é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\" class=\"headerlink\" title=\"é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\"></a>é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ</h2><p>è¿™ä¸ªè¯é¢˜ä¹Ÿæ˜¯æœ€è¿‘æ ˆé•¿çš„JavaæŠ€æœ¯vipç¾¤é‡Œé¢è®¨è®ºçš„ï¼Œå¤§å®¶å¯¹è¿™ä¸ªçŸ¥è¯†ç‚¹æ¯”è¾ƒæ¨¡ç³Šï¼Œæˆ‘å°±å†™äº†è¿™ç¯‡æ–‡ç« æµ‹è¯•æ€»ç»“ä¸€ä¸‹ã€‚</p>\n<p><img src=\"http://img.javastack.cn/%E5%BE%AE%E4%BF%A1%E5%9B%BE%E7%89%87_20190214162351.png\"></p>\n<blockquote>\n<p>å¦‚æœä½ ä¹Ÿæƒ³åŠ å…¥æˆ‘ä»¬çš„JavaæŠ€æœ¯vipç¾¤å’Œå„ä½å¤§ç‰›ä¸€èµ·è®¨è®ºæŠ€æœ¯ï¼Œé‚£ç‚¹å‡»<a href=\"https://mp.weixin.qq.com/s/iqCLAduVzDqt19L6D4FCUQ\">è¿™ä¸ªé“¾æ¥</a>äº†è§£åŠ å…¥å§ã€‚</p>\n</blockquote>\n<p>é‚£ä¹ˆï¼Œåˆ°åº•é™æ€å˜é‡èƒ½è¢«åºåˆ—åŒ–å—ï¼ŸåºŸè¯å°‘è¯´ï¼Œå…ˆåŠ¨æ‰‹æµ‹è¯•ä¸‹å§ï¼</p>\n<p>ç¤ºä¾‹2ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">import java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutputStream;\nimport java.io.Serializable;\n\n&#x2F;**\n * @author \n *&#x2F;\npublic class TransientStaticTest &#123;\n\n\tpublic static void main(String[] args) throws Exception &#123;\n\n\t\tUser2 user &#x3D; new User2();\n\t\tUser2.username &#x3D; &quot;JavaæŠ€æœ¯1&quot;;\n\t\tuser.setId(&quot;javastack&quot;);\n\n\t\tSystem.out.println(&quot;\\nåºåˆ—åŒ–ä¹‹å‰&quot;);\n\t\tSystem.out.println(&quot;username: &quot; + user.getUsername());\n\t\tSystem.out.println(&quot;id: &quot; + user.getId());\n\n\t\tObjectOutputStream os &#x3D; new ObjectOutputStream(new FileOutputStream(&quot;d:&#x2F;user.txt&quot;));\n\t\tos.writeObject(user);\n\t\tos.flush();\n\t\tos.close();\n\t\t\n\t\t&#x2F;&#x2F; åœ¨ååºåˆ—åŒ–å‡ºæ¥ä¹‹å‰ï¼Œæ”¹å˜é™æ€å˜é‡çš„å€¼\n\t\tUser2.username &#x3D; &quot;JavaæŠ€æœ¯2&quot;;\n\n\t\tObjectInputStream is &#x3D; new ObjectInputStream(new FileInputStream(&quot;d:&#x2F;user.txt&quot;));\n\t\tuser &#x3D; (User2) is.readObject();\n\t\tis.close();\n\n\t\tSystem.out.println(&quot;\\nåºåˆ—åŒ–ä¹‹å&quot;);\n\t\tSystem.out.println(&quot;username: &quot; + user.getUsername());\n\t\tSystem.out.println(&quot;id: &quot; + user.getId());\n\n\t&#125;\n&#125;\n\n&#x2F;**\n * @author \n *&#x2F;\nclass User2 implements Serializable &#123;\n\n\tprivate static final long serialVersionUID &#x3D; 1L;\n\n\tpublic static String username;\n\tprivate transient String id;\n\n\tpublic String getUsername() &#123;\n\t\treturn username;\n\t&#125;\n\n\tpublic String getId() &#123;\n\t\treturn id;\n\t&#125;\n\n\tpublic void setId(String id) &#123;\n\t\tthis.id &#x3D; id;\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>è¾“å‡ºç»“æœï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">åºåˆ—åŒ–ä¹‹å‰\nusername: JavaæŠ€æœ¯1\nid: javastack\n\nåºåˆ—åŒ–ä¹‹å\nusername: JavaæŠ€æœ¯2\nid: null<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¤ºä¾‹2æŠŠ username æ”¹ä¸ºäº† public static, å¹¶åœ¨ååºåˆ—åŒ–å‡ºæ¥ä¹‹å‰æ”¹å˜äº†é™æ€å˜é‡çš„å€¼ï¼Œç»“æœå¯ä»¥çœ‹å‡ºåºåˆ—åŒ–ä¹‹åçš„å€¼å¹¶éåºåˆ—åŒ–è¿›å»æ—¶çš„å€¼ã€‚</p>\n<p>ç”±ä»¥ä¸Šç»“æœåˆ†æå¯çŸ¥ï¼Œé™æ€å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ï¼Œç¤ºä¾‹2è¯»å–å‡ºæ¥çš„æ˜¯ username åœ¨ JVM å†…å­˜ä¸­å­˜å‚¨çš„å€¼ã€‚</p>\n<h2 id=\"transient-çœŸä¸èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\"><a href=\"#transient-çœŸä¸èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\" class=\"headerlink\" title=\"transient çœŸä¸èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ\"></a>transient çœŸä¸èƒ½è¢«åºåˆ—åŒ–å—ï¼Ÿ</h2><p>ç»§ç»­æ¥çœ‹ç¤ºä¾‹3ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">import java.io.Externalizable;\nimport java.io.File;\nimport java.io.FileInputStream;\nimport java.io.FileOutputStream;\nimport java.io.IOException;\nimport java.io.ObjectInput;\nimport java.io.ObjectInputStream;\nimport java.io.ObjectOutput;\nimport java.io.ObjectOutputStream;\n\n&#x2F;**\n * @author \n *&#x2F;\npublic class ExternalizableTest &#123;\n\n\tpublic static void main(String[] args) throws Exception &#123;\n\n\t\tUser3 user &#x3D; new User3();\n\t\tuser.setUsername(&quot;JavaæŠ€æœ¯&quot;);\n\t\tuser.setId(&quot;javastack&quot;);\n\t\tObjectOutput objectOutput &#x3D; new ObjectOutputStream(new FileOutputStream(new File(&quot;javastack&quot;)));\n\t\tobjectOutput.writeObject(user);\n\n\t\tObjectInput objectInput &#x3D; new ObjectInputStream(new FileInputStream(new File(&quot;javastack&quot;)));\n\t\tuser &#x3D; (User3) objectInput.readObject();\n\n\t\tSystem.out.println(user.getUsername());\n\t\tSystem.out.println(user.getId());\n\n\t\tobjectOutput.close();\n\t\tobjectInput.close();\n\t&#125;\n\n&#125;\n\n&#x2F;**\n * @author \n *&#x2F;\nclass User3 implements Externalizable &#123;\n\n\tprivate static final long serialVersionUID &#x3D; 1L;\n\n\tpublic User3() &#123;\n\n\t&#125;\n\n\tprivate String username;\n\tprivate transient String id;\n\n\tpublic String getUsername() &#123;\n\t\treturn username;\n\t&#125;\n\n\tpublic void setUsername(String username) &#123;\n\t\tthis.username &#x3D; username;\n\t&#125;\n\n\tpublic String getId() &#123;\n\t\treturn id;\n\t&#125;\n\n\tpublic void setId(String id) &#123;\n\t\tthis.id &#x3D; id;\n\t&#125;\n\n\t@Override\n\tpublic void writeExternal(ObjectOutput objectOutput) throws IOException &#123;\n\t\tobjectOutput.writeObject(id);\n\t&#125;\n\n\t@Override\n\tpublic void readExternal(ObjectInput objectInput) throws IOException, ClassNotFoundException &#123;\n\t\tid &#x3D; (String) objectInput.readObject();\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>è¾“å‡ºç»“æœï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">null\njavastack<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>ç¤ºä¾‹3çš„ id è¢« transient ä¿®æ”¹äº†ï¼Œä¸ºä»€ä¹ˆè¿˜èƒ½åºåˆ—åŒ–å‡ºæ¥ï¼Ÿé‚£æ˜¯å› ä¸º User3 å®ç°äº†æ¥å£ Externalizableï¼Œè€Œä¸æ˜¯ Serializableã€‚</p>\n<p>åœ¨ Java ä¸­æœ‰ä¸¤ç§å®ç°åºåˆ—åŒ–çš„æ–¹å¼ï¼ŒSerializable å’Œ Externalizableï¼Œå¯èƒ½å¤§éƒ¨åˆ†äººåªçŸ¥é“ Serializable è€Œä¸çŸ¥é“ Externalizableã€‚</p>\n<p>è¿™ä¸¤ç§åºåˆ—åŒ–æ–¹å¼çš„åŒºåˆ«æ˜¯ï¼šå®ç°äº† Serializable æ¥å£æ˜¯è‡ªåŠ¨åºåˆ—åŒ–çš„ï¼Œå®ç° Externalizable åˆ™éœ€è¦æ‰‹åŠ¨åºåˆ—åŒ–ï¼Œé€šè¿‡ writeExternal å’Œ readExternal æ–¹æ³•æ‰‹åŠ¨è¿›è¡Œï¼Œè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸Šé¢çš„ username ä¸º null çš„åŸå› äº†ã€‚</p>\n<h2 id=\"transient-å…³é”®å­—æ€»ç»“\"><a href=\"#transient-å…³é”®å­—æ€»ç»“\" class=\"headerlink\" title=\"transient å…³é”®å­—æ€»ç»“\"></a>transient å…³é”®å­—æ€»ç»“</h2><p>1ï¼‰transientä¿®é¥°çš„å˜é‡ä¸èƒ½è¢«åºåˆ—åŒ–ï¼›</p>\n<p>2ï¼‰transientåªä½œç”¨äºå®ç° Serializable æ¥å£ï¼›</p>\n<p>3ï¼‰transientåªèƒ½ç”¨æ¥ä¿®é¥°æ™®é€šæˆå‘˜å˜é‡å­—æ®µï¼›</p>\n<p>4ï¼‰ä¸ç®¡æœ‰æ²¡æœ‰ transient ä¿®é¥°ï¼Œé™æ€å˜é‡éƒ½ä¸èƒ½è¢«åºåˆ—åŒ–ï¼›</p>\n"},{"title":"å…³äº Java åºåˆ—åŒ–ä½ ä¸çŸ¥é“çš„ 5 ä»¶äº‹","date":"2025-10-14T06:42:34.000Z","_content":"\n### å…³äºæœ¬ç³»åˆ—\n\nå¤§çº¦ä¸€å¹´å‰ï¼Œä¸€ä¸ªè´Ÿè´£ç®¡ç†åº”ç”¨ç¨‹åºæ‰€æœ‰ç”¨æˆ·è®¾ç½®çš„å¼€å‘äººå‘˜ï¼Œå†³å®šå°†ç”¨æˆ·è®¾ç½®å­˜å‚¨åœ¨ä¸€ä¸ª Hashtableä¸­ï¼Œç„¶åå°†è¿™ä¸ª Hashtable åºåˆ—åŒ–åˆ°ç£ç›˜ï¼Œä»¥ä¾¿æŒä¹…åŒ–ã€‚å½“ç”¨æˆ·æ›´æ”¹è®¾ç½®æ—¶ï¼Œä¾¿é‡æ–°å°† Hashtable å†™åˆ°ç£ç›˜ã€‚\n\nè¿™æ˜¯ä¸€ä¸ªä¼˜é›…çš„ã€å¼€æ”¾å¼çš„è®¾ç½®ç³»ç»Ÿï¼Œä½†æ˜¯ï¼Œå½“å›¢é˜Ÿå†³å®šä» Hashtable è¿ç§»åˆ° Java Collections åº“ä¸­çš„HashMap æ—¶ï¼Œè¿™ä¸ªç³»ç»Ÿä¾¿é¢ä¸´å´©æºƒã€‚\n\nHashtable å’Œ HashMap åœ¨ç£ç›˜ä¸Šçš„æ ¼å¼æ˜¯ä¸ç›¸åŒã€ä¸å…¼å®¹çš„ã€‚é™¤éå¯¹æ¯ä¸ªæŒä¹…åŒ–çš„ç”¨æˆ·è®¾ç½®è¿è¡ŒæŸç§ç±»å‹çš„æ•°æ®è½¬æ¢å®ç”¨ç¨‹åºï¼ˆæå…¶åºå¤§çš„ä»»åŠ¡ï¼‰ï¼Œå¦åˆ™ä»¥åä¼¼ä¹åªèƒ½ä¸€ç›´ç”¨Hashtable ä½œä¸ºåº”ç”¨ç¨‹åºçš„å­˜å‚¨æ ¼å¼ã€‚\n\nå›¢é˜Ÿæ„Ÿåˆ°é™·å…¥åƒµå±€ï¼Œä½†è¿™åªæ˜¯å› ä¸ºä»–ä»¬ä¸çŸ¥é“å…³äº Java åºåˆ—åŒ–çš„ä¸€ä¸ªé‡è¦äº‹å®ï¼šJava åºåˆ—åŒ–å…è®¸éšç€æ—¶é—´çš„æ¨ç§»è€Œæ”¹å˜ç±»å‹ã€‚å½“æˆ‘å‘ä»–ä»¬å±•ç¤ºå¦‚ä½•è‡ªåŠ¨è¿›è¡Œåºåˆ—åŒ–æ›¿æ¢åï¼Œä»–ä»¬ç»ˆäºæŒ‰è®¡åˆ’å®Œæˆäº†å‘ HashMap çš„è½¬å˜ã€‚\n\næœ¬æ–‡æ˜¯æœ¬ç³»åˆ—çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œè¿™ä¸ªç³»åˆ—ä¸“é—¨æ­ç¤ºå…³äº Java å¹³å°çš„ä¸€äº›æœ‰ç”¨çš„å°çŸ¥è¯† â€” è¿™äº›å°çŸ¥è¯†ä¸æ˜“ç†è§£ï¼Œä½†å¯¹äºè§£å†³ Java ç¼–ç¨‹æŒ‘æˆ˜è¿Ÿæ—©æœ‰ç”¨ã€‚\n\nå°† Java å¯¹è±¡åºåˆ—åŒ– API ä½œä¸ºå¼€ç«¯æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒä»ä¸€å¼€å§‹å°±å­˜åœ¨äº JDK 1.1 ä¸­ã€‚æœ¬æ–‡ä»‹ç»çš„å…³äºåºåˆ—åŒ–çš„ 5 ä»¶äº‹æƒ…å°†è¯´æœæ‚¨é‡æ–°å®¡è§†é‚£äº›æ ‡å‡† Java APIã€‚\n\n### Java åºåˆ—åŒ–ç®€ä»‹\n\nJava å¯¹è±¡åºåˆ—åŒ–æ˜¯ JDK 1.1 ä¸­å¼•å…¥çš„ä¸€ç»„å¼€åˆ›æ€§ç‰¹æ€§ä¹‹ä¸€ï¼Œç”¨äºä½œä¸ºä¸€ç§å°† Java å¯¹è±¡çš„çŠ¶æ€è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„ï¼Œä»¥ä¾¿å­˜å‚¨æˆ–ä¼ è¾“çš„æœºåˆ¶ï¼Œä»¥åï¼Œä»å¯ä»¥å°†å­—èŠ‚æ•°ç»„è½¬æ¢å› Java å¯¹è±¡åŸæœ‰çš„çŠ¶æ€ã€‚\n\nå®é™…ä¸Šï¼Œåºåˆ—åŒ–çš„æ€æƒ³æ˜¯ â€œå†»ç»“â€ å¯¹è±¡çŠ¶æ€ï¼Œä¼ è¾“å¯¹è±¡çŠ¶æ€ï¼ˆå†™åˆ°ç£ç›˜ã€é€šè¿‡ç½‘ç»œä¼ è¾“ç­‰ç­‰ï¼‰ï¼Œç„¶å â€œè§£å†»â€ çŠ¶æ€ï¼Œé‡æ–°è·å¾—å¯ç”¨çš„ Java å¯¹è±¡ã€‚æ‰€æœ‰è¿™äº›äº‹æƒ…çš„å‘ç”Ÿæœ‰ç‚¹åƒæ˜¯é­”æœ¯ï¼Œè¿™è¦å½’åŠŸäº ObjectInputStream/ObjectOutputStream ç±»ã€å®Œå…¨ä¿çœŸçš„å…ƒæ•°æ®ä»¥åŠç¨‹åºå‘˜æ„¿æ„ç”¨Serializable æ ‡è¯†æ¥å£æ ‡è®°ä»–ä»¬çš„ç±»ï¼Œä»è€Œ â€œå‚ä¸â€ è¿™ä¸ªè¿‡ç¨‹ã€‚\n\næ¸…å• 1 æ˜¾ç¤ºä¸€ä¸ªå®ç° Serializable çš„ Person ç±»ã€‚\n\n**æ¸…å• 1. Serializable Person**\n\n\n```\npackage com.tedneward;\n\npublic class Person\n    implements java.io.Serializable\n{\n    public Person(String fn, String ln, int a)\n    {\n        this.firstName = fn; this.lastName = ln; this.age = a;\n    }\n\n    public String getFirstName() { return firstName; }\n    public String getLastName() { return lastName; }\n    public int getAge() { return age; }\n    public Person getSpouse() { return spouse; }\n\n    public void setFirstName(String value) { firstName = value; }\n    public void setLastName(String value) { lastName = value; }\n    public void setAge(int value) { age = value; }\n    public void setSpouse(Person value) { spouse = value; }\n\n    public String toString()\n    {\n        return \"[Person: firstName=\" + firstName + \n            \" lastName=\" + lastName +\n            \" age=\" + age +\n            \" spouse=\" + spouse.getFirstName() +\n            \"]\";\n    }    \n\n    private String firstName;\n    private String lastName;\n    private int age;\n    private Person spouse;\n\n}\n```\n\nå°† Person åºåˆ—åŒ–åï¼Œå¾ˆå®¹æ˜“å°†å¯¹è±¡çŠ¶æ€å†™åˆ°ç£ç›˜ï¼Œç„¶åé‡æ–°è¯»å‡ºå®ƒï¼Œä¸‹é¢çš„ JUnit 4 å•å…ƒæµ‹è¯•å¯¹æ­¤åšäº†æ¼”ç¤ºã€‚\n\n**æ¸…å• 2. å¯¹ Person è¿›è¡Œååºåˆ—åŒ–**\n\n\n```\npublic class SerTest\n{\n    @Test public void serializeToDisk()\n    {\n        try\n        {\n            com.tedneward.Person ted = new com.tedneward.Person(\"Ted\", \"Neward\", 39);\n            com.tedneward.Person charl = new com.tedneward.Person(\"Charlotte\",\n                \"Neward\", 38);\n\n            ted.setSpouse(charl); charl.setSpouse(ted);\n\n            FileOutputStream fos = new FileOutputStream(\"tempdata.ser\");\n            ObjectOutputStream oos = new ObjectOutputStream(fos);\n            oos.writeObject(ted);\n            oos.close();\n        }\n        catch (Exception ex)\n        {\n            fail(\"Exception thrown during test: \" + ex.toString());\n        }\n\n        try\n        {\n            FileInputStream fis = new FileInputStream(\"tempdata.ser\");\n            ObjectInputStream ois = new ObjectInputStream(fis);\n            com.tedneward.Person ted = (com.tedneward.Person) ois.readObject();\n            ois.close();\n\n            assertEquals(ted.getFirstName(ï¼‰ï¼Œ \"Ted\");\n            assertEquals(ted.getSpouse().getFirstName(ï¼‰ï¼Œ \"Charlotte\");\n\n            // Clean up the file\n            new File(\"tempdata.ser\").delete();\n        }\n        catch (Exception ex)\n        {\n            fail(\"Exception thrown during test: \" + ex.toString());\n        }\n    }\n}\n```\n\nåˆ°ç°åœ¨ä¸ºæ­¢ï¼Œè¿˜æ²¡æœ‰çœ‹åˆ°ä»€ä¹ˆæ–°é²œçš„æˆ–ä»¤äººå…´å¥‹çš„äº‹æƒ…ï¼Œä½†æ˜¯è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å‡ºå‘ç‚¹ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ Person æ¥å‘ç°æ‚¨å¯èƒ½ä¸ çŸ¥é“çš„å…³äº Java å¯¹è±¡åºåˆ—åŒ– çš„ 5 ä»¶äº‹ã€‚\n\n#### 1. åºåˆ—åŒ–å…è®¸é‡æ„\n\nåºåˆ—åŒ–å…è®¸ä¸€å®šæ•°é‡çš„ç±»å˜ç§ï¼Œç”šè‡³é‡æ„ä¹‹åä¹Ÿæ˜¯å¦‚æ­¤ï¼ŒObjectInputStream ä»å¯ä»¥å¾ˆå¥½åœ°å°†å…¶è¯»å‡ºæ¥ã€‚\nJava Object Serialization è§„èŒƒå¯ä»¥è‡ªåŠ¨ç®¡ç†çš„å…³é”®ä»»åŠ¡æ˜¯ï¼š\n\n- å°†æ–°å­—æ®µæ·»åŠ åˆ°ç±»ä¸­\n\n- å°†å­—æ®µä» static æ”¹ä¸ºé static\n\n- å°†å­—æ®µä» transient æ”¹ä¸ºé transient\n\nå–å†³äºæ‰€éœ€çš„å‘åå…¼å®¹ç¨‹åº¦ï¼Œè½¬æ¢å­—æ®µå½¢å¼ï¼ˆä»é static è½¬æ¢ä¸º static æˆ–ä»é transient è½¬æ¢ä¸º transientï¼‰æˆ–è€…åˆ é™¤å­—æ®µéœ€è¦é¢å¤–çš„æ¶ˆæ¯ä¼ é€’ã€‚\n\n**é‡æ„åºåˆ—åŒ–ç±»**\n\næ—¢ç„¶å·²ç»çŸ¥é“åºåˆ—åŒ–å…è®¸é‡æ„ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å½“æŠŠæ–°å­—æ®µæ·»åŠ åˆ° Person ç±»ä¸­æ—¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆäº‹æƒ…ã€‚\n\nå¦‚æ¸…å• 3 æ‰€ç¤ºï¼ŒPersonV2 åœ¨åŸå…ˆ Person ç±»çš„åŸºç¡€ä¸Šå¼•å…¥ä¸€ä¸ªè¡¨ç¤ºæ€§åˆ«çš„æ–°å­—æ®µã€‚\n\n**æ¸…å• 3. å°†æ–°å­—æ®µæ·»åŠ åˆ°åºåˆ—åŒ–çš„ Person ä¸­**\n\n\n```\nenum Gender\n{\n    MALE, FEMALE\n}\n\npublic class Person\n    implements java.io.Serializable\n{\n    public Person(String fn, String ln, int a, Gender g)\n    {\n        this.firstName = fn; this.lastName = ln; this.age = a; this.gender = g;\n    }\n\n    public String getFirstName() { return firstName; }\n    public String getLastName() { return lastName; }\n    public Gender getGender() { return gender; }\n    public int getAge() { return age; }\n    public Person getSpouse() { return spouse; }\n\n    public void setFirstName(String value) { firstName = value; }\n    public void setLastName(String value) { lastName = value; }\n    public void setGender(Gender value) { gender = value; }\n    public void setAge(int value) { age = value; }\n    public void setSpouse(Person value) { spouse = value; }\n\n    public String toString()\n    {\n        return \"[Person: firstName=\" + firstName + \n            \" lastName=\" + lastName +\n            \" gender=\" + gender +\n            \" age=\" + age +\n            \" spouse=\" + spouse.getFirstName() +\n            \"]\";\n    }    \n\n    private String firstName;\n    private String lastName;\n    private int age;\n    private Person spouse;\n    private Gender gender;\n}\n```\n\nåºåˆ—åŒ–ä½¿ç”¨ä¸€ä¸ª hashï¼Œè¯¥ hash æ˜¯æ ¹æ®ç»™å®šæºæ–‡ä»¶ä¸­å‡ ä¹æ‰€æœ‰ä¸œè¥¿ â€” æ–¹æ³•åç§°ã€å­—æ®µåç§°ã€å­—æ®µç±»å‹ã€è®¿é—®ä¿®æ”¹æ–¹æ³•ç­‰ â€” è®¡ç®—å‡ºæ¥çš„ï¼Œåºåˆ—åŒ–å°†è¯¥ hash å€¼ä¸åºåˆ—åŒ–æµä¸­çš„ hash å€¼ç›¸æ¯”è¾ƒã€‚\n\nä¸ºäº†ä½¿ Java è¿è¡Œæ—¶ç›¸ä¿¡ä¸¤ç§ç±»å‹å®é™…ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œç¬¬äºŒç‰ˆå’Œéšåç‰ˆæœ¬çš„ Person å¿…é¡»ä¸ç¬¬ä¸€ç‰ˆæœ‰ç›¸åŒçš„åºåˆ—åŒ–ç‰ˆæœ¬ hashï¼ˆå­˜å‚¨ä¸º private static final serialVersionUID å­—æ®µï¼‰ã€‚\n\nå› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ serialVersionUID å­—æ®µï¼Œå®ƒæ˜¯é€šè¿‡å¯¹åŸå§‹ï¼ˆæˆ– V1ï¼‰ç‰ˆæœ¬çš„ Person ç±»è¿è¡Œ JDK serialverå‘½ä»¤è®¡ç®—å‡ºçš„ã€‚\n\nä¸€æ—¦æœ‰äº† Person çš„ serialVersionUIDï¼Œä¸ä»…å¯ä»¥ä»åŸå§‹å¯¹è±¡ Person çš„åºåˆ—åŒ–æ•°æ®åˆ›å»º PersonV2 å¯¹è±¡ï¼ˆå½“å‡ºç°æ–°å­—æ®µæ—¶ï¼Œæ–°å­—æ®µè¢«è®¾ä¸ºç¼ºçœå€¼ï¼Œæœ€å¸¸è§çš„æ˜¯â€œnullâ€ï¼‰ï¼Œè¿˜å¯ä»¥åè¿‡æ¥åšï¼šå³ä» PersonV2 çš„æ•°æ®é€šè¿‡ååºåˆ—åŒ–å¾—åˆ° Personï¼Œè¿™æ¯«ä¸å¥‡æ€ªã€‚\n\n#### 2. åºåˆ—åŒ–å¹¶ä¸å®‰å…¨\n\nè®© Java å¼€å‘äººå‘˜è¯§å¼‚å¹¶æ„Ÿåˆ°ä¸å¿«çš„æ˜¯ï¼Œåºåˆ—åŒ–äºŒè¿›åˆ¶æ ¼å¼å®Œå…¨ç¼–å†™åœ¨æ–‡æ¡£ä¸­ï¼Œå¹¶ä¸”å®Œå…¨å¯é€†ã€‚å®é™…ä¸Šï¼Œåªéœ€å°†äºŒè¿›åˆ¶åºåˆ—åŒ–æµçš„å†…å®¹è½¬å‚¨åˆ°æ§åˆ¶å°ï¼Œå°±è¶³ä»¥çœ‹æ¸…ç±»æ˜¯ä»€ä¹ˆæ ·å­ï¼Œä»¥åŠå®ƒåŒ…å«ä»€ä¹ˆå†…å®¹ã€‚\n\nè¿™å¯¹äºå®‰å…¨æ€§æœ‰ç€ä¸è‰¯å½±å“ã€‚ä¾‹å¦‚ï¼Œå½“é€šè¿‡ RMI è¿›è¡Œè¿œç¨‹æ–¹æ³•è°ƒç”¨æ—¶ï¼Œé€šè¿‡è¿æ¥å‘é€çš„å¯¹è±¡ä¸­çš„ä»»ä½• private å­—æ®µå‡ ä¹éƒ½æ˜¯ä»¥æ˜æ–‡çš„æ–¹å¼å‡ºç°åœ¨å¥—æ¥å­—æµä¸­ï¼Œè¿™æ˜¾ç„¶å®¹æ˜“æ‹›è‡´å“ªæ€•æœ€ç®€å•çš„å®‰å…¨é—®é¢˜ã€‚\n\nå¹¸è¿çš„æ˜¯ï¼Œåºåˆ—åŒ–å…è®¸ â€œhookâ€ åºåˆ—åŒ–è¿‡ç¨‹ï¼Œå¹¶åœ¨åºåˆ—åŒ–ä¹‹å‰å’Œååºåˆ—åŒ–ä¹‹åä¿æŠ¤ï¼ˆæˆ–æ¨¡ç³ŠåŒ–ï¼‰å­—æ®µæ•°æ®ã€‚å¯ä»¥é€šè¿‡åœ¨ Serializable å¯¹è±¡ä¸Šæä¾›ä¸€ä¸ª writeObject æ–¹æ³•æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚\n\n**æ¨¡ç³ŠåŒ–åºåˆ—åŒ–æ•°æ®**\n\nå‡è®¾ Person ç±»ä¸­çš„æ•æ„Ÿæ•°æ®æ˜¯ age å­—æ®µã€‚æ¯•ç«Ÿï¼Œå¥³å£«å¿Œè°ˆå¹´é¾„ã€‚ æˆ‘ä»¬å¯ä»¥åœ¨åºåˆ—åŒ–ä¹‹å‰æ¨¡ç³ŠåŒ–è¯¥æ•°æ®ï¼Œå°†æ•°ä½å¾ªç¯å·¦ç§»ä¸€ä½ï¼Œç„¶ååœ¨ååºåˆ—åŒ–ä¹‹åå¤ä½ã€‚ï¼ˆæ‚¨å¯ä»¥å¼€å‘æ›´å®‰å…¨çš„ç®—æ³•ï¼Œå½“å‰è¿™ä¸ªç®—æ³•åªæ˜¯ä½œä¸ºä¸€ä¸ªä¾‹å­ã€‚ï¼‰\n\nä¸ºäº† â€œhookâ€ åºåˆ—åŒ–è¿‡ç¨‹ï¼Œæˆ‘ä»¬å°†åœ¨ Person ä¸Šå®ç°ä¸€ä¸ª writeObject æ–¹æ³•ï¼›ä¸ºäº† â€œhookâ€ ååºåˆ—åŒ–è¿‡ç¨‹ï¼Œæˆ‘ä»¬å°†åœ¨åŒä¸€ä¸ªç±»ä¸Šå®ç°ä¸€ä¸ªreadObject æ–¹æ³•ã€‚é‡è¦çš„æ˜¯è¿™ä¸¤ä¸ªæ–¹æ³•çš„ç»†èŠ‚è¦æ­£ç¡® â€” å¦‚æœè®¿é—®ä¿®æ”¹æ–¹æ³•ã€å‚æ•°æˆ–åç§°ä¸åŒäºæ¸…å• 4 ä¸­çš„å†…å®¹ï¼Œé‚£ä¹ˆä»£ç å°†ä¸è¢«å¯Ÿè§‰åœ°å¤±è´¥ï¼ŒPerson çš„ age å°†æš´éœ²ã€‚\n\n**æ¸…å• 4. æ¨¡ç³ŠåŒ–åºåˆ—åŒ–æ•°æ®**\n\n\n```\npublic class Person\n    implements java.io.Serializable\n{\n    public Person(String fn, String ln, int a)\n    {\n        this.firstName = fn; this.lastName = ln; this.age = a;\n    }\n\n    public String getFirstName() { return firstName; }\n    public String getLastName() { return lastName; }\n    public int getAge() { return age; }\n    public Person getSpouse() { return spouse; }\n\n    public void setFirstName(String value) { firstName = value; }\n    public void setLastName(String value) { lastName = value; }\n    public void setAge(int value) { age = value; }\n    public void setSpouse(Person value) { spouse = value; }\n\n    private void writeObject(java.io.ObjectOutputStream stream)\n        throws java.io.IOException\n    {\n        // \"Encrypt\"/obscure the sensitive data\n        age = age << 2;\n        stream.defaultWriteObject();\n    }\n\n    private void readObject(java.io.ObjectInputStream stream)\n        throws java.io.IOException, ClassNotFoundException\n    {\n        stream.defaultReadObject();\n\n        // \"Decrypt\"/de-obscure the sensitive data\n        age = age << 2;\n    }\n\n    public String toString()\n    {\n        return \"[Person: firstName=\" + firstName + \n            \" lastName=\" + lastName +\n            \" age=\" + age +\n            \" spouse=\" + (spouse!=null ? spouse.getFirstName() : \"[null]\") +\n            \"]\";\n    }      \n\n    private String firstName;\n    private String lastName;\n    private int age;\n    private Person spouse;\n}\n```\n\nå¦‚æœéœ€è¦æŸ¥çœ‹è¢«æ¨¡ç³ŠåŒ–çš„æ•°æ®ï¼Œæ€»æ˜¯å¯ä»¥æŸ¥çœ‹åºåˆ—åŒ–æ•°æ®æµ/æ–‡ä»¶ã€‚è€Œä¸”ï¼Œç”±äºè¯¥æ ¼å¼è¢«å®Œå…¨æ–‡æ¡£åŒ–ï¼Œå³ä½¿ä¸èƒ½è®¿é—®ç±»æœ¬èº«ï¼Œä¹Ÿä»å¯ä»¥è¯»å–åºåˆ—åŒ–æµä¸­çš„å†…å®¹ã€‚\n\n#### 3. åºåˆ—åŒ–çš„æ•°æ®å¯ä»¥è¢«ç­¾åå’Œå¯†å°\n\nä¸Šä¸€ä¸ªæŠ€å·§å‡è®¾æ‚¨æƒ³æ¨¡ç³ŠåŒ–åºåˆ—åŒ–æ•°æ®ï¼Œè€Œä¸æ˜¯å¯¹å…¶åŠ å¯†æˆ–è€…ç¡®ä¿å®ƒä¸è¢«ä¿®æ”¹ã€‚å½“ç„¶ï¼Œé€šè¿‡ä½¿ç”¨ writeObject å’Œ readObject å¯ä»¥å®ç°å¯†ç åŠ å¯†å’Œç­¾åç®¡ç†ï¼Œä½†å…¶å®è¿˜æœ‰æ›´å¥½çš„æ–¹å¼ã€‚\n\nå¦‚æœéœ€è¦å¯¹æ•´ä¸ªå¯¹è±¡è¿›è¡ŒåŠ å¯†å’Œç­¾åï¼Œæœ€ç®€å•çš„æ˜¯å°†å®ƒæ”¾åœ¨ä¸€ä¸ª javax.crypto.SealedObject å’Œ/æˆ– java.security.SignedObject åŒ…è£…å™¨ä¸­ã€‚ä¸¤è€…éƒ½æ˜¯å¯åºåˆ—åŒ–çš„ï¼Œæ‰€ä»¥å°†å¯¹è±¡åŒ…è£…åœ¨ SealedObject ä¸­å¯ä»¥å›´ç»•åŸå¯¹è±¡åˆ›å»ºä¸€ç§â€œåŒ…è£…ç›’â€ã€‚å¿…é¡»æœ‰å¯¹ç§°å¯†é’¥æ‰èƒ½è§£å¯†ï¼Œè€Œä¸”å¯†é’¥å¿…é¡»å•ç‹¬ç®¡ç†ã€‚åŒæ ·ï¼Œä¹Ÿå¯ä»¥å°† SignedObject ç”¨äºæ•°æ®éªŒè¯ï¼Œå¹¶ä¸”å¯¹ç§°å¯†é’¥ä¹Ÿå¿…é¡»å•ç‹¬ç®¡ç†ã€‚\n\nç»“åˆä½¿ç”¨è¿™ä¸¤ç§å¯¹è±¡ï¼Œä¾¿å¯ä»¥è½»æ¾åœ°å¯¹åºåˆ—åŒ–æ•°æ®è¿›è¡Œå¯†å°å’Œç­¾åï¼Œè€Œä¸å¿…å¼ºè°ƒå…³äºæ•°å­—ç­¾åéªŒè¯æˆ–åŠ å¯†çš„ç»†èŠ‚ã€‚å¾ˆç®€æ´ï¼Œæ˜¯å§ï¼Ÿ\n\n#### 4. åºåˆ—åŒ–å…è®¸å°†ä»£ç†æ”¾åœ¨æµä¸­\n\nå¾ˆå¤šæƒ…å†µä¸‹ï¼Œç±»ä¸­åŒ…å«ä¸€ä¸ªæ ¸å¿ƒæ•°æ®å…ƒç´ ï¼Œé€šè¿‡å®ƒå¯ä»¥æ´¾ç”Ÿæˆ–æ‰¾åˆ°ç±»ä¸­çš„å…¶ä»–å­—æ®µã€‚åœ¨æ­¤æƒ…å†µä¸‹ï¼Œæ²¡æœ‰å¿…è¦åºåˆ—åŒ–æ•´ä¸ªå¯¹è±¡ã€‚å¯ä»¥å°†å­—æ®µæ ‡è®°ä¸º transientï¼Œä½†æ˜¯æ¯å½“æœ‰æ–¹æ³•è®¿é—®ä¸€ä¸ªå­—æ®µæ—¶ï¼Œç±»ä»ç„¶å¿…é¡»æ˜¾å¼åœ°äº§ç”Ÿä»£ç æ¥æ£€æŸ¥å®ƒæ˜¯å¦è¢«åˆå§‹åŒ–ã€‚\n\nå¦‚æœé¦–è¦é—®é¢˜æ˜¯åºåˆ—åŒ–ï¼Œé‚£ä¹ˆæœ€å¥½æŒ‡å®šä¸€ä¸ª flyweight æˆ–ä»£ç†æ”¾åœ¨æµä¸­ã€‚ä¸ºåŸå§‹ Person æä¾›ä¸€ä¸ª writeReplace æ–¹æ³•ï¼Œå¯ä»¥åºåˆ—åŒ–ä¸åŒç±»å‹çš„å¯¹è±¡æ¥ä»£æ›¿å®ƒã€‚ç±»ä¼¼åœ°ï¼Œå¦‚æœååºåˆ—åŒ–æœŸé—´å‘ç°ä¸€ä¸ª readResolve æ–¹æ³•ï¼Œé‚£ä¹ˆå°†è°ƒç”¨è¯¥æ–¹æ³•ï¼Œå°†æ›¿ä»£å¯¹è±¡æä¾›ç»™è°ƒç”¨è€…ã€‚\n\n**æ‰“åŒ…å’Œè§£åŒ…ä»£ç†**\n\nwriteReplace å’Œ readResolve æ–¹æ³•ä½¿ Person ç±»å¯ä»¥å°†å®ƒçš„æ‰€æœ‰æ•°æ®ï¼ˆæˆ–å…¶ä¸­çš„æ ¸å¿ƒæ•°æ®ï¼‰æ‰“åŒ…åˆ°ä¸€ä¸ª PersonProxy ä¸­ï¼Œå°†å®ƒæ”¾å…¥åˆ°ä¸€ä¸ªæµä¸­ï¼Œç„¶ååœ¨ååºåˆ—åŒ–æ—¶å†è¿›è¡Œè§£åŒ…ã€‚\n\n**æ¸…å• 5. ä½ å®Œæ•´äº†æˆ‘ï¼Œæˆ‘ä»£æ›¿äº†ä½ **\n\n\n```\nclass PersonProxy\n    implements java.io.Serializable\n{\n    public PersonProxy(Person orig)\n    {\n        data = orig.getFirstName() + \",\" + orig.getLastName() + \",\" + orig.getAge();\n        if (orig.getSpouse() != null)\n        {\n            Person spouse = orig.getSpouse();\n            data = data + \",\" + spouse.getFirstName() + \",\" + spouse.getLastName() + \",\"  \n              + spouse.getAge();\n        }\n    }\n\n    public String data;\n    private Object readResolve()\n        throws java.io.ObjectStreamException\n    {\n        String[] pieces = data.split(\",\");\n        Person result = new Person(pieces[0], pieces[1], Integer.parseInt(pieces[2]));\n        if (pieces.length > 3)\n        {\n            result.setSpouse(new Person(pieces[3], pieces[4], Integer.parseInt\n              (pieces[5])));\n            result.getSpouse().setSpouse(result);\n        }\n        return result;\n    }\n}\n\npublic class Person\n    implements java.io.Serializable\n{\n    public Person(String fn, String ln, int a)\n    {\n        this.firstName = fn; this.lastName = ln; this.age = a;\n    }\n\n    public String getFirstName() { return firstName; }\n    public String getLastName() { return lastName; }\n    public int getAge() { return age; }\n    public Person getSpouse() { return spouse; }\n\n    private Object writeReplace()\n        throws java.io.ObjectStreamException\n    {\n        return new PersonProxy(this);\n    }\n\n    public void setFirstName(String value) { firstName = value; }\n    public void setLastName(String value) { lastName = value; }\n    public void setAge(int value) { age = value; }\n    public void setSpouse(Person value) { spouse = value; }   \n\n    public String toString()\n    {\n        return \"[Person: firstName=\" + firstName + \n            \" lastName=\" + lastName +\n            \" age=\" + age +\n            \" spouse=\" + spouse.getFirstName() +\n            \"]\";\n    }    \n\n    private String firstName;\n    private String lastName;\n    private int age;\n    private Person spouse;\n}\n```\n\næ³¨æ„ï¼ŒPersonProxy å¿…é¡»è·Ÿè¸ª Person çš„æ‰€æœ‰æ•°æ®ã€‚è¿™é€šå¸¸æ„å‘³ç€ä»£ç†éœ€è¦æ˜¯ Person çš„ä¸€ä¸ªå†…éƒ¨ç±»ï¼Œä»¥ä¾¿èƒ½è®¿é—® private å­—æ®µã€‚æœ‰æ—¶å€™ï¼Œä»£ç†è¿˜éœ€è¦è¿½è¸ªå…¶ä»–å¯¹è±¡å¼•ç”¨å¹¶æ‰‹åŠ¨åºåˆ—åŒ–å®ƒä»¬ï¼Œä¾‹å¦‚ Person çš„ spouseã€‚\n\nè¿™ç§æŠ€å·§æ˜¯å°‘æ•°å‡ ç§ä¸éœ€è¦è¯»/å†™å¹³è¡¡çš„æŠ€å·§ä¹‹ä¸€ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªç±»è¢«é‡æ„æˆå¦ä¸€ç§ç±»å‹åçš„ç‰ˆæœ¬å¯ä»¥æä¾›ä¸€ä¸ª readResolve æ–¹æ³•ï¼Œä»¥ä¾¿é™é»˜åœ°å°†è¢«åºåˆ—åŒ–çš„å¯¹è±¡è½¬æ¢æˆæ–°ç±»å‹ã€‚ç±»ä¼¼åœ°ï¼Œå®ƒå¯ä»¥é‡‡ç”¨ writeReplace æ–¹æ³•å°†æ—§ç±»åºåˆ—åŒ–æˆæ–°ç‰ˆæœ¬ã€‚\n\n#### 5. ä¿¡ä»»ï¼Œä½†è¦éªŒè¯\n\nè®¤ä¸ºåºåˆ—åŒ–æµä¸­çš„æ•°æ®æ€»æ˜¯ä¸æœ€åˆå†™åˆ°æµä¸­çš„æ•°æ®ä¸€è‡´ï¼Œè¿™æ²¡æœ‰é—®é¢˜ã€‚ä½†æ˜¯ï¼Œæ­£å¦‚ä¸€ä½ç¾å›½å‰æ€»ç»Ÿæ‰€è¯´çš„ï¼Œâ€œä¿¡ä»»ï¼Œä½†è¦éªŒè¯â€ã€‚\nå¯¹äºåºåˆ—åŒ–çš„å¯¹è±¡ï¼Œè¿™æ„å‘³ç€éªŒè¯å­—æ®µï¼Œä»¥ç¡®ä¿åœ¨ååºåˆ—åŒ–ä¹‹åå®ƒä»¬ä»å…·æœ‰æ­£ç¡®çš„å€¼ï¼Œâ€œä»¥é˜²ä¸‡ä¸€â€ã€‚\n\nä¸ºæ­¤ï¼Œå¯ä»¥å®ç° ObjectInputValidationæ¥å£ï¼Œå¹¶è¦†ç›– validateObject() æ–¹æ³•ã€‚å¦‚æœè°ƒç”¨è¯¥æ–¹æ³•æ—¶å‘ç°æŸå¤„æœ‰é”™è¯¯ï¼Œåˆ™æŠ›å‡ºä¸€ä¸ª InvalidObjectExceptionã€‚\n\n### ç»“æŸè¯­\n\nJava å¯¹è±¡åºåˆ—åŒ–æ¯”å¤§å¤šæ•° Java å¼€å‘äººå‘˜æƒ³è±¡çš„æ›´çµæ´»ï¼Œè¿™ä½¿æˆ‘ä»¬æœ‰æ›´å¤šçš„æœºä¼šè§£å†³æ£˜æ‰‹çš„æƒ…å†µã€‚\n\nå¹¸è¿çš„æ˜¯ï¼Œåƒè¿™æ ·çš„ç¼–ç¨‹å¦™æ‹›åœ¨ JVM ä¸­éšå¤„å¯è§ã€‚å…³é”®æ˜¯è¦çŸ¥é“å®ƒä»¬ï¼Œåœ¨é‡åˆ°éš¾é¢˜çš„æ—¶å€™èƒ½ç”¨ä¸Šå®ƒä»¬ã€‚\n\næ¥æºï¼šwww.topthink.com/topic/11361.html","source":"_posts/åŸºç¡€/å…³äº Java åºåˆ—åŒ–ä½ ä¸çŸ¥é“çš„ 5 ä»¶äº‹.md","raw":"---\ntitle: å…³äº Java åºåˆ—åŒ–ä½ ä¸çŸ¥é“çš„ 5 ä»¶äº‹\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: åŸºç¡€\n---\n\n### å…³äºæœ¬ç³»åˆ—\n\nå¤§çº¦ä¸€å¹´å‰ï¼Œä¸€ä¸ªè´Ÿè´£ç®¡ç†åº”ç”¨ç¨‹åºæ‰€æœ‰ç”¨æˆ·è®¾ç½®çš„å¼€å‘äººå‘˜ï¼Œå†³å®šå°†ç”¨æˆ·è®¾ç½®å­˜å‚¨åœ¨ä¸€ä¸ª Hashtableä¸­ï¼Œç„¶åå°†è¿™ä¸ª Hashtable åºåˆ—åŒ–åˆ°ç£ç›˜ï¼Œä»¥ä¾¿æŒä¹…åŒ–ã€‚å½“ç”¨æˆ·æ›´æ”¹è®¾ç½®æ—¶ï¼Œä¾¿é‡æ–°å°† Hashtable å†™åˆ°ç£ç›˜ã€‚\n\nè¿™æ˜¯ä¸€ä¸ªä¼˜é›…çš„ã€å¼€æ”¾å¼çš„è®¾ç½®ç³»ç»Ÿï¼Œä½†æ˜¯ï¼Œå½“å›¢é˜Ÿå†³å®šä» Hashtable è¿ç§»åˆ° Java Collections åº“ä¸­çš„HashMap æ—¶ï¼Œè¿™ä¸ªç³»ç»Ÿä¾¿é¢ä¸´å´©æºƒã€‚\n\nHashtable å’Œ HashMap åœ¨ç£ç›˜ä¸Šçš„æ ¼å¼æ˜¯ä¸ç›¸åŒã€ä¸å…¼å®¹çš„ã€‚é™¤éå¯¹æ¯ä¸ªæŒä¹…åŒ–çš„ç”¨æˆ·è®¾ç½®è¿è¡ŒæŸç§ç±»å‹çš„æ•°æ®è½¬æ¢å®ç”¨ç¨‹åºï¼ˆæå…¶åºå¤§çš„ä»»åŠ¡ï¼‰ï¼Œå¦åˆ™ä»¥åä¼¼ä¹åªèƒ½ä¸€ç›´ç”¨Hashtable ä½œä¸ºåº”ç”¨ç¨‹åºçš„å­˜å‚¨æ ¼å¼ã€‚\n\nå›¢é˜Ÿæ„Ÿåˆ°é™·å…¥åƒµå±€ï¼Œä½†è¿™åªæ˜¯å› ä¸ºä»–ä»¬ä¸çŸ¥é“å…³äº Java åºåˆ—åŒ–çš„ä¸€ä¸ªé‡è¦äº‹å®ï¼šJava åºåˆ—åŒ–å…è®¸éšç€æ—¶é—´çš„æ¨ç§»è€Œæ”¹å˜ç±»å‹ã€‚å½“æˆ‘å‘ä»–ä»¬å±•ç¤ºå¦‚ä½•è‡ªåŠ¨è¿›è¡Œåºåˆ—åŒ–æ›¿æ¢åï¼Œä»–ä»¬ç»ˆäºæŒ‰è®¡åˆ’å®Œæˆäº†å‘ HashMap çš„è½¬å˜ã€‚\n\næœ¬æ–‡æ˜¯æœ¬ç³»åˆ—çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œè¿™ä¸ªç³»åˆ—ä¸“é—¨æ­ç¤ºå…³äº Java å¹³å°çš„ä¸€äº›æœ‰ç”¨çš„å°çŸ¥è¯† â€” è¿™äº›å°çŸ¥è¯†ä¸æ˜“ç†è§£ï¼Œä½†å¯¹äºè§£å†³ Java ç¼–ç¨‹æŒ‘æˆ˜è¿Ÿæ—©æœ‰ç”¨ã€‚\n\nå°† Java å¯¹è±¡åºåˆ—åŒ– API ä½œä¸ºå¼€ç«¯æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒä»ä¸€å¼€å§‹å°±å­˜åœ¨äº JDK 1.1 ä¸­ã€‚æœ¬æ–‡ä»‹ç»çš„å…³äºåºåˆ—åŒ–çš„ 5 ä»¶äº‹æƒ…å°†è¯´æœæ‚¨é‡æ–°å®¡è§†é‚£äº›æ ‡å‡† Java APIã€‚\n\n### Java åºåˆ—åŒ–ç®€ä»‹\n\nJava å¯¹è±¡åºåˆ—åŒ–æ˜¯ JDK 1.1 ä¸­å¼•å…¥çš„ä¸€ç»„å¼€åˆ›æ€§ç‰¹æ€§ä¹‹ä¸€ï¼Œç”¨äºä½œä¸ºä¸€ç§å°† Java å¯¹è±¡çš„çŠ¶æ€è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„ï¼Œä»¥ä¾¿å­˜å‚¨æˆ–ä¼ è¾“çš„æœºåˆ¶ï¼Œä»¥åï¼Œä»å¯ä»¥å°†å­—èŠ‚æ•°ç»„è½¬æ¢å› Java å¯¹è±¡åŸæœ‰çš„çŠ¶æ€ã€‚\n\nå®é™…ä¸Šï¼Œåºåˆ—åŒ–çš„æ€æƒ³æ˜¯ â€œå†»ç»“â€ å¯¹è±¡çŠ¶æ€ï¼Œä¼ è¾“å¯¹è±¡çŠ¶æ€ï¼ˆå†™åˆ°ç£ç›˜ã€é€šè¿‡ç½‘ç»œä¼ è¾“ç­‰ç­‰ï¼‰ï¼Œç„¶å â€œè§£å†»â€ çŠ¶æ€ï¼Œé‡æ–°è·å¾—å¯ç”¨çš„ Java å¯¹è±¡ã€‚æ‰€æœ‰è¿™äº›äº‹æƒ…çš„å‘ç”Ÿæœ‰ç‚¹åƒæ˜¯é­”æœ¯ï¼Œè¿™è¦å½’åŠŸäº ObjectInputStream/ObjectOutputStream ç±»ã€å®Œå…¨ä¿çœŸçš„å…ƒæ•°æ®ä»¥åŠç¨‹åºå‘˜æ„¿æ„ç”¨Serializable æ ‡è¯†æ¥å£æ ‡è®°ä»–ä»¬çš„ç±»ï¼Œä»è€Œ â€œå‚ä¸â€ è¿™ä¸ªè¿‡ç¨‹ã€‚\n\næ¸…å• 1 æ˜¾ç¤ºä¸€ä¸ªå®ç° Serializable çš„ Person ç±»ã€‚\n\n**æ¸…å• 1. Serializable Person**\n\n\n```\npackage com.tedneward;\n\npublic class Person\n    implements java.io.Serializable\n{\n    public Person(String fn, String ln, int a)\n    {\n        this.firstName = fn; this.lastName = ln; this.age = a;\n    }\n\n    public String getFirstName() { return firstName; }\n    public String getLastName() { return lastName; }\n    public int getAge() { return age; }\n    public Person getSpouse() { return spouse; }\n\n    public void setFirstName(String value) { firstName = value; }\n    public void setLastName(String value) { lastName = value; }\n    public void setAge(int value) { age = value; }\n    public void setSpouse(Person value) { spouse = value; }\n\n    public String toString()\n    {\n        return \"[Person: firstName=\" + firstName + \n            \" lastName=\" + lastName +\n            \" age=\" + age +\n            \" spouse=\" + spouse.getFirstName() +\n            \"]\";\n    }    \n\n    private String firstName;\n    private String lastName;\n    private int age;\n    private Person spouse;\n\n}\n```\n\nå°† Person åºåˆ—åŒ–åï¼Œå¾ˆå®¹æ˜“å°†å¯¹è±¡çŠ¶æ€å†™åˆ°ç£ç›˜ï¼Œç„¶åé‡æ–°è¯»å‡ºå®ƒï¼Œä¸‹é¢çš„ JUnit 4 å•å…ƒæµ‹è¯•å¯¹æ­¤åšäº†æ¼”ç¤ºã€‚\n\n**æ¸…å• 2. å¯¹ Person è¿›è¡Œååºåˆ—åŒ–**\n\n\n```\npublic class SerTest\n{\n    @Test public void serializeToDisk()\n    {\n        try\n        {\n            com.tedneward.Person ted = new com.tedneward.Person(\"Ted\", \"Neward\", 39);\n            com.tedneward.Person charl = new com.tedneward.Person(\"Charlotte\",\n                \"Neward\", 38);\n\n            ted.setSpouse(charl); charl.setSpouse(ted);\n\n            FileOutputStream fos = new FileOutputStream(\"tempdata.ser\");\n            ObjectOutputStream oos = new ObjectOutputStream(fos);\n            oos.writeObject(ted);\n            oos.close();\n        }\n        catch (Exception ex)\n        {\n            fail(\"Exception thrown during test: \" + ex.toString());\n        }\n\n        try\n        {\n            FileInputStream fis = new FileInputStream(\"tempdata.ser\");\n            ObjectInputStream ois = new ObjectInputStream(fis);\n            com.tedneward.Person ted = (com.tedneward.Person) ois.readObject();\n            ois.close();\n\n            assertEquals(ted.getFirstName(ï¼‰ï¼Œ \"Ted\");\n            assertEquals(ted.getSpouse().getFirstName(ï¼‰ï¼Œ \"Charlotte\");\n\n            // Clean up the file\n            new File(\"tempdata.ser\").delete();\n        }\n        catch (Exception ex)\n        {\n            fail(\"Exception thrown during test: \" + ex.toString());\n        }\n    }\n}\n```\n\nåˆ°ç°åœ¨ä¸ºæ­¢ï¼Œè¿˜æ²¡æœ‰çœ‹åˆ°ä»€ä¹ˆæ–°é²œçš„æˆ–ä»¤äººå…´å¥‹çš„äº‹æƒ…ï¼Œä½†æ˜¯è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å‡ºå‘ç‚¹ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ Person æ¥å‘ç°æ‚¨å¯èƒ½ä¸ çŸ¥é“çš„å…³äº Java å¯¹è±¡åºåˆ—åŒ– çš„ 5 ä»¶äº‹ã€‚\n\n#### 1. åºåˆ—åŒ–å…è®¸é‡æ„\n\nåºåˆ—åŒ–å…è®¸ä¸€å®šæ•°é‡çš„ç±»å˜ç§ï¼Œç”šè‡³é‡æ„ä¹‹åä¹Ÿæ˜¯å¦‚æ­¤ï¼ŒObjectInputStream ä»å¯ä»¥å¾ˆå¥½åœ°å°†å…¶è¯»å‡ºæ¥ã€‚\nJava Object Serialization è§„èŒƒå¯ä»¥è‡ªåŠ¨ç®¡ç†çš„å…³é”®ä»»åŠ¡æ˜¯ï¼š\n\n- å°†æ–°å­—æ®µæ·»åŠ åˆ°ç±»ä¸­\n\n- å°†å­—æ®µä» static æ”¹ä¸ºé static\n\n- å°†å­—æ®µä» transient æ”¹ä¸ºé transient\n\nå–å†³äºæ‰€éœ€çš„å‘åå…¼å®¹ç¨‹åº¦ï¼Œè½¬æ¢å­—æ®µå½¢å¼ï¼ˆä»é static è½¬æ¢ä¸º static æˆ–ä»é transient è½¬æ¢ä¸º transientï¼‰æˆ–è€…åˆ é™¤å­—æ®µéœ€è¦é¢å¤–çš„æ¶ˆæ¯ä¼ é€’ã€‚\n\n**é‡æ„åºåˆ—åŒ–ç±»**\n\næ—¢ç„¶å·²ç»çŸ¥é“åºåˆ—åŒ–å…è®¸é‡æ„ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å½“æŠŠæ–°å­—æ®µæ·»åŠ åˆ° Person ç±»ä¸­æ—¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆäº‹æƒ…ã€‚\n\nå¦‚æ¸…å• 3 æ‰€ç¤ºï¼ŒPersonV2 åœ¨åŸå…ˆ Person ç±»çš„åŸºç¡€ä¸Šå¼•å…¥ä¸€ä¸ªè¡¨ç¤ºæ€§åˆ«çš„æ–°å­—æ®µã€‚\n\n**æ¸…å• 3. å°†æ–°å­—æ®µæ·»åŠ åˆ°åºåˆ—åŒ–çš„ Person ä¸­**\n\n\n```\nenum Gender\n{\n    MALE, FEMALE\n}\n\npublic class Person\n    implements java.io.Serializable\n{\n    public Person(String fn, String ln, int a, Gender g)\n    {\n        this.firstName = fn; this.lastName = ln; this.age = a; this.gender = g;\n    }\n\n    public String getFirstName() { return firstName; }\n    public String getLastName() { return lastName; }\n    public Gender getGender() { return gender; }\n    public int getAge() { return age; }\n    public Person getSpouse() { return spouse; }\n\n    public void setFirstName(String value) { firstName = value; }\n    public void setLastName(String value) { lastName = value; }\n    public void setGender(Gender value) { gender = value; }\n    public void setAge(int value) { age = value; }\n    public void setSpouse(Person value) { spouse = value; }\n\n    public String toString()\n    {\n        return \"[Person: firstName=\" + firstName + \n            \" lastName=\" + lastName +\n            \" gender=\" + gender +\n            \" age=\" + age +\n            \" spouse=\" + spouse.getFirstName() +\n            \"]\";\n    }    \n\n    private String firstName;\n    private String lastName;\n    private int age;\n    private Person spouse;\n    private Gender gender;\n}\n```\n\nåºåˆ—åŒ–ä½¿ç”¨ä¸€ä¸ª hashï¼Œè¯¥ hash æ˜¯æ ¹æ®ç»™å®šæºæ–‡ä»¶ä¸­å‡ ä¹æ‰€æœ‰ä¸œè¥¿ â€” æ–¹æ³•åç§°ã€å­—æ®µåç§°ã€å­—æ®µç±»å‹ã€è®¿é—®ä¿®æ”¹æ–¹æ³•ç­‰ â€” è®¡ç®—å‡ºæ¥çš„ï¼Œåºåˆ—åŒ–å°†è¯¥ hash å€¼ä¸åºåˆ—åŒ–æµä¸­çš„ hash å€¼ç›¸æ¯”è¾ƒã€‚\n\nä¸ºäº†ä½¿ Java è¿è¡Œæ—¶ç›¸ä¿¡ä¸¤ç§ç±»å‹å®é™…ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œç¬¬äºŒç‰ˆå’Œéšåç‰ˆæœ¬çš„ Person å¿…é¡»ä¸ç¬¬ä¸€ç‰ˆæœ‰ç›¸åŒçš„åºåˆ—åŒ–ç‰ˆæœ¬ hashï¼ˆå­˜å‚¨ä¸º private static final serialVersionUID å­—æ®µï¼‰ã€‚\n\nå› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ serialVersionUID å­—æ®µï¼Œå®ƒæ˜¯é€šè¿‡å¯¹åŸå§‹ï¼ˆæˆ– V1ï¼‰ç‰ˆæœ¬çš„ Person ç±»è¿è¡Œ JDK serialverå‘½ä»¤è®¡ç®—å‡ºçš„ã€‚\n\nä¸€æ—¦æœ‰äº† Person çš„ serialVersionUIDï¼Œä¸ä»…å¯ä»¥ä»åŸå§‹å¯¹è±¡ Person çš„åºåˆ—åŒ–æ•°æ®åˆ›å»º PersonV2 å¯¹è±¡ï¼ˆå½“å‡ºç°æ–°å­—æ®µæ—¶ï¼Œæ–°å­—æ®µè¢«è®¾ä¸ºç¼ºçœå€¼ï¼Œæœ€å¸¸è§çš„æ˜¯â€œnullâ€ï¼‰ï¼Œè¿˜å¯ä»¥åè¿‡æ¥åšï¼šå³ä» PersonV2 çš„æ•°æ®é€šè¿‡ååºåˆ—åŒ–å¾—åˆ° Personï¼Œè¿™æ¯«ä¸å¥‡æ€ªã€‚\n\n#### 2. åºåˆ—åŒ–å¹¶ä¸å®‰å…¨\n\nè®© Java å¼€å‘äººå‘˜è¯§å¼‚å¹¶æ„Ÿåˆ°ä¸å¿«çš„æ˜¯ï¼Œåºåˆ—åŒ–äºŒè¿›åˆ¶æ ¼å¼å®Œå…¨ç¼–å†™åœ¨æ–‡æ¡£ä¸­ï¼Œå¹¶ä¸”å®Œå…¨å¯é€†ã€‚å®é™…ä¸Šï¼Œåªéœ€å°†äºŒè¿›åˆ¶åºåˆ—åŒ–æµçš„å†…å®¹è½¬å‚¨åˆ°æ§åˆ¶å°ï¼Œå°±è¶³ä»¥çœ‹æ¸…ç±»æ˜¯ä»€ä¹ˆæ ·å­ï¼Œä»¥åŠå®ƒåŒ…å«ä»€ä¹ˆå†…å®¹ã€‚\n\nè¿™å¯¹äºå®‰å…¨æ€§æœ‰ç€ä¸è‰¯å½±å“ã€‚ä¾‹å¦‚ï¼Œå½“é€šè¿‡ RMI è¿›è¡Œè¿œç¨‹æ–¹æ³•è°ƒç”¨æ—¶ï¼Œé€šè¿‡è¿æ¥å‘é€çš„å¯¹è±¡ä¸­çš„ä»»ä½• private å­—æ®µå‡ ä¹éƒ½æ˜¯ä»¥æ˜æ–‡çš„æ–¹å¼å‡ºç°åœ¨å¥—æ¥å­—æµä¸­ï¼Œè¿™æ˜¾ç„¶å®¹æ˜“æ‹›è‡´å“ªæ€•æœ€ç®€å•çš„å®‰å…¨é—®é¢˜ã€‚\n\nå¹¸è¿çš„æ˜¯ï¼Œåºåˆ—åŒ–å…è®¸ â€œhookâ€ åºåˆ—åŒ–è¿‡ç¨‹ï¼Œå¹¶åœ¨åºåˆ—åŒ–ä¹‹å‰å’Œååºåˆ—åŒ–ä¹‹åä¿æŠ¤ï¼ˆæˆ–æ¨¡ç³ŠåŒ–ï¼‰å­—æ®µæ•°æ®ã€‚å¯ä»¥é€šè¿‡åœ¨ Serializable å¯¹è±¡ä¸Šæä¾›ä¸€ä¸ª writeObject æ–¹æ³•æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚\n\n**æ¨¡ç³ŠåŒ–åºåˆ—åŒ–æ•°æ®**\n\nå‡è®¾ Person ç±»ä¸­çš„æ•æ„Ÿæ•°æ®æ˜¯ age å­—æ®µã€‚æ¯•ç«Ÿï¼Œå¥³å£«å¿Œè°ˆå¹´é¾„ã€‚ æˆ‘ä»¬å¯ä»¥åœ¨åºåˆ—åŒ–ä¹‹å‰æ¨¡ç³ŠåŒ–è¯¥æ•°æ®ï¼Œå°†æ•°ä½å¾ªç¯å·¦ç§»ä¸€ä½ï¼Œç„¶ååœ¨ååºåˆ—åŒ–ä¹‹åå¤ä½ã€‚ï¼ˆæ‚¨å¯ä»¥å¼€å‘æ›´å®‰å…¨çš„ç®—æ³•ï¼Œå½“å‰è¿™ä¸ªç®—æ³•åªæ˜¯ä½œä¸ºä¸€ä¸ªä¾‹å­ã€‚ï¼‰\n\nä¸ºäº† â€œhookâ€ åºåˆ—åŒ–è¿‡ç¨‹ï¼Œæˆ‘ä»¬å°†åœ¨ Person ä¸Šå®ç°ä¸€ä¸ª writeObject æ–¹æ³•ï¼›ä¸ºäº† â€œhookâ€ ååºåˆ—åŒ–è¿‡ç¨‹ï¼Œæˆ‘ä»¬å°†åœ¨åŒä¸€ä¸ªç±»ä¸Šå®ç°ä¸€ä¸ªreadObject æ–¹æ³•ã€‚é‡è¦çš„æ˜¯è¿™ä¸¤ä¸ªæ–¹æ³•çš„ç»†èŠ‚è¦æ­£ç¡® â€” å¦‚æœè®¿é—®ä¿®æ”¹æ–¹æ³•ã€å‚æ•°æˆ–åç§°ä¸åŒäºæ¸…å• 4 ä¸­çš„å†…å®¹ï¼Œé‚£ä¹ˆä»£ç å°†ä¸è¢«å¯Ÿè§‰åœ°å¤±è´¥ï¼ŒPerson çš„ age å°†æš´éœ²ã€‚\n\n**æ¸…å• 4. æ¨¡ç³ŠåŒ–åºåˆ—åŒ–æ•°æ®**\n\n\n```\npublic class Person\n    implements java.io.Serializable\n{\n    public Person(String fn, String ln, int a)\n    {\n        this.firstName = fn; this.lastName = ln; this.age = a;\n    }\n\n    public String getFirstName() { return firstName; }\n    public String getLastName() { return lastName; }\n    public int getAge() { return age; }\n    public Person getSpouse() { return spouse; }\n\n    public void setFirstName(String value) { firstName = value; }\n    public void setLastName(String value) { lastName = value; }\n    public void setAge(int value) { age = value; }\n    public void setSpouse(Person value) { spouse = value; }\n\n    private void writeObject(java.io.ObjectOutputStream stream)\n        throws java.io.IOException\n    {\n        // \"Encrypt\"/obscure the sensitive data\n        age = age << 2;\n        stream.defaultWriteObject();\n    }\n\n    private void readObject(java.io.ObjectInputStream stream)\n        throws java.io.IOException, ClassNotFoundException\n    {\n        stream.defaultReadObject();\n\n        // \"Decrypt\"/de-obscure the sensitive data\n        age = age << 2;\n    }\n\n    public String toString()\n    {\n        return \"[Person: firstName=\" + firstName + \n            \" lastName=\" + lastName +\n            \" age=\" + age +\n            \" spouse=\" + (spouse!=null ? spouse.getFirstName() : \"[null]\") +\n            \"]\";\n    }      \n\n    private String firstName;\n    private String lastName;\n    private int age;\n    private Person spouse;\n}\n```\n\nå¦‚æœéœ€è¦æŸ¥çœ‹è¢«æ¨¡ç³ŠåŒ–çš„æ•°æ®ï¼Œæ€»æ˜¯å¯ä»¥æŸ¥çœ‹åºåˆ—åŒ–æ•°æ®æµ/æ–‡ä»¶ã€‚è€Œä¸”ï¼Œç”±äºè¯¥æ ¼å¼è¢«å®Œå…¨æ–‡æ¡£åŒ–ï¼Œå³ä½¿ä¸èƒ½è®¿é—®ç±»æœ¬èº«ï¼Œä¹Ÿä»å¯ä»¥è¯»å–åºåˆ—åŒ–æµä¸­çš„å†…å®¹ã€‚\n\n#### 3. åºåˆ—åŒ–çš„æ•°æ®å¯ä»¥è¢«ç­¾åå’Œå¯†å°\n\nä¸Šä¸€ä¸ªæŠ€å·§å‡è®¾æ‚¨æƒ³æ¨¡ç³ŠåŒ–åºåˆ—åŒ–æ•°æ®ï¼Œè€Œä¸æ˜¯å¯¹å…¶åŠ å¯†æˆ–è€…ç¡®ä¿å®ƒä¸è¢«ä¿®æ”¹ã€‚å½“ç„¶ï¼Œé€šè¿‡ä½¿ç”¨ writeObject å’Œ readObject å¯ä»¥å®ç°å¯†ç åŠ å¯†å’Œç­¾åç®¡ç†ï¼Œä½†å…¶å®è¿˜æœ‰æ›´å¥½çš„æ–¹å¼ã€‚\n\nå¦‚æœéœ€è¦å¯¹æ•´ä¸ªå¯¹è±¡è¿›è¡ŒåŠ å¯†å’Œç­¾åï¼Œæœ€ç®€å•çš„æ˜¯å°†å®ƒæ”¾åœ¨ä¸€ä¸ª javax.crypto.SealedObject å’Œ/æˆ– java.security.SignedObject åŒ…è£…å™¨ä¸­ã€‚ä¸¤è€…éƒ½æ˜¯å¯åºåˆ—åŒ–çš„ï¼Œæ‰€ä»¥å°†å¯¹è±¡åŒ…è£…åœ¨ SealedObject ä¸­å¯ä»¥å›´ç»•åŸå¯¹è±¡åˆ›å»ºä¸€ç§â€œåŒ…è£…ç›’â€ã€‚å¿…é¡»æœ‰å¯¹ç§°å¯†é’¥æ‰èƒ½è§£å¯†ï¼Œè€Œä¸”å¯†é’¥å¿…é¡»å•ç‹¬ç®¡ç†ã€‚åŒæ ·ï¼Œä¹Ÿå¯ä»¥å°† SignedObject ç”¨äºæ•°æ®éªŒè¯ï¼Œå¹¶ä¸”å¯¹ç§°å¯†é’¥ä¹Ÿå¿…é¡»å•ç‹¬ç®¡ç†ã€‚\n\nç»“åˆä½¿ç”¨è¿™ä¸¤ç§å¯¹è±¡ï¼Œä¾¿å¯ä»¥è½»æ¾åœ°å¯¹åºåˆ—åŒ–æ•°æ®è¿›è¡Œå¯†å°å’Œç­¾åï¼Œè€Œä¸å¿…å¼ºè°ƒå…³äºæ•°å­—ç­¾åéªŒè¯æˆ–åŠ å¯†çš„ç»†èŠ‚ã€‚å¾ˆç®€æ´ï¼Œæ˜¯å§ï¼Ÿ\n\n#### 4. åºåˆ—åŒ–å…è®¸å°†ä»£ç†æ”¾åœ¨æµä¸­\n\nå¾ˆå¤šæƒ…å†µä¸‹ï¼Œç±»ä¸­åŒ…å«ä¸€ä¸ªæ ¸å¿ƒæ•°æ®å…ƒç´ ï¼Œé€šè¿‡å®ƒå¯ä»¥æ´¾ç”Ÿæˆ–æ‰¾åˆ°ç±»ä¸­çš„å…¶ä»–å­—æ®µã€‚åœ¨æ­¤æƒ…å†µä¸‹ï¼Œæ²¡æœ‰å¿…è¦åºåˆ—åŒ–æ•´ä¸ªå¯¹è±¡ã€‚å¯ä»¥å°†å­—æ®µæ ‡è®°ä¸º transientï¼Œä½†æ˜¯æ¯å½“æœ‰æ–¹æ³•è®¿é—®ä¸€ä¸ªå­—æ®µæ—¶ï¼Œç±»ä»ç„¶å¿…é¡»æ˜¾å¼åœ°äº§ç”Ÿä»£ç æ¥æ£€æŸ¥å®ƒæ˜¯å¦è¢«åˆå§‹åŒ–ã€‚\n\nå¦‚æœé¦–è¦é—®é¢˜æ˜¯åºåˆ—åŒ–ï¼Œé‚£ä¹ˆæœ€å¥½æŒ‡å®šä¸€ä¸ª flyweight æˆ–ä»£ç†æ”¾åœ¨æµä¸­ã€‚ä¸ºåŸå§‹ Person æä¾›ä¸€ä¸ª writeReplace æ–¹æ³•ï¼Œå¯ä»¥åºåˆ—åŒ–ä¸åŒç±»å‹çš„å¯¹è±¡æ¥ä»£æ›¿å®ƒã€‚ç±»ä¼¼åœ°ï¼Œå¦‚æœååºåˆ—åŒ–æœŸé—´å‘ç°ä¸€ä¸ª readResolve æ–¹æ³•ï¼Œé‚£ä¹ˆå°†è°ƒç”¨è¯¥æ–¹æ³•ï¼Œå°†æ›¿ä»£å¯¹è±¡æä¾›ç»™è°ƒç”¨è€…ã€‚\n\n**æ‰“åŒ…å’Œè§£åŒ…ä»£ç†**\n\nwriteReplace å’Œ readResolve æ–¹æ³•ä½¿ Person ç±»å¯ä»¥å°†å®ƒçš„æ‰€æœ‰æ•°æ®ï¼ˆæˆ–å…¶ä¸­çš„æ ¸å¿ƒæ•°æ®ï¼‰æ‰“åŒ…åˆ°ä¸€ä¸ª PersonProxy ä¸­ï¼Œå°†å®ƒæ”¾å…¥åˆ°ä¸€ä¸ªæµä¸­ï¼Œç„¶ååœ¨ååºåˆ—åŒ–æ—¶å†è¿›è¡Œè§£åŒ…ã€‚\n\n**æ¸…å• 5. ä½ å®Œæ•´äº†æˆ‘ï¼Œæˆ‘ä»£æ›¿äº†ä½ **\n\n\n```\nclass PersonProxy\n    implements java.io.Serializable\n{\n    public PersonProxy(Person orig)\n    {\n        data = orig.getFirstName() + \",\" + orig.getLastName() + \",\" + orig.getAge();\n        if (orig.getSpouse() != null)\n        {\n            Person spouse = orig.getSpouse();\n            data = data + \",\" + spouse.getFirstName() + \",\" + spouse.getLastName() + \",\"  \n              + spouse.getAge();\n        }\n    }\n\n    public String data;\n    private Object readResolve()\n        throws java.io.ObjectStreamException\n    {\n        String[] pieces = data.split(\",\");\n        Person result = new Person(pieces[0], pieces[1], Integer.parseInt(pieces[2]));\n        if (pieces.length > 3)\n        {\n            result.setSpouse(new Person(pieces[3], pieces[4], Integer.parseInt\n              (pieces[5])));\n            result.getSpouse().setSpouse(result);\n        }\n        return result;\n    }\n}\n\npublic class Person\n    implements java.io.Serializable\n{\n    public Person(String fn, String ln, int a)\n    {\n        this.firstName = fn; this.lastName = ln; this.age = a;\n    }\n\n    public String getFirstName() { return firstName; }\n    public String getLastName() { return lastName; }\n    public int getAge() { return age; }\n    public Person getSpouse() { return spouse; }\n\n    private Object writeReplace()\n        throws java.io.ObjectStreamException\n    {\n        return new PersonProxy(this);\n    }\n\n    public void setFirstName(String value) { firstName = value; }\n    public void setLastName(String value) { lastName = value; }\n    public void setAge(int value) { age = value; }\n    public void setSpouse(Person value) { spouse = value; }   \n\n    public String toString()\n    {\n        return \"[Person: firstName=\" + firstName + \n            \" lastName=\" + lastName +\n            \" age=\" + age +\n            \" spouse=\" + spouse.getFirstName() +\n            \"]\";\n    }    \n\n    private String firstName;\n    private String lastName;\n    private int age;\n    private Person spouse;\n}\n```\n\næ³¨æ„ï¼ŒPersonProxy å¿…é¡»è·Ÿè¸ª Person çš„æ‰€æœ‰æ•°æ®ã€‚è¿™é€šå¸¸æ„å‘³ç€ä»£ç†éœ€è¦æ˜¯ Person çš„ä¸€ä¸ªå†…éƒ¨ç±»ï¼Œä»¥ä¾¿èƒ½è®¿é—® private å­—æ®µã€‚æœ‰æ—¶å€™ï¼Œä»£ç†è¿˜éœ€è¦è¿½è¸ªå…¶ä»–å¯¹è±¡å¼•ç”¨å¹¶æ‰‹åŠ¨åºåˆ—åŒ–å®ƒä»¬ï¼Œä¾‹å¦‚ Person çš„ spouseã€‚\n\nè¿™ç§æŠ€å·§æ˜¯å°‘æ•°å‡ ç§ä¸éœ€è¦è¯»/å†™å¹³è¡¡çš„æŠ€å·§ä¹‹ä¸€ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªç±»è¢«é‡æ„æˆå¦ä¸€ç§ç±»å‹åçš„ç‰ˆæœ¬å¯ä»¥æä¾›ä¸€ä¸ª readResolve æ–¹æ³•ï¼Œä»¥ä¾¿é™é»˜åœ°å°†è¢«åºåˆ—åŒ–çš„å¯¹è±¡è½¬æ¢æˆæ–°ç±»å‹ã€‚ç±»ä¼¼åœ°ï¼Œå®ƒå¯ä»¥é‡‡ç”¨ writeReplace æ–¹æ³•å°†æ—§ç±»åºåˆ—åŒ–æˆæ–°ç‰ˆæœ¬ã€‚\n\n#### 5. ä¿¡ä»»ï¼Œä½†è¦éªŒè¯\n\nè®¤ä¸ºåºåˆ—åŒ–æµä¸­çš„æ•°æ®æ€»æ˜¯ä¸æœ€åˆå†™åˆ°æµä¸­çš„æ•°æ®ä¸€è‡´ï¼Œè¿™æ²¡æœ‰é—®é¢˜ã€‚ä½†æ˜¯ï¼Œæ­£å¦‚ä¸€ä½ç¾å›½å‰æ€»ç»Ÿæ‰€è¯´çš„ï¼Œâ€œä¿¡ä»»ï¼Œä½†è¦éªŒè¯â€ã€‚\nå¯¹äºåºåˆ—åŒ–çš„å¯¹è±¡ï¼Œè¿™æ„å‘³ç€éªŒè¯å­—æ®µï¼Œä»¥ç¡®ä¿åœ¨ååºåˆ—åŒ–ä¹‹åå®ƒä»¬ä»å…·æœ‰æ­£ç¡®çš„å€¼ï¼Œâ€œä»¥é˜²ä¸‡ä¸€â€ã€‚\n\nä¸ºæ­¤ï¼Œå¯ä»¥å®ç° ObjectInputValidationæ¥å£ï¼Œå¹¶è¦†ç›– validateObject() æ–¹æ³•ã€‚å¦‚æœè°ƒç”¨è¯¥æ–¹æ³•æ—¶å‘ç°æŸå¤„æœ‰é”™è¯¯ï¼Œåˆ™æŠ›å‡ºä¸€ä¸ª InvalidObjectExceptionã€‚\n\n### ç»“æŸè¯­\n\nJava å¯¹è±¡åºåˆ—åŒ–æ¯”å¤§å¤šæ•° Java å¼€å‘äººå‘˜æƒ³è±¡çš„æ›´çµæ´»ï¼Œè¿™ä½¿æˆ‘ä»¬æœ‰æ›´å¤šçš„æœºä¼šè§£å†³æ£˜æ‰‹çš„æƒ…å†µã€‚\n\nå¹¸è¿çš„æ˜¯ï¼Œåƒè¿™æ ·çš„ç¼–ç¨‹å¦™æ‹›åœ¨ JVM ä¸­éšå¤„å¯è§ã€‚å…³é”®æ˜¯è¦çŸ¥é“å®ƒä»¬ï¼Œåœ¨é‡åˆ°éš¾é¢˜çš„æ—¶å€™èƒ½ç”¨ä¸Šå®ƒä»¬ã€‚\n\næ¥æºï¼šwww.topthink.com/topic/11361.html","slug":"åŸºç¡€/å…³äº Java åºåˆ—åŒ–ä½ ä¸çŸ¥é“çš„ 5 ä»¶äº‹","published":1,"updated":"2025-10-15T07:19:51.889Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076w0046qkd42f033a2v","content":"<h3 id=\"å…³äºæœ¬ç³»åˆ—\"><a href=\"#å…³äºæœ¬ç³»åˆ—\" class=\"headerlink\" title=\"å…³äºæœ¬ç³»åˆ—\"></a>å…³äºæœ¬ç³»åˆ—</h3><p>å¤§çº¦ä¸€å¹´å‰ï¼Œä¸€ä¸ªè´Ÿè´£ç®¡ç†åº”ç”¨ç¨‹åºæ‰€æœ‰ç”¨æˆ·è®¾ç½®çš„å¼€å‘äººå‘˜ï¼Œå†³å®šå°†ç”¨æˆ·è®¾ç½®å­˜å‚¨åœ¨ä¸€ä¸ª Hashtableä¸­ï¼Œç„¶åå°†è¿™ä¸ª Hashtable åºåˆ—åŒ–åˆ°ç£ç›˜ï¼Œä»¥ä¾¿æŒä¹…åŒ–ã€‚å½“ç”¨æˆ·æ›´æ”¹è®¾ç½®æ—¶ï¼Œä¾¿é‡æ–°å°† Hashtable å†™åˆ°ç£ç›˜ã€‚</p>\n<p>è¿™æ˜¯ä¸€ä¸ªä¼˜é›…çš„ã€å¼€æ”¾å¼çš„è®¾ç½®ç³»ç»Ÿï¼Œä½†æ˜¯ï¼Œå½“å›¢é˜Ÿå†³å®šä» Hashtable è¿ç§»åˆ° Java Collections åº“ä¸­çš„HashMap æ—¶ï¼Œè¿™ä¸ªç³»ç»Ÿä¾¿é¢ä¸´å´©æºƒã€‚</p>\n<p>Hashtable å’Œ HashMap åœ¨ç£ç›˜ä¸Šçš„æ ¼å¼æ˜¯ä¸ç›¸åŒã€ä¸å…¼å®¹çš„ã€‚é™¤éå¯¹æ¯ä¸ªæŒä¹…åŒ–çš„ç”¨æˆ·è®¾ç½®è¿è¡ŒæŸç§ç±»å‹çš„æ•°æ®è½¬æ¢å®ç”¨ç¨‹åºï¼ˆæå…¶åºå¤§çš„ä»»åŠ¡ï¼‰ï¼Œå¦åˆ™ä»¥åä¼¼ä¹åªèƒ½ä¸€ç›´ç”¨Hashtable ä½œä¸ºåº”ç”¨ç¨‹åºçš„å­˜å‚¨æ ¼å¼ã€‚</p>\n<p>å›¢é˜Ÿæ„Ÿåˆ°é™·å…¥åƒµå±€ï¼Œä½†è¿™åªæ˜¯å› ä¸ºä»–ä»¬ä¸çŸ¥é“å…³äº Java åºåˆ—åŒ–çš„ä¸€ä¸ªé‡è¦äº‹å®ï¼šJava åºåˆ—åŒ–å…è®¸éšç€æ—¶é—´çš„æ¨ç§»è€Œæ”¹å˜ç±»å‹ã€‚å½“æˆ‘å‘ä»–ä»¬å±•ç¤ºå¦‚ä½•è‡ªåŠ¨è¿›è¡Œåºåˆ—åŒ–æ›¿æ¢åï¼Œä»–ä»¬ç»ˆäºæŒ‰è®¡åˆ’å®Œæˆäº†å‘ HashMap çš„è½¬å˜ã€‚</p>\n<p>æœ¬æ–‡æ˜¯æœ¬ç³»åˆ—çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œè¿™ä¸ªç³»åˆ—ä¸“é—¨æ­ç¤ºå…³äº Java å¹³å°çš„ä¸€äº›æœ‰ç”¨çš„å°çŸ¥è¯† â€” è¿™äº›å°çŸ¥è¯†ä¸æ˜“ç†è§£ï¼Œä½†å¯¹äºè§£å†³ Java ç¼–ç¨‹æŒ‘æˆ˜è¿Ÿæ—©æœ‰ç”¨ã€‚</p>\n<p>å°† Java å¯¹è±¡åºåˆ—åŒ– API ä½œä¸ºå¼€ç«¯æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒä»ä¸€å¼€å§‹å°±å­˜åœ¨äº JDK 1.1 ä¸­ã€‚æœ¬æ–‡ä»‹ç»çš„å…³äºåºåˆ—åŒ–çš„ 5 ä»¶äº‹æƒ…å°†è¯´æœæ‚¨é‡æ–°å®¡è§†é‚£äº›æ ‡å‡† Java APIã€‚</p>\n<h3 id=\"Java-åºåˆ—åŒ–ç®€ä»‹\"><a href=\"#Java-åºåˆ—åŒ–ç®€ä»‹\" class=\"headerlink\" title=\"Java åºåˆ—åŒ–ç®€ä»‹\"></a>Java åºåˆ—åŒ–ç®€ä»‹</h3><p>Java å¯¹è±¡åºåˆ—åŒ–æ˜¯ JDK 1.1 ä¸­å¼•å…¥çš„ä¸€ç»„å¼€åˆ›æ€§ç‰¹æ€§ä¹‹ä¸€ï¼Œç”¨äºä½œä¸ºä¸€ç§å°† Java å¯¹è±¡çš„çŠ¶æ€è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„ï¼Œä»¥ä¾¿å­˜å‚¨æˆ–ä¼ è¾“çš„æœºåˆ¶ï¼Œä»¥åï¼Œä»å¯ä»¥å°†å­—èŠ‚æ•°ç»„è½¬æ¢å› Java å¯¹è±¡åŸæœ‰çš„çŠ¶æ€ã€‚</p>\n<p>å®é™…ä¸Šï¼Œåºåˆ—åŒ–çš„æ€æƒ³æ˜¯ â€œå†»ç»“â€ å¯¹è±¡çŠ¶æ€ï¼Œä¼ è¾“å¯¹è±¡çŠ¶æ€ï¼ˆå†™åˆ°ç£ç›˜ã€é€šè¿‡ç½‘ç»œä¼ è¾“ç­‰ç­‰ï¼‰ï¼Œç„¶å â€œè§£å†»â€ çŠ¶æ€ï¼Œé‡æ–°è·å¾—å¯ç”¨çš„ Java å¯¹è±¡ã€‚æ‰€æœ‰è¿™äº›äº‹æƒ…çš„å‘ç”Ÿæœ‰ç‚¹åƒæ˜¯é­”æœ¯ï¼Œè¿™è¦å½’åŠŸäº ObjectInputStream&#x2F;ObjectOutputStream ç±»ã€å®Œå…¨ä¿çœŸçš„å…ƒæ•°æ®ä»¥åŠç¨‹åºå‘˜æ„¿æ„ç”¨Serializable æ ‡è¯†æ¥å£æ ‡è®°ä»–ä»¬çš„ç±»ï¼Œä»è€Œ â€œå‚ä¸â€ è¿™ä¸ªè¿‡ç¨‹ã€‚</p>\n<p>æ¸…å• 1 æ˜¾ç¤ºä¸€ä¸ªå®ç° Serializable çš„ Person ç±»ã€‚</p>\n<p><strong>æ¸…å• 1. Serializable Person</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">package com.tedneward;\n\npublic class Person\n    implements java.io.Serializable\n&#123;\n    public Person(String fn, String ln, int a)\n    &#123;\n        this.firstName &#x3D; fn; this.lastName &#x3D; ln; this.age &#x3D; a;\n    &#125;\n\n    public String getFirstName() &#123; return firstName; &#125;\n    public String getLastName() &#123; return lastName; &#125;\n    public int getAge() &#123; return age; &#125;\n    public Person getSpouse() &#123; return spouse; &#125;\n\n    public void setFirstName(String value) &#123; firstName &#x3D; value; &#125;\n    public void setLastName(String value) &#123; lastName &#x3D; value; &#125;\n    public void setAge(int value) &#123; age &#x3D; value; &#125;\n    public void setSpouse(Person value) &#123; spouse &#x3D; value; &#125;\n\n    public String toString()\n    &#123;\n        return &quot;[Person: firstName&#x3D;&quot; + firstName + \n            &quot; lastName&#x3D;&quot; + lastName +\n            &quot; age&#x3D;&quot; + age +\n            &quot; spouse&#x3D;&quot; + spouse.getFirstName() +\n            &quot;]&quot;;\n    &#125;    \n\n    private String firstName;\n    private String lastName;\n    private int age;\n    private Person spouse;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å°† Person åºåˆ—åŒ–åï¼Œå¾ˆå®¹æ˜“å°†å¯¹è±¡çŠ¶æ€å†™åˆ°ç£ç›˜ï¼Œç„¶åé‡æ–°è¯»å‡ºå®ƒï¼Œä¸‹é¢çš„ JUnit 4 å•å…ƒæµ‹è¯•å¯¹æ­¤åšäº†æ¼”ç¤ºã€‚</p>\n<p><strong>æ¸…å• 2. å¯¹ Person è¿›è¡Œååºåˆ—åŒ–</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class SerTest\n&#123;\n    @Test public void serializeToDisk()\n    &#123;\n        try\n        &#123;\n            com.tedneward.Person ted &#x3D; new com.tedneward.Person(&quot;Ted&quot;, &quot;Neward&quot;, 39);\n            com.tedneward.Person charl &#x3D; new com.tedneward.Person(&quot;Charlotte&quot;,\n                &quot;Neward&quot;, 38);\n\n            ted.setSpouse(charl); charl.setSpouse(ted);\n\n            FileOutputStream fos &#x3D; new FileOutputStream(&quot;tempdata.ser&quot;);\n            ObjectOutputStream oos &#x3D; new ObjectOutputStream(fos);\n            oos.writeObject(ted);\n            oos.close();\n        &#125;\n        catch (Exception ex)\n        &#123;\n            fail(&quot;Exception thrown during test: &quot; + ex.toString());\n        &#125;\n\n        try\n        &#123;\n            FileInputStream fis &#x3D; new FileInputStream(&quot;tempdata.ser&quot;);\n            ObjectInputStream ois &#x3D; new ObjectInputStream(fis);\n            com.tedneward.Person ted &#x3D; (com.tedneward.Person) ois.readObject();\n            ois.close();\n\n            assertEquals(ted.getFirstName(ï¼‰ï¼Œ &quot;Ted&quot;);\n            assertEquals(ted.getSpouse().getFirstName(ï¼‰ï¼Œ &quot;Charlotte&quot;);\n\n            &#x2F;&#x2F; Clean up the file\n            new File(&quot;tempdata.ser&quot;).delete();\n        &#125;\n        catch (Exception ex)\n        &#123;\n            fail(&quot;Exception thrown during test: &quot; + ex.toString());\n        &#125;\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>åˆ°ç°åœ¨ä¸ºæ­¢ï¼Œè¿˜æ²¡æœ‰çœ‹åˆ°ä»€ä¹ˆæ–°é²œçš„æˆ–ä»¤äººå…´å¥‹çš„äº‹æƒ…ï¼Œä½†æ˜¯è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å‡ºå‘ç‚¹ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ Person æ¥å‘ç°æ‚¨å¯èƒ½ä¸ çŸ¥é“çš„å…³äº Java å¯¹è±¡åºåˆ—åŒ– çš„ 5 ä»¶äº‹ã€‚</p>\n<h4 id=\"1-åºåˆ—åŒ–å…è®¸é‡æ„\"><a href=\"#1-åºåˆ—åŒ–å…è®¸é‡æ„\" class=\"headerlink\" title=\"1. åºåˆ—åŒ–å…è®¸é‡æ„\"></a>1. åºåˆ—åŒ–å…è®¸é‡æ„</h4><p>åºåˆ—åŒ–å…è®¸ä¸€å®šæ•°é‡çš„ç±»å˜ç§ï¼Œç”šè‡³é‡æ„ä¹‹åä¹Ÿæ˜¯å¦‚æ­¤ï¼ŒObjectInputStream ä»å¯ä»¥å¾ˆå¥½åœ°å°†å…¶è¯»å‡ºæ¥ã€‚<br>Java Object Serialization è§„èŒƒå¯ä»¥è‡ªåŠ¨ç®¡ç†çš„å…³é”®ä»»åŠ¡æ˜¯ï¼š</p>\n<ul>\n<li><p>å°†æ–°å­—æ®µæ·»åŠ åˆ°ç±»ä¸­</p>\n</li>\n<li><p>å°†å­—æ®µä» static æ”¹ä¸ºé static</p>\n</li>\n<li><p>å°†å­—æ®µä» transient æ”¹ä¸ºé transient</p>\n</li>\n</ul>\n<p>å–å†³äºæ‰€éœ€çš„å‘åå…¼å®¹ç¨‹åº¦ï¼Œè½¬æ¢å­—æ®µå½¢å¼ï¼ˆä»é static è½¬æ¢ä¸º static æˆ–ä»é transient è½¬æ¢ä¸º transientï¼‰æˆ–è€…åˆ é™¤å­—æ®µéœ€è¦é¢å¤–çš„æ¶ˆæ¯ä¼ é€’ã€‚</p>\n<p><strong>é‡æ„åºåˆ—åŒ–ç±»</strong></p>\n<p>æ—¢ç„¶å·²ç»çŸ¥é“åºåˆ—åŒ–å…è®¸é‡æ„ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å½“æŠŠæ–°å­—æ®µæ·»åŠ åˆ° Person ç±»ä¸­æ—¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆäº‹æƒ…ã€‚</p>\n<p>å¦‚æ¸…å• 3 æ‰€ç¤ºï¼ŒPersonV2 åœ¨åŸå…ˆ Person ç±»çš„åŸºç¡€ä¸Šå¼•å…¥ä¸€ä¸ªè¡¨ç¤ºæ€§åˆ«çš„æ–°å­—æ®µã€‚</p>\n<p><strong>æ¸…å• 3. å°†æ–°å­—æ®µæ·»åŠ åˆ°åºåˆ—åŒ–çš„ Person ä¸­</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">enum Gender\n&#123;\n    MALE, FEMALE\n&#125;\n\npublic class Person\n    implements java.io.Serializable\n&#123;\n    public Person(String fn, String ln, int a, Gender g)\n    &#123;\n        this.firstName &#x3D; fn; this.lastName &#x3D; ln; this.age &#x3D; a; this.gender &#x3D; g;\n    &#125;\n\n    public String getFirstName() &#123; return firstName; &#125;\n    public String getLastName() &#123; return lastName; &#125;\n    public Gender getGender() &#123; return gender; &#125;\n    public int getAge() &#123; return age; &#125;\n    public Person getSpouse() &#123; return spouse; &#125;\n\n    public void setFirstName(String value) &#123; firstName &#x3D; value; &#125;\n    public void setLastName(String value) &#123; lastName &#x3D; value; &#125;\n    public void setGender(Gender value) &#123; gender &#x3D; value; &#125;\n    public void setAge(int value) &#123; age &#x3D; value; &#125;\n    public void setSpouse(Person value) &#123; spouse &#x3D; value; &#125;\n\n    public String toString()\n    &#123;\n        return &quot;[Person: firstName&#x3D;&quot; + firstName + \n            &quot; lastName&#x3D;&quot; + lastName +\n            &quot; gender&#x3D;&quot; + gender +\n            &quot; age&#x3D;&quot; + age +\n            &quot; spouse&#x3D;&quot; + spouse.getFirstName() +\n            &quot;]&quot;;\n    &#125;    \n\n    private String firstName;\n    private String lastName;\n    private int age;\n    private Person spouse;\n    private Gender gender;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>åºåˆ—åŒ–ä½¿ç”¨ä¸€ä¸ª hashï¼Œè¯¥ hash æ˜¯æ ¹æ®ç»™å®šæºæ–‡ä»¶ä¸­å‡ ä¹æ‰€æœ‰ä¸œè¥¿ â€” æ–¹æ³•åç§°ã€å­—æ®µåç§°ã€å­—æ®µç±»å‹ã€è®¿é—®ä¿®æ”¹æ–¹æ³•ç­‰ â€” è®¡ç®—å‡ºæ¥çš„ï¼Œåºåˆ—åŒ–å°†è¯¥ hash å€¼ä¸åºåˆ—åŒ–æµä¸­çš„ hash å€¼ç›¸æ¯”è¾ƒã€‚</p>\n<p>ä¸ºäº†ä½¿ Java è¿è¡Œæ—¶ç›¸ä¿¡ä¸¤ç§ç±»å‹å®é™…ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œç¬¬äºŒç‰ˆå’Œéšåç‰ˆæœ¬çš„ Person å¿…é¡»ä¸ç¬¬ä¸€ç‰ˆæœ‰ç›¸åŒçš„åºåˆ—åŒ–ç‰ˆæœ¬ hashï¼ˆå­˜å‚¨ä¸º private static final serialVersionUID å­—æ®µï¼‰ã€‚</p>\n<p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ serialVersionUID å­—æ®µï¼Œå®ƒæ˜¯é€šè¿‡å¯¹åŸå§‹ï¼ˆæˆ– V1ï¼‰ç‰ˆæœ¬çš„ Person ç±»è¿è¡Œ JDK serialverå‘½ä»¤è®¡ç®—å‡ºçš„ã€‚</p>\n<p>ä¸€æ—¦æœ‰äº† Person çš„ serialVersionUIDï¼Œä¸ä»…å¯ä»¥ä»åŸå§‹å¯¹è±¡ Person çš„åºåˆ—åŒ–æ•°æ®åˆ›å»º PersonV2 å¯¹è±¡ï¼ˆå½“å‡ºç°æ–°å­—æ®µæ—¶ï¼Œæ–°å­—æ®µè¢«è®¾ä¸ºç¼ºçœå€¼ï¼Œæœ€å¸¸è§çš„æ˜¯â€œnullâ€ï¼‰ï¼Œè¿˜å¯ä»¥åè¿‡æ¥åšï¼šå³ä» PersonV2 çš„æ•°æ®é€šè¿‡ååºåˆ—åŒ–å¾—åˆ° Personï¼Œè¿™æ¯«ä¸å¥‡æ€ªã€‚</p>\n<h4 id=\"2-åºåˆ—åŒ–å¹¶ä¸å®‰å…¨\"><a href=\"#2-åºåˆ—åŒ–å¹¶ä¸å®‰å…¨\" class=\"headerlink\" title=\"2. åºåˆ—åŒ–å¹¶ä¸å®‰å…¨\"></a>2. åºåˆ—åŒ–å¹¶ä¸å®‰å…¨</h4><p>è®© Java å¼€å‘äººå‘˜è¯§å¼‚å¹¶æ„Ÿåˆ°ä¸å¿«çš„æ˜¯ï¼Œåºåˆ—åŒ–äºŒè¿›åˆ¶æ ¼å¼å®Œå…¨ç¼–å†™åœ¨æ–‡æ¡£ä¸­ï¼Œå¹¶ä¸”å®Œå…¨å¯é€†ã€‚å®é™…ä¸Šï¼Œåªéœ€å°†äºŒè¿›åˆ¶åºåˆ—åŒ–æµçš„å†…å®¹è½¬å‚¨åˆ°æ§åˆ¶å°ï¼Œå°±è¶³ä»¥çœ‹æ¸…ç±»æ˜¯ä»€ä¹ˆæ ·å­ï¼Œä»¥åŠå®ƒåŒ…å«ä»€ä¹ˆå†…å®¹ã€‚</p>\n<p>è¿™å¯¹äºå®‰å…¨æ€§æœ‰ç€ä¸è‰¯å½±å“ã€‚ä¾‹å¦‚ï¼Œå½“é€šè¿‡ RMI è¿›è¡Œè¿œç¨‹æ–¹æ³•è°ƒç”¨æ—¶ï¼Œé€šè¿‡è¿æ¥å‘é€çš„å¯¹è±¡ä¸­çš„ä»»ä½• private å­—æ®µå‡ ä¹éƒ½æ˜¯ä»¥æ˜æ–‡çš„æ–¹å¼å‡ºç°åœ¨å¥—æ¥å­—æµä¸­ï¼Œè¿™æ˜¾ç„¶å®¹æ˜“æ‹›è‡´å“ªæ€•æœ€ç®€å•çš„å®‰å…¨é—®é¢˜ã€‚</p>\n<p>å¹¸è¿çš„æ˜¯ï¼Œåºåˆ—åŒ–å…è®¸ â€œhookâ€ åºåˆ—åŒ–è¿‡ç¨‹ï¼Œå¹¶åœ¨åºåˆ—åŒ–ä¹‹å‰å’Œååºåˆ—åŒ–ä¹‹åä¿æŠ¤ï¼ˆæˆ–æ¨¡ç³ŠåŒ–ï¼‰å­—æ®µæ•°æ®ã€‚å¯ä»¥é€šè¿‡åœ¨ Serializable å¯¹è±¡ä¸Šæä¾›ä¸€ä¸ª writeObject æ–¹æ³•æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚</p>\n<p><strong>æ¨¡ç³ŠåŒ–åºåˆ—åŒ–æ•°æ®</strong></p>\n<p>å‡è®¾ Person ç±»ä¸­çš„æ•æ„Ÿæ•°æ®æ˜¯ age å­—æ®µã€‚æ¯•ç«Ÿï¼Œå¥³å£«å¿Œè°ˆå¹´é¾„ã€‚ æˆ‘ä»¬å¯ä»¥åœ¨åºåˆ—åŒ–ä¹‹å‰æ¨¡ç³ŠåŒ–è¯¥æ•°æ®ï¼Œå°†æ•°ä½å¾ªç¯å·¦ç§»ä¸€ä½ï¼Œç„¶ååœ¨ååºåˆ—åŒ–ä¹‹åå¤ä½ã€‚ï¼ˆæ‚¨å¯ä»¥å¼€å‘æ›´å®‰å…¨çš„ç®—æ³•ï¼Œå½“å‰è¿™ä¸ªç®—æ³•åªæ˜¯ä½œä¸ºä¸€ä¸ªä¾‹å­ã€‚ï¼‰</p>\n<p>ä¸ºäº† â€œhookâ€ åºåˆ—åŒ–è¿‡ç¨‹ï¼Œæˆ‘ä»¬å°†åœ¨ Person ä¸Šå®ç°ä¸€ä¸ª writeObject æ–¹æ³•ï¼›ä¸ºäº† â€œhookâ€ ååºåˆ—åŒ–è¿‡ç¨‹ï¼Œæˆ‘ä»¬å°†åœ¨åŒä¸€ä¸ªç±»ä¸Šå®ç°ä¸€ä¸ªreadObject æ–¹æ³•ã€‚é‡è¦çš„æ˜¯è¿™ä¸¤ä¸ªæ–¹æ³•çš„ç»†èŠ‚è¦æ­£ç¡® â€” å¦‚æœè®¿é—®ä¿®æ”¹æ–¹æ³•ã€å‚æ•°æˆ–åç§°ä¸åŒäºæ¸…å• 4 ä¸­çš„å†…å®¹ï¼Œé‚£ä¹ˆä»£ç å°†ä¸è¢«å¯Ÿè§‰åœ°å¤±è´¥ï¼ŒPerson çš„ age å°†æš´éœ²ã€‚</p>\n<p><strong>æ¸…å• 4. æ¨¡ç³ŠåŒ–åºåˆ—åŒ–æ•°æ®</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class Person\n    implements java.io.Serializable\n&#123;\n    public Person(String fn, String ln, int a)\n    &#123;\n        this.firstName &#x3D; fn; this.lastName &#x3D; ln; this.age &#x3D; a;\n    &#125;\n\n    public String getFirstName() &#123; return firstName; &#125;\n    public String getLastName() &#123; return lastName; &#125;\n    public int getAge() &#123; return age; &#125;\n    public Person getSpouse() &#123; return spouse; &#125;\n\n    public void setFirstName(String value) &#123; firstName &#x3D; value; &#125;\n    public void setLastName(String value) &#123; lastName &#x3D; value; &#125;\n    public void setAge(int value) &#123; age &#x3D; value; &#125;\n    public void setSpouse(Person value) &#123; spouse &#x3D; value; &#125;\n\n    private void writeObject(java.io.ObjectOutputStream stream)\n        throws java.io.IOException\n    &#123;\n        &#x2F;&#x2F; &quot;Encrypt&quot;&#x2F;obscure the sensitive data\n        age &#x3D; age &lt;&lt; 2;\n        stream.defaultWriteObject();\n    &#125;\n\n    private void readObject(java.io.ObjectInputStream stream)\n        throws java.io.IOException, ClassNotFoundException\n    &#123;\n        stream.defaultReadObject();\n\n        &#x2F;&#x2F; &quot;Decrypt&quot;&#x2F;de-obscure the sensitive data\n        age &#x3D; age &lt;&lt; 2;\n    &#125;\n\n    public String toString()\n    &#123;\n        return &quot;[Person: firstName&#x3D;&quot; + firstName + \n            &quot; lastName&#x3D;&quot; + lastName +\n            &quot; age&#x3D;&quot; + age +\n            &quot; spouse&#x3D;&quot; + (spouse!&#x3D;null ? spouse.getFirstName() : &quot;[null]&quot;) +\n            &quot;]&quot;;\n    &#125;      \n\n    private String firstName;\n    private String lastName;\n    private int age;\n    private Person spouse;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¦‚æœéœ€è¦æŸ¥çœ‹è¢«æ¨¡ç³ŠåŒ–çš„æ•°æ®ï¼Œæ€»æ˜¯å¯ä»¥æŸ¥çœ‹åºåˆ—åŒ–æ•°æ®æµ&#x2F;æ–‡ä»¶ã€‚è€Œä¸”ï¼Œç”±äºè¯¥æ ¼å¼è¢«å®Œå…¨æ–‡æ¡£åŒ–ï¼Œå³ä½¿ä¸èƒ½è®¿é—®ç±»æœ¬èº«ï¼Œä¹Ÿä»å¯ä»¥è¯»å–åºåˆ—åŒ–æµä¸­çš„å†…å®¹ã€‚</p>\n<h4 id=\"3-åºåˆ—åŒ–çš„æ•°æ®å¯ä»¥è¢«ç­¾åå’Œå¯†å°\"><a href=\"#3-åºåˆ—åŒ–çš„æ•°æ®å¯ä»¥è¢«ç­¾åå’Œå¯†å°\" class=\"headerlink\" title=\"3. åºåˆ—åŒ–çš„æ•°æ®å¯ä»¥è¢«ç­¾åå’Œå¯†å°\"></a>3. åºåˆ—åŒ–çš„æ•°æ®å¯ä»¥è¢«ç­¾åå’Œå¯†å°</h4><p>ä¸Šä¸€ä¸ªæŠ€å·§å‡è®¾æ‚¨æƒ³æ¨¡ç³ŠåŒ–åºåˆ—åŒ–æ•°æ®ï¼Œè€Œä¸æ˜¯å¯¹å…¶åŠ å¯†æˆ–è€…ç¡®ä¿å®ƒä¸è¢«ä¿®æ”¹ã€‚å½“ç„¶ï¼Œé€šè¿‡ä½¿ç”¨ writeObject å’Œ readObject å¯ä»¥å®ç°å¯†ç åŠ å¯†å’Œç­¾åç®¡ç†ï¼Œä½†å…¶å®è¿˜æœ‰æ›´å¥½çš„æ–¹å¼ã€‚</p>\n<p>å¦‚æœéœ€è¦å¯¹æ•´ä¸ªå¯¹è±¡è¿›è¡ŒåŠ å¯†å’Œç­¾åï¼Œæœ€ç®€å•çš„æ˜¯å°†å®ƒæ”¾åœ¨ä¸€ä¸ª javax.crypto.SealedObject å’Œ&#x2F;æˆ– java.security.SignedObject åŒ…è£…å™¨ä¸­ã€‚ä¸¤è€…éƒ½æ˜¯å¯åºåˆ—åŒ–çš„ï¼Œæ‰€ä»¥å°†å¯¹è±¡åŒ…è£…åœ¨ SealedObject ä¸­å¯ä»¥å›´ç»•åŸå¯¹è±¡åˆ›å»ºä¸€ç§â€œåŒ…è£…ç›’â€ã€‚å¿…é¡»æœ‰å¯¹ç§°å¯†é’¥æ‰èƒ½è§£å¯†ï¼Œè€Œä¸”å¯†é’¥å¿…é¡»å•ç‹¬ç®¡ç†ã€‚åŒæ ·ï¼Œä¹Ÿå¯ä»¥å°† SignedObject ç”¨äºæ•°æ®éªŒè¯ï¼Œå¹¶ä¸”å¯¹ç§°å¯†é’¥ä¹Ÿå¿…é¡»å•ç‹¬ç®¡ç†ã€‚</p>\n<p>ç»“åˆä½¿ç”¨è¿™ä¸¤ç§å¯¹è±¡ï¼Œä¾¿å¯ä»¥è½»æ¾åœ°å¯¹åºåˆ—åŒ–æ•°æ®è¿›è¡Œå¯†å°å’Œç­¾åï¼Œè€Œä¸å¿…å¼ºè°ƒå…³äºæ•°å­—ç­¾åéªŒè¯æˆ–åŠ å¯†çš„ç»†èŠ‚ã€‚å¾ˆç®€æ´ï¼Œæ˜¯å§ï¼Ÿ</p>\n<h4 id=\"4-åºåˆ—åŒ–å…è®¸å°†ä»£ç†æ”¾åœ¨æµä¸­\"><a href=\"#4-åºåˆ—åŒ–å…è®¸å°†ä»£ç†æ”¾åœ¨æµä¸­\" class=\"headerlink\" title=\"4. åºåˆ—åŒ–å…è®¸å°†ä»£ç†æ”¾åœ¨æµä¸­\"></a>4. åºåˆ—åŒ–å…è®¸å°†ä»£ç†æ”¾åœ¨æµä¸­</h4><p>å¾ˆå¤šæƒ…å†µä¸‹ï¼Œç±»ä¸­åŒ…å«ä¸€ä¸ªæ ¸å¿ƒæ•°æ®å…ƒç´ ï¼Œé€šè¿‡å®ƒå¯ä»¥æ´¾ç”Ÿæˆ–æ‰¾åˆ°ç±»ä¸­çš„å…¶ä»–å­—æ®µã€‚åœ¨æ­¤æƒ…å†µä¸‹ï¼Œæ²¡æœ‰å¿…è¦åºåˆ—åŒ–æ•´ä¸ªå¯¹è±¡ã€‚å¯ä»¥å°†å­—æ®µæ ‡è®°ä¸º transientï¼Œä½†æ˜¯æ¯å½“æœ‰æ–¹æ³•è®¿é—®ä¸€ä¸ªå­—æ®µæ—¶ï¼Œç±»ä»ç„¶å¿…é¡»æ˜¾å¼åœ°äº§ç”Ÿä»£ç æ¥æ£€æŸ¥å®ƒæ˜¯å¦è¢«åˆå§‹åŒ–ã€‚</p>\n<p>å¦‚æœé¦–è¦é—®é¢˜æ˜¯åºåˆ—åŒ–ï¼Œé‚£ä¹ˆæœ€å¥½æŒ‡å®šä¸€ä¸ª flyweight æˆ–ä»£ç†æ”¾åœ¨æµä¸­ã€‚ä¸ºåŸå§‹ Person æä¾›ä¸€ä¸ª writeReplace æ–¹æ³•ï¼Œå¯ä»¥åºåˆ—åŒ–ä¸åŒç±»å‹çš„å¯¹è±¡æ¥ä»£æ›¿å®ƒã€‚ç±»ä¼¼åœ°ï¼Œå¦‚æœååºåˆ—åŒ–æœŸé—´å‘ç°ä¸€ä¸ª readResolve æ–¹æ³•ï¼Œé‚£ä¹ˆå°†è°ƒç”¨è¯¥æ–¹æ³•ï¼Œå°†æ›¿ä»£å¯¹è±¡æä¾›ç»™è°ƒç”¨è€…ã€‚</p>\n<p><strong>æ‰“åŒ…å’Œè§£åŒ…ä»£ç†</strong></p>\n<p>writeReplace å’Œ readResolve æ–¹æ³•ä½¿ Person ç±»å¯ä»¥å°†å®ƒçš„æ‰€æœ‰æ•°æ®ï¼ˆæˆ–å…¶ä¸­çš„æ ¸å¿ƒæ•°æ®ï¼‰æ‰“åŒ…åˆ°ä¸€ä¸ª PersonProxy ä¸­ï¼Œå°†å®ƒæ”¾å…¥åˆ°ä¸€ä¸ªæµä¸­ï¼Œç„¶ååœ¨ååºåˆ—åŒ–æ—¶å†è¿›è¡Œè§£åŒ…ã€‚</p>\n<p><strong>æ¸…å• 5. ä½ å®Œæ•´äº†æˆ‘ï¼Œæˆ‘ä»£æ›¿äº†ä½ </strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">class PersonProxy\n    implements java.io.Serializable\n&#123;\n    public PersonProxy(Person orig)\n    &#123;\n        data &#x3D; orig.getFirstName() + &quot;,&quot; + orig.getLastName() + &quot;,&quot; + orig.getAge();\n        if (orig.getSpouse() !&#x3D; null)\n        &#123;\n            Person spouse &#x3D; orig.getSpouse();\n            data &#x3D; data + &quot;,&quot; + spouse.getFirstName() + &quot;,&quot; + spouse.getLastName() + &quot;,&quot;  \n              + spouse.getAge();\n        &#125;\n    &#125;\n\n    public String data;\n    private Object readResolve()\n        throws java.io.ObjectStreamException\n    &#123;\n        String[] pieces &#x3D; data.split(&quot;,&quot;);\n        Person result &#x3D; new Person(pieces[0], pieces[1], Integer.parseInt(pieces[2]));\n        if (pieces.length &gt; 3)\n        &#123;\n            result.setSpouse(new Person(pieces[3], pieces[4], Integer.parseInt\n              (pieces[5])));\n            result.getSpouse().setSpouse(result);\n        &#125;\n        return result;\n    &#125;\n&#125;\n\npublic class Person\n    implements java.io.Serializable\n&#123;\n    public Person(String fn, String ln, int a)\n    &#123;\n        this.firstName &#x3D; fn; this.lastName &#x3D; ln; this.age &#x3D; a;\n    &#125;\n\n    public String getFirstName() &#123; return firstName; &#125;\n    public String getLastName() &#123; return lastName; &#125;\n    public int getAge() &#123; return age; &#125;\n    public Person getSpouse() &#123; return spouse; &#125;\n\n    private Object writeReplace()\n        throws java.io.ObjectStreamException\n    &#123;\n        return new PersonProxy(this);\n    &#125;\n\n    public void setFirstName(String value) &#123; firstName &#x3D; value; &#125;\n    public void setLastName(String value) &#123; lastName &#x3D; value; &#125;\n    public void setAge(int value) &#123; age &#x3D; value; &#125;\n    public void setSpouse(Person value) &#123; spouse &#x3D; value; &#125;   \n\n    public String toString()\n    &#123;\n        return &quot;[Person: firstName&#x3D;&quot; + firstName + \n            &quot; lastName&#x3D;&quot; + lastName +\n            &quot; age&#x3D;&quot; + age +\n            &quot; spouse&#x3D;&quot; + spouse.getFirstName() +\n            &quot;]&quot;;\n    &#125;    \n\n    private String firstName;\n    private String lastName;\n    private int age;\n    private Person spouse;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ³¨æ„ï¼ŒPersonProxy å¿…é¡»è·Ÿè¸ª Person çš„æ‰€æœ‰æ•°æ®ã€‚è¿™é€šå¸¸æ„å‘³ç€ä»£ç†éœ€è¦æ˜¯ Person çš„ä¸€ä¸ªå†…éƒ¨ç±»ï¼Œä»¥ä¾¿èƒ½è®¿é—® private å­—æ®µã€‚æœ‰æ—¶å€™ï¼Œä»£ç†è¿˜éœ€è¦è¿½è¸ªå…¶ä»–å¯¹è±¡å¼•ç”¨å¹¶æ‰‹åŠ¨åºåˆ—åŒ–å®ƒä»¬ï¼Œä¾‹å¦‚ Person çš„ spouseã€‚</p>\n<p>è¿™ç§æŠ€å·§æ˜¯å°‘æ•°å‡ ç§ä¸éœ€è¦è¯»&#x2F;å†™å¹³è¡¡çš„æŠ€å·§ä¹‹ä¸€ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªç±»è¢«é‡æ„æˆå¦ä¸€ç§ç±»å‹åçš„ç‰ˆæœ¬å¯ä»¥æä¾›ä¸€ä¸ª readResolve æ–¹æ³•ï¼Œä»¥ä¾¿é™é»˜åœ°å°†è¢«åºåˆ—åŒ–çš„å¯¹è±¡è½¬æ¢æˆæ–°ç±»å‹ã€‚ç±»ä¼¼åœ°ï¼Œå®ƒå¯ä»¥é‡‡ç”¨ writeReplace æ–¹æ³•å°†æ—§ç±»åºåˆ—åŒ–æˆæ–°ç‰ˆæœ¬ã€‚</p>\n<h4 id=\"5-ä¿¡ä»»ï¼Œä½†è¦éªŒè¯\"><a href=\"#5-ä¿¡ä»»ï¼Œä½†è¦éªŒè¯\" class=\"headerlink\" title=\"5. ä¿¡ä»»ï¼Œä½†è¦éªŒè¯\"></a>5. ä¿¡ä»»ï¼Œä½†è¦éªŒè¯</h4><p>è®¤ä¸ºåºåˆ—åŒ–æµä¸­çš„æ•°æ®æ€»æ˜¯ä¸æœ€åˆå†™åˆ°æµä¸­çš„æ•°æ®ä¸€è‡´ï¼Œè¿™æ²¡æœ‰é—®é¢˜ã€‚ä½†æ˜¯ï¼Œæ­£å¦‚ä¸€ä½ç¾å›½å‰æ€»ç»Ÿæ‰€è¯´çš„ï¼Œâ€œä¿¡ä»»ï¼Œä½†è¦éªŒè¯â€ã€‚<br>å¯¹äºåºåˆ—åŒ–çš„å¯¹è±¡ï¼Œè¿™æ„å‘³ç€éªŒè¯å­—æ®µï¼Œä»¥ç¡®ä¿åœ¨ååºåˆ—åŒ–ä¹‹åå®ƒä»¬ä»å…·æœ‰æ­£ç¡®çš„å€¼ï¼Œâ€œä»¥é˜²ä¸‡ä¸€â€ã€‚</p>\n<p>ä¸ºæ­¤ï¼Œå¯ä»¥å®ç° ObjectInputValidationæ¥å£ï¼Œå¹¶è¦†ç›– validateObject() æ–¹æ³•ã€‚å¦‚æœè°ƒç”¨è¯¥æ–¹æ³•æ—¶å‘ç°æŸå¤„æœ‰é”™è¯¯ï¼Œåˆ™æŠ›å‡ºä¸€ä¸ª InvalidObjectExceptionã€‚</p>\n<h3 id=\"ç»“æŸè¯­\"><a href=\"#ç»“æŸè¯­\" class=\"headerlink\" title=\"ç»“æŸè¯­\"></a>ç»“æŸè¯­</h3><p>Java å¯¹è±¡åºåˆ—åŒ–æ¯”å¤§å¤šæ•° Java å¼€å‘äººå‘˜æƒ³è±¡çš„æ›´çµæ´»ï¼Œè¿™ä½¿æˆ‘ä»¬æœ‰æ›´å¤šçš„æœºä¼šè§£å†³æ£˜æ‰‹çš„æƒ…å†µã€‚</p>\n<p>å¹¸è¿çš„æ˜¯ï¼Œåƒè¿™æ ·çš„ç¼–ç¨‹å¦™æ‹›åœ¨ JVM ä¸­éšå¤„å¯è§ã€‚å…³é”®æ˜¯è¦çŸ¥é“å®ƒä»¬ï¼Œåœ¨é‡åˆ°éš¾é¢˜çš„æ—¶å€™èƒ½ç”¨ä¸Šå®ƒä»¬ã€‚</p>\n<p>æ¥æºï¼š<a href=\"http://www.topthink.com/topic/11361.html\">www.topthink.com/topic/11361.html</a></p>\n","excerpt":"","more":"<h3 id=\"å…³äºæœ¬ç³»åˆ—\"><a href=\"#å…³äºæœ¬ç³»åˆ—\" class=\"headerlink\" title=\"å…³äºæœ¬ç³»åˆ—\"></a>å…³äºæœ¬ç³»åˆ—</h3><p>å¤§çº¦ä¸€å¹´å‰ï¼Œä¸€ä¸ªè´Ÿè´£ç®¡ç†åº”ç”¨ç¨‹åºæ‰€æœ‰ç”¨æˆ·è®¾ç½®çš„å¼€å‘äººå‘˜ï¼Œå†³å®šå°†ç”¨æˆ·è®¾ç½®å­˜å‚¨åœ¨ä¸€ä¸ª Hashtableä¸­ï¼Œç„¶åå°†è¿™ä¸ª Hashtable åºåˆ—åŒ–åˆ°ç£ç›˜ï¼Œä»¥ä¾¿æŒä¹…åŒ–ã€‚å½“ç”¨æˆ·æ›´æ”¹è®¾ç½®æ—¶ï¼Œä¾¿é‡æ–°å°† Hashtable å†™åˆ°ç£ç›˜ã€‚</p>\n<p>è¿™æ˜¯ä¸€ä¸ªä¼˜é›…çš„ã€å¼€æ”¾å¼çš„è®¾ç½®ç³»ç»Ÿï¼Œä½†æ˜¯ï¼Œå½“å›¢é˜Ÿå†³å®šä» Hashtable è¿ç§»åˆ° Java Collections åº“ä¸­çš„HashMap æ—¶ï¼Œè¿™ä¸ªç³»ç»Ÿä¾¿é¢ä¸´å´©æºƒã€‚</p>\n<p>Hashtable å’Œ HashMap åœ¨ç£ç›˜ä¸Šçš„æ ¼å¼æ˜¯ä¸ç›¸åŒã€ä¸å…¼å®¹çš„ã€‚é™¤éå¯¹æ¯ä¸ªæŒä¹…åŒ–çš„ç”¨æˆ·è®¾ç½®è¿è¡ŒæŸç§ç±»å‹çš„æ•°æ®è½¬æ¢å®ç”¨ç¨‹åºï¼ˆæå…¶åºå¤§çš„ä»»åŠ¡ï¼‰ï¼Œå¦åˆ™ä»¥åä¼¼ä¹åªèƒ½ä¸€ç›´ç”¨Hashtable ä½œä¸ºåº”ç”¨ç¨‹åºçš„å­˜å‚¨æ ¼å¼ã€‚</p>\n<p>å›¢é˜Ÿæ„Ÿåˆ°é™·å…¥åƒµå±€ï¼Œä½†è¿™åªæ˜¯å› ä¸ºä»–ä»¬ä¸çŸ¥é“å…³äº Java åºåˆ—åŒ–çš„ä¸€ä¸ªé‡è¦äº‹å®ï¼šJava åºåˆ—åŒ–å…è®¸éšç€æ—¶é—´çš„æ¨ç§»è€Œæ”¹å˜ç±»å‹ã€‚å½“æˆ‘å‘ä»–ä»¬å±•ç¤ºå¦‚ä½•è‡ªåŠ¨è¿›è¡Œåºåˆ—åŒ–æ›¿æ¢åï¼Œä»–ä»¬ç»ˆäºæŒ‰è®¡åˆ’å®Œæˆäº†å‘ HashMap çš„è½¬å˜ã€‚</p>\n<p>æœ¬æ–‡æ˜¯æœ¬ç³»åˆ—çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œè¿™ä¸ªç³»åˆ—ä¸“é—¨æ­ç¤ºå…³äº Java å¹³å°çš„ä¸€äº›æœ‰ç”¨çš„å°çŸ¥è¯† â€” è¿™äº›å°çŸ¥è¯†ä¸æ˜“ç†è§£ï¼Œä½†å¯¹äºè§£å†³ Java ç¼–ç¨‹æŒ‘æˆ˜è¿Ÿæ—©æœ‰ç”¨ã€‚</p>\n<p>å°† Java å¯¹è±¡åºåˆ—åŒ– API ä½œä¸ºå¼€ç«¯æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œå› ä¸ºå®ƒä»ä¸€å¼€å§‹å°±å­˜åœ¨äº JDK 1.1 ä¸­ã€‚æœ¬æ–‡ä»‹ç»çš„å…³äºåºåˆ—åŒ–çš„ 5 ä»¶äº‹æƒ…å°†è¯´æœæ‚¨é‡æ–°å®¡è§†é‚£äº›æ ‡å‡† Java APIã€‚</p>\n<h3 id=\"Java-åºåˆ—åŒ–ç®€ä»‹\"><a href=\"#Java-åºåˆ—åŒ–ç®€ä»‹\" class=\"headerlink\" title=\"Java åºåˆ—åŒ–ç®€ä»‹\"></a>Java åºåˆ—åŒ–ç®€ä»‹</h3><p>Java å¯¹è±¡åºåˆ—åŒ–æ˜¯ JDK 1.1 ä¸­å¼•å…¥çš„ä¸€ç»„å¼€åˆ›æ€§ç‰¹æ€§ä¹‹ä¸€ï¼Œç”¨äºä½œä¸ºä¸€ç§å°† Java å¯¹è±¡çš„çŠ¶æ€è½¬æ¢ä¸ºå­—èŠ‚æ•°ç»„ï¼Œä»¥ä¾¿å­˜å‚¨æˆ–ä¼ è¾“çš„æœºåˆ¶ï¼Œä»¥åï¼Œä»å¯ä»¥å°†å­—èŠ‚æ•°ç»„è½¬æ¢å› Java å¯¹è±¡åŸæœ‰çš„çŠ¶æ€ã€‚</p>\n<p>å®é™…ä¸Šï¼Œåºåˆ—åŒ–çš„æ€æƒ³æ˜¯ â€œå†»ç»“â€ å¯¹è±¡çŠ¶æ€ï¼Œä¼ è¾“å¯¹è±¡çŠ¶æ€ï¼ˆå†™åˆ°ç£ç›˜ã€é€šè¿‡ç½‘ç»œä¼ è¾“ç­‰ç­‰ï¼‰ï¼Œç„¶å â€œè§£å†»â€ çŠ¶æ€ï¼Œé‡æ–°è·å¾—å¯ç”¨çš„ Java å¯¹è±¡ã€‚æ‰€æœ‰è¿™äº›äº‹æƒ…çš„å‘ç”Ÿæœ‰ç‚¹åƒæ˜¯é­”æœ¯ï¼Œè¿™è¦å½’åŠŸäº ObjectInputStream&#x2F;ObjectOutputStream ç±»ã€å®Œå…¨ä¿çœŸçš„å…ƒæ•°æ®ä»¥åŠç¨‹åºå‘˜æ„¿æ„ç”¨Serializable æ ‡è¯†æ¥å£æ ‡è®°ä»–ä»¬çš„ç±»ï¼Œä»è€Œ â€œå‚ä¸â€ è¿™ä¸ªè¿‡ç¨‹ã€‚</p>\n<p>æ¸…å• 1 æ˜¾ç¤ºä¸€ä¸ªå®ç° Serializable çš„ Person ç±»ã€‚</p>\n<p><strong>æ¸…å• 1. Serializable Person</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">package com.tedneward;\n\npublic class Person\n    implements java.io.Serializable\n&#123;\n    public Person(String fn, String ln, int a)\n    &#123;\n        this.firstName &#x3D; fn; this.lastName &#x3D; ln; this.age &#x3D; a;\n    &#125;\n\n    public String getFirstName() &#123; return firstName; &#125;\n    public String getLastName() &#123; return lastName; &#125;\n    public int getAge() &#123; return age; &#125;\n    public Person getSpouse() &#123; return spouse; &#125;\n\n    public void setFirstName(String value) &#123; firstName &#x3D; value; &#125;\n    public void setLastName(String value) &#123; lastName &#x3D; value; &#125;\n    public void setAge(int value) &#123; age &#x3D; value; &#125;\n    public void setSpouse(Person value) &#123; spouse &#x3D; value; &#125;\n\n    public String toString()\n    &#123;\n        return &quot;[Person: firstName&#x3D;&quot; + firstName + \n            &quot; lastName&#x3D;&quot; + lastName +\n            &quot; age&#x3D;&quot; + age +\n            &quot; spouse&#x3D;&quot; + spouse.getFirstName() +\n            &quot;]&quot;;\n    &#125;    \n\n    private String firstName;\n    private String lastName;\n    private int age;\n    private Person spouse;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å°† Person åºåˆ—åŒ–åï¼Œå¾ˆå®¹æ˜“å°†å¯¹è±¡çŠ¶æ€å†™åˆ°ç£ç›˜ï¼Œç„¶åé‡æ–°è¯»å‡ºå®ƒï¼Œä¸‹é¢çš„ JUnit 4 å•å…ƒæµ‹è¯•å¯¹æ­¤åšäº†æ¼”ç¤ºã€‚</p>\n<p><strong>æ¸…å• 2. å¯¹ Person è¿›è¡Œååºåˆ—åŒ–</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class SerTest\n&#123;\n    @Test public void serializeToDisk()\n    &#123;\n        try\n        &#123;\n            com.tedneward.Person ted &#x3D; new com.tedneward.Person(&quot;Ted&quot;, &quot;Neward&quot;, 39);\n            com.tedneward.Person charl &#x3D; new com.tedneward.Person(&quot;Charlotte&quot;,\n                &quot;Neward&quot;, 38);\n\n            ted.setSpouse(charl); charl.setSpouse(ted);\n\n            FileOutputStream fos &#x3D; new FileOutputStream(&quot;tempdata.ser&quot;);\n            ObjectOutputStream oos &#x3D; new ObjectOutputStream(fos);\n            oos.writeObject(ted);\n            oos.close();\n        &#125;\n        catch (Exception ex)\n        &#123;\n            fail(&quot;Exception thrown during test: &quot; + ex.toString());\n        &#125;\n\n        try\n        &#123;\n            FileInputStream fis &#x3D; new FileInputStream(&quot;tempdata.ser&quot;);\n            ObjectInputStream ois &#x3D; new ObjectInputStream(fis);\n            com.tedneward.Person ted &#x3D; (com.tedneward.Person) ois.readObject();\n            ois.close();\n\n            assertEquals(ted.getFirstName(ï¼‰ï¼Œ &quot;Ted&quot;);\n            assertEquals(ted.getSpouse().getFirstName(ï¼‰ï¼Œ &quot;Charlotte&quot;);\n\n            &#x2F;&#x2F; Clean up the file\n            new File(&quot;tempdata.ser&quot;).delete();\n        &#125;\n        catch (Exception ex)\n        &#123;\n            fail(&quot;Exception thrown during test: &quot; + ex.toString());\n        &#125;\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>åˆ°ç°åœ¨ä¸ºæ­¢ï¼Œè¿˜æ²¡æœ‰çœ‹åˆ°ä»€ä¹ˆæ–°é²œçš„æˆ–ä»¤äººå…´å¥‹çš„äº‹æƒ…ï¼Œä½†æ˜¯è¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å‡ºå‘ç‚¹ã€‚æˆ‘ä»¬å°†ä½¿ç”¨ Person æ¥å‘ç°æ‚¨å¯èƒ½ä¸ çŸ¥é“çš„å…³äº Java å¯¹è±¡åºåˆ—åŒ– çš„ 5 ä»¶äº‹ã€‚</p>\n<h4 id=\"1-åºåˆ—åŒ–å…è®¸é‡æ„\"><a href=\"#1-åºåˆ—åŒ–å…è®¸é‡æ„\" class=\"headerlink\" title=\"1. åºåˆ—åŒ–å…è®¸é‡æ„\"></a>1. åºåˆ—åŒ–å…è®¸é‡æ„</h4><p>åºåˆ—åŒ–å…è®¸ä¸€å®šæ•°é‡çš„ç±»å˜ç§ï¼Œç”šè‡³é‡æ„ä¹‹åä¹Ÿæ˜¯å¦‚æ­¤ï¼ŒObjectInputStream ä»å¯ä»¥å¾ˆå¥½åœ°å°†å…¶è¯»å‡ºæ¥ã€‚<br>Java Object Serialization è§„èŒƒå¯ä»¥è‡ªåŠ¨ç®¡ç†çš„å…³é”®ä»»åŠ¡æ˜¯ï¼š</p>\n<ul>\n<li><p>å°†æ–°å­—æ®µæ·»åŠ åˆ°ç±»ä¸­</p>\n</li>\n<li><p>å°†å­—æ®µä» static æ”¹ä¸ºé static</p>\n</li>\n<li><p>å°†å­—æ®µä» transient æ”¹ä¸ºé transient</p>\n</li>\n</ul>\n<p>å–å†³äºæ‰€éœ€çš„å‘åå…¼å®¹ç¨‹åº¦ï¼Œè½¬æ¢å­—æ®µå½¢å¼ï¼ˆä»é static è½¬æ¢ä¸º static æˆ–ä»é transient è½¬æ¢ä¸º transientï¼‰æˆ–è€…åˆ é™¤å­—æ®µéœ€è¦é¢å¤–çš„æ¶ˆæ¯ä¼ é€’ã€‚</p>\n<p><strong>é‡æ„åºåˆ—åŒ–ç±»</strong></p>\n<p>æ—¢ç„¶å·²ç»çŸ¥é“åºåˆ—åŒ–å…è®¸é‡æ„ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹å½“æŠŠæ–°å­—æ®µæ·»åŠ åˆ° Person ç±»ä¸­æ—¶ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆäº‹æƒ…ã€‚</p>\n<p>å¦‚æ¸…å• 3 æ‰€ç¤ºï¼ŒPersonV2 åœ¨åŸå…ˆ Person ç±»çš„åŸºç¡€ä¸Šå¼•å…¥ä¸€ä¸ªè¡¨ç¤ºæ€§åˆ«çš„æ–°å­—æ®µã€‚</p>\n<p><strong>æ¸…å• 3. å°†æ–°å­—æ®µæ·»åŠ åˆ°åºåˆ—åŒ–çš„ Person ä¸­</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">enum Gender\n&#123;\n    MALE, FEMALE\n&#125;\n\npublic class Person\n    implements java.io.Serializable\n&#123;\n    public Person(String fn, String ln, int a, Gender g)\n    &#123;\n        this.firstName &#x3D; fn; this.lastName &#x3D; ln; this.age &#x3D; a; this.gender &#x3D; g;\n    &#125;\n\n    public String getFirstName() &#123; return firstName; &#125;\n    public String getLastName() &#123; return lastName; &#125;\n    public Gender getGender() &#123; return gender; &#125;\n    public int getAge() &#123; return age; &#125;\n    public Person getSpouse() &#123; return spouse; &#125;\n\n    public void setFirstName(String value) &#123; firstName &#x3D; value; &#125;\n    public void setLastName(String value) &#123; lastName &#x3D; value; &#125;\n    public void setGender(Gender value) &#123; gender &#x3D; value; &#125;\n    public void setAge(int value) &#123; age &#x3D; value; &#125;\n    public void setSpouse(Person value) &#123; spouse &#x3D; value; &#125;\n\n    public String toString()\n    &#123;\n        return &quot;[Person: firstName&#x3D;&quot; + firstName + \n            &quot; lastName&#x3D;&quot; + lastName +\n            &quot; gender&#x3D;&quot; + gender +\n            &quot; age&#x3D;&quot; + age +\n            &quot; spouse&#x3D;&quot; + spouse.getFirstName() +\n            &quot;]&quot;;\n    &#125;    \n\n    private String firstName;\n    private String lastName;\n    private int age;\n    private Person spouse;\n    private Gender gender;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>åºåˆ—åŒ–ä½¿ç”¨ä¸€ä¸ª hashï¼Œè¯¥ hash æ˜¯æ ¹æ®ç»™å®šæºæ–‡ä»¶ä¸­å‡ ä¹æ‰€æœ‰ä¸œè¥¿ â€” æ–¹æ³•åç§°ã€å­—æ®µåç§°ã€å­—æ®µç±»å‹ã€è®¿é—®ä¿®æ”¹æ–¹æ³•ç­‰ â€” è®¡ç®—å‡ºæ¥çš„ï¼Œåºåˆ—åŒ–å°†è¯¥ hash å€¼ä¸åºåˆ—åŒ–æµä¸­çš„ hash å€¼ç›¸æ¯”è¾ƒã€‚</p>\n<p>ä¸ºäº†ä½¿ Java è¿è¡Œæ—¶ç›¸ä¿¡ä¸¤ç§ç±»å‹å®é™…ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œç¬¬äºŒç‰ˆå’Œéšåç‰ˆæœ¬çš„ Person å¿…é¡»ä¸ç¬¬ä¸€ç‰ˆæœ‰ç›¸åŒçš„åºåˆ—åŒ–ç‰ˆæœ¬ hashï¼ˆå­˜å‚¨ä¸º private static final serialVersionUID å­—æ®µï¼‰ã€‚</p>\n<p>å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦ serialVersionUID å­—æ®µï¼Œå®ƒæ˜¯é€šè¿‡å¯¹åŸå§‹ï¼ˆæˆ– V1ï¼‰ç‰ˆæœ¬çš„ Person ç±»è¿è¡Œ JDK serialverå‘½ä»¤è®¡ç®—å‡ºçš„ã€‚</p>\n<p>ä¸€æ—¦æœ‰äº† Person çš„ serialVersionUIDï¼Œä¸ä»…å¯ä»¥ä»åŸå§‹å¯¹è±¡ Person çš„åºåˆ—åŒ–æ•°æ®åˆ›å»º PersonV2 å¯¹è±¡ï¼ˆå½“å‡ºç°æ–°å­—æ®µæ—¶ï¼Œæ–°å­—æ®µè¢«è®¾ä¸ºç¼ºçœå€¼ï¼Œæœ€å¸¸è§çš„æ˜¯â€œnullâ€ï¼‰ï¼Œè¿˜å¯ä»¥åè¿‡æ¥åšï¼šå³ä» PersonV2 çš„æ•°æ®é€šè¿‡ååºåˆ—åŒ–å¾—åˆ° Personï¼Œè¿™æ¯«ä¸å¥‡æ€ªã€‚</p>\n<h4 id=\"2-åºåˆ—åŒ–å¹¶ä¸å®‰å…¨\"><a href=\"#2-åºåˆ—åŒ–å¹¶ä¸å®‰å…¨\" class=\"headerlink\" title=\"2. åºåˆ—åŒ–å¹¶ä¸å®‰å…¨\"></a>2. åºåˆ—åŒ–å¹¶ä¸å®‰å…¨</h4><p>è®© Java å¼€å‘äººå‘˜è¯§å¼‚å¹¶æ„Ÿåˆ°ä¸å¿«çš„æ˜¯ï¼Œåºåˆ—åŒ–äºŒè¿›åˆ¶æ ¼å¼å®Œå…¨ç¼–å†™åœ¨æ–‡æ¡£ä¸­ï¼Œå¹¶ä¸”å®Œå…¨å¯é€†ã€‚å®é™…ä¸Šï¼Œåªéœ€å°†äºŒè¿›åˆ¶åºåˆ—åŒ–æµçš„å†…å®¹è½¬å‚¨åˆ°æ§åˆ¶å°ï¼Œå°±è¶³ä»¥çœ‹æ¸…ç±»æ˜¯ä»€ä¹ˆæ ·å­ï¼Œä»¥åŠå®ƒåŒ…å«ä»€ä¹ˆå†…å®¹ã€‚</p>\n<p>è¿™å¯¹äºå®‰å…¨æ€§æœ‰ç€ä¸è‰¯å½±å“ã€‚ä¾‹å¦‚ï¼Œå½“é€šè¿‡ RMI è¿›è¡Œè¿œç¨‹æ–¹æ³•è°ƒç”¨æ—¶ï¼Œé€šè¿‡è¿æ¥å‘é€çš„å¯¹è±¡ä¸­çš„ä»»ä½• private å­—æ®µå‡ ä¹éƒ½æ˜¯ä»¥æ˜æ–‡çš„æ–¹å¼å‡ºç°åœ¨å¥—æ¥å­—æµä¸­ï¼Œè¿™æ˜¾ç„¶å®¹æ˜“æ‹›è‡´å“ªæ€•æœ€ç®€å•çš„å®‰å…¨é—®é¢˜ã€‚</p>\n<p>å¹¸è¿çš„æ˜¯ï¼Œåºåˆ—åŒ–å…è®¸ â€œhookâ€ åºåˆ—åŒ–è¿‡ç¨‹ï¼Œå¹¶åœ¨åºåˆ—åŒ–ä¹‹å‰å’Œååºåˆ—åŒ–ä¹‹åä¿æŠ¤ï¼ˆæˆ–æ¨¡ç³ŠåŒ–ï¼‰å­—æ®µæ•°æ®ã€‚å¯ä»¥é€šè¿‡åœ¨ Serializable å¯¹è±¡ä¸Šæä¾›ä¸€ä¸ª writeObject æ–¹æ³•æ¥åšåˆ°è¿™ä¸€ç‚¹ã€‚</p>\n<p><strong>æ¨¡ç³ŠåŒ–åºåˆ—åŒ–æ•°æ®</strong></p>\n<p>å‡è®¾ Person ç±»ä¸­çš„æ•æ„Ÿæ•°æ®æ˜¯ age å­—æ®µã€‚æ¯•ç«Ÿï¼Œå¥³å£«å¿Œè°ˆå¹´é¾„ã€‚ æˆ‘ä»¬å¯ä»¥åœ¨åºåˆ—åŒ–ä¹‹å‰æ¨¡ç³ŠåŒ–è¯¥æ•°æ®ï¼Œå°†æ•°ä½å¾ªç¯å·¦ç§»ä¸€ä½ï¼Œç„¶ååœ¨ååºåˆ—åŒ–ä¹‹åå¤ä½ã€‚ï¼ˆæ‚¨å¯ä»¥å¼€å‘æ›´å®‰å…¨çš„ç®—æ³•ï¼Œå½“å‰è¿™ä¸ªç®—æ³•åªæ˜¯ä½œä¸ºä¸€ä¸ªä¾‹å­ã€‚ï¼‰</p>\n<p>ä¸ºäº† â€œhookâ€ åºåˆ—åŒ–è¿‡ç¨‹ï¼Œæˆ‘ä»¬å°†åœ¨ Person ä¸Šå®ç°ä¸€ä¸ª writeObject æ–¹æ³•ï¼›ä¸ºäº† â€œhookâ€ ååºåˆ—åŒ–è¿‡ç¨‹ï¼Œæˆ‘ä»¬å°†åœ¨åŒä¸€ä¸ªç±»ä¸Šå®ç°ä¸€ä¸ªreadObject æ–¹æ³•ã€‚é‡è¦çš„æ˜¯è¿™ä¸¤ä¸ªæ–¹æ³•çš„ç»†èŠ‚è¦æ­£ç¡® â€” å¦‚æœè®¿é—®ä¿®æ”¹æ–¹æ³•ã€å‚æ•°æˆ–åç§°ä¸åŒäºæ¸…å• 4 ä¸­çš„å†…å®¹ï¼Œé‚£ä¹ˆä»£ç å°†ä¸è¢«å¯Ÿè§‰åœ°å¤±è´¥ï¼ŒPerson çš„ age å°†æš´éœ²ã€‚</p>\n<p><strong>æ¸…å• 4. æ¨¡ç³ŠåŒ–åºåˆ—åŒ–æ•°æ®</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class Person\n    implements java.io.Serializable\n&#123;\n    public Person(String fn, String ln, int a)\n    &#123;\n        this.firstName &#x3D; fn; this.lastName &#x3D; ln; this.age &#x3D; a;\n    &#125;\n\n    public String getFirstName() &#123; return firstName; &#125;\n    public String getLastName() &#123; return lastName; &#125;\n    public int getAge() &#123; return age; &#125;\n    public Person getSpouse() &#123; return spouse; &#125;\n\n    public void setFirstName(String value) &#123; firstName &#x3D; value; &#125;\n    public void setLastName(String value) &#123; lastName &#x3D; value; &#125;\n    public void setAge(int value) &#123; age &#x3D; value; &#125;\n    public void setSpouse(Person value) &#123; spouse &#x3D; value; &#125;\n\n    private void writeObject(java.io.ObjectOutputStream stream)\n        throws java.io.IOException\n    &#123;\n        &#x2F;&#x2F; &quot;Encrypt&quot;&#x2F;obscure the sensitive data\n        age &#x3D; age &lt;&lt; 2;\n        stream.defaultWriteObject();\n    &#125;\n\n    private void readObject(java.io.ObjectInputStream stream)\n        throws java.io.IOException, ClassNotFoundException\n    &#123;\n        stream.defaultReadObject();\n\n        &#x2F;&#x2F; &quot;Decrypt&quot;&#x2F;de-obscure the sensitive data\n        age &#x3D; age &lt;&lt; 2;\n    &#125;\n\n    public String toString()\n    &#123;\n        return &quot;[Person: firstName&#x3D;&quot; + firstName + \n            &quot; lastName&#x3D;&quot; + lastName +\n            &quot; age&#x3D;&quot; + age +\n            &quot; spouse&#x3D;&quot; + (spouse!&#x3D;null ? spouse.getFirstName() : &quot;[null]&quot;) +\n            &quot;]&quot;;\n    &#125;      \n\n    private String firstName;\n    private String lastName;\n    private int age;\n    private Person spouse;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¦‚æœéœ€è¦æŸ¥çœ‹è¢«æ¨¡ç³ŠåŒ–çš„æ•°æ®ï¼Œæ€»æ˜¯å¯ä»¥æŸ¥çœ‹åºåˆ—åŒ–æ•°æ®æµ&#x2F;æ–‡ä»¶ã€‚è€Œä¸”ï¼Œç”±äºè¯¥æ ¼å¼è¢«å®Œå…¨æ–‡æ¡£åŒ–ï¼Œå³ä½¿ä¸èƒ½è®¿é—®ç±»æœ¬èº«ï¼Œä¹Ÿä»å¯ä»¥è¯»å–åºåˆ—åŒ–æµä¸­çš„å†…å®¹ã€‚</p>\n<h4 id=\"3-åºåˆ—åŒ–çš„æ•°æ®å¯ä»¥è¢«ç­¾åå’Œå¯†å°\"><a href=\"#3-åºåˆ—åŒ–çš„æ•°æ®å¯ä»¥è¢«ç­¾åå’Œå¯†å°\" class=\"headerlink\" title=\"3. åºåˆ—åŒ–çš„æ•°æ®å¯ä»¥è¢«ç­¾åå’Œå¯†å°\"></a>3. åºåˆ—åŒ–çš„æ•°æ®å¯ä»¥è¢«ç­¾åå’Œå¯†å°</h4><p>ä¸Šä¸€ä¸ªæŠ€å·§å‡è®¾æ‚¨æƒ³æ¨¡ç³ŠåŒ–åºåˆ—åŒ–æ•°æ®ï¼Œè€Œä¸æ˜¯å¯¹å…¶åŠ å¯†æˆ–è€…ç¡®ä¿å®ƒä¸è¢«ä¿®æ”¹ã€‚å½“ç„¶ï¼Œé€šè¿‡ä½¿ç”¨ writeObject å’Œ readObject å¯ä»¥å®ç°å¯†ç åŠ å¯†å’Œç­¾åç®¡ç†ï¼Œä½†å…¶å®è¿˜æœ‰æ›´å¥½çš„æ–¹å¼ã€‚</p>\n<p>å¦‚æœéœ€è¦å¯¹æ•´ä¸ªå¯¹è±¡è¿›è¡ŒåŠ å¯†å’Œç­¾åï¼Œæœ€ç®€å•çš„æ˜¯å°†å®ƒæ”¾åœ¨ä¸€ä¸ª javax.crypto.SealedObject å’Œ&#x2F;æˆ– java.security.SignedObject åŒ…è£…å™¨ä¸­ã€‚ä¸¤è€…éƒ½æ˜¯å¯åºåˆ—åŒ–çš„ï¼Œæ‰€ä»¥å°†å¯¹è±¡åŒ…è£…åœ¨ SealedObject ä¸­å¯ä»¥å›´ç»•åŸå¯¹è±¡åˆ›å»ºä¸€ç§â€œåŒ…è£…ç›’â€ã€‚å¿…é¡»æœ‰å¯¹ç§°å¯†é’¥æ‰èƒ½è§£å¯†ï¼Œè€Œä¸”å¯†é’¥å¿…é¡»å•ç‹¬ç®¡ç†ã€‚åŒæ ·ï¼Œä¹Ÿå¯ä»¥å°† SignedObject ç”¨äºæ•°æ®éªŒè¯ï¼Œå¹¶ä¸”å¯¹ç§°å¯†é’¥ä¹Ÿå¿…é¡»å•ç‹¬ç®¡ç†ã€‚</p>\n<p>ç»“åˆä½¿ç”¨è¿™ä¸¤ç§å¯¹è±¡ï¼Œä¾¿å¯ä»¥è½»æ¾åœ°å¯¹åºåˆ—åŒ–æ•°æ®è¿›è¡Œå¯†å°å’Œç­¾åï¼Œè€Œä¸å¿…å¼ºè°ƒå…³äºæ•°å­—ç­¾åéªŒè¯æˆ–åŠ å¯†çš„ç»†èŠ‚ã€‚å¾ˆç®€æ´ï¼Œæ˜¯å§ï¼Ÿ</p>\n<h4 id=\"4-åºåˆ—åŒ–å…è®¸å°†ä»£ç†æ”¾åœ¨æµä¸­\"><a href=\"#4-åºåˆ—åŒ–å…è®¸å°†ä»£ç†æ”¾åœ¨æµä¸­\" class=\"headerlink\" title=\"4. åºåˆ—åŒ–å…è®¸å°†ä»£ç†æ”¾åœ¨æµä¸­\"></a>4. åºåˆ—åŒ–å…è®¸å°†ä»£ç†æ”¾åœ¨æµä¸­</h4><p>å¾ˆå¤šæƒ…å†µä¸‹ï¼Œç±»ä¸­åŒ…å«ä¸€ä¸ªæ ¸å¿ƒæ•°æ®å…ƒç´ ï¼Œé€šè¿‡å®ƒå¯ä»¥æ´¾ç”Ÿæˆ–æ‰¾åˆ°ç±»ä¸­çš„å…¶ä»–å­—æ®µã€‚åœ¨æ­¤æƒ…å†µä¸‹ï¼Œæ²¡æœ‰å¿…è¦åºåˆ—åŒ–æ•´ä¸ªå¯¹è±¡ã€‚å¯ä»¥å°†å­—æ®µæ ‡è®°ä¸º transientï¼Œä½†æ˜¯æ¯å½“æœ‰æ–¹æ³•è®¿é—®ä¸€ä¸ªå­—æ®µæ—¶ï¼Œç±»ä»ç„¶å¿…é¡»æ˜¾å¼åœ°äº§ç”Ÿä»£ç æ¥æ£€æŸ¥å®ƒæ˜¯å¦è¢«åˆå§‹åŒ–ã€‚</p>\n<p>å¦‚æœé¦–è¦é—®é¢˜æ˜¯åºåˆ—åŒ–ï¼Œé‚£ä¹ˆæœ€å¥½æŒ‡å®šä¸€ä¸ª flyweight æˆ–ä»£ç†æ”¾åœ¨æµä¸­ã€‚ä¸ºåŸå§‹ Person æä¾›ä¸€ä¸ª writeReplace æ–¹æ³•ï¼Œå¯ä»¥åºåˆ—åŒ–ä¸åŒç±»å‹çš„å¯¹è±¡æ¥ä»£æ›¿å®ƒã€‚ç±»ä¼¼åœ°ï¼Œå¦‚æœååºåˆ—åŒ–æœŸé—´å‘ç°ä¸€ä¸ª readResolve æ–¹æ³•ï¼Œé‚£ä¹ˆå°†è°ƒç”¨è¯¥æ–¹æ³•ï¼Œå°†æ›¿ä»£å¯¹è±¡æä¾›ç»™è°ƒç”¨è€…ã€‚</p>\n<p><strong>æ‰“åŒ…å’Œè§£åŒ…ä»£ç†</strong></p>\n<p>writeReplace å’Œ readResolve æ–¹æ³•ä½¿ Person ç±»å¯ä»¥å°†å®ƒçš„æ‰€æœ‰æ•°æ®ï¼ˆæˆ–å…¶ä¸­çš„æ ¸å¿ƒæ•°æ®ï¼‰æ‰“åŒ…åˆ°ä¸€ä¸ª PersonProxy ä¸­ï¼Œå°†å®ƒæ”¾å…¥åˆ°ä¸€ä¸ªæµä¸­ï¼Œç„¶ååœ¨ååºåˆ—åŒ–æ—¶å†è¿›è¡Œè§£åŒ…ã€‚</p>\n<p><strong>æ¸…å• 5. ä½ å®Œæ•´äº†æˆ‘ï¼Œæˆ‘ä»£æ›¿äº†ä½ </strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">class PersonProxy\n    implements java.io.Serializable\n&#123;\n    public PersonProxy(Person orig)\n    &#123;\n        data &#x3D; orig.getFirstName() + &quot;,&quot; + orig.getLastName() + &quot;,&quot; + orig.getAge();\n        if (orig.getSpouse() !&#x3D; null)\n        &#123;\n            Person spouse &#x3D; orig.getSpouse();\n            data &#x3D; data + &quot;,&quot; + spouse.getFirstName() + &quot;,&quot; + spouse.getLastName() + &quot;,&quot;  \n              + spouse.getAge();\n        &#125;\n    &#125;\n\n    public String data;\n    private Object readResolve()\n        throws java.io.ObjectStreamException\n    &#123;\n        String[] pieces &#x3D; data.split(&quot;,&quot;);\n        Person result &#x3D; new Person(pieces[0], pieces[1], Integer.parseInt(pieces[2]));\n        if (pieces.length &gt; 3)\n        &#123;\n            result.setSpouse(new Person(pieces[3], pieces[4], Integer.parseInt\n              (pieces[5])));\n            result.getSpouse().setSpouse(result);\n        &#125;\n        return result;\n    &#125;\n&#125;\n\npublic class Person\n    implements java.io.Serializable\n&#123;\n    public Person(String fn, String ln, int a)\n    &#123;\n        this.firstName &#x3D; fn; this.lastName &#x3D; ln; this.age &#x3D; a;\n    &#125;\n\n    public String getFirstName() &#123; return firstName; &#125;\n    public String getLastName() &#123; return lastName; &#125;\n    public int getAge() &#123; return age; &#125;\n    public Person getSpouse() &#123; return spouse; &#125;\n\n    private Object writeReplace()\n        throws java.io.ObjectStreamException\n    &#123;\n        return new PersonProxy(this);\n    &#125;\n\n    public void setFirstName(String value) &#123; firstName &#x3D; value; &#125;\n    public void setLastName(String value) &#123; lastName &#x3D; value; &#125;\n    public void setAge(int value) &#123; age &#x3D; value; &#125;\n    public void setSpouse(Person value) &#123; spouse &#x3D; value; &#125;   \n\n    public String toString()\n    &#123;\n        return &quot;[Person: firstName&#x3D;&quot; + firstName + \n            &quot; lastName&#x3D;&quot; + lastName +\n            &quot; age&#x3D;&quot; + age +\n            &quot; spouse&#x3D;&quot; + spouse.getFirstName() +\n            &quot;]&quot;;\n    &#125;    \n\n    private String firstName;\n    private String lastName;\n    private int age;\n    private Person spouse;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ³¨æ„ï¼ŒPersonProxy å¿…é¡»è·Ÿè¸ª Person çš„æ‰€æœ‰æ•°æ®ã€‚è¿™é€šå¸¸æ„å‘³ç€ä»£ç†éœ€è¦æ˜¯ Person çš„ä¸€ä¸ªå†…éƒ¨ç±»ï¼Œä»¥ä¾¿èƒ½è®¿é—® private å­—æ®µã€‚æœ‰æ—¶å€™ï¼Œä»£ç†è¿˜éœ€è¦è¿½è¸ªå…¶ä»–å¯¹è±¡å¼•ç”¨å¹¶æ‰‹åŠ¨åºåˆ—åŒ–å®ƒä»¬ï¼Œä¾‹å¦‚ Person çš„ spouseã€‚</p>\n<p>è¿™ç§æŠ€å·§æ˜¯å°‘æ•°å‡ ç§ä¸éœ€è¦è¯»&#x2F;å†™å¹³è¡¡çš„æŠ€å·§ä¹‹ä¸€ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªç±»è¢«é‡æ„æˆå¦ä¸€ç§ç±»å‹åçš„ç‰ˆæœ¬å¯ä»¥æä¾›ä¸€ä¸ª readResolve æ–¹æ³•ï¼Œä»¥ä¾¿é™é»˜åœ°å°†è¢«åºåˆ—åŒ–çš„å¯¹è±¡è½¬æ¢æˆæ–°ç±»å‹ã€‚ç±»ä¼¼åœ°ï¼Œå®ƒå¯ä»¥é‡‡ç”¨ writeReplace æ–¹æ³•å°†æ—§ç±»åºåˆ—åŒ–æˆæ–°ç‰ˆæœ¬ã€‚</p>\n<h4 id=\"5-ä¿¡ä»»ï¼Œä½†è¦éªŒè¯\"><a href=\"#5-ä¿¡ä»»ï¼Œä½†è¦éªŒè¯\" class=\"headerlink\" title=\"5. ä¿¡ä»»ï¼Œä½†è¦éªŒè¯\"></a>5. ä¿¡ä»»ï¼Œä½†è¦éªŒè¯</h4><p>è®¤ä¸ºåºåˆ—åŒ–æµä¸­çš„æ•°æ®æ€»æ˜¯ä¸æœ€åˆå†™åˆ°æµä¸­çš„æ•°æ®ä¸€è‡´ï¼Œè¿™æ²¡æœ‰é—®é¢˜ã€‚ä½†æ˜¯ï¼Œæ­£å¦‚ä¸€ä½ç¾å›½å‰æ€»ç»Ÿæ‰€è¯´çš„ï¼Œâ€œä¿¡ä»»ï¼Œä½†è¦éªŒè¯â€ã€‚<br>å¯¹äºåºåˆ—åŒ–çš„å¯¹è±¡ï¼Œè¿™æ„å‘³ç€éªŒè¯å­—æ®µï¼Œä»¥ç¡®ä¿åœ¨ååºåˆ—åŒ–ä¹‹åå®ƒä»¬ä»å…·æœ‰æ­£ç¡®çš„å€¼ï¼Œâ€œä»¥é˜²ä¸‡ä¸€â€ã€‚</p>\n<p>ä¸ºæ­¤ï¼Œå¯ä»¥å®ç° ObjectInputValidationæ¥å£ï¼Œå¹¶è¦†ç›– validateObject() æ–¹æ³•ã€‚å¦‚æœè°ƒç”¨è¯¥æ–¹æ³•æ—¶å‘ç°æŸå¤„æœ‰é”™è¯¯ï¼Œåˆ™æŠ›å‡ºä¸€ä¸ª InvalidObjectExceptionã€‚</p>\n<h3 id=\"ç»“æŸè¯­\"><a href=\"#ç»“æŸè¯­\" class=\"headerlink\" title=\"ç»“æŸè¯­\"></a>ç»“æŸè¯­</h3><p>Java å¯¹è±¡åºåˆ—åŒ–æ¯”å¤§å¤šæ•° Java å¼€å‘äººå‘˜æƒ³è±¡çš„æ›´çµæ´»ï¼Œè¿™ä½¿æˆ‘ä»¬æœ‰æ›´å¤šçš„æœºä¼šè§£å†³æ£˜æ‰‹çš„æƒ…å†µã€‚</p>\n<p>å¹¸è¿çš„æ˜¯ï¼Œåƒè¿™æ ·çš„ç¼–ç¨‹å¦™æ‹›åœ¨ JVM ä¸­éšå¤„å¯è§ã€‚å…³é”®æ˜¯è¦çŸ¥é“å®ƒä»¬ï¼Œåœ¨é‡åˆ°éš¾é¢˜çš„æ—¶å€™èƒ½ç”¨ä¸Šå®ƒä»¬ã€‚</p>\n<p>æ¥æºï¼š<a href=\"http://www.topthink.com/topic/11361.html\">www.topthink.com/topic/11361.html</a></p>\n"},{"title":"å…³äºJavaåºåˆ—åŒ–ä½ åº”è¯¥çŸ¥é“çš„ä¸€åˆ‡","date":"2025-10-14T06:42:34.000Z","_content":"\n## ä»€ä¹ˆæ˜¯åºåˆ—åŒ–\n\næˆ‘ä»¬çš„å¯¹è±¡å¹¶ä¸åªæ˜¯å­˜åœ¨å†…å­˜ä¸­ï¼Œè¿˜éœ€è¦ä¼ è¾“ç½‘ç»œï¼Œæˆ–è€…ä¿å­˜èµ·æ¥ä¸‹æ¬¡å†åŠ è½½å‡ºæ¥ç”¨ï¼Œæ‰€ä»¥éœ€è¦Javaåºåˆ—åŒ–æŠ€æœ¯ã€‚\n\nJavaåºåˆ—åŒ–æŠ€æœ¯æ­£æ˜¯å°†å¯¹è±¡è½¬å˜æˆä¸€ä¸²ç”±äºŒè¿›åˆ¶å­—èŠ‚ç»„æˆçš„æ•°ç»„ï¼Œå¯ä»¥é€šè¿‡å°†äºŒè¿›åˆ¶æ•°æ®ä¿å­˜åˆ°ç£ç›˜æˆ–è€…ä¼ è¾“ç½‘ç»œï¼Œç£ç›˜æˆ–è€…ç½‘ç»œæ¥æ”¶è€…å¯ä»¥åœ¨å¯¹è±¡çš„å±ç±»çš„æ¨¡æ¿ä¸Šæ¥ååºåˆ—åŒ–ç±»çš„å¯¹è±¡ï¼Œè¾¾åˆ°å¯¹è±¡æŒä¹…åŒ–çš„ç›®çš„ã€‚\n\n## æ€ä¹ˆåºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Ÿ\n\nè¦åºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ‰€åœ¨ç±»å°±å¿…é¡»å®ç°Javaåºåˆ—åŒ–çš„æ¥å£ï¼šjava.io.Serializableã€‚\n\n##### 1ã€ç±»æ·»åŠ åºåˆ—åŒ–æ¥å£\n```\nimport java.io.Serializable;\n\npublic class User implements Serializable{\n\n    private static final long serialVersionUID = -8475669200846811112L;\n\n    private String username;\n    private String address;\n\n    public String getUsername() {\n        return username;\n    }\n\n    public void setUsername(String username) {\n        this.username = username;\n    }\n\n    public String getAddress() {\n        return address;\n    }\n\n    public void setAddress(String address) {\n        this.address = address;\n    }\n\n    @Override\n    public String toString() {\n        return \"User{\" +\n                \"username='\" + username + '\\'' +\n                \", address='\" + address + '\\'' +\n                '}';\n    }\n    \n}\n```\n\n##### 2ã€åºåˆ—åŒ–/ååºåˆ—åŒ–\n\nå¯ä»¥å€ŸåŠ©commons-lang3å·¥å…·åŒ…é‡Œé¢çš„ç±»å®ç°å¯¹è±¡çš„åºåˆ—åŒ–åŠååºåˆ—åŒ–ï¼Œä½ æ²¡æœ‰å¿…è¦è‡ªå·±å†™ã€‚\n\n```\nimport org.apache.commons.lang3.SerializationUtils;\n\npublic class Test {\n\n    public static void main(String[] args) {\n        User user = new User();\n        user.setUsername(\"Java\");\n        user.setAddress(\"China\");\n        byte[] bytes = SerializationUtils.serialize(user);\n\n        User u = SerializationUtils.deserialize(bytes);\n        System.out.println(u);\n\n    }\n\n}\n```\nè¾“å‡ºï¼š\n```\nUser{username='Java', address='China'}\n```\nä¸Šä¾‹é€šè¿‡åºåˆ—åŒ–å¯¹è±¡å­—èŠ‚åˆ°å†…å­˜ç„¶åååºåˆ—åŒ–ï¼Œå½“ç„¶é‡Œé¢ä¹Ÿæä¾›äº†åºåˆ—åŒ–ç£ç›˜ç„¶åå†ååºåˆ—åŒ–çš„æ–¹æ³•ï¼ŒåŸç†éƒ½æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯ç›®æ ‡åœ°ä¸ä¸€æ ·ã€‚\n\n## åºåˆ—åŒ–æ³¨æ„äº‹é¡¹\n\n- åºåˆ—åŒ–å¯¹è±¡å¿…é¡»å®ç°åºåˆ—åŒ–æ¥å£ã€‚\n\n- åºåˆ—åŒ–å¯¹è±¡é‡Œé¢çš„å±æ€§æ˜¯å¯¹è±¡çš„è¯ä¹Ÿè¦å®ç°åºåˆ—åŒ–æ¥å£ã€‚\n\n- ç±»çš„å¯¹è±¡åºåˆ—åŒ–åï¼Œç±»çš„åºåˆ—åŒ–IDä¸èƒ½è½»æ˜“ä¿®æ”¹ï¼Œä¸ç„¶ååºåˆ—åŒ–ä¼šå¤±è´¥ã€‚\n\n- ç±»çš„å¯¹è±¡åºåˆ—åŒ–åï¼Œç±»çš„å±æ€§æœ‰å¢åŠ æˆ–è€…åˆ é™¤ä¸ä¼šå½±å“åºåˆ—åŒ–ï¼Œåªæ˜¯å€¼ä¼šä¸¢å¤±ã€‚\n\n- å¦‚æœçˆ¶ç±»åºåˆ—åŒ–äº†ï¼Œå­ç±»ä¼šç»§æ‰¿çˆ¶ç±»çš„åºåˆ—åŒ–ï¼Œå­ç±»æ— éœ€æ·»åŠ åºåˆ—åŒ–æ¥å£ã€‚\n\n- å¦‚æœçˆ¶ç±»æ²¡æœ‰åºåˆ—åŒ–ï¼Œå­ç±»åºåˆ—åŒ–äº†ï¼Œå­ç±»ä¸­çš„å±æ€§èƒ½æ­£å¸¸åºåˆ—åŒ–ï¼Œä½†çˆ¶ç±»çš„å±æ€§ä¼šä¸¢å¤±ï¼Œä¸èƒ½åºåˆ—åŒ–ã€‚\n\n- ç”¨Javaåºåˆ—åŒ–çš„äºŒè¿›åˆ¶å­—èŠ‚æ•°æ®åªèƒ½ç”±Javaååºåˆ—åŒ–ï¼Œä¸èƒ½è¢«å…¶ä»–è¯­è¨€ååºåˆ—åŒ–ã€‚å¦‚æœè¦è¿›è¡Œå‰åç«¯æˆ–è€…ä¸åŒè¯­è¨€ä¹‹é—´çš„äº¤äº’ä¸€èˆ¬éœ€è¦å°†å¯¹è±¡è½¬å˜æˆJson/Xmlé€šç”¨æ ¼å¼çš„æ•°æ®ï¼Œå†æ¢å¤åŸæ¥çš„å¯¹è±¡ã€‚\n\n","source":"_posts/åŸºç¡€/å…³äºJavaåºåˆ—åŒ–ä½ åº”è¯¥çŸ¥é“çš„ä¸€åˆ‡.md","raw":"---\ntitle: å…³äºJavaåºåˆ—åŒ–ä½ åº”è¯¥çŸ¥é“çš„ä¸€åˆ‡\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: åŸºç¡€\n---\n\n## ä»€ä¹ˆæ˜¯åºåˆ—åŒ–\n\næˆ‘ä»¬çš„å¯¹è±¡å¹¶ä¸åªæ˜¯å­˜åœ¨å†…å­˜ä¸­ï¼Œè¿˜éœ€è¦ä¼ è¾“ç½‘ç»œï¼Œæˆ–è€…ä¿å­˜èµ·æ¥ä¸‹æ¬¡å†åŠ è½½å‡ºæ¥ç”¨ï¼Œæ‰€ä»¥éœ€è¦Javaåºåˆ—åŒ–æŠ€æœ¯ã€‚\n\nJavaåºåˆ—åŒ–æŠ€æœ¯æ­£æ˜¯å°†å¯¹è±¡è½¬å˜æˆä¸€ä¸²ç”±äºŒè¿›åˆ¶å­—èŠ‚ç»„æˆçš„æ•°ç»„ï¼Œå¯ä»¥é€šè¿‡å°†äºŒè¿›åˆ¶æ•°æ®ä¿å­˜åˆ°ç£ç›˜æˆ–è€…ä¼ è¾“ç½‘ç»œï¼Œç£ç›˜æˆ–è€…ç½‘ç»œæ¥æ”¶è€…å¯ä»¥åœ¨å¯¹è±¡çš„å±ç±»çš„æ¨¡æ¿ä¸Šæ¥ååºåˆ—åŒ–ç±»çš„å¯¹è±¡ï¼Œè¾¾åˆ°å¯¹è±¡æŒä¹…åŒ–çš„ç›®çš„ã€‚\n\n## æ€ä¹ˆåºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Ÿ\n\nè¦åºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ‰€åœ¨ç±»å°±å¿…é¡»å®ç°Javaåºåˆ—åŒ–çš„æ¥å£ï¼šjava.io.Serializableã€‚\n\n##### 1ã€ç±»æ·»åŠ åºåˆ—åŒ–æ¥å£\n```\nimport java.io.Serializable;\n\npublic class User implements Serializable{\n\n    private static final long serialVersionUID = -8475669200846811112L;\n\n    private String username;\n    private String address;\n\n    public String getUsername() {\n        return username;\n    }\n\n    public void setUsername(String username) {\n        this.username = username;\n    }\n\n    public String getAddress() {\n        return address;\n    }\n\n    public void setAddress(String address) {\n        this.address = address;\n    }\n\n    @Override\n    public String toString() {\n        return \"User{\" +\n                \"username='\" + username + '\\'' +\n                \", address='\" + address + '\\'' +\n                '}';\n    }\n    \n}\n```\n\n##### 2ã€åºåˆ—åŒ–/ååºåˆ—åŒ–\n\nå¯ä»¥å€ŸåŠ©commons-lang3å·¥å…·åŒ…é‡Œé¢çš„ç±»å®ç°å¯¹è±¡çš„åºåˆ—åŒ–åŠååºåˆ—åŒ–ï¼Œä½ æ²¡æœ‰å¿…è¦è‡ªå·±å†™ã€‚\n\n```\nimport org.apache.commons.lang3.SerializationUtils;\n\npublic class Test {\n\n    public static void main(String[] args) {\n        User user = new User();\n        user.setUsername(\"Java\");\n        user.setAddress(\"China\");\n        byte[] bytes = SerializationUtils.serialize(user);\n\n        User u = SerializationUtils.deserialize(bytes);\n        System.out.println(u);\n\n    }\n\n}\n```\nè¾“å‡ºï¼š\n```\nUser{username='Java', address='China'}\n```\nä¸Šä¾‹é€šè¿‡åºåˆ—åŒ–å¯¹è±¡å­—èŠ‚åˆ°å†…å­˜ç„¶åååºåˆ—åŒ–ï¼Œå½“ç„¶é‡Œé¢ä¹Ÿæä¾›äº†åºåˆ—åŒ–ç£ç›˜ç„¶åå†ååºåˆ—åŒ–çš„æ–¹æ³•ï¼ŒåŸç†éƒ½æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯ç›®æ ‡åœ°ä¸ä¸€æ ·ã€‚\n\n## åºåˆ—åŒ–æ³¨æ„äº‹é¡¹\n\n- åºåˆ—åŒ–å¯¹è±¡å¿…é¡»å®ç°åºåˆ—åŒ–æ¥å£ã€‚\n\n- åºåˆ—åŒ–å¯¹è±¡é‡Œé¢çš„å±æ€§æ˜¯å¯¹è±¡çš„è¯ä¹Ÿè¦å®ç°åºåˆ—åŒ–æ¥å£ã€‚\n\n- ç±»çš„å¯¹è±¡åºåˆ—åŒ–åï¼Œç±»çš„åºåˆ—åŒ–IDä¸èƒ½è½»æ˜“ä¿®æ”¹ï¼Œä¸ç„¶ååºåˆ—åŒ–ä¼šå¤±è´¥ã€‚\n\n- ç±»çš„å¯¹è±¡åºåˆ—åŒ–åï¼Œç±»çš„å±æ€§æœ‰å¢åŠ æˆ–è€…åˆ é™¤ä¸ä¼šå½±å“åºåˆ—åŒ–ï¼Œåªæ˜¯å€¼ä¼šä¸¢å¤±ã€‚\n\n- å¦‚æœçˆ¶ç±»åºåˆ—åŒ–äº†ï¼Œå­ç±»ä¼šç»§æ‰¿çˆ¶ç±»çš„åºåˆ—åŒ–ï¼Œå­ç±»æ— éœ€æ·»åŠ åºåˆ—åŒ–æ¥å£ã€‚\n\n- å¦‚æœçˆ¶ç±»æ²¡æœ‰åºåˆ—åŒ–ï¼Œå­ç±»åºåˆ—åŒ–äº†ï¼Œå­ç±»ä¸­çš„å±æ€§èƒ½æ­£å¸¸åºåˆ—åŒ–ï¼Œä½†çˆ¶ç±»çš„å±æ€§ä¼šä¸¢å¤±ï¼Œä¸èƒ½åºåˆ—åŒ–ã€‚\n\n- ç”¨Javaåºåˆ—åŒ–çš„äºŒè¿›åˆ¶å­—èŠ‚æ•°æ®åªèƒ½ç”±Javaååºåˆ—åŒ–ï¼Œä¸èƒ½è¢«å…¶ä»–è¯­è¨€ååºåˆ—åŒ–ã€‚å¦‚æœè¦è¿›è¡Œå‰åç«¯æˆ–è€…ä¸åŒè¯­è¨€ä¹‹é—´çš„äº¤äº’ä¸€èˆ¬éœ€è¦å°†å¯¹è±¡è½¬å˜æˆJson/Xmlé€šç”¨æ ¼å¼çš„æ•°æ®ï¼Œå†æ¢å¤åŸæ¥çš„å¯¹è±¡ã€‚\n\n","slug":"åŸºç¡€/å…³äºJavaåºåˆ—åŒ–ä½ åº”è¯¥çŸ¥é“çš„ä¸€åˆ‡","published":1,"updated":"2025-10-15T07:19:51.784Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076x0049qkd4954efqqm","content":"<h2 id=\"ä»€ä¹ˆæ˜¯åºåˆ—åŒ–\"><a href=\"#ä»€ä¹ˆæ˜¯åºåˆ—åŒ–\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯åºåˆ—åŒ–\"></a>ä»€ä¹ˆæ˜¯åºåˆ—åŒ–</h2><p>æˆ‘ä»¬çš„å¯¹è±¡å¹¶ä¸åªæ˜¯å­˜åœ¨å†…å­˜ä¸­ï¼Œè¿˜éœ€è¦ä¼ è¾“ç½‘ç»œï¼Œæˆ–è€…ä¿å­˜èµ·æ¥ä¸‹æ¬¡å†åŠ è½½å‡ºæ¥ç”¨ï¼Œæ‰€ä»¥éœ€è¦Javaåºåˆ—åŒ–æŠ€æœ¯ã€‚</p>\n<p>Javaåºåˆ—åŒ–æŠ€æœ¯æ­£æ˜¯å°†å¯¹è±¡è½¬å˜æˆä¸€ä¸²ç”±äºŒè¿›åˆ¶å­—èŠ‚ç»„æˆçš„æ•°ç»„ï¼Œå¯ä»¥é€šè¿‡å°†äºŒè¿›åˆ¶æ•°æ®ä¿å­˜åˆ°ç£ç›˜æˆ–è€…ä¼ è¾“ç½‘ç»œï¼Œç£ç›˜æˆ–è€…ç½‘ç»œæ¥æ”¶è€…å¯ä»¥åœ¨å¯¹è±¡çš„å±ç±»çš„æ¨¡æ¿ä¸Šæ¥ååºåˆ—åŒ–ç±»çš„å¯¹è±¡ï¼Œè¾¾åˆ°å¯¹è±¡æŒä¹…åŒ–çš„ç›®çš„ã€‚</p>\n<h2 id=\"æ€ä¹ˆåºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Ÿ\"><a href=\"#æ€ä¹ˆåºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Ÿ\" class=\"headerlink\" title=\"æ€ä¹ˆåºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Ÿ\"></a>æ€ä¹ˆåºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Ÿ</h2><p>è¦åºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ‰€åœ¨ç±»å°±å¿…é¡»å®ç°Javaåºåˆ—åŒ–çš„æ¥å£ï¼šjava.io.Serializableã€‚</p>\n<h5 id=\"1ã€ç±»æ·»åŠ åºåˆ—åŒ–æ¥å£\"><a href=\"#1ã€ç±»æ·»åŠ åºåˆ—åŒ–æ¥å£\" class=\"headerlink\" title=\"1ã€ç±»æ·»åŠ åºåˆ—åŒ–æ¥å£\"></a>1ã€ç±»æ·»åŠ åºåˆ—åŒ–æ¥å£</h5><pre class=\"line-numbers language-none\"><code class=\"language-none\">import java.io.Serializable;\n\npublic class User implements Serializable&#123;\n\n    private static final long serialVersionUID &#x3D; -8475669200846811112L;\n\n    private String username;\n    private String address;\n\n    public String getUsername() &#123;\n        return username;\n    &#125;\n\n    public void setUsername(String username) &#123;\n        this.username &#x3D; username;\n    &#125;\n\n    public String getAddress() &#123;\n        return address;\n    &#125;\n\n    public void setAddress(String address) &#123;\n        this.address &#x3D; address;\n    &#125;\n\n    @Override\n    public String toString() &#123;\n        return &quot;User&#123;&quot; +\n                &quot;username&#x3D;&#39;&quot; + username + &#39;\\&#39;&#39; +\n                &quot;, address&#x3D;&#39;&quot; + address + &#39;\\&#39;&#39; +\n                &#39;&#125;&#39;;\n    &#125;\n    \n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"2ã€åºåˆ—åŒ–-ååºåˆ—åŒ–\"><a href=\"#2ã€åºåˆ—åŒ–-ååºåˆ—åŒ–\" class=\"headerlink\" title=\"2ã€åºåˆ—åŒ–&#x2F;ååºåˆ—åŒ–\"></a>2ã€åºåˆ—åŒ–&#x2F;ååºåˆ—åŒ–</h5><p>å¯ä»¥å€ŸåŠ©commons-lang3å·¥å…·åŒ…é‡Œé¢çš„ç±»å®ç°å¯¹è±¡çš„åºåˆ—åŒ–åŠååºåˆ—åŒ–ï¼Œä½ æ²¡æœ‰å¿…è¦è‡ªå·±å†™ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">import org.apache.commons.lang3.SerializationUtils;\n\npublic class Test &#123;\n\n    public static void main(String[] args) &#123;\n        User user &#x3D; new User();\n        user.setUsername(&quot;Java&quot;);\n        user.setAddress(&quot;China&quot;);\n        byte[] bytes &#x3D; SerializationUtils.serialize(user);\n\n        User u &#x3D; SerializationUtils.deserialize(bytes);\n        System.out.println(u);\n\n    &#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>è¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">User&#123;username&#x3D;&#39;Java&#39;, address&#x3D;&#39;China&#39;&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>ä¸Šä¾‹é€šè¿‡åºåˆ—åŒ–å¯¹è±¡å­—èŠ‚åˆ°å†…å­˜ç„¶åååºåˆ—åŒ–ï¼Œå½“ç„¶é‡Œé¢ä¹Ÿæä¾›äº†åºåˆ—åŒ–ç£ç›˜ç„¶åå†ååºåˆ—åŒ–çš„æ–¹æ³•ï¼ŒåŸç†éƒ½æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯ç›®æ ‡åœ°ä¸ä¸€æ ·ã€‚</p>\n<h2 id=\"åºåˆ—åŒ–æ³¨æ„äº‹é¡¹\"><a href=\"#åºåˆ—åŒ–æ³¨æ„äº‹é¡¹\" class=\"headerlink\" title=\"åºåˆ—åŒ–æ³¨æ„äº‹é¡¹\"></a>åºåˆ—åŒ–æ³¨æ„äº‹é¡¹</h2><ul>\n<li><p>åºåˆ—åŒ–å¯¹è±¡å¿…é¡»å®ç°åºåˆ—åŒ–æ¥å£ã€‚</p>\n</li>\n<li><p>åºåˆ—åŒ–å¯¹è±¡é‡Œé¢çš„å±æ€§æ˜¯å¯¹è±¡çš„è¯ä¹Ÿè¦å®ç°åºåˆ—åŒ–æ¥å£ã€‚</p>\n</li>\n<li><p>ç±»çš„å¯¹è±¡åºåˆ—åŒ–åï¼Œç±»çš„åºåˆ—åŒ–IDä¸èƒ½è½»æ˜“ä¿®æ”¹ï¼Œä¸ç„¶ååºåˆ—åŒ–ä¼šå¤±è´¥ã€‚</p>\n</li>\n<li><p>ç±»çš„å¯¹è±¡åºåˆ—åŒ–åï¼Œç±»çš„å±æ€§æœ‰å¢åŠ æˆ–è€…åˆ é™¤ä¸ä¼šå½±å“åºåˆ—åŒ–ï¼Œåªæ˜¯å€¼ä¼šä¸¢å¤±ã€‚</p>\n</li>\n<li><p>å¦‚æœçˆ¶ç±»åºåˆ—åŒ–äº†ï¼Œå­ç±»ä¼šç»§æ‰¿çˆ¶ç±»çš„åºåˆ—åŒ–ï¼Œå­ç±»æ— éœ€æ·»åŠ åºåˆ—åŒ–æ¥å£ã€‚</p>\n</li>\n<li><p>å¦‚æœçˆ¶ç±»æ²¡æœ‰åºåˆ—åŒ–ï¼Œå­ç±»åºåˆ—åŒ–äº†ï¼Œå­ç±»ä¸­çš„å±æ€§èƒ½æ­£å¸¸åºåˆ—åŒ–ï¼Œä½†çˆ¶ç±»çš„å±æ€§ä¼šä¸¢å¤±ï¼Œä¸èƒ½åºåˆ—åŒ–ã€‚</p>\n</li>\n<li><p>ç”¨Javaåºåˆ—åŒ–çš„äºŒè¿›åˆ¶å­—èŠ‚æ•°æ®åªèƒ½ç”±Javaååºåˆ—åŒ–ï¼Œä¸èƒ½è¢«å…¶ä»–è¯­è¨€ååºåˆ—åŒ–ã€‚å¦‚æœè¦è¿›è¡Œå‰åç«¯æˆ–è€…ä¸åŒè¯­è¨€ä¹‹é—´çš„äº¤äº’ä¸€èˆ¬éœ€è¦å°†å¯¹è±¡è½¬å˜æˆJson&#x2F;Xmlé€šç”¨æ ¼å¼çš„æ•°æ®ï¼Œå†æ¢å¤åŸæ¥çš„å¯¹è±¡ã€‚</p>\n</li>\n</ul>\n","excerpt":"","more":"<h2 id=\"ä»€ä¹ˆæ˜¯åºåˆ—åŒ–\"><a href=\"#ä»€ä¹ˆæ˜¯åºåˆ—åŒ–\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯åºåˆ—åŒ–\"></a>ä»€ä¹ˆæ˜¯åºåˆ—åŒ–</h2><p>æˆ‘ä»¬çš„å¯¹è±¡å¹¶ä¸åªæ˜¯å­˜åœ¨å†…å­˜ä¸­ï¼Œè¿˜éœ€è¦ä¼ è¾“ç½‘ç»œï¼Œæˆ–è€…ä¿å­˜èµ·æ¥ä¸‹æ¬¡å†åŠ è½½å‡ºæ¥ç”¨ï¼Œæ‰€ä»¥éœ€è¦Javaåºåˆ—åŒ–æŠ€æœ¯ã€‚</p>\n<p>Javaåºåˆ—åŒ–æŠ€æœ¯æ­£æ˜¯å°†å¯¹è±¡è½¬å˜æˆä¸€ä¸²ç”±äºŒè¿›åˆ¶å­—èŠ‚ç»„æˆçš„æ•°ç»„ï¼Œå¯ä»¥é€šè¿‡å°†äºŒè¿›åˆ¶æ•°æ®ä¿å­˜åˆ°ç£ç›˜æˆ–è€…ä¼ è¾“ç½‘ç»œï¼Œç£ç›˜æˆ–è€…ç½‘ç»œæ¥æ”¶è€…å¯ä»¥åœ¨å¯¹è±¡çš„å±ç±»çš„æ¨¡æ¿ä¸Šæ¥ååºåˆ—åŒ–ç±»çš„å¯¹è±¡ï¼Œè¾¾åˆ°å¯¹è±¡æŒä¹…åŒ–çš„ç›®çš„ã€‚</p>\n<h2 id=\"æ€ä¹ˆåºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Ÿ\"><a href=\"#æ€ä¹ˆåºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Ÿ\" class=\"headerlink\" title=\"æ€ä¹ˆåºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Ÿ\"></a>æ€ä¹ˆåºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Ÿ</h2><p>è¦åºåˆ—åŒ–ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æ‰€åœ¨ç±»å°±å¿…é¡»å®ç°Javaåºåˆ—åŒ–çš„æ¥å£ï¼šjava.io.Serializableã€‚</p>\n<h5 id=\"1ã€ç±»æ·»åŠ åºåˆ—åŒ–æ¥å£\"><a href=\"#1ã€ç±»æ·»åŠ åºåˆ—åŒ–æ¥å£\" class=\"headerlink\" title=\"1ã€ç±»æ·»åŠ åºåˆ—åŒ–æ¥å£\"></a>1ã€ç±»æ·»åŠ åºåˆ—åŒ–æ¥å£</h5><pre class=\"line-numbers language-none\"><code class=\"language-none\">import java.io.Serializable;\n\npublic class User implements Serializable&#123;\n\n    private static final long serialVersionUID &#x3D; -8475669200846811112L;\n\n    private String username;\n    private String address;\n\n    public String getUsername() &#123;\n        return username;\n    &#125;\n\n    public void setUsername(String username) &#123;\n        this.username &#x3D; username;\n    &#125;\n\n    public String getAddress() &#123;\n        return address;\n    &#125;\n\n    public void setAddress(String address) &#123;\n        this.address &#x3D; address;\n    &#125;\n\n    @Override\n    public String toString() &#123;\n        return &quot;User&#123;&quot; +\n                &quot;username&#x3D;&#39;&quot; + username + &#39;\\&#39;&#39; +\n                &quot;, address&#x3D;&#39;&quot; + address + &#39;\\&#39;&#39; +\n                &#39;&#125;&#39;;\n    &#125;\n    \n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h5 id=\"2ã€åºåˆ—åŒ–-ååºåˆ—åŒ–\"><a href=\"#2ã€åºåˆ—åŒ–-ååºåˆ—åŒ–\" class=\"headerlink\" title=\"2ã€åºåˆ—åŒ–&#x2F;ååºåˆ—åŒ–\"></a>2ã€åºåˆ—åŒ–&#x2F;ååºåˆ—åŒ–</h5><p>å¯ä»¥å€ŸåŠ©commons-lang3å·¥å…·åŒ…é‡Œé¢çš„ç±»å®ç°å¯¹è±¡çš„åºåˆ—åŒ–åŠååºåˆ—åŒ–ï¼Œä½ æ²¡æœ‰å¿…è¦è‡ªå·±å†™ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">import org.apache.commons.lang3.SerializationUtils;\n\npublic class Test &#123;\n\n    public static void main(String[] args) &#123;\n        User user &#x3D; new User();\n        user.setUsername(&quot;Java&quot;);\n        user.setAddress(&quot;China&quot;);\n        byte[] bytes &#x3D; SerializationUtils.serialize(user);\n\n        User u &#x3D; SerializationUtils.deserialize(bytes);\n        System.out.println(u);\n\n    &#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>è¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">User&#123;username&#x3D;&#39;Java&#39;, address&#x3D;&#39;China&#39;&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n<p>ä¸Šä¾‹é€šè¿‡åºåˆ—åŒ–å¯¹è±¡å­—èŠ‚åˆ°å†…å­˜ç„¶åååºåˆ—åŒ–ï¼Œå½“ç„¶é‡Œé¢ä¹Ÿæä¾›äº†åºåˆ—åŒ–ç£ç›˜ç„¶åå†ååºåˆ—åŒ–çš„æ–¹æ³•ï¼ŒåŸç†éƒ½æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯ç›®æ ‡åœ°ä¸ä¸€æ ·ã€‚</p>\n<h2 id=\"åºåˆ—åŒ–æ³¨æ„äº‹é¡¹\"><a href=\"#åºåˆ—åŒ–æ³¨æ„äº‹é¡¹\" class=\"headerlink\" title=\"åºåˆ—åŒ–æ³¨æ„äº‹é¡¹\"></a>åºåˆ—åŒ–æ³¨æ„äº‹é¡¹</h2><ul>\n<li><p>åºåˆ—åŒ–å¯¹è±¡å¿…é¡»å®ç°åºåˆ—åŒ–æ¥å£ã€‚</p>\n</li>\n<li><p>åºåˆ—åŒ–å¯¹è±¡é‡Œé¢çš„å±æ€§æ˜¯å¯¹è±¡çš„è¯ä¹Ÿè¦å®ç°åºåˆ—åŒ–æ¥å£ã€‚</p>\n</li>\n<li><p>ç±»çš„å¯¹è±¡åºåˆ—åŒ–åï¼Œç±»çš„åºåˆ—åŒ–IDä¸èƒ½è½»æ˜“ä¿®æ”¹ï¼Œä¸ç„¶ååºåˆ—åŒ–ä¼šå¤±è´¥ã€‚</p>\n</li>\n<li><p>ç±»çš„å¯¹è±¡åºåˆ—åŒ–åï¼Œç±»çš„å±æ€§æœ‰å¢åŠ æˆ–è€…åˆ é™¤ä¸ä¼šå½±å“åºåˆ—åŒ–ï¼Œåªæ˜¯å€¼ä¼šä¸¢å¤±ã€‚</p>\n</li>\n<li><p>å¦‚æœçˆ¶ç±»åºåˆ—åŒ–äº†ï¼Œå­ç±»ä¼šç»§æ‰¿çˆ¶ç±»çš„åºåˆ—åŒ–ï¼Œå­ç±»æ— éœ€æ·»åŠ åºåˆ—åŒ–æ¥å£ã€‚</p>\n</li>\n<li><p>å¦‚æœçˆ¶ç±»æ²¡æœ‰åºåˆ—åŒ–ï¼Œå­ç±»åºåˆ—åŒ–äº†ï¼Œå­ç±»ä¸­çš„å±æ€§èƒ½æ­£å¸¸åºåˆ—åŒ–ï¼Œä½†çˆ¶ç±»çš„å±æ€§ä¼šä¸¢å¤±ï¼Œä¸èƒ½åºåˆ—åŒ–ã€‚</p>\n</li>\n<li><p>ç”¨Javaåºåˆ—åŒ–çš„äºŒè¿›åˆ¶å­—èŠ‚æ•°æ®åªèƒ½ç”±Javaååºåˆ—åŒ–ï¼Œä¸èƒ½è¢«å…¶ä»–è¯­è¨€ååºåˆ—åŒ–ã€‚å¦‚æœè¦è¿›è¡Œå‰åç«¯æˆ–è€…ä¸åŒè¯­è¨€ä¹‹é—´çš„äº¤äº’ä¸€èˆ¬éœ€è¦å°†å¯¹è±¡è½¬å˜æˆJson&#x2F;Xmlé€šç”¨æ ¼å¼çš„æ•°æ®ï¼Œå†æ¢å¤åŸæ¥çš„å¯¹è±¡ã€‚</p>\n</li>\n</ul>\n"},{"title":"å‘çˆ¹çš„ Java å¯å˜å‚æ•°ï¼ŒæŠŠæˆ‘æ•´å¾—å¤Ÿæƒ¨ã€‚","date":"2025-10-14T06:42:34.000Z","_content":"\n**ä»€ä¹ˆæ˜¯å¯å˜å‚æ•°ï¼Ÿ**\n\nå°±æ˜¯æ–¹æ³•å‚æ•°ç”¨ `Object... args` ä¸‰ä¸ªç‚¹å½¢å¼ï¼Œä¸€ä¸ªå‚æ•°å¯ä»¥æ¥æ”¶å¤šä¸ªå‚æ•°ã€‚\n\nå®é™…çš„ä»£ç å°±ä¸å¸–äº†ï¼Œæ¥çœ‹è¿™ä¸ªç¤ºä¾‹å§ï¼š\n\n**ç¤ºä¾‹1**\n\n```\npublic static void main(String[] args) {\n    test(\"name=%s&memo=%s\", \"JavaæŠ€æœ¯\", \"666\");\n}\n\nprivate static void test(String text, Object... params) {\n    String result = String.format(text, params);\n    System.out.println(result);\n}\n```\n\nå¤§å®¶çŒœç»“æœæ˜¯ä»€ä¹ˆï¼Ÿç»“æœå¦‚æˆ‘ä»¬æƒ³è±¡ï¼š\n\n```\nname=JavaæŠ€æœ¯&memo=666\n```\n\n**ç¤ºä¾‹2**\n\n```\npublic static void main(String[] args) {\n    test(\"name=%s&memo=%s\", \"JavaæŠ€æœ¯\");\n}\n\nprivate static void test(String text, Object... params) {\n    String result = String.format(text, params, \"666\");\n    System.out.println(result);\n}\n```\n\næˆ‘æŠŠ \"666\" ç§»åˆ°äº†å­æ–¹æ³•é‡Œé¢ï¼Œæ”¾åˆ°äº† format æœ€åï¼Œå†æ¥çœ‹ä¸‹ç»“æœæ˜¯ä»€ä¹ˆã€‚\n\n```\nname=[Ljava.lang.Object;@4cb2c100&memo=666\n```\n\nè¿™å¹¶éæ˜¯æˆ‘æƒ³è¦çš„ç»“æœï¼ŒæŠŠå¯å˜å‚æ•° params æ•°ç»„å¯¹è±¡åœ°å€ä½œä¸ºå€¼è¾“å‡ºå‡ºæ¥äº†ï¼ŒæŠŠæˆ‘æå¾—å¤Ÿæƒ¨ï¼Œæœ€åæˆ‘å¹²æ‰äº†å¯å˜å‚æ•°ã€‚ã€‚\n\nJDKé‡Œé¢å¾ˆå¤šæœ‰ç”¨åˆ°å¯å˜å‚æ•°çš„ï¼Œå¯å®é™…å¼€å‘ä¸­ï¼Œå¹¶ä¸å»ºè®®ä½¿ç”¨å¯å˜å‚è€ƒï¼Œå®ƒå¸¦æ¥çš„å›°æ‰°å’Œæ½œåœ¨çš„é—®é¢˜ä¼šè¿œå¤§äºä¾¿åˆ©æ€§ï¼Œæ¯”å¦‚åœ¨æ–¹æ³•é‡æ„ã€é‡å†™ç­‰ä¹Ÿä¼šå¸¦æ¥å¾ˆå¤šé—®é¢˜ã€‚\n\nå…³äºå¯å˜å‚æ•°ï¼Œä¹Ÿæ˜¯æœ‰å¼€å‘è§„èŒƒçš„ï¼Œä¸èƒ½éšä¾¿å†™ã€‚æˆ‘æ‰¾åˆ°äº†é˜¿é‡Œå·´å·´çš„ã€ŠJavaå¼€å‘æ‰‹å†Œã€‹ä¸­å…³äºå¯å˜å‚æ•°çš„è§„çº¦ã€‚\n\n> ç›¸åŒå‚æ•°ç±»å‹ï¼Œç›¸åŒä¸šåŠ¡å«ä¹‰ï¼Œæ‰å¯ä»¥ä½¿ç”¨ Java çš„å¯å˜å‚æ•°ï¼Œé¿å…ä½¿ç”¨ Object ã€‚\n> \n> è¯´æ˜ï¼šå¯å˜å‚æ•°å¿…é¡»æ”¾ç½®åœ¨å‚æ•°åˆ—è¡¨çš„æœ€åã€‚ ï¼ˆ æå€¡åŒå­¦ä»¬å°½é‡ä¸ç”¨å¯å˜å‚æ•°ç¼–ç¨‹ ï¼‰\n> \n> æ­£ä¾‹ï¼š public List<User> listUsers(String type, Long... ids) {...}\n\n\n\n","source":"_posts/åŸºç¡€/å‘çˆ¹çš„ Java å¯å˜å‚æ•°ï¼ŒæŠŠæˆ‘æ•´å¾—å¤Ÿæƒ¨ã€‚.md","raw":"---\ntitle: å‘çˆ¹çš„ Java å¯å˜å‚æ•°ï¼ŒæŠŠæˆ‘æ•´å¾—å¤Ÿæƒ¨ã€‚\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: åŸºç¡€\n---\n\n**ä»€ä¹ˆæ˜¯å¯å˜å‚æ•°ï¼Ÿ**\n\nå°±æ˜¯æ–¹æ³•å‚æ•°ç”¨ `Object... args` ä¸‰ä¸ªç‚¹å½¢å¼ï¼Œä¸€ä¸ªå‚æ•°å¯ä»¥æ¥æ”¶å¤šä¸ªå‚æ•°ã€‚\n\nå®é™…çš„ä»£ç å°±ä¸å¸–äº†ï¼Œæ¥çœ‹è¿™ä¸ªç¤ºä¾‹å§ï¼š\n\n**ç¤ºä¾‹1**\n\n```\npublic static void main(String[] args) {\n    test(\"name=%s&memo=%s\", \"JavaæŠ€æœ¯\", \"666\");\n}\n\nprivate static void test(String text, Object... params) {\n    String result = String.format(text, params);\n    System.out.println(result);\n}\n```\n\nå¤§å®¶çŒœç»“æœæ˜¯ä»€ä¹ˆï¼Ÿç»“æœå¦‚æˆ‘ä»¬æƒ³è±¡ï¼š\n\n```\nname=JavaæŠ€æœ¯&memo=666\n```\n\n**ç¤ºä¾‹2**\n\n```\npublic static void main(String[] args) {\n    test(\"name=%s&memo=%s\", \"JavaæŠ€æœ¯\");\n}\n\nprivate static void test(String text, Object... params) {\n    String result = String.format(text, params, \"666\");\n    System.out.println(result);\n}\n```\n\næˆ‘æŠŠ \"666\" ç§»åˆ°äº†å­æ–¹æ³•é‡Œé¢ï¼Œæ”¾åˆ°äº† format æœ€åï¼Œå†æ¥çœ‹ä¸‹ç»“æœæ˜¯ä»€ä¹ˆã€‚\n\n```\nname=[Ljava.lang.Object;@4cb2c100&memo=666\n```\n\nè¿™å¹¶éæ˜¯æˆ‘æƒ³è¦çš„ç»“æœï¼ŒæŠŠå¯å˜å‚æ•° params æ•°ç»„å¯¹è±¡åœ°å€ä½œä¸ºå€¼è¾“å‡ºå‡ºæ¥äº†ï¼ŒæŠŠæˆ‘æå¾—å¤Ÿæƒ¨ï¼Œæœ€åæˆ‘å¹²æ‰äº†å¯å˜å‚æ•°ã€‚ã€‚\n\nJDKé‡Œé¢å¾ˆå¤šæœ‰ç”¨åˆ°å¯å˜å‚æ•°çš„ï¼Œå¯å®é™…å¼€å‘ä¸­ï¼Œå¹¶ä¸å»ºè®®ä½¿ç”¨å¯å˜å‚è€ƒï¼Œå®ƒå¸¦æ¥çš„å›°æ‰°å’Œæ½œåœ¨çš„é—®é¢˜ä¼šè¿œå¤§äºä¾¿åˆ©æ€§ï¼Œæ¯”å¦‚åœ¨æ–¹æ³•é‡æ„ã€é‡å†™ç­‰ä¹Ÿä¼šå¸¦æ¥å¾ˆå¤šé—®é¢˜ã€‚\n\nå…³äºå¯å˜å‚æ•°ï¼Œä¹Ÿæ˜¯æœ‰å¼€å‘è§„èŒƒçš„ï¼Œä¸èƒ½éšä¾¿å†™ã€‚æˆ‘æ‰¾åˆ°äº†é˜¿é‡Œå·´å·´çš„ã€ŠJavaå¼€å‘æ‰‹å†Œã€‹ä¸­å…³äºå¯å˜å‚æ•°çš„è§„çº¦ã€‚\n\n> ç›¸åŒå‚æ•°ç±»å‹ï¼Œç›¸åŒä¸šåŠ¡å«ä¹‰ï¼Œæ‰å¯ä»¥ä½¿ç”¨ Java çš„å¯å˜å‚æ•°ï¼Œé¿å…ä½¿ç”¨ Object ã€‚\n> \n> è¯´æ˜ï¼šå¯å˜å‚æ•°å¿…é¡»æ”¾ç½®åœ¨å‚æ•°åˆ—è¡¨çš„æœ€åã€‚ ï¼ˆ æå€¡åŒå­¦ä»¬å°½é‡ä¸ç”¨å¯å˜å‚æ•°ç¼–ç¨‹ ï¼‰\n> \n> æ­£ä¾‹ï¼š public List<User> listUsers(String type, Long... ids) {...}\n\n\n\n","slug":"åŸºç¡€/å‘çˆ¹çš„ Java å¯å˜å‚æ•°ï¼ŒæŠŠæˆ‘æ•´å¾—å¤Ÿæƒ¨ã€‚","published":1,"updated":"2025-10-15T07:19:51.805Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076x004cqkd4ez50c4c3","content":"<p><strong>ä»€ä¹ˆæ˜¯å¯å˜å‚æ•°ï¼Ÿ</strong></p>\n<p>å°±æ˜¯æ–¹æ³•å‚æ•°ç”¨ <code>Object... args</code> ä¸‰ä¸ªç‚¹å½¢å¼ï¼Œä¸€ä¸ªå‚æ•°å¯ä»¥æ¥æ”¶å¤šä¸ªå‚æ•°ã€‚</p>\n<p>å®é™…çš„ä»£ç å°±ä¸å¸–äº†ï¼Œæ¥çœ‹è¿™ä¸ªç¤ºä¾‹å§ï¼š</p>\n<p><strong>ç¤ºä¾‹1</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n    test(&quot;name&#x3D;%s&amp;memo&#x3D;%s&quot;, &quot;JavaæŠ€æœ¯&quot;, &quot;666&quot;);\n&#125;\n\nprivate static void test(String text, Object... params) &#123;\n    String result &#x3D; String.format(text, params);\n    System.out.println(result);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¤§å®¶çŒœç»“æœæ˜¯ä»€ä¹ˆï¼Ÿç»“æœå¦‚æˆ‘ä»¬æƒ³è±¡ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">name&#x3D;JavaæŠ€æœ¯&amp;memo&#x3D;666<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><strong>ç¤ºä¾‹2</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n    test(&quot;name&#x3D;%s&amp;memo&#x3D;%s&quot;, &quot;JavaæŠ€æœ¯&quot;);\n&#125;\n\nprivate static void test(String text, Object... params) &#123;\n    String result &#x3D; String.format(text, params, &quot;666&quot;);\n    System.out.println(result);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æˆ‘æŠŠ â€œ666â€ ç§»åˆ°äº†å­æ–¹æ³•é‡Œé¢ï¼Œæ”¾åˆ°äº† format æœ€åï¼Œå†æ¥çœ‹ä¸‹ç»“æœæ˜¯ä»€ä¹ˆã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">name&#x3D;[Ljava.lang.Object;@4cb2c100&amp;memo&#x3D;666<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>è¿™å¹¶éæ˜¯æˆ‘æƒ³è¦çš„ç»“æœï¼ŒæŠŠå¯å˜å‚æ•° params æ•°ç»„å¯¹è±¡åœ°å€ä½œä¸ºå€¼è¾“å‡ºå‡ºæ¥äº†ï¼ŒæŠŠæˆ‘æå¾—å¤Ÿæƒ¨ï¼Œæœ€åæˆ‘å¹²æ‰äº†å¯å˜å‚æ•°ã€‚ã€‚</p>\n<p>JDKé‡Œé¢å¾ˆå¤šæœ‰ç”¨åˆ°å¯å˜å‚æ•°çš„ï¼Œå¯å®é™…å¼€å‘ä¸­ï¼Œå¹¶ä¸å»ºè®®ä½¿ç”¨å¯å˜å‚è€ƒï¼Œå®ƒå¸¦æ¥çš„å›°æ‰°å’Œæ½œåœ¨çš„é—®é¢˜ä¼šè¿œå¤§äºä¾¿åˆ©æ€§ï¼Œæ¯”å¦‚åœ¨æ–¹æ³•é‡æ„ã€é‡å†™ç­‰ä¹Ÿä¼šå¸¦æ¥å¾ˆå¤šé—®é¢˜ã€‚</p>\n<p>å…³äºå¯å˜å‚æ•°ï¼Œä¹Ÿæ˜¯æœ‰å¼€å‘è§„èŒƒçš„ï¼Œä¸èƒ½éšä¾¿å†™ã€‚æˆ‘æ‰¾åˆ°äº†é˜¿é‡Œå·´å·´çš„ã€ŠJavaå¼€å‘æ‰‹å†Œã€‹ä¸­å…³äºå¯å˜å‚æ•°çš„è§„çº¦ã€‚</p>\n<blockquote>\n<p>ç›¸åŒå‚æ•°ç±»å‹ï¼Œç›¸åŒä¸šåŠ¡å«ä¹‰ï¼Œæ‰å¯ä»¥ä½¿ç”¨ Java çš„å¯å˜å‚æ•°ï¼Œé¿å…ä½¿ç”¨ Object ã€‚</p>\n<p>è¯´æ˜ï¼šå¯å˜å‚æ•°å¿…é¡»æ”¾ç½®åœ¨å‚æ•°åˆ—è¡¨çš„æœ€åã€‚ ï¼ˆ æå€¡åŒå­¦ä»¬å°½é‡ä¸ç”¨å¯å˜å‚æ•°ç¼–ç¨‹ ï¼‰</p>\n<p>æ­£ä¾‹ï¼š public List<User> listUsers(String type, Longâ€¦ ids) {â€¦}</p>\n</blockquote>\n","excerpt":"","more":"<p><strong>ä»€ä¹ˆæ˜¯å¯å˜å‚æ•°ï¼Ÿ</strong></p>\n<p>å°±æ˜¯æ–¹æ³•å‚æ•°ç”¨ <code>Object... args</code> ä¸‰ä¸ªç‚¹å½¢å¼ï¼Œä¸€ä¸ªå‚æ•°å¯ä»¥æ¥æ”¶å¤šä¸ªå‚æ•°ã€‚</p>\n<p>å®é™…çš„ä»£ç å°±ä¸å¸–äº†ï¼Œæ¥çœ‹è¿™ä¸ªç¤ºä¾‹å§ï¼š</p>\n<p><strong>ç¤ºä¾‹1</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n    test(&quot;name&#x3D;%s&amp;memo&#x3D;%s&quot;, &quot;JavaæŠ€æœ¯&quot;, &quot;666&quot;);\n&#125;\n\nprivate static void test(String text, Object... params) &#123;\n    String result &#x3D; String.format(text, params);\n    System.out.println(result);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¤§å®¶çŒœç»“æœæ˜¯ä»€ä¹ˆï¼Ÿç»“æœå¦‚æˆ‘ä»¬æƒ³è±¡ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">name&#x3D;JavaæŠ€æœ¯&amp;memo&#x3D;666<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p><strong>ç¤ºä¾‹2</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n    test(&quot;name&#x3D;%s&amp;memo&#x3D;%s&quot;, &quot;JavaæŠ€æœ¯&quot;);\n&#125;\n\nprivate static void test(String text, Object... params) &#123;\n    String result &#x3D; String.format(text, params, &quot;666&quot;);\n    System.out.println(result);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æˆ‘æŠŠ â€œ666â€ ç§»åˆ°äº†å­æ–¹æ³•é‡Œé¢ï¼Œæ”¾åˆ°äº† format æœ€åï¼Œå†æ¥çœ‹ä¸‹ç»“æœæ˜¯ä»€ä¹ˆã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">name&#x3D;[Ljava.lang.Object;@4cb2c100&amp;memo&#x3D;666<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>è¿™å¹¶éæ˜¯æˆ‘æƒ³è¦çš„ç»“æœï¼ŒæŠŠå¯å˜å‚æ•° params æ•°ç»„å¯¹è±¡åœ°å€ä½œä¸ºå€¼è¾“å‡ºå‡ºæ¥äº†ï¼ŒæŠŠæˆ‘æå¾—å¤Ÿæƒ¨ï¼Œæœ€åæˆ‘å¹²æ‰äº†å¯å˜å‚æ•°ã€‚ã€‚</p>\n<p>JDKé‡Œé¢å¾ˆå¤šæœ‰ç”¨åˆ°å¯å˜å‚æ•°çš„ï¼Œå¯å®é™…å¼€å‘ä¸­ï¼Œå¹¶ä¸å»ºè®®ä½¿ç”¨å¯å˜å‚è€ƒï¼Œå®ƒå¸¦æ¥çš„å›°æ‰°å’Œæ½œåœ¨çš„é—®é¢˜ä¼šè¿œå¤§äºä¾¿åˆ©æ€§ï¼Œæ¯”å¦‚åœ¨æ–¹æ³•é‡æ„ã€é‡å†™ç­‰ä¹Ÿä¼šå¸¦æ¥å¾ˆå¤šé—®é¢˜ã€‚</p>\n<p>å…³äºå¯å˜å‚æ•°ï¼Œä¹Ÿæ˜¯æœ‰å¼€å‘è§„èŒƒçš„ï¼Œä¸èƒ½éšä¾¿å†™ã€‚æˆ‘æ‰¾åˆ°äº†é˜¿é‡Œå·´å·´çš„ã€ŠJavaå¼€å‘æ‰‹å†Œã€‹ä¸­å…³äºå¯å˜å‚æ•°çš„è§„çº¦ã€‚</p>\n<blockquote>\n<p>ç›¸åŒå‚æ•°ç±»å‹ï¼Œç›¸åŒä¸šåŠ¡å«ä¹‰ï¼Œæ‰å¯ä»¥ä½¿ç”¨ Java çš„å¯å˜å‚æ•°ï¼Œé¿å…ä½¿ç”¨ Object ã€‚</p>\n<p>è¯´æ˜ï¼šå¯å˜å‚æ•°å¿…é¡»æ”¾ç½®åœ¨å‚æ•°åˆ—è¡¨çš„æœ€åã€‚ ï¼ˆ æå€¡åŒå­¦ä»¬å°½é‡ä¸ç”¨å¯å˜å‚æ•°ç¼–ç¨‹ ï¼‰</p>\n<p>æ­£ä¾‹ï¼š public List<User> listUsers(String type, Longâ€¦ ids) {â€¦}</p>\n</blockquote>\n"},{"title":"å­—ç¬¦ä¸²æ‹¼æ¥ + å’Œ concat çš„åŒºåˆ«","date":"2025-10-14T06:42:34.000Z","_content":"\n+å’Œconcatéƒ½å¯ä»¥ç”¨æ¥æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œä½†åœ¨ä½¿ç”¨ä¸Šæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Œå…ˆæ¥çœ‹çœ‹è¿™ä¸ªä¾‹å­ã€‚\n\n```\npublic static void main(String[] args) {\n\t// example1\n\tString str1 = \"s1\";\n\tSystem.out.println(str1 + 100);//s1100\n\tSystem.out.println(100 + str1);//100s1\n\n\tString str2 = \"s2\";\n\tstr2 = str2.concat(\"a\").concat(\"bc\");\n\tSystem.out.println(str2);//s2abc\n\n\t// example2\n\tString str3 = \"s3\";\n\tSystem.out.println(str3 + null);//s3null\n\tSystem.out.println(null + str3);//nulls3\n\n\tString str4 = null;\n\tSystem.out.println(str4.concat(\"a\"));//NullPointerException\n\tSystem.out.println(\"a\".concat(str4));//NullPointerException\n}\n```\n\nconcatæºç ï¼š\n\n```\npublic String concat(String str) {\n    int otherLen = str.length();\n    if (otherLen == 0) {\n        return this;\n    }\n    int len = value.length;\n    char buf[] = Arrays.copyOf(value, len + otherLen);\n    str.getChars(buf, len);\n    return new String(buf, true);\n}\n```\n\nçœ‹ä¸‹ç”Ÿæˆçš„å­—èŠ‚ç ï¼š\n\n\n#### æ‰€ä»¥å¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š\n\n1. +å¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–è€…æ•°å­—åŠå…¶ä»–åŸºæœ¬ç±»å‹æ•°æ®ï¼Œè€Œconcatåªèƒ½æ¥æ”¶å­—ç¬¦ä¸²ã€‚\n\n2. +å·¦å³å¯ä»¥ä¸ºnullï¼Œconcatä¸ºä¼šç©ºæŒ‡é’ˆã€‚\n\n3. å¦‚æœæ‹¼æ¥ç©ºå­—ç¬¦ä¸²ï¼Œconcatä¼šç¨å¿«ï¼Œåœ¨é€Ÿåº¦ä¸Šä¸¤è€…å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œå¦‚æœæ‹¼æ¥æ›´å¤šå­—ç¬¦ä¸²å»ºè®®ç”¨StringBuilderã€‚\n\n4. ä»å­—èŠ‚ç æ¥çœ‹+å·ç¼–è¯‘åå°±æ˜¯ä½¿ç”¨äº†StringBuileræ¥æ‹¼æ¥ï¼Œæ‰€ä»¥ä¸€è¡Œ+++çš„è¯­å¥å°±ä¼šåˆ›å»ºä¸€ä¸ªStringBuilderï¼Œå¤šæ¡+++è¯­å¥å°±ä¼šåˆ›å»ºå¤šä¸ªï¼Œæ‰€ä»¥ä¸ºä»€ä¹ˆå»ºè®®ç”¨StringBuilderçš„åŸå› ã€‚\n\n","source":"_posts/åŸºç¡€/å­—ç¬¦ä¸²æ‹¼æ¥ + å’Œ concat çš„åŒºåˆ«.md","raw":"---\ntitle: å­—ç¬¦ä¸²æ‹¼æ¥ + å’Œ concat çš„åŒºåˆ«\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: åŸºç¡€\n---\n\n+å’Œconcatéƒ½å¯ä»¥ç”¨æ¥æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œä½†åœ¨ä½¿ç”¨ä¸Šæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Œå…ˆæ¥çœ‹çœ‹è¿™ä¸ªä¾‹å­ã€‚\n\n```\npublic static void main(String[] args) {\n\t// example1\n\tString str1 = \"s1\";\n\tSystem.out.println(str1 + 100);//s1100\n\tSystem.out.println(100 + str1);//100s1\n\n\tString str2 = \"s2\";\n\tstr2 = str2.concat(\"a\").concat(\"bc\");\n\tSystem.out.println(str2);//s2abc\n\n\t// example2\n\tString str3 = \"s3\";\n\tSystem.out.println(str3 + null);//s3null\n\tSystem.out.println(null + str3);//nulls3\n\n\tString str4 = null;\n\tSystem.out.println(str4.concat(\"a\"));//NullPointerException\n\tSystem.out.println(\"a\".concat(str4));//NullPointerException\n}\n```\n\nconcatæºç ï¼š\n\n```\npublic String concat(String str) {\n    int otherLen = str.length();\n    if (otherLen == 0) {\n        return this;\n    }\n    int len = value.length;\n    char buf[] = Arrays.copyOf(value, len + otherLen);\n    str.getChars(buf, len);\n    return new String(buf, true);\n}\n```\n\nçœ‹ä¸‹ç”Ÿæˆçš„å­—èŠ‚ç ï¼š\n\n\n#### æ‰€ä»¥å¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š\n\n1. +å¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–è€…æ•°å­—åŠå…¶ä»–åŸºæœ¬ç±»å‹æ•°æ®ï¼Œè€Œconcatåªèƒ½æ¥æ”¶å­—ç¬¦ä¸²ã€‚\n\n2. +å·¦å³å¯ä»¥ä¸ºnullï¼Œconcatä¸ºä¼šç©ºæŒ‡é’ˆã€‚\n\n3. å¦‚æœæ‹¼æ¥ç©ºå­—ç¬¦ä¸²ï¼Œconcatä¼šç¨å¿«ï¼Œåœ¨é€Ÿåº¦ä¸Šä¸¤è€…å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œå¦‚æœæ‹¼æ¥æ›´å¤šå­—ç¬¦ä¸²å»ºè®®ç”¨StringBuilderã€‚\n\n4. ä»å­—èŠ‚ç æ¥çœ‹+å·ç¼–è¯‘åå°±æ˜¯ä½¿ç”¨äº†StringBuileræ¥æ‹¼æ¥ï¼Œæ‰€ä»¥ä¸€è¡Œ+++çš„è¯­å¥å°±ä¼šåˆ›å»ºä¸€ä¸ªStringBuilderï¼Œå¤šæ¡+++è¯­å¥å°±ä¼šåˆ›å»ºå¤šä¸ªï¼Œæ‰€ä»¥ä¸ºä»€ä¹ˆå»ºè®®ç”¨StringBuilderçš„åŸå› ã€‚\n\n","slug":"åŸºç¡€/å­—ç¬¦ä¸²æ‹¼æ¥ + å’Œ concat çš„åŒºåˆ«","published":1,"updated":"2025-10-15T07:19:51.789Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076y004fqkd4aol40svf","content":"<p>+å’Œconcatéƒ½å¯ä»¥ç”¨æ¥æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œä½†åœ¨ä½¿ç”¨ä¸Šæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Œå…ˆæ¥çœ‹çœ‹è¿™ä¸ªä¾‹å­ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n\t&#x2F;&#x2F; example1\n\tString str1 &#x3D; &quot;s1&quot;;\n\tSystem.out.println(str1 + 100);&#x2F;&#x2F;s1100\n\tSystem.out.println(100 + str1);&#x2F;&#x2F;100s1\n\n\tString str2 &#x3D; &quot;s2&quot;;\n\tstr2 &#x3D; str2.concat(&quot;a&quot;).concat(&quot;bc&quot;);\n\tSystem.out.println(str2);&#x2F;&#x2F;s2abc\n\n\t&#x2F;&#x2F; example2\n\tString str3 &#x3D; &quot;s3&quot;;\n\tSystem.out.println(str3 + null);&#x2F;&#x2F;s3null\n\tSystem.out.println(null + str3);&#x2F;&#x2F;nulls3\n\n\tString str4 &#x3D; null;\n\tSystem.out.println(str4.concat(&quot;a&quot;));&#x2F;&#x2F;NullPointerException\n\tSystem.out.println(&quot;a&quot;.concat(str4));&#x2F;&#x2F;NullPointerException\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>concatæºç ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public String concat(String str) &#123;\n    int otherLen &#x3D; str.length();\n    if (otherLen &#x3D;&#x3D; 0) &#123;\n        return this;\n    &#125;\n    int len &#x3D; value.length;\n    char buf[] &#x3D; Arrays.copyOf(value, len + otherLen);\n    str.getChars(buf, len);\n    return new String(buf, true);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>çœ‹ä¸‹ç”Ÿæˆçš„å­—èŠ‚ç ï¼š</p>\n<h4 id=\"æ‰€ä»¥å¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š\"><a href=\"#æ‰€ä»¥å¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š\" class=\"headerlink\" title=\"æ‰€ä»¥å¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š\"></a>æ‰€ä»¥å¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š</h4><ol>\n<li><p>+å¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–è€…æ•°å­—åŠå…¶ä»–åŸºæœ¬ç±»å‹æ•°æ®ï¼Œè€Œconcatåªèƒ½æ¥æ”¶å­—ç¬¦ä¸²ã€‚</p>\n</li>\n<li><p>+å·¦å³å¯ä»¥ä¸ºnullï¼Œconcatä¸ºä¼šç©ºæŒ‡é’ˆã€‚</p>\n</li>\n<li><p>å¦‚æœæ‹¼æ¥ç©ºå­—ç¬¦ä¸²ï¼Œconcatä¼šç¨å¿«ï¼Œåœ¨é€Ÿåº¦ä¸Šä¸¤è€…å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œå¦‚æœæ‹¼æ¥æ›´å¤šå­—ç¬¦ä¸²å»ºè®®ç”¨StringBuilderã€‚</p>\n</li>\n<li><p>ä»å­—èŠ‚ç æ¥çœ‹+å·ç¼–è¯‘åå°±æ˜¯ä½¿ç”¨äº†StringBuileræ¥æ‹¼æ¥ï¼Œæ‰€ä»¥ä¸€è¡Œ+++çš„è¯­å¥å°±ä¼šåˆ›å»ºä¸€ä¸ªStringBuilderï¼Œå¤šæ¡+++è¯­å¥å°±ä¼šåˆ›å»ºå¤šä¸ªï¼Œæ‰€ä»¥ä¸ºä»€ä¹ˆå»ºè®®ç”¨StringBuilderçš„åŸå› ã€‚</p>\n</li>\n</ol>\n","excerpt":"","more":"<p>+å’Œconcatéƒ½å¯ä»¥ç”¨æ¥æ‹¼æ¥å­—ç¬¦ä¸²ï¼Œä½†åœ¨ä½¿ç”¨ä¸Šæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Œå…ˆæ¥çœ‹çœ‹è¿™ä¸ªä¾‹å­ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n\t&#x2F;&#x2F; example1\n\tString str1 &#x3D; &quot;s1&quot;;\n\tSystem.out.println(str1 + 100);&#x2F;&#x2F;s1100\n\tSystem.out.println(100 + str1);&#x2F;&#x2F;100s1\n\n\tString str2 &#x3D; &quot;s2&quot;;\n\tstr2 &#x3D; str2.concat(&quot;a&quot;).concat(&quot;bc&quot;);\n\tSystem.out.println(str2);&#x2F;&#x2F;s2abc\n\n\t&#x2F;&#x2F; example2\n\tString str3 &#x3D; &quot;s3&quot;;\n\tSystem.out.println(str3 + null);&#x2F;&#x2F;s3null\n\tSystem.out.println(null + str3);&#x2F;&#x2F;nulls3\n\n\tString str4 &#x3D; null;\n\tSystem.out.println(str4.concat(&quot;a&quot;));&#x2F;&#x2F;NullPointerException\n\tSystem.out.println(&quot;a&quot;.concat(str4));&#x2F;&#x2F;NullPointerException\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>concatæºç ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public String concat(String str) &#123;\n    int otherLen &#x3D; str.length();\n    if (otherLen &#x3D;&#x3D; 0) &#123;\n        return this;\n    &#125;\n    int len &#x3D; value.length;\n    char buf[] &#x3D; Arrays.copyOf(value, len + otherLen);\n    str.getChars(buf, len);\n    return new String(buf, true);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>çœ‹ä¸‹ç”Ÿæˆçš„å­—èŠ‚ç ï¼š</p>\n<h4 id=\"æ‰€ä»¥å¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š\"><a href=\"#æ‰€ä»¥å¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š\" class=\"headerlink\" title=\"æ‰€ä»¥å¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š\"></a>æ‰€ä»¥å¯ä»¥å¾—å‡ºä»¥ä¸‹ç»“è®ºï¼š</h4><ol>\n<li><p>+å¯ä»¥æ˜¯å­—ç¬¦ä¸²æˆ–è€…æ•°å­—åŠå…¶ä»–åŸºæœ¬ç±»å‹æ•°æ®ï¼Œè€Œconcatåªèƒ½æ¥æ”¶å­—ç¬¦ä¸²ã€‚</p>\n</li>\n<li><p>+å·¦å³å¯ä»¥ä¸ºnullï¼Œconcatä¸ºä¼šç©ºæŒ‡é’ˆã€‚</p>\n</li>\n<li><p>å¦‚æœæ‹¼æ¥ç©ºå­—ç¬¦ä¸²ï¼Œconcatä¼šç¨å¿«ï¼Œåœ¨é€Ÿåº¦ä¸Šä¸¤è€…å¯ä»¥å¿½ç•¥ä¸è®¡ï¼Œå¦‚æœæ‹¼æ¥æ›´å¤šå­—ç¬¦ä¸²å»ºè®®ç”¨StringBuilderã€‚</p>\n</li>\n<li><p>ä»å­—èŠ‚ç æ¥çœ‹+å·ç¼–è¯‘åå°±æ˜¯ä½¿ç”¨äº†StringBuileræ¥æ‹¼æ¥ï¼Œæ‰€ä»¥ä¸€è¡Œ+++çš„è¯­å¥å°±ä¼šåˆ›å»ºä¸€ä¸ªStringBuilderï¼Œå¤šæ¡+++è¯­å¥å°±ä¼šåˆ›å»ºå¤šä¸ªï¼Œæ‰€ä»¥ä¸ºä»€ä¹ˆå»ºè®®ç”¨StringBuilderçš„åŸå› ã€‚</p>\n</li>\n</ol>\n"},{"title":"å¸¸è§çš„ 3 ç§ Class çº§åˆ«çš„é”™è¯¯","date":"2025-10-14T06:42:34.000Z","_content":"\n## ClassNotFoundException\n\nå¾ˆæ˜æ˜¾ï¼Œè¿™ä¸ªé”™è¯¯æ˜¯`æ‰¾ä¸åˆ°ç±»å¼‚å¸¸`ï¼Œå³åœ¨å½“å‰classpathè·¯å¾„ä¸‹æ‰¾ä¸åˆ°è¿™ä¸ªç±»ã€‚\n\nClassNotFoundExceptionç»§æ‰¿äº†Exceptionï¼Œæ˜¯å¿…é¡»æ•è·çš„å¼‚å¸¸ï¼Œæ‰€ä»¥è¿™ä¸ªå¼‚å¸¸ä¸€èˆ¬å‘ç”Ÿåœ¨æ˜¾ç¤ºåŠ è½½ç±»çš„æ—¶å€™ï¼Œå¦‚ä¸‹é¢ä¸¤ç§æ–¹å¼æ˜¾ç¤ºæ¥åŠ è½½ç±»å¹¶è¦æ•è·å¼‚å¸¸ã€‚\n\n```\npublic static void main(String[] args) {\n    try {\n        Class.forName(\"com.User\");\n    } catch (ClassNotFoundException e) {\n        e.printStackTrace();\n    }\n\n    try {\n        Test.class.getClassLoader().loadClass(\"com.User\");\n    } catch (ClassNotFoundException e) {\n        e.printStackTrace();\n    }\n\n}\n```\nå½“æ— æ³•æ‰¾åˆ°å¯¹åº”çš„ç±»æ—¶éƒ½ä¼šæŠ›å‡ºClassNotFoundExceptionå¼‚å¸¸ã€‚\n\n```\njava.lang.ClassNotFoundException: com.User\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:381)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:424)\n\tat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:331)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:357)\n\tat com.test.user.Test.main(Test.java:15)\n```\n\n## NoClassDefFoundError\n\nè¿™æ˜¯è™šæ‹Ÿæœºéšå¼åŠ è½½ç±»å‡ºç°çš„å¼‚å¸¸ã€‚\n\nè¿™ä¸ªå¼‚å¸¸ç»§æ‰¿äº†Errorç±»ï¼Œä¸€èˆ¬å‘ç”Ÿåœ¨å¼•ç”¨çš„ç±»ä¸å­˜åœ¨ï¼Œå³ç±»ã€æ–¹æ³•æˆ–è€…å±æ€§å¼•ç”¨äº†æŸä¸ªç±»æˆ–è€…æ¥å£ï¼Œå¦‚æœç›®æ ‡å¼•ç”¨ä¸å­˜åœ¨å°±ä¼šæŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ã€‚\n\n```\nimport org.jdom2.input.DOMBuilder;\npublic class MyDomBuilder extends DOMBuilder{\n\n}\n```\n```\npublic static void main(String[] args) {\n    MyDomBuilder builder = new MyDomBuilder();\n}\n```\nMyDomBuilderç»§æ‰¿äº†DOMBuilderï¼Œå¦‚æœæŠŠDOMBuilderæ‰€å±çš„jaråŒ…èŒƒå›´è®¾ç½®ä¸ºprovidedï¼Œå³è¿è¡Œæ—¶æ‰¾ä¸åˆ°DOMBuilderç±»å°±ä¼šæŠ¥é”™ã€‚\n```\nException in thread \"main\" java.lang.NoClassDefFoundError: org/jdom2/input/DOMBuilder\n\tat java.lang.ClassLoader.defineClass1(Native Method)\n\tat java.lang.ClassLoader.defineClass(ClassLoader.java:763)\n\tat java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)\n\tat java.net.URLClassLoader.defineClass(URLClassLoader.java:467)\n\tat java.net.URLClassLoader.access$100(URLClassLoader.java:73)\n\tat java.net.URLClassLoader$1.run(URLClassLoader.java:368)\n\tat java.net.URLClassLoader$1.run(URLClassLoader.java:362)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:361)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:424)\n\tat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:331)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:357)\n\tat com.test.user.Test.main(Test.java:8)\nCaused by: java.lang.ClassNotFoundException: org.jdom2.input.DOMBuilder\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:381)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:424)\n\tat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:331)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:357)\n\t... 13 more\n```\nå…ˆæŠ¥å‡ºClassNotFoundExceptionï¼Œç„¶åå¼•å‘NoClassDefFoundErrorã€‚\n\næ‰€ä»¥ï¼Œä»¥ä¸Šä¸¤ä¸ªé”™è¯¯éƒ½è¦ç¡®ä¿åŠ è½½ç±»æˆ–è€…å¼•ç”¨ç±»éƒ½è¦åœ¨classpathè·¯å¾„ä¸‹ã€‚\n\n## ClassCastException\n\nç±»è½¬æ¢å¼‚å¸¸ï¼Œè¿™ä¸ªé”™è¯¯ä¸€èˆ¬å‘ç”Ÿåœ¨ä¸€ä¸ªå¯¹è±¡å¼ºåˆ¶è½¬æ¢ç±»å‹çš„æ—¶å€™ï¼Œå¦‚å°†ä¸€ä¸ªStringå¼ºåˆ¶è½¬æ¢æˆIntegerå°±ä¼šæŠ¥è¿™ä¸ªé”™ã€‚\n\nè¿™ä¸ªå¼‚å¸¸ç»§æ‰¿äº†è¿è¡Œæ—¶å¼‚å¸¸RuntimeExceptionï¼Œä¸éœ€è¦æ•è·çš„å¼‚å¸¸ã€‚ä¸ºäº†é¿å…æŠ¥è¿™ä¸ªé”™ï¼Œåœ¨è½¬æ¢ä¹‹é—´å¯ä»¥å…ˆç”¨instanceofåˆ¤æ–­ä¸‹æ˜¯ä¸æ˜¯è¯¥ç±»çš„å¼•ç”¨å†è½¬æ¢ã€‚å¦‚æœæ˜¯é›†åˆç±»å‹ï¼Œæœ€å¥½æŒ‡å®šé›†åˆé‡Œé¢çš„æ³›å‹ã€‚\n\n\n```\npublic static void main(String[] args) {\n    Object str = \"123\";\n    Integer i = (Integer)str;\n}\n```\n\nå­—ç¬¦ä¸²\"123\"å¼ºåˆ¶è½¬æ¢æˆIntegerï¼Œç„¶åæŠ¥é”™ã€‚\n\n```\nException in thread \"main\" java.lang.ClassCastException: java.lang.String cannot be cast to java.lang.Integer\n\tat com.test.user.Test.main(Test.java:9)\n```\n\n","source":"_posts/åŸºç¡€/å¸¸è§çš„ 3 ç§ Class çº§åˆ«çš„é”™è¯¯.md","raw":"---\ntitle: å¸¸è§çš„ 3 ç§ Class çº§åˆ«çš„é”™è¯¯\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: åŸºç¡€\n---\n\n## ClassNotFoundException\n\nå¾ˆæ˜æ˜¾ï¼Œè¿™ä¸ªé”™è¯¯æ˜¯`æ‰¾ä¸åˆ°ç±»å¼‚å¸¸`ï¼Œå³åœ¨å½“å‰classpathè·¯å¾„ä¸‹æ‰¾ä¸åˆ°è¿™ä¸ªç±»ã€‚\n\nClassNotFoundExceptionç»§æ‰¿äº†Exceptionï¼Œæ˜¯å¿…é¡»æ•è·çš„å¼‚å¸¸ï¼Œæ‰€ä»¥è¿™ä¸ªå¼‚å¸¸ä¸€èˆ¬å‘ç”Ÿåœ¨æ˜¾ç¤ºåŠ è½½ç±»çš„æ—¶å€™ï¼Œå¦‚ä¸‹é¢ä¸¤ç§æ–¹å¼æ˜¾ç¤ºæ¥åŠ è½½ç±»å¹¶è¦æ•è·å¼‚å¸¸ã€‚\n\n```\npublic static void main(String[] args) {\n    try {\n        Class.forName(\"com.User\");\n    } catch (ClassNotFoundException e) {\n        e.printStackTrace();\n    }\n\n    try {\n        Test.class.getClassLoader().loadClass(\"com.User\");\n    } catch (ClassNotFoundException e) {\n        e.printStackTrace();\n    }\n\n}\n```\nå½“æ— æ³•æ‰¾åˆ°å¯¹åº”çš„ç±»æ—¶éƒ½ä¼šæŠ›å‡ºClassNotFoundExceptionå¼‚å¸¸ã€‚\n\n```\njava.lang.ClassNotFoundException: com.User\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:381)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:424)\n\tat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:331)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:357)\n\tat com.test.user.Test.main(Test.java:15)\n```\n\n## NoClassDefFoundError\n\nè¿™æ˜¯è™šæ‹Ÿæœºéšå¼åŠ è½½ç±»å‡ºç°çš„å¼‚å¸¸ã€‚\n\nè¿™ä¸ªå¼‚å¸¸ç»§æ‰¿äº†Errorç±»ï¼Œä¸€èˆ¬å‘ç”Ÿåœ¨å¼•ç”¨çš„ç±»ä¸å­˜åœ¨ï¼Œå³ç±»ã€æ–¹æ³•æˆ–è€…å±æ€§å¼•ç”¨äº†æŸä¸ªç±»æˆ–è€…æ¥å£ï¼Œå¦‚æœç›®æ ‡å¼•ç”¨ä¸å­˜åœ¨å°±ä¼šæŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ã€‚\n\n```\nimport org.jdom2.input.DOMBuilder;\npublic class MyDomBuilder extends DOMBuilder{\n\n}\n```\n```\npublic static void main(String[] args) {\n    MyDomBuilder builder = new MyDomBuilder();\n}\n```\nMyDomBuilderç»§æ‰¿äº†DOMBuilderï¼Œå¦‚æœæŠŠDOMBuilderæ‰€å±çš„jaråŒ…èŒƒå›´è®¾ç½®ä¸ºprovidedï¼Œå³è¿è¡Œæ—¶æ‰¾ä¸åˆ°DOMBuilderç±»å°±ä¼šæŠ¥é”™ã€‚\n```\nException in thread \"main\" java.lang.NoClassDefFoundError: org/jdom2/input/DOMBuilder\n\tat java.lang.ClassLoader.defineClass1(Native Method)\n\tat java.lang.ClassLoader.defineClass(ClassLoader.java:763)\n\tat java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)\n\tat java.net.URLClassLoader.defineClass(URLClassLoader.java:467)\n\tat java.net.URLClassLoader.access$100(URLClassLoader.java:73)\n\tat java.net.URLClassLoader$1.run(URLClassLoader.java:368)\n\tat java.net.URLClassLoader$1.run(URLClassLoader.java:362)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:361)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:424)\n\tat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:331)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:357)\n\tat com.test.user.Test.main(Test.java:8)\nCaused by: java.lang.ClassNotFoundException: org.jdom2.input.DOMBuilder\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:381)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:424)\n\tat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:331)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:357)\n\t... 13 more\n```\nå…ˆæŠ¥å‡ºClassNotFoundExceptionï¼Œç„¶åå¼•å‘NoClassDefFoundErrorã€‚\n\næ‰€ä»¥ï¼Œä»¥ä¸Šä¸¤ä¸ªé”™è¯¯éƒ½è¦ç¡®ä¿åŠ è½½ç±»æˆ–è€…å¼•ç”¨ç±»éƒ½è¦åœ¨classpathè·¯å¾„ä¸‹ã€‚\n\n## ClassCastException\n\nç±»è½¬æ¢å¼‚å¸¸ï¼Œè¿™ä¸ªé”™è¯¯ä¸€èˆ¬å‘ç”Ÿåœ¨ä¸€ä¸ªå¯¹è±¡å¼ºåˆ¶è½¬æ¢ç±»å‹çš„æ—¶å€™ï¼Œå¦‚å°†ä¸€ä¸ªStringå¼ºåˆ¶è½¬æ¢æˆIntegerå°±ä¼šæŠ¥è¿™ä¸ªé”™ã€‚\n\nè¿™ä¸ªå¼‚å¸¸ç»§æ‰¿äº†è¿è¡Œæ—¶å¼‚å¸¸RuntimeExceptionï¼Œä¸éœ€è¦æ•è·çš„å¼‚å¸¸ã€‚ä¸ºäº†é¿å…æŠ¥è¿™ä¸ªé”™ï¼Œåœ¨è½¬æ¢ä¹‹é—´å¯ä»¥å…ˆç”¨instanceofåˆ¤æ–­ä¸‹æ˜¯ä¸æ˜¯è¯¥ç±»çš„å¼•ç”¨å†è½¬æ¢ã€‚å¦‚æœæ˜¯é›†åˆç±»å‹ï¼Œæœ€å¥½æŒ‡å®šé›†åˆé‡Œé¢çš„æ³›å‹ã€‚\n\n\n```\npublic static void main(String[] args) {\n    Object str = \"123\";\n    Integer i = (Integer)str;\n}\n```\n\nå­—ç¬¦ä¸²\"123\"å¼ºåˆ¶è½¬æ¢æˆIntegerï¼Œç„¶åæŠ¥é”™ã€‚\n\n```\nException in thread \"main\" java.lang.ClassCastException: java.lang.String cannot be cast to java.lang.Integer\n\tat com.test.user.Test.main(Test.java:9)\n```\n\n","slug":"åŸºç¡€/å¸¸è§çš„ 3 ç§ Class çº§åˆ«çš„é”™è¯¯","published":1,"updated":"2025-10-15T07:19:51.893Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076y004iqkd415ts7h45","content":"<h2 id=\"ClassNotFoundException\"><a href=\"#ClassNotFoundException\" class=\"headerlink\" title=\"ClassNotFoundException\"></a>ClassNotFoundException</h2><p>å¾ˆæ˜æ˜¾ï¼Œè¿™ä¸ªé”™è¯¯æ˜¯<code>æ‰¾ä¸åˆ°ç±»å¼‚å¸¸</code>ï¼Œå³åœ¨å½“å‰classpathè·¯å¾„ä¸‹æ‰¾ä¸åˆ°è¿™ä¸ªç±»ã€‚</p>\n<p>ClassNotFoundExceptionç»§æ‰¿äº†Exceptionï¼Œæ˜¯å¿…é¡»æ•è·çš„å¼‚å¸¸ï¼Œæ‰€ä»¥è¿™ä¸ªå¼‚å¸¸ä¸€èˆ¬å‘ç”Ÿåœ¨æ˜¾ç¤ºåŠ è½½ç±»çš„æ—¶å€™ï¼Œå¦‚ä¸‹é¢ä¸¤ç§æ–¹å¼æ˜¾ç¤ºæ¥åŠ è½½ç±»å¹¶è¦æ•è·å¼‚å¸¸ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n    try &#123;\n        Class.forName(&quot;com.User&quot;);\n    &#125; catch (ClassNotFoundException e) &#123;\n        e.printStackTrace();\n    &#125;\n\n    try &#123;\n        Test.class.getClassLoader().loadClass(&quot;com.User&quot;);\n    &#125; catch (ClassNotFoundException e) &#123;\n        e.printStackTrace();\n    &#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>å½“æ— æ³•æ‰¾åˆ°å¯¹åº”çš„ç±»æ—¶éƒ½ä¼šæŠ›å‡ºClassNotFoundExceptionå¼‚å¸¸ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">java.lang.ClassNotFoundException: com.User\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:381)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:424)\n\tat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:331)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:357)\n\tat com.test.user.Test.main(Test.java:15)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"NoClassDefFoundError\"><a href=\"#NoClassDefFoundError\" class=\"headerlink\" title=\"NoClassDefFoundError\"></a>NoClassDefFoundError</h2><p>è¿™æ˜¯è™šæ‹Ÿæœºéšå¼åŠ è½½ç±»å‡ºç°çš„å¼‚å¸¸ã€‚</p>\n<p>è¿™ä¸ªå¼‚å¸¸ç»§æ‰¿äº†Errorç±»ï¼Œä¸€èˆ¬å‘ç”Ÿåœ¨å¼•ç”¨çš„ç±»ä¸å­˜åœ¨ï¼Œå³ç±»ã€æ–¹æ³•æˆ–è€…å±æ€§å¼•ç”¨äº†æŸä¸ªç±»æˆ–è€…æ¥å£ï¼Œå¦‚æœç›®æ ‡å¼•ç”¨ä¸å­˜åœ¨å°±ä¼šæŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">import org.jdom2.input.DOMBuilder;\npublic class MyDomBuilder extends DOMBuilder&#123;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n    MyDomBuilder builder &#x3D; new MyDomBuilder();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>MyDomBuilderç»§æ‰¿äº†DOMBuilderï¼Œå¦‚æœæŠŠDOMBuilderæ‰€å±çš„jaråŒ…èŒƒå›´è®¾ç½®ä¸ºprovidedï¼Œå³è¿è¡Œæ—¶æ‰¾ä¸åˆ°DOMBuilderç±»å°±ä¼šæŠ¥é”™ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Exception in thread &quot;main&quot; java.lang.NoClassDefFoundError: org&#x2F;jdom2&#x2F;input&#x2F;DOMBuilder\n\tat java.lang.ClassLoader.defineClass1(Native Method)\n\tat java.lang.ClassLoader.defineClass(ClassLoader.java:763)\n\tat java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)\n\tat java.net.URLClassLoader.defineClass(URLClassLoader.java:467)\n\tat java.net.URLClassLoader.access$100(URLClassLoader.java:73)\n\tat java.net.URLClassLoader$1.run(URLClassLoader.java:368)\n\tat java.net.URLClassLoader$1.run(URLClassLoader.java:362)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:361)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:424)\n\tat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:331)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:357)\n\tat com.test.user.Test.main(Test.java:8)\nCaused by: java.lang.ClassNotFoundException: org.jdom2.input.DOMBuilder\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:381)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:424)\n\tat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:331)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:357)\n\t... 13 more<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>å…ˆæŠ¥å‡ºClassNotFoundExceptionï¼Œç„¶åå¼•å‘NoClassDefFoundErrorã€‚</p>\n<p>æ‰€ä»¥ï¼Œä»¥ä¸Šä¸¤ä¸ªé”™è¯¯éƒ½è¦ç¡®ä¿åŠ è½½ç±»æˆ–è€…å¼•ç”¨ç±»éƒ½è¦åœ¨classpathè·¯å¾„ä¸‹ã€‚</p>\n<h2 id=\"ClassCastException\"><a href=\"#ClassCastException\" class=\"headerlink\" title=\"ClassCastException\"></a>ClassCastException</h2><p>ç±»è½¬æ¢å¼‚å¸¸ï¼Œè¿™ä¸ªé”™è¯¯ä¸€èˆ¬å‘ç”Ÿåœ¨ä¸€ä¸ªå¯¹è±¡å¼ºåˆ¶è½¬æ¢ç±»å‹çš„æ—¶å€™ï¼Œå¦‚å°†ä¸€ä¸ªStringå¼ºåˆ¶è½¬æ¢æˆIntegerå°±ä¼šæŠ¥è¿™ä¸ªé”™ã€‚</p>\n<p>è¿™ä¸ªå¼‚å¸¸ç»§æ‰¿äº†è¿è¡Œæ—¶å¼‚å¸¸RuntimeExceptionï¼Œä¸éœ€è¦æ•è·çš„å¼‚å¸¸ã€‚ä¸ºäº†é¿å…æŠ¥è¿™ä¸ªé”™ï¼Œåœ¨è½¬æ¢ä¹‹é—´å¯ä»¥å…ˆç”¨instanceofåˆ¤æ–­ä¸‹æ˜¯ä¸æ˜¯è¯¥ç±»çš„å¼•ç”¨å†è½¬æ¢ã€‚å¦‚æœæ˜¯é›†åˆç±»å‹ï¼Œæœ€å¥½æŒ‡å®šé›†åˆé‡Œé¢çš„æ³›å‹ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n    Object str &#x3D; &quot;123&quot;;\n    Integer i &#x3D; (Integer)str;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å­—ç¬¦ä¸²â€123â€å¼ºåˆ¶è½¬æ¢æˆIntegerï¼Œç„¶åæŠ¥é”™ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Exception in thread &quot;main&quot; java.lang.ClassCastException: java.lang.String cannot be cast to java.lang.Integer\n\tat com.test.user.Test.main(Test.java:9)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n","excerpt":"","more":"<h2 id=\"ClassNotFoundException\"><a href=\"#ClassNotFoundException\" class=\"headerlink\" title=\"ClassNotFoundException\"></a>ClassNotFoundException</h2><p>å¾ˆæ˜æ˜¾ï¼Œè¿™ä¸ªé”™è¯¯æ˜¯<code>æ‰¾ä¸åˆ°ç±»å¼‚å¸¸</code>ï¼Œå³åœ¨å½“å‰classpathè·¯å¾„ä¸‹æ‰¾ä¸åˆ°è¿™ä¸ªç±»ã€‚</p>\n<p>ClassNotFoundExceptionç»§æ‰¿äº†Exceptionï¼Œæ˜¯å¿…é¡»æ•è·çš„å¼‚å¸¸ï¼Œæ‰€ä»¥è¿™ä¸ªå¼‚å¸¸ä¸€èˆ¬å‘ç”Ÿåœ¨æ˜¾ç¤ºåŠ è½½ç±»çš„æ—¶å€™ï¼Œå¦‚ä¸‹é¢ä¸¤ç§æ–¹å¼æ˜¾ç¤ºæ¥åŠ è½½ç±»å¹¶è¦æ•è·å¼‚å¸¸ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n    try &#123;\n        Class.forName(&quot;com.User&quot;);\n    &#125; catch (ClassNotFoundException e) &#123;\n        e.printStackTrace();\n    &#125;\n\n    try &#123;\n        Test.class.getClassLoader().loadClass(&quot;com.User&quot;);\n    &#125; catch (ClassNotFoundException e) &#123;\n        e.printStackTrace();\n    &#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>å½“æ— æ³•æ‰¾åˆ°å¯¹åº”çš„ç±»æ—¶éƒ½ä¼šæŠ›å‡ºClassNotFoundExceptionå¼‚å¸¸ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">java.lang.ClassNotFoundException: com.User\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:381)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:424)\n\tat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:331)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:357)\n\tat com.test.user.Test.main(Test.java:15)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"NoClassDefFoundError\"><a href=\"#NoClassDefFoundError\" class=\"headerlink\" title=\"NoClassDefFoundError\"></a>NoClassDefFoundError</h2><p>è¿™æ˜¯è™šæ‹Ÿæœºéšå¼åŠ è½½ç±»å‡ºç°çš„å¼‚å¸¸ã€‚</p>\n<p>è¿™ä¸ªå¼‚å¸¸ç»§æ‰¿äº†Errorç±»ï¼Œä¸€èˆ¬å‘ç”Ÿåœ¨å¼•ç”¨çš„ç±»ä¸å­˜åœ¨ï¼Œå³ç±»ã€æ–¹æ³•æˆ–è€…å±æ€§å¼•ç”¨äº†æŸä¸ªç±»æˆ–è€…æ¥å£ï¼Œå¦‚æœç›®æ ‡å¼•ç”¨ä¸å­˜åœ¨å°±ä¼šæŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">import org.jdom2.input.DOMBuilder;\npublic class MyDomBuilder extends DOMBuilder&#123;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n    MyDomBuilder builder &#x3D; new MyDomBuilder();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>MyDomBuilderç»§æ‰¿äº†DOMBuilderï¼Œå¦‚æœæŠŠDOMBuilderæ‰€å±çš„jaråŒ…èŒƒå›´è®¾ç½®ä¸ºprovidedï¼Œå³è¿è¡Œæ—¶æ‰¾ä¸åˆ°DOMBuilderç±»å°±ä¼šæŠ¥é”™ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Exception in thread &quot;main&quot; java.lang.NoClassDefFoundError: org&#x2F;jdom2&#x2F;input&#x2F;DOMBuilder\n\tat java.lang.ClassLoader.defineClass1(Native Method)\n\tat java.lang.ClassLoader.defineClass(ClassLoader.java:763)\n\tat java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)\n\tat java.net.URLClassLoader.defineClass(URLClassLoader.java:467)\n\tat java.net.URLClassLoader.access$100(URLClassLoader.java:73)\n\tat java.net.URLClassLoader$1.run(URLClassLoader.java:368)\n\tat java.net.URLClassLoader$1.run(URLClassLoader.java:362)\n\tat java.security.AccessController.doPrivileged(Native Method)\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:361)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:424)\n\tat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:331)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:357)\n\tat com.test.user.Test.main(Test.java:8)\nCaused by: java.lang.ClassNotFoundException: org.jdom2.input.DOMBuilder\n\tat java.net.URLClassLoader.findClass(URLClassLoader.java:381)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:424)\n\tat sun.misc.Launcher$AppClassLoader.loadClass(Launcher.java:331)\n\tat java.lang.ClassLoader.loadClass(ClassLoader.java:357)\n\t... 13 more<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>å…ˆæŠ¥å‡ºClassNotFoundExceptionï¼Œç„¶åå¼•å‘NoClassDefFoundErrorã€‚</p>\n<p>æ‰€ä»¥ï¼Œä»¥ä¸Šä¸¤ä¸ªé”™è¯¯éƒ½è¦ç¡®ä¿åŠ è½½ç±»æˆ–è€…å¼•ç”¨ç±»éƒ½è¦åœ¨classpathè·¯å¾„ä¸‹ã€‚</p>\n<h2 id=\"ClassCastException\"><a href=\"#ClassCastException\" class=\"headerlink\" title=\"ClassCastException\"></a>ClassCastException</h2><p>ç±»è½¬æ¢å¼‚å¸¸ï¼Œè¿™ä¸ªé”™è¯¯ä¸€èˆ¬å‘ç”Ÿåœ¨ä¸€ä¸ªå¯¹è±¡å¼ºåˆ¶è½¬æ¢ç±»å‹çš„æ—¶å€™ï¼Œå¦‚å°†ä¸€ä¸ªStringå¼ºåˆ¶è½¬æ¢æˆIntegerå°±ä¼šæŠ¥è¿™ä¸ªé”™ã€‚</p>\n<p>è¿™ä¸ªå¼‚å¸¸ç»§æ‰¿äº†è¿è¡Œæ—¶å¼‚å¸¸RuntimeExceptionï¼Œä¸éœ€è¦æ•è·çš„å¼‚å¸¸ã€‚ä¸ºäº†é¿å…æŠ¥è¿™ä¸ªé”™ï¼Œåœ¨è½¬æ¢ä¹‹é—´å¯ä»¥å…ˆç”¨instanceofåˆ¤æ–­ä¸‹æ˜¯ä¸æ˜¯è¯¥ç±»çš„å¼•ç”¨å†è½¬æ¢ã€‚å¦‚æœæ˜¯é›†åˆç±»å‹ï¼Œæœ€å¥½æŒ‡å®šé›†åˆé‡Œé¢çš„æ³›å‹ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n    Object str &#x3D; &quot;123&quot;;\n    Integer i &#x3D; (Integer)str;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å­—ç¬¦ä¸²â€123â€å¼ºåˆ¶è½¬æ¢æˆIntegerï¼Œç„¶åæŠ¥é”™ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Exception in thread &quot;main&quot; java.lang.ClassCastException: java.lang.String cannot be cast to java.lang.Integer\n\tat com.test.user.Test.main(Test.java:9)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n"},{"title":"æ·±å…¥æµ…å‡º Java ä¸­çš„åŒ…è£…ç±»","date":"2025-10-14T06:42:34.000Z","_content":"\n![](http://img.javastack.cn/18-6-5/61544442.jpg)\n\n#### ä»€ä¹ˆæ˜¯åŒ…è£…ç±»å‹\n\nJava è®¾è®¡å½“åˆå°±æä¾›äº† 8 ç§ åŸºæœ¬æ•°æ®ç±»å‹åŠå¯¹åº”çš„ 8 ç§åŒ…è£…æ•°æ®ç±»å‹ã€‚æˆ‘ä»¬çŸ¥é“ Java æ˜¯ä¸€ç§é¢å‘å¯¹è±¡ç¼–ç¨‹çš„é«˜çº§è¯­è¨€ï¼Œæ‰€ä»¥åŒ…è£…ç±»å‹æ­£æ˜¯ä¸ºäº†è§£å†³åŸºæœ¬æ•°æ®ç±»å‹æ— æ³•é¢å‘å¯¹è±¡ç¼–ç¨‹æ‰€æä¾›çš„ã€‚\n\n**ä¸‹é¢æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ä¸å¯¹åº”çš„åŒ…è£…ç±»å‹ã€‚**\n\nåŸºæœ¬æ•°æ®ç±»å‹ | åŒ…è£…ç±»å‹\n---|---\nbyte | Byte\nboolean | Boolean\nshort | Short\nchar | Character\nint | Integer\nlong | Long\nfloat | Float\ndouble | Double\n\n**ä¸‹é¢æ˜¯åŒ…è£…ç±»å‹çš„ç»§æ‰¿ç»“æ„å›¾ã€‚**\n\n![](http://img.javastack.cn/18-6-5/80489463.jpg)\n\nä»ä»¥ä¸Šå›¾è¡¨å¯ä»¥å¯¹åŸºæœ¬ç±»å‹å’ŒåŒ…è£…ç±»å‹æœ‰ä¸€ä¸ªå…¨é¢çš„äº†è§£ã€‚\n\n#### åŒ…è£…ç±»åº”ç”¨åœºæ™¯\n\n**1ã€é›†åˆç±»æ³›å‹åªèƒ½æ˜¯åŒ…è£…ç±»ï¼›**\n\n```\n// ç¼–è¯‘æŠ¥é”™\nList<int> list1 = new ArrayList<>();\n\n// æ­£å¸¸\nList<Integer> list2 = new ArrayList<>();\n```\n\n**2ã€æˆå‘˜å˜é‡ä¸èƒ½æœ‰é»˜è®¤å€¼ï¼›**\n\n```\nprivate int status;\n```\n\nåŸºæœ¬æ•°æ®ç±»å‹çš„æˆå‘˜å˜é‡éƒ½æœ‰é»˜è®¤å€¼ï¼Œå¦‚ä»¥ä¸Šä»£ç  status é»˜è®¤å€¼ä¸º 0ï¼Œå¦‚æœå®šä¹‰ä¸­ 0 ä»£è¡¨å¤±è´¥ï¼Œé‚£æ ·å°±ä¼šæœ‰é—®é¢˜ï¼Œè¿™æ ·åªèƒ½ä½¿ç”¨åŒ…è£…ç±» Integerï¼Œå®ƒçš„é»˜è®¤å€¼ä¸º null,æ‰€ä»¥å°±ä¸ä¼šæœ‰é»˜è®¤å€¼å½±å“ã€‚\n\n**3ã€æ–¹æ³•å‚æ•°å…è®¸å®šä¹‰ç©ºå€¼ï¼›**\n\n```\nprivate static void test1(int status){\n\tSystem.out.println(status);\n}\n```\n\nçœ‹ä»¥ä¸Šä»£ç ï¼Œæ–¹æ³•å‚æ•°å®šä¹‰çš„æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ intï¼Œæ‰€ä»¥å¿…é¡»å¾—ä¼ ä¸€ä¸ªæ•°å­—è¿‡æ¥ï¼Œä¸èƒ½ä¼  nullï¼Œå¾ˆå¤šåœºåˆæˆ‘ä»¬å¸Œæœ›æ˜¯èƒ½ä¼ é€’ null çš„ï¼Œæ‰€ä»¥è¿™ç§åœºåˆç”¨åŒ…è£…ç±»æ¯”è¾ƒåˆé€‚ã€‚\n\nè¿˜æœ‰æ›´å¤šåº”ç”¨åœºæ™¯å°±ä¸ä¸€ä¸€ä¾‹ä¸¾äº†ï¼Œæ¬¢è¿ç•™è¨€å…±åŒæ¢è®¨åŒ…è£…ç±»çš„æ›´å¤šçš„åº”ç”¨åœºæ™¯ã€‚\n\n#### è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±\n\nJava 5 å¢åŠ äº†è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±æœºåˆ¶ï¼Œæä¾›åŸºæœ¬æ•°æ®ç±»å‹å’ŒåŒ…è£…ç±»å‹çš„ç›¸äº’è½¬æ¢æ“ä½œã€‚\n\n\n**è‡ªåŠ¨è£…ç®±**\n\nè‡ªåŠ¨è£…ç®±å³è‡ªåŠ¨å°†åŸºæœ¬æ•°æ®ç±»å‹è½¬æ¢æˆåŒ…è£…ç±»å‹ï¼Œåœ¨ Java 5 ä¹‹å‰ï¼Œè¦å°†åŸºæœ¬æ•°æ®ç±»å‹è½¬æ¢æˆåŒ…è£…ç±»å‹åªèƒ½è¿™æ ·åšï¼Œçœ‹ä¸‹é¢çš„ä»£ç ã€‚\n\n```\nInteger i1 = new Integer(8);\n\nInteger i2 = Integer.valueOf(8);\n\n// è‡ªåŠ¨è£…ç®±\nInteger i3 = 8;\n```\n\nä»¥ä¸Š 3 ç§éƒ½å¯ä»¥è¿›è¡Œè½¬æ¢ï¼Œä½†åœ¨ Java 5 ä¹‹å‰ç¬¬ 3 ç§æ–¹æ³•æ˜¯ç¼–è¯‘å¤±è´¥çš„ï¼Œç¬¬ 3 ç§æ–¹æ³•ä¹Ÿæ­£æ˜¯ç°åœ¨çš„è‡ªåŠ¨è£…ç®±åŠŸèƒ½ã€‚å¦å¤–ï¼Œç¬¬ä¸€ç§æ„é€ å™¨æ–¹æ³•ä¹Ÿä¸æ¨èä½¿ç”¨äº†ï¼Œå·²ç»æ ‡ä¸ºåºŸå¼ƒäº†ã€‚\n\nå…¶å®è‡ªåŠ¨è£…ç®±çš„åŸç†å°±æ˜¯è°ƒç”¨åŒ…è£…ç±»çš„ valueOf æ–¹æ³•ï¼Œå¦‚ç¬¬ 2 ä¸ªæ–¹æ³•ä¸­çš„ Integer.valueOf æ–¹æ³•ã€‚\n\n**è‡ªåŠ¨æ‹†ç®±**\n\nè‡ªåŠ¨æ‹†ç®±å³è‡ªåŠ¨å°†åŒ…è£…ç±»å‹è½¬æ¢æˆåŸºæœ¬æ•°æ®ç±»å‹ï¼Œä¸è‡ªåŠ¨è£…ç®±ç›¸åï¼Œæœ‰è£…å°±æœ‰æ‹†ï¼Œå¾ˆå¥½ç†è§£ã€‚\n\n```\n// è‡ªåŠ¨æ‹†ç®±\nint i4 = i3;\n\nint i5 = i3.intValue();\n```\n\nç»§ç»­ä¸Šé¢çš„ä¾‹å­ï¼ŒæŠŠ i3 èµ‹å€¼ç»™ i4 å°±æ˜¯å®ç°çš„è‡ªåŠ¨æ‹†ç®±åŠŸèƒ½ï¼Œè‡ªåŠ¨è£…ç®±çš„åŸç†å°±æ˜¯è°ƒç”¨åŒ…è£…ç±»çš„ xxValue æ–¹æ³•ï¼Œå¦‚ i5 ä¸­çš„ Integer çš„ intValue æ–¹æ³•ã€‚\n\nè‡ªåŠ¨è£…ç®±ã€æ‹†ç®±ä¸åªæ˜¯ä½“ç°åœ¨ä»¥ä¸Šçš„ä¾‹å­ï¼Œåœ¨æ–¹æ³•æ¥æ”¶å‚æ•°ã€å¯¹è±¡è®¾ç½®å‚æ•°æ—¶éƒ½èƒ½è‡ªåŠ¨è£…ç®±æ‹†ç®±ã€‚\n\n**éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå…³äº Integerï¼Œ-128 ~ 127 ä¼šæœ‰ç¼“å­˜ï¼Œå¯¹æ¯”è¿™ä¸ªèŒƒå›´çš„å€¼çš„å¯¹è±¡æ˜¯ä¸€ä¸ªå‘ï¼Œè¿™ä¸ªåœ¨é˜¿é‡Œå·´å·´è§„èŒƒä¸­ä¹Ÿæœ‰æåŠã€‚** è¯¦ç»†è¯·å‚è€ƒã€Š[IntegerCacheçš„å¦™ç”¨å’Œé™·é˜±](https://mp.weixin.qq.com/s/PnVkrMzYeOiepPKjl4MKVA)ã€‹è¿™ç¯‡æ–‡ç« ã€‚\n\n","source":"_posts/åŸºç¡€/æ·±å…¥æµ…å‡º Java ä¸­çš„åŒ…è£…ç±».md","raw":"---\ntitle: æ·±å…¥æµ…å‡º Java ä¸­çš„åŒ…è£…ç±»\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: åŸºç¡€\n---\n\n![](http://img.javastack.cn/18-6-5/61544442.jpg)\n\n#### ä»€ä¹ˆæ˜¯åŒ…è£…ç±»å‹\n\nJava è®¾è®¡å½“åˆå°±æä¾›äº† 8 ç§ åŸºæœ¬æ•°æ®ç±»å‹åŠå¯¹åº”çš„ 8 ç§åŒ…è£…æ•°æ®ç±»å‹ã€‚æˆ‘ä»¬çŸ¥é“ Java æ˜¯ä¸€ç§é¢å‘å¯¹è±¡ç¼–ç¨‹çš„é«˜çº§è¯­è¨€ï¼Œæ‰€ä»¥åŒ…è£…ç±»å‹æ­£æ˜¯ä¸ºäº†è§£å†³åŸºæœ¬æ•°æ®ç±»å‹æ— æ³•é¢å‘å¯¹è±¡ç¼–ç¨‹æ‰€æä¾›çš„ã€‚\n\n**ä¸‹é¢æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ä¸å¯¹åº”çš„åŒ…è£…ç±»å‹ã€‚**\n\nåŸºæœ¬æ•°æ®ç±»å‹ | åŒ…è£…ç±»å‹\n---|---\nbyte | Byte\nboolean | Boolean\nshort | Short\nchar | Character\nint | Integer\nlong | Long\nfloat | Float\ndouble | Double\n\n**ä¸‹é¢æ˜¯åŒ…è£…ç±»å‹çš„ç»§æ‰¿ç»“æ„å›¾ã€‚**\n\n![](http://img.javastack.cn/18-6-5/80489463.jpg)\n\nä»ä»¥ä¸Šå›¾è¡¨å¯ä»¥å¯¹åŸºæœ¬ç±»å‹å’ŒåŒ…è£…ç±»å‹æœ‰ä¸€ä¸ªå…¨é¢çš„äº†è§£ã€‚\n\n#### åŒ…è£…ç±»åº”ç”¨åœºæ™¯\n\n**1ã€é›†åˆç±»æ³›å‹åªèƒ½æ˜¯åŒ…è£…ç±»ï¼›**\n\n```\n// ç¼–è¯‘æŠ¥é”™\nList<int> list1 = new ArrayList<>();\n\n// æ­£å¸¸\nList<Integer> list2 = new ArrayList<>();\n```\n\n**2ã€æˆå‘˜å˜é‡ä¸èƒ½æœ‰é»˜è®¤å€¼ï¼›**\n\n```\nprivate int status;\n```\n\nåŸºæœ¬æ•°æ®ç±»å‹çš„æˆå‘˜å˜é‡éƒ½æœ‰é»˜è®¤å€¼ï¼Œå¦‚ä»¥ä¸Šä»£ç  status é»˜è®¤å€¼ä¸º 0ï¼Œå¦‚æœå®šä¹‰ä¸­ 0 ä»£è¡¨å¤±è´¥ï¼Œé‚£æ ·å°±ä¼šæœ‰é—®é¢˜ï¼Œè¿™æ ·åªèƒ½ä½¿ç”¨åŒ…è£…ç±» Integerï¼Œå®ƒçš„é»˜è®¤å€¼ä¸º null,æ‰€ä»¥å°±ä¸ä¼šæœ‰é»˜è®¤å€¼å½±å“ã€‚\n\n**3ã€æ–¹æ³•å‚æ•°å…è®¸å®šä¹‰ç©ºå€¼ï¼›**\n\n```\nprivate static void test1(int status){\n\tSystem.out.println(status);\n}\n```\n\nçœ‹ä»¥ä¸Šä»£ç ï¼Œæ–¹æ³•å‚æ•°å®šä¹‰çš„æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ intï¼Œæ‰€ä»¥å¿…é¡»å¾—ä¼ ä¸€ä¸ªæ•°å­—è¿‡æ¥ï¼Œä¸èƒ½ä¼  nullï¼Œå¾ˆå¤šåœºåˆæˆ‘ä»¬å¸Œæœ›æ˜¯èƒ½ä¼ é€’ null çš„ï¼Œæ‰€ä»¥è¿™ç§åœºåˆç”¨åŒ…è£…ç±»æ¯”è¾ƒåˆé€‚ã€‚\n\nè¿˜æœ‰æ›´å¤šåº”ç”¨åœºæ™¯å°±ä¸ä¸€ä¸€ä¾‹ä¸¾äº†ï¼Œæ¬¢è¿ç•™è¨€å…±åŒæ¢è®¨åŒ…è£…ç±»çš„æ›´å¤šçš„åº”ç”¨åœºæ™¯ã€‚\n\n#### è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±\n\nJava 5 å¢åŠ äº†è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±æœºåˆ¶ï¼Œæä¾›åŸºæœ¬æ•°æ®ç±»å‹å’ŒåŒ…è£…ç±»å‹çš„ç›¸äº’è½¬æ¢æ“ä½œã€‚\n\n\n**è‡ªåŠ¨è£…ç®±**\n\nè‡ªåŠ¨è£…ç®±å³è‡ªåŠ¨å°†åŸºæœ¬æ•°æ®ç±»å‹è½¬æ¢æˆåŒ…è£…ç±»å‹ï¼Œåœ¨ Java 5 ä¹‹å‰ï¼Œè¦å°†åŸºæœ¬æ•°æ®ç±»å‹è½¬æ¢æˆåŒ…è£…ç±»å‹åªèƒ½è¿™æ ·åšï¼Œçœ‹ä¸‹é¢çš„ä»£ç ã€‚\n\n```\nInteger i1 = new Integer(8);\n\nInteger i2 = Integer.valueOf(8);\n\n// è‡ªåŠ¨è£…ç®±\nInteger i3 = 8;\n```\n\nä»¥ä¸Š 3 ç§éƒ½å¯ä»¥è¿›è¡Œè½¬æ¢ï¼Œä½†åœ¨ Java 5 ä¹‹å‰ç¬¬ 3 ç§æ–¹æ³•æ˜¯ç¼–è¯‘å¤±è´¥çš„ï¼Œç¬¬ 3 ç§æ–¹æ³•ä¹Ÿæ­£æ˜¯ç°åœ¨çš„è‡ªåŠ¨è£…ç®±åŠŸèƒ½ã€‚å¦å¤–ï¼Œç¬¬ä¸€ç§æ„é€ å™¨æ–¹æ³•ä¹Ÿä¸æ¨èä½¿ç”¨äº†ï¼Œå·²ç»æ ‡ä¸ºåºŸå¼ƒäº†ã€‚\n\nå…¶å®è‡ªåŠ¨è£…ç®±çš„åŸç†å°±æ˜¯è°ƒç”¨åŒ…è£…ç±»çš„ valueOf æ–¹æ³•ï¼Œå¦‚ç¬¬ 2 ä¸ªæ–¹æ³•ä¸­çš„ Integer.valueOf æ–¹æ³•ã€‚\n\n**è‡ªåŠ¨æ‹†ç®±**\n\nè‡ªåŠ¨æ‹†ç®±å³è‡ªåŠ¨å°†åŒ…è£…ç±»å‹è½¬æ¢æˆåŸºæœ¬æ•°æ®ç±»å‹ï¼Œä¸è‡ªåŠ¨è£…ç®±ç›¸åï¼Œæœ‰è£…å°±æœ‰æ‹†ï¼Œå¾ˆå¥½ç†è§£ã€‚\n\n```\n// è‡ªåŠ¨æ‹†ç®±\nint i4 = i3;\n\nint i5 = i3.intValue();\n```\n\nç»§ç»­ä¸Šé¢çš„ä¾‹å­ï¼ŒæŠŠ i3 èµ‹å€¼ç»™ i4 å°±æ˜¯å®ç°çš„è‡ªåŠ¨æ‹†ç®±åŠŸèƒ½ï¼Œè‡ªåŠ¨è£…ç®±çš„åŸç†å°±æ˜¯è°ƒç”¨åŒ…è£…ç±»çš„ xxValue æ–¹æ³•ï¼Œå¦‚ i5 ä¸­çš„ Integer çš„ intValue æ–¹æ³•ã€‚\n\nè‡ªåŠ¨è£…ç®±ã€æ‹†ç®±ä¸åªæ˜¯ä½“ç°åœ¨ä»¥ä¸Šçš„ä¾‹å­ï¼Œåœ¨æ–¹æ³•æ¥æ”¶å‚æ•°ã€å¯¹è±¡è®¾ç½®å‚æ•°æ—¶éƒ½èƒ½è‡ªåŠ¨è£…ç®±æ‹†ç®±ã€‚\n\n**éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå…³äº Integerï¼Œ-128 ~ 127 ä¼šæœ‰ç¼“å­˜ï¼Œå¯¹æ¯”è¿™ä¸ªèŒƒå›´çš„å€¼çš„å¯¹è±¡æ˜¯ä¸€ä¸ªå‘ï¼Œè¿™ä¸ªåœ¨é˜¿é‡Œå·´å·´è§„èŒƒä¸­ä¹Ÿæœ‰æåŠã€‚** è¯¦ç»†è¯·å‚è€ƒã€Š[IntegerCacheçš„å¦™ç”¨å’Œé™·é˜±](https://mp.weixin.qq.com/s/PnVkrMzYeOiepPKjl4MKVA)ã€‹è¿™ç¯‡æ–‡ç« ã€‚\n\n","slug":"åŸºç¡€/æ·±å…¥æµ…å‡º Java ä¸­çš„åŒ…è£…ç±»","published":1,"updated":"2025-10-15T07:19:51.843Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076y004lqkd494h1csj8","content":"<p><img src=\"http://img.javastack.cn/18-6-5/61544442.jpg\"></p>\n<h4 id=\"ä»€ä¹ˆæ˜¯åŒ…è£…ç±»å‹\"><a href=\"#ä»€ä¹ˆæ˜¯åŒ…è£…ç±»å‹\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯åŒ…è£…ç±»å‹\"></a>ä»€ä¹ˆæ˜¯åŒ…è£…ç±»å‹</h4><p>Java è®¾è®¡å½“åˆå°±æä¾›äº† 8 ç§ åŸºæœ¬æ•°æ®ç±»å‹åŠå¯¹åº”çš„ 8 ç§åŒ…è£…æ•°æ®ç±»å‹ã€‚æˆ‘ä»¬çŸ¥é“ Java æ˜¯ä¸€ç§é¢å‘å¯¹è±¡ç¼–ç¨‹çš„é«˜çº§è¯­è¨€ï¼Œæ‰€ä»¥åŒ…è£…ç±»å‹æ­£æ˜¯ä¸ºäº†è§£å†³åŸºæœ¬æ•°æ®ç±»å‹æ— æ³•é¢å‘å¯¹è±¡ç¼–ç¨‹æ‰€æä¾›çš„ã€‚</p>\n<p><strong>ä¸‹é¢æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ä¸å¯¹åº”çš„åŒ…è£…ç±»å‹ã€‚</strong></p>\n<table>\n<thead>\n<tr>\n<th>åŸºæœ¬æ•°æ®ç±»å‹</th>\n<th>åŒ…è£…ç±»å‹</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>byte</td>\n<td>Byte</td>\n</tr>\n<tr>\n<td>boolean</td>\n<td>Boolean</td>\n</tr>\n<tr>\n<td>short</td>\n<td>Short</td>\n</tr>\n<tr>\n<td>char</td>\n<td>Character</td>\n</tr>\n<tr>\n<td>int</td>\n<td>Integer</td>\n</tr>\n<tr>\n<td>long</td>\n<td>Long</td>\n</tr>\n<tr>\n<td>float</td>\n<td>Float</td>\n</tr>\n<tr>\n<td>double</td>\n<td>Double</td>\n</tr>\n</tbody></table>\n<p><strong>ä¸‹é¢æ˜¯åŒ…è£…ç±»å‹çš„ç»§æ‰¿ç»“æ„å›¾ã€‚</strong></p>\n<p><img src=\"http://img.javastack.cn/18-6-5/80489463.jpg\"></p>\n<p>ä»ä»¥ä¸Šå›¾è¡¨å¯ä»¥å¯¹åŸºæœ¬ç±»å‹å’ŒåŒ…è£…ç±»å‹æœ‰ä¸€ä¸ªå…¨é¢çš„äº†è§£ã€‚</p>\n<h4 id=\"åŒ…è£…ç±»åº”ç”¨åœºæ™¯\"><a href=\"#åŒ…è£…ç±»åº”ç”¨åœºæ™¯\" class=\"headerlink\" title=\"åŒ…è£…ç±»åº”ç”¨åœºæ™¯\"></a>åŒ…è£…ç±»åº”ç”¨åœºæ™¯</h4><p><strong>1ã€é›†åˆç±»æ³›å‹åªèƒ½æ˜¯åŒ…è£…ç±»ï¼›</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; ç¼–è¯‘æŠ¥é”™\nList&lt;int&gt; list1 &#x3D; new ArrayList&lt;&gt;();\n\n&#x2F;&#x2F; æ­£å¸¸\nList&lt;Integer&gt; list2 &#x3D; new ArrayList&lt;&gt;();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>2ã€æˆå‘˜å˜é‡ä¸èƒ½æœ‰é»˜è®¤å€¼ï¼›</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private int status;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>åŸºæœ¬æ•°æ®ç±»å‹çš„æˆå‘˜å˜é‡éƒ½æœ‰é»˜è®¤å€¼ï¼Œå¦‚ä»¥ä¸Šä»£ç  status é»˜è®¤å€¼ä¸º 0ï¼Œå¦‚æœå®šä¹‰ä¸­ 0 ä»£è¡¨å¤±è´¥ï¼Œé‚£æ ·å°±ä¼šæœ‰é—®é¢˜ï¼Œè¿™æ ·åªèƒ½ä½¿ç”¨åŒ…è£…ç±» Integerï¼Œå®ƒçš„é»˜è®¤å€¼ä¸º null,æ‰€ä»¥å°±ä¸ä¼šæœ‰é»˜è®¤å€¼å½±å“ã€‚</p>\n<p><strong>3ã€æ–¹æ³•å‚æ•°å…è®¸å®šä¹‰ç©ºå€¼ï¼›</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void test1(int status)&#123;\n\tSystem.out.println(status);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>çœ‹ä»¥ä¸Šä»£ç ï¼Œæ–¹æ³•å‚æ•°å®šä¹‰çš„æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ intï¼Œæ‰€ä»¥å¿…é¡»å¾—ä¼ ä¸€ä¸ªæ•°å­—è¿‡æ¥ï¼Œä¸èƒ½ä¼  nullï¼Œå¾ˆå¤šåœºåˆæˆ‘ä»¬å¸Œæœ›æ˜¯èƒ½ä¼ é€’ null çš„ï¼Œæ‰€ä»¥è¿™ç§åœºåˆç”¨åŒ…è£…ç±»æ¯”è¾ƒåˆé€‚ã€‚</p>\n<p>è¿˜æœ‰æ›´å¤šåº”ç”¨åœºæ™¯å°±ä¸ä¸€ä¸€ä¾‹ä¸¾äº†ï¼Œæ¬¢è¿ç•™è¨€å…±åŒæ¢è®¨åŒ…è£…ç±»çš„æ›´å¤šçš„åº”ç”¨åœºæ™¯ã€‚</p>\n<h4 id=\"è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±\"><a href=\"#è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±\" class=\"headerlink\" title=\"è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±\"></a>è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±</h4><p>Java 5 å¢åŠ äº†è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±æœºåˆ¶ï¼Œæä¾›åŸºæœ¬æ•°æ®ç±»å‹å’ŒåŒ…è£…ç±»å‹çš„ç›¸äº’è½¬æ¢æ“ä½œã€‚</p>\n<p><strong>è‡ªåŠ¨è£…ç®±</strong></p>\n<p>è‡ªåŠ¨è£…ç®±å³è‡ªåŠ¨å°†åŸºæœ¬æ•°æ®ç±»å‹è½¬æ¢æˆåŒ…è£…ç±»å‹ï¼Œåœ¨ Java 5 ä¹‹å‰ï¼Œè¦å°†åŸºæœ¬æ•°æ®ç±»å‹è½¬æ¢æˆåŒ…è£…ç±»å‹åªèƒ½è¿™æ ·åšï¼Œçœ‹ä¸‹é¢çš„ä»£ç ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Integer i1 &#x3D; new Integer(8);\n\nInteger i2 &#x3D; Integer.valueOf(8);\n\n&#x2F;&#x2F; è‡ªåŠ¨è£…ç®±\nInteger i3 &#x3D; 8;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä»¥ä¸Š 3 ç§éƒ½å¯ä»¥è¿›è¡Œè½¬æ¢ï¼Œä½†åœ¨ Java 5 ä¹‹å‰ç¬¬ 3 ç§æ–¹æ³•æ˜¯ç¼–è¯‘å¤±è´¥çš„ï¼Œç¬¬ 3 ç§æ–¹æ³•ä¹Ÿæ­£æ˜¯ç°åœ¨çš„è‡ªåŠ¨è£…ç®±åŠŸèƒ½ã€‚å¦å¤–ï¼Œç¬¬ä¸€ç§æ„é€ å™¨æ–¹æ³•ä¹Ÿä¸æ¨èä½¿ç”¨äº†ï¼Œå·²ç»æ ‡ä¸ºåºŸå¼ƒäº†ã€‚</p>\n<p>å…¶å®è‡ªåŠ¨è£…ç®±çš„åŸç†å°±æ˜¯è°ƒç”¨åŒ…è£…ç±»çš„ valueOf æ–¹æ³•ï¼Œå¦‚ç¬¬ 2 ä¸ªæ–¹æ³•ä¸­çš„ Integer.valueOf æ–¹æ³•ã€‚</p>\n<p><strong>è‡ªåŠ¨æ‹†ç®±</strong></p>\n<p>è‡ªåŠ¨æ‹†ç®±å³è‡ªåŠ¨å°†åŒ…è£…ç±»å‹è½¬æ¢æˆåŸºæœ¬æ•°æ®ç±»å‹ï¼Œä¸è‡ªåŠ¨è£…ç®±ç›¸åï¼Œæœ‰è£…å°±æœ‰æ‹†ï¼Œå¾ˆå¥½ç†è§£ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; è‡ªåŠ¨æ‹†ç®±\nint i4 &#x3D; i3;\n\nint i5 &#x3D; i3.intValue();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç»§ç»­ä¸Šé¢çš„ä¾‹å­ï¼ŒæŠŠ i3 èµ‹å€¼ç»™ i4 å°±æ˜¯å®ç°çš„è‡ªåŠ¨æ‹†ç®±åŠŸèƒ½ï¼Œè‡ªåŠ¨è£…ç®±çš„åŸç†å°±æ˜¯è°ƒç”¨åŒ…è£…ç±»çš„ xxValue æ–¹æ³•ï¼Œå¦‚ i5 ä¸­çš„ Integer çš„ intValue æ–¹æ³•ã€‚</p>\n<p>è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±ä¸åªæ˜¯ä½“ç°åœ¨ä»¥ä¸Šçš„ä¾‹å­ï¼Œåœ¨æ–¹æ³•æ¥æ”¶å‚æ•°ã€å¯¹è±¡è®¾ç½®å‚æ•°æ—¶éƒ½èƒ½è‡ªåŠ¨è£…ç®±æ‹†ç®±ã€‚</p>\n<p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå…³äº Integerï¼Œ-128 ~ 127 ä¼šæœ‰ç¼“å­˜ï¼Œå¯¹æ¯”è¿™ä¸ªèŒƒå›´çš„å€¼çš„å¯¹è±¡æ˜¯ä¸€ä¸ªå‘ï¼Œè¿™ä¸ªåœ¨é˜¿é‡Œå·´å·´è§„èŒƒä¸­ä¹Ÿæœ‰æåŠã€‚</strong> è¯¦ç»†è¯·å‚è€ƒã€Š<a href=\"https://mp.weixin.qq.com/s/PnVkrMzYeOiepPKjl4MKVA\">IntegerCacheçš„å¦™ç”¨å’Œé™·é˜±</a>ã€‹è¿™ç¯‡æ–‡ç« ã€‚</p>\n","excerpt":"","more":"<p><img src=\"http://img.javastack.cn/18-6-5/61544442.jpg\"></p>\n<h4 id=\"ä»€ä¹ˆæ˜¯åŒ…è£…ç±»å‹\"><a href=\"#ä»€ä¹ˆæ˜¯åŒ…è£…ç±»å‹\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯åŒ…è£…ç±»å‹\"></a>ä»€ä¹ˆæ˜¯åŒ…è£…ç±»å‹</h4><p>Java è®¾è®¡å½“åˆå°±æä¾›äº† 8 ç§ åŸºæœ¬æ•°æ®ç±»å‹åŠå¯¹åº”çš„ 8 ç§åŒ…è£…æ•°æ®ç±»å‹ã€‚æˆ‘ä»¬çŸ¥é“ Java æ˜¯ä¸€ç§é¢å‘å¯¹è±¡ç¼–ç¨‹çš„é«˜çº§è¯­è¨€ï¼Œæ‰€ä»¥åŒ…è£…ç±»å‹æ­£æ˜¯ä¸ºäº†è§£å†³åŸºæœ¬æ•°æ®ç±»å‹æ— æ³•é¢å‘å¯¹è±¡ç¼–ç¨‹æ‰€æä¾›çš„ã€‚</p>\n<p><strong>ä¸‹é¢æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ä¸å¯¹åº”çš„åŒ…è£…ç±»å‹ã€‚</strong></p>\n<table>\n<thead>\n<tr>\n<th>åŸºæœ¬æ•°æ®ç±»å‹</th>\n<th>åŒ…è£…ç±»å‹</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>byte</td>\n<td>Byte</td>\n</tr>\n<tr>\n<td>boolean</td>\n<td>Boolean</td>\n</tr>\n<tr>\n<td>short</td>\n<td>Short</td>\n</tr>\n<tr>\n<td>char</td>\n<td>Character</td>\n</tr>\n<tr>\n<td>int</td>\n<td>Integer</td>\n</tr>\n<tr>\n<td>long</td>\n<td>Long</td>\n</tr>\n<tr>\n<td>float</td>\n<td>Float</td>\n</tr>\n<tr>\n<td>double</td>\n<td>Double</td>\n</tr>\n</tbody></table>\n<p><strong>ä¸‹é¢æ˜¯åŒ…è£…ç±»å‹çš„ç»§æ‰¿ç»“æ„å›¾ã€‚</strong></p>\n<p><img src=\"http://img.javastack.cn/18-6-5/80489463.jpg\"></p>\n<p>ä»ä»¥ä¸Šå›¾è¡¨å¯ä»¥å¯¹åŸºæœ¬ç±»å‹å’ŒåŒ…è£…ç±»å‹æœ‰ä¸€ä¸ªå…¨é¢çš„äº†è§£ã€‚</p>\n<h4 id=\"åŒ…è£…ç±»åº”ç”¨åœºæ™¯\"><a href=\"#åŒ…è£…ç±»åº”ç”¨åœºæ™¯\" class=\"headerlink\" title=\"åŒ…è£…ç±»åº”ç”¨åœºæ™¯\"></a>åŒ…è£…ç±»åº”ç”¨åœºæ™¯</h4><p><strong>1ã€é›†åˆç±»æ³›å‹åªèƒ½æ˜¯åŒ…è£…ç±»ï¼›</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; ç¼–è¯‘æŠ¥é”™\nList&lt;int&gt; list1 &#x3D; new ArrayList&lt;&gt;();\n\n&#x2F;&#x2F; æ­£å¸¸\nList&lt;Integer&gt; list2 &#x3D; new ArrayList&lt;&gt;();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>2ã€æˆå‘˜å˜é‡ä¸èƒ½æœ‰é»˜è®¤å€¼ï¼›</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private int status;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>åŸºæœ¬æ•°æ®ç±»å‹çš„æˆå‘˜å˜é‡éƒ½æœ‰é»˜è®¤å€¼ï¼Œå¦‚ä»¥ä¸Šä»£ç  status é»˜è®¤å€¼ä¸º 0ï¼Œå¦‚æœå®šä¹‰ä¸­ 0 ä»£è¡¨å¤±è´¥ï¼Œé‚£æ ·å°±ä¼šæœ‰é—®é¢˜ï¼Œè¿™æ ·åªèƒ½ä½¿ç”¨åŒ…è£…ç±» Integerï¼Œå®ƒçš„é»˜è®¤å€¼ä¸º null,æ‰€ä»¥å°±ä¸ä¼šæœ‰é»˜è®¤å€¼å½±å“ã€‚</p>\n<p><strong>3ã€æ–¹æ³•å‚æ•°å…è®¸å®šä¹‰ç©ºå€¼ï¼›</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void test1(int status)&#123;\n\tSystem.out.println(status);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>çœ‹ä»¥ä¸Šä»£ç ï¼Œæ–¹æ³•å‚æ•°å®šä¹‰çš„æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ intï¼Œæ‰€ä»¥å¿…é¡»å¾—ä¼ ä¸€ä¸ªæ•°å­—è¿‡æ¥ï¼Œä¸èƒ½ä¼  nullï¼Œå¾ˆå¤šåœºåˆæˆ‘ä»¬å¸Œæœ›æ˜¯èƒ½ä¼ é€’ null çš„ï¼Œæ‰€ä»¥è¿™ç§åœºåˆç”¨åŒ…è£…ç±»æ¯”è¾ƒåˆé€‚ã€‚</p>\n<p>è¿˜æœ‰æ›´å¤šåº”ç”¨åœºæ™¯å°±ä¸ä¸€ä¸€ä¾‹ä¸¾äº†ï¼Œæ¬¢è¿ç•™è¨€å…±åŒæ¢è®¨åŒ…è£…ç±»çš„æ›´å¤šçš„åº”ç”¨åœºæ™¯ã€‚</p>\n<h4 id=\"è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±\"><a href=\"#è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±\" class=\"headerlink\" title=\"è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±\"></a>è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±</h4><p>Java 5 å¢åŠ äº†è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±æœºåˆ¶ï¼Œæä¾›åŸºæœ¬æ•°æ®ç±»å‹å’ŒåŒ…è£…ç±»å‹çš„ç›¸äº’è½¬æ¢æ“ä½œã€‚</p>\n<p><strong>è‡ªåŠ¨è£…ç®±</strong></p>\n<p>è‡ªåŠ¨è£…ç®±å³è‡ªåŠ¨å°†åŸºæœ¬æ•°æ®ç±»å‹è½¬æ¢æˆåŒ…è£…ç±»å‹ï¼Œåœ¨ Java 5 ä¹‹å‰ï¼Œè¦å°†åŸºæœ¬æ•°æ®ç±»å‹è½¬æ¢æˆåŒ…è£…ç±»å‹åªèƒ½è¿™æ ·åšï¼Œçœ‹ä¸‹é¢çš„ä»£ç ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Integer i1 &#x3D; new Integer(8);\n\nInteger i2 &#x3D; Integer.valueOf(8);\n\n&#x2F;&#x2F; è‡ªåŠ¨è£…ç®±\nInteger i3 &#x3D; 8;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä»¥ä¸Š 3 ç§éƒ½å¯ä»¥è¿›è¡Œè½¬æ¢ï¼Œä½†åœ¨ Java 5 ä¹‹å‰ç¬¬ 3 ç§æ–¹æ³•æ˜¯ç¼–è¯‘å¤±è´¥çš„ï¼Œç¬¬ 3 ç§æ–¹æ³•ä¹Ÿæ­£æ˜¯ç°åœ¨çš„è‡ªåŠ¨è£…ç®±åŠŸèƒ½ã€‚å¦å¤–ï¼Œç¬¬ä¸€ç§æ„é€ å™¨æ–¹æ³•ä¹Ÿä¸æ¨èä½¿ç”¨äº†ï¼Œå·²ç»æ ‡ä¸ºåºŸå¼ƒäº†ã€‚</p>\n<p>å…¶å®è‡ªåŠ¨è£…ç®±çš„åŸç†å°±æ˜¯è°ƒç”¨åŒ…è£…ç±»çš„ valueOf æ–¹æ³•ï¼Œå¦‚ç¬¬ 2 ä¸ªæ–¹æ³•ä¸­çš„ Integer.valueOf æ–¹æ³•ã€‚</p>\n<p><strong>è‡ªåŠ¨æ‹†ç®±</strong></p>\n<p>è‡ªåŠ¨æ‹†ç®±å³è‡ªåŠ¨å°†åŒ…è£…ç±»å‹è½¬æ¢æˆåŸºæœ¬æ•°æ®ç±»å‹ï¼Œä¸è‡ªåŠ¨è£…ç®±ç›¸åï¼Œæœ‰è£…å°±æœ‰æ‹†ï¼Œå¾ˆå¥½ç†è§£ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; è‡ªåŠ¨æ‹†ç®±\nint i4 &#x3D; i3;\n\nint i5 &#x3D; i3.intValue();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç»§ç»­ä¸Šé¢çš„ä¾‹å­ï¼ŒæŠŠ i3 èµ‹å€¼ç»™ i4 å°±æ˜¯å®ç°çš„è‡ªåŠ¨æ‹†ç®±åŠŸèƒ½ï¼Œè‡ªåŠ¨è£…ç®±çš„åŸç†å°±æ˜¯è°ƒç”¨åŒ…è£…ç±»çš„ xxValue æ–¹æ³•ï¼Œå¦‚ i5 ä¸­çš„ Integer çš„ intValue æ–¹æ³•ã€‚</p>\n<p>è‡ªåŠ¨è£…ç®±ã€æ‹†ç®±ä¸åªæ˜¯ä½“ç°åœ¨ä»¥ä¸Šçš„ä¾‹å­ï¼Œåœ¨æ–¹æ³•æ¥æ”¶å‚æ•°ã€å¯¹è±¡è®¾ç½®å‚æ•°æ—¶éƒ½èƒ½è‡ªåŠ¨è£…ç®±æ‹†ç®±ã€‚</p>\n<p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå…³äº Integerï¼Œ-128 ~ 127 ä¼šæœ‰ç¼“å­˜ï¼Œå¯¹æ¯”è¿™ä¸ªèŒƒå›´çš„å€¼çš„å¯¹è±¡æ˜¯ä¸€ä¸ªå‘ï¼Œè¿™ä¸ªåœ¨é˜¿é‡Œå·´å·´è§„èŒƒä¸­ä¹Ÿæœ‰æåŠã€‚</strong> è¯¦ç»†è¯·å‚è€ƒã€Š<a href=\"https://mp.weixin.qq.com/s/PnVkrMzYeOiepPKjl4MKVA\">IntegerCacheçš„å¦™ç”¨å’Œé™·é˜±</a>ã€‹è¿™ç¯‡æ–‡ç« ã€‚</p>\n"},{"title":"é€šç”¨å”¯ä¸€æ ‡è¯†ç  UUID çš„ä»‹ç»åŠä½¿ç”¨ã€‚","date":"2025-10-14T06:42:34.000Z","_content":"\n#### ä»€ä¹ˆæ˜¯UUIDï¼Ÿ\n\nUUIDå…¨ç§°ï¼šUniversally Unique Identifierï¼Œå³é€šç”¨å”¯ä¸€è¯†åˆ«ç ã€‚\n\nUUIDæ˜¯ç”±ä¸€ç»„32ä½æ•°çš„16è¿›åˆ¶æ•°å­—æ‰€æ„æˆï¼Œæ˜¯æ•…UUIDç†è®ºä¸Šçš„æ€»æ•°ä¸º16^32 = 2^128ï¼Œçº¦ç­‰äº3.4 x 10^38ã€‚ä¹Ÿå°±æ˜¯è¯´è‹¥æ¯çº³ç§’äº§ç”Ÿ1å…†ä¸ªUUIDï¼Œè¦èŠ±100äº¿å¹´æ‰ä¼šå°†æ‰€æœ‰UUIDç”¨å®Œã€‚\n\nUUIDçš„æ ‡å‡†å‹å¼åŒ…å«32ä¸ª16è¿›åˆ¶æ•°å­—ï¼Œä»¥è¿å­—å·åˆ†ä¸ºäº”æ®µï¼Œå½¢å¼ä¸º8-4-4-4-12çš„32ä¸ªå­—ç¬¦ï¼Œå¦‚ï¼š550e8400-e29b-41d4-a716-446655440000ã€‚\n\n#### UUIDçš„ä½œç”¨\n\nUUIDçš„æ˜¯è®©åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½èƒ½æœ‰å”¯ä¸€çš„è¾¨è¯†ä¿¡æ¯ï¼Œè€Œä¸éœ€è¦é€šè¿‡ä¸­å¤®æ§åˆ¶ç«¯æ¥åšè¾¨è¯†ä¿¡æ¯çš„æŒ‡å®šã€‚å¦‚æ­¤ä¸€æ¥ï¼Œæ¯ä¸ªäººéƒ½å¯ä»¥åˆ›å»ºä¸ä¸å…¶å®ƒäººå†²çªçš„UUIDã€‚åœ¨è¿™æ ·çš„æƒ…å†µä¸‹ï¼Œå°±ä¸éœ€è€ƒè™‘æ•°æ®åº“åˆ›å»ºæ—¶çš„åç§°é‡å¤é—®é¢˜ã€‚ç›®å‰æœ€å¹¿æ³›åº”ç”¨çš„UUIDï¼Œæ˜¯å¾®è½¯å…¬å¸çš„å…¨å±€å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆGUIDï¼‰ï¼Œè€Œå…¶ä»–é‡è¦çš„åº”ç”¨ï¼Œåˆ™æœ‰Linux ext2/ext3æ–‡ä»¶ç³»ç»Ÿã€LUKSåŠ å¯†åˆ†åŒºã€GNOMEã€KDEã€Mac OS Xç­‰ç­‰ã€‚\n\n#### UUIDçš„ç»„æˆ\n\nUUIDæ˜¯æŒ‡åœ¨ä¸€å°æœºå™¨ä¸Šç”Ÿæˆçš„æ•°å­—ï¼Œå®ƒä¿è¯å¯¹åœ¨åŒä¸€æ—¶ç©ºä¸­çš„æ‰€æœ‰æœºå™¨éƒ½æ˜¯å”¯ä¸€çš„ã€‚é€šå¸¸å¹³å°ä¼šæä¾›ç”Ÿæˆçš„APIã€‚æŒ‰ç…§å¼€æ”¾è½¯ä»¶åŸºé‡‘ä¼š(OSF)åˆ¶å®šçš„æ ‡å‡†è®¡ç®—ï¼Œç”¨åˆ°äº†ä»¥å¤ªç½‘å¡åœ°å€ã€çº³ç§’çº§æ—¶é—´ã€èŠ¯ç‰‡IDç å’Œè®¸å¤šå¯èƒ½çš„æ•°å­—ã€‚\n\n**UUIDç”±ä»¥ä¸‹å‡ éƒ¨åˆ†çš„ç»„åˆï¼š**\n\n- å½“å‰æ—¥æœŸå’Œæ—¶é—´ï¼ŒUUIDçš„ç¬¬ä¸€ä¸ªéƒ¨åˆ†ä¸æ—¶é—´æœ‰å…³ï¼Œå¦‚æœä½ åœ¨ç”Ÿæˆä¸€ä¸ªUUIDä¹‹åï¼Œè¿‡å‡ ç§’åˆç”Ÿæˆä¸€ä¸ªUUIDï¼Œåˆ™ç¬¬ä¸€ä¸ªéƒ¨åˆ†ä¸åŒï¼Œå…¶ä½™ç›¸åŒã€‚\n\n- æ—¶é’Ÿåºåˆ—ã€‚\n\n- å…¨å±€å”¯ä¸€çš„IEEEæœºå™¨è¯†åˆ«å·ï¼Œå¦‚æœæœ‰ç½‘å¡ï¼Œä»ç½‘å¡MACåœ°å€è·å¾—ï¼Œæ²¡æœ‰ç½‘å¡ä»¥å…¶ä»–æ–¹å¼è·å¾—ã€‚\n\nUUIDçš„å”¯ä¸€ç¼ºé™·åœ¨äºç”Ÿæˆçš„ç»“æœä¸²ä¼šæ¯”è¾ƒé•¿ã€‚å…³äºUUIDè¿™ä¸ªæ ‡å‡†ä½¿ç”¨æœ€æ™®éçš„æ˜¯å¾®è½¯çš„GUID(Globals Unique Identifiers)ã€‚\n\n#### UUIDçš„ç”Ÿæˆ\n\n```\npublic static void main(String[] args) throws Exception {\n\tSystem.out.println(UUID.randomUUID());\n}\n```\n\n> æ‰¹é‡ç”ŸæˆUUIDç½‘ç«™ï¼šhttp://www.uuid.online/","source":"_posts/åŸºç¡€/é€šç”¨å”¯ä¸€æ ‡è¯†ç  UUID çš„ä»‹ç»åŠä½¿ç”¨ã€‚.md","raw":"---\ntitle: é€šç”¨å”¯ä¸€æ ‡è¯†ç  UUID çš„ä»‹ç»åŠä½¿ç”¨ã€‚\ndate: 2025-10-14 14:42:34\ncategory: åç«¯\ntags: åŸºç¡€\n---\n\n#### ä»€ä¹ˆæ˜¯UUIDï¼Ÿ\n\nUUIDå…¨ç§°ï¼šUniversally Unique Identifierï¼Œå³é€šç”¨å”¯ä¸€è¯†åˆ«ç ã€‚\n\nUUIDæ˜¯ç”±ä¸€ç»„32ä½æ•°çš„16è¿›åˆ¶æ•°å­—æ‰€æ„æˆï¼Œæ˜¯æ•…UUIDç†è®ºä¸Šçš„æ€»æ•°ä¸º16^32 = 2^128ï¼Œçº¦ç­‰äº3.4 x 10^38ã€‚ä¹Ÿå°±æ˜¯è¯´è‹¥æ¯çº³ç§’äº§ç”Ÿ1å…†ä¸ªUUIDï¼Œè¦èŠ±100äº¿å¹´æ‰ä¼šå°†æ‰€æœ‰UUIDç”¨å®Œã€‚\n\nUUIDçš„æ ‡å‡†å‹å¼åŒ…å«32ä¸ª16è¿›åˆ¶æ•°å­—ï¼Œä»¥è¿å­—å·åˆ†ä¸ºäº”æ®µï¼Œå½¢å¼ä¸º8-4-4-4-12çš„32ä¸ªå­—ç¬¦ï¼Œå¦‚ï¼š550e8400-e29b-41d4-a716-446655440000ã€‚\n\n#### UUIDçš„ä½œç”¨\n\nUUIDçš„æ˜¯è®©åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½èƒ½æœ‰å”¯ä¸€çš„è¾¨è¯†ä¿¡æ¯ï¼Œè€Œä¸éœ€è¦é€šè¿‡ä¸­å¤®æ§åˆ¶ç«¯æ¥åšè¾¨è¯†ä¿¡æ¯çš„æŒ‡å®šã€‚å¦‚æ­¤ä¸€æ¥ï¼Œæ¯ä¸ªäººéƒ½å¯ä»¥åˆ›å»ºä¸ä¸å…¶å®ƒäººå†²çªçš„UUIDã€‚åœ¨è¿™æ ·çš„æƒ…å†µä¸‹ï¼Œå°±ä¸éœ€è€ƒè™‘æ•°æ®åº“åˆ›å»ºæ—¶çš„åç§°é‡å¤é—®é¢˜ã€‚ç›®å‰æœ€å¹¿æ³›åº”ç”¨çš„UUIDï¼Œæ˜¯å¾®è½¯å…¬å¸çš„å…¨å±€å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆGUIDï¼‰ï¼Œè€Œå…¶ä»–é‡è¦çš„åº”ç”¨ï¼Œåˆ™æœ‰Linux ext2/ext3æ–‡ä»¶ç³»ç»Ÿã€LUKSåŠ å¯†åˆ†åŒºã€GNOMEã€KDEã€Mac OS Xç­‰ç­‰ã€‚\n\n#### UUIDçš„ç»„æˆ\n\nUUIDæ˜¯æŒ‡åœ¨ä¸€å°æœºå™¨ä¸Šç”Ÿæˆçš„æ•°å­—ï¼Œå®ƒä¿è¯å¯¹åœ¨åŒä¸€æ—¶ç©ºä¸­çš„æ‰€æœ‰æœºå™¨éƒ½æ˜¯å”¯ä¸€çš„ã€‚é€šå¸¸å¹³å°ä¼šæä¾›ç”Ÿæˆçš„APIã€‚æŒ‰ç…§å¼€æ”¾è½¯ä»¶åŸºé‡‘ä¼š(OSF)åˆ¶å®šçš„æ ‡å‡†è®¡ç®—ï¼Œç”¨åˆ°äº†ä»¥å¤ªç½‘å¡åœ°å€ã€çº³ç§’çº§æ—¶é—´ã€èŠ¯ç‰‡IDç å’Œè®¸å¤šå¯èƒ½çš„æ•°å­—ã€‚\n\n**UUIDç”±ä»¥ä¸‹å‡ éƒ¨åˆ†çš„ç»„åˆï¼š**\n\n- å½“å‰æ—¥æœŸå’Œæ—¶é—´ï¼ŒUUIDçš„ç¬¬ä¸€ä¸ªéƒ¨åˆ†ä¸æ—¶é—´æœ‰å…³ï¼Œå¦‚æœä½ åœ¨ç”Ÿæˆä¸€ä¸ªUUIDä¹‹åï¼Œè¿‡å‡ ç§’åˆç”Ÿæˆä¸€ä¸ªUUIDï¼Œåˆ™ç¬¬ä¸€ä¸ªéƒ¨åˆ†ä¸åŒï¼Œå…¶ä½™ç›¸åŒã€‚\n\n- æ—¶é’Ÿåºåˆ—ã€‚\n\n- å…¨å±€å”¯ä¸€çš„IEEEæœºå™¨è¯†åˆ«å·ï¼Œå¦‚æœæœ‰ç½‘å¡ï¼Œä»ç½‘å¡MACåœ°å€è·å¾—ï¼Œæ²¡æœ‰ç½‘å¡ä»¥å…¶ä»–æ–¹å¼è·å¾—ã€‚\n\nUUIDçš„å”¯ä¸€ç¼ºé™·åœ¨äºç”Ÿæˆçš„ç»“æœä¸²ä¼šæ¯”è¾ƒé•¿ã€‚å…³äºUUIDè¿™ä¸ªæ ‡å‡†ä½¿ç”¨æœ€æ™®éçš„æ˜¯å¾®è½¯çš„GUID(Globals Unique Identifiers)ã€‚\n\n#### UUIDçš„ç”Ÿæˆ\n\n```\npublic static void main(String[] args) throws Exception {\n\tSystem.out.println(UUID.randomUUID());\n}\n```\n\n> æ‰¹é‡ç”ŸæˆUUIDç½‘ç«™ï¼šhttp://www.uuid.online/","slug":"åŸºç¡€/é€šç”¨å”¯ä¸€æ ‡è¯†ç  UUID çš„ä»‹ç»åŠä½¿ç”¨ã€‚","published":1,"updated":"2025-10-15T07:19:51.883Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076z004oqkd4c1mr7a2v","content":"<h4 id=\"ä»€ä¹ˆæ˜¯UUIDï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯UUIDï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯UUIDï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯UUIDï¼Ÿ</h4><p>UUIDå…¨ç§°ï¼šUniversally Unique Identifierï¼Œå³é€šç”¨å”¯ä¸€è¯†åˆ«ç ã€‚</p>\n<p>UUIDæ˜¯ç”±ä¸€ç»„32ä½æ•°çš„16è¿›åˆ¶æ•°å­—æ‰€æ„æˆï¼Œæ˜¯æ•…UUIDç†è®ºä¸Šçš„æ€»æ•°ä¸º16^32 &#x3D; 2^128ï¼Œçº¦ç­‰äº3.4 x 10^38ã€‚ä¹Ÿå°±æ˜¯è¯´è‹¥æ¯çº³ç§’äº§ç”Ÿ1å…†ä¸ªUUIDï¼Œè¦èŠ±100äº¿å¹´æ‰ä¼šå°†æ‰€æœ‰UUIDç”¨å®Œã€‚</p>\n<p>UUIDçš„æ ‡å‡†å‹å¼åŒ…å«32ä¸ª16è¿›åˆ¶æ•°å­—ï¼Œä»¥è¿å­—å·åˆ†ä¸ºäº”æ®µï¼Œå½¢å¼ä¸º8-4-4-4-12çš„32ä¸ªå­—ç¬¦ï¼Œå¦‚ï¼š550e8400-e29b-41d4-a716-446655440000ã€‚</p>\n<h4 id=\"UUIDçš„ä½œç”¨\"><a href=\"#UUIDçš„ä½œç”¨\" class=\"headerlink\" title=\"UUIDçš„ä½œç”¨\"></a>UUIDçš„ä½œç”¨</h4><p>UUIDçš„æ˜¯è®©åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½èƒ½æœ‰å”¯ä¸€çš„è¾¨è¯†ä¿¡æ¯ï¼Œè€Œä¸éœ€è¦é€šè¿‡ä¸­å¤®æ§åˆ¶ç«¯æ¥åšè¾¨è¯†ä¿¡æ¯çš„æŒ‡å®šã€‚å¦‚æ­¤ä¸€æ¥ï¼Œæ¯ä¸ªäººéƒ½å¯ä»¥åˆ›å»ºä¸ä¸å…¶å®ƒäººå†²çªçš„UUIDã€‚åœ¨è¿™æ ·çš„æƒ…å†µä¸‹ï¼Œå°±ä¸éœ€è€ƒè™‘æ•°æ®åº“åˆ›å»ºæ—¶çš„åç§°é‡å¤é—®é¢˜ã€‚ç›®å‰æœ€å¹¿æ³›åº”ç”¨çš„UUIDï¼Œæ˜¯å¾®è½¯å…¬å¸çš„å…¨å±€å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆGUIDï¼‰ï¼Œè€Œå…¶ä»–é‡è¦çš„åº”ç”¨ï¼Œåˆ™æœ‰Linux ext2&#x2F;ext3æ–‡ä»¶ç³»ç»Ÿã€LUKSåŠ å¯†åˆ†åŒºã€GNOMEã€KDEã€Mac OS Xç­‰ç­‰ã€‚</p>\n<h4 id=\"UUIDçš„ç»„æˆ\"><a href=\"#UUIDçš„ç»„æˆ\" class=\"headerlink\" title=\"UUIDçš„ç»„æˆ\"></a>UUIDçš„ç»„æˆ</h4><p>UUIDæ˜¯æŒ‡åœ¨ä¸€å°æœºå™¨ä¸Šç”Ÿæˆçš„æ•°å­—ï¼Œå®ƒä¿è¯å¯¹åœ¨åŒä¸€æ—¶ç©ºä¸­çš„æ‰€æœ‰æœºå™¨éƒ½æ˜¯å”¯ä¸€çš„ã€‚é€šå¸¸å¹³å°ä¼šæä¾›ç”Ÿæˆçš„APIã€‚æŒ‰ç…§å¼€æ”¾è½¯ä»¶åŸºé‡‘ä¼š(OSF)åˆ¶å®šçš„æ ‡å‡†è®¡ç®—ï¼Œç”¨åˆ°äº†ä»¥å¤ªç½‘å¡åœ°å€ã€çº³ç§’çº§æ—¶é—´ã€èŠ¯ç‰‡IDç å’Œè®¸å¤šå¯èƒ½çš„æ•°å­—ã€‚</p>\n<p><strong>UUIDç”±ä»¥ä¸‹å‡ éƒ¨åˆ†çš„ç»„åˆï¼š</strong></p>\n<ul>\n<li><p>å½“å‰æ—¥æœŸå’Œæ—¶é—´ï¼ŒUUIDçš„ç¬¬ä¸€ä¸ªéƒ¨åˆ†ä¸æ—¶é—´æœ‰å…³ï¼Œå¦‚æœä½ åœ¨ç”Ÿæˆä¸€ä¸ªUUIDä¹‹åï¼Œè¿‡å‡ ç§’åˆç”Ÿæˆä¸€ä¸ªUUIDï¼Œåˆ™ç¬¬ä¸€ä¸ªéƒ¨åˆ†ä¸åŒï¼Œå…¶ä½™ç›¸åŒã€‚</p>\n</li>\n<li><p>æ—¶é’Ÿåºåˆ—ã€‚</p>\n</li>\n<li><p>å…¨å±€å”¯ä¸€çš„IEEEæœºå™¨è¯†åˆ«å·ï¼Œå¦‚æœæœ‰ç½‘å¡ï¼Œä»ç½‘å¡MACåœ°å€è·å¾—ï¼Œæ²¡æœ‰ç½‘å¡ä»¥å…¶ä»–æ–¹å¼è·å¾—ã€‚</p>\n</li>\n</ul>\n<p>UUIDçš„å”¯ä¸€ç¼ºé™·åœ¨äºç”Ÿæˆçš„ç»“æœä¸²ä¼šæ¯”è¾ƒé•¿ã€‚å…³äºUUIDè¿™ä¸ªæ ‡å‡†ä½¿ç”¨æœ€æ™®éçš„æ˜¯å¾®è½¯çš„GUID(Globals Unique Identifiers)ã€‚</p>\n<h4 id=\"UUIDçš„ç”Ÿæˆ\"><a href=\"#UUIDçš„ç”Ÿæˆ\" class=\"headerlink\" title=\"UUIDçš„ç”Ÿæˆ\"></a>UUIDçš„ç”Ÿæˆ</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) throws Exception &#123;\n\tSystem.out.println(UUID.randomUUID());\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<blockquote>\n<p>æ‰¹é‡ç”ŸæˆUUIDç½‘ç«™ï¼š<a href=\"http://www.uuid.online/\">http://www.uuid.online/</a></p>\n</blockquote>\n","excerpt":"","more":"<h4 id=\"ä»€ä¹ˆæ˜¯UUIDï¼Ÿ\"><a href=\"#ä»€ä¹ˆæ˜¯UUIDï¼Ÿ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯UUIDï¼Ÿ\"></a>ä»€ä¹ˆæ˜¯UUIDï¼Ÿ</h4><p>UUIDå…¨ç§°ï¼šUniversally Unique Identifierï¼Œå³é€šç”¨å”¯ä¸€è¯†åˆ«ç ã€‚</p>\n<p>UUIDæ˜¯ç”±ä¸€ç»„32ä½æ•°çš„16è¿›åˆ¶æ•°å­—æ‰€æ„æˆï¼Œæ˜¯æ•…UUIDç†è®ºä¸Šçš„æ€»æ•°ä¸º16^32 &#x3D; 2^128ï¼Œçº¦ç­‰äº3.4 x 10^38ã€‚ä¹Ÿå°±æ˜¯è¯´è‹¥æ¯çº³ç§’äº§ç”Ÿ1å…†ä¸ªUUIDï¼Œè¦èŠ±100äº¿å¹´æ‰ä¼šå°†æ‰€æœ‰UUIDç”¨å®Œã€‚</p>\n<p>UUIDçš„æ ‡å‡†å‹å¼åŒ…å«32ä¸ª16è¿›åˆ¶æ•°å­—ï¼Œä»¥è¿å­—å·åˆ†ä¸ºäº”æ®µï¼Œå½¢å¼ä¸º8-4-4-4-12çš„32ä¸ªå­—ç¬¦ï¼Œå¦‚ï¼š550e8400-e29b-41d4-a716-446655440000ã€‚</p>\n<h4 id=\"UUIDçš„ä½œç”¨\"><a href=\"#UUIDçš„ä½œç”¨\" class=\"headerlink\" title=\"UUIDçš„ä½œç”¨\"></a>UUIDçš„ä½œç”¨</h4><p>UUIDçš„æ˜¯è®©åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½èƒ½æœ‰å”¯ä¸€çš„è¾¨è¯†ä¿¡æ¯ï¼Œè€Œä¸éœ€è¦é€šè¿‡ä¸­å¤®æ§åˆ¶ç«¯æ¥åšè¾¨è¯†ä¿¡æ¯çš„æŒ‡å®šã€‚å¦‚æ­¤ä¸€æ¥ï¼Œæ¯ä¸ªäººéƒ½å¯ä»¥åˆ›å»ºä¸ä¸å…¶å®ƒäººå†²çªçš„UUIDã€‚åœ¨è¿™æ ·çš„æƒ…å†µä¸‹ï¼Œå°±ä¸éœ€è€ƒè™‘æ•°æ®åº“åˆ›å»ºæ—¶çš„åç§°é‡å¤é—®é¢˜ã€‚ç›®å‰æœ€å¹¿æ³›åº”ç”¨çš„UUIDï¼Œæ˜¯å¾®è½¯å…¬å¸çš„å…¨å±€å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆGUIDï¼‰ï¼Œè€Œå…¶ä»–é‡è¦çš„åº”ç”¨ï¼Œåˆ™æœ‰Linux ext2&#x2F;ext3æ–‡ä»¶ç³»ç»Ÿã€LUKSåŠ å¯†åˆ†åŒºã€GNOMEã€KDEã€Mac OS Xç­‰ç­‰ã€‚</p>\n<h4 id=\"UUIDçš„ç»„æˆ\"><a href=\"#UUIDçš„ç»„æˆ\" class=\"headerlink\" title=\"UUIDçš„ç»„æˆ\"></a>UUIDçš„ç»„æˆ</h4><p>UUIDæ˜¯æŒ‡åœ¨ä¸€å°æœºå™¨ä¸Šç”Ÿæˆçš„æ•°å­—ï¼Œå®ƒä¿è¯å¯¹åœ¨åŒä¸€æ—¶ç©ºä¸­çš„æ‰€æœ‰æœºå™¨éƒ½æ˜¯å”¯ä¸€çš„ã€‚é€šå¸¸å¹³å°ä¼šæä¾›ç”Ÿæˆçš„APIã€‚æŒ‰ç…§å¼€æ”¾è½¯ä»¶åŸºé‡‘ä¼š(OSF)åˆ¶å®šçš„æ ‡å‡†è®¡ç®—ï¼Œç”¨åˆ°äº†ä»¥å¤ªç½‘å¡åœ°å€ã€çº³ç§’çº§æ—¶é—´ã€èŠ¯ç‰‡IDç å’Œè®¸å¤šå¯èƒ½çš„æ•°å­—ã€‚</p>\n<p><strong>UUIDç”±ä»¥ä¸‹å‡ éƒ¨åˆ†çš„ç»„åˆï¼š</strong></p>\n<ul>\n<li><p>å½“å‰æ—¥æœŸå’Œæ—¶é—´ï¼ŒUUIDçš„ç¬¬ä¸€ä¸ªéƒ¨åˆ†ä¸æ—¶é—´æœ‰å…³ï¼Œå¦‚æœä½ åœ¨ç”Ÿæˆä¸€ä¸ªUUIDä¹‹åï¼Œè¿‡å‡ ç§’åˆç”Ÿæˆä¸€ä¸ªUUIDï¼Œåˆ™ç¬¬ä¸€ä¸ªéƒ¨åˆ†ä¸åŒï¼Œå…¶ä½™ç›¸åŒã€‚</p>\n</li>\n<li><p>æ—¶é’Ÿåºåˆ—ã€‚</p>\n</li>\n<li><p>å…¨å±€å”¯ä¸€çš„IEEEæœºå™¨è¯†åˆ«å·ï¼Œå¦‚æœæœ‰ç½‘å¡ï¼Œä»ç½‘å¡MACåœ°å€è·å¾—ï¼Œæ²¡æœ‰ç½‘å¡ä»¥å…¶ä»–æ–¹å¼è·å¾—ã€‚</p>\n</li>\n</ul>\n<p>UUIDçš„å”¯ä¸€ç¼ºé™·åœ¨äºç”Ÿæˆçš„ç»“æœä¸²ä¼šæ¯”è¾ƒé•¿ã€‚å…³äºUUIDè¿™ä¸ªæ ‡å‡†ä½¿ç”¨æœ€æ™®éçš„æ˜¯å¾®è½¯çš„GUID(Globals Unique Identifiers)ã€‚</p>\n<h4 id=\"UUIDçš„ç”Ÿæˆ\"><a href=\"#UUIDçš„ç”Ÿæˆ\" class=\"headerlink\" title=\"UUIDçš„ç”Ÿæˆ\"></a>UUIDçš„ç”Ÿæˆ</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) throws Exception &#123;\n\tSystem.out.println(UUID.randomUUID());\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<blockquote>\n<p>æ‰¹é‡ç”ŸæˆUUIDç½‘ç«™ï¼š<a href=\"http://www.uuid.online/\">http://www.uuid.online/</a></p>\n</blockquote>\n"},{"title":"HashMap å’Œ Hashtable çš„ 6 ä¸ªåŒºåˆ«","date":"2025-10-15T03:36:33.000Z","_content":"\nHashMap å’Œ Hashtable æ˜¯ Java å¼€å‘ç¨‹åºå‘˜å¿…é¡»è¦æŒæ¡çš„ï¼Œä¹Ÿæ˜¯åœ¨å„ç§ Java é¢è¯•åœºåˆä¸­å¿…é¡»ä¼šé—®åˆ°çš„ã€‚\n\nä½†ä½ å¯¹è¿™ä¸¤è€…çš„åŒºåˆ«äº†è§£æœ‰å¤šå°‘å‘¢ï¼Ÿ\n\nç°åœ¨ï¼Œæ ˆé•¿æˆ‘ç»™å¤§å®¶æ€»ç»“ä¸€ä¸‹ï¼Œæˆ–è®¸æœ‰ä½ ä¸æ˜æœ—çš„åœ°æ–¹ï¼Œåœ¨æ ˆé•¿çš„æŒ‡ç‚¹ä¸‹éƒ½ä¼šæ‹¨å¼€è¿·é›¾è§æ™´å¤©ã€‚\n\n## 1ã€çº¿ç¨‹å®‰å…¨\n\nHashtable æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼ŒHashMap ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚\n\nä¸ºä»€ä¹ˆè¯´ HashTable æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ\n\næ¥çœ‹ä¸‹ Hashtable çš„æºç ï¼ŒHashtable æ‰€æœ‰çš„å…ƒç´ æ“ä½œéƒ½æ˜¯ synchronized ä¿®é¥°çš„ï¼Œè€Œ HashMap å¹¶æ²¡æœ‰ã€‚\n\n```\npublic synchronized V put(K key, V value);\npublic synchronized V get(Object key);\n...\n```\n\n## 2ã€æ€§èƒ½ä¼˜åŠ£\n\næ—¢ç„¶ Hashtable æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ¯ä¸ªæ–¹æ³•éƒ½è¦é˜»å¡å…¶ä»–çº¿ç¨‹ï¼Œæ‰€ä»¥ Hashtable æ€§èƒ½è¾ƒå·®ï¼ŒHashMap æ€§èƒ½è¾ƒå¥½ï¼Œä½¿ç”¨æ›´å¹¿ã€‚\n\nå¦‚æœè¦çº¿ç¨‹å®‰å…¨åˆè¦ä¿è¯æ€§èƒ½ï¼Œå»ºè®®ä½¿ç”¨ JUC åŒ…ä¸‹çš„ ConcurrentHashMapã€‚\n\n## 3ã€NULL\n\nHashtable æ˜¯ä¸å…è®¸é”®æˆ–å€¼ä¸º null çš„ï¼ŒHashMap çš„é”®å€¼åˆ™éƒ½å¯ä»¥ä¸º nullã€‚\n\né‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œä¸ºä»€ä¹ˆ Hashtable æ˜¯ä¸å…è®¸ KEY å’Œ VALUE ä¸º null, è€Œ HashMap åˆ™å¯ä»¥ï¼Ÿ\n\n**Hashtable put æ–¹æ³•é€»è¾‘ï¼š**\n\n```\n public synchronized V put(K key, V value) {\n        // Make sure the value is not null\n        if (value == null) {\n            throw new NullPointerException();\n        }\n\n        // Makes sure the key is not already in the hashtable.\n        Entry<?,?> tab[] = table;\n        int hash = key.hashCode();\n        \n        ...\n    \n}        \n```\n\n**HashMap hash æ–¹æ³•é€»è¾‘ï¼š**\n\n```\nstatic final int hash(Object key) {\n    int h;\n    return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);\n}\n```\n\nå¯ä»¥çœ‹å‡º Hashtable key ä¸º null ä¼šç›´æ¥æŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œvalue ä¸º null æ‰‹åŠ¨æŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œè€Œ HashMap çš„é€»è¾‘å¯¹ null ä½œäº†ç‰¹æ®Šå¤„ç†ã€‚\n\n## 4ã€å®ç°æ–¹å¼\n\nHashtable çš„ç»§æ‰¿æºç ï¼š\n\n```\npublic class Hashtable<K,V>\n    extends Dictionary<K,V>\n    implements Map<K,V>, Cloneable, java.io.Serializable\n```\n\nHashMap çš„ç»§æ‰¿æºç ï¼š\n\n```\npublic class HashMap<K,V> extends AbstractMap<K,V>\n    implements Map<K,V>, Cloneable, Serializable\n```\n\nå¯ä»¥çœ‹å‡ºä¸¤è€…ç»§æ‰¿çš„ç±»ä¸ä¸€æ ·ï¼ŒHashtable ç»§æ‰¿äº† Dictionaryç±»ï¼Œè€Œ HashMap ç»§æ‰¿çš„æ˜¯ AbstractMap ç±»ã€‚\n\nDictionary æ˜¯ JDK 1.0 æ·»åŠ çš„ï¼Œè²Œä¼¼æ²¡äººç”¨è¿‡è¿™ä¸ªï¼Œæ ˆé•¿æˆ‘ä¹Ÿæ²¡ç”¨è¿‡ã€‚ã€‚\n\n## 5ã€å®¹é‡æ‰©å®¹\n\nHashMap çš„åˆå§‹å®¹é‡ä¸ºï¼š16ï¼ŒHashtable åˆå§‹å®¹é‡ä¸ºï¼š11ï¼Œä¸¤è€…çš„è´Ÿè½½å› å­é»˜è®¤éƒ½æ˜¯ï¼š0.75ã€‚\n\n```\n/**\n * Constructs a new, empty hashtable with a default initial capacity (11)\n * and load factor (0.75).\n */\npublic Hashtable() {\n    this(11, 0.75f);\n}\n\n/**\n * Constructs an empty <tt>HashMap</tt> with the default initial capacity\n * (16) and the default load factor (0.75).\n */\npublic HashMap() {\n    this.loadFactor = DEFAULT_LOAD_FACTOR; // all other fields defaulted\n}\n```\n\nå½“ç°æœ‰å®¹é‡å¤§äºæ€»å®¹é‡ * è´Ÿè½½å› å­æ—¶ï¼ŒHashMap æ‰©å®¹è§„åˆ™ä¸ºå½“å‰å®¹é‡ç¿»å€ï¼ŒHashtable æ‰©å®¹è§„åˆ™ä¸ºå½“å‰å®¹é‡ç¿»å€ + 1ã€‚\n\n## 6ã€è¿­ä»£å™¨\n\nHashMap ä¸­çš„ Iterator è¿­ä»£å™¨æ˜¯ fail-fast çš„ï¼Œè€Œ Hashtable çš„ Enumerator ä¸æ˜¯ fail-fast çš„ã€‚\n\næ‰€ä»¥ï¼Œå½“å…¶ä»–çº¿ç¨‹æ”¹å˜äº†HashMap çš„ç»“æ„ï¼Œå¦‚ï¼šå¢åŠ ã€åˆ é™¤å…ƒç´ ï¼Œå°†ä¼šæŠ›å‡º ConcurrentModificationException å¼‚å¸¸ï¼Œè€Œ Hashtable åˆ™ä¸ä¼šã€‚\n\n**å¯ä»¥æ¥çœ‹ä¸‹è¿™ä¸ªåŒºåˆ«çš„æ¼”ç¤ºï¼š**\n\n```\n/**\n* \n**/\npublic static void main(String[] args) {\n    Map<String, String> hashtable = new Hashtable<>();\n    hashtable.put(\"t1\", \"1\");\n    hashtable.put(\"t2\", \"2\");\n    hashtable.put(\"t3\", \"3\");\n\n    Enumeration<Map.Entry<String, String>> iterator1 = (Enumeration<Map.Entry<String, String>>) hashtable.entrySet().iterator();\n    hashtable.remove(iterator1.nextElement().getKey());\n    while (iterator1.hasMoreElements()) {\n        System.out.println(iterator1.nextElement());\n    }\n\n    Map<String, String> hashMap = new HashMap<>();\n    hashMap.put(\"h1\", \"1\");\n    hashMap.put(\"h2\", \"2\");\n    hashMap.put(\"h3\", \"3\");\n\n    Iterator<Map.Entry<String, String>> iterator2 = hashMap.entrySet().iterator();\n    hashMap.remove(iterator2.next().getKey());\n    while (iterator2.hasNext()) {\n        System.out.println(iterator2.next());\n    }\n\n}\n```\n\nè¾“å‡ºä¿¡æ¯ï¼š\n\n```\nt2=2\nt1=1\nException in thread \"main\" java.util.ConcurrentModificationException\n\tat java.util.HashMap$HashIterator.nextNode(HashMap.java:1442)\n\tat java.util.HashMap$EntryIterator.next(HashMap.java:1476)\n\tat java.util.HashMap$EntryIterator.next(HashMap.java:1474)\n\tat cn.javastack.Test.main(Test.java:37)\n```\n\nçœ‹åˆ°äº†å§ï¼Ÿ\n\næ‰€ä»¥ï¼Œè¿™æ¡åŒæ ·ä¹Ÿæ˜¯ Enumeration å’Œ Iterator çš„åŒºåˆ«ã€‚ \n\næœ€åä¸€ç‚¹æœ‰å‡ ä¸ªäººçŸ¥é“ï¼ŸçŸ¥é“çš„ç»™æ ˆé•¿ç‚¹ä¸ªèµå›åº”ä¸€ä¸‹ï¼Œä¸çŸ¥é“çš„æœ‰æ”¶è·çš„ä¹Ÿç‚¹ä¸€ä¸ªèµæ”¯æŒä¸€ä¸‹å§ã€‚\n\næœ‰æ”¶è·ï¼Ÿè½¬å‘ç»™æ›´å¤šçš„äººå§ï¼\n\n","source":"_posts/é›†åˆ/HashMap å’Œ Hashtable çš„ 6 ä¸ªåŒºåˆ«.md","raw":"---\ntitle: HashMap å’Œ Hashtable çš„ 6 ä¸ªåŒºåˆ«\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: é›†åˆ\n---\n\nHashMap å’Œ Hashtable æ˜¯ Java å¼€å‘ç¨‹åºå‘˜å¿…é¡»è¦æŒæ¡çš„ï¼Œä¹Ÿæ˜¯åœ¨å„ç§ Java é¢è¯•åœºåˆä¸­å¿…é¡»ä¼šé—®åˆ°çš„ã€‚\n\nä½†ä½ å¯¹è¿™ä¸¤è€…çš„åŒºåˆ«äº†è§£æœ‰å¤šå°‘å‘¢ï¼Ÿ\n\nç°åœ¨ï¼Œæ ˆé•¿æˆ‘ç»™å¤§å®¶æ€»ç»“ä¸€ä¸‹ï¼Œæˆ–è®¸æœ‰ä½ ä¸æ˜æœ—çš„åœ°æ–¹ï¼Œåœ¨æ ˆé•¿çš„æŒ‡ç‚¹ä¸‹éƒ½ä¼šæ‹¨å¼€è¿·é›¾è§æ™´å¤©ã€‚\n\n## 1ã€çº¿ç¨‹å®‰å…¨\n\nHashtable æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼ŒHashMap ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚\n\nä¸ºä»€ä¹ˆè¯´ HashTable æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ\n\næ¥çœ‹ä¸‹ Hashtable çš„æºç ï¼ŒHashtable æ‰€æœ‰çš„å…ƒç´ æ“ä½œéƒ½æ˜¯ synchronized ä¿®é¥°çš„ï¼Œè€Œ HashMap å¹¶æ²¡æœ‰ã€‚\n\n```\npublic synchronized V put(K key, V value);\npublic synchronized V get(Object key);\n...\n```\n\n## 2ã€æ€§èƒ½ä¼˜åŠ£\n\næ—¢ç„¶ Hashtable æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ¯ä¸ªæ–¹æ³•éƒ½è¦é˜»å¡å…¶ä»–çº¿ç¨‹ï¼Œæ‰€ä»¥ Hashtable æ€§èƒ½è¾ƒå·®ï¼ŒHashMap æ€§èƒ½è¾ƒå¥½ï¼Œä½¿ç”¨æ›´å¹¿ã€‚\n\nå¦‚æœè¦çº¿ç¨‹å®‰å…¨åˆè¦ä¿è¯æ€§èƒ½ï¼Œå»ºè®®ä½¿ç”¨ JUC åŒ…ä¸‹çš„ ConcurrentHashMapã€‚\n\n## 3ã€NULL\n\nHashtable æ˜¯ä¸å…è®¸é”®æˆ–å€¼ä¸º null çš„ï¼ŒHashMap çš„é”®å€¼åˆ™éƒ½å¯ä»¥ä¸º nullã€‚\n\né‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œä¸ºä»€ä¹ˆ Hashtable æ˜¯ä¸å…è®¸ KEY å’Œ VALUE ä¸º null, è€Œ HashMap åˆ™å¯ä»¥ï¼Ÿ\n\n**Hashtable put æ–¹æ³•é€»è¾‘ï¼š**\n\n```\n public synchronized V put(K key, V value) {\n        // Make sure the value is not null\n        if (value == null) {\n            throw new NullPointerException();\n        }\n\n        // Makes sure the key is not already in the hashtable.\n        Entry<?,?> tab[] = table;\n        int hash = key.hashCode();\n        \n        ...\n    \n}        \n```\n\n**HashMap hash æ–¹æ³•é€»è¾‘ï¼š**\n\n```\nstatic final int hash(Object key) {\n    int h;\n    return (key == null) ? 0 : (h = key.hashCode()) ^ (h >>> 16);\n}\n```\n\nå¯ä»¥çœ‹å‡º Hashtable key ä¸º null ä¼šç›´æ¥æŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œvalue ä¸º null æ‰‹åŠ¨æŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œè€Œ HashMap çš„é€»è¾‘å¯¹ null ä½œäº†ç‰¹æ®Šå¤„ç†ã€‚\n\n## 4ã€å®ç°æ–¹å¼\n\nHashtable çš„ç»§æ‰¿æºç ï¼š\n\n```\npublic class Hashtable<K,V>\n    extends Dictionary<K,V>\n    implements Map<K,V>, Cloneable, java.io.Serializable\n```\n\nHashMap çš„ç»§æ‰¿æºç ï¼š\n\n```\npublic class HashMap<K,V> extends AbstractMap<K,V>\n    implements Map<K,V>, Cloneable, Serializable\n```\n\nå¯ä»¥çœ‹å‡ºä¸¤è€…ç»§æ‰¿çš„ç±»ä¸ä¸€æ ·ï¼ŒHashtable ç»§æ‰¿äº† Dictionaryç±»ï¼Œè€Œ HashMap ç»§æ‰¿çš„æ˜¯ AbstractMap ç±»ã€‚\n\nDictionary æ˜¯ JDK 1.0 æ·»åŠ çš„ï¼Œè²Œä¼¼æ²¡äººç”¨è¿‡è¿™ä¸ªï¼Œæ ˆé•¿æˆ‘ä¹Ÿæ²¡ç”¨è¿‡ã€‚ã€‚\n\n## 5ã€å®¹é‡æ‰©å®¹\n\nHashMap çš„åˆå§‹å®¹é‡ä¸ºï¼š16ï¼ŒHashtable åˆå§‹å®¹é‡ä¸ºï¼š11ï¼Œä¸¤è€…çš„è´Ÿè½½å› å­é»˜è®¤éƒ½æ˜¯ï¼š0.75ã€‚\n\n```\n/**\n * Constructs a new, empty hashtable with a default initial capacity (11)\n * and load factor (0.75).\n */\npublic Hashtable() {\n    this(11, 0.75f);\n}\n\n/**\n * Constructs an empty <tt>HashMap</tt> with the default initial capacity\n * (16) and the default load factor (0.75).\n */\npublic HashMap() {\n    this.loadFactor = DEFAULT_LOAD_FACTOR; // all other fields defaulted\n}\n```\n\nå½“ç°æœ‰å®¹é‡å¤§äºæ€»å®¹é‡ * è´Ÿè½½å› å­æ—¶ï¼ŒHashMap æ‰©å®¹è§„åˆ™ä¸ºå½“å‰å®¹é‡ç¿»å€ï¼ŒHashtable æ‰©å®¹è§„åˆ™ä¸ºå½“å‰å®¹é‡ç¿»å€ + 1ã€‚\n\n## 6ã€è¿­ä»£å™¨\n\nHashMap ä¸­çš„ Iterator è¿­ä»£å™¨æ˜¯ fail-fast çš„ï¼Œè€Œ Hashtable çš„ Enumerator ä¸æ˜¯ fail-fast çš„ã€‚\n\næ‰€ä»¥ï¼Œå½“å…¶ä»–çº¿ç¨‹æ”¹å˜äº†HashMap çš„ç»“æ„ï¼Œå¦‚ï¼šå¢åŠ ã€åˆ é™¤å…ƒç´ ï¼Œå°†ä¼šæŠ›å‡º ConcurrentModificationException å¼‚å¸¸ï¼Œè€Œ Hashtable åˆ™ä¸ä¼šã€‚\n\n**å¯ä»¥æ¥çœ‹ä¸‹è¿™ä¸ªåŒºåˆ«çš„æ¼”ç¤ºï¼š**\n\n```\n/**\n* \n**/\npublic static void main(String[] args) {\n    Map<String, String> hashtable = new Hashtable<>();\n    hashtable.put(\"t1\", \"1\");\n    hashtable.put(\"t2\", \"2\");\n    hashtable.put(\"t3\", \"3\");\n\n    Enumeration<Map.Entry<String, String>> iterator1 = (Enumeration<Map.Entry<String, String>>) hashtable.entrySet().iterator();\n    hashtable.remove(iterator1.nextElement().getKey());\n    while (iterator1.hasMoreElements()) {\n        System.out.println(iterator1.nextElement());\n    }\n\n    Map<String, String> hashMap = new HashMap<>();\n    hashMap.put(\"h1\", \"1\");\n    hashMap.put(\"h2\", \"2\");\n    hashMap.put(\"h3\", \"3\");\n\n    Iterator<Map.Entry<String, String>> iterator2 = hashMap.entrySet().iterator();\n    hashMap.remove(iterator2.next().getKey());\n    while (iterator2.hasNext()) {\n        System.out.println(iterator2.next());\n    }\n\n}\n```\n\nè¾“å‡ºä¿¡æ¯ï¼š\n\n```\nt2=2\nt1=1\nException in thread \"main\" java.util.ConcurrentModificationException\n\tat java.util.HashMap$HashIterator.nextNode(HashMap.java:1442)\n\tat java.util.HashMap$EntryIterator.next(HashMap.java:1476)\n\tat java.util.HashMap$EntryIterator.next(HashMap.java:1474)\n\tat cn.javastack.Test.main(Test.java:37)\n```\n\nçœ‹åˆ°äº†å§ï¼Ÿ\n\næ‰€ä»¥ï¼Œè¿™æ¡åŒæ ·ä¹Ÿæ˜¯ Enumeration å’Œ Iterator çš„åŒºåˆ«ã€‚ \n\næœ€åä¸€ç‚¹æœ‰å‡ ä¸ªäººçŸ¥é“ï¼ŸçŸ¥é“çš„ç»™æ ˆé•¿ç‚¹ä¸ªèµå›åº”ä¸€ä¸‹ï¼Œä¸çŸ¥é“çš„æœ‰æ”¶è·çš„ä¹Ÿç‚¹ä¸€ä¸ªèµæ”¯æŒä¸€ä¸‹å§ã€‚\n\næœ‰æ”¶è·ï¼Ÿè½¬å‘ç»™æ›´å¤šçš„äººå§ï¼\n\n","slug":"é›†åˆ/HashMap å’Œ Hashtable çš„ 6 ä¸ªåŒºåˆ«","published":1,"updated":"2025-10-15T07:21:29.813Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu076z004rqkd4fpic9h04","content":"<p>HashMap å’Œ Hashtable æ˜¯ Java å¼€å‘ç¨‹åºå‘˜å¿…é¡»è¦æŒæ¡çš„ï¼Œä¹Ÿæ˜¯åœ¨å„ç§ Java é¢è¯•åœºåˆä¸­å¿…é¡»ä¼šé—®åˆ°çš„ã€‚</p>\n<p>ä½†ä½ å¯¹è¿™ä¸¤è€…çš„åŒºåˆ«äº†è§£æœ‰å¤šå°‘å‘¢ï¼Ÿ</p>\n<p>ç°åœ¨ï¼Œæ ˆé•¿æˆ‘ç»™å¤§å®¶æ€»ç»“ä¸€ä¸‹ï¼Œæˆ–è®¸æœ‰ä½ ä¸æ˜æœ—çš„åœ°æ–¹ï¼Œåœ¨æ ˆé•¿çš„æŒ‡ç‚¹ä¸‹éƒ½ä¼šæ‹¨å¼€è¿·é›¾è§æ™´å¤©ã€‚</p>\n<h2 id=\"1ã€çº¿ç¨‹å®‰å…¨\"><a href=\"#1ã€çº¿ç¨‹å®‰å…¨\" class=\"headerlink\" title=\"1ã€çº¿ç¨‹å®‰å…¨\"></a>1ã€çº¿ç¨‹å®‰å…¨</h2><p>Hashtable æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼ŒHashMap ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p>\n<p>ä¸ºä»€ä¹ˆè¯´ HashTable æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ</p>\n<p>æ¥çœ‹ä¸‹ Hashtable çš„æºç ï¼ŒHashtable æ‰€æœ‰çš„å…ƒç´ æ“ä½œéƒ½æ˜¯ synchronized ä¿®é¥°çš„ï¼Œè€Œ HashMap å¹¶æ²¡æœ‰ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public synchronized V put(K key, V value);\npublic synchronized V get(Object key);\n...<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"2ã€æ€§èƒ½ä¼˜åŠ£\"><a href=\"#2ã€æ€§èƒ½ä¼˜åŠ£\" class=\"headerlink\" title=\"2ã€æ€§èƒ½ä¼˜åŠ£\"></a>2ã€æ€§èƒ½ä¼˜åŠ£</h2><p>æ—¢ç„¶ Hashtable æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ¯ä¸ªæ–¹æ³•éƒ½è¦é˜»å¡å…¶ä»–çº¿ç¨‹ï¼Œæ‰€ä»¥ Hashtable æ€§èƒ½è¾ƒå·®ï¼ŒHashMap æ€§èƒ½è¾ƒå¥½ï¼Œä½¿ç”¨æ›´å¹¿ã€‚</p>\n<p>å¦‚æœè¦çº¿ç¨‹å®‰å…¨åˆè¦ä¿è¯æ€§èƒ½ï¼Œå»ºè®®ä½¿ç”¨ JUC åŒ…ä¸‹çš„ ConcurrentHashMapã€‚</p>\n<h2 id=\"3ã€NULL\"><a href=\"#3ã€NULL\" class=\"headerlink\" title=\"3ã€NULL\"></a>3ã€NULL</h2><p>Hashtable æ˜¯ä¸å…è®¸é”®æˆ–å€¼ä¸º null çš„ï¼ŒHashMap çš„é”®å€¼åˆ™éƒ½å¯ä»¥ä¸º nullã€‚</p>\n<p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œä¸ºä»€ä¹ˆ Hashtable æ˜¯ä¸å…è®¸ KEY å’Œ VALUE ä¸º null, è€Œ HashMap åˆ™å¯ä»¥ï¼Ÿ</p>\n<p><strong>Hashtable put æ–¹æ³•é€»è¾‘ï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"> public synchronized V put(K key, V value) &#123;\n        &#x2F;&#x2F; Make sure the value is not null\n        if (value &#x3D;&#x3D; null) &#123;\n            throw new NullPointerException();\n        &#125;\n\n        &#x2F;&#x2F; Makes sure the key is not already in the hashtable.\n        Entry&lt;?,?&gt; tab[] &#x3D; table;\n        int hash &#x3D; key.hashCode();\n        \n        ...\n    \n&#125;        <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>HashMap hash æ–¹æ³•é€»è¾‘ï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">static final int hash(Object key) &#123;\n    int h;\n    return (key &#x3D;&#x3D; null) ? 0 : (h &#x3D; key.hashCode()) ^ (h &gt;&gt;&gt; 16);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥çœ‹å‡º Hashtable key ä¸º null ä¼šç›´æ¥æŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œvalue ä¸º null æ‰‹åŠ¨æŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œè€Œ HashMap çš„é€»è¾‘å¯¹ null ä½œäº†ç‰¹æ®Šå¤„ç†ã€‚</p>\n<h2 id=\"4ã€å®ç°æ–¹å¼\"><a href=\"#4ã€å®ç°æ–¹å¼\" class=\"headerlink\" title=\"4ã€å®ç°æ–¹å¼\"></a>4ã€å®ç°æ–¹å¼</h2><p>Hashtable çš„ç»§æ‰¿æºç ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class Hashtable&lt;K,V&gt;\n    extends Dictionary&lt;K,V&gt;\n    implements Map&lt;K,V&gt;, Cloneable, java.io.Serializable<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>HashMap çš„ç»§æ‰¿æºç ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class HashMap&lt;K,V&gt; extends AbstractMap&lt;K,V&gt;\n    implements Map&lt;K,V&gt;, Cloneable, Serializable<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥çœ‹å‡ºä¸¤è€…ç»§æ‰¿çš„ç±»ä¸ä¸€æ ·ï¼ŒHashtable ç»§æ‰¿äº† Dictionaryç±»ï¼Œè€Œ HashMap ç»§æ‰¿çš„æ˜¯ AbstractMap ç±»ã€‚</p>\n<p>Dictionary æ˜¯ JDK 1.0 æ·»åŠ çš„ï¼Œè²Œä¼¼æ²¡äººç”¨è¿‡è¿™ä¸ªï¼Œæ ˆé•¿æˆ‘ä¹Ÿæ²¡ç”¨è¿‡ã€‚ã€‚</p>\n<h2 id=\"5ã€å®¹é‡æ‰©å®¹\"><a href=\"#5ã€å®¹é‡æ‰©å®¹\" class=\"headerlink\" title=\"5ã€å®¹é‡æ‰©å®¹\"></a>5ã€å®¹é‡æ‰©å®¹</h2><p>HashMap çš„åˆå§‹å®¹é‡ä¸ºï¼š16ï¼ŒHashtable åˆå§‹å®¹é‡ä¸ºï¼š11ï¼Œä¸¤è€…çš„è´Ÿè½½å› å­é»˜è®¤éƒ½æ˜¯ï¼š0.75ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * Constructs a new, empty hashtable with a default initial capacity (11)\n * and load factor (0.75).\n *&#x2F;\npublic Hashtable() &#123;\n    this(11, 0.75f);\n&#125;\n\n&#x2F;**\n * Constructs an empty &lt;tt&gt;HashMap&lt;&#x2F;tt&gt; with the default initial capacity\n * (16) and the default load factor (0.75).\n *&#x2F;\npublic HashMap() &#123;\n    this.loadFactor &#x3D; DEFAULT_LOAD_FACTOR; &#x2F;&#x2F; all other fields defaulted\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å½“ç°æœ‰å®¹é‡å¤§äºæ€»å®¹é‡ * è´Ÿè½½å› å­æ—¶ï¼ŒHashMap æ‰©å®¹è§„åˆ™ä¸ºå½“å‰å®¹é‡ç¿»å€ï¼ŒHashtable æ‰©å®¹è§„åˆ™ä¸ºå½“å‰å®¹é‡ç¿»å€ + 1ã€‚</p>\n<h2 id=\"6ã€è¿­ä»£å™¨\"><a href=\"#6ã€è¿­ä»£å™¨\" class=\"headerlink\" title=\"6ã€è¿­ä»£å™¨\"></a>6ã€è¿­ä»£å™¨</h2><p>HashMap ä¸­çš„ Iterator è¿­ä»£å™¨æ˜¯ fail-fast çš„ï¼Œè€Œ Hashtable çš„ Enumerator ä¸æ˜¯ fail-fast çš„ã€‚</p>\n<p>æ‰€ä»¥ï¼Œå½“å…¶ä»–çº¿ç¨‹æ”¹å˜äº†HashMap çš„ç»“æ„ï¼Œå¦‚ï¼šå¢åŠ ã€åˆ é™¤å…ƒç´ ï¼Œå°†ä¼šæŠ›å‡º ConcurrentModificationException å¼‚å¸¸ï¼Œè€Œ Hashtable åˆ™ä¸ä¼šã€‚</p>\n<p><strong>å¯ä»¥æ¥çœ‹ä¸‹è¿™ä¸ªåŒºåˆ«çš„æ¼”ç¤ºï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n* \n**&#x2F;\npublic static void main(String[] args) &#123;\n    Map&lt;String, String&gt; hashtable &#x3D; new Hashtable&lt;&gt;();\n    hashtable.put(&quot;t1&quot;, &quot;1&quot;);\n    hashtable.put(&quot;t2&quot;, &quot;2&quot;);\n    hashtable.put(&quot;t3&quot;, &quot;3&quot;);\n\n    Enumeration&lt;Map.Entry&lt;String, String&gt;&gt; iterator1 &#x3D; (Enumeration&lt;Map.Entry&lt;String, String&gt;&gt;) hashtable.entrySet().iterator();\n    hashtable.remove(iterator1.nextElement().getKey());\n    while (iterator1.hasMoreElements()) &#123;\n        System.out.println(iterator1.nextElement());\n    &#125;\n\n    Map&lt;String, String&gt; hashMap &#x3D; new HashMap&lt;&gt;();\n    hashMap.put(&quot;h1&quot;, &quot;1&quot;);\n    hashMap.put(&quot;h2&quot;, &quot;2&quot;);\n    hashMap.put(&quot;h3&quot;, &quot;3&quot;);\n\n    Iterator&lt;Map.Entry&lt;String, String&gt;&gt; iterator2 &#x3D; hashMap.entrySet().iterator();\n    hashMap.remove(iterator2.next().getKey());\n    while (iterator2.hasNext()) &#123;\n        System.out.println(iterator2.next());\n    &#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¾“å‡ºä¿¡æ¯ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">t2&#x3D;2\nt1&#x3D;1\nException in thread &quot;main&quot; java.util.ConcurrentModificationException\n\tat java.util.HashMap$HashIterator.nextNode(HashMap.java:1442)\n\tat java.util.HashMap$EntryIterator.next(HashMap.java:1476)\n\tat java.util.HashMap$EntryIterator.next(HashMap.java:1474)\n\tat cn.javastack.Test.main(Test.java:37)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>çœ‹åˆ°äº†å§ï¼Ÿ</p>\n<p>æ‰€ä»¥ï¼Œè¿™æ¡åŒæ ·ä¹Ÿæ˜¯ Enumeration å’Œ Iterator çš„åŒºåˆ«ã€‚ </p>\n<p>æœ€åä¸€ç‚¹æœ‰å‡ ä¸ªäººçŸ¥é“ï¼ŸçŸ¥é“çš„ç»™æ ˆé•¿ç‚¹ä¸ªèµå›åº”ä¸€ä¸‹ï¼Œä¸çŸ¥é“çš„æœ‰æ”¶è·çš„ä¹Ÿç‚¹ä¸€ä¸ªèµæ”¯æŒä¸€ä¸‹å§ã€‚</p>\n<p>æœ‰æ”¶è·ï¼Ÿè½¬å‘ç»™æ›´å¤šçš„äººå§ï¼</p>\n","excerpt":"","more":"<p>HashMap å’Œ Hashtable æ˜¯ Java å¼€å‘ç¨‹åºå‘˜å¿…é¡»è¦æŒæ¡çš„ï¼Œä¹Ÿæ˜¯åœ¨å„ç§ Java é¢è¯•åœºåˆä¸­å¿…é¡»ä¼šé—®åˆ°çš„ã€‚</p>\n<p>ä½†ä½ å¯¹è¿™ä¸¤è€…çš„åŒºåˆ«äº†è§£æœ‰å¤šå°‘å‘¢ï¼Ÿ</p>\n<p>ç°åœ¨ï¼Œæ ˆé•¿æˆ‘ç»™å¤§å®¶æ€»ç»“ä¸€ä¸‹ï¼Œæˆ–è®¸æœ‰ä½ ä¸æ˜æœ—çš„åœ°æ–¹ï¼Œåœ¨æ ˆé•¿çš„æŒ‡ç‚¹ä¸‹éƒ½ä¼šæ‹¨å¼€è¿·é›¾è§æ™´å¤©ã€‚</p>\n<h2 id=\"1ã€çº¿ç¨‹å®‰å…¨\"><a href=\"#1ã€çº¿ç¨‹å®‰å…¨\" class=\"headerlink\" title=\"1ã€çº¿ç¨‹å®‰å…¨\"></a>1ã€çº¿ç¨‹å®‰å…¨</h2><p>Hashtable æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼ŒHashMap ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</p>\n<p>ä¸ºä»€ä¹ˆè¯´ HashTable æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ</p>\n<p>æ¥çœ‹ä¸‹ Hashtable çš„æºç ï¼ŒHashtable æ‰€æœ‰çš„å…ƒç´ æ“ä½œéƒ½æ˜¯ synchronized ä¿®é¥°çš„ï¼Œè€Œ HashMap å¹¶æ²¡æœ‰ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public synchronized V put(K key, V value);\npublic synchronized V get(Object key);\n...<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"2ã€æ€§èƒ½ä¼˜åŠ£\"><a href=\"#2ã€æ€§èƒ½ä¼˜åŠ£\" class=\"headerlink\" title=\"2ã€æ€§èƒ½ä¼˜åŠ£\"></a>2ã€æ€§èƒ½ä¼˜åŠ£</h2><p>æ—¢ç„¶ Hashtable æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œæ¯ä¸ªæ–¹æ³•éƒ½è¦é˜»å¡å…¶ä»–çº¿ç¨‹ï¼Œæ‰€ä»¥ Hashtable æ€§èƒ½è¾ƒå·®ï¼ŒHashMap æ€§èƒ½è¾ƒå¥½ï¼Œä½¿ç”¨æ›´å¹¿ã€‚</p>\n<p>å¦‚æœè¦çº¿ç¨‹å®‰å…¨åˆè¦ä¿è¯æ€§èƒ½ï¼Œå»ºè®®ä½¿ç”¨ JUC åŒ…ä¸‹çš„ ConcurrentHashMapã€‚</p>\n<h2 id=\"3ã€NULL\"><a href=\"#3ã€NULL\" class=\"headerlink\" title=\"3ã€NULL\"></a>3ã€NULL</h2><p>Hashtable æ˜¯ä¸å…è®¸é”®æˆ–å€¼ä¸º null çš„ï¼ŒHashMap çš„é”®å€¼åˆ™éƒ½å¯ä»¥ä¸º nullã€‚</p>\n<p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œä¸ºä»€ä¹ˆ Hashtable æ˜¯ä¸å…è®¸ KEY å’Œ VALUE ä¸º null, è€Œ HashMap åˆ™å¯ä»¥ï¼Ÿ</p>\n<p><strong>Hashtable put æ–¹æ³•é€»è¾‘ï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\"> public synchronized V put(K key, V value) &#123;\n        &#x2F;&#x2F; Make sure the value is not null\n        if (value &#x3D;&#x3D; null) &#123;\n            throw new NullPointerException();\n        &#125;\n\n        &#x2F;&#x2F; Makes sure the key is not already in the hashtable.\n        Entry&lt;?,?&gt; tab[] &#x3D; table;\n        int hash &#x3D; key.hashCode();\n        \n        ...\n    \n&#125;        <span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>HashMap hash æ–¹æ³•é€»è¾‘ï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">static final int hash(Object key) &#123;\n    int h;\n    return (key &#x3D;&#x3D; null) ? 0 : (h &#x3D; key.hashCode()) ^ (h &gt;&gt;&gt; 16);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥çœ‹å‡º Hashtable key ä¸º null ä¼šç›´æ¥æŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œvalue ä¸º null æ‰‹åŠ¨æŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œè€Œ HashMap çš„é€»è¾‘å¯¹ null ä½œäº†ç‰¹æ®Šå¤„ç†ã€‚</p>\n<h2 id=\"4ã€å®ç°æ–¹å¼\"><a href=\"#4ã€å®ç°æ–¹å¼\" class=\"headerlink\" title=\"4ã€å®ç°æ–¹å¼\"></a>4ã€å®ç°æ–¹å¼</h2><p>Hashtable çš„ç»§æ‰¿æºç ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class Hashtable&lt;K,V&gt;\n    extends Dictionary&lt;K,V&gt;\n    implements Map&lt;K,V&gt;, Cloneable, java.io.Serializable<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>HashMap çš„ç»§æ‰¿æºç ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class HashMap&lt;K,V&gt; extends AbstractMap&lt;K,V&gt;\n    implements Map&lt;K,V&gt;, Cloneable, Serializable<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥çœ‹å‡ºä¸¤è€…ç»§æ‰¿çš„ç±»ä¸ä¸€æ ·ï¼ŒHashtable ç»§æ‰¿äº† Dictionaryç±»ï¼Œè€Œ HashMap ç»§æ‰¿çš„æ˜¯ AbstractMap ç±»ã€‚</p>\n<p>Dictionary æ˜¯ JDK 1.0 æ·»åŠ çš„ï¼Œè²Œä¼¼æ²¡äººç”¨è¿‡è¿™ä¸ªï¼Œæ ˆé•¿æˆ‘ä¹Ÿæ²¡ç”¨è¿‡ã€‚ã€‚</p>\n<h2 id=\"5ã€å®¹é‡æ‰©å®¹\"><a href=\"#5ã€å®¹é‡æ‰©å®¹\" class=\"headerlink\" title=\"5ã€å®¹é‡æ‰©å®¹\"></a>5ã€å®¹é‡æ‰©å®¹</h2><p>HashMap çš„åˆå§‹å®¹é‡ä¸ºï¼š16ï¼ŒHashtable åˆå§‹å®¹é‡ä¸ºï¼š11ï¼Œä¸¤è€…çš„è´Ÿè½½å› å­é»˜è®¤éƒ½æ˜¯ï¼š0.75ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * Constructs a new, empty hashtable with a default initial capacity (11)\n * and load factor (0.75).\n *&#x2F;\npublic Hashtable() &#123;\n    this(11, 0.75f);\n&#125;\n\n&#x2F;**\n * Constructs an empty &lt;tt&gt;HashMap&lt;&#x2F;tt&gt; with the default initial capacity\n * (16) and the default load factor (0.75).\n *&#x2F;\npublic HashMap() &#123;\n    this.loadFactor &#x3D; DEFAULT_LOAD_FACTOR; &#x2F;&#x2F; all other fields defaulted\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å½“ç°æœ‰å®¹é‡å¤§äºæ€»å®¹é‡ * è´Ÿè½½å› å­æ—¶ï¼ŒHashMap æ‰©å®¹è§„åˆ™ä¸ºå½“å‰å®¹é‡ç¿»å€ï¼ŒHashtable æ‰©å®¹è§„åˆ™ä¸ºå½“å‰å®¹é‡ç¿»å€ + 1ã€‚</p>\n<h2 id=\"6ã€è¿­ä»£å™¨\"><a href=\"#6ã€è¿­ä»£å™¨\" class=\"headerlink\" title=\"6ã€è¿­ä»£å™¨\"></a>6ã€è¿­ä»£å™¨</h2><p>HashMap ä¸­çš„ Iterator è¿­ä»£å™¨æ˜¯ fail-fast çš„ï¼Œè€Œ Hashtable çš„ Enumerator ä¸æ˜¯ fail-fast çš„ã€‚</p>\n<p>æ‰€ä»¥ï¼Œå½“å…¶ä»–çº¿ç¨‹æ”¹å˜äº†HashMap çš„ç»“æ„ï¼Œå¦‚ï¼šå¢åŠ ã€åˆ é™¤å…ƒç´ ï¼Œå°†ä¼šæŠ›å‡º ConcurrentModificationException å¼‚å¸¸ï¼Œè€Œ Hashtable åˆ™ä¸ä¼šã€‚</p>\n<p><strong>å¯ä»¥æ¥çœ‹ä¸‹è¿™ä¸ªåŒºåˆ«çš„æ¼”ç¤ºï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n* \n**&#x2F;\npublic static void main(String[] args) &#123;\n    Map&lt;String, String&gt; hashtable &#x3D; new Hashtable&lt;&gt;();\n    hashtable.put(&quot;t1&quot;, &quot;1&quot;);\n    hashtable.put(&quot;t2&quot;, &quot;2&quot;);\n    hashtable.put(&quot;t3&quot;, &quot;3&quot;);\n\n    Enumeration&lt;Map.Entry&lt;String, String&gt;&gt; iterator1 &#x3D; (Enumeration&lt;Map.Entry&lt;String, String&gt;&gt;) hashtable.entrySet().iterator();\n    hashtable.remove(iterator1.nextElement().getKey());\n    while (iterator1.hasMoreElements()) &#123;\n        System.out.println(iterator1.nextElement());\n    &#125;\n\n    Map&lt;String, String&gt; hashMap &#x3D; new HashMap&lt;&gt;();\n    hashMap.put(&quot;h1&quot;, &quot;1&quot;);\n    hashMap.put(&quot;h2&quot;, &quot;2&quot;);\n    hashMap.put(&quot;h3&quot;, &quot;3&quot;);\n\n    Iterator&lt;Map.Entry&lt;String, String&gt;&gt; iterator2 &#x3D; hashMap.entrySet().iterator();\n    hashMap.remove(iterator2.next().getKey());\n    while (iterator2.hasNext()) &#123;\n        System.out.println(iterator2.next());\n    &#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¾“å‡ºä¿¡æ¯ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">t2&#x3D;2\nt1&#x3D;1\nException in thread &quot;main&quot; java.util.ConcurrentModificationException\n\tat java.util.HashMap$HashIterator.nextNode(HashMap.java:1442)\n\tat java.util.HashMap$EntryIterator.next(HashMap.java:1476)\n\tat java.util.HashMap$EntryIterator.next(HashMap.java:1474)\n\tat cn.javastack.Test.main(Test.java:37)<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>çœ‹åˆ°äº†å§ï¼Ÿ</p>\n<p>æ‰€ä»¥ï¼Œè¿™æ¡åŒæ ·ä¹Ÿæ˜¯ Enumeration å’Œ Iterator çš„åŒºåˆ«ã€‚ </p>\n<p>æœ€åä¸€ç‚¹æœ‰å‡ ä¸ªäººçŸ¥é“ï¼ŸçŸ¥é“çš„ç»™æ ˆé•¿ç‚¹ä¸ªèµå›åº”ä¸€ä¸‹ï¼Œä¸çŸ¥é“çš„æœ‰æ”¶è·çš„ä¹Ÿç‚¹ä¸€ä¸ªèµæ”¯æŒä¸€ä¸‹å§ã€‚</p>\n<p>æœ‰æ”¶è·ï¼Ÿè½¬å‘ç»™æ›´å¤šçš„äººå§ï¼</p>\n"},{"title":"Hashtable ä¸ºä»€ä¹ˆä¸å« HashTableï¼Ÿ","date":"2025-10-15T03:36:33.000Z","_content":"\n> ä»€ä¹ˆæ˜¯é©¼å³°å‘½åè§„åˆ™ï¼Œæ¥çœ‹ä¸‹é¢çš„å…³é”®å­—ï¼š\n> \n> - HashMap\n> - ArrayList\n> - ConcurrentHashMap\n> \n> ç®€å•æ¥è¯´å°±æ˜¯ï¼Œæ ‡è¯†ç¬¦çš„æ¯ä¸ªå•è¯é¦–å­—æ¯å¿…é¡»å¤§å†™ï¼Œçœ‹èµ·æ¥åƒæ˜¯é©¼å³°çš„å½¢çŠ¶ã€‚\n\nå½“æ—¶å°±å¾ˆå¥½å¥‡ï¼ŒHashtable ä¸ºä»€ä¹ˆä¸æ˜¯ HashTable å‘¢ï¼Ÿä½œä¸ºä¸€ååˆçº§çš„ Java ç¨‹åºå‘˜éƒ½åº”è¯¥çŸ¥é“çš„åŸºæœ¬çš„é©¼å³°å‘½åè§„åˆ™ï¼Œä¸ºä»€ä¹ˆ JDK ä»£ç é‡Œé¢è¿˜æœ‰è¿™ç§ä¸è§„èŒƒçš„å‘½åå‘¢ï¼Ÿ\n\næˆ‘æƒ³å¤§å®¶åº”è¯¥éƒ½æ¯”è¾ƒå¥½å¥‡ï¼Œæˆ‘ç‰¹æ„å»æŸ¥äº†ä¸‹èµ„æ–™ï¼Œæ²¡æœ‰æŸ¥åˆ°å®˜æ–¹çš„è¯´æ³•ï¼Œä¸è¿‡åœ¨ stackoverflow ä¸Šçœ‹åˆ°äº†åŒæ ·çš„è¿™ä¸ªé—®é¢˜ã€‚\n\nåŸè´´å¦‚ä¸‹ï¼š\n\n> https://stackoverflow.com/questions/12506706/why-is-the-t-in-hash-tablehashtable-in-java-not-capitalized\n\n![](http://qianniu.javastack.cn/18-12-6/56236009.jpg)\n\næœ€ä½³ç­”æ¡ˆæ˜¯ï¼š\n\n> Hashtable was created in Java v1. The consistent naming conventions for collections were established later, in Java2, when the other classes were published as part of the brand new Java Collection Framework.\n> \n> Which btw made Hashtable obsolete, so it should not be used in new code.\n> \n> Hope that helps.\n\næ„æ€å°±æ˜¯ï¼š\n\n> Hashtable æ˜¯åœ¨ Java 1.0 çš„æ—¶å€™åˆ›å»ºçš„ï¼Œè€Œé›†åˆçš„ç»Ÿä¸€è§„èŒƒå‘½åæ˜¯åœ¨åæ¥çš„ Java 2 å¼€å§‹çº¦å®šçš„ï¼Œå½“æ—¶å…¶ä»–ä¸€éƒ¨åˆ†é›†åˆç±»çš„å‘å¸ƒæ„æˆäº†æ–°çš„é›†åˆæ¡†æ¶ã€‚\n> \n> é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œè¿™æ ·å°±ä½¿å¾— Hashtable è¿‡æ—¶äº†ï¼Œæ‰€ä»¥ä¸åº”è¯¥åœ¨æ–°ä»£ç ä¸­ç»§ç»­ä½¿ç”¨å®ƒã€‚\n\næ ˆé•¿çœ‹äº†ä¸‹ï¼ŒHashtable ç¡®å®æ˜¯ JDK1.0 æ·»åŠ çš„ï¼Œæœ€æ—©çš„ä¸€ä¸ªé›†åˆç±»ï¼Œè¿™æ ·ä¹Ÿè¯´å¾—è¿‡å»ã€‚é‚£ä¸ºä»€ä¹ˆä¸åœ¨åé¢çš„ JDK ç‰ˆæœ¬ä¸­ä¿®å¤å®ƒå‘¢ï¼Ÿå¯èƒ½æ˜¯ä¸ºäº†è€ƒè™‘å…¼å®¹ä½¿ç”¨ JDK è€ç‰ˆæœ¬çš„ç³»ç»Ÿå§ã€‚æ‰€ä»¥å°±å°†é”™å°±é”™å°å­˜åœ¨äº† JDKï¼Œç›´åˆ°ç°åœ¨ JDK 11 äº†ä¹Ÿè¿˜æ²¡æœ‰ä¿®å¤æˆ–è€…è€ƒè™‘åˆ é™¤å®ƒã€‚\n\nå¦å¤–ï¼Œå…³äºã€Š[HashMap å’Œ Hashtable çš„ 6 ä¸ªåŒºåˆ«](https://mp.weixin.qq.com/s/EGqKMndXiJDIMeRQwxBd_w)ã€‹ï¼Œæœ‰äººç•™è¨€è¯´å¯ä»¥ä½¿ç”¨ currenthashtableã€‚\n\n![](http://qianniu.javastack.cn/18-12-6/79250944.jpg)\n\næ ˆé•¿åˆå»è¯å®äº†ä¸‹ï¼Œæ²¡æœ‰ currenthashtable å’Œ concurrenthashtable è¿™ä¸ªç±»ï¼Œæ‰€æœ‰ concurrent* å¼€å¤´çš„å¹¶å‘ç±»å’Œæ¥å£éƒ½åœ¨è¿™é‡Œäº†ã€‚\n\n![](http://qianniu.javastack.cn/18-12-6/49796932.jpg)\n\nå¥½äº†ï¼Œå…³äº Hashtable çš„è¿·æƒ‘å°±æ­¤å…¨éƒ½è§£å¼€äº†ã€‚\n\næœ‰æ”¶è·ï¼Ÿè½¬å‘ç»™æ›´å¤šçš„äººå§ï¼\n\n","source":"_posts/é›†åˆ/Hashtable ä¸ºä»€ä¹ˆä¸å« HashTableï¼Ÿ.md","raw":"---\ntitle: Hashtable ä¸ºä»€ä¹ˆä¸å« HashTableï¼Ÿ\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: é›†åˆ\n---\n\n> ä»€ä¹ˆæ˜¯é©¼å³°å‘½åè§„åˆ™ï¼Œæ¥çœ‹ä¸‹é¢çš„å…³é”®å­—ï¼š\n> \n> - HashMap\n> - ArrayList\n> - ConcurrentHashMap\n> \n> ç®€å•æ¥è¯´å°±æ˜¯ï¼Œæ ‡è¯†ç¬¦çš„æ¯ä¸ªå•è¯é¦–å­—æ¯å¿…é¡»å¤§å†™ï¼Œçœ‹èµ·æ¥åƒæ˜¯é©¼å³°çš„å½¢çŠ¶ã€‚\n\nå½“æ—¶å°±å¾ˆå¥½å¥‡ï¼ŒHashtable ä¸ºä»€ä¹ˆä¸æ˜¯ HashTable å‘¢ï¼Ÿä½œä¸ºä¸€ååˆçº§çš„ Java ç¨‹åºå‘˜éƒ½åº”è¯¥çŸ¥é“çš„åŸºæœ¬çš„é©¼å³°å‘½åè§„åˆ™ï¼Œä¸ºä»€ä¹ˆ JDK ä»£ç é‡Œé¢è¿˜æœ‰è¿™ç§ä¸è§„èŒƒçš„å‘½åå‘¢ï¼Ÿ\n\næˆ‘æƒ³å¤§å®¶åº”è¯¥éƒ½æ¯”è¾ƒå¥½å¥‡ï¼Œæˆ‘ç‰¹æ„å»æŸ¥äº†ä¸‹èµ„æ–™ï¼Œæ²¡æœ‰æŸ¥åˆ°å®˜æ–¹çš„è¯´æ³•ï¼Œä¸è¿‡åœ¨ stackoverflow ä¸Šçœ‹åˆ°äº†åŒæ ·çš„è¿™ä¸ªé—®é¢˜ã€‚\n\nåŸè´´å¦‚ä¸‹ï¼š\n\n> https://stackoverflow.com/questions/12506706/why-is-the-t-in-hash-tablehashtable-in-java-not-capitalized\n\n![](http://qianniu.javastack.cn/18-12-6/56236009.jpg)\n\næœ€ä½³ç­”æ¡ˆæ˜¯ï¼š\n\n> Hashtable was created in Java v1. The consistent naming conventions for collections were established later, in Java2, when the other classes were published as part of the brand new Java Collection Framework.\n> \n> Which btw made Hashtable obsolete, so it should not be used in new code.\n> \n> Hope that helps.\n\næ„æ€å°±æ˜¯ï¼š\n\n> Hashtable æ˜¯åœ¨ Java 1.0 çš„æ—¶å€™åˆ›å»ºçš„ï¼Œè€Œé›†åˆçš„ç»Ÿä¸€è§„èŒƒå‘½åæ˜¯åœ¨åæ¥çš„ Java 2 å¼€å§‹çº¦å®šçš„ï¼Œå½“æ—¶å…¶ä»–ä¸€éƒ¨åˆ†é›†åˆç±»çš„å‘å¸ƒæ„æˆäº†æ–°çš„é›†åˆæ¡†æ¶ã€‚\n> \n> é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œè¿™æ ·å°±ä½¿å¾— Hashtable è¿‡æ—¶äº†ï¼Œæ‰€ä»¥ä¸åº”è¯¥åœ¨æ–°ä»£ç ä¸­ç»§ç»­ä½¿ç”¨å®ƒã€‚\n\næ ˆé•¿çœ‹äº†ä¸‹ï¼ŒHashtable ç¡®å®æ˜¯ JDK1.0 æ·»åŠ çš„ï¼Œæœ€æ—©çš„ä¸€ä¸ªé›†åˆç±»ï¼Œè¿™æ ·ä¹Ÿè¯´å¾—è¿‡å»ã€‚é‚£ä¸ºä»€ä¹ˆä¸åœ¨åé¢çš„ JDK ç‰ˆæœ¬ä¸­ä¿®å¤å®ƒå‘¢ï¼Ÿå¯èƒ½æ˜¯ä¸ºäº†è€ƒè™‘å…¼å®¹ä½¿ç”¨ JDK è€ç‰ˆæœ¬çš„ç³»ç»Ÿå§ã€‚æ‰€ä»¥å°±å°†é”™å°±é”™å°å­˜åœ¨äº† JDKï¼Œç›´åˆ°ç°åœ¨ JDK 11 äº†ä¹Ÿè¿˜æ²¡æœ‰ä¿®å¤æˆ–è€…è€ƒè™‘åˆ é™¤å®ƒã€‚\n\nå¦å¤–ï¼Œå…³äºã€Š[HashMap å’Œ Hashtable çš„ 6 ä¸ªåŒºåˆ«](https://mp.weixin.qq.com/s/EGqKMndXiJDIMeRQwxBd_w)ã€‹ï¼Œæœ‰äººç•™è¨€è¯´å¯ä»¥ä½¿ç”¨ currenthashtableã€‚\n\n![](http://qianniu.javastack.cn/18-12-6/79250944.jpg)\n\næ ˆé•¿åˆå»è¯å®äº†ä¸‹ï¼Œæ²¡æœ‰ currenthashtable å’Œ concurrenthashtable è¿™ä¸ªç±»ï¼Œæ‰€æœ‰ concurrent* å¼€å¤´çš„å¹¶å‘ç±»å’Œæ¥å£éƒ½åœ¨è¿™é‡Œäº†ã€‚\n\n![](http://qianniu.javastack.cn/18-12-6/49796932.jpg)\n\nå¥½äº†ï¼Œå…³äº Hashtable çš„è¿·æƒ‘å°±æ­¤å…¨éƒ½è§£å¼€äº†ã€‚\n\næœ‰æ”¶è·ï¼Ÿè½¬å‘ç»™æ›´å¤šçš„äººå§ï¼\n\n","slug":"é›†åˆ/Hashtable ä¸ºä»€ä¹ˆä¸å« HashTableï¼Ÿ","published":1,"updated":"2025-10-15T07:21:29.809Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu0770004uqkd4eb9b9k23","content":"<blockquote>\n<p>ä»€ä¹ˆæ˜¯é©¼å³°å‘½åè§„åˆ™ï¼Œæ¥çœ‹ä¸‹é¢çš„å…³é”®å­—ï¼š</p>\n<ul>\n<li>HashMap</li>\n<li>ArrayList</li>\n<li>ConcurrentHashMap</li>\n</ul>\n<p>ç®€å•æ¥è¯´å°±æ˜¯ï¼Œæ ‡è¯†ç¬¦çš„æ¯ä¸ªå•è¯é¦–å­—æ¯å¿…é¡»å¤§å†™ï¼Œçœ‹èµ·æ¥åƒæ˜¯é©¼å³°çš„å½¢çŠ¶ã€‚</p>\n</blockquote>\n<p>å½“æ—¶å°±å¾ˆå¥½å¥‡ï¼ŒHashtable ä¸ºä»€ä¹ˆä¸æ˜¯ HashTable å‘¢ï¼Ÿä½œä¸ºä¸€ååˆçº§çš„ Java ç¨‹åºå‘˜éƒ½åº”è¯¥çŸ¥é“çš„åŸºæœ¬çš„é©¼å³°å‘½åè§„åˆ™ï¼Œä¸ºä»€ä¹ˆ JDK ä»£ç é‡Œé¢è¿˜æœ‰è¿™ç§ä¸è§„èŒƒçš„å‘½åå‘¢ï¼Ÿ</p>\n<p>æˆ‘æƒ³å¤§å®¶åº”è¯¥éƒ½æ¯”è¾ƒå¥½å¥‡ï¼Œæˆ‘ç‰¹æ„å»æŸ¥äº†ä¸‹èµ„æ–™ï¼Œæ²¡æœ‰æŸ¥åˆ°å®˜æ–¹çš„è¯´æ³•ï¼Œä¸è¿‡åœ¨ stackoverflow ä¸Šçœ‹åˆ°äº†åŒæ ·çš„è¿™ä¸ªé—®é¢˜ã€‚</p>\n<p>åŸè´´å¦‚ä¸‹ï¼š</p>\n<blockquote>\n<p><a href=\"https://stackoverflow.com/questions/12506706/why-is-the-t-in-hash-tablehashtable-in-java-not-capitalized\">https://stackoverflow.com/questions/12506706/why-is-the-t-in-hash-tablehashtable-in-java-not-capitalized</a></p>\n</blockquote>\n<p><img src=\"http://qianniu.javastack.cn/18-12-6/56236009.jpg\"></p>\n<p>æœ€ä½³ç­”æ¡ˆæ˜¯ï¼š</p>\n<blockquote>\n<p>Hashtable was created in Java v1. The consistent naming conventions for collections were established later, in Java2, when the other classes were published as part of the brand new Java Collection Framework.</p>\n<p>Which btw made Hashtable obsolete, so it should not be used in new code.</p>\n<p>Hope that helps.</p>\n</blockquote>\n<p>æ„æ€å°±æ˜¯ï¼š</p>\n<blockquote>\n<p>Hashtable æ˜¯åœ¨ Java 1.0 çš„æ—¶å€™åˆ›å»ºçš„ï¼Œè€Œé›†åˆçš„ç»Ÿä¸€è§„èŒƒå‘½åæ˜¯åœ¨åæ¥çš„ Java 2 å¼€å§‹çº¦å®šçš„ï¼Œå½“æ—¶å…¶ä»–ä¸€éƒ¨åˆ†é›†åˆç±»çš„å‘å¸ƒæ„æˆäº†æ–°çš„é›†åˆæ¡†æ¶ã€‚</p>\n<p>é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œè¿™æ ·å°±ä½¿å¾— Hashtable è¿‡æ—¶äº†ï¼Œæ‰€ä»¥ä¸åº”è¯¥åœ¨æ–°ä»£ç ä¸­ç»§ç»­ä½¿ç”¨å®ƒã€‚</p>\n</blockquote>\n<p>æ ˆé•¿çœ‹äº†ä¸‹ï¼ŒHashtable ç¡®å®æ˜¯ JDK1.0 æ·»åŠ çš„ï¼Œæœ€æ—©çš„ä¸€ä¸ªé›†åˆç±»ï¼Œè¿™æ ·ä¹Ÿè¯´å¾—è¿‡å»ã€‚é‚£ä¸ºä»€ä¹ˆä¸åœ¨åé¢çš„ JDK ç‰ˆæœ¬ä¸­ä¿®å¤å®ƒå‘¢ï¼Ÿå¯èƒ½æ˜¯ä¸ºäº†è€ƒè™‘å…¼å®¹ä½¿ç”¨ JDK è€ç‰ˆæœ¬çš„ç³»ç»Ÿå§ã€‚æ‰€ä»¥å°±å°†é”™å°±é”™å°å­˜åœ¨äº† JDKï¼Œç›´åˆ°ç°åœ¨ JDK 11 äº†ä¹Ÿè¿˜æ²¡æœ‰ä¿®å¤æˆ–è€…è€ƒè™‘åˆ é™¤å®ƒã€‚</p>\n<p>å¦å¤–ï¼Œå…³äºã€Š<a href=\"https://mp.weixin.qq.com/s/EGqKMndXiJDIMeRQwxBd_w\">HashMap å’Œ Hashtable çš„ 6 ä¸ªåŒºåˆ«</a>ã€‹ï¼Œæœ‰äººç•™è¨€è¯´å¯ä»¥ä½¿ç”¨ currenthashtableã€‚</p>\n<p><img src=\"http://qianniu.javastack.cn/18-12-6/79250944.jpg\"></p>\n<p>æ ˆé•¿åˆå»è¯å®äº†ä¸‹ï¼Œæ²¡æœ‰ currenthashtable å’Œ concurrenthashtable è¿™ä¸ªç±»ï¼Œæ‰€æœ‰ concurrent* å¼€å¤´çš„å¹¶å‘ç±»å’Œæ¥å£éƒ½åœ¨è¿™é‡Œäº†ã€‚</p>\n<p><img src=\"http://qianniu.javastack.cn/18-12-6/49796932.jpg\"></p>\n<p>å¥½äº†ï¼Œå…³äº Hashtable çš„è¿·æƒ‘å°±æ­¤å…¨éƒ½è§£å¼€äº†ã€‚</p>\n<p>æœ‰æ”¶è·ï¼Ÿè½¬å‘ç»™æ›´å¤šçš„äººå§ï¼</p>\n","excerpt":"","more":"<blockquote>\n<p>ä»€ä¹ˆæ˜¯é©¼å³°å‘½åè§„åˆ™ï¼Œæ¥çœ‹ä¸‹é¢çš„å…³é”®å­—ï¼š</p>\n<ul>\n<li>HashMap</li>\n<li>ArrayList</li>\n<li>ConcurrentHashMap</li>\n</ul>\n<p>ç®€å•æ¥è¯´å°±æ˜¯ï¼Œæ ‡è¯†ç¬¦çš„æ¯ä¸ªå•è¯é¦–å­—æ¯å¿…é¡»å¤§å†™ï¼Œçœ‹èµ·æ¥åƒæ˜¯é©¼å³°çš„å½¢çŠ¶ã€‚</p>\n</blockquote>\n<p>å½“æ—¶å°±å¾ˆå¥½å¥‡ï¼ŒHashtable ä¸ºä»€ä¹ˆä¸æ˜¯ HashTable å‘¢ï¼Ÿä½œä¸ºä¸€ååˆçº§çš„ Java ç¨‹åºå‘˜éƒ½åº”è¯¥çŸ¥é“çš„åŸºæœ¬çš„é©¼å³°å‘½åè§„åˆ™ï¼Œä¸ºä»€ä¹ˆ JDK ä»£ç é‡Œé¢è¿˜æœ‰è¿™ç§ä¸è§„èŒƒçš„å‘½åå‘¢ï¼Ÿ</p>\n<p>æˆ‘æƒ³å¤§å®¶åº”è¯¥éƒ½æ¯”è¾ƒå¥½å¥‡ï¼Œæˆ‘ç‰¹æ„å»æŸ¥äº†ä¸‹èµ„æ–™ï¼Œæ²¡æœ‰æŸ¥åˆ°å®˜æ–¹çš„è¯´æ³•ï¼Œä¸è¿‡åœ¨ stackoverflow ä¸Šçœ‹åˆ°äº†åŒæ ·çš„è¿™ä¸ªé—®é¢˜ã€‚</p>\n<p>åŸè´´å¦‚ä¸‹ï¼š</p>\n<blockquote>\n<p><a href=\"https://stackoverflow.com/questions/12506706/why-is-the-t-in-hash-tablehashtable-in-java-not-capitalized\">https://stackoverflow.com/questions/12506706/why-is-the-t-in-hash-tablehashtable-in-java-not-capitalized</a></p>\n</blockquote>\n<p><img src=\"http://qianniu.javastack.cn/18-12-6/56236009.jpg\"></p>\n<p>æœ€ä½³ç­”æ¡ˆæ˜¯ï¼š</p>\n<blockquote>\n<p>Hashtable was created in Java v1. The consistent naming conventions for collections were established later, in Java2, when the other classes were published as part of the brand new Java Collection Framework.</p>\n<p>Which btw made Hashtable obsolete, so it should not be used in new code.</p>\n<p>Hope that helps.</p>\n</blockquote>\n<p>æ„æ€å°±æ˜¯ï¼š</p>\n<blockquote>\n<p>Hashtable æ˜¯åœ¨ Java 1.0 çš„æ—¶å€™åˆ›å»ºçš„ï¼Œè€Œé›†åˆçš„ç»Ÿä¸€è§„èŒƒå‘½åæ˜¯åœ¨åæ¥çš„ Java 2 å¼€å§‹çº¦å®šçš„ï¼Œå½“æ—¶å…¶ä»–ä¸€éƒ¨åˆ†é›†åˆç±»çš„å‘å¸ƒæ„æˆäº†æ–°çš„é›†åˆæ¡†æ¶ã€‚</p>\n<p>é¡ºä¾¿è¯´ä¸€ä¸‹ï¼Œè¿™æ ·å°±ä½¿å¾— Hashtable è¿‡æ—¶äº†ï¼Œæ‰€ä»¥ä¸åº”è¯¥åœ¨æ–°ä»£ç ä¸­ç»§ç»­ä½¿ç”¨å®ƒã€‚</p>\n</blockquote>\n<p>æ ˆé•¿çœ‹äº†ä¸‹ï¼ŒHashtable ç¡®å®æ˜¯ JDK1.0 æ·»åŠ çš„ï¼Œæœ€æ—©çš„ä¸€ä¸ªé›†åˆç±»ï¼Œè¿™æ ·ä¹Ÿè¯´å¾—è¿‡å»ã€‚é‚£ä¸ºä»€ä¹ˆä¸åœ¨åé¢çš„ JDK ç‰ˆæœ¬ä¸­ä¿®å¤å®ƒå‘¢ï¼Ÿå¯èƒ½æ˜¯ä¸ºäº†è€ƒè™‘å…¼å®¹ä½¿ç”¨ JDK è€ç‰ˆæœ¬çš„ç³»ç»Ÿå§ã€‚æ‰€ä»¥å°±å°†é”™å°±é”™å°å­˜åœ¨äº† JDKï¼Œç›´åˆ°ç°åœ¨ JDK 11 äº†ä¹Ÿè¿˜æ²¡æœ‰ä¿®å¤æˆ–è€…è€ƒè™‘åˆ é™¤å®ƒã€‚</p>\n<p>å¦å¤–ï¼Œå…³äºã€Š<a href=\"https://mp.weixin.qq.com/s/EGqKMndXiJDIMeRQwxBd_w\">HashMap å’Œ Hashtable çš„ 6 ä¸ªåŒºåˆ«</a>ã€‹ï¼Œæœ‰äººç•™è¨€è¯´å¯ä»¥ä½¿ç”¨ currenthashtableã€‚</p>\n<p><img src=\"http://qianniu.javastack.cn/18-12-6/79250944.jpg\"></p>\n<p>æ ˆé•¿åˆå»è¯å®äº†ä¸‹ï¼Œæ²¡æœ‰ currenthashtable å’Œ concurrenthashtable è¿™ä¸ªç±»ï¼Œæ‰€æœ‰ concurrent* å¼€å¤´çš„å¹¶å‘ç±»å’Œæ¥å£éƒ½åœ¨è¿™é‡Œäº†ã€‚</p>\n<p><img src=\"http://qianniu.javastack.cn/18-12-6/49796932.jpg\"></p>\n<p>å¥½äº†ï¼Œå…³äº Hashtable çš„è¿·æƒ‘å°±æ­¤å…¨éƒ½è§£å¼€äº†ã€‚</p>\n<p>æœ‰æ”¶è·ï¼Ÿè½¬å‘ç»™æ›´å¤šçš„äººå§ï¼</p>\n"},{"title":"Java ä¸­åˆå§‹åŒ– List é›†åˆçš„ 6 ç§æ–¹å¼!","date":"2025-10-15T03:36:33.000Z","_content":"\nList æ˜¯ Java å¼€å‘ä¸­ç»å¸¸ä¼šä½¿ç”¨çš„é›†åˆï¼Œä½ ä»¬çŸ¥é“æœ‰å“ªäº›æ–¹å¼å¯ä»¥åˆå§‹åŒ–ä¸€ä¸ª List å—ï¼Ÿè¿™å…¶ä¸­ä¸ç¼ºä¹ä¸€äº›å‘ï¼Œä»Šå¤©æ ˆé•¿æˆ‘ç»™å¤§å®¶ä¸€ä¸€æ™®åŠä¸€ä¸‹ã€‚\n\n## 1ã€å¸¸è§„æ–¹å¼\n\n```\nList<String> languages = new ArrayList<>();\nlanguages.add(\"Java\");\nlanguages.add(\"PHP\");\nlanguages.add(\"Python\");\nSystem.out.println(languages);\n```\n\nè¿™ç§å°±æ˜¯æˆ‘ä»¬å¹³å¸¸ç”¨çš„æœ€å¤šæœ€å¹³å¸¸çš„æ–¹å¼äº†ï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œåé¢ç¼ºå¤±çš„æ³›å‹ç±»å‹åœ¨ JDK 7 ä¹‹åå°±å¯ä»¥ä¸ç”¨å†™å…·ä½“çš„ç±»å‹äº†ï¼Œæ”¹è¿›åä¼šè‡ªåŠ¨æ¨æ–­ç±»å‹ã€‚\n\n## 2ã€Arrays å·¥å…·ç±»\n\n```\nList<String> jdks = asList(\"JDK6\", \"JDK8\", \"JDK10\");\nSystem.out.println(jdks);\n```\n\næ³¨æ„ï¼Œä¸Šé¢çš„ asList æ˜¯ Arrays çš„é™æ€æ–¹æ³•ï¼Œè¿™é‡Œä½¿ç”¨äº†é™æ€å¯¼å…¥ã€‚è¿™ç§æ–¹å¼æ·»åŠ çš„æ˜¯ä¸å¯å˜çš„ List, å³ä¸èƒ½æ·»åŠ ã€åˆ é™¤ç­‰æ“ä½œï¼Œéœ€è¦è­¦æƒ•ã€‚ã€‚\n\n> import static java.util.Arrays.asList;\n\nå¦‚æœè¦å¯å˜ï¼Œé‚£å°±ä½¿ç”¨ ArrayList å†åŒ…è£…ä¸€ä¸‹ï¼Œå¦‚ä¸‹é¢æ‰€ç¤ºã€‚\n\n```\nList<String> numbers = new ArrayList<>(Arrays.asList(\"1\", \"2\", \"3\"));\nnumbers.add(\"4\");\nSystem.out.println(numbers);\n```\n\nåŒ…è£…ä¸€ä¸‹ï¼Œè¿™å°±æ˜¯å¯å˜çš„ ArrayList äº†ã€‚\n\n## 3ã€Collections å·¥å…·ç±»\n\n```\nList<String> apples = Collections.nCopies(3, \"apple\");\nSystem.out.println(apples);\n```\n\nè¿™ç§æ–¹å¼æ·»åŠ çš„æ˜¯ä¸å¯å˜çš„ã€å¤åˆ¶æŸä¸ªå…ƒç´ Néçš„å·¥å…·ç±»ï¼Œä»¥ä¸Šç¨‹åºè¾“å‡ºï¼š\n\n```\n[apple, apple, apple]\n```\n\nè€è§„åˆ™ï¼Œå¦‚æœè¦å¯å˜ï¼Œä½¿ç”¨ ArrayList åŒ…è£…ä¸€éã€‚\n\n```\nList<String> dogs = new ArrayList<>(Collections.nCopies(3, \"dog\"));\ndogs.add(\"dog\");\nSystem.out.println(dogs);\n```\n\nè¿˜æœ‰åˆå§‹åŒ–å•ä¸ªå¯¹è±¡çš„ List å·¥å…·ç±»ï¼Œè¿™ç§æ–¹å¼ä¹Ÿæ˜¯ä¸å¯å˜çš„ï¼Œé›†åˆå†…åªèƒ½æœ‰ä¸€ä¸ªå…ƒç´ ï¼Œè¿™ç§ä¹Ÿç”¨å¾—å¾ˆå°‘å•Šã€‚\n\n```\nList<String> cat = Collections.singletonList(\"cat\");\nSystem.out.println(cat);\n```\n\nè¿˜æœ‰ä¸€ä¸ªåˆ›å»ºç©º List çš„å·¥å…·ç±»ï¼Œæ²¡æœ‰é»˜è®¤å®¹é‡ï¼ŒèŠ‚çœç©ºé—´ï¼Œä½†ä¸çŸ¥é“å®é™…å·¥ä½œä¸­æœ‰ä»€ä¹ˆé¸Ÿç”¨ã€‚\n\n```\nList<String> cat = Collections.emptyList(\"cat\");\n```\n\n## 4ã€åŒ¿åå†…éƒ¨ç±»\n\n```\nList<String> names = new ArrayList<>() {{\n    add(\"Tom\");\n    add(\"Sally\");\n    add(\"John\");\n}};\nSystem.out.println(names);\n```\n\nè¿™ç§ä½¿ç”¨äº†åŒ¿åå†…éƒ¨ç±»çš„æ–¹å¼ï¼Œä¸€æ°”å–æˆï¼Œæ˜¯ä¸æ˜¯å¾ˆé«˜å¤§ä¸Šï¼Ÿæ ˆé•¿æˆ‘æ›¾ç»ä¹Ÿä½¿ç”¨è¿‡è¿™ç§æ–¹å¼ï¼Œä¸è¿‡æˆ‘è§‰å¾—è¿™ç§çœ‹ä¼¼é«˜çº§ï¼Œå®ç°ä¹Ÿæ²¡ä»€ä¹ˆåµç”¨ã€‚\n\n## 5ã€JDK8 Stream\n\n```\nList<String> colors = Stream.of(\"blue\", \"red\", \"yellow\").collect(toList());\nSystem.out.println(colors);\n```\n\nStream æ˜¯ JDK 8 æ¨å‡ºæ¥çš„æ–°æ¦‚å¿µï¼Œæ¯”é›†åˆè¿˜è¦æ›´å¼ºå¤§ï¼Œè¿˜å¯ä»¥å’Œé›†åˆäº’ç›¸è½¬æ¢ã€‚\n\nä¸Šé¢åŒæ ·ä½¿ç”¨äº†é™æ€å¯¼å…¥ï¼š\n\n> import static java.util.stream.Collectors.toList;\n\n\n\n## 6ã€JDK 9 List.of\n\n```\nList<String> cups = List.of(\"A\", \"B\", \"C\");\nSystem.out.println(cups);\n```\n\nè¿™æ˜¯ JDK 9 é‡Œé¢æ–°å¢çš„ List æ¥å£é‡Œé¢çš„é™æ€æ–¹æ³•ï¼ŒåŒæ ·ä¹Ÿæ˜¯ä¸å¯å˜çš„ã€‚\n\nåœ¨æ¥å£ä¸­å®ç°é™æ€æ–¹æ³•å’Œé»˜è®¤æ–¹æ³•æ˜¯ JDK 8 ä¸­æ·»åŠ çš„æ–°ç‰¹æ€§ï¼Œå…·ä½“çœ‹è¿™ç¯‡æ–‡ç« ã€Š[JDK 8 æ–°ç‰¹æ€§ä¹‹æ¥å£é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•\n](https://mp.weixin.qq.com/s/_V6oyDle4PrpzL65x_8K5w)ã€‹ã€‚\n\nå¥½äº†ï¼Œä»Šå¤©æ ˆé•¿å°±ç»™å¤§å®¶ä»‹ç»åˆ°è¿™é‡Œäº†ï¼Œè¿™ 6 ç§ï¼Œä½ çŸ¥é“å‡ ç§ï¼Ÿå¦å¤–ï¼ŒMap, Set ä¹Ÿæœ‰ç±»ä¼¼çš„åˆå§‹åŒ–çš„æ–¹æ³•ï¼Œå¤§å®¶æœ‰å…´è¶£çš„å¯ä»¥è¯•ä¸€ä¸‹ã€‚\n\nä½ è¿˜çŸ¥é“å“ªäº›ç»æ‹›å‘¢ï¼Ÿæ¬¢è¿ç•™è¨€åˆ†äº«ä¸€ä¸‹ã€‚ã€‚ã€‚\n\n","source":"_posts/é›†åˆ/Java ä¸­åˆå§‹åŒ– List é›†åˆçš„ 6 ç§æ–¹å¼!.md","raw":"---\ntitle: Java ä¸­åˆå§‹åŒ– List é›†åˆçš„ 6 ç§æ–¹å¼!\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: é›†åˆ\n---\n\nList æ˜¯ Java å¼€å‘ä¸­ç»å¸¸ä¼šä½¿ç”¨çš„é›†åˆï¼Œä½ ä»¬çŸ¥é“æœ‰å“ªäº›æ–¹å¼å¯ä»¥åˆå§‹åŒ–ä¸€ä¸ª List å—ï¼Ÿè¿™å…¶ä¸­ä¸ç¼ºä¹ä¸€äº›å‘ï¼Œä»Šå¤©æ ˆé•¿æˆ‘ç»™å¤§å®¶ä¸€ä¸€æ™®åŠä¸€ä¸‹ã€‚\n\n## 1ã€å¸¸è§„æ–¹å¼\n\n```\nList<String> languages = new ArrayList<>();\nlanguages.add(\"Java\");\nlanguages.add(\"PHP\");\nlanguages.add(\"Python\");\nSystem.out.println(languages);\n```\n\nè¿™ç§å°±æ˜¯æˆ‘ä»¬å¹³å¸¸ç”¨çš„æœ€å¤šæœ€å¹³å¸¸çš„æ–¹å¼äº†ï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œåé¢ç¼ºå¤±çš„æ³›å‹ç±»å‹åœ¨ JDK 7 ä¹‹åå°±å¯ä»¥ä¸ç”¨å†™å…·ä½“çš„ç±»å‹äº†ï¼Œæ”¹è¿›åä¼šè‡ªåŠ¨æ¨æ–­ç±»å‹ã€‚\n\n## 2ã€Arrays å·¥å…·ç±»\n\n```\nList<String> jdks = asList(\"JDK6\", \"JDK8\", \"JDK10\");\nSystem.out.println(jdks);\n```\n\næ³¨æ„ï¼Œä¸Šé¢çš„ asList æ˜¯ Arrays çš„é™æ€æ–¹æ³•ï¼Œè¿™é‡Œä½¿ç”¨äº†é™æ€å¯¼å…¥ã€‚è¿™ç§æ–¹å¼æ·»åŠ çš„æ˜¯ä¸å¯å˜çš„ List, å³ä¸èƒ½æ·»åŠ ã€åˆ é™¤ç­‰æ“ä½œï¼Œéœ€è¦è­¦æƒ•ã€‚ã€‚\n\n> import static java.util.Arrays.asList;\n\nå¦‚æœè¦å¯å˜ï¼Œé‚£å°±ä½¿ç”¨ ArrayList å†åŒ…è£…ä¸€ä¸‹ï¼Œå¦‚ä¸‹é¢æ‰€ç¤ºã€‚\n\n```\nList<String> numbers = new ArrayList<>(Arrays.asList(\"1\", \"2\", \"3\"));\nnumbers.add(\"4\");\nSystem.out.println(numbers);\n```\n\nåŒ…è£…ä¸€ä¸‹ï¼Œè¿™å°±æ˜¯å¯å˜çš„ ArrayList äº†ã€‚\n\n## 3ã€Collections å·¥å…·ç±»\n\n```\nList<String> apples = Collections.nCopies(3, \"apple\");\nSystem.out.println(apples);\n```\n\nè¿™ç§æ–¹å¼æ·»åŠ çš„æ˜¯ä¸å¯å˜çš„ã€å¤åˆ¶æŸä¸ªå…ƒç´ Néçš„å·¥å…·ç±»ï¼Œä»¥ä¸Šç¨‹åºè¾“å‡ºï¼š\n\n```\n[apple, apple, apple]\n```\n\nè€è§„åˆ™ï¼Œå¦‚æœè¦å¯å˜ï¼Œä½¿ç”¨ ArrayList åŒ…è£…ä¸€éã€‚\n\n```\nList<String> dogs = new ArrayList<>(Collections.nCopies(3, \"dog\"));\ndogs.add(\"dog\");\nSystem.out.println(dogs);\n```\n\nè¿˜æœ‰åˆå§‹åŒ–å•ä¸ªå¯¹è±¡çš„ List å·¥å…·ç±»ï¼Œè¿™ç§æ–¹å¼ä¹Ÿæ˜¯ä¸å¯å˜çš„ï¼Œé›†åˆå†…åªèƒ½æœ‰ä¸€ä¸ªå…ƒç´ ï¼Œè¿™ç§ä¹Ÿç”¨å¾—å¾ˆå°‘å•Šã€‚\n\n```\nList<String> cat = Collections.singletonList(\"cat\");\nSystem.out.println(cat);\n```\n\nè¿˜æœ‰ä¸€ä¸ªåˆ›å»ºç©º List çš„å·¥å…·ç±»ï¼Œæ²¡æœ‰é»˜è®¤å®¹é‡ï¼ŒèŠ‚çœç©ºé—´ï¼Œä½†ä¸çŸ¥é“å®é™…å·¥ä½œä¸­æœ‰ä»€ä¹ˆé¸Ÿç”¨ã€‚\n\n```\nList<String> cat = Collections.emptyList(\"cat\");\n```\n\n## 4ã€åŒ¿åå†…éƒ¨ç±»\n\n```\nList<String> names = new ArrayList<>() {{\n    add(\"Tom\");\n    add(\"Sally\");\n    add(\"John\");\n}};\nSystem.out.println(names);\n```\n\nè¿™ç§ä½¿ç”¨äº†åŒ¿åå†…éƒ¨ç±»çš„æ–¹å¼ï¼Œä¸€æ°”å–æˆï¼Œæ˜¯ä¸æ˜¯å¾ˆé«˜å¤§ä¸Šï¼Ÿæ ˆé•¿æˆ‘æ›¾ç»ä¹Ÿä½¿ç”¨è¿‡è¿™ç§æ–¹å¼ï¼Œä¸è¿‡æˆ‘è§‰å¾—è¿™ç§çœ‹ä¼¼é«˜çº§ï¼Œå®ç°ä¹Ÿæ²¡ä»€ä¹ˆåµç”¨ã€‚\n\n## 5ã€JDK8 Stream\n\n```\nList<String> colors = Stream.of(\"blue\", \"red\", \"yellow\").collect(toList());\nSystem.out.println(colors);\n```\n\nStream æ˜¯ JDK 8 æ¨å‡ºæ¥çš„æ–°æ¦‚å¿µï¼Œæ¯”é›†åˆè¿˜è¦æ›´å¼ºå¤§ï¼Œè¿˜å¯ä»¥å’Œé›†åˆäº’ç›¸è½¬æ¢ã€‚\n\nä¸Šé¢åŒæ ·ä½¿ç”¨äº†é™æ€å¯¼å…¥ï¼š\n\n> import static java.util.stream.Collectors.toList;\n\n\n\n## 6ã€JDK 9 List.of\n\n```\nList<String> cups = List.of(\"A\", \"B\", \"C\");\nSystem.out.println(cups);\n```\n\nè¿™æ˜¯ JDK 9 é‡Œé¢æ–°å¢çš„ List æ¥å£é‡Œé¢çš„é™æ€æ–¹æ³•ï¼ŒåŒæ ·ä¹Ÿæ˜¯ä¸å¯å˜çš„ã€‚\n\nåœ¨æ¥å£ä¸­å®ç°é™æ€æ–¹æ³•å’Œé»˜è®¤æ–¹æ³•æ˜¯ JDK 8 ä¸­æ·»åŠ çš„æ–°ç‰¹æ€§ï¼Œå…·ä½“çœ‹è¿™ç¯‡æ–‡ç« ã€Š[JDK 8 æ–°ç‰¹æ€§ä¹‹æ¥å£é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•\n](https://mp.weixin.qq.com/s/_V6oyDle4PrpzL65x_8K5w)ã€‹ã€‚\n\nå¥½äº†ï¼Œä»Šå¤©æ ˆé•¿å°±ç»™å¤§å®¶ä»‹ç»åˆ°è¿™é‡Œäº†ï¼Œè¿™ 6 ç§ï¼Œä½ çŸ¥é“å‡ ç§ï¼Ÿå¦å¤–ï¼ŒMap, Set ä¹Ÿæœ‰ç±»ä¼¼çš„åˆå§‹åŒ–çš„æ–¹æ³•ï¼Œå¤§å®¶æœ‰å…´è¶£çš„å¯ä»¥è¯•ä¸€ä¸‹ã€‚\n\nä½ è¿˜çŸ¥é“å“ªäº›ç»æ‹›å‘¢ï¼Ÿæ¬¢è¿ç•™è¨€åˆ†äº«ä¸€ä¸‹ã€‚ã€‚ã€‚\n\n","slug":"é›†åˆ/Java ä¸­åˆå§‹åŒ– List é›†åˆçš„ 6 ç§æ–¹å¼!","published":1,"updated":"2025-10-15T07:21:29.764Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu0770004yqkd4gdt57lbu","content":"<p>List æ˜¯ Java å¼€å‘ä¸­ç»å¸¸ä¼šä½¿ç”¨çš„é›†åˆï¼Œä½ ä»¬çŸ¥é“æœ‰å“ªäº›æ–¹å¼å¯ä»¥åˆå§‹åŒ–ä¸€ä¸ª List å—ï¼Ÿè¿™å…¶ä¸­ä¸ç¼ºä¹ä¸€äº›å‘ï¼Œä»Šå¤©æ ˆé•¿æˆ‘ç»™å¤§å®¶ä¸€ä¸€æ™®åŠä¸€ä¸‹ã€‚</p>\n<h2 id=\"1ã€å¸¸è§„æ–¹å¼\"><a href=\"#1ã€å¸¸è§„æ–¹å¼\" class=\"headerlink\" title=\"1ã€å¸¸è§„æ–¹å¼\"></a>1ã€å¸¸è§„æ–¹å¼</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;String&gt; languages &#x3D; new ArrayList&lt;&gt;();\nlanguages.add(&quot;Java&quot;);\nlanguages.add(&quot;PHP&quot;);\nlanguages.add(&quot;Python&quot;);\nSystem.out.println(languages);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ç§å°±æ˜¯æˆ‘ä»¬å¹³å¸¸ç”¨çš„æœ€å¤šæœ€å¹³å¸¸çš„æ–¹å¼äº†ï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œåé¢ç¼ºå¤±çš„æ³›å‹ç±»å‹åœ¨ JDK 7 ä¹‹åå°±å¯ä»¥ä¸ç”¨å†™å…·ä½“çš„ç±»å‹äº†ï¼Œæ”¹è¿›åä¼šè‡ªåŠ¨æ¨æ–­ç±»å‹ã€‚</p>\n<h2 id=\"2ã€Arrays-å·¥å…·ç±»\"><a href=\"#2ã€Arrays-å·¥å…·ç±»\" class=\"headerlink\" title=\"2ã€Arrays å·¥å…·ç±»\"></a>2ã€Arrays å·¥å…·ç±»</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;String&gt; jdks &#x3D; asList(&quot;JDK6&quot;, &quot;JDK8&quot;, &quot;JDK10&quot;);\nSystem.out.println(jdks);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>æ³¨æ„ï¼Œä¸Šé¢çš„ asList æ˜¯ Arrays çš„é™æ€æ–¹æ³•ï¼Œè¿™é‡Œä½¿ç”¨äº†é™æ€å¯¼å…¥ã€‚è¿™ç§æ–¹å¼æ·»åŠ çš„æ˜¯ä¸å¯å˜çš„ List, å³ä¸èƒ½æ·»åŠ ã€åˆ é™¤ç­‰æ“ä½œï¼Œéœ€è¦è­¦æƒ•ã€‚ã€‚</p>\n<blockquote>\n<p>import static java.util.Arrays.asList;</p>\n</blockquote>\n<p>å¦‚æœè¦å¯å˜ï¼Œé‚£å°±ä½¿ç”¨ ArrayList å†åŒ…è£…ä¸€ä¸‹ï¼Œå¦‚ä¸‹é¢æ‰€ç¤ºã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;String&gt; numbers &#x3D; new ArrayList&lt;&gt;(Arrays.asList(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;));\nnumbers.add(&quot;4&quot;);\nSystem.out.println(numbers);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>åŒ…è£…ä¸€ä¸‹ï¼Œè¿™å°±æ˜¯å¯å˜çš„ ArrayList äº†ã€‚</p>\n<h2 id=\"3ã€Collections-å·¥å…·ç±»\"><a href=\"#3ã€Collections-å·¥å…·ç±»\" class=\"headerlink\" title=\"3ã€Collections å·¥å…·ç±»\"></a>3ã€Collections å·¥å…·ç±»</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;String&gt; apples &#x3D; Collections.nCopies(3, &quot;apple&quot;);\nSystem.out.println(apples);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>è¿™ç§æ–¹å¼æ·»åŠ çš„æ˜¯ä¸å¯å˜çš„ã€å¤åˆ¶æŸä¸ªå…ƒç´ Néçš„å·¥å…·ç±»ï¼Œä»¥ä¸Šç¨‹åºè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">[apple, apple, apple]<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>è€è§„åˆ™ï¼Œå¦‚æœè¦å¯å˜ï¼Œä½¿ç”¨ ArrayList åŒ…è£…ä¸€éã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;String&gt; dogs &#x3D; new ArrayList&lt;&gt;(Collections.nCopies(3, &quot;dog&quot;));\ndogs.add(&quot;dog&quot;);\nSystem.out.println(dogs);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿˜æœ‰åˆå§‹åŒ–å•ä¸ªå¯¹è±¡çš„ List å·¥å…·ç±»ï¼Œè¿™ç§æ–¹å¼ä¹Ÿæ˜¯ä¸å¯å˜çš„ï¼Œé›†åˆå†…åªèƒ½æœ‰ä¸€ä¸ªå…ƒç´ ï¼Œè¿™ç§ä¹Ÿç”¨å¾—å¾ˆå°‘å•Šã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;String&gt; cat &#x3D; Collections.singletonList(&quot;cat&quot;);\nSystem.out.println(cat);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>è¿˜æœ‰ä¸€ä¸ªåˆ›å»ºç©º List çš„å·¥å…·ç±»ï¼Œæ²¡æœ‰é»˜è®¤å®¹é‡ï¼ŒèŠ‚çœç©ºé—´ï¼Œä½†ä¸çŸ¥é“å®é™…å·¥ä½œä¸­æœ‰ä»€ä¹ˆé¸Ÿç”¨ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;String&gt; cat &#x3D; Collections.emptyList(&quot;cat&quot;);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"4ã€åŒ¿åå†…éƒ¨ç±»\"><a href=\"#4ã€åŒ¿åå†…éƒ¨ç±»\" class=\"headerlink\" title=\"4ã€åŒ¿åå†…éƒ¨ç±»\"></a>4ã€åŒ¿åå†…éƒ¨ç±»</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;String&gt; names &#x3D; new ArrayList&lt;&gt;() &#123;&#123;\n    add(&quot;Tom&quot;);\n    add(&quot;Sally&quot;);\n    add(&quot;John&quot;);\n&#125;&#125;;\nSystem.out.println(names);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ç§ä½¿ç”¨äº†åŒ¿åå†…éƒ¨ç±»çš„æ–¹å¼ï¼Œä¸€æ°”å–æˆï¼Œæ˜¯ä¸æ˜¯å¾ˆé«˜å¤§ä¸Šï¼Ÿæ ˆé•¿æˆ‘æ›¾ç»ä¹Ÿä½¿ç”¨è¿‡è¿™ç§æ–¹å¼ï¼Œä¸è¿‡æˆ‘è§‰å¾—è¿™ç§çœ‹ä¼¼é«˜çº§ï¼Œå®ç°ä¹Ÿæ²¡ä»€ä¹ˆåµç”¨ã€‚</p>\n<h2 id=\"5ã€JDK8-Stream\"><a href=\"#5ã€JDK8-Stream\" class=\"headerlink\" title=\"5ã€JDK8 Stream\"></a>5ã€JDK8 Stream</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;String&gt; colors &#x3D; Stream.of(&quot;blue&quot;, &quot;red&quot;, &quot;yellow&quot;).collect(toList());\nSystem.out.println(colors);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>Stream æ˜¯ JDK 8 æ¨å‡ºæ¥çš„æ–°æ¦‚å¿µï¼Œæ¯”é›†åˆè¿˜è¦æ›´å¼ºå¤§ï¼Œè¿˜å¯ä»¥å’Œé›†åˆäº’ç›¸è½¬æ¢ã€‚</p>\n<p>ä¸Šé¢åŒæ ·ä½¿ç”¨äº†é™æ€å¯¼å…¥ï¼š</p>\n<blockquote>\n<p>import static java.util.stream.Collectors.toList;</p>\n</blockquote>\n<h2 id=\"6ã€JDK-9-List-of\"><a href=\"#6ã€JDK-9-List-of\" class=\"headerlink\" title=\"6ã€JDK 9 List.of\"></a>6ã€JDK 9 List.of</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;String&gt; cups &#x3D; List.of(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;);\nSystem.out.println(cups);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>è¿™æ˜¯ JDK 9 é‡Œé¢æ–°å¢çš„ List æ¥å£é‡Œé¢çš„é™æ€æ–¹æ³•ï¼ŒåŒæ ·ä¹Ÿæ˜¯ä¸å¯å˜çš„ã€‚</p>\n<p>åœ¨æ¥å£ä¸­å®ç°é™æ€æ–¹æ³•å’Œé»˜è®¤æ–¹æ³•æ˜¯ JDK 8 ä¸­æ·»åŠ çš„æ–°ç‰¹æ€§ï¼Œå…·ä½“çœ‹è¿™ç¯‡æ–‡ç« ã€Š<a href=\"https://mp.weixin.qq.com/s/_V6oyDle4PrpzL65x_8K5w\">JDK 8 æ–°ç‰¹æ€§ä¹‹æ¥å£é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•\n</a>ã€‹ã€‚</p>\n<p>å¥½äº†ï¼Œä»Šå¤©æ ˆé•¿å°±ç»™å¤§å®¶ä»‹ç»åˆ°è¿™é‡Œäº†ï¼Œè¿™ 6 ç§ï¼Œä½ çŸ¥é“å‡ ç§ï¼Ÿå¦å¤–ï¼ŒMap, Set ä¹Ÿæœ‰ç±»ä¼¼çš„åˆå§‹åŒ–çš„æ–¹æ³•ï¼Œå¤§å®¶æœ‰å…´è¶£çš„å¯ä»¥è¯•ä¸€ä¸‹ã€‚</p>\n<p>ä½ è¿˜çŸ¥é“å“ªäº›ç»æ‹›å‘¢ï¼Ÿæ¬¢è¿ç•™è¨€åˆ†äº«ä¸€ä¸‹ã€‚ã€‚ã€‚</p>\n","excerpt":"","more":"<p>List æ˜¯ Java å¼€å‘ä¸­ç»å¸¸ä¼šä½¿ç”¨çš„é›†åˆï¼Œä½ ä»¬çŸ¥é“æœ‰å“ªäº›æ–¹å¼å¯ä»¥åˆå§‹åŒ–ä¸€ä¸ª List å—ï¼Ÿè¿™å…¶ä¸­ä¸ç¼ºä¹ä¸€äº›å‘ï¼Œä»Šå¤©æ ˆé•¿æˆ‘ç»™å¤§å®¶ä¸€ä¸€æ™®åŠä¸€ä¸‹ã€‚</p>\n<h2 id=\"1ã€å¸¸è§„æ–¹å¼\"><a href=\"#1ã€å¸¸è§„æ–¹å¼\" class=\"headerlink\" title=\"1ã€å¸¸è§„æ–¹å¼\"></a>1ã€å¸¸è§„æ–¹å¼</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;String&gt; languages &#x3D; new ArrayList&lt;&gt;();\nlanguages.add(&quot;Java&quot;);\nlanguages.add(&quot;PHP&quot;);\nlanguages.add(&quot;Python&quot;);\nSystem.out.println(languages);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ç§å°±æ˜¯æˆ‘ä»¬å¹³å¸¸ç”¨çš„æœ€å¤šæœ€å¹³å¸¸çš„æ–¹å¼äº†ï¼Œæ²¡ä»€ä¹ˆå¥½è¯´çš„ï¼Œåé¢ç¼ºå¤±çš„æ³›å‹ç±»å‹åœ¨ JDK 7 ä¹‹åå°±å¯ä»¥ä¸ç”¨å†™å…·ä½“çš„ç±»å‹äº†ï¼Œæ”¹è¿›åä¼šè‡ªåŠ¨æ¨æ–­ç±»å‹ã€‚</p>\n<h2 id=\"2ã€Arrays-å·¥å…·ç±»\"><a href=\"#2ã€Arrays-å·¥å…·ç±»\" class=\"headerlink\" title=\"2ã€Arrays å·¥å…·ç±»\"></a>2ã€Arrays å·¥å…·ç±»</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;String&gt; jdks &#x3D; asList(&quot;JDK6&quot;, &quot;JDK8&quot;, &quot;JDK10&quot;);\nSystem.out.println(jdks);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>æ³¨æ„ï¼Œä¸Šé¢çš„ asList æ˜¯ Arrays çš„é™æ€æ–¹æ³•ï¼Œè¿™é‡Œä½¿ç”¨äº†é™æ€å¯¼å…¥ã€‚è¿™ç§æ–¹å¼æ·»åŠ çš„æ˜¯ä¸å¯å˜çš„ List, å³ä¸èƒ½æ·»åŠ ã€åˆ é™¤ç­‰æ“ä½œï¼Œéœ€è¦è­¦æƒ•ã€‚ã€‚</p>\n<blockquote>\n<p>import static java.util.Arrays.asList;</p>\n</blockquote>\n<p>å¦‚æœè¦å¯å˜ï¼Œé‚£å°±ä½¿ç”¨ ArrayList å†åŒ…è£…ä¸€ä¸‹ï¼Œå¦‚ä¸‹é¢æ‰€ç¤ºã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;String&gt; numbers &#x3D; new ArrayList&lt;&gt;(Arrays.asList(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;));\nnumbers.add(&quot;4&quot;);\nSystem.out.println(numbers);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>åŒ…è£…ä¸€ä¸‹ï¼Œè¿™å°±æ˜¯å¯å˜çš„ ArrayList äº†ã€‚</p>\n<h2 id=\"3ã€Collections-å·¥å…·ç±»\"><a href=\"#3ã€Collections-å·¥å…·ç±»\" class=\"headerlink\" title=\"3ã€Collections å·¥å…·ç±»\"></a>3ã€Collections å·¥å…·ç±»</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;String&gt; apples &#x3D; Collections.nCopies(3, &quot;apple&quot;);\nSystem.out.println(apples);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>è¿™ç§æ–¹å¼æ·»åŠ çš„æ˜¯ä¸å¯å˜çš„ã€å¤åˆ¶æŸä¸ªå…ƒç´ Néçš„å·¥å…·ç±»ï¼Œä»¥ä¸Šç¨‹åºè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">[apple, apple, apple]<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>è€è§„åˆ™ï¼Œå¦‚æœè¦å¯å˜ï¼Œä½¿ç”¨ ArrayList åŒ…è£…ä¸€éã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;String&gt; dogs &#x3D; new ArrayList&lt;&gt;(Collections.nCopies(3, &quot;dog&quot;));\ndogs.add(&quot;dog&quot;);\nSystem.out.println(dogs);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿˜æœ‰åˆå§‹åŒ–å•ä¸ªå¯¹è±¡çš„ List å·¥å…·ç±»ï¼Œè¿™ç§æ–¹å¼ä¹Ÿæ˜¯ä¸å¯å˜çš„ï¼Œé›†åˆå†…åªèƒ½æœ‰ä¸€ä¸ªå…ƒç´ ï¼Œè¿™ç§ä¹Ÿç”¨å¾—å¾ˆå°‘å•Šã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;String&gt; cat &#x3D; Collections.singletonList(&quot;cat&quot;);\nSystem.out.println(cat);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>è¿˜æœ‰ä¸€ä¸ªåˆ›å»ºç©º List çš„å·¥å…·ç±»ï¼Œæ²¡æœ‰é»˜è®¤å®¹é‡ï¼ŒèŠ‚çœç©ºé—´ï¼Œä½†ä¸çŸ¥é“å®é™…å·¥ä½œä¸­æœ‰ä»€ä¹ˆé¸Ÿç”¨ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;String&gt; cat &#x3D; Collections.emptyList(&quot;cat&quot;);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h2 id=\"4ã€åŒ¿åå†…éƒ¨ç±»\"><a href=\"#4ã€åŒ¿åå†…éƒ¨ç±»\" class=\"headerlink\" title=\"4ã€åŒ¿åå†…éƒ¨ç±»\"></a>4ã€åŒ¿åå†…éƒ¨ç±»</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;String&gt; names &#x3D; new ArrayList&lt;&gt;() &#123;&#123;\n    add(&quot;Tom&quot;);\n    add(&quot;Sally&quot;);\n    add(&quot;John&quot;);\n&#125;&#125;;\nSystem.out.println(names);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ç§ä½¿ç”¨äº†åŒ¿åå†…éƒ¨ç±»çš„æ–¹å¼ï¼Œä¸€æ°”å–æˆï¼Œæ˜¯ä¸æ˜¯å¾ˆé«˜å¤§ä¸Šï¼Ÿæ ˆé•¿æˆ‘æ›¾ç»ä¹Ÿä½¿ç”¨è¿‡è¿™ç§æ–¹å¼ï¼Œä¸è¿‡æˆ‘è§‰å¾—è¿™ç§çœ‹ä¼¼é«˜çº§ï¼Œå®ç°ä¹Ÿæ²¡ä»€ä¹ˆåµç”¨ã€‚</p>\n<h2 id=\"5ã€JDK8-Stream\"><a href=\"#5ã€JDK8-Stream\" class=\"headerlink\" title=\"5ã€JDK8 Stream\"></a>5ã€JDK8 Stream</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;String&gt; colors &#x3D; Stream.of(&quot;blue&quot;, &quot;red&quot;, &quot;yellow&quot;).collect(toList());\nSystem.out.println(colors);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>Stream æ˜¯ JDK 8 æ¨å‡ºæ¥çš„æ–°æ¦‚å¿µï¼Œæ¯”é›†åˆè¿˜è¦æ›´å¼ºå¤§ï¼Œè¿˜å¯ä»¥å’Œé›†åˆäº’ç›¸è½¬æ¢ã€‚</p>\n<p>ä¸Šé¢åŒæ ·ä½¿ç”¨äº†é™æ€å¯¼å…¥ï¼š</p>\n<blockquote>\n<p>import static java.util.stream.Collectors.toList;</p>\n</blockquote>\n<h2 id=\"6ã€JDK-9-List-of\"><a href=\"#6ã€JDK-9-List-of\" class=\"headerlink\" title=\"6ã€JDK 9 List.of\"></a>6ã€JDK 9 List.of</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;String&gt; cups &#x3D; List.of(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;);\nSystem.out.println(cups);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>è¿™æ˜¯ JDK 9 é‡Œé¢æ–°å¢çš„ List æ¥å£é‡Œé¢çš„é™æ€æ–¹æ³•ï¼ŒåŒæ ·ä¹Ÿæ˜¯ä¸å¯å˜çš„ã€‚</p>\n<p>åœ¨æ¥å£ä¸­å®ç°é™æ€æ–¹æ³•å’Œé»˜è®¤æ–¹æ³•æ˜¯ JDK 8 ä¸­æ·»åŠ çš„æ–°ç‰¹æ€§ï¼Œå…·ä½“çœ‹è¿™ç¯‡æ–‡ç« ã€Š<a href=\"https://mp.weixin.qq.com/s/_V6oyDle4PrpzL65x_8K5w\">JDK 8 æ–°ç‰¹æ€§ä¹‹æ¥å£é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•\n</a>ã€‹ã€‚</p>\n<p>å¥½äº†ï¼Œä»Šå¤©æ ˆé•¿å°±ç»™å¤§å®¶ä»‹ç»åˆ°è¿™é‡Œäº†ï¼Œè¿™ 6 ç§ï¼Œä½ çŸ¥é“å‡ ç§ï¼Ÿå¦å¤–ï¼ŒMap, Set ä¹Ÿæœ‰ç±»ä¼¼çš„åˆå§‹åŒ–çš„æ–¹æ³•ï¼Œå¤§å®¶æœ‰å…´è¶£çš„å¯ä»¥è¯•ä¸€ä¸‹ã€‚</p>\n<p>ä½ è¿˜çŸ¥é“å“ªäº›ç»æ‹›å‘¢ï¼Ÿæ¬¢è¿ç•™è¨€åˆ†äº«ä¸€ä¸‹ã€‚ã€‚ã€‚</p>\n"},{"title":"HashMap, ConcurrentHashMap åŸç†åŠæºç ","date":"2025-10-15T03:36:33.000Z","_content":"\n\nç½‘ä¸Šå…³äº HashMap å’Œ ConcurrentHashMap çš„æ–‡ç« ç¡®å®ä¸å°‘ï¼Œä¸è¿‡ç¼ºæ–¤å°‘ä¸¤çš„æ–‡ç« æ¯”è¾ƒå¤šï¼Œæ‰€ä»¥æ‰æƒ³è‡ªå·±ä¹Ÿå†™ä¸€ç¯‡ï¼ŒæŠŠç»†èŠ‚è¯´æ¸…æ¥šè¯´é€ï¼Œå°¤å…¶åƒ Java8 ä¸­çš„ ConcurrentHashMapï¼Œå¤§éƒ¨åˆ†æ–‡ç« éƒ½è¯´ä¸æ¸…æ¥šã€‚ç»ˆå½’æ˜¯å¸Œæœ›èƒ½é™ä½å¤§å®¶å­¦ä¹ çš„æˆæœ¬ï¼Œä¸å¸Œæœ›å¤§å®¶åˆ°å¤„æ‰¾å„ç§ä¸æ˜¯å¾ˆé è°±çš„æ–‡ç« ï¼Œçœ‹å®Œä¸€ç¯‡åˆä¸€ç¯‡ï¼Œå¯æ˜¯è¿˜æ˜¯æ¨¡æ¨¡ç³Šç³Šã€‚\n\n**é˜…è¯»å»ºè®®ï¼š** å››èŠ‚åŸºæœ¬ä¸Šå¯ä»¥è¿›è¡Œç‹¬ç«‹é˜…è¯»ï¼Œå»ºè®®åˆå­¦è€…å¯æŒ‰ç…§ä»¥ä¸‹é¡ºåºè¿›è¡Œé˜…è¯»ï¼Œå¯é€‚å½“é™ä½é˜…è¯»é—¨æ§›ã€‚\n\n> Java7 HashMap -> Java7 ConcurrentHashMap -> Java8 HashMap -> Java8 ConcurrentHashMap \n\n**é˜…è¯»å‰æï¼š** æœ¬æ–‡åˆ†æçš„æ˜¯æºç ï¼Œæ‰€ä»¥è‡³å°‘è¯»è€…è¦ç†Ÿæ‚‰å®ƒä»¬çš„æ¥å£ä½¿ç”¨ï¼ŒåŒæ—¶ï¼Œå¯¹äºå¹¶å‘ï¼Œè¯»è€…è‡³å°‘è¦çŸ¥é“ CASã€ReentrantLockã€UNSAFE æ“ä½œè¿™å‡ ä¸ªåŸºæœ¬çš„çŸ¥è¯†ï¼Œæ–‡ä¸­ä¸ä¼šå¯¹è¿™äº›çŸ¥è¯†è¿›è¡Œä»‹ç»ã€‚Java8 ç”¨åˆ°äº†çº¢é»‘æ ‘ï¼Œä¸è¿‡æœ¬æ–‡ä¸ä¼šè¿›è¡Œå±•å¼€ï¼Œæ„Ÿå…´è¶£çš„è¯»è€…è¯·è‡ªè¡ŒæŸ¥æ‰¾ç›¸å…³èµ„æ–™ã€‚\n\n## Java7 HashMap\n\nHashMap æ˜¯æœ€ç®€å•çš„ï¼Œä¸€æ¥æˆ‘ä»¬éå¸¸ç†Ÿæ‚‰ï¼ŒäºŒæ¥å°±æ˜¯å®ƒä¸æ”¯æŒå¹¶å‘æ“ä½œï¼Œæ‰€ä»¥æºç ä¹Ÿéå¸¸ç®€å•ã€‚\n\né¦–å…ˆï¼Œæˆ‘ä»¬ç”¨ä¸‹é¢è¿™å¼ å›¾æ¥ä»‹ç» HashMap çš„ç»“æ„ã€‚\n\n![](http://qianniu.javastack.cn/18-12-4/65827660.jpg)\n\nè¿™ä¸ªä»…ä»…æ˜¯ç¤ºæ„å›¾ï¼Œå› ä¸ºæ²¡æœ‰è€ƒè™‘åˆ°æ•°ç»„è¦æ‰©å®¹çš„æƒ…å†µï¼Œå…·ä½“çš„åé¢å†è¯´ã€‚\n\nå¤§æ–¹å‘ä¸Šï¼ŒHashMap é‡Œé¢æ˜¯ä¸€ä¸ª**æ•°ç»„**ï¼Œç„¶åæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ª**å•å‘é“¾è¡¨**ã€‚\n\nä¸Šå›¾ä¸­ï¼Œæ¯ä¸ªç»¿è‰²çš„å®ä½“æ˜¯åµŒå¥—ç±» Entry çš„å®ä¾‹ï¼ŒEntry åŒ…å«å››ä¸ªå±æ€§ï¼škey, value, hash å€¼å’Œç”¨äºå•å‘é“¾è¡¨çš„ nextã€‚\n\ncapacityï¼šå½“å‰æ•°ç»„å®¹é‡ï¼Œå§‹ç»ˆä¿æŒ 2^nï¼Œå¯ä»¥æ‰©å®¹ï¼Œæ‰©å®¹åæ•°ç»„å¤§å°ä¸ºå½“å‰çš„ 2 å€ã€‚\n\nloadFactorï¼šè´Ÿè½½å› å­ï¼Œé»˜è®¤ä¸º 0.75ã€‚\n\nthresholdï¼šæ‰©å®¹çš„é˜ˆå€¼ï¼Œç­‰äº capacity * loadFactor\n\n#### put è¿‡ç¨‹åˆ†æ\n\nè¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œè·Ÿç€ä»£ç èµ°ä¸€éå§ã€‚\n\n```\npublic V put(K key, V value) {\n    // å½“æ’å…¥ç¬¬ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œéœ€è¦å…ˆåˆå§‹åŒ–æ•°ç»„å¤§å°\n    if (table == EMPTY_TABLE) {\n        inflateTable(threshold);\n    }\n    // å¦‚æœ key ä¸º nullï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å¾€é‡Œçœ‹ï¼Œæœ€ç»ˆä¼šå°†è¿™ä¸ª entry æ”¾åˆ° table[0] ä¸­\n    if (key == null)\n        return putForNullKey(value);\n    // 1. æ±‚ key çš„ hash å€¼\n    int hash = hash(key);\n    // 2. æ‰¾åˆ°å¯¹åº”çš„æ•°ç»„ä¸‹æ ‡\n    int i = indexFor(hash, table.length);\n    // 3. éå†ä¸€ä¸‹å¯¹åº”ä¸‹æ ‡å¤„çš„é“¾è¡¨ï¼Œçœ‹æ˜¯å¦æœ‰é‡å¤çš„ key å·²ç»å­˜åœ¨ï¼Œ\n    //    å¦‚æœæœ‰ï¼Œç›´æ¥è¦†ç›–ï¼Œput æ–¹æ³•è¿”å›æ—§å€¼å°±ç»“æŸäº†\n    for (Entry<K,V> e = table[i]; e != null; e = e.next) {\n        Object k;\n        if (e.hash == hash && ((k = e.key) == key || key.equals(k))) {\n            V oldValue = e.value;\n            e.value = value;\n            e.recordAccess(this);\n            return oldValue;\n        }\n    }\n \n    modCount++;\n    // 4. ä¸å­˜åœ¨é‡å¤çš„ keyï¼Œå°†æ­¤ entry æ·»åŠ åˆ°é“¾è¡¨ä¸­ï¼Œç»†èŠ‚åé¢è¯´\n    addEntry(hash, key, value, i);\n    return null;\n}\n```\n\n###### æ•°ç»„åˆå§‹åŒ–\n\nåœ¨ç¬¬ä¸€ä¸ªå…ƒç´ æ’å…¥ HashMap çš„æ—¶å€™åšä¸€æ¬¡æ•°ç»„çš„åˆå§‹åŒ–ï¼Œå°±æ˜¯å…ˆç¡®å®šåˆå§‹çš„æ•°ç»„å¤§å°ï¼Œå¹¶è®¡ç®—æ•°ç»„æ‰©å®¹çš„é˜ˆå€¼ã€‚\n\n```\nprivate void inflateTable(int toSize) {\n    // ä¿è¯æ•°ç»„å¤§å°ä¸€å®šæ˜¯ 2 çš„ n æ¬¡æ–¹ã€‚\n    // æ¯”å¦‚è¿™æ ·åˆå§‹åŒ–ï¼šnew HashMap(20)ï¼Œé‚£ä¹ˆå¤„ç†æˆåˆå§‹æ•°ç»„å¤§å°æ˜¯ 32\n    int capacity = roundUpToPowerOf2(toSize);\n    // è®¡ç®—æ‰©å®¹é˜ˆå€¼ï¼šcapacity * loadFactor\n    threshold = (int) Math.min(capacity * loadFactor, MAXIMUM_CAPACITY + 1);\n    // ç®—æ˜¯åˆå§‹åŒ–æ•°ç»„å§\n    table = new Entry[capacity];\n    initHashSeedAsNeeded(capacity); //ignore\n}\n```\n\nè¿™é‡Œæœ‰ä¸€ä¸ªå°†æ•°ç»„å¤§å°ä¿æŒä¸º 2 çš„ n æ¬¡æ–¹çš„åšæ³•ï¼ŒJava7 å’Œ Java8 çš„ HashMap å’Œ ConcurrentHashMap éƒ½æœ‰ç›¸åº”çš„è¦æ±‚ï¼Œåªä¸è¿‡å®ç°çš„ä»£ç ç¨å¾®æœ‰äº›ä¸åŒï¼Œåé¢å†çœ‹åˆ°çš„æ—¶å€™å°±çŸ¥é“äº†ã€‚\n\n###### è®¡ç®—å…·ä½“æ•°ç»„ä½ç½®\n\nè¿™ä¸ªç®€å•ï¼Œæˆ‘ä»¬è‡ªå·±ä¹Ÿèƒ½ YY ä¸€ä¸ªï¼šä½¿ç”¨ key çš„ hash å€¼å¯¹æ•°ç»„é•¿åº¦è¿›è¡Œå–æ¨¡å°±å¯ä»¥äº†ã€‚\n\n```\nstatic int indexFor(int hash, int length) {\n    // assert Integer.bitCount(length) == 1 : \"length must be a non-zero power of 2\";\n    return hash & (length-1);\n}\n```\n\nè¿™ä¸ªæ–¹æ³•å¾ˆç®€å•ï¼Œç®€å•è¯´å°±æ˜¯å– hash å€¼çš„ä½ n ä½ã€‚å¦‚åœ¨æ•°ç»„é•¿åº¦ä¸º 32 çš„æ—¶å€™ï¼Œå…¶å®å–çš„å°±æ˜¯ key çš„ hash å€¼çš„ä½ 5 ä½ï¼Œä½œä¸ºå®ƒåœ¨æ•°ç»„ä¸­çš„ä¸‹æ ‡ä½ç½®ã€‚\n\n###### æ·»åŠ èŠ‚ç‚¹åˆ°é“¾è¡¨ä¸­\n\næ‰¾åˆ°æ•°ç»„ä¸‹æ ‡åï¼Œä¼šå…ˆè¿›è¡Œ key åˆ¤é‡ï¼Œå¦‚æœæ²¡æœ‰é‡å¤ï¼Œå°±å‡†å¤‡å°†æ–°å€¼æ”¾å…¥åˆ°é“¾è¡¨çš„è¡¨å¤´ã€‚\n\n```\nvoid addEntry(int hash, K key, V value, int bucketIndex) {\n    // å¦‚æœå½“å‰ HashMap å¤§å°å·²ç»è¾¾åˆ°äº†é˜ˆå€¼ï¼Œå¹¶ä¸”æ–°å€¼è¦æ’å…¥çš„æ•°ç»„ä½ç½®å·²ç»æœ‰å…ƒç´ äº†ï¼Œé‚£ä¹ˆè¦æ‰©å®¹\n    if ((size >= threshold) && (null != table[bucketIndex])) {\n        // æ‰©å®¹ï¼Œåé¢ä¼šä»‹ç»ä¸€ä¸‹\n        resize(2 * table.length);\n        // æ‰©å®¹ä»¥åï¼Œé‡æ–°è®¡ç®— hash å€¼\n        hash = (null != key) ? hash(key) : 0;\n        // é‡æ–°è®¡ç®—æ‰©å®¹åçš„æ–°çš„ä¸‹æ ‡\n        bucketIndex = indexFor(hash, table.length);\n    }\n    // å¾€ä¸‹çœ‹\n    createEntry(hash, key, value, bucketIndex);\n}\n\n// è¿™ä¸ªå¾ˆç®€å•ï¼Œå…¶å®å°±æ˜¯å°†æ–°å€¼æ”¾åˆ°é“¾è¡¨çš„è¡¨å¤´ï¼Œç„¶å size++\nvoid createEntry(int hash, K key, V value, int bucketIndex) {\n    Entry<K,V> e = table[bucketIndex];\n    table[bucketIndex] = new Entry<>(hash, key, value, e);\n    size++;\n}\n```\n\nè¿™ä¸ªæ–¹æ³•çš„ä¸»è¦é€»è¾‘å°±æ˜¯å…ˆåˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹ï¼Œéœ€è¦çš„è¯å…ˆæ‰©å®¹ï¼Œç„¶åå†å°†è¿™ä¸ªæ–°çš„æ•°æ®æ’å…¥åˆ°æ‰©å®¹åçš„æ•°ç»„çš„ç›¸åº”ä½ç½®å¤„çš„é“¾è¡¨çš„è¡¨å¤´ã€‚\n\n###### æ•°ç»„æ‰©å®¹\n\nå‰é¢æˆ‘ä»¬çœ‹åˆ°ï¼Œåœ¨æ’å…¥æ–°å€¼çš„æ—¶å€™ï¼Œå¦‚æœå½“å‰çš„ size å·²ç»è¾¾åˆ°äº†é˜ˆå€¼ï¼Œå¹¶ä¸”è¦æ’å…¥çš„æ•°ç»„ä½ç½®ä¸Šå·²ç»æœ‰å…ƒç´ ï¼Œé‚£ä¹ˆå°±ä¼šè§¦å‘æ‰©å®¹ï¼Œæ‰©å®¹åï¼Œæ•°ç»„å¤§å°ä¸ºåŸæ¥çš„ 2 å€ã€‚\n\n```\nvoid resize(int newCapacity) {\n    Entry[] oldTable = table;\n    int oldCapacity = oldTable.length;\n    if (oldCapacity == MAXIMUM_CAPACITY) {\n        threshold = Integer.MAX_VALUE;\n        return;\n    }\n    // æ–°çš„æ•°ç»„\n    Entry[] newTable = new Entry[newCapacity];\n    // å°†åŸæ¥æ•°ç»„ä¸­çš„å€¼è¿ç§»åˆ°æ–°çš„æ›´å¤§çš„æ•°ç»„ä¸­\n    transfer(newTable, initHashSeedAsNeeded(newCapacity));\n    table = newTable;\n    threshold = (int)Math.min(newCapacity * loadFactor, MAXIMUM_CAPACITY + 1);\n}\n```\n\næ‰©å®¹å°±æ˜¯ç”¨ä¸€ä¸ªæ–°çš„å¤§æ•°ç»„æ›¿æ¢åŸæ¥çš„å°æ•°ç»„ï¼Œå¹¶å°†åŸæ¥æ•°ç»„ä¸­çš„å€¼è¿ç§»åˆ°æ–°çš„æ•°ç»„ä¸­ã€‚\n\nç”±äºæ˜¯åŒå€æ‰©å®¹ï¼Œè¿ç§»è¿‡ç¨‹ä¸­ï¼Œä¼šå°†åŸæ¥ table[i] ä¸­çš„é“¾è¡¨çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œåˆ†æ‹†åˆ°æ–°çš„æ•°ç»„çš„ newTable[i] å’Œ newTable[i + oldLength] ä½ç½®ä¸Šã€‚å¦‚åŸæ¥æ•°ç»„é•¿åº¦æ˜¯ 16ï¼Œé‚£ä¹ˆæ‰©å®¹åï¼ŒåŸæ¥ table[0] å¤„çš„é“¾è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ ä¼šè¢«åˆ†é…åˆ°æ–°æ•°ç»„ä¸­ newTable[0] å’Œ newTable[16] è¿™ä¸¤ä¸ªä½ç½®ã€‚ä»£ç æ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œå°±ä¸å±•å¼€äº†ã€‚\n\n#### get è¿‡ç¨‹åˆ†æ\n\nç›¸å¯¹äº put è¿‡ç¨‹ï¼Œget è¿‡ç¨‹æ˜¯éå¸¸ç®€å•çš„ã€‚\n\n1. æ ¹æ® key è®¡ç®— hash å€¼ã€‚\n2. æ‰¾åˆ°ç›¸åº”çš„æ•°ç»„ä¸‹æ ‡ï¼šhash & (length â€“ 1)ã€‚\n3. éå†è¯¥æ•°ç»„ä½ç½®å¤„çš„é“¾è¡¨ï¼Œç›´åˆ°æ‰¾åˆ°ç›¸ç­‰(==æˆ–equals)çš„ keyã€‚\n\n```\npublic V get(Object key) {\n    // ä¹‹å‰è¯´è¿‡ï¼Œkey ä¸º null çš„è¯ï¼Œä¼šè¢«æ”¾åˆ° table[0]ï¼Œæ‰€ä»¥åªè¦éå†ä¸‹ table[0] å¤„çš„é“¾è¡¨å°±å¯ä»¥äº†\n    if (key == null)\n        return getForNullKey();\n    // \n    Entry<K,V> entry = getEntry(key);\n \n    return null == entry ? null : entry.getValue();\n}\n```\n\ngetEntry(key):\n\n```\nfinal Entry<K,V> getEntry(Object key) {\n    if (size == 0) {\n        return null;\n    }\n \n    int hash = (key == null) ? 0 : hash(key);\n    // ç¡®å®šæ•°ç»„ä¸‹æ ‡ï¼Œç„¶åä»å¤´å¼€å§‹éå†é“¾è¡¨ï¼Œç›´åˆ°æ‰¾åˆ°ä¸ºæ­¢\n    for (Entry<K,V> e = table[indexFor(hash, table.length)];\n         e != null;\n         e = e.next) {\n        Object k;\n        if (e.hash == hash &&\n            ((k = e.key) == key || (key != null && key.equals(k))))\n            return e;\n    }\n    return null;\n}\n```\n\n## Java7 ConcurrentHashMap\n\nConcurrentHashMap å’Œ HashMap æ€è·¯æ˜¯å·®ä¸å¤šçš„ï¼Œä½†æ˜¯å› ä¸ºå®ƒæ”¯æŒå¹¶å‘æ“ä½œï¼Œæ‰€ä»¥è¦å¤æ‚ä¸€äº›ã€‚\n\næ•´ä¸ª ConcurrentHashMap ç”±ä¸€ä¸ªä¸ª Segment ç»„æˆï¼ŒSegment ä»£è¡¨â€éƒ¨åˆ†â€œæˆ–â€ä¸€æ®µâ€œçš„æ„æ€ï¼Œæ‰€ä»¥å¾ˆå¤šåœ°æ–¹éƒ½ä¼šå°†å…¶æè¿°ä¸º**åˆ†æ®µé”**ã€‚æ³¨æ„ï¼Œè¡Œæ–‡ä¸­ï¼Œæˆ‘å¾ˆå¤šåœ°æ–¹ç”¨äº† **â€œæ§½â€** æ¥ä»£è¡¨ä¸€ä¸ª segmentã€‚\n\nç®€å•ç†è§£å°±æ˜¯ï¼ŒConcurrentHashMap æ˜¯ä¸€ä¸ª Segment æ•°ç»„ï¼ŒSegment é€šè¿‡ç»§æ‰¿ ReentrantLock æ¥è¿›è¡ŒåŠ é”ï¼Œæ‰€ä»¥æ¯æ¬¡éœ€è¦åŠ é”çš„æ“ä½œé”ä½çš„æ˜¯ä¸€ä¸ª segmentï¼Œè¿™æ ·åªè¦ä¿è¯æ¯ä¸ª Segment æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä¹Ÿå°±å®ç°äº†å…¨å±€çš„çº¿ç¨‹å®‰å…¨ã€‚æ¨èé˜…è¯»ï¼š[å²ä¸Šæœ€å…¨ Java å¤šçº¿ç¨‹é¢è¯•é¢˜åŠç­”æ¡ˆ](https://mp.weixin.qq.com/s/0CI9od4DIxRrmOGFJw0SuQ)ã€‚\n\n![](http://qianniu.javastack.cn/18-12-4/75121838.jpg)\n\n**concurrencyLevelï¼š** å¹¶è¡Œçº§åˆ«ã€å¹¶å‘æ•°ã€Segment æ•°ï¼Œæ€ä¹ˆç¿»è¯‘ä¸é‡è¦ï¼Œç†è§£å®ƒã€‚é»˜è®¤æ˜¯ 16ï¼Œä¹Ÿå°±æ˜¯è¯´ ConcurrentHashMap æœ‰ 16 ä¸ª Segmentsï¼Œæ‰€ä»¥ç†è®ºä¸Šï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæœ€å¤šå¯ä»¥åŒæ—¶æ”¯æŒ 16 ä¸ªçº¿ç¨‹å¹¶å‘å†™ï¼Œåªè¦å®ƒä»¬çš„æ“ä½œåˆ†åˆ«åˆ†å¸ƒåœ¨ä¸åŒçš„ Segment ä¸Šã€‚è¿™ä¸ªå€¼å¯ä»¥åœ¨åˆå§‹åŒ–çš„æ—¶å€™è®¾ç½®ä¸ºå…¶ä»–å€¼ï¼Œä½†æ˜¯ä¸€æ—¦åˆå§‹åŒ–ä»¥åï¼Œå®ƒæ˜¯ä¸å¯ä»¥æ‰©å®¹çš„ã€‚\n\nå†å…·ä½“åˆ°æ¯ä¸ª Segment å†…éƒ¨ï¼Œå…¶å®æ¯ä¸ª Segment å¾ˆåƒä¹‹å‰ä»‹ç»çš„ HashMapï¼Œä¸è¿‡å®ƒè¦ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œæ‰€ä»¥å¤„ç†èµ·æ¥è¦éº»çƒ¦äº›ã€‚æ¨èé˜…è¯»ï¼š[å‡ ç§çº¿ç¨‹å®‰å…¨çš„Mapè§£æ](https://mp.weixin.qq.com/s/5Y5_6qn2g6kIVmQia_0R6g)ã€‚\n\n#### åˆå§‹åŒ–\n\ninitialCapacityï¼šåˆå§‹å®¹é‡ï¼Œè¿™ä¸ªå€¼æŒ‡çš„æ˜¯æ•´ä¸ª ConcurrentHashMap çš„åˆå§‹å®¹é‡ï¼Œå®é™…æ“ä½œçš„æ—¶å€™éœ€è¦å¹³å‡åˆ†ç»™æ¯ä¸ª Segmentã€‚\n\nloadFactorï¼šè´Ÿè½½å› å­ï¼Œä¹‹å‰æˆ‘ä»¬è¯´äº†ï¼ŒSegment æ•°ç»„ä¸å¯ä»¥æ‰©å®¹ï¼Œæ‰€ä»¥è¿™ä¸ªè´Ÿè½½å› å­æ˜¯ç»™æ¯ä¸ª Segment å†…éƒ¨ä½¿ç”¨çš„ã€‚\n\n```\npublic ConcurrentHashMap(int initialCapacity,\n                         float loadFactor, int concurrencyLevel) {\n    if (!(loadFactor > 0) || initialCapacity < 0 || concurrencyLevel <= 0)\n        throw new IllegalArgumentException();\n    if (concurrencyLevel > MAX_SEGMENTS)\n        concurrencyLevel = MAX_SEGMENTS;\n    // Find power-of-two sizes best matching arguments\n    int sshift = 0;\n    int ssize = 1;\n    // è®¡ç®—å¹¶è¡Œçº§åˆ« ssizeï¼Œå› ä¸ºè¦ä¿æŒå¹¶è¡Œçº§åˆ«æ˜¯ 2 çš„ n æ¬¡æ–¹\n    while (ssize < concurrencyLevel) {\n        ++sshift;\n        ssize <<= 1;\n    }\n    // æˆ‘ä»¬è¿™é‡Œå…ˆä¸è¦é‚£ä¹ˆçƒ§è„‘ï¼Œç”¨é»˜è®¤å€¼ï¼ŒconcurrencyLevel ä¸º 16ï¼Œsshift ä¸º 4\n    // é‚£ä¹ˆè®¡ç®—å‡º segmentShift ä¸º 28ï¼ŒsegmentMask ä¸º 15ï¼Œåé¢ä¼šç”¨åˆ°è¿™ä¸¤ä¸ªå€¼\n    this.segmentShift = 32 - sshift;\n    this.segmentMask = ssize - 1;\n \n    if (initialCapacity > MAXIMUM_CAPACITY)\n        initialCapacity = MAXIMUM_CAPACITY;\n \n    // initialCapacity æ˜¯è®¾ç½®æ•´ä¸ª map åˆå§‹çš„å¤§å°ï¼Œ\n    // è¿™é‡Œæ ¹æ® initialCapacity è®¡ç®— Segment æ•°ç»„ä¸­æ¯ä¸ªä½ç½®å¯ä»¥åˆ†åˆ°çš„å¤§å°\n    // å¦‚ initialCapacity ä¸º 64ï¼Œé‚£ä¹ˆæ¯ä¸ª Segment æˆ–ç§°ä¹‹ä¸º\"æ§½\"å¯ä»¥åˆ†åˆ° 4 ä¸ª\n    int c = initialCapacity / ssize;\n    if (c * ssize < initialCapacity)\n        ++c;\n    // é»˜è®¤ MIN_SEGMENT_TABLE_CAPACITY æ˜¯ 2ï¼Œè¿™ä¸ªå€¼ä¹Ÿæ˜¯æœ‰è®²ç©¶çš„ï¼Œå› ä¸ºè¿™æ ·çš„è¯ï¼Œå¯¹äºå…·ä½“çš„æ§½ä¸Šï¼Œ\n    // æ’å…¥ä¸€ä¸ªå…ƒç´ ä¸è‡³äºæ‰©å®¹ï¼Œæ’å…¥ç¬¬äºŒä¸ªçš„æ—¶å€™æ‰ä¼šæ‰©å®¹\n    int cap = MIN_SEGMENT_TABLE_CAPACITY; \n    while (cap < c)\n        cap <<= 1;\n \n    // åˆ›å»º Segment æ•°ç»„ï¼Œ\n    // å¹¶åˆ›å»ºæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´  segment[0]\n    Segment<K,V> s0 =\n        new Segment<K,V>(loadFactor, (int)(cap * loadFactor),\n                         (HashEntry<K,V>[])new HashEntry[cap]);\n    Segment<K,V>[] ss = (Segment<K,V>[])new Segment[ssize];\n    // å¾€æ•°ç»„å†™å…¥ segment[0]\n    UNSAFE.putOrderedObject(ss, SBASE, s0); // ordered write of segments[0]\n    this.segments = ss;\n}\n```\n\nåˆå§‹åŒ–å®Œæˆï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ª Segment æ•°ç»„ã€‚\n\næˆ‘ä»¬å°±å½“æ˜¯ç”¨ new ConcurrentHashMap() æ— å‚æ„é€ å‡½æ•°è¿›è¡Œåˆå§‹åŒ–çš„ï¼Œé‚£ä¹ˆåˆå§‹åŒ–å®Œæˆåï¼š\n\n- Segment æ•°ç»„é•¿åº¦ä¸º 16ï¼Œä¸å¯ä»¥æ‰©å®¹\n- Segment[i] çš„é»˜è®¤å¤§å°ä¸º 2ï¼Œè´Ÿè½½å› å­æ˜¯ 0.75ï¼Œå¾—å‡ºåˆå§‹é˜ˆå€¼ä¸º 1.5ï¼Œä¹Ÿå°±æ˜¯ä»¥åæ’å…¥ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ä¼šè§¦å‘æ‰©å®¹ï¼Œæ’å…¥ç¬¬äºŒä¸ªä¼šè¿›è¡Œç¬¬ä¸€æ¬¡æ‰©å®¹\n- è¿™é‡Œåˆå§‹åŒ–äº† segment[0]ï¼Œå…¶ä»–ä½ç½®è¿˜æ˜¯ nullï¼Œè‡³äºä¸ºä»€ä¹ˆè¦åˆå§‹åŒ– segment[0]ï¼Œåé¢çš„ä»£ç ä¼šä»‹ç»\n- å½“å‰ segmentShift çš„å€¼ä¸º 32 â€“ 4 = 28ï¼ŒsegmentMask ä¸º 16 â€“ 1 = 15ï¼Œå§‘ä¸”æŠŠå®ƒä»¬ç®€å•ç¿»è¯‘ä¸ºç§»ä½æ•°å’Œæ©ç ï¼Œè¿™ä¸¤ä¸ªå€¼é©¬ä¸Šå°±ä¼šç”¨åˆ°ã€‚\n\n#### put è¿‡ç¨‹åˆ†æ\n\næˆ‘ä»¬å…ˆçœ‹ put çš„ä¸»æµç¨‹ï¼Œå¯¹äºå…¶ä¸­çš„ä¸€äº›å…³é”®ç»†èŠ‚æ“ä½œï¼Œåé¢ä¼šè¿›è¡Œè¯¦ç»†ä»‹ç»ã€‚\n\n```\npublic V put(K key, V value) {\n    Segment<K,V> s;\n    if (value == null)\n        throw new NullPointerException();\n    // 1. è®¡ç®— key çš„ hash å€¼\n    int hash = hash(key);\n    // 2. æ ¹æ® hash å€¼æ‰¾åˆ° Segment æ•°ç»„ä¸­çš„ä½ç½® j\n    //    hash æ˜¯ 32 ä½ï¼Œæ— ç¬¦å·å³ç§» segmentShift(28) ä½ï¼Œå‰©ä¸‹ä½ 4 ä½ï¼Œ\n    //    ç„¶åå’Œ segmentMask(15) åšä¸€æ¬¡ä¸æ“ä½œï¼Œä¹Ÿå°±æ˜¯è¯´ j æ˜¯ hash å€¼çš„æœ€å 4 ä½ï¼Œä¹Ÿå°±æ˜¯æ§½çš„æ•°ç»„ä¸‹æ ‡\n    int j = (hash >>> segmentShift) & segmentMask;\n    // åˆšåˆšè¯´äº†ï¼Œåˆå§‹åŒ–çš„æ—¶å€™åˆå§‹åŒ–äº† segment[0]ï¼Œä½†æ˜¯å…¶ä»–ä½ç½®è¿˜æ˜¯ nullï¼Œ\n    // ensureSegment(j) å¯¹ segment[j] è¿›è¡Œåˆå§‹åŒ–\n    if ((s = (Segment<K,V>)UNSAFE.getObject          // nonvolatile; recheck\n         (segments, (j << SSHIFT) + SBASE)) == null) //  in ensureSegment\n        s = ensureSegment(j);\n    // 3. æ’å…¥æ–°å€¼åˆ° æ§½ s ä¸­\n    return s.put(key, hash, value, false);\n}\n```\n\nç¬¬ä¸€å±‚çš®å¾ˆç®€å•ï¼Œæ ¹æ® hash å€¼å¾ˆå¿«å°±èƒ½æ‰¾åˆ°ç›¸åº”çš„ Segmentï¼Œä¹‹åå°±æ˜¯ Segment å†…éƒ¨çš„ put æ“ä½œäº†ã€‚\n\nSegment å†…éƒ¨æ˜¯ç”± **æ•°ç»„+é“¾è¡¨** ç»„æˆçš„ã€‚\n\n```\nfinal V put(K key, int hash, V value, boolean onlyIfAbsent) {\n    // åœ¨å¾€è¯¥ segment å†™å…¥å‰ï¼Œéœ€è¦å…ˆè·å–è¯¥ segment çš„ç‹¬å é”\n    //    å…ˆçœ‹ä¸»æµç¨‹ï¼Œåé¢è¿˜ä¼šå…·ä½“ä»‹ç»è¿™éƒ¨åˆ†å†…å®¹\n    HashEntry<K,V> node = tryLock() ? null :\n        scanAndLockForPut(key, hash, value);\n    V oldValue;\n    try {\n        // è¿™ä¸ªæ˜¯ segment å†…éƒ¨çš„æ•°ç»„\n        HashEntry<K,V>[] tab = table;\n        // å†åˆ©ç”¨ hash å€¼ï¼Œæ±‚åº”è¯¥æ”¾ç½®çš„æ•°ç»„ä¸‹æ ‡\n        int index = (tab.length - 1) & hash;\n        // first æ˜¯æ•°ç»„è¯¥ä½ç½®å¤„çš„é“¾è¡¨çš„è¡¨å¤´\n        HashEntry<K,V> first = entryAt(tab, index);\n \n        // ä¸‹é¢è¿™ä¸² for å¾ªç¯è™½ç„¶å¾ˆé•¿ï¼Œä¸è¿‡ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œæƒ³æƒ³è¯¥ä½ç½®æ²¡æœ‰ä»»ä½•å…ƒç´ å’Œå·²ç»å­˜åœ¨ä¸€ä¸ªé“¾è¡¨è¿™ä¸¤ç§æƒ…å†µ\n        for (HashEntry<K,V> e = first;;) {\n            if (e != null) {\n                K k;\n                if ((k = e.key) == key ||\n                    (e.hash == hash && key.equals(k))) {\n                    oldValue = e.value;\n                    if (!onlyIfAbsent) {\n                        // è¦†ç›–æ—§å€¼\n                        e.value = value;\n                        ++modCount;\n                    }\n                    break;\n                }\n                // ç»§ç»­é¡ºç€é“¾è¡¨èµ°\n                e = e.next;\n            }\n            else {\n                // node åˆ°åº•æ˜¯ä¸æ˜¯ nullï¼Œè¿™ä¸ªè¦çœ‹è·å–é”çš„è¿‡ç¨‹ï¼Œä¸è¿‡å’Œè¿™é‡Œéƒ½æ²¡æœ‰å…³ç³»ã€‚\n                // å¦‚æœä¸ä¸º nullï¼Œé‚£å°±ç›´æ¥å°†å®ƒè®¾ç½®ä¸ºé“¾è¡¨è¡¨å¤´ï¼›å¦‚æœæ˜¯nullï¼Œåˆå§‹åŒ–å¹¶è®¾ç½®ä¸ºé“¾è¡¨è¡¨å¤´ã€‚\n                if (node != null)\n                    node.setNext(first);\n                else\n                    node = new HashEntry<K,V>(hash, key, value, first);\n \n                int c = count + 1;\n                // å¦‚æœè¶…è¿‡äº†è¯¥ segment çš„é˜ˆå€¼ï¼Œè¿™ä¸ª segment éœ€è¦æ‰©å®¹\n                if (c > threshold && tab.length < MAXIMUM_CAPACITY)\n                    rehash(node); // æ‰©å®¹åé¢ä¹Ÿä¼šå…·ä½“åˆ†æ\n                else\n                    // æ²¡æœ‰è¾¾åˆ°é˜ˆå€¼ï¼Œå°† node æ”¾åˆ°æ•°ç»„ tab çš„ index ä½ç½®ï¼Œ\n                    // å…¶å®å°±æ˜¯å°†æ–°çš„èŠ‚ç‚¹è®¾ç½®æˆåŸé“¾è¡¨çš„è¡¨å¤´\n                    setEntryAt(tab, index, node);\n                ++modCount;\n                count = c;\n                oldValue = null;\n                break;\n            }\n        }\n    } finally {\n        // è§£é”\n        unlock();\n    }\n    return oldValue;\n}\n```\n\næ•´ä½“æµç¨‹è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œç”±äºæœ‰ç‹¬å é”çš„ä¿æŠ¤ï¼Œæ‰€ä»¥ segment å†…éƒ¨çš„æ“ä½œå¹¶ä¸å¤æ‚ã€‚è‡³äºè¿™é‡Œé¢çš„å¹¶å‘é—®é¢˜ï¼Œæˆ‘ä»¬ç¨åå†è¿›è¡Œä»‹ç»ã€‚\n\nåˆ°è¿™é‡Œ put æ“ä½œå°±ç»“æŸäº†ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¯´ä¸€è¯´å…¶ä¸­å‡ æ­¥å…³é”®çš„æ“ä½œã€‚\n\n###### åˆå§‹åŒ–æ§½: ensureSegment\n\nConcurrentHashMap åˆå§‹åŒ–çš„æ—¶å€™ä¼šåˆå§‹åŒ–ç¬¬ä¸€ä¸ªæ§½ segment[0]ï¼Œå¯¹äºå…¶ä»–æ§½æ¥è¯´ï¼Œåœ¨æ’å…¥ç¬¬ä¸€ä¸ªå€¼çš„æ—¶å€™è¿›è¡Œåˆå§‹åŒ–ã€‚\n\nè¿™é‡Œéœ€è¦è€ƒè™‘å¹¶å‘ï¼Œå› ä¸ºå¾ˆå¯èƒ½ä¼šæœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶è¿›æ¥åˆå§‹åŒ–åŒä¸€ä¸ªæ§½ segment[k]ï¼Œä¸è¿‡åªè¦æœ‰ä¸€ä¸ªæˆåŠŸäº†å°±å¯ä»¥ã€‚\n\n```\nprivate Segment<K,V> ensureSegment(int k) {\n    final Segment<K,V>[] ss = this.segments;\n    long u = (k << SSHIFT) + SBASE; // raw offset\n    Segment<K,V> seg;\n    if ((seg = (Segment<K,V>)UNSAFE.getObjectVolatile(ss, u)) == null) {\n        // è¿™é‡Œçœ‹åˆ°ä¸ºä»€ä¹ˆä¹‹å‰è¦åˆå§‹åŒ– segment[0] äº†ï¼Œ\n        // ä½¿ç”¨å½“å‰ segment[0] å¤„çš„æ•°ç»„é•¿åº¦å’Œè´Ÿè½½å› å­æ¥åˆå§‹åŒ– segment[k]\n        // ä¸ºä»€ä¹ˆè¦ç”¨â€œå½“å‰â€ï¼Œå› ä¸º segment[0] å¯èƒ½æ—©å°±æ‰©å®¹è¿‡äº†\n        Segment<K,V> proto = ss[0];\n        int cap = proto.table.length;\n        float lf = proto.loadFactor;\n        int threshold = (int)(cap * lf);\n \n        // åˆå§‹åŒ– segment[k] å†…éƒ¨çš„æ•°ç»„\n        HashEntry<K,V>[] tab = (HashEntry<K,V>[])new HashEntry[cap];\n        if ((seg = (Segment<K,V>)UNSAFE.getObjectVolatile(ss, u))\n            == null) { // å†æ¬¡æ£€æŸ¥ä¸€éè¯¥æ§½æ˜¯å¦è¢«å…¶ä»–çº¿ç¨‹åˆå§‹åŒ–äº†ã€‚\n \n            Segment<K,V> s = new Segment<K,V>(lf, threshold, tab);\n            // ä½¿ç”¨ while å¾ªç¯ï¼Œå†…éƒ¨ç”¨ CASï¼Œå½“å‰çº¿ç¨‹æˆåŠŸè®¾å€¼æˆ–å…¶ä»–çº¿ç¨‹æˆåŠŸè®¾å€¼åï¼Œé€€å‡º\n            while ((seg = (Segment<K,V>)UNSAFE.getObjectVolatile(ss, u))\n                   == null) {\n                if (UNSAFE.compareAndSwapObject(ss, u, null, seg = s))\n                    break;\n            }\n        }\n    }\n    return seg;\n}\n```\n\næ€»çš„æ¥è¯´ï¼ŒensureSegment(int k) æ¯”è¾ƒç®€å•ï¼Œå¯¹äºå¹¶å‘æ“ä½œä½¿ç”¨ CAS è¿›è¡Œæ§åˆ¶ã€‚\n\n> å¦‚æœå½“å‰çº¿ç¨‹ CAS å¤±è´¥ï¼Œè¿™é‡Œçš„ while å¾ªç¯æ˜¯ä¸ºäº†å°† seg èµ‹å€¼è¿”å›ã€‚\n\n###### è·å–å†™å…¥é”: scanAndLockForPut\n\nå‰é¢æˆ‘ä»¬çœ‹åˆ°ï¼Œåœ¨å¾€æŸä¸ª segment ä¸­ put çš„æ—¶å€™ï¼Œé¦–å…ˆä¼šè°ƒç”¨ node = tryLock() ? null : scanAndLockForPut(key, hash, value)ï¼Œä¹Ÿå°±æ˜¯è¯´å…ˆè¿›è¡Œä¸€æ¬¡ tryLock() å¿«é€Ÿè·å–è¯¥ segment çš„ç‹¬å é”ï¼Œå¦‚æœå¤±è´¥ï¼Œé‚£ä¹ˆè¿›å…¥åˆ° scanAndLockForPut è¿™ä¸ªæ–¹æ³•æ¥è·å–é”ã€‚\n\nä¸‹é¢æˆ‘ä»¬æ¥å…·ä½“åˆ†æè¿™ä¸ªæ–¹æ³•ä¸­æ˜¯æ€ä¹ˆæ§åˆ¶åŠ é”çš„ã€‚\n\n```\nprivate HashEntry<K,V> scanAndLockForPut(K key, int hash, V value) {\n    HashEntry<K,V> first = entryForHash(this, hash);\n    HashEntry<K,V> e = first;\n    HashEntry<K,V> node = null;\n    int retries = -1; // negative while locating node\n \n    // å¾ªç¯è·å–é”\n    while (!tryLock()) {\n        HashEntry<K,V> f; // to recheck first below\n        if (retries < 0) {\n            if (e == null) {\n                if (node == null) // speculatively create node\n                    // è¿›åˆ°è¿™é‡Œè¯´æ˜æ•°ç»„è¯¥ä½ç½®çš„é“¾è¡¨æ˜¯ç©ºçš„ï¼Œæ²¡æœ‰ä»»ä½•å…ƒç´ \n                    // å½“ç„¶ï¼Œè¿›åˆ°è¿™é‡Œçš„å¦ä¸€ä¸ªåŸå› æ˜¯ tryLock() å¤±è´¥ï¼Œæ‰€ä»¥è¯¥æ§½å­˜åœ¨å¹¶å‘ï¼Œä¸ä¸€å®šæ˜¯è¯¥ä½ç½®\n                    node = new HashEntry<K,V>(hash, key, value, null);\n                retries = 0;\n            }\n            else if (key.equals(e.key))\n                retries = 0;\n            else\n                // é¡ºç€é“¾è¡¨å¾€ä¸‹èµ°\n                e = e.next;\n        }\n        // é‡è¯•æ¬¡æ•°å¦‚æœè¶…è¿‡ MAX_SCAN_RETRIESï¼ˆå•æ ¸1å¤šæ ¸64ï¼‰ï¼Œé‚£ä¹ˆä¸æŠ¢äº†ï¼Œè¿›å…¥åˆ°é˜»å¡é˜Ÿåˆ—ç­‰å¾…é”\n        //    lock() æ˜¯é˜»å¡æ–¹æ³•ï¼Œç›´åˆ°è·å–é”åè¿”å›\n        else if (++retries > MAX_SCAN_RETRIES) {\n            lock();\n            break;\n        }\n        else if ((retries & 1) == 0 &&\n                 // è¿™ä¸ªæ—¶å€™æ˜¯æœ‰å¤§é—®é¢˜äº†ï¼Œé‚£å°±æ˜¯æœ‰æ–°çš„å…ƒç´ è¿›åˆ°äº†é“¾è¡¨ï¼Œæˆä¸ºäº†æ–°çš„è¡¨å¤´\n                 //     æ‰€ä»¥è¿™è¾¹çš„ç­–ç•¥æ˜¯ï¼Œç›¸å½“äºé‡æ–°èµ°ä¸€éè¿™ä¸ª scanAndLockForPut æ–¹æ³•\n                 (f = entryForHash(this, hash)) != first) {\n            e = first = f; // re-traverse if entry changed\n            retries = -1;\n        }\n    }\n    return node;\n}\n```\n\nè¿™ä¸ªæ–¹æ³•æœ‰ä¸¤ä¸ªå‡ºå£ï¼Œä¸€ä¸ªæ˜¯ tryLock() æˆåŠŸäº†ï¼Œå¾ªç¯ç»ˆæ­¢ï¼Œå¦ä¸€ä¸ªå°±æ˜¯é‡è¯•æ¬¡æ•°è¶…è¿‡äº† MAX_SCAN_RETRIESï¼Œè¿›åˆ° lock() æ–¹æ³•ï¼Œæ­¤æ–¹æ³•ä¼šé˜»å¡ç­‰å¾…ï¼Œç›´åˆ°æˆåŠŸæ‹¿åˆ°ç‹¬å é”ã€‚\n\nè¿™ä¸ªæ–¹æ³•å°±æ˜¯çœ‹ä¼¼å¤æ‚ï¼Œä½†æ˜¯å…¶å®å°±æ˜¯åšäº†ä¸€ä»¶äº‹ï¼Œé‚£å°±æ˜¯**è·å–è¯¥ segment çš„ç‹¬å é”**ï¼Œå¦‚æœéœ€è¦çš„è¯é¡ºä¾¿å®ä¾‹åŒ–äº†ä¸€ä¸‹ nodeã€‚\n\n###### æ‰©å®¹: rehash\n\né‡å¤ä¸€ä¸‹ï¼Œsegment æ•°ç»„ä¸èƒ½æ‰©å®¹ï¼Œæ‰©å®¹æ˜¯ segment æ•°ç»„æŸä¸ªä½ç½®å†…éƒ¨çš„æ•°ç»„ HashEntry\\[] è¿›è¡Œæ‰©å®¹ï¼Œæ‰©å®¹åï¼Œå®¹é‡ä¸ºåŸæ¥çš„ 2 å€ã€‚\n\né¦–å…ˆï¼Œæˆ‘ä»¬è¦å›é¡¾ä¸€ä¸‹è§¦å‘æ‰©å®¹çš„åœ°æ–¹ï¼Œput çš„æ—¶å€™ï¼Œå¦‚æœåˆ¤æ–­è¯¥å€¼çš„æ’å…¥ä¼šå¯¼è‡´è¯¥ segment çš„å…ƒç´ ä¸ªæ•°è¶…è¿‡é˜ˆå€¼ï¼Œé‚£ä¹ˆå…ˆè¿›è¡Œæ‰©å®¹ï¼Œå†æ’å€¼ï¼Œè¯»è€…è¿™ä¸ªæ—¶å€™å¯ä»¥å›å» put æ–¹æ³•çœ‹ä¸€çœ¼ã€‚\n\nè¯¥æ–¹æ³•ä¸éœ€è¦è€ƒè™‘å¹¶å‘ï¼Œå› ä¸ºåˆ°è¿™é‡Œçš„æ—¶å€™ï¼Œæ˜¯æŒæœ‰è¯¥ segment çš„ç‹¬å é”çš„ã€‚\n\n```\n// æ–¹æ³•å‚æ•°ä¸Šçš„ node æ˜¯è¿™æ¬¡æ‰©å®¹åï¼Œéœ€è¦æ·»åŠ åˆ°æ–°çš„æ•°ç»„ä¸­çš„æ•°æ®ã€‚\nprivate void rehash(HashEntry<K,V> node) {\n    HashEntry<K,V>[] oldTable = table;\n    int oldCapacity = oldTable.length;\n    // 2 å€\n    int newCapacity = oldCapacity << 1;\n    threshold = (int)(newCapacity * loadFactor);\n    // åˆ›å»ºæ–°æ•°ç»„\n    HashEntry<K,V>[] newTable =\n        (HashEntry<K,V>[]) new HashEntry[newCapacity];\n    // æ–°çš„æ©ç ï¼Œå¦‚ä» 16 æ‰©å®¹åˆ° 32ï¼Œé‚£ä¹ˆ sizeMask ä¸º 31ï¼Œå¯¹åº”äºŒè¿›åˆ¶ â€˜000...00011111â€™\n    int sizeMask = newCapacity - 1;\n \n    // éå†åŸæ•°ç»„ï¼Œè€å¥—è·¯ï¼Œå°†åŸæ•°ç»„ä½ç½® i å¤„çš„é“¾è¡¨æ‹†åˆ†åˆ° æ–°æ•°ç»„ä½ç½® i å’Œ i+oldCap ä¸¤ä¸ªä½ç½®\n    for (int i = 0; i < oldCapacity ; i++) {\n        // e æ˜¯é“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ \n        HashEntry<K,V> e = oldTable[i];\n        if (e != null) {\n            HashEntry<K,V> next = e.next;\n            // è®¡ç®—åº”è¯¥æ”¾ç½®åœ¨æ–°æ•°ç»„ä¸­çš„ä½ç½®ï¼Œ\n            // å‡è®¾åŸæ•°ç»„é•¿åº¦ä¸º 16ï¼Œe åœ¨ oldTable[3] å¤„ï¼Œé‚£ä¹ˆ idx åªå¯èƒ½æ˜¯ 3 æˆ–è€…æ˜¯ 3 + 16 = 19\n            int idx = e.hash & sizeMask;\n            if (next == null)   // è¯¥ä½ç½®å¤„åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œé‚£æ¯”è¾ƒå¥½åŠ\n                newTable[idx] = e;\n            else { // Reuse consecutive sequence at same slot\n                // e æ˜¯é“¾è¡¨è¡¨å¤´\n                HashEntry<K,V> lastRun = e;\n                // idx æ˜¯å½“å‰é“¾è¡¨çš„å¤´ç»“ç‚¹ e çš„æ–°ä½ç½®\n                int lastIdx = idx;\n \n                // ä¸‹é¢è¿™ä¸ª for å¾ªç¯ä¼šæ‰¾åˆ°ä¸€ä¸ª lastRun èŠ‚ç‚¹ï¼Œè¿™ä¸ªèŠ‚ç‚¹ä¹‹åçš„æ‰€æœ‰å…ƒç´ æ˜¯å°†è¦æ”¾åˆ°ä¸€èµ·çš„\n                for (HashEntry<K,V> last = next;\n                     last != null;\n                     last = last.next) {\n                    int k = last.hash & sizeMask;\n                    if (k != lastIdx) {\n                        lastIdx = k;\n                        lastRun = last;\n                    }\n                }\n                // å°† lastRun åŠå…¶ä¹‹åçš„æ‰€æœ‰èŠ‚ç‚¹ç»„æˆçš„è¿™ä¸ªé“¾è¡¨æ”¾åˆ° lastIdx è¿™ä¸ªä½ç½®\n                newTable[lastIdx] = lastRun;\n                // ä¸‹é¢çš„æ“ä½œæ˜¯å¤„ç† lastRun ä¹‹å‰çš„èŠ‚ç‚¹ï¼Œ\n                //    è¿™äº›èŠ‚ç‚¹å¯èƒ½åˆ†é…åœ¨å¦ä¸€ä¸ªé“¾è¡¨ä¸­ï¼Œä¹Ÿå¯èƒ½åˆ†é…åˆ°ä¸Šé¢çš„é‚£ä¸ªé“¾è¡¨ä¸­\n                for (HashEntry<K,V> p = e; p != lastRun; p = p.next) {\n                    V v = p.value;\n                    int h = p.hash;\n                    int k = h & sizeMask;\n                    HashEntry<K,V> n = newTable[k];\n                    newTable[k] = new HashEntry<K,V>(h, p.key, v, n);\n                }\n            }\n        }\n    }\n    // å°†æ–°æ¥çš„ node æ”¾åˆ°æ–°æ•°ç»„ä¸­åˆšåˆšçš„ ä¸¤ä¸ªé“¾è¡¨ä¹‹ä¸€ çš„ å¤´éƒ¨\n    int nodeIndex = node.hash & sizeMask; // add the new node\n    node.setNext(newTable[nodeIndex]);\n    newTable[nodeIndex] = node;\n    table = newTable;\n}\n```\n\nè¿™é‡Œçš„æ‰©å®¹æ¯”ä¹‹å‰çš„ HashMap è¦å¤æ‚ä¸€äº›ï¼Œä»£ç éš¾æ‡‚ä¸€ç‚¹ã€‚ä¸Šé¢æœ‰ä¸¤ä¸ªæŒ¨ç€çš„ for å¾ªç¯ï¼Œç¬¬ä¸€ä¸ª for æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ\n\nä»”ç»†ä¸€çœ‹å‘ç°ï¼Œå¦‚æœæ²¡æœ‰ç¬¬ä¸€ä¸ª for å¾ªç¯ï¼Œä¹Ÿæ˜¯å¯ä»¥å·¥ä½œçš„ï¼Œä½†æ˜¯ï¼Œè¿™ä¸ª for å¾ªç¯ä¸‹æ¥ï¼Œå¦‚æœ lastRun çš„åé¢è¿˜æœ‰æ¯”è¾ƒå¤šçš„èŠ‚ç‚¹ï¼Œé‚£ä¹ˆè¿™æ¬¡å°±æ˜¯å€¼å¾—çš„ã€‚å› ä¸ºæˆ‘ä»¬åªéœ€è¦å…‹éš† lastRun å‰é¢çš„èŠ‚ç‚¹ï¼Œåé¢çš„ä¸€ä¸²èŠ‚ç‚¹è·Ÿç€ lastRun èµ°å°±æ˜¯äº†ï¼Œä¸éœ€è¦åšä»»ä½•æ“ä½œã€‚\n\næˆ‘è§‰å¾— Doug Lea çš„è¿™ä¸ªæƒ³æ³•ä¹Ÿæ˜¯æŒºæœ‰æ„æ€çš„ï¼Œä¸è¿‡æ¯”è¾ƒåçš„æƒ…å†µå°±æ˜¯æ¯æ¬¡ lastRun éƒ½æ˜¯é“¾è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ æˆ–è€…å¾ˆé åçš„å…ƒç´ ï¼Œé‚£ä¹ˆè¿™æ¬¡éå†å°±æœ‰ç‚¹æµªè´¹äº†ã€‚**ä¸è¿‡ Doug Lea ä¹Ÿè¯´äº†ï¼Œæ ¹æ®ç»Ÿè®¡ï¼Œå¦‚æœä½¿ç”¨é»˜è®¤çš„é˜ˆå€¼ï¼Œå¤§çº¦åªæœ‰ 1/6 çš„èŠ‚ç‚¹éœ€è¦å…‹éš†ã€‚**\n\n#### get è¿‡ç¨‹åˆ†æ\n\nç›¸å¯¹äº put æ¥è¯´ï¼Œget çœŸçš„ä¸è¦å¤ªç®€å•ã€‚\n\n1. è®¡ç®— hash å€¼ï¼Œæ‰¾åˆ° segment æ•°ç»„ä¸­çš„å…·ä½“ä½ç½®ï¼Œæˆ–æˆ‘ä»¬å‰é¢ç”¨çš„â€œæ§½â€\n2. æ§½ä¸­ä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ ¹æ® hash æ‰¾åˆ°æ•°ç»„ä¸­å…·ä½“çš„ä½ç½®\n3. åˆ°è¿™é‡Œæ˜¯é“¾è¡¨äº†ï¼Œé¡ºç€é“¾è¡¨è¿›è¡ŒæŸ¥æ‰¾å³å¯\n\n```\npublic V get(Object key) {\n    Segment<K,V> s; // manually integrate access methods to reduce overhead\n    HashEntry<K,V>[] tab;\n    // 1. hash å€¼\n    int h = hash(key);\n    long u = (((h >>> segmentShift) & segmentMask) << SSHIFT) + SBASE;\n    // 2. æ ¹æ® hash æ‰¾åˆ°å¯¹åº”çš„ segment\n    if ((s = (Segment<K,V>)UNSAFE.getObjectVolatile(segments, u)) != null &&\n        (tab = s.table) != null) {\n        // 3. æ‰¾åˆ°segment å†…éƒ¨æ•°ç»„ç›¸åº”ä½ç½®çš„é“¾è¡¨ï¼Œéå†\n        for (HashEntry<K,V> e = (HashEntry<K,V>) UNSAFE.getObjectVolatile\n                 (tab, ((long)(((tab.length - 1) & h)) << TSHIFT) + TBASE);\n             e != null; e = e.next) {\n            K k;\n            if ((k = e.key) == key || (e.hash == h && key.equals(k)))\n                return e.value;\n        }\n    }\n    return null;\n}\n```\n\n#### å¹¶å‘é—®é¢˜åˆ†æ\n\nç°åœ¨æˆ‘ä»¬å·²ç»è¯´å®Œäº† put è¿‡ç¨‹å’Œ get è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° get è¿‡ç¨‹ä¸­æ˜¯æ²¡æœ‰åŠ é”çš„ï¼Œé‚£è‡ªç„¶æˆ‘ä»¬å°±éœ€è¦å»è€ƒè™‘å¹¶å‘é—®é¢˜ã€‚\n\næ·»åŠ èŠ‚ç‚¹çš„æ“ä½œ put å’Œåˆ é™¤èŠ‚ç‚¹çš„æ“ä½œ remove éƒ½æ˜¯è¦åŠ  segment ä¸Šçš„ç‹¬å é”çš„ï¼Œæ‰€ä»¥å®ƒä»¬ä¹‹é—´è‡ªç„¶ä¸ä¼šæœ‰é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘çš„é—®é¢˜å°±æ˜¯ get çš„æ—¶å€™åœ¨åŒä¸€ä¸ª segment ä¸­å‘ç”Ÿäº† put æˆ– remove æ“ä½œã€‚æ¨èé˜…è¯»ï¼š[30 ä¸ª Java é›†åˆé¢è¯•é—®é¢˜åŠç­”æ¡ˆ](https://mp.weixin.qq.com/s/Q5F604CUM_0x2co9mvADxw)ã€‚\n\n- **put æ“ä½œçš„çº¿ç¨‹å®‰å…¨æ€§**\n\n1. åˆå§‹åŒ–æ§½ï¼Œè¿™ä¸ªæˆ‘ä»¬ä¹‹å‰å°±è¯´è¿‡äº†ï¼Œä½¿ç”¨äº† CAS æ¥åˆå§‹åŒ– Segment ä¸­çš„æ•°ç»„ã€‚\n1. æ·»åŠ èŠ‚ç‚¹åˆ°é“¾è¡¨çš„æ“ä½œæ˜¯æ’å…¥åˆ°è¡¨å¤´çš„ï¼Œæ‰€ä»¥ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™ get æ“ä½œåœ¨é“¾è¡¨éå†çš„è¿‡ç¨‹å·²ç»åˆ°äº†ä¸­é—´ï¼Œæ˜¯ä¸ä¼šå½±å“çš„ã€‚å½“ç„¶ï¼Œå¦ä¸€ä¸ªå¹¶å‘é—®é¢˜å°±æ˜¯ get æ“ä½œåœ¨ put ä¹‹åï¼Œéœ€è¦ä¿è¯åˆšåˆšæ’å…¥è¡¨å¤´çš„èŠ‚ç‚¹è¢«è¯»å–ï¼Œè¿™ä¸ªä¾èµ–äº setEntryAt æ–¹æ³•ä¸­ä½¿ç”¨çš„ UNSAFE.putOrderedObjectã€‚\n3. æ‰©å®¹ã€‚æ‰©å®¹æ˜¯æ–°åˆ›å»ºäº†æ•°ç»„ï¼Œç„¶åè¿›è¡Œè¿ç§»æ•°æ®ï¼Œæœ€åé¢å°† newTable è®¾ç½®ç»™å±æ€§ tableã€‚æ‰€ä»¥ï¼Œå¦‚æœ get æ“ä½œæ­¤æ—¶ä¹Ÿåœ¨è¿›è¡Œï¼Œé‚£ä¹ˆä¹Ÿæ²¡å…³ç³»ï¼Œå¦‚æœ get å…ˆè¡Œï¼Œé‚£ä¹ˆå°±æ˜¯åœ¨æ—§çš„ table ä¸ŠåšæŸ¥è¯¢æ“ä½œï¼›è€Œ put å…ˆè¡Œï¼Œé‚£ä¹ˆ put æ“ä½œçš„å¯è§æ€§ä¿è¯å°±æ˜¯ table ä½¿ç”¨äº† volatile å…³é”®å­—ã€‚\n\n- **remove æ“ä½œçš„çº¿ç¨‹å®‰å…¨æ€§**\n\nremove æ“ä½œæˆ‘ä»¬æ²¡æœ‰åˆ†ææºç ï¼Œæ‰€ä»¥è¿™é‡Œè¯´çš„è¯»è€…æ„Ÿå…´è¶£çš„è¯è¿˜æ˜¯éœ€è¦åˆ°æºç ä¸­å»æ±‚å®ä¸€ä¸‹çš„ã€‚\n\nget æ“ä½œéœ€è¦éå†é“¾è¡¨ï¼Œä½†æ˜¯ remove æ“ä½œä¼šâ€ç ´åâ€é“¾è¡¨ã€‚\n\nå¦‚æœ remove ç ´åçš„èŠ‚ç‚¹ get æ“ä½œå·²ç»è¿‡å»äº†ï¼Œé‚£ä¹ˆè¿™é‡Œä¸å­˜åœ¨ä»»ä½•é—®é¢˜ã€‚\n\nå¦‚æœ remove å…ˆç ´åäº†ä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆ†ä¸¤ç§æƒ…å†µè€ƒè™‘ã€‚\n\n1ã€å¦‚æœæ­¤èŠ‚ç‚¹æ˜¯å¤´ç»“ç‚¹ï¼Œé‚£ä¹ˆéœ€è¦å°†å¤´ç»“ç‚¹çš„ next è®¾ç½®ä¸ºæ•°ç»„è¯¥ä½ç½®çš„å…ƒç´ ï¼Œtable è™½ç„¶ä½¿ç”¨äº† volatile ä¿®é¥°ï¼Œä½†æ˜¯ volatile å¹¶ä¸èƒ½æä¾›æ•°ç»„å†…éƒ¨æ“ä½œçš„å¯è§æ€§ä¿è¯ï¼Œæ‰€ä»¥æºç ä¸­ä½¿ç”¨äº† UNSAFE æ¥æ“ä½œæ•°ç»„ï¼Œè¯·çœ‹æ–¹æ³• setEntryAtã€‚\n\n2ã€å¦‚æœè¦åˆ é™¤çš„èŠ‚ç‚¹ä¸æ˜¯å¤´ç»“ç‚¹ï¼Œå®ƒä¼šå°†è¦åˆ é™¤èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹æ¥åˆ°å‰é©±èŠ‚ç‚¹ä¸­ï¼Œè¿™é‡Œçš„å¹¶å‘ä¿è¯å°±æ˜¯ next å±æ€§æ˜¯ volatile çš„ã€‚æ¨èé˜…è¯»ï¼š[å²ä¸Šæœ€å…¨ Java å¤šçº¿ç¨‹é¢è¯•é¢˜åŠç­”æ¡ˆ](https://mp.weixin.qq.com/s/0CI9od4DIxRrmOGFJw0SuQ)ã€‚\n\n## Java8 HashMap\n\nJava8 å¯¹ HashMap è¿›è¡Œäº†ä¸€äº›ä¿®æ”¹ï¼Œæœ€å¤§çš„ä¸åŒå°±æ˜¯åˆ©ç”¨äº†çº¢é»‘æ ‘ï¼Œæ‰€ä»¥å…¶ç”± **æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘** ç»„æˆã€‚\n\næ ¹æ® Java7 HashMap çš„ä»‹ç»ï¼Œæˆ‘ä»¬çŸ¥é“ï¼ŒæŸ¥æ‰¾çš„æ—¶å€™ï¼Œæ ¹æ® hash å€¼æˆ‘ä»¬èƒ½å¤Ÿå¿«é€Ÿå®šä½åˆ°æ•°ç»„çš„å…·ä½“ä¸‹æ ‡ï¼Œä½†æ˜¯ä¹‹åçš„è¯ï¼Œéœ€è¦é¡ºç€é“¾è¡¨ä¸€ä¸ªä¸ªæ¯”è¾ƒä¸‹å»æ‰èƒ½æ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„ï¼Œæ—¶é—´å¤æ‚åº¦å–å†³äºé“¾è¡¨çš„é•¿åº¦ï¼Œä¸º **O(n)**ã€‚\n\nä¸ºäº†é™ä½è¿™éƒ¨åˆ†çš„å¼€é”€ï¼Œåœ¨ Java8 ä¸­ï¼Œå½“é“¾è¡¨ä¸­çš„å…ƒç´ è¶…è¿‡äº† 8 ä¸ªä»¥åï¼Œä¼šå°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œåœ¨è¿™äº›ä½ç½®è¿›è¡ŒæŸ¥æ‰¾çš„æ—¶å€™å¯ä»¥é™ä½æ—¶é—´å¤æ‚åº¦ä¸º O(logN)ã€‚\n\næ¥ä¸€å¼ å›¾ç®€å•ç¤ºæ„ä¸€ä¸‹å§ï¼š\n\n![](http://qianniu.javastack.cn/18-12-4/75398751.jpg)\n\n> æ³¨æ„ï¼Œä¸Šå›¾æ˜¯ç¤ºæ„å›¾ï¼Œä¸»è¦æ˜¯æè¿°ç»“æ„ï¼Œä¸ä¼šè¾¾åˆ°è¿™ä¸ªçŠ¶æ€çš„ï¼Œå› ä¸ºè¿™ä¹ˆå¤šæ•°æ®çš„æ—¶å€™æ—©å°±æ‰©å®¹äº†ã€‚\n\nä¸‹é¢ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç”¨ä»£ç æ¥ä»‹ç»å§ï¼Œä¸ªäººæ„Ÿè§‰ï¼ŒJava8 çš„æºç å¯è¯»æ€§è¦å·®ä¸€äº›ï¼Œä¸è¿‡ç²¾ç®€ä¸€äº›ã€‚\n\nJava7 ä¸­ä½¿ç”¨ Entry æ¥ä»£è¡¨æ¯ä¸ª HashMap ä¸­çš„æ•°æ®èŠ‚ç‚¹ï¼ŒJava8 ä¸­ä½¿ç”¨ **Node**ï¼ŒåŸºæœ¬æ²¡æœ‰åŒºåˆ«ï¼Œéƒ½æ˜¯ keyï¼Œvalueï¼Œhash å’Œ next è¿™å››ä¸ªå±æ€§ï¼Œä¸è¿‡ï¼ŒNode åªèƒ½ç”¨äºé“¾è¡¨çš„æƒ…å†µï¼Œçº¢é»‘æ ‘çš„æƒ…å†µéœ€è¦ä½¿ç”¨ **TreeNode**ã€‚\n\næˆ‘ä»¬æ ¹æ®æ•°ç»„å…ƒç´ ä¸­ï¼Œç¬¬ä¸€ä¸ªèŠ‚ç‚¹æ•°æ®ç±»å‹æ˜¯ Node è¿˜æ˜¯ TreeNode æ¥åˆ¤æ–­è¯¥ä½ç½®ä¸‹æ˜¯é“¾è¡¨è¿˜æ˜¯çº¢é»‘æ ‘çš„ã€‚æ¨èé˜…è¯»ï¼š[30 ä¸ª Java é›†åˆé¢è¯•é—®é¢˜åŠç­”æ¡ˆ](https://mp.weixin.qq.com/s/Q5F604CUM_0x2co9mvADxw)ã€‚\n\n#### put è¿‡ç¨‹åˆ†æ\n\n```\npublic V put(K key, V value) {\n    return putVal(hash(key), key, value, false, true);\n}\n \n// ç¬¬ä¸‰ä¸ªå‚æ•° onlyIfAbsent å¦‚æœæ˜¯ trueï¼Œé‚£ä¹ˆåªæœ‰åœ¨ä¸å­˜åœ¨è¯¥ key æ—¶æ‰ä¼šè¿›è¡Œ put æ“ä½œ\n// ç¬¬å››ä¸ªå‚æ•° evict æˆ‘ä»¬è¿™é‡Œä¸å…³å¿ƒ\nfinal V putVal(int hash, K key, V value, boolean onlyIfAbsent,\n               boolean evict) {\n    Node<K,V>[] tab; Node<K,V> p; int n, i;\n    // ç¬¬ä¸€æ¬¡ put å€¼çš„æ—¶å€™ï¼Œä¼šè§¦å‘ä¸‹é¢çš„ resize()ï¼Œç±»ä¼¼ java7 çš„ç¬¬ä¸€æ¬¡ put ä¹Ÿè¦åˆå§‹åŒ–æ•°ç»„é•¿åº¦\n    // ç¬¬ä¸€æ¬¡ resize å’Œåç»­çš„æ‰©å®¹æœ‰äº›ä¸ä¸€æ ·ï¼Œå› ä¸ºè¿™æ¬¡æ˜¯æ•°ç»„ä» null åˆå§‹åŒ–åˆ°é»˜è®¤çš„ 16 æˆ–è‡ªå®šä¹‰çš„åˆå§‹å®¹é‡\n    if ((tab = table) == null || (n = tab.length) == 0)\n        n = (tab = resize()).length;\n    // æ‰¾åˆ°å…·ä½“çš„æ•°ç»„ä¸‹æ ‡ï¼Œå¦‚æœæ­¤ä½ç½®æ²¡æœ‰å€¼ï¼Œé‚£ä¹ˆç›´æ¥åˆå§‹åŒ–ä¸€ä¸‹ Node å¹¶æ”¾ç½®åœ¨è¿™ä¸ªä½ç½®å°±å¯ä»¥äº†\n    if ((p = tab[i = (n - 1) & hash]) == null)\n        tab[i] = newNode(hash, key, value, null);\n \n    else {// æ•°ç»„è¯¥ä½ç½®æœ‰æ•°æ®\n        Node<K,V> e; K k;\n        // é¦–å…ˆï¼Œåˆ¤æ–­è¯¥ä½ç½®çš„ç¬¬ä¸€ä¸ªæ•°æ®å’Œæˆ‘ä»¬è¦æ’å…¥çš„æ•°æ®ï¼Œkey æ˜¯ä¸æ˜¯\"ç›¸ç­‰\"ï¼Œå¦‚æœæ˜¯ï¼Œå–å‡ºè¿™ä¸ªèŠ‚ç‚¹\n        if (p.hash == hash &&\n            ((k = p.key) == key || (key != null && key.equals(k))))\n            e = p;\n        // å¦‚æœè¯¥èŠ‚ç‚¹æ˜¯ä»£è¡¨çº¢é»‘æ ‘çš„èŠ‚ç‚¹ï¼Œè°ƒç”¨çº¢é»‘æ ‘çš„æ’å€¼æ–¹æ³•ï¼Œæœ¬æ–‡ä¸å±•å¼€è¯´çº¢é»‘æ ‘\n        else if (p instanceof TreeNode)\n            e = ((TreeNode<K,V>)p).putTreeVal(this, tab, hash, key, value);\n        else {\n            // åˆ°è¿™é‡Œï¼Œè¯´æ˜æ•°ç»„è¯¥ä½ç½®ä¸Šæ˜¯ä¸€ä¸ªé“¾è¡¨\n            for (int binCount = 0; ; ++binCount) {\n                // æ’å…¥åˆ°é“¾è¡¨çš„æœ€åé¢(Java7 æ˜¯æ’å…¥åˆ°é“¾è¡¨çš„æœ€å‰é¢)\n                if ((e = p.next) == null) {\n                    p.next = newNode(hash, key, value, null);\n                    // TREEIFY_THRESHOLD ä¸º 8ï¼Œæ‰€ä»¥ï¼Œå¦‚æœæ–°æ’å…¥çš„å€¼æ˜¯é“¾è¡¨ä¸­çš„ç¬¬ 9 ä¸ª\n                    // ä¼šè§¦å‘ä¸‹é¢çš„ treeifyBinï¼Œä¹Ÿå°±æ˜¯å°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘\n                    if (binCount >= TREEIFY_THRESHOLD - 1) // -1 for 1st\n                        treeifyBin(tab, hash);\n                    break;\n                }\n                // å¦‚æœåœ¨è¯¥é“¾è¡¨ä¸­æ‰¾åˆ°äº†\"ç›¸ç­‰\"çš„ key(== æˆ– equals)\n                if (e.hash == hash &&\n                    ((k = e.key) == key || (key != null && key.equals(k))))\n                    // æ­¤æ—¶ breakï¼Œé‚£ä¹ˆ e ä¸ºé“¾è¡¨ä¸­[ä¸è¦æ’å…¥çš„æ–°å€¼çš„ key \"ç›¸ç­‰\"]çš„ node\n                    break;\n                p = e;\n            }\n        }\n        // e!=null è¯´æ˜å­˜åœ¨æ—§å€¼çš„keyä¸è¦æ’å…¥çš„key\"ç›¸ç­‰\"\n        // å¯¹äºæˆ‘ä»¬åˆ†æçš„putæ“ä½œï¼Œä¸‹é¢è¿™ä¸ª if å…¶å®å°±æ˜¯è¿›è¡Œ \"å€¼è¦†ç›–\"ï¼Œç„¶åè¿”å›æ—§å€¼\n        if (e != null) {\n            V oldValue = e.value;\n            if (!onlyIfAbsent || oldValue == null)\n                e.value = value;\n            afterNodeAccess(e);\n            return oldValue;\n        }\n    }\n    ++modCount;\n    // å¦‚æœ HashMap ç”±äºæ–°æ’å…¥è¿™ä¸ªå€¼å¯¼è‡´ size å·²ç»è¶…è¿‡äº†é˜ˆå€¼ï¼Œéœ€è¦è¿›è¡Œæ‰©å®¹\n    if (++size > threshold)\n        resize();\n    afterNodeInsertion(evict);\n    return null;\n}\n```\n\nå’Œ Java7 ç¨å¾®æœ‰ç‚¹ä¸ä¸€æ ·çš„åœ°æ–¹å°±æ˜¯ï¼ŒJava7 æ˜¯å…ˆæ‰©å®¹åæ’å…¥æ–°å€¼çš„ï¼ŒJava8 å…ˆæ’å€¼å†æ‰©å®¹ï¼Œä¸è¿‡è¿™ä¸ªä¸é‡è¦ã€‚\n\n###### æ•°ç»„æ‰©å®¹\n\nresize() æ–¹æ³•ç”¨äº**åˆå§‹åŒ–æ•°ç»„æˆ–æ•°ç»„æ‰©å®¹**ï¼Œæ¯æ¬¡æ‰©å®¹åï¼Œå®¹é‡ä¸ºåŸæ¥çš„ 2 å€ï¼Œå¹¶è¿›è¡Œæ•°æ®è¿ç§»ã€‚\n\n```\nfinal Node<K,V>[] resize() {\n    Node<K,V>[] oldTab = table;\n    int oldCap = (oldTab == null) ? 0 : oldTab.length;\n    int oldThr = threshold;\n    int newCap, newThr = 0;\n    if (oldCap > 0) { // å¯¹åº”æ•°ç»„æ‰©å®¹\n        if (oldCap >= MAXIMUM_CAPACITY) {\n            threshold = Integer.MAX_VALUE;\n            return oldTab;\n        }\n        // å°†æ•°ç»„å¤§å°æ‰©å¤§ä¸€å€\n        else if ((newCap = oldCap << 1) < MAXIMUM_CAPACITY &&\n                 oldCap >= DEFAULT_INITIAL_CAPACITY)\n            // å°†é˜ˆå€¼æ‰©å¤§ä¸€å€\n            newThr = oldThr << 1; // double threshold\n    }\n    else if (oldThr > 0) // å¯¹åº”ä½¿ç”¨ new HashMap(int initialCapacity) åˆå§‹åŒ–åï¼Œç¬¬ä¸€æ¬¡ put çš„æ—¶å€™\n        newCap = oldThr;\n    else {// å¯¹åº”ä½¿ç”¨ new HashMap() åˆå§‹åŒ–åï¼Œç¬¬ä¸€æ¬¡ put çš„æ—¶å€™\n        newCap = DEFAULT_INITIAL_CAPACITY;\n        newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);\n    }\n \n    if (newThr == 0) {\n        float ft = (float)newCap * loadFactor;\n        newThr = (newCap < MAXIMUM_CAPACITY && ft < (float)MAXIMUM_CAPACITY ?\n                  (int)ft : Integer.MAX_VALUE);\n    }\n    threshold = newThr;\n \n    // ç”¨æ–°çš„æ•°ç»„å¤§å°åˆå§‹åŒ–æ–°çš„æ•°ç»„\n    Node<K,V>[] newTab = (Node<K,V>[])new Node[newCap];\n    table = newTab; // å¦‚æœæ˜¯åˆå§‹åŒ–æ•°ç»„ï¼Œåˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œè¿”å› newTab å³å¯\n \n    if (oldTab != null) {\n        // å¼€å§‹éå†åŸæ•°ç»„ï¼Œè¿›è¡Œæ•°æ®è¿ç§»ã€‚\n        for (int j = 0; j < oldCap; ++j) {\n            Node<K,V> e;\n            if ((e = oldTab[j]) != null) {\n                oldTab[j] = null;\n                // å¦‚æœè¯¥æ•°ç»„ä½ç½®ä¸Šåªæœ‰å•ä¸ªå…ƒç´ ï¼Œé‚£å°±ç®€å•äº†ï¼Œç®€å•è¿ç§»è¿™ä¸ªå…ƒç´ å°±å¯ä»¥äº†\n                if (e.next == null)\n                    newTab[e.hash & (newCap - 1)] = e;\n                // å¦‚æœæ˜¯çº¢é»‘æ ‘ï¼Œå…·ä½“æˆ‘ä»¬å°±ä¸å±•å¼€äº†\n                else if (e instanceof TreeNode)\n                    ((TreeNode<K,V>)e).split(this, newTab, j, oldCap);\n                else { \n                    // è¿™å—æ˜¯å¤„ç†é“¾è¡¨çš„æƒ…å†µï¼Œ\n                    // éœ€è¦å°†æ­¤é“¾è¡¨æ‹†æˆä¸¤ä¸ªé“¾è¡¨ï¼Œæ”¾åˆ°æ–°çš„æ•°ç»„ä¸­ï¼Œå¹¶ä¸”ä¿ç•™åŸæ¥çš„å…ˆåé¡ºåº\n                    // loHeadã€loTail å¯¹åº”ä¸€æ¡é“¾è¡¨ï¼ŒhiHeadã€hiTail å¯¹åº”å¦ä¸€æ¡é“¾è¡¨ï¼Œä»£ç è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„\n                    Node<K,V> loHead = null, loTail = null;\n                    Node<K,V> hiHead = null, hiTail = null;\n                    Node<K,V> next;\n                    do {\n                        next = e.next;\n                        if ((e.hash & oldCap) == 0) {\n                            if (loTail == null)\n                                loHead = e;\n                            else\n                                loTail.next = e;\n                            loTail = e;\n                        }\n                        else {\n                            if (hiTail == null)\n                                hiHead = e;\n                            else\n                                hiTail.next = e;\n                            hiTail = e;\n                        }\n                    } while ((e = next) != null);\n                    if (loTail != null) {\n                        loTail.next = null;\n                        // ç¬¬ä¸€æ¡é“¾è¡¨\n                        newTab[j] = loHead;\n                    }\n                    if (hiTail != null) {\n                        hiTail.next = null;\n                        // ç¬¬äºŒæ¡é“¾è¡¨çš„æ–°çš„ä½ç½®æ˜¯ j + oldCapï¼Œè¿™ä¸ªå¾ˆå¥½ç†è§£\n                        newTab[j + oldCap] = hiHead;\n                    }\n                }\n            }\n        }\n    }\n    return newTab;\n}\n```\n\n#### get è¿‡ç¨‹åˆ†æ\n\nç›¸å¯¹äº put æ¥è¯´ï¼Œget çœŸçš„å¤ªç®€å•äº†ã€‚\n\n1. è®¡ç®— key çš„ hash å€¼ï¼Œæ ¹æ® hash å€¼æ‰¾åˆ°å¯¹åº”æ•°ç»„ä¸‹æ ‡: hash & (length-1)\n2. åˆ¤æ–­æ•°ç»„è¯¥ä½ç½®å¤„çš„å…ƒç´ æ˜¯å¦åˆšå¥½å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„ï¼Œå¦‚æœä¸æ˜¯ï¼Œèµ°ç¬¬ä¸‰æ­¥\n3. åˆ¤æ–­è¯¥å…ƒç´ ç±»å‹æ˜¯å¦æ˜¯ TreeNodeï¼Œå¦‚æœæ˜¯ï¼Œç”¨çº¢é»‘æ ‘çš„æ–¹æ³•å–æ•°æ®ï¼Œå¦‚æœä¸æ˜¯ï¼Œèµ°ç¬¬å››æ­¥\n4. éå†é“¾è¡¨ï¼Œç›´åˆ°æ‰¾åˆ°ç›¸ç­‰(==æˆ–equals)çš„ key.\n\n```\npublic V get(Object key) {\n    Node<K,V> e;\n    return (e = getNode(hash(key), key)) == null ? null : e.value;\n}\n```\n\n```\nfinal Node<K,V> getNode(int hash, Object key) {\n    Node<K,V>[] tab; Node<K,V> first, e; int n; K k;\n    if ((tab = table) != null && (n = tab.length) > 0 &&\n        (first = tab[(n - 1) & hash]) != null) {\n        // åˆ¤æ–­ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æ˜¯ä¸æ˜¯å°±æ˜¯éœ€è¦çš„\n        if (first.hash == hash && // always check first node\n            ((k = first.key) == key || (key != null && key.equals(k))))\n            return first;\n        if ((e = first.next) != null) {\n            // åˆ¤æ–­æ˜¯å¦æ˜¯çº¢é»‘æ ‘\n            if (first instanceof TreeNode)\n                return ((TreeNode<K,V>)first).getTreeNode(hash, key);\n \n            // é“¾è¡¨éå†\n            do {\n                if (e.hash == hash &&\n                    ((k = e.key) == key || (key != null && key.equals(k))))\n                    return e;\n            } while ((e = e.next) != null);\n        }\n    }\n    return null;\n}\n```\n\n## Java8 ConcurrentHashMap\n\nJava7 ä¸­å®ç°çš„ ConcurrentHashMap è¯´å®è¯è¿˜æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼ŒJava8 å¯¹ ConcurrentHashMap è¿›è¡Œäº†æ¯”è¾ƒå¤§çš„æ”¹åŠ¨ã€‚å»ºè®®è¯»è€…å¯ä»¥å‚è€ƒ Java8 ä¸­ HashMap ç›¸å¯¹äº Java7 HashMap çš„æ”¹åŠ¨ï¼Œå¯¹äº ConcurrentHashMapï¼ŒJava8 ä¹Ÿå¼•å…¥äº†çº¢é»‘æ ‘ã€‚\n\nè¯´å®è¯ï¼ŒJava8 ConcurrentHashMap æºç çœŸå¿ƒä¸ç®€å•ï¼Œæœ€éš¾çš„åœ¨äºæ‰©å®¹ï¼Œæ•°æ®è¿ç§»æ“ä½œä¸å®¹æ˜“çœ‹æ‡‚ã€‚\n\næˆ‘ä»¬å…ˆç”¨ä¸€ä¸ªç¤ºæ„å›¾æ¥æè¿°ä¸‹å…¶ç»“æ„ï¼š\n\n![](http://qianniu.javastack.cn/18-12-4/335817.jpg)\n\nç»“æ„ä¸Šå’Œ Java8 çš„ HashMap åŸºæœ¬ä¸Šä¸€æ ·ï¼Œä¸è¿‡å®ƒè¦ä¿è¯çº¿ç¨‹å®‰å…¨æ€§ï¼Œæ‰€ä»¥åœ¨æºç ä¸Šç¡®å®è¦å¤æ‚ä¸€äº›ã€‚æ¨èé˜…è¯»ï¼š[å‡ ç§çº¿ç¨‹å®‰å…¨çš„Mapè§£æ](https://mp.weixin.qq.com/s/5Y5_6qn2g6kIVmQia_0R6g)ã€‚\n\n#### åˆå§‹åŒ–\n\n```\n// è¿™æ„é€ å‡½æ•°é‡Œï¼Œä»€ä¹ˆéƒ½ä¸å¹²\npublic ConcurrentHashMap() {\n}\npublic ConcurrentHashMap(int initialCapacity) {\n    if (initialCapacity < 0)\n        throw new IllegalArgumentException();\n    int cap = ((initialCapacity >= (MAXIMUM_CAPACITY >>> 1)) ?\n               MAXIMUM_CAPACITY :\n               tableSizeFor(initialCapacity + (initialCapacity >>> 1) + 1));\n    this.sizeCtl = cap;\n}\n```\n\nè¿™ä¸ªåˆå§‹åŒ–æ–¹æ³•æœ‰ç‚¹æ„æ€ï¼Œé€šè¿‡æä¾›åˆå§‹å®¹é‡ï¼Œè®¡ç®—äº† sizeCtlï¼ŒsizeCtl = ã€ (1.5 * initialCapacity + 1)ï¼Œç„¶åå‘ä¸Šå–æœ€è¿‘çš„ 2 çš„ n æ¬¡æ–¹ã€‘ã€‚å¦‚ initialCapacity ä¸º 10ï¼Œé‚£ä¹ˆå¾—åˆ° sizeCtl ä¸º 16ï¼Œå¦‚æœ initialCapacity ä¸º 11ï¼Œå¾—åˆ° sizeCtl ä¸º 32ã€‚\n\nsizeCtl è¿™ä¸ªå±æ€§ä½¿ç”¨çš„åœºæ™¯å¾ˆå¤šï¼Œä¸è¿‡åªè¦è·Ÿç€æ–‡ç« çš„æ€è·¯æ¥ï¼Œå°±ä¸ä¼šè¢«å®ƒææ™•äº†ã€‚\n\nå¦‚æœä½ çˆ±æŠ˜è…¾ï¼Œä¹Ÿå¯ä»¥çœ‹ä¸‹å¦ä¸€ä¸ªæœ‰ä¸‰ä¸ªå‚æ•°çš„æ„é€ æ–¹æ³•ï¼Œè¿™é‡Œæˆ‘å°±ä¸è¯´äº†ï¼Œå¤§éƒ¨åˆ†æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨æ— å‚æ„é€ å‡½æ•°è¿›è¡Œå®ä¾‹åŒ–ï¼Œæˆ‘ä»¬ä¹ŸæŒ‰ç…§è¿™ä¸ªæ€è·¯æ¥è¿›è¡Œæºç åˆ†æå§ã€‚\n\n#### put è¿‡ç¨‹åˆ†æ\n\nä»”ç»†åœ°ä¸€è¡Œä¸€è¡Œä»£ç çœ‹ä¸‹å»ï¼š\n\n```\npublic V put(K key, V value) {\n    return putVal(key, value, false);\n}\nfinal V putVal(K key, V value, boolean onlyIfAbsent) {\n    if (key == null || value == null) throw new NullPointerException();\n    // å¾—åˆ° hash å€¼\n    int hash = spread(key.hashCode());\n    // ç”¨äºè®°å½•ç›¸åº”é“¾è¡¨çš„é•¿åº¦\n    int binCount = 0;\n    for (Node<K,V>[] tab = table;;) {\n        Node<K,V> f; int n, i, fh;\n        // å¦‚æœæ•°ç»„\"ç©º\"ï¼Œè¿›è¡Œæ•°ç»„åˆå§‹åŒ–\n        if (tab == null || (n = tab.length) == 0)\n            // åˆå§‹åŒ–æ•°ç»„ï¼Œåé¢ä¼šè¯¦ç»†ä»‹ç»\n            tab = initTable();\n \n        // æ‰¾è¯¥ hash å€¼å¯¹åº”çš„æ•°ç»„ä¸‹æ ‡ï¼Œå¾—åˆ°ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ f\n        else if ((f = tabAt(tab, i = (n - 1) & hash)) == null) {\n            // å¦‚æœæ•°ç»„è¯¥ä½ç½®ä¸ºç©ºï¼Œ\n            //    ç”¨ä¸€æ¬¡ CAS æ“ä½œå°†è¿™ä¸ªæ–°å€¼æ”¾å…¥å…¶ä¸­å³å¯ï¼Œè¿™ä¸ª put æ“ä½œå·®ä¸å¤šå°±ç»“æŸäº†ï¼Œå¯ä»¥æ‹‰åˆ°æœ€åé¢äº†\n            //          å¦‚æœ CAS å¤±è´¥ï¼Œé‚£å°±æ˜¯æœ‰å¹¶å‘æ“ä½œï¼Œè¿›åˆ°ä¸‹ä¸€ä¸ªå¾ªç¯å°±å¥½äº†\n            if (casTabAt(tab, i, null,\n                         new Node<K,V>(hash, key, value, null)))\n                break;                   // no lock when adding to empty bin\n        }\n        // hash å±…ç„¶å¯ä»¥ç­‰äº MOVEDï¼Œè¿™ä¸ªéœ€è¦åˆ°åé¢æ‰èƒ½çœ‹æ˜ç™½ï¼Œä¸è¿‡ä»åå­—ä¸Šä¹Ÿèƒ½çŒœåˆ°ï¼Œè‚¯å®šæ˜¯å› ä¸ºåœ¨æ‰©å®¹\n        else if ((fh = f.hash) == MOVED)\n            // å¸®åŠ©æ•°æ®è¿ç§»ï¼Œè¿™ä¸ªç­‰åˆ°çœ‹å®Œæ•°æ®è¿ç§»éƒ¨åˆ†çš„ä»‹ç»åï¼Œå†ç†è§£è¿™ä¸ªå°±å¾ˆç®€å•äº†\n            tab = helpTransfer(tab, f);\n \n        else { // åˆ°è¿™é‡Œå°±æ˜¯è¯´ï¼Œf æ˜¯è¯¥ä½ç½®çš„å¤´ç»“ç‚¹ï¼Œè€Œä¸”ä¸ä¸ºç©º\n \n            V oldVal = null;\n            // è·å–æ•°ç»„è¯¥ä½ç½®çš„å¤´ç»“ç‚¹çš„ç›‘è§†å™¨é”\n            synchronized (f) {\n                if (tabAt(tab, i) == f) {\n                    if (fh >= 0) { // å¤´ç»“ç‚¹çš„ hash å€¼å¤§äº 0ï¼Œè¯´æ˜æ˜¯é“¾è¡¨\n                        // ç”¨äºç´¯åŠ ï¼Œè®°å½•é“¾è¡¨çš„é•¿åº¦\n                        binCount = 1;\n                        // éå†é“¾è¡¨\n                        for (Node<K,V> e = f;; ++binCount) {\n                            K ek;\n                            // å¦‚æœå‘ç°äº†\"ç›¸ç­‰\"çš„ keyï¼Œåˆ¤æ–­æ˜¯å¦è¦è¿›è¡Œå€¼è¦†ç›–ï¼Œç„¶åä¹Ÿå°±å¯ä»¥ break äº†\n                            if (e.hash == hash &&\n                                ((ek = e.key) == key ||\n                                 (ek != null && key.equals(ek)))) {\n                                oldVal = e.val;\n                                if (!onlyIfAbsent)\n                                    e.val = value;\n                                break;\n                            }\n                            // åˆ°äº†é“¾è¡¨çš„æœ€æœ«ç«¯ï¼Œå°†è¿™ä¸ªæ–°å€¼æ”¾åˆ°é“¾è¡¨çš„æœ€åé¢\n                            Node<K,V> pred = e;\n                            if ((e = e.next) == null) {\n                                pred.next = new Node<K,V>(hash, key,\n                                                          value, null);\n                                break;\n                            }\n                        }\n                    }\n                    else if (f instanceof TreeBin) { // çº¢é»‘æ ‘\n                        Node<K,V> p;\n                        binCount = 2;\n                        // è°ƒç”¨çº¢é»‘æ ‘çš„æ’å€¼æ–¹æ³•æ’å…¥æ–°èŠ‚ç‚¹\n                        if ((p = ((TreeBin<K,V>)f).putTreeVal(hash, key,\n                                                       value)) != null) {\n                            oldVal = p.val;\n                            if (!onlyIfAbsent)\n                                p.val = value;\n                        }\n                    }\n                }\n            }\n            // binCount != 0 è¯´æ˜ä¸Šé¢åœ¨åšé“¾è¡¨æ“ä½œ\n            if (binCount != 0) {\n                // åˆ¤æ–­æ˜¯å¦è¦å°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œä¸´ç•Œå€¼å’Œ HashMap ä¸€æ ·ï¼Œä¹Ÿæ˜¯ 8\n                if (binCount >= TREEIFY_THRESHOLD)\n                    // è¿™ä¸ªæ–¹æ³•å’Œ HashMap ä¸­ç¨å¾®æœ‰ä¸€ç‚¹ç‚¹ä¸åŒï¼Œé‚£å°±æ˜¯å®ƒä¸æ˜¯ä¸€å®šä¼šè¿›è¡Œçº¢é»‘æ ‘è½¬æ¢ï¼Œ\n                    // å¦‚æœå½“å‰æ•°ç»„çš„é•¿åº¦å°äº 64ï¼Œé‚£ä¹ˆä¼šé€‰æ‹©è¿›è¡Œæ•°ç»„æ‰©å®¹ï¼Œè€Œä¸æ˜¯è½¬æ¢ä¸ºçº¢é»‘æ ‘\n                    //    å…·ä½“æºç æˆ‘ä»¬å°±ä¸çœ‹äº†ï¼Œæ‰©å®¹éƒ¨åˆ†åé¢è¯´\n                    treeifyBin(tab, i);\n                if (oldVal != null)\n                    return oldVal;\n                break;\n            }\n        }\n    }\n    // \n    addCount(1L, binCount);\n    return null;\n}\n```\n\nput çš„ä¸»æµç¨‹çœ‹å®Œäº†ï¼Œä½†æ˜¯è‡³å°‘ç•™ä¸‹äº†å‡ ä¸ªé—®é¢˜ï¼Œç¬¬ä¸€ä¸ªæ˜¯åˆå§‹åŒ–ï¼Œç¬¬äºŒä¸ªæ˜¯æ‰©å®¹ï¼Œç¬¬ä¸‰ä¸ªæ˜¯å¸®åŠ©æ•°æ®è¿ç§»ï¼Œè¿™äº›æˆ‘ä»¬éƒ½ä¼šåœ¨åé¢è¿›è¡Œä¸€ä¸€ä»‹ç»ã€‚\n\n###### åˆå§‹åŒ–æ•°ç»„ï¼šinitTable\n\nè¿™ä¸ªæ¯”è¾ƒç®€å•ï¼Œä¸»è¦å°±æ˜¯åˆå§‹åŒ–ä¸€ä¸ªåˆé€‚å¤§å°çš„æ•°ç»„ï¼Œç„¶åä¼šè®¾ç½® sizeCtlã€‚\n\nåˆå§‹åŒ–æ–¹æ³•ä¸­çš„å¹¶å‘é—®é¢˜æ˜¯é€šè¿‡å¯¹ sizeCtl è¿›è¡Œä¸€ä¸ª CAS æ“ä½œæ¥æ§åˆ¶çš„ã€‚\n\n```\nprivate final Node<K,V>[] initTable() {\n    Node<K,V>[] tab; int sc;\n    while ((tab = table) == null || tab.length == 0) {\n        // åˆå§‹åŒ–çš„\"åŠŸåŠ³\"è¢«å…¶ä»–çº¿ç¨‹\"æŠ¢å»\"äº†\n        if ((sc = sizeCtl) < 0)\n            Thread.yield(); // lost initialization race; just spin\n        // CAS ä¸€ä¸‹ï¼Œå°† sizeCtl è®¾ç½®ä¸º -1ï¼Œä»£è¡¨æŠ¢åˆ°äº†é”\n        else if (U.compareAndSwapInt(this, SIZECTL, sc, -1)) {\n            try {\n                if ((tab = table) == null || tab.length == 0) {\n                    // DEFAULT_CAPACITY é»˜è®¤åˆå§‹å®¹é‡æ˜¯ 16\n                    int n = (sc > 0) ? sc : DEFAULT_CAPACITY;\n                    // åˆå§‹åŒ–æ•°ç»„ï¼Œé•¿åº¦ä¸º 16 æˆ–åˆå§‹åŒ–æ—¶æä¾›çš„é•¿åº¦\n                    Node<K,V>[] nt = (Node<K,V>[])new Node<?,?>[n];\n                    // å°†è¿™ä¸ªæ•°ç»„èµ‹å€¼ç»™ tableï¼Œtable æ˜¯ volatile çš„\n                    table = tab = nt;\n                    // å¦‚æœ n ä¸º 16 çš„è¯ï¼Œé‚£ä¹ˆè¿™é‡Œ sc = 12\n                    // å…¶å®å°±æ˜¯ 0.75 * n\n                    sc = n - (n >>> 2);\n                }\n            } finally {\n                // è®¾ç½® sizeCtl ä¸º scï¼Œæˆ‘ä»¬å°±å½“æ˜¯ 12 å§\n                sizeCtl = sc;\n            }\n            break;\n        }\n    }\n    return tab;\n}\n```\n\n###### é“¾è¡¨è½¬çº¢é»‘æ ‘: treeifyBin\n\nå‰é¢æˆ‘ä»¬åœ¨ put æºç åˆ†æä¹Ÿè¯´è¿‡ï¼ŒtreeifyBin ä¸ä¸€å®šå°±ä¼šè¿›è¡Œçº¢é»‘æ ‘è½¬æ¢ï¼Œä¹Ÿå¯èƒ½æ˜¯ä»…ä»…åšæ•°ç»„æ‰©å®¹ã€‚æˆ‘ä»¬è¿˜æ˜¯è¿›è¡Œæºç åˆ†æå§ã€‚\n\n```\nprivate final void treeifyBin(Node<K,V>[] tab, int index) {\n    Node<K,V> b; int n, sc;\n    if (tab != null) {\n        // MIN_TREEIFY_CAPACITY ä¸º 64\n        // æ‰€ä»¥ï¼Œå¦‚æœæ•°ç»„é•¿åº¦å°äº 64 çš„æ—¶å€™ï¼Œå…¶å®ä¹Ÿå°±æ˜¯ 32 æˆ–è€… 16 æˆ–è€…æ›´å°çš„æ—¶å€™ï¼Œä¼šè¿›è¡Œæ•°ç»„æ‰©å®¹\n        if ((n = tab.length) < MIN_TREEIFY_CAPACITY)\n            // åé¢æˆ‘ä»¬å†è¯¦ç»†åˆ†æè¿™ä¸ªæ–¹æ³•\n            tryPresize(n << 1);\n        // b æ˜¯å¤´ç»“ç‚¹\n        else if ((b = tabAt(tab, index)) != null && b.hash >= 0) {\n            // åŠ é”\n            synchronized (b) {\n \n                if (tabAt(tab, index) == b) {\n                    // ä¸‹é¢å°±æ˜¯éå†é“¾è¡¨ï¼Œå»ºç«‹ä¸€é¢—çº¢é»‘æ ‘\n                    TreeNode<K,V> hd = null, tl = null;\n                    for (Node<K,V> e = b; e != null; e = e.next) {\n                        TreeNode<K,V> p =\n                            new TreeNode<K,V>(e.hash, e.key, e.val,\n                                              null, null);\n                        if ((p.prev = tl) == null)\n                            hd = p;\n                        else\n                            tl.next = p;\n                        tl = p;\n                    }\n                    // å°†çº¢é»‘æ ‘è®¾ç½®åˆ°æ•°ç»„ç›¸åº”ä½ç½®ä¸­\n                    setTabAt(tab, index, new TreeBin<K,V>(hd));\n                }\n            }\n        }\n    }\n}\n```\n\n\n#### æ‰©å®¹ï¼štryPresize\n\nå¦‚æœè¯´ Java8 ConcurrentHashMap çš„æºç ä¸ç®€å•ï¼Œé‚£ä¹ˆè¯´çš„å°±æ˜¯æ‰©å®¹æ“ä½œå’Œè¿ç§»æ“ä½œã€‚\n\nè¿™ä¸ªæ–¹æ³•è¦å®Œå®Œå…¨å…¨çœ‹æ‡‚è¿˜éœ€è¦çœ‹ä¹‹åçš„ transfer æ–¹æ³•ï¼Œè¯»è€…åº”è¯¥æå‰çŸ¥é“è¿™ç‚¹ã€‚\n\nè¿™é‡Œçš„æ‰©å®¹ä¹Ÿæ˜¯åšç¿»å€æ‰©å®¹çš„ï¼Œæ‰©å®¹åæ•°ç»„å®¹é‡ä¸ºåŸæ¥çš„ 2 å€ã€‚\n\n```\n// é¦–å…ˆè¦è¯´æ˜çš„æ˜¯ï¼Œæ–¹æ³•å‚æ•° size ä¼ è¿›æ¥çš„æ—¶å€™å°±å·²ç»ç¿»äº†å€äº†\nprivate final void tryPresize(int size) {\n    // cï¼šsize çš„ 1.5 å€ï¼Œå†åŠ  1ï¼Œå†å¾€ä¸Šå–æœ€è¿‘çš„ 2 çš„ n æ¬¡æ–¹ã€‚\n    int c = (size >= (MAXIMUM_CAPACITY >>> 1)) ? MAXIMUM_CAPACITY :\n        tableSizeFor(size + (size >>> 1) + 1);\n    int sc;\n    while ((sc = sizeCtl) >= 0) {\n        Node<K,V>[] tab = table; int n;\n \n        // è¿™ä¸ª if åˆ†æ”¯å’Œä¹‹å‰è¯´çš„åˆå§‹åŒ–æ•°ç»„çš„ä»£ç åŸºæœ¬ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥ä¸ç”¨ç®¡è¿™å—ä»£ç \n        if (tab == null || (n = tab.length) == 0) {\n            n = (sc > c) ? sc : c;\n            if (U.compareAndSwapInt(this, SIZECTL, sc, -1)) {\n                try {\n                    if (table == tab) {\n                        @SuppressWarnings(\"unchecked\")\n                        Node<K,V>[] nt = (Node<K,V>[])new Node<?,?>[n];\n                        table = nt;\n                        sc = n - (n >>> 2); // 0.75 * n\n                    }\n                } finally {\n                    sizeCtl = sc;\n                }\n            }\n        }\n        else if (c <= sc || n >= MAXIMUM_CAPACITY)\n            break;\n        else if (tab == table) {\n            // æˆ‘æ²¡çœ‹æ‡‚ rs çš„çœŸæ­£å«ä¹‰æ˜¯ä»€ä¹ˆï¼Œä¸è¿‡ä¹Ÿå…³ç³»ä¸å¤§\n            int rs = resizeStamp(n);\n \n            if (sc < 0) {\n                Node<K,V>[] nt;\n                if ((sc >>> RESIZE_STAMP_SHIFT) != rs || sc == rs + 1 ||\n                    sc == rs + MAX_RESIZERS || (nt = nextTable) == null ||\n                    transferIndex <= 0)\n                    break;\n                // 2. ç”¨ CAS å°† sizeCtl åŠ  1ï¼Œç„¶åæ‰§è¡Œ transfer æ–¹æ³•\n                //    æ­¤æ—¶ nextTab ä¸ä¸º null\n                if (U.compareAndSwapInt(this, SIZECTL, sc, sc + 1))\n                    transfer(tab, nt);\n            }\n            // 1. å°† sizeCtl è®¾ç½®ä¸º (rs << RESIZE_STAMP_SHIFT) + 2)\n            //     æˆ‘æ˜¯æ²¡çœ‹æ‡‚è¿™ä¸ªå€¼çœŸæ­£çš„æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿä¸è¿‡å¯ä»¥è®¡ç®—å‡ºæ¥çš„æ˜¯ï¼Œç»“æœæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤§çš„è´Ÿæ•°\n            //  è°ƒç”¨ transfer æ–¹æ³•ï¼Œæ­¤æ—¶ nextTab å‚æ•°ä¸º null\n            else if (U.compareAndSwapInt(this, SIZECTL, sc,\n                                         (rs << RESIZE_STAMP_SHIFT) + 2))\n                transfer(tab, null);\n        }\n    }\n}\n```\n\nè¿™ä¸ªæ–¹æ³•çš„æ ¸å¿ƒåœ¨äº sizeCtl å€¼çš„æ“ä½œï¼Œé¦–å…ˆå°†å…¶è®¾ç½®ä¸ºä¸€ä¸ªè´Ÿæ•°ï¼Œç„¶åæ‰§è¡Œ transfer(tab, null)ï¼Œå†ä¸‹ä¸€ä¸ªå¾ªç¯å°† sizeCtl åŠ  1ï¼Œå¹¶æ‰§è¡Œ transfer(tab, nt)ï¼Œä¹‹åå¯èƒ½æ˜¯ç»§ç»­ sizeCtl åŠ  1ï¼Œå¹¶æ‰§è¡Œ transfer(tab, nt)ã€‚\n\næ‰€ä»¥ï¼Œå¯èƒ½çš„æ“ä½œå°±æ˜¯æ‰§è¡Œ **1 æ¬¡ transfer(tab, null) + å¤šæ¬¡ transfer(tab, nt)**ï¼Œè¿™é‡Œæ€ä¹ˆç»“æŸå¾ªç¯çš„éœ€è¦çœ‹å®Œ transfer æºç æ‰æ¸…æ¥šã€‚æ¨èé˜…è¯»ï¼š[30 ä¸ª Java é›†åˆé¢è¯•é—®é¢˜åŠç­”æ¡ˆ](https://mp.weixin.qq.com/s/Q5F604CUM_0x2co9mvADxw)ã€‚\n\n###### æ•°æ®è¿ç§»ï¼štransfer\n\nä¸‹é¢è¿™ä¸ªæ–¹æ³•å¾ˆç‚¹é•¿ï¼Œå°†åŸæ¥çš„ tab æ•°ç»„çš„å…ƒç´ è¿ç§»åˆ°æ–°çš„ nextTab æ•°ç»„ä¸­ã€‚\n\nè™½ç„¶æˆ‘ä»¬ä¹‹å‰è¯´çš„ tryPresize æ–¹æ³•ä¸­å¤šæ¬¡è°ƒç”¨ transfer ä¸æ¶‰åŠå¤šçº¿ç¨‹ï¼Œä½†æ˜¯è¿™ä¸ª transfer æ–¹æ³•å¯ä»¥åœ¨å…¶ä»–åœ°æ–¹è¢«è°ƒç”¨ï¼Œå…¸å‹åœ°ï¼Œæˆ‘ä»¬ä¹‹å‰åœ¨è¯´ put æ–¹æ³•çš„æ—¶å€™å°±è¯´è¿‡äº†ï¼Œè¯·å¾€ä¸Šçœ‹ put æ–¹æ³•ï¼Œæ˜¯ä¸æ˜¯æœ‰ä¸ªåœ°æ–¹è°ƒç”¨äº† helpTransfer æ–¹æ³•ï¼ŒhelpTransfer æ–¹æ³•ä¼šè°ƒç”¨ transfer æ–¹æ³•çš„ã€‚\n\næ­¤æ–¹æ³•æ”¯æŒå¤šçº¿ç¨‹æ‰§è¡Œï¼Œå¤–å›´è°ƒç”¨æ­¤æ–¹æ³•çš„æ—¶å€™ï¼Œä¼šä¿è¯ç¬¬ä¸€ä¸ªå‘èµ·æ•°æ®è¿ç§»çš„çº¿ç¨‹ï¼ŒnextTab å‚æ•°ä¸º nullï¼Œä¹‹åå†è°ƒç”¨æ­¤æ–¹æ³•çš„æ—¶å€™ï¼ŒnextTab ä¸ä¼šä¸º nullã€‚\n\né˜…è¯»æºç ä¹‹å‰ï¼Œå…ˆè¦ç†è§£å¹¶å‘æ“ä½œçš„æœºåˆ¶ã€‚åŸæ•°ç»„é•¿åº¦ä¸º nï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰ n ä¸ªè¿ç§»ä»»åŠ¡ï¼Œè®©æ¯ä¸ªçº¿ç¨‹æ¯æ¬¡è´Ÿè´£ä¸€ä¸ªå°ä»»åŠ¡æ˜¯æœ€ç®€å•çš„ï¼Œæ¯åšå®Œä¸€ä¸ªä»»åŠ¡å†æ£€æµ‹æ˜¯å¦æœ‰å…¶ä»–æ²¡åšå®Œçš„ä»»åŠ¡ï¼Œå¸®åŠ©è¿ç§»å°±å¯ä»¥äº†ï¼Œè€Œ Doug Lea ä½¿ç”¨äº†ä¸€ä¸ª strideï¼Œç®€å•ç†è§£å°±æ˜¯æ­¥é•¿ï¼Œæ¯ä¸ªçº¿ç¨‹æ¯æ¬¡è´Ÿè´£è¿ç§»å…¶ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œå¦‚æ¯æ¬¡è¿ç§» 16 ä¸ªå°ä»»åŠ¡ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªå…¨å±€çš„è°ƒåº¦è€…æ¥å®‰æ’å“ªä¸ªçº¿ç¨‹æ‰§è¡Œå“ªå‡ ä¸ªä»»åŠ¡ï¼Œè¿™ä¸ªå°±æ˜¯å±æ€§ transferIndex çš„ä½œç”¨ã€‚\n\nç¬¬ä¸€ä¸ªå‘èµ·æ•°æ®è¿ç§»çš„çº¿ç¨‹ä¼šå°† transferIndex æŒ‡å‘åŸæ•°ç»„æœ€åçš„ä½ç½®ï¼Œç„¶åä»åå¾€å‰çš„ stride ä¸ªä»»åŠ¡å±äºç¬¬ä¸€ä¸ªçº¿ç¨‹ï¼Œç„¶åå°† transferIndex æŒ‡å‘æ–°çš„ä½ç½®ï¼Œå†å¾€å‰çš„ stride ä¸ªä»»åŠ¡å±äºç¬¬äºŒä¸ªçº¿ç¨‹ï¼Œä¾æ­¤ç±»æ¨ã€‚å½“ç„¶ï¼Œè¿™é‡Œè¯´çš„ç¬¬äºŒä¸ªçº¿ç¨‹ä¸æ˜¯çœŸçš„ä¸€å®šæŒ‡ä»£äº†ç¬¬äºŒä¸ªçº¿ç¨‹ï¼Œä¹Ÿå¯ä»¥æ˜¯åŒä¸€ä¸ªçº¿ç¨‹ï¼Œè¿™ä¸ªè¯»è€…åº”è¯¥èƒ½ç†è§£å§ã€‚å…¶å®å°±æ˜¯å°†ä¸€ä¸ªå¤§çš„è¿ç§»ä»»åŠ¡åˆ†ä¸ºäº†ä¸€ä¸ªä¸ªä»»åŠ¡åŒ…ã€‚\n\n```\nprivate final void transfer(Node<K,V>[] tab, Node<K,V>[] nextTab) {\n    int n = tab.length, stride;\n \n    // stride åœ¨å•æ ¸ä¸‹ç›´æ¥ç­‰äº nï¼Œå¤šæ ¸æ¨¡å¼ä¸‹ä¸º (n>>>3)/NCPUï¼Œæœ€å°å€¼æ˜¯ 16\n    // stride å¯ä»¥ç†è§£ä¸ºâ€æ­¥é•¿â€œï¼Œæœ‰ n ä¸ªä½ç½®æ˜¯éœ€è¦è¿›è¡Œè¿ç§»çš„ï¼Œ\n    //   å°†è¿™ n ä¸ªä»»åŠ¡åˆ†ä¸ºå¤šä¸ªä»»åŠ¡åŒ…ï¼Œæ¯ä¸ªä»»åŠ¡åŒ…æœ‰ stride ä¸ªä»»åŠ¡\n    if ((stride = (NCPU > 1) ? (n >>> 3) / NCPU : n) < MIN_TRANSFER_STRIDE)\n        stride = MIN_TRANSFER_STRIDE; // subdivide range\n \n    // å¦‚æœ nextTab ä¸º nullï¼Œå…ˆè¿›è¡Œä¸€æ¬¡åˆå§‹åŒ–\n    //    å‰é¢æˆ‘ä»¬è¯´äº†ï¼Œå¤–å›´ä¼šä¿è¯ç¬¬ä¸€ä¸ªå‘èµ·è¿ç§»çš„çº¿ç¨‹è°ƒç”¨æ­¤æ–¹æ³•æ—¶ï¼Œå‚æ•° nextTab ä¸º null\n    //       ä¹‹åå‚ä¸è¿ç§»çš„çº¿ç¨‹è°ƒç”¨æ­¤æ–¹æ³•æ—¶ï¼ŒnextTab ä¸ä¼šä¸º null\n    if (nextTab == null) {\n        try {\n            // å®¹é‡ç¿»å€\n            Node<K,V>[] nt = (Node<K,V>[])new Node<?,?>[n << 1];\n            nextTab = nt;\n        } catch (Throwable ex) {      // try to cope with OOME\n            sizeCtl = Integer.MAX_VALUE;\n            return;\n        }\n        // nextTable æ˜¯ ConcurrentHashMap ä¸­çš„å±æ€§\n        nextTable = nextTab;\n        // transferIndex ä¹Ÿæ˜¯ ConcurrentHashMap çš„å±æ€§ï¼Œç”¨äºæ§åˆ¶è¿ç§»çš„ä½ç½®\n        transferIndex = n;\n    }\n \n    int nextn = nextTab.length;\n \n    // ForwardingNode ç¿»è¯‘è¿‡æ¥å°±æ˜¯æ­£åœ¨è¢«è¿ç§»çš„ Node\n    // è¿™ä¸ªæ„é€ æ–¹æ³•ä¼šç”Ÿæˆä¸€ä¸ªNodeï¼Œkeyã€value å’Œ next éƒ½ä¸º nullï¼Œå…³é”®æ˜¯ hash ä¸º MOVED\n    // åé¢æˆ‘ä»¬ä¼šçœ‹åˆ°ï¼ŒåŸæ•°ç»„ä¸­ä½ç½® i å¤„çš„èŠ‚ç‚¹å®Œæˆè¿ç§»å·¥ä½œåï¼Œ\n    //    å°±ä¼šå°†ä½ç½® i å¤„è®¾ç½®ä¸ºè¿™ä¸ª ForwardingNodeï¼Œç”¨æ¥å‘Šè¯‰å…¶ä»–çº¿ç¨‹è¯¥ä½ç½®å·²ç»å¤„ç†è¿‡äº†\n    //    æ‰€ä»¥å®ƒå…¶å®ç›¸å½“äºæ˜¯ä¸€ä¸ªæ ‡å¿—ã€‚\n    ForwardingNode<K,V> fwd = new ForwardingNode<K,V>(nextTab);\n \n \n    // advance æŒ‡çš„æ˜¯åšå®Œäº†ä¸€ä¸ªä½ç½®çš„è¿ç§»å·¥ä½œï¼Œå¯ä»¥å‡†å¤‡åšä¸‹ä¸€ä¸ªä½ç½®çš„äº†\n    boolean advance = true;\n    boolean finishing = false; // to ensure sweep before committing nextTab\n \n    /*\n     * ä¸‹é¢è¿™ä¸ª for å¾ªç¯ï¼Œæœ€éš¾ç†è§£çš„åœ¨å‰é¢ï¼Œè€Œè¦çœ‹æ‡‚å®ƒä»¬ï¼Œåº”è¯¥å…ˆçœ‹æ‡‚åé¢çš„ï¼Œç„¶åå†å€’å›æ¥çœ‹\n     * \n     */\n \n    // i æ˜¯ä½ç½®ç´¢å¼•ï¼Œbound æ˜¯è¾¹ç•Œï¼Œæ³¨æ„æ˜¯ä»åå¾€å‰\n    for (int i = 0, bound = 0;;) {\n        Node<K,V> f; int fh;\n \n        // ä¸‹é¢è¿™ä¸ª while çœŸçš„æ˜¯ä¸å¥½ç†è§£\n        // advance ä¸º true è¡¨ç¤ºå¯ä»¥è¿›è¡Œä¸‹ä¸€ä¸ªä½ç½®çš„è¿ç§»äº†\n        //   ç®€å•ç†è§£ç»“å±€ï¼ši æŒ‡å‘äº† transferIndexï¼Œbound æŒ‡å‘äº† transferIndex-stride\n        while (advance) {\n            int nextIndex, nextBound;\n            if (--i >= bound || finishing)\n                advance = false;\n \n            // å°† transferIndex å€¼èµ‹ç»™ nextIndex\n            // è¿™é‡Œ transferIndex ä¸€æ—¦å°äºç­‰äº 0ï¼Œè¯´æ˜åŸæ•°ç»„çš„æ‰€æœ‰ä½ç½®éƒ½æœ‰ç›¸åº”çš„çº¿ç¨‹å»å¤„ç†äº†\n            else if ((nextIndex = transferIndex) <= 0) {\n                i = -1;\n                advance = false;\n            }\n            else if (U.compareAndSwapInt\n                     (this, TRANSFERINDEX, nextIndex,\n                      nextBound = (nextIndex > stride ?\n                                   nextIndex - stride : 0))) {\n                // çœ‹æ‹¬å·ä¸­çš„ä»£ç ï¼ŒnextBound æ˜¯è¿™æ¬¡è¿ç§»ä»»åŠ¡çš„è¾¹ç•Œï¼Œæ³¨æ„ï¼Œæ˜¯ä»åå¾€å‰\n                bound = nextBound;\n                i = nextIndex - 1;\n                advance = false;\n            }\n        }\n        if (i < 0 || i >= n || i + n >= nextn) {\n            int sc;\n            if (finishing) {\n                // æ‰€æœ‰çš„è¿ç§»æ“ä½œå·²ç»å®Œæˆ\n                nextTable = null;\n                // å°†æ–°çš„ nextTab èµ‹å€¼ç»™ table å±æ€§ï¼Œå®Œæˆè¿ç§»\n                table = nextTab;\n                // é‡æ–°è®¡ç®— sizeCtlï¼šn æ˜¯åŸæ•°ç»„é•¿åº¦ï¼Œæ‰€ä»¥ sizeCtl å¾—å‡ºçš„å€¼å°†æ˜¯æ–°æ•°ç»„é•¿åº¦çš„ 0.75 å€\n                sizeCtl = (n << 1) - (n >>> 1);\n                return;\n            }\n \n            // ä¹‹å‰æˆ‘ä»¬è¯´è¿‡ï¼ŒsizeCtl åœ¨è¿ç§»å‰ä¼šè®¾ç½®ä¸º (rs << RESIZE_STAMP_SHIFT) + 2\n            // ç„¶åï¼Œæ¯æœ‰ä¸€ä¸ªçº¿ç¨‹å‚ä¸è¿ç§»å°±ä¼šå°† sizeCtl åŠ  1ï¼Œ\n            // è¿™é‡Œä½¿ç”¨ CAS æ“ä½œå¯¹ sizeCtl è¿›è¡Œå‡ 1ï¼Œä»£è¡¨åšå®Œäº†å±äºè‡ªå·±çš„ä»»åŠ¡\n            if (U.compareAndSwapInt(this, SIZECTL, sc = sizeCtl, sc - 1)) {\n                // ä»»åŠ¡ç»“æŸï¼Œæ–¹æ³•é€€å‡º\n                if ((sc - 2) != resizeStamp(n) << RESIZE_STAMP_SHIFT)\n                    return;\n \n                // åˆ°è¿™é‡Œï¼Œè¯´æ˜ (sc - 2) == resizeStamp(n) << RESIZE_STAMP_SHIFTï¼Œ\n                // ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰€æœ‰çš„è¿ç§»ä»»åŠ¡éƒ½åšå®Œäº†ï¼Œä¹Ÿå°±ä¼šè¿›å…¥åˆ°ä¸Šé¢çš„ if(finishing){} åˆ†æ”¯äº†\n                finishing = advance = true;\n                i = n; // recheck before commit\n            }\n        }\n        // å¦‚æœä½ç½® i å¤„æ˜¯ç©ºçš„ï¼Œæ²¡æœ‰ä»»ä½•èŠ‚ç‚¹ï¼Œé‚£ä¹ˆæ”¾å…¥åˆšåˆšåˆå§‹åŒ–çš„ ForwardingNode â€ç©ºèŠ‚ç‚¹â€œ\n        else if ((f = tabAt(tab, i)) == null)\n            advance = casTabAt(tab, i, null, fwd);\n        // è¯¥ä½ç½®å¤„æ˜¯ä¸€ä¸ª ForwardingNodeï¼Œä»£è¡¨è¯¥ä½ç½®å·²ç»è¿ç§»è¿‡äº†\n        else if ((fh = f.hash) == MOVED)\n            advance = true; // already processed\n        else {\n            // å¯¹æ•°ç»„è¯¥ä½ç½®å¤„çš„ç»“ç‚¹åŠ é”ï¼Œå¼€å§‹å¤„ç†æ•°ç»„è¯¥ä½ç½®å¤„çš„è¿ç§»å·¥ä½œ\n            synchronized (f) {\n                if (tabAt(tab, i) == f) {\n                    Node<K,V> ln, hn;\n                    // å¤´ç»“ç‚¹çš„ hash å¤§äº 0ï¼Œè¯´æ˜æ˜¯é“¾è¡¨çš„ Node èŠ‚ç‚¹\n                    if (fh >= 0) {\n                        // ä¸‹é¢è¿™ä¸€å—å’Œ Java7 ä¸­çš„ ConcurrentHashMap è¿ç§»æ˜¯å·®ä¸å¤šçš„ï¼Œ\n                        // éœ€è¦å°†é“¾è¡¨ä¸€åˆ†ä¸ºäºŒï¼Œ\n                        //   æ‰¾åˆ°åŸé“¾è¡¨ä¸­çš„ lastRunï¼Œç„¶å lastRun åŠå…¶ä¹‹åçš„èŠ‚ç‚¹æ˜¯ä¸€èµ·è¿›è¡Œè¿ç§»çš„\n                        //   lastRun ä¹‹å‰çš„èŠ‚ç‚¹éœ€è¦è¿›è¡Œå…‹éš†ï¼Œç„¶ååˆ†åˆ°ä¸¤ä¸ªé“¾è¡¨ä¸­\n                        int runBit = fh & n;\n                        Node<K,V> lastRun = f;\n                        for (Node<K,V> p = f.next; p != null; p = p.next) {\n                            int b = p.hash & n;\n                            if (b != runBit) {\n                                runBit = b;\n                                lastRun = p;\n                            }\n                        }\n                        if (runBit == 0) {\n                            ln = lastRun;\n                            hn = null;\n                        }\n                        else {\n                            hn = lastRun;\n                            ln = null;\n                        }\n                        for (Node<K,V> p = f; p != lastRun; p = p.next) {\n                            int ph = p.hash; K pk = p.key; V pv = p.val;\n                            if ((ph & n) == 0)\n                                ln = new Node<K,V>(ph, pk, pv, ln);\n                            else\n                                hn = new Node<K,V>(ph, pk, pv, hn);\n                        }\n                        // å…¶ä¸­çš„ä¸€ä¸ªé“¾è¡¨æ”¾åœ¨æ–°æ•°ç»„çš„ä½ç½® i\n                        setTabAt(nextTab, i, ln);\n                        // å¦ä¸€ä¸ªé“¾è¡¨æ”¾åœ¨æ–°æ•°ç»„çš„ä½ç½® i+n\n                        setTabAt(nextTab, i + n, hn);\n                        // å°†åŸæ•°ç»„è¯¥ä½ç½®å¤„è®¾ç½®ä¸º fwdï¼Œä»£è¡¨è¯¥ä½ç½®å·²ç»å¤„ç†å®Œæ¯•ï¼Œ\n                        //    å…¶ä»–çº¿ç¨‹ä¸€æ—¦çœ‹åˆ°è¯¥ä½ç½®çš„ hash å€¼ä¸º MOVEDï¼Œå°±ä¸ä¼šè¿›è¡Œè¿ç§»äº†\n                        setTabAt(tab, i, fwd);\n                        // advance è®¾ç½®ä¸º trueï¼Œä»£è¡¨è¯¥ä½ç½®å·²ç»è¿ç§»å®Œæ¯•\n                        advance = true;\n                    }\n                    else if (f instanceof TreeBin) {\n                        // çº¢é»‘æ ‘çš„è¿ç§»\n                        TreeBin<K,V> t = (TreeBin<K,V>)f;\n                        TreeNode<K,V> lo = null, loTail = null;\n                        TreeNode<K,V> hi = null, hiTail = null;\n                        int lc = 0, hc = 0;\n                        for (Node<K,V> e = t.first; e != null; e = e.next) {\n                            int h = e.hash;\n                            TreeNode<K,V> p = new TreeNode<K,V>\n                                (h, e.key, e.val, null, null);\n                            if ((h & n) == 0) {\n                                if ((p.prev = loTail) == null)\n                                    lo = p;\n                                else\n                                    loTail.next = p;\n                                loTail = p;\n                                ++lc;\n                            }\n                            else {\n                                if ((p.prev = hiTail) == null)\n                                    hi = p;\n                                else\n                                    hiTail.next = p;\n                                hiTail = p;\n                                ++hc;\n                            }\n                        }\n                        // å¦‚æœä¸€åˆ†ä¸ºäºŒåï¼ŒèŠ‚ç‚¹æ•°å°‘äº 8ï¼Œé‚£ä¹ˆå°†çº¢é»‘æ ‘è½¬æ¢å›é“¾è¡¨\n                        ln = (lc <= UNTREEIFY_THRESHOLD) ? untreeify(lo) :\n                            (hc != 0) ? new TreeBin<K,V>(lo) : t;\n                        hn = (hc <= UNTREEIFY_THRESHOLD) ? untreeify(hi) :\n                            (lc != 0) ? new TreeBin<K,V>(hi) : t;\n \n                        // å°† ln æ”¾ç½®åœ¨æ–°æ•°ç»„çš„ä½ç½® i\n                        setTabAt(nextTab, i, ln);\n                        // å°† hn æ”¾ç½®åœ¨æ–°æ•°ç»„çš„ä½ç½® i+n\n                        setTabAt(nextTab, i + n, hn);\n                        // å°†åŸæ•°ç»„è¯¥ä½ç½®å¤„è®¾ç½®ä¸º fwdï¼Œä»£è¡¨è¯¥ä½ç½®å·²ç»å¤„ç†å®Œæ¯•ï¼Œ\n                        //    å…¶ä»–çº¿ç¨‹ä¸€æ—¦çœ‹åˆ°è¯¥ä½ç½®çš„ hash å€¼ä¸º MOVEDï¼Œå°±ä¸ä¼šè¿›è¡Œè¿ç§»äº†\n                        setTabAt(tab, i, fwd);\n                        // advance è®¾ç½®ä¸º trueï¼Œä»£è¡¨è¯¥ä½ç½®å·²ç»è¿ç§»å®Œæ¯•\n                        advance = true;\n                    }\n                }\n            }\n        }\n    }\n}\n```\n\nè¯´åˆ°åº•ï¼Œtransfer è¿™ä¸ªæ–¹æ³•å¹¶æ²¡æœ‰å®ç°æ‰€æœ‰çš„è¿ç§»ä»»åŠ¡ï¼Œæ¯æ¬¡è°ƒç”¨è¿™ä¸ªæ–¹æ³•åªå®ç°äº† transferIndex å¾€å‰ stride ä¸ªä½ç½®çš„è¿ç§»å·¥ä½œï¼Œå…¶ä»–çš„éœ€è¦ç”±å¤–å›´æ¥æ§åˆ¶ã€‚\n\nè¿™ä¸ªæ—¶å€™ï¼Œå†å›å»ä»”ç»†çœ‹ tryPresize æ–¹æ³•å¯èƒ½å°±ä¼šæ›´åŠ æ¸…æ™°ä¸€äº›äº†ã€‚\n\n#### get è¿‡ç¨‹åˆ†æ\n\nget æ–¹æ³•ä»æ¥éƒ½æ˜¯æœ€ç®€å•çš„ï¼Œè¿™é‡Œä¹Ÿä¸ä¾‹å¤–ï¼š\n\n1.è®¡ç®— hash å€¼\n\n2.æ ¹æ® hash å€¼æ‰¾åˆ°æ•°ç»„å¯¹åº”ä½ç½®: (n â€“ 1) & h\n\n3.æ ¹æ®è¯¥ä½ç½®å¤„ç»“ç‚¹æ€§è´¨è¿›è¡Œç›¸åº”æŸ¥æ‰¾\n\n- å¦‚æœè¯¥ä½ç½®ä¸º nullï¼Œé‚£ä¹ˆç›´æ¥è¿”å› null å°±å¯ä»¥äº†\n- å¦‚æœè¯¥ä½ç½®å¤„çš„èŠ‚ç‚¹åˆšå¥½å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„ï¼Œè¿”å›è¯¥èŠ‚ç‚¹çš„å€¼å³å¯\n- å¦‚æœè¯¥ä½ç½®èŠ‚ç‚¹çš„ hash å€¼å°äº 0ï¼Œè¯´æ˜æ­£åœ¨æ‰©å®¹ï¼Œæˆ–è€…æ˜¯çº¢é»‘æ ‘ï¼Œåé¢æˆ‘ä»¬å†ä»‹ç» find æ–¹æ³•\n- å¦‚æœä»¥ä¸Š 3 æ¡éƒ½ä¸æ»¡è¶³ï¼Œé‚£å°±æ˜¯é“¾è¡¨ï¼Œè¿›è¡Œéå†æ¯”å¯¹å³å¯ã€‚\n\n```\npublic V get(Object key) {\n    Node<K,V>[] tab; Node<K,V> e, p; int n, eh; K ek;\n    int h = spread(key.hashCode());\n    if ((tab = table) != null && (n = tab.length) > 0 &&\n        (e = tabAt(tab, (n - 1) & h)) != null) {\n        // åˆ¤æ–­å¤´ç»“ç‚¹æ˜¯å¦å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„èŠ‚ç‚¹\n        if ((eh = e.hash) == h) {\n            if ((ek = e.key) == key || (ek != null && key.equals(ek)))\n                return e.val;\n        }\n        // å¦‚æœå¤´ç»“ç‚¹çš„ hash å°äº 0ï¼Œè¯´æ˜ æ­£åœ¨æ‰©å®¹ï¼Œæˆ–è€…è¯¥ä½ç½®æ˜¯çº¢é»‘æ ‘\n        else if (eh < 0)\n            // å‚è€ƒ ForwardingNode.find(int h, Object k) å’Œ TreeBin.find(int h, Object k)\n            return (p = e.find(h, key)) != null ? p.val : null;\n \n        // éå†é“¾è¡¨\n        while ((e = e.next) != null) {\n            if (e.hash == h &&\n                ((ek = e.key) == key || (ek != null && key.equals(ek))))\n                return e.val;\n        }\n    }\n    return null;\n}\n```\n\nç®€å•è¯´ä¸€å¥ï¼Œæ­¤æ–¹æ³•çš„å¤§éƒ¨åˆ†å†…å®¹éƒ½å¾ˆç®€å•ï¼Œåªæœ‰æ­£å¥½ç¢°åˆ°æ‰©å®¹çš„æƒ…å†µï¼ŒForwardingNode.find(int h, Object k) ç¨å¾®å¤æ‚ä¸€äº›ï¼Œä¸è¿‡åœ¨äº†è§£äº†æ•°æ®è¿ç§»çš„è¿‡ç¨‹åï¼Œè¿™ä¸ªä¹Ÿå°±ä¸éš¾äº†ï¼Œæ‰€ä»¥é™äºç¯‡å¹…è¿™é‡Œä¹Ÿä¸å±•å¼€è¯´äº†ã€‚\n\n## æ€»ç»“\n\nå…¶å®ä¹Ÿä¸æ˜¯å¾ˆéš¾å˜›ï¼Œè™½ç„¶æ²¡æœ‰åƒä¹‹å‰çš„ AQS å’Œçº¿ç¨‹æ± ä¸€æ ·ä¸€è¡Œä¸€è¡Œæºç è¿›è¡Œåˆ†æï¼Œä½†è¿˜æ˜¯æŠŠæ‰€æœ‰åˆå­¦è€…å¯èƒ½ä¼šç³Šæ¶‚çš„åœ°æ–¹éƒ½è¿›è¡Œäº†æ·±å…¥çš„ä»‹ç»ï¼Œåªè¦æ˜¯ç¨å¾®æœ‰ç‚¹åŸºç¡€çš„è¯»è€…ï¼Œåº”è¯¥æ˜¯å¾ˆå®¹æ˜“å°±èƒ½çœ‹æ‡‚ HashMap å’Œ ConcurrentHashMap æºç äº†ã€‚\n\nçœ‹æºç ä¸ç®—æ˜¯ç›®çš„å§ï¼Œæ·±å…¥åœ°äº†è§£ Doug Lea çš„è®¾è®¡æ€è·¯ï¼Œæˆ‘è§‰å¾—è¿˜æŒºæœ‰è¶£çš„ï¼Œå¤§å¸ˆå°±æ˜¯å¤§å¸ˆï¼Œä»£ç å†™å¾—çœŸçš„æ˜¯å¥½å•Šã€‚\n\næˆ‘å‘ç°å¾ˆå¤šäººéƒ½ä»¥ä¸ºæˆ‘å†™åšå®¢ä¸»è¦æ˜¯æºç åˆ†æï¼Œè¯´çœŸçš„ï¼Œæˆ‘å¯¹äºæºç åˆ†ææ²¡æœ‰é‚£ä¹ˆå¤§çƒ­æƒ…ï¼Œä¸»è¦éƒ½æ˜¯ä¸ºäº†ç”¨æºç è¯´äº‹ç½¢äº†ï¼Œå¯èƒ½ä¹‹åçš„æ–‡ç« è¿˜æ˜¯ä¼šæœ‰æ¯”è¾ƒå¤šçš„æºç åˆ†ææˆåˆ†ï¼Œå¤§å®¶è¯¥æ€ä¹ˆçœ‹å°±æ€ä¹ˆçœ‹å§ã€‚\n\nä¸è¦è„¸åœ°è‡ªä»¥ä¸ºæœ¬æ–‡çš„è´¨é‡è¿˜æ˜¯æŒºé«˜çš„ï¼Œä¿¡æ¯é‡æ¯”è¾ƒå¤§ï¼Œå¦‚æœä½ è§‰å¾—æœ‰å†™å¾—ä¸å¥½çš„åœ°æ–¹ï¼Œæˆ–è€…è¯´çœ‹å®Œæœ¬æ–‡ä½ è¿˜æ˜¯æ²¡çœ‹æ‡‚å®ƒä»¬ï¼Œé‚£ä¹ˆè¯·æå‡ºæ¥~~~\n\n","source":"_posts/é›†åˆ/HashMap, ConcurrentHashMap åŸç†åŠæºç .md","raw":"---\ntitle: HashMap, ConcurrentHashMap åŸç†åŠæºç \ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: é›†åˆ\n---\n\n\nç½‘ä¸Šå…³äº HashMap å’Œ ConcurrentHashMap çš„æ–‡ç« ç¡®å®ä¸å°‘ï¼Œä¸è¿‡ç¼ºæ–¤å°‘ä¸¤çš„æ–‡ç« æ¯”è¾ƒå¤šï¼Œæ‰€ä»¥æ‰æƒ³è‡ªå·±ä¹Ÿå†™ä¸€ç¯‡ï¼ŒæŠŠç»†èŠ‚è¯´æ¸…æ¥šè¯´é€ï¼Œå°¤å…¶åƒ Java8 ä¸­çš„ ConcurrentHashMapï¼Œå¤§éƒ¨åˆ†æ–‡ç« éƒ½è¯´ä¸æ¸…æ¥šã€‚ç»ˆå½’æ˜¯å¸Œæœ›èƒ½é™ä½å¤§å®¶å­¦ä¹ çš„æˆæœ¬ï¼Œä¸å¸Œæœ›å¤§å®¶åˆ°å¤„æ‰¾å„ç§ä¸æ˜¯å¾ˆé è°±çš„æ–‡ç« ï¼Œçœ‹å®Œä¸€ç¯‡åˆä¸€ç¯‡ï¼Œå¯æ˜¯è¿˜æ˜¯æ¨¡æ¨¡ç³Šç³Šã€‚\n\n**é˜…è¯»å»ºè®®ï¼š** å››èŠ‚åŸºæœ¬ä¸Šå¯ä»¥è¿›è¡Œç‹¬ç«‹é˜…è¯»ï¼Œå»ºè®®åˆå­¦è€…å¯æŒ‰ç…§ä»¥ä¸‹é¡ºåºè¿›è¡Œé˜…è¯»ï¼Œå¯é€‚å½“é™ä½é˜…è¯»é—¨æ§›ã€‚\n\n> Java7 HashMap -> Java7 ConcurrentHashMap -> Java8 HashMap -> Java8 ConcurrentHashMap \n\n**é˜…è¯»å‰æï¼š** æœ¬æ–‡åˆ†æçš„æ˜¯æºç ï¼Œæ‰€ä»¥è‡³å°‘è¯»è€…è¦ç†Ÿæ‚‰å®ƒä»¬çš„æ¥å£ä½¿ç”¨ï¼ŒåŒæ—¶ï¼Œå¯¹äºå¹¶å‘ï¼Œè¯»è€…è‡³å°‘è¦çŸ¥é“ CASã€ReentrantLockã€UNSAFE æ“ä½œè¿™å‡ ä¸ªåŸºæœ¬çš„çŸ¥è¯†ï¼Œæ–‡ä¸­ä¸ä¼šå¯¹è¿™äº›çŸ¥è¯†è¿›è¡Œä»‹ç»ã€‚Java8 ç”¨åˆ°äº†çº¢é»‘æ ‘ï¼Œä¸è¿‡æœ¬æ–‡ä¸ä¼šè¿›è¡Œå±•å¼€ï¼Œæ„Ÿå…´è¶£çš„è¯»è€…è¯·è‡ªè¡ŒæŸ¥æ‰¾ç›¸å…³èµ„æ–™ã€‚\n\n## Java7 HashMap\n\nHashMap æ˜¯æœ€ç®€å•çš„ï¼Œä¸€æ¥æˆ‘ä»¬éå¸¸ç†Ÿæ‚‰ï¼ŒäºŒæ¥å°±æ˜¯å®ƒä¸æ”¯æŒå¹¶å‘æ“ä½œï¼Œæ‰€ä»¥æºç ä¹Ÿéå¸¸ç®€å•ã€‚\n\né¦–å…ˆï¼Œæˆ‘ä»¬ç”¨ä¸‹é¢è¿™å¼ å›¾æ¥ä»‹ç» HashMap çš„ç»“æ„ã€‚\n\n![](http://qianniu.javastack.cn/18-12-4/65827660.jpg)\n\nè¿™ä¸ªä»…ä»…æ˜¯ç¤ºæ„å›¾ï¼Œå› ä¸ºæ²¡æœ‰è€ƒè™‘åˆ°æ•°ç»„è¦æ‰©å®¹çš„æƒ…å†µï¼Œå…·ä½“çš„åé¢å†è¯´ã€‚\n\nå¤§æ–¹å‘ä¸Šï¼ŒHashMap é‡Œé¢æ˜¯ä¸€ä¸ª**æ•°ç»„**ï¼Œç„¶åæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ª**å•å‘é“¾è¡¨**ã€‚\n\nä¸Šå›¾ä¸­ï¼Œæ¯ä¸ªç»¿è‰²çš„å®ä½“æ˜¯åµŒå¥—ç±» Entry çš„å®ä¾‹ï¼ŒEntry åŒ…å«å››ä¸ªå±æ€§ï¼škey, value, hash å€¼å’Œç”¨äºå•å‘é“¾è¡¨çš„ nextã€‚\n\ncapacityï¼šå½“å‰æ•°ç»„å®¹é‡ï¼Œå§‹ç»ˆä¿æŒ 2^nï¼Œå¯ä»¥æ‰©å®¹ï¼Œæ‰©å®¹åæ•°ç»„å¤§å°ä¸ºå½“å‰çš„ 2 å€ã€‚\n\nloadFactorï¼šè´Ÿè½½å› å­ï¼Œé»˜è®¤ä¸º 0.75ã€‚\n\nthresholdï¼šæ‰©å®¹çš„é˜ˆå€¼ï¼Œç­‰äº capacity * loadFactor\n\n#### put è¿‡ç¨‹åˆ†æ\n\nè¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œè·Ÿç€ä»£ç èµ°ä¸€éå§ã€‚\n\n```\npublic V put(K key, V value) {\n    // å½“æ’å…¥ç¬¬ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œéœ€è¦å…ˆåˆå§‹åŒ–æ•°ç»„å¤§å°\n    if (table == EMPTY_TABLE) {\n        inflateTable(threshold);\n    }\n    // å¦‚æœ key ä¸º nullï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å¾€é‡Œçœ‹ï¼Œæœ€ç»ˆä¼šå°†è¿™ä¸ª entry æ”¾åˆ° table[0] ä¸­\n    if (key == null)\n        return putForNullKey(value);\n    // 1. æ±‚ key çš„ hash å€¼\n    int hash = hash(key);\n    // 2. æ‰¾åˆ°å¯¹åº”çš„æ•°ç»„ä¸‹æ ‡\n    int i = indexFor(hash, table.length);\n    // 3. éå†ä¸€ä¸‹å¯¹åº”ä¸‹æ ‡å¤„çš„é“¾è¡¨ï¼Œçœ‹æ˜¯å¦æœ‰é‡å¤çš„ key å·²ç»å­˜åœ¨ï¼Œ\n    //    å¦‚æœæœ‰ï¼Œç›´æ¥è¦†ç›–ï¼Œput æ–¹æ³•è¿”å›æ—§å€¼å°±ç»“æŸäº†\n    for (Entry<K,V> e = table[i]; e != null; e = e.next) {\n        Object k;\n        if (e.hash == hash && ((k = e.key) == key || key.equals(k))) {\n            V oldValue = e.value;\n            e.value = value;\n            e.recordAccess(this);\n            return oldValue;\n        }\n    }\n \n    modCount++;\n    // 4. ä¸å­˜åœ¨é‡å¤çš„ keyï¼Œå°†æ­¤ entry æ·»åŠ åˆ°é“¾è¡¨ä¸­ï¼Œç»†èŠ‚åé¢è¯´\n    addEntry(hash, key, value, i);\n    return null;\n}\n```\n\n###### æ•°ç»„åˆå§‹åŒ–\n\nåœ¨ç¬¬ä¸€ä¸ªå…ƒç´ æ’å…¥ HashMap çš„æ—¶å€™åšä¸€æ¬¡æ•°ç»„çš„åˆå§‹åŒ–ï¼Œå°±æ˜¯å…ˆç¡®å®šåˆå§‹çš„æ•°ç»„å¤§å°ï¼Œå¹¶è®¡ç®—æ•°ç»„æ‰©å®¹çš„é˜ˆå€¼ã€‚\n\n```\nprivate void inflateTable(int toSize) {\n    // ä¿è¯æ•°ç»„å¤§å°ä¸€å®šæ˜¯ 2 çš„ n æ¬¡æ–¹ã€‚\n    // æ¯”å¦‚è¿™æ ·åˆå§‹åŒ–ï¼šnew HashMap(20)ï¼Œé‚£ä¹ˆå¤„ç†æˆåˆå§‹æ•°ç»„å¤§å°æ˜¯ 32\n    int capacity = roundUpToPowerOf2(toSize);\n    // è®¡ç®—æ‰©å®¹é˜ˆå€¼ï¼šcapacity * loadFactor\n    threshold = (int) Math.min(capacity * loadFactor, MAXIMUM_CAPACITY + 1);\n    // ç®—æ˜¯åˆå§‹åŒ–æ•°ç»„å§\n    table = new Entry[capacity];\n    initHashSeedAsNeeded(capacity); //ignore\n}\n```\n\nè¿™é‡Œæœ‰ä¸€ä¸ªå°†æ•°ç»„å¤§å°ä¿æŒä¸º 2 çš„ n æ¬¡æ–¹çš„åšæ³•ï¼ŒJava7 å’Œ Java8 çš„ HashMap å’Œ ConcurrentHashMap éƒ½æœ‰ç›¸åº”çš„è¦æ±‚ï¼Œåªä¸è¿‡å®ç°çš„ä»£ç ç¨å¾®æœ‰äº›ä¸åŒï¼Œåé¢å†çœ‹åˆ°çš„æ—¶å€™å°±çŸ¥é“äº†ã€‚\n\n###### è®¡ç®—å…·ä½“æ•°ç»„ä½ç½®\n\nè¿™ä¸ªç®€å•ï¼Œæˆ‘ä»¬è‡ªå·±ä¹Ÿèƒ½ YY ä¸€ä¸ªï¼šä½¿ç”¨ key çš„ hash å€¼å¯¹æ•°ç»„é•¿åº¦è¿›è¡Œå–æ¨¡å°±å¯ä»¥äº†ã€‚\n\n```\nstatic int indexFor(int hash, int length) {\n    // assert Integer.bitCount(length) == 1 : \"length must be a non-zero power of 2\";\n    return hash & (length-1);\n}\n```\n\nè¿™ä¸ªæ–¹æ³•å¾ˆç®€å•ï¼Œç®€å•è¯´å°±æ˜¯å– hash å€¼çš„ä½ n ä½ã€‚å¦‚åœ¨æ•°ç»„é•¿åº¦ä¸º 32 çš„æ—¶å€™ï¼Œå…¶å®å–çš„å°±æ˜¯ key çš„ hash å€¼çš„ä½ 5 ä½ï¼Œä½œä¸ºå®ƒåœ¨æ•°ç»„ä¸­çš„ä¸‹æ ‡ä½ç½®ã€‚\n\n###### æ·»åŠ èŠ‚ç‚¹åˆ°é“¾è¡¨ä¸­\n\næ‰¾åˆ°æ•°ç»„ä¸‹æ ‡åï¼Œä¼šå…ˆè¿›è¡Œ key åˆ¤é‡ï¼Œå¦‚æœæ²¡æœ‰é‡å¤ï¼Œå°±å‡†å¤‡å°†æ–°å€¼æ”¾å…¥åˆ°é“¾è¡¨çš„è¡¨å¤´ã€‚\n\n```\nvoid addEntry(int hash, K key, V value, int bucketIndex) {\n    // å¦‚æœå½“å‰ HashMap å¤§å°å·²ç»è¾¾åˆ°äº†é˜ˆå€¼ï¼Œå¹¶ä¸”æ–°å€¼è¦æ’å…¥çš„æ•°ç»„ä½ç½®å·²ç»æœ‰å…ƒç´ äº†ï¼Œé‚£ä¹ˆè¦æ‰©å®¹\n    if ((size >= threshold) && (null != table[bucketIndex])) {\n        // æ‰©å®¹ï¼Œåé¢ä¼šä»‹ç»ä¸€ä¸‹\n        resize(2 * table.length);\n        // æ‰©å®¹ä»¥åï¼Œé‡æ–°è®¡ç®— hash å€¼\n        hash = (null != key) ? hash(key) : 0;\n        // é‡æ–°è®¡ç®—æ‰©å®¹åçš„æ–°çš„ä¸‹æ ‡\n        bucketIndex = indexFor(hash, table.length);\n    }\n    // å¾€ä¸‹çœ‹\n    createEntry(hash, key, value, bucketIndex);\n}\n\n// è¿™ä¸ªå¾ˆç®€å•ï¼Œå…¶å®å°±æ˜¯å°†æ–°å€¼æ”¾åˆ°é“¾è¡¨çš„è¡¨å¤´ï¼Œç„¶å size++\nvoid createEntry(int hash, K key, V value, int bucketIndex) {\n    Entry<K,V> e = table[bucketIndex];\n    table[bucketIndex] = new Entry<>(hash, key, value, e);\n    size++;\n}\n```\n\nè¿™ä¸ªæ–¹æ³•çš„ä¸»è¦é€»è¾‘å°±æ˜¯å…ˆåˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹ï¼Œéœ€è¦çš„è¯å…ˆæ‰©å®¹ï¼Œç„¶åå†å°†è¿™ä¸ªæ–°çš„æ•°æ®æ’å…¥åˆ°æ‰©å®¹åçš„æ•°ç»„çš„ç›¸åº”ä½ç½®å¤„çš„é“¾è¡¨çš„è¡¨å¤´ã€‚\n\n###### æ•°ç»„æ‰©å®¹\n\nå‰é¢æˆ‘ä»¬çœ‹åˆ°ï¼Œåœ¨æ’å…¥æ–°å€¼çš„æ—¶å€™ï¼Œå¦‚æœå½“å‰çš„ size å·²ç»è¾¾åˆ°äº†é˜ˆå€¼ï¼Œå¹¶ä¸”è¦æ’å…¥çš„æ•°ç»„ä½ç½®ä¸Šå·²ç»æœ‰å…ƒç´ ï¼Œé‚£ä¹ˆå°±ä¼šè§¦å‘æ‰©å®¹ï¼Œæ‰©å®¹åï¼Œæ•°ç»„å¤§å°ä¸ºåŸæ¥çš„ 2 å€ã€‚\n\n```\nvoid resize(int newCapacity) {\n    Entry[] oldTable = table;\n    int oldCapacity = oldTable.length;\n    if (oldCapacity == MAXIMUM_CAPACITY) {\n        threshold = Integer.MAX_VALUE;\n        return;\n    }\n    // æ–°çš„æ•°ç»„\n    Entry[] newTable = new Entry[newCapacity];\n    // å°†åŸæ¥æ•°ç»„ä¸­çš„å€¼è¿ç§»åˆ°æ–°çš„æ›´å¤§çš„æ•°ç»„ä¸­\n    transfer(newTable, initHashSeedAsNeeded(newCapacity));\n    table = newTable;\n    threshold = (int)Math.min(newCapacity * loadFactor, MAXIMUM_CAPACITY + 1);\n}\n```\n\næ‰©å®¹å°±æ˜¯ç”¨ä¸€ä¸ªæ–°çš„å¤§æ•°ç»„æ›¿æ¢åŸæ¥çš„å°æ•°ç»„ï¼Œå¹¶å°†åŸæ¥æ•°ç»„ä¸­çš„å€¼è¿ç§»åˆ°æ–°çš„æ•°ç»„ä¸­ã€‚\n\nç”±äºæ˜¯åŒå€æ‰©å®¹ï¼Œè¿ç§»è¿‡ç¨‹ä¸­ï¼Œä¼šå°†åŸæ¥ table[i] ä¸­çš„é“¾è¡¨çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œåˆ†æ‹†åˆ°æ–°çš„æ•°ç»„çš„ newTable[i] å’Œ newTable[i + oldLength] ä½ç½®ä¸Šã€‚å¦‚åŸæ¥æ•°ç»„é•¿åº¦æ˜¯ 16ï¼Œé‚£ä¹ˆæ‰©å®¹åï¼ŒåŸæ¥ table[0] å¤„çš„é“¾è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ ä¼šè¢«åˆ†é…åˆ°æ–°æ•°ç»„ä¸­ newTable[0] å’Œ newTable[16] è¿™ä¸¤ä¸ªä½ç½®ã€‚ä»£ç æ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œå°±ä¸å±•å¼€äº†ã€‚\n\n#### get è¿‡ç¨‹åˆ†æ\n\nç›¸å¯¹äº put è¿‡ç¨‹ï¼Œget è¿‡ç¨‹æ˜¯éå¸¸ç®€å•çš„ã€‚\n\n1. æ ¹æ® key è®¡ç®— hash å€¼ã€‚\n2. æ‰¾åˆ°ç›¸åº”çš„æ•°ç»„ä¸‹æ ‡ï¼šhash & (length â€“ 1)ã€‚\n3. éå†è¯¥æ•°ç»„ä½ç½®å¤„çš„é“¾è¡¨ï¼Œç›´åˆ°æ‰¾åˆ°ç›¸ç­‰(==æˆ–equals)çš„ keyã€‚\n\n```\npublic V get(Object key) {\n    // ä¹‹å‰è¯´è¿‡ï¼Œkey ä¸º null çš„è¯ï¼Œä¼šè¢«æ”¾åˆ° table[0]ï¼Œæ‰€ä»¥åªè¦éå†ä¸‹ table[0] å¤„çš„é“¾è¡¨å°±å¯ä»¥äº†\n    if (key == null)\n        return getForNullKey();\n    // \n    Entry<K,V> entry = getEntry(key);\n \n    return null == entry ? null : entry.getValue();\n}\n```\n\ngetEntry(key):\n\n```\nfinal Entry<K,V> getEntry(Object key) {\n    if (size == 0) {\n        return null;\n    }\n \n    int hash = (key == null) ? 0 : hash(key);\n    // ç¡®å®šæ•°ç»„ä¸‹æ ‡ï¼Œç„¶åä»å¤´å¼€å§‹éå†é“¾è¡¨ï¼Œç›´åˆ°æ‰¾åˆ°ä¸ºæ­¢\n    for (Entry<K,V> e = table[indexFor(hash, table.length)];\n         e != null;\n         e = e.next) {\n        Object k;\n        if (e.hash == hash &&\n            ((k = e.key) == key || (key != null && key.equals(k))))\n            return e;\n    }\n    return null;\n}\n```\n\n## Java7 ConcurrentHashMap\n\nConcurrentHashMap å’Œ HashMap æ€è·¯æ˜¯å·®ä¸å¤šçš„ï¼Œä½†æ˜¯å› ä¸ºå®ƒæ”¯æŒå¹¶å‘æ“ä½œï¼Œæ‰€ä»¥è¦å¤æ‚ä¸€äº›ã€‚\n\næ•´ä¸ª ConcurrentHashMap ç”±ä¸€ä¸ªä¸ª Segment ç»„æˆï¼ŒSegment ä»£è¡¨â€éƒ¨åˆ†â€œæˆ–â€ä¸€æ®µâ€œçš„æ„æ€ï¼Œæ‰€ä»¥å¾ˆå¤šåœ°æ–¹éƒ½ä¼šå°†å…¶æè¿°ä¸º**åˆ†æ®µé”**ã€‚æ³¨æ„ï¼Œè¡Œæ–‡ä¸­ï¼Œæˆ‘å¾ˆå¤šåœ°æ–¹ç”¨äº† **â€œæ§½â€** æ¥ä»£è¡¨ä¸€ä¸ª segmentã€‚\n\nç®€å•ç†è§£å°±æ˜¯ï¼ŒConcurrentHashMap æ˜¯ä¸€ä¸ª Segment æ•°ç»„ï¼ŒSegment é€šè¿‡ç»§æ‰¿ ReentrantLock æ¥è¿›è¡ŒåŠ é”ï¼Œæ‰€ä»¥æ¯æ¬¡éœ€è¦åŠ é”çš„æ“ä½œé”ä½çš„æ˜¯ä¸€ä¸ª segmentï¼Œè¿™æ ·åªè¦ä¿è¯æ¯ä¸ª Segment æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä¹Ÿå°±å®ç°äº†å…¨å±€çš„çº¿ç¨‹å®‰å…¨ã€‚æ¨èé˜…è¯»ï¼š[å²ä¸Šæœ€å…¨ Java å¤šçº¿ç¨‹é¢è¯•é¢˜åŠç­”æ¡ˆ](https://mp.weixin.qq.com/s/0CI9od4DIxRrmOGFJw0SuQ)ã€‚\n\n![](http://qianniu.javastack.cn/18-12-4/75121838.jpg)\n\n**concurrencyLevelï¼š** å¹¶è¡Œçº§åˆ«ã€å¹¶å‘æ•°ã€Segment æ•°ï¼Œæ€ä¹ˆç¿»è¯‘ä¸é‡è¦ï¼Œç†è§£å®ƒã€‚é»˜è®¤æ˜¯ 16ï¼Œä¹Ÿå°±æ˜¯è¯´ ConcurrentHashMap æœ‰ 16 ä¸ª Segmentsï¼Œæ‰€ä»¥ç†è®ºä¸Šï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæœ€å¤šå¯ä»¥åŒæ—¶æ”¯æŒ 16 ä¸ªçº¿ç¨‹å¹¶å‘å†™ï¼Œåªè¦å®ƒä»¬çš„æ“ä½œåˆ†åˆ«åˆ†å¸ƒåœ¨ä¸åŒçš„ Segment ä¸Šã€‚è¿™ä¸ªå€¼å¯ä»¥åœ¨åˆå§‹åŒ–çš„æ—¶å€™è®¾ç½®ä¸ºå…¶ä»–å€¼ï¼Œä½†æ˜¯ä¸€æ—¦åˆå§‹åŒ–ä»¥åï¼Œå®ƒæ˜¯ä¸å¯ä»¥æ‰©å®¹çš„ã€‚\n\nå†å…·ä½“åˆ°æ¯ä¸ª Segment å†…éƒ¨ï¼Œå…¶å®æ¯ä¸ª Segment å¾ˆåƒä¹‹å‰ä»‹ç»çš„ HashMapï¼Œä¸è¿‡å®ƒè¦ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œæ‰€ä»¥å¤„ç†èµ·æ¥è¦éº»çƒ¦äº›ã€‚æ¨èé˜…è¯»ï¼š[å‡ ç§çº¿ç¨‹å®‰å…¨çš„Mapè§£æ](https://mp.weixin.qq.com/s/5Y5_6qn2g6kIVmQia_0R6g)ã€‚\n\n#### åˆå§‹åŒ–\n\ninitialCapacityï¼šåˆå§‹å®¹é‡ï¼Œè¿™ä¸ªå€¼æŒ‡çš„æ˜¯æ•´ä¸ª ConcurrentHashMap çš„åˆå§‹å®¹é‡ï¼Œå®é™…æ“ä½œçš„æ—¶å€™éœ€è¦å¹³å‡åˆ†ç»™æ¯ä¸ª Segmentã€‚\n\nloadFactorï¼šè´Ÿè½½å› å­ï¼Œä¹‹å‰æˆ‘ä»¬è¯´äº†ï¼ŒSegment æ•°ç»„ä¸å¯ä»¥æ‰©å®¹ï¼Œæ‰€ä»¥è¿™ä¸ªè´Ÿè½½å› å­æ˜¯ç»™æ¯ä¸ª Segment å†…éƒ¨ä½¿ç”¨çš„ã€‚\n\n```\npublic ConcurrentHashMap(int initialCapacity,\n                         float loadFactor, int concurrencyLevel) {\n    if (!(loadFactor > 0) || initialCapacity < 0 || concurrencyLevel <= 0)\n        throw new IllegalArgumentException();\n    if (concurrencyLevel > MAX_SEGMENTS)\n        concurrencyLevel = MAX_SEGMENTS;\n    // Find power-of-two sizes best matching arguments\n    int sshift = 0;\n    int ssize = 1;\n    // è®¡ç®—å¹¶è¡Œçº§åˆ« ssizeï¼Œå› ä¸ºè¦ä¿æŒå¹¶è¡Œçº§åˆ«æ˜¯ 2 çš„ n æ¬¡æ–¹\n    while (ssize < concurrencyLevel) {\n        ++sshift;\n        ssize <<= 1;\n    }\n    // æˆ‘ä»¬è¿™é‡Œå…ˆä¸è¦é‚£ä¹ˆçƒ§è„‘ï¼Œç”¨é»˜è®¤å€¼ï¼ŒconcurrencyLevel ä¸º 16ï¼Œsshift ä¸º 4\n    // é‚£ä¹ˆè®¡ç®—å‡º segmentShift ä¸º 28ï¼ŒsegmentMask ä¸º 15ï¼Œåé¢ä¼šç”¨åˆ°è¿™ä¸¤ä¸ªå€¼\n    this.segmentShift = 32 - sshift;\n    this.segmentMask = ssize - 1;\n \n    if (initialCapacity > MAXIMUM_CAPACITY)\n        initialCapacity = MAXIMUM_CAPACITY;\n \n    // initialCapacity æ˜¯è®¾ç½®æ•´ä¸ª map åˆå§‹çš„å¤§å°ï¼Œ\n    // è¿™é‡Œæ ¹æ® initialCapacity è®¡ç®— Segment æ•°ç»„ä¸­æ¯ä¸ªä½ç½®å¯ä»¥åˆ†åˆ°çš„å¤§å°\n    // å¦‚ initialCapacity ä¸º 64ï¼Œé‚£ä¹ˆæ¯ä¸ª Segment æˆ–ç§°ä¹‹ä¸º\"æ§½\"å¯ä»¥åˆ†åˆ° 4 ä¸ª\n    int c = initialCapacity / ssize;\n    if (c * ssize < initialCapacity)\n        ++c;\n    // é»˜è®¤ MIN_SEGMENT_TABLE_CAPACITY æ˜¯ 2ï¼Œè¿™ä¸ªå€¼ä¹Ÿæ˜¯æœ‰è®²ç©¶çš„ï¼Œå› ä¸ºè¿™æ ·çš„è¯ï¼Œå¯¹äºå…·ä½“çš„æ§½ä¸Šï¼Œ\n    // æ’å…¥ä¸€ä¸ªå…ƒç´ ä¸è‡³äºæ‰©å®¹ï¼Œæ’å…¥ç¬¬äºŒä¸ªçš„æ—¶å€™æ‰ä¼šæ‰©å®¹\n    int cap = MIN_SEGMENT_TABLE_CAPACITY; \n    while (cap < c)\n        cap <<= 1;\n \n    // åˆ›å»º Segment æ•°ç»„ï¼Œ\n    // å¹¶åˆ›å»ºæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´  segment[0]\n    Segment<K,V> s0 =\n        new Segment<K,V>(loadFactor, (int)(cap * loadFactor),\n                         (HashEntry<K,V>[])new HashEntry[cap]);\n    Segment<K,V>[] ss = (Segment<K,V>[])new Segment[ssize];\n    // å¾€æ•°ç»„å†™å…¥ segment[0]\n    UNSAFE.putOrderedObject(ss, SBASE, s0); // ordered write of segments[0]\n    this.segments = ss;\n}\n```\n\nåˆå§‹åŒ–å®Œæˆï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ª Segment æ•°ç»„ã€‚\n\næˆ‘ä»¬å°±å½“æ˜¯ç”¨ new ConcurrentHashMap() æ— å‚æ„é€ å‡½æ•°è¿›è¡Œåˆå§‹åŒ–çš„ï¼Œé‚£ä¹ˆåˆå§‹åŒ–å®Œæˆåï¼š\n\n- Segment æ•°ç»„é•¿åº¦ä¸º 16ï¼Œä¸å¯ä»¥æ‰©å®¹\n- Segment[i] çš„é»˜è®¤å¤§å°ä¸º 2ï¼Œè´Ÿè½½å› å­æ˜¯ 0.75ï¼Œå¾—å‡ºåˆå§‹é˜ˆå€¼ä¸º 1.5ï¼Œä¹Ÿå°±æ˜¯ä»¥åæ’å…¥ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ä¼šè§¦å‘æ‰©å®¹ï¼Œæ’å…¥ç¬¬äºŒä¸ªä¼šè¿›è¡Œç¬¬ä¸€æ¬¡æ‰©å®¹\n- è¿™é‡Œåˆå§‹åŒ–äº† segment[0]ï¼Œå…¶ä»–ä½ç½®è¿˜æ˜¯ nullï¼Œè‡³äºä¸ºä»€ä¹ˆè¦åˆå§‹åŒ– segment[0]ï¼Œåé¢çš„ä»£ç ä¼šä»‹ç»\n- å½“å‰ segmentShift çš„å€¼ä¸º 32 â€“ 4 = 28ï¼ŒsegmentMask ä¸º 16 â€“ 1 = 15ï¼Œå§‘ä¸”æŠŠå®ƒä»¬ç®€å•ç¿»è¯‘ä¸ºç§»ä½æ•°å’Œæ©ç ï¼Œè¿™ä¸¤ä¸ªå€¼é©¬ä¸Šå°±ä¼šç”¨åˆ°ã€‚\n\n#### put è¿‡ç¨‹åˆ†æ\n\næˆ‘ä»¬å…ˆçœ‹ put çš„ä¸»æµç¨‹ï¼Œå¯¹äºå…¶ä¸­çš„ä¸€äº›å…³é”®ç»†èŠ‚æ“ä½œï¼Œåé¢ä¼šè¿›è¡Œè¯¦ç»†ä»‹ç»ã€‚\n\n```\npublic V put(K key, V value) {\n    Segment<K,V> s;\n    if (value == null)\n        throw new NullPointerException();\n    // 1. è®¡ç®— key çš„ hash å€¼\n    int hash = hash(key);\n    // 2. æ ¹æ® hash å€¼æ‰¾åˆ° Segment æ•°ç»„ä¸­çš„ä½ç½® j\n    //    hash æ˜¯ 32 ä½ï¼Œæ— ç¬¦å·å³ç§» segmentShift(28) ä½ï¼Œå‰©ä¸‹ä½ 4 ä½ï¼Œ\n    //    ç„¶åå’Œ segmentMask(15) åšä¸€æ¬¡ä¸æ“ä½œï¼Œä¹Ÿå°±æ˜¯è¯´ j æ˜¯ hash å€¼çš„æœ€å 4 ä½ï¼Œä¹Ÿå°±æ˜¯æ§½çš„æ•°ç»„ä¸‹æ ‡\n    int j = (hash >>> segmentShift) & segmentMask;\n    // åˆšåˆšè¯´äº†ï¼Œåˆå§‹åŒ–çš„æ—¶å€™åˆå§‹åŒ–äº† segment[0]ï¼Œä½†æ˜¯å…¶ä»–ä½ç½®è¿˜æ˜¯ nullï¼Œ\n    // ensureSegment(j) å¯¹ segment[j] è¿›è¡Œåˆå§‹åŒ–\n    if ((s = (Segment<K,V>)UNSAFE.getObject          // nonvolatile; recheck\n         (segments, (j << SSHIFT) + SBASE)) == null) //  in ensureSegment\n        s = ensureSegment(j);\n    // 3. æ’å…¥æ–°å€¼åˆ° æ§½ s ä¸­\n    return s.put(key, hash, value, false);\n}\n```\n\nç¬¬ä¸€å±‚çš®å¾ˆç®€å•ï¼Œæ ¹æ® hash å€¼å¾ˆå¿«å°±èƒ½æ‰¾åˆ°ç›¸åº”çš„ Segmentï¼Œä¹‹åå°±æ˜¯ Segment å†…éƒ¨çš„ put æ“ä½œäº†ã€‚\n\nSegment å†…éƒ¨æ˜¯ç”± **æ•°ç»„+é“¾è¡¨** ç»„æˆçš„ã€‚\n\n```\nfinal V put(K key, int hash, V value, boolean onlyIfAbsent) {\n    // åœ¨å¾€è¯¥ segment å†™å…¥å‰ï¼Œéœ€è¦å…ˆè·å–è¯¥ segment çš„ç‹¬å é”\n    //    å…ˆçœ‹ä¸»æµç¨‹ï¼Œåé¢è¿˜ä¼šå…·ä½“ä»‹ç»è¿™éƒ¨åˆ†å†…å®¹\n    HashEntry<K,V> node = tryLock() ? null :\n        scanAndLockForPut(key, hash, value);\n    V oldValue;\n    try {\n        // è¿™ä¸ªæ˜¯ segment å†…éƒ¨çš„æ•°ç»„\n        HashEntry<K,V>[] tab = table;\n        // å†åˆ©ç”¨ hash å€¼ï¼Œæ±‚åº”è¯¥æ”¾ç½®çš„æ•°ç»„ä¸‹æ ‡\n        int index = (tab.length - 1) & hash;\n        // first æ˜¯æ•°ç»„è¯¥ä½ç½®å¤„çš„é“¾è¡¨çš„è¡¨å¤´\n        HashEntry<K,V> first = entryAt(tab, index);\n \n        // ä¸‹é¢è¿™ä¸² for å¾ªç¯è™½ç„¶å¾ˆé•¿ï¼Œä¸è¿‡ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œæƒ³æƒ³è¯¥ä½ç½®æ²¡æœ‰ä»»ä½•å…ƒç´ å’Œå·²ç»å­˜åœ¨ä¸€ä¸ªé“¾è¡¨è¿™ä¸¤ç§æƒ…å†µ\n        for (HashEntry<K,V> e = first;;) {\n            if (e != null) {\n                K k;\n                if ((k = e.key) == key ||\n                    (e.hash == hash && key.equals(k))) {\n                    oldValue = e.value;\n                    if (!onlyIfAbsent) {\n                        // è¦†ç›–æ—§å€¼\n                        e.value = value;\n                        ++modCount;\n                    }\n                    break;\n                }\n                // ç»§ç»­é¡ºç€é“¾è¡¨èµ°\n                e = e.next;\n            }\n            else {\n                // node åˆ°åº•æ˜¯ä¸æ˜¯ nullï¼Œè¿™ä¸ªè¦çœ‹è·å–é”çš„è¿‡ç¨‹ï¼Œä¸è¿‡å’Œè¿™é‡Œéƒ½æ²¡æœ‰å…³ç³»ã€‚\n                // å¦‚æœä¸ä¸º nullï¼Œé‚£å°±ç›´æ¥å°†å®ƒè®¾ç½®ä¸ºé“¾è¡¨è¡¨å¤´ï¼›å¦‚æœæ˜¯nullï¼Œåˆå§‹åŒ–å¹¶è®¾ç½®ä¸ºé“¾è¡¨è¡¨å¤´ã€‚\n                if (node != null)\n                    node.setNext(first);\n                else\n                    node = new HashEntry<K,V>(hash, key, value, first);\n \n                int c = count + 1;\n                // å¦‚æœè¶…è¿‡äº†è¯¥ segment çš„é˜ˆå€¼ï¼Œè¿™ä¸ª segment éœ€è¦æ‰©å®¹\n                if (c > threshold && tab.length < MAXIMUM_CAPACITY)\n                    rehash(node); // æ‰©å®¹åé¢ä¹Ÿä¼šå…·ä½“åˆ†æ\n                else\n                    // æ²¡æœ‰è¾¾åˆ°é˜ˆå€¼ï¼Œå°† node æ”¾åˆ°æ•°ç»„ tab çš„ index ä½ç½®ï¼Œ\n                    // å…¶å®å°±æ˜¯å°†æ–°çš„èŠ‚ç‚¹è®¾ç½®æˆåŸé“¾è¡¨çš„è¡¨å¤´\n                    setEntryAt(tab, index, node);\n                ++modCount;\n                count = c;\n                oldValue = null;\n                break;\n            }\n        }\n    } finally {\n        // è§£é”\n        unlock();\n    }\n    return oldValue;\n}\n```\n\næ•´ä½“æµç¨‹è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œç”±äºæœ‰ç‹¬å é”çš„ä¿æŠ¤ï¼Œæ‰€ä»¥ segment å†…éƒ¨çš„æ“ä½œå¹¶ä¸å¤æ‚ã€‚è‡³äºè¿™é‡Œé¢çš„å¹¶å‘é—®é¢˜ï¼Œæˆ‘ä»¬ç¨åå†è¿›è¡Œä»‹ç»ã€‚\n\nåˆ°è¿™é‡Œ put æ“ä½œå°±ç»“æŸäº†ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¯´ä¸€è¯´å…¶ä¸­å‡ æ­¥å…³é”®çš„æ“ä½œã€‚\n\n###### åˆå§‹åŒ–æ§½: ensureSegment\n\nConcurrentHashMap åˆå§‹åŒ–çš„æ—¶å€™ä¼šåˆå§‹åŒ–ç¬¬ä¸€ä¸ªæ§½ segment[0]ï¼Œå¯¹äºå…¶ä»–æ§½æ¥è¯´ï¼Œåœ¨æ’å…¥ç¬¬ä¸€ä¸ªå€¼çš„æ—¶å€™è¿›è¡Œåˆå§‹åŒ–ã€‚\n\nè¿™é‡Œéœ€è¦è€ƒè™‘å¹¶å‘ï¼Œå› ä¸ºå¾ˆå¯èƒ½ä¼šæœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶è¿›æ¥åˆå§‹åŒ–åŒä¸€ä¸ªæ§½ segment[k]ï¼Œä¸è¿‡åªè¦æœ‰ä¸€ä¸ªæˆåŠŸäº†å°±å¯ä»¥ã€‚\n\n```\nprivate Segment<K,V> ensureSegment(int k) {\n    final Segment<K,V>[] ss = this.segments;\n    long u = (k << SSHIFT) + SBASE; // raw offset\n    Segment<K,V> seg;\n    if ((seg = (Segment<K,V>)UNSAFE.getObjectVolatile(ss, u)) == null) {\n        // è¿™é‡Œçœ‹åˆ°ä¸ºä»€ä¹ˆä¹‹å‰è¦åˆå§‹åŒ– segment[0] äº†ï¼Œ\n        // ä½¿ç”¨å½“å‰ segment[0] å¤„çš„æ•°ç»„é•¿åº¦å’Œè´Ÿè½½å› å­æ¥åˆå§‹åŒ– segment[k]\n        // ä¸ºä»€ä¹ˆè¦ç”¨â€œå½“å‰â€ï¼Œå› ä¸º segment[0] å¯èƒ½æ—©å°±æ‰©å®¹è¿‡äº†\n        Segment<K,V> proto = ss[0];\n        int cap = proto.table.length;\n        float lf = proto.loadFactor;\n        int threshold = (int)(cap * lf);\n \n        // åˆå§‹åŒ– segment[k] å†…éƒ¨çš„æ•°ç»„\n        HashEntry<K,V>[] tab = (HashEntry<K,V>[])new HashEntry[cap];\n        if ((seg = (Segment<K,V>)UNSAFE.getObjectVolatile(ss, u))\n            == null) { // å†æ¬¡æ£€æŸ¥ä¸€éè¯¥æ§½æ˜¯å¦è¢«å…¶ä»–çº¿ç¨‹åˆå§‹åŒ–äº†ã€‚\n \n            Segment<K,V> s = new Segment<K,V>(lf, threshold, tab);\n            // ä½¿ç”¨ while å¾ªç¯ï¼Œå†…éƒ¨ç”¨ CASï¼Œå½“å‰çº¿ç¨‹æˆåŠŸè®¾å€¼æˆ–å…¶ä»–çº¿ç¨‹æˆåŠŸè®¾å€¼åï¼Œé€€å‡º\n            while ((seg = (Segment<K,V>)UNSAFE.getObjectVolatile(ss, u))\n                   == null) {\n                if (UNSAFE.compareAndSwapObject(ss, u, null, seg = s))\n                    break;\n            }\n        }\n    }\n    return seg;\n}\n```\n\næ€»çš„æ¥è¯´ï¼ŒensureSegment(int k) æ¯”è¾ƒç®€å•ï¼Œå¯¹äºå¹¶å‘æ“ä½œä½¿ç”¨ CAS è¿›è¡Œæ§åˆ¶ã€‚\n\n> å¦‚æœå½“å‰çº¿ç¨‹ CAS å¤±è´¥ï¼Œè¿™é‡Œçš„ while å¾ªç¯æ˜¯ä¸ºäº†å°† seg èµ‹å€¼è¿”å›ã€‚\n\n###### è·å–å†™å…¥é”: scanAndLockForPut\n\nå‰é¢æˆ‘ä»¬çœ‹åˆ°ï¼Œåœ¨å¾€æŸä¸ª segment ä¸­ put çš„æ—¶å€™ï¼Œé¦–å…ˆä¼šè°ƒç”¨ node = tryLock() ? null : scanAndLockForPut(key, hash, value)ï¼Œä¹Ÿå°±æ˜¯è¯´å…ˆè¿›è¡Œä¸€æ¬¡ tryLock() å¿«é€Ÿè·å–è¯¥ segment çš„ç‹¬å é”ï¼Œå¦‚æœå¤±è´¥ï¼Œé‚£ä¹ˆè¿›å…¥åˆ° scanAndLockForPut è¿™ä¸ªæ–¹æ³•æ¥è·å–é”ã€‚\n\nä¸‹é¢æˆ‘ä»¬æ¥å…·ä½“åˆ†æè¿™ä¸ªæ–¹æ³•ä¸­æ˜¯æ€ä¹ˆæ§åˆ¶åŠ é”çš„ã€‚\n\n```\nprivate HashEntry<K,V> scanAndLockForPut(K key, int hash, V value) {\n    HashEntry<K,V> first = entryForHash(this, hash);\n    HashEntry<K,V> e = first;\n    HashEntry<K,V> node = null;\n    int retries = -1; // negative while locating node\n \n    // å¾ªç¯è·å–é”\n    while (!tryLock()) {\n        HashEntry<K,V> f; // to recheck first below\n        if (retries < 0) {\n            if (e == null) {\n                if (node == null) // speculatively create node\n                    // è¿›åˆ°è¿™é‡Œè¯´æ˜æ•°ç»„è¯¥ä½ç½®çš„é“¾è¡¨æ˜¯ç©ºçš„ï¼Œæ²¡æœ‰ä»»ä½•å…ƒç´ \n                    // å½“ç„¶ï¼Œè¿›åˆ°è¿™é‡Œçš„å¦ä¸€ä¸ªåŸå› æ˜¯ tryLock() å¤±è´¥ï¼Œæ‰€ä»¥è¯¥æ§½å­˜åœ¨å¹¶å‘ï¼Œä¸ä¸€å®šæ˜¯è¯¥ä½ç½®\n                    node = new HashEntry<K,V>(hash, key, value, null);\n                retries = 0;\n            }\n            else if (key.equals(e.key))\n                retries = 0;\n            else\n                // é¡ºç€é“¾è¡¨å¾€ä¸‹èµ°\n                e = e.next;\n        }\n        // é‡è¯•æ¬¡æ•°å¦‚æœè¶…è¿‡ MAX_SCAN_RETRIESï¼ˆå•æ ¸1å¤šæ ¸64ï¼‰ï¼Œé‚£ä¹ˆä¸æŠ¢äº†ï¼Œè¿›å…¥åˆ°é˜»å¡é˜Ÿåˆ—ç­‰å¾…é”\n        //    lock() æ˜¯é˜»å¡æ–¹æ³•ï¼Œç›´åˆ°è·å–é”åè¿”å›\n        else if (++retries > MAX_SCAN_RETRIES) {\n            lock();\n            break;\n        }\n        else if ((retries & 1) == 0 &&\n                 // è¿™ä¸ªæ—¶å€™æ˜¯æœ‰å¤§é—®é¢˜äº†ï¼Œé‚£å°±æ˜¯æœ‰æ–°çš„å…ƒç´ è¿›åˆ°äº†é“¾è¡¨ï¼Œæˆä¸ºäº†æ–°çš„è¡¨å¤´\n                 //     æ‰€ä»¥è¿™è¾¹çš„ç­–ç•¥æ˜¯ï¼Œç›¸å½“äºé‡æ–°èµ°ä¸€éè¿™ä¸ª scanAndLockForPut æ–¹æ³•\n                 (f = entryForHash(this, hash)) != first) {\n            e = first = f; // re-traverse if entry changed\n            retries = -1;\n        }\n    }\n    return node;\n}\n```\n\nè¿™ä¸ªæ–¹æ³•æœ‰ä¸¤ä¸ªå‡ºå£ï¼Œä¸€ä¸ªæ˜¯ tryLock() æˆåŠŸäº†ï¼Œå¾ªç¯ç»ˆæ­¢ï¼Œå¦ä¸€ä¸ªå°±æ˜¯é‡è¯•æ¬¡æ•°è¶…è¿‡äº† MAX_SCAN_RETRIESï¼Œè¿›åˆ° lock() æ–¹æ³•ï¼Œæ­¤æ–¹æ³•ä¼šé˜»å¡ç­‰å¾…ï¼Œç›´åˆ°æˆåŠŸæ‹¿åˆ°ç‹¬å é”ã€‚\n\nè¿™ä¸ªæ–¹æ³•å°±æ˜¯çœ‹ä¼¼å¤æ‚ï¼Œä½†æ˜¯å…¶å®å°±æ˜¯åšäº†ä¸€ä»¶äº‹ï¼Œé‚£å°±æ˜¯**è·å–è¯¥ segment çš„ç‹¬å é”**ï¼Œå¦‚æœéœ€è¦çš„è¯é¡ºä¾¿å®ä¾‹åŒ–äº†ä¸€ä¸‹ nodeã€‚\n\n###### æ‰©å®¹: rehash\n\né‡å¤ä¸€ä¸‹ï¼Œsegment æ•°ç»„ä¸èƒ½æ‰©å®¹ï¼Œæ‰©å®¹æ˜¯ segment æ•°ç»„æŸä¸ªä½ç½®å†…éƒ¨çš„æ•°ç»„ HashEntry\\[] è¿›è¡Œæ‰©å®¹ï¼Œæ‰©å®¹åï¼Œå®¹é‡ä¸ºåŸæ¥çš„ 2 å€ã€‚\n\né¦–å…ˆï¼Œæˆ‘ä»¬è¦å›é¡¾ä¸€ä¸‹è§¦å‘æ‰©å®¹çš„åœ°æ–¹ï¼Œput çš„æ—¶å€™ï¼Œå¦‚æœåˆ¤æ–­è¯¥å€¼çš„æ’å…¥ä¼šå¯¼è‡´è¯¥ segment çš„å…ƒç´ ä¸ªæ•°è¶…è¿‡é˜ˆå€¼ï¼Œé‚£ä¹ˆå…ˆè¿›è¡Œæ‰©å®¹ï¼Œå†æ’å€¼ï¼Œè¯»è€…è¿™ä¸ªæ—¶å€™å¯ä»¥å›å» put æ–¹æ³•çœ‹ä¸€çœ¼ã€‚\n\nè¯¥æ–¹æ³•ä¸éœ€è¦è€ƒè™‘å¹¶å‘ï¼Œå› ä¸ºåˆ°è¿™é‡Œçš„æ—¶å€™ï¼Œæ˜¯æŒæœ‰è¯¥ segment çš„ç‹¬å é”çš„ã€‚\n\n```\n// æ–¹æ³•å‚æ•°ä¸Šçš„ node æ˜¯è¿™æ¬¡æ‰©å®¹åï¼Œéœ€è¦æ·»åŠ åˆ°æ–°çš„æ•°ç»„ä¸­çš„æ•°æ®ã€‚\nprivate void rehash(HashEntry<K,V> node) {\n    HashEntry<K,V>[] oldTable = table;\n    int oldCapacity = oldTable.length;\n    // 2 å€\n    int newCapacity = oldCapacity << 1;\n    threshold = (int)(newCapacity * loadFactor);\n    // åˆ›å»ºæ–°æ•°ç»„\n    HashEntry<K,V>[] newTable =\n        (HashEntry<K,V>[]) new HashEntry[newCapacity];\n    // æ–°çš„æ©ç ï¼Œå¦‚ä» 16 æ‰©å®¹åˆ° 32ï¼Œé‚£ä¹ˆ sizeMask ä¸º 31ï¼Œå¯¹åº”äºŒè¿›åˆ¶ â€˜000...00011111â€™\n    int sizeMask = newCapacity - 1;\n \n    // éå†åŸæ•°ç»„ï¼Œè€å¥—è·¯ï¼Œå°†åŸæ•°ç»„ä½ç½® i å¤„çš„é“¾è¡¨æ‹†åˆ†åˆ° æ–°æ•°ç»„ä½ç½® i å’Œ i+oldCap ä¸¤ä¸ªä½ç½®\n    for (int i = 0; i < oldCapacity ; i++) {\n        // e æ˜¯é“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ \n        HashEntry<K,V> e = oldTable[i];\n        if (e != null) {\n            HashEntry<K,V> next = e.next;\n            // è®¡ç®—åº”è¯¥æ”¾ç½®åœ¨æ–°æ•°ç»„ä¸­çš„ä½ç½®ï¼Œ\n            // å‡è®¾åŸæ•°ç»„é•¿åº¦ä¸º 16ï¼Œe åœ¨ oldTable[3] å¤„ï¼Œé‚£ä¹ˆ idx åªå¯èƒ½æ˜¯ 3 æˆ–è€…æ˜¯ 3 + 16 = 19\n            int idx = e.hash & sizeMask;\n            if (next == null)   // è¯¥ä½ç½®å¤„åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œé‚£æ¯”è¾ƒå¥½åŠ\n                newTable[idx] = e;\n            else { // Reuse consecutive sequence at same slot\n                // e æ˜¯é“¾è¡¨è¡¨å¤´\n                HashEntry<K,V> lastRun = e;\n                // idx æ˜¯å½“å‰é“¾è¡¨çš„å¤´ç»“ç‚¹ e çš„æ–°ä½ç½®\n                int lastIdx = idx;\n \n                // ä¸‹é¢è¿™ä¸ª for å¾ªç¯ä¼šæ‰¾åˆ°ä¸€ä¸ª lastRun èŠ‚ç‚¹ï¼Œè¿™ä¸ªèŠ‚ç‚¹ä¹‹åçš„æ‰€æœ‰å…ƒç´ æ˜¯å°†è¦æ”¾åˆ°ä¸€èµ·çš„\n                for (HashEntry<K,V> last = next;\n                     last != null;\n                     last = last.next) {\n                    int k = last.hash & sizeMask;\n                    if (k != lastIdx) {\n                        lastIdx = k;\n                        lastRun = last;\n                    }\n                }\n                // å°† lastRun åŠå…¶ä¹‹åçš„æ‰€æœ‰èŠ‚ç‚¹ç»„æˆçš„è¿™ä¸ªé“¾è¡¨æ”¾åˆ° lastIdx è¿™ä¸ªä½ç½®\n                newTable[lastIdx] = lastRun;\n                // ä¸‹é¢çš„æ“ä½œæ˜¯å¤„ç† lastRun ä¹‹å‰çš„èŠ‚ç‚¹ï¼Œ\n                //    è¿™äº›èŠ‚ç‚¹å¯èƒ½åˆ†é…åœ¨å¦ä¸€ä¸ªé“¾è¡¨ä¸­ï¼Œä¹Ÿå¯èƒ½åˆ†é…åˆ°ä¸Šé¢çš„é‚£ä¸ªé“¾è¡¨ä¸­\n                for (HashEntry<K,V> p = e; p != lastRun; p = p.next) {\n                    V v = p.value;\n                    int h = p.hash;\n                    int k = h & sizeMask;\n                    HashEntry<K,V> n = newTable[k];\n                    newTable[k] = new HashEntry<K,V>(h, p.key, v, n);\n                }\n            }\n        }\n    }\n    // å°†æ–°æ¥çš„ node æ”¾åˆ°æ–°æ•°ç»„ä¸­åˆšåˆšçš„ ä¸¤ä¸ªé“¾è¡¨ä¹‹ä¸€ çš„ å¤´éƒ¨\n    int nodeIndex = node.hash & sizeMask; // add the new node\n    node.setNext(newTable[nodeIndex]);\n    newTable[nodeIndex] = node;\n    table = newTable;\n}\n```\n\nè¿™é‡Œçš„æ‰©å®¹æ¯”ä¹‹å‰çš„ HashMap è¦å¤æ‚ä¸€äº›ï¼Œä»£ç éš¾æ‡‚ä¸€ç‚¹ã€‚ä¸Šé¢æœ‰ä¸¤ä¸ªæŒ¨ç€çš„ for å¾ªç¯ï¼Œç¬¬ä¸€ä¸ª for æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ\n\nä»”ç»†ä¸€çœ‹å‘ç°ï¼Œå¦‚æœæ²¡æœ‰ç¬¬ä¸€ä¸ª for å¾ªç¯ï¼Œä¹Ÿæ˜¯å¯ä»¥å·¥ä½œçš„ï¼Œä½†æ˜¯ï¼Œè¿™ä¸ª for å¾ªç¯ä¸‹æ¥ï¼Œå¦‚æœ lastRun çš„åé¢è¿˜æœ‰æ¯”è¾ƒå¤šçš„èŠ‚ç‚¹ï¼Œé‚£ä¹ˆè¿™æ¬¡å°±æ˜¯å€¼å¾—çš„ã€‚å› ä¸ºæˆ‘ä»¬åªéœ€è¦å…‹éš† lastRun å‰é¢çš„èŠ‚ç‚¹ï¼Œåé¢çš„ä¸€ä¸²èŠ‚ç‚¹è·Ÿç€ lastRun èµ°å°±æ˜¯äº†ï¼Œä¸éœ€è¦åšä»»ä½•æ“ä½œã€‚\n\næˆ‘è§‰å¾— Doug Lea çš„è¿™ä¸ªæƒ³æ³•ä¹Ÿæ˜¯æŒºæœ‰æ„æ€çš„ï¼Œä¸è¿‡æ¯”è¾ƒåçš„æƒ…å†µå°±æ˜¯æ¯æ¬¡ lastRun éƒ½æ˜¯é“¾è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ æˆ–è€…å¾ˆé åçš„å…ƒç´ ï¼Œé‚£ä¹ˆè¿™æ¬¡éå†å°±æœ‰ç‚¹æµªè´¹äº†ã€‚**ä¸è¿‡ Doug Lea ä¹Ÿè¯´äº†ï¼Œæ ¹æ®ç»Ÿè®¡ï¼Œå¦‚æœä½¿ç”¨é»˜è®¤çš„é˜ˆå€¼ï¼Œå¤§çº¦åªæœ‰ 1/6 çš„èŠ‚ç‚¹éœ€è¦å…‹éš†ã€‚**\n\n#### get è¿‡ç¨‹åˆ†æ\n\nç›¸å¯¹äº put æ¥è¯´ï¼Œget çœŸçš„ä¸è¦å¤ªç®€å•ã€‚\n\n1. è®¡ç®— hash å€¼ï¼Œæ‰¾åˆ° segment æ•°ç»„ä¸­çš„å…·ä½“ä½ç½®ï¼Œæˆ–æˆ‘ä»¬å‰é¢ç”¨çš„â€œæ§½â€\n2. æ§½ä¸­ä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ ¹æ® hash æ‰¾åˆ°æ•°ç»„ä¸­å…·ä½“çš„ä½ç½®\n3. åˆ°è¿™é‡Œæ˜¯é“¾è¡¨äº†ï¼Œé¡ºç€é“¾è¡¨è¿›è¡ŒæŸ¥æ‰¾å³å¯\n\n```\npublic V get(Object key) {\n    Segment<K,V> s; // manually integrate access methods to reduce overhead\n    HashEntry<K,V>[] tab;\n    // 1. hash å€¼\n    int h = hash(key);\n    long u = (((h >>> segmentShift) & segmentMask) << SSHIFT) + SBASE;\n    // 2. æ ¹æ® hash æ‰¾åˆ°å¯¹åº”çš„ segment\n    if ((s = (Segment<K,V>)UNSAFE.getObjectVolatile(segments, u)) != null &&\n        (tab = s.table) != null) {\n        // 3. æ‰¾åˆ°segment å†…éƒ¨æ•°ç»„ç›¸åº”ä½ç½®çš„é“¾è¡¨ï¼Œéå†\n        for (HashEntry<K,V> e = (HashEntry<K,V>) UNSAFE.getObjectVolatile\n                 (tab, ((long)(((tab.length - 1) & h)) << TSHIFT) + TBASE);\n             e != null; e = e.next) {\n            K k;\n            if ((k = e.key) == key || (e.hash == h && key.equals(k)))\n                return e.value;\n        }\n    }\n    return null;\n}\n```\n\n#### å¹¶å‘é—®é¢˜åˆ†æ\n\nç°åœ¨æˆ‘ä»¬å·²ç»è¯´å®Œäº† put è¿‡ç¨‹å’Œ get è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° get è¿‡ç¨‹ä¸­æ˜¯æ²¡æœ‰åŠ é”çš„ï¼Œé‚£è‡ªç„¶æˆ‘ä»¬å°±éœ€è¦å»è€ƒè™‘å¹¶å‘é—®é¢˜ã€‚\n\næ·»åŠ èŠ‚ç‚¹çš„æ“ä½œ put å’Œåˆ é™¤èŠ‚ç‚¹çš„æ“ä½œ remove éƒ½æ˜¯è¦åŠ  segment ä¸Šçš„ç‹¬å é”çš„ï¼Œæ‰€ä»¥å®ƒä»¬ä¹‹é—´è‡ªç„¶ä¸ä¼šæœ‰é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘çš„é—®é¢˜å°±æ˜¯ get çš„æ—¶å€™åœ¨åŒä¸€ä¸ª segment ä¸­å‘ç”Ÿäº† put æˆ– remove æ“ä½œã€‚æ¨èé˜…è¯»ï¼š[30 ä¸ª Java é›†åˆé¢è¯•é—®é¢˜åŠç­”æ¡ˆ](https://mp.weixin.qq.com/s/Q5F604CUM_0x2co9mvADxw)ã€‚\n\n- **put æ“ä½œçš„çº¿ç¨‹å®‰å…¨æ€§**\n\n1. åˆå§‹åŒ–æ§½ï¼Œè¿™ä¸ªæˆ‘ä»¬ä¹‹å‰å°±è¯´è¿‡äº†ï¼Œä½¿ç”¨äº† CAS æ¥åˆå§‹åŒ– Segment ä¸­çš„æ•°ç»„ã€‚\n1. æ·»åŠ èŠ‚ç‚¹åˆ°é“¾è¡¨çš„æ“ä½œæ˜¯æ’å…¥åˆ°è¡¨å¤´çš„ï¼Œæ‰€ä»¥ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™ get æ“ä½œåœ¨é“¾è¡¨éå†çš„è¿‡ç¨‹å·²ç»åˆ°äº†ä¸­é—´ï¼Œæ˜¯ä¸ä¼šå½±å“çš„ã€‚å½“ç„¶ï¼Œå¦ä¸€ä¸ªå¹¶å‘é—®é¢˜å°±æ˜¯ get æ“ä½œåœ¨ put ä¹‹åï¼Œéœ€è¦ä¿è¯åˆšåˆšæ’å…¥è¡¨å¤´çš„èŠ‚ç‚¹è¢«è¯»å–ï¼Œè¿™ä¸ªä¾èµ–äº setEntryAt æ–¹æ³•ä¸­ä½¿ç”¨çš„ UNSAFE.putOrderedObjectã€‚\n3. æ‰©å®¹ã€‚æ‰©å®¹æ˜¯æ–°åˆ›å»ºäº†æ•°ç»„ï¼Œç„¶åè¿›è¡Œè¿ç§»æ•°æ®ï¼Œæœ€åé¢å°† newTable è®¾ç½®ç»™å±æ€§ tableã€‚æ‰€ä»¥ï¼Œå¦‚æœ get æ“ä½œæ­¤æ—¶ä¹Ÿåœ¨è¿›è¡Œï¼Œé‚£ä¹ˆä¹Ÿæ²¡å…³ç³»ï¼Œå¦‚æœ get å…ˆè¡Œï¼Œé‚£ä¹ˆå°±æ˜¯åœ¨æ—§çš„ table ä¸ŠåšæŸ¥è¯¢æ“ä½œï¼›è€Œ put å…ˆè¡Œï¼Œé‚£ä¹ˆ put æ“ä½œçš„å¯è§æ€§ä¿è¯å°±æ˜¯ table ä½¿ç”¨äº† volatile å…³é”®å­—ã€‚\n\n- **remove æ“ä½œçš„çº¿ç¨‹å®‰å…¨æ€§**\n\nremove æ“ä½œæˆ‘ä»¬æ²¡æœ‰åˆ†ææºç ï¼Œæ‰€ä»¥è¿™é‡Œè¯´çš„è¯»è€…æ„Ÿå…´è¶£çš„è¯è¿˜æ˜¯éœ€è¦åˆ°æºç ä¸­å»æ±‚å®ä¸€ä¸‹çš„ã€‚\n\nget æ“ä½œéœ€è¦éå†é“¾è¡¨ï¼Œä½†æ˜¯ remove æ“ä½œä¼šâ€ç ´åâ€é“¾è¡¨ã€‚\n\nå¦‚æœ remove ç ´åçš„èŠ‚ç‚¹ get æ“ä½œå·²ç»è¿‡å»äº†ï¼Œé‚£ä¹ˆè¿™é‡Œä¸å­˜åœ¨ä»»ä½•é—®é¢˜ã€‚\n\nå¦‚æœ remove å…ˆç ´åäº†ä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆ†ä¸¤ç§æƒ…å†µè€ƒè™‘ã€‚\n\n1ã€å¦‚æœæ­¤èŠ‚ç‚¹æ˜¯å¤´ç»“ç‚¹ï¼Œé‚£ä¹ˆéœ€è¦å°†å¤´ç»“ç‚¹çš„ next è®¾ç½®ä¸ºæ•°ç»„è¯¥ä½ç½®çš„å…ƒç´ ï¼Œtable è™½ç„¶ä½¿ç”¨äº† volatile ä¿®é¥°ï¼Œä½†æ˜¯ volatile å¹¶ä¸èƒ½æä¾›æ•°ç»„å†…éƒ¨æ“ä½œçš„å¯è§æ€§ä¿è¯ï¼Œæ‰€ä»¥æºç ä¸­ä½¿ç”¨äº† UNSAFE æ¥æ“ä½œæ•°ç»„ï¼Œè¯·çœ‹æ–¹æ³• setEntryAtã€‚\n\n2ã€å¦‚æœè¦åˆ é™¤çš„èŠ‚ç‚¹ä¸æ˜¯å¤´ç»“ç‚¹ï¼Œå®ƒä¼šå°†è¦åˆ é™¤èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹æ¥åˆ°å‰é©±èŠ‚ç‚¹ä¸­ï¼Œè¿™é‡Œçš„å¹¶å‘ä¿è¯å°±æ˜¯ next å±æ€§æ˜¯ volatile çš„ã€‚æ¨èé˜…è¯»ï¼š[å²ä¸Šæœ€å…¨ Java å¤šçº¿ç¨‹é¢è¯•é¢˜åŠç­”æ¡ˆ](https://mp.weixin.qq.com/s/0CI9od4DIxRrmOGFJw0SuQ)ã€‚\n\n## Java8 HashMap\n\nJava8 å¯¹ HashMap è¿›è¡Œäº†ä¸€äº›ä¿®æ”¹ï¼Œæœ€å¤§çš„ä¸åŒå°±æ˜¯åˆ©ç”¨äº†çº¢é»‘æ ‘ï¼Œæ‰€ä»¥å…¶ç”± **æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘** ç»„æˆã€‚\n\næ ¹æ® Java7 HashMap çš„ä»‹ç»ï¼Œæˆ‘ä»¬çŸ¥é“ï¼ŒæŸ¥æ‰¾çš„æ—¶å€™ï¼Œæ ¹æ® hash å€¼æˆ‘ä»¬èƒ½å¤Ÿå¿«é€Ÿå®šä½åˆ°æ•°ç»„çš„å…·ä½“ä¸‹æ ‡ï¼Œä½†æ˜¯ä¹‹åçš„è¯ï¼Œéœ€è¦é¡ºç€é“¾è¡¨ä¸€ä¸ªä¸ªæ¯”è¾ƒä¸‹å»æ‰èƒ½æ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„ï¼Œæ—¶é—´å¤æ‚åº¦å–å†³äºé“¾è¡¨çš„é•¿åº¦ï¼Œä¸º **O(n)**ã€‚\n\nä¸ºäº†é™ä½è¿™éƒ¨åˆ†çš„å¼€é”€ï¼Œåœ¨ Java8 ä¸­ï¼Œå½“é“¾è¡¨ä¸­çš„å…ƒç´ è¶…è¿‡äº† 8 ä¸ªä»¥åï¼Œä¼šå°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œåœ¨è¿™äº›ä½ç½®è¿›è¡ŒæŸ¥æ‰¾çš„æ—¶å€™å¯ä»¥é™ä½æ—¶é—´å¤æ‚åº¦ä¸º O(logN)ã€‚\n\næ¥ä¸€å¼ å›¾ç®€å•ç¤ºæ„ä¸€ä¸‹å§ï¼š\n\n![](http://qianniu.javastack.cn/18-12-4/75398751.jpg)\n\n> æ³¨æ„ï¼Œä¸Šå›¾æ˜¯ç¤ºæ„å›¾ï¼Œä¸»è¦æ˜¯æè¿°ç»“æ„ï¼Œä¸ä¼šè¾¾åˆ°è¿™ä¸ªçŠ¶æ€çš„ï¼Œå› ä¸ºè¿™ä¹ˆå¤šæ•°æ®çš„æ—¶å€™æ—©å°±æ‰©å®¹äº†ã€‚\n\nä¸‹é¢ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç”¨ä»£ç æ¥ä»‹ç»å§ï¼Œä¸ªäººæ„Ÿè§‰ï¼ŒJava8 çš„æºç å¯è¯»æ€§è¦å·®ä¸€äº›ï¼Œä¸è¿‡ç²¾ç®€ä¸€äº›ã€‚\n\nJava7 ä¸­ä½¿ç”¨ Entry æ¥ä»£è¡¨æ¯ä¸ª HashMap ä¸­çš„æ•°æ®èŠ‚ç‚¹ï¼ŒJava8 ä¸­ä½¿ç”¨ **Node**ï¼ŒåŸºæœ¬æ²¡æœ‰åŒºåˆ«ï¼Œéƒ½æ˜¯ keyï¼Œvalueï¼Œhash å’Œ next è¿™å››ä¸ªå±æ€§ï¼Œä¸è¿‡ï¼ŒNode åªèƒ½ç”¨äºé“¾è¡¨çš„æƒ…å†µï¼Œçº¢é»‘æ ‘çš„æƒ…å†µéœ€è¦ä½¿ç”¨ **TreeNode**ã€‚\n\næˆ‘ä»¬æ ¹æ®æ•°ç»„å…ƒç´ ä¸­ï¼Œç¬¬ä¸€ä¸ªèŠ‚ç‚¹æ•°æ®ç±»å‹æ˜¯ Node è¿˜æ˜¯ TreeNode æ¥åˆ¤æ–­è¯¥ä½ç½®ä¸‹æ˜¯é“¾è¡¨è¿˜æ˜¯çº¢é»‘æ ‘çš„ã€‚æ¨èé˜…è¯»ï¼š[30 ä¸ª Java é›†åˆé¢è¯•é—®é¢˜åŠç­”æ¡ˆ](https://mp.weixin.qq.com/s/Q5F604CUM_0x2co9mvADxw)ã€‚\n\n#### put è¿‡ç¨‹åˆ†æ\n\n```\npublic V put(K key, V value) {\n    return putVal(hash(key), key, value, false, true);\n}\n \n// ç¬¬ä¸‰ä¸ªå‚æ•° onlyIfAbsent å¦‚æœæ˜¯ trueï¼Œé‚£ä¹ˆåªæœ‰åœ¨ä¸å­˜åœ¨è¯¥ key æ—¶æ‰ä¼šè¿›è¡Œ put æ“ä½œ\n// ç¬¬å››ä¸ªå‚æ•° evict æˆ‘ä»¬è¿™é‡Œä¸å…³å¿ƒ\nfinal V putVal(int hash, K key, V value, boolean onlyIfAbsent,\n               boolean evict) {\n    Node<K,V>[] tab; Node<K,V> p; int n, i;\n    // ç¬¬ä¸€æ¬¡ put å€¼çš„æ—¶å€™ï¼Œä¼šè§¦å‘ä¸‹é¢çš„ resize()ï¼Œç±»ä¼¼ java7 çš„ç¬¬ä¸€æ¬¡ put ä¹Ÿè¦åˆå§‹åŒ–æ•°ç»„é•¿åº¦\n    // ç¬¬ä¸€æ¬¡ resize å’Œåç»­çš„æ‰©å®¹æœ‰äº›ä¸ä¸€æ ·ï¼Œå› ä¸ºè¿™æ¬¡æ˜¯æ•°ç»„ä» null åˆå§‹åŒ–åˆ°é»˜è®¤çš„ 16 æˆ–è‡ªå®šä¹‰çš„åˆå§‹å®¹é‡\n    if ((tab = table) == null || (n = tab.length) == 0)\n        n = (tab = resize()).length;\n    // æ‰¾åˆ°å…·ä½“çš„æ•°ç»„ä¸‹æ ‡ï¼Œå¦‚æœæ­¤ä½ç½®æ²¡æœ‰å€¼ï¼Œé‚£ä¹ˆç›´æ¥åˆå§‹åŒ–ä¸€ä¸‹ Node å¹¶æ”¾ç½®åœ¨è¿™ä¸ªä½ç½®å°±å¯ä»¥äº†\n    if ((p = tab[i = (n - 1) & hash]) == null)\n        tab[i] = newNode(hash, key, value, null);\n \n    else {// æ•°ç»„è¯¥ä½ç½®æœ‰æ•°æ®\n        Node<K,V> e; K k;\n        // é¦–å…ˆï¼Œåˆ¤æ–­è¯¥ä½ç½®çš„ç¬¬ä¸€ä¸ªæ•°æ®å’Œæˆ‘ä»¬è¦æ’å…¥çš„æ•°æ®ï¼Œkey æ˜¯ä¸æ˜¯\"ç›¸ç­‰\"ï¼Œå¦‚æœæ˜¯ï¼Œå–å‡ºè¿™ä¸ªèŠ‚ç‚¹\n        if (p.hash == hash &&\n            ((k = p.key) == key || (key != null && key.equals(k))))\n            e = p;\n        // å¦‚æœè¯¥èŠ‚ç‚¹æ˜¯ä»£è¡¨çº¢é»‘æ ‘çš„èŠ‚ç‚¹ï¼Œè°ƒç”¨çº¢é»‘æ ‘çš„æ’å€¼æ–¹æ³•ï¼Œæœ¬æ–‡ä¸å±•å¼€è¯´çº¢é»‘æ ‘\n        else if (p instanceof TreeNode)\n            e = ((TreeNode<K,V>)p).putTreeVal(this, tab, hash, key, value);\n        else {\n            // åˆ°è¿™é‡Œï¼Œè¯´æ˜æ•°ç»„è¯¥ä½ç½®ä¸Šæ˜¯ä¸€ä¸ªé“¾è¡¨\n            for (int binCount = 0; ; ++binCount) {\n                // æ’å…¥åˆ°é“¾è¡¨çš„æœ€åé¢(Java7 æ˜¯æ’å…¥åˆ°é“¾è¡¨çš„æœ€å‰é¢)\n                if ((e = p.next) == null) {\n                    p.next = newNode(hash, key, value, null);\n                    // TREEIFY_THRESHOLD ä¸º 8ï¼Œæ‰€ä»¥ï¼Œå¦‚æœæ–°æ’å…¥çš„å€¼æ˜¯é“¾è¡¨ä¸­çš„ç¬¬ 9 ä¸ª\n                    // ä¼šè§¦å‘ä¸‹é¢çš„ treeifyBinï¼Œä¹Ÿå°±æ˜¯å°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘\n                    if (binCount >= TREEIFY_THRESHOLD - 1) // -1 for 1st\n                        treeifyBin(tab, hash);\n                    break;\n                }\n                // å¦‚æœåœ¨è¯¥é“¾è¡¨ä¸­æ‰¾åˆ°äº†\"ç›¸ç­‰\"çš„ key(== æˆ– equals)\n                if (e.hash == hash &&\n                    ((k = e.key) == key || (key != null && key.equals(k))))\n                    // æ­¤æ—¶ breakï¼Œé‚£ä¹ˆ e ä¸ºé“¾è¡¨ä¸­[ä¸è¦æ’å…¥çš„æ–°å€¼çš„ key \"ç›¸ç­‰\"]çš„ node\n                    break;\n                p = e;\n            }\n        }\n        // e!=null è¯´æ˜å­˜åœ¨æ—§å€¼çš„keyä¸è¦æ’å…¥çš„key\"ç›¸ç­‰\"\n        // å¯¹äºæˆ‘ä»¬åˆ†æçš„putæ“ä½œï¼Œä¸‹é¢è¿™ä¸ª if å…¶å®å°±æ˜¯è¿›è¡Œ \"å€¼è¦†ç›–\"ï¼Œç„¶åè¿”å›æ—§å€¼\n        if (e != null) {\n            V oldValue = e.value;\n            if (!onlyIfAbsent || oldValue == null)\n                e.value = value;\n            afterNodeAccess(e);\n            return oldValue;\n        }\n    }\n    ++modCount;\n    // å¦‚æœ HashMap ç”±äºæ–°æ’å…¥è¿™ä¸ªå€¼å¯¼è‡´ size å·²ç»è¶…è¿‡äº†é˜ˆå€¼ï¼Œéœ€è¦è¿›è¡Œæ‰©å®¹\n    if (++size > threshold)\n        resize();\n    afterNodeInsertion(evict);\n    return null;\n}\n```\n\nå’Œ Java7 ç¨å¾®æœ‰ç‚¹ä¸ä¸€æ ·çš„åœ°æ–¹å°±æ˜¯ï¼ŒJava7 æ˜¯å…ˆæ‰©å®¹åæ’å…¥æ–°å€¼çš„ï¼ŒJava8 å…ˆæ’å€¼å†æ‰©å®¹ï¼Œä¸è¿‡è¿™ä¸ªä¸é‡è¦ã€‚\n\n###### æ•°ç»„æ‰©å®¹\n\nresize() æ–¹æ³•ç”¨äº**åˆå§‹åŒ–æ•°ç»„æˆ–æ•°ç»„æ‰©å®¹**ï¼Œæ¯æ¬¡æ‰©å®¹åï¼Œå®¹é‡ä¸ºåŸæ¥çš„ 2 å€ï¼Œå¹¶è¿›è¡Œæ•°æ®è¿ç§»ã€‚\n\n```\nfinal Node<K,V>[] resize() {\n    Node<K,V>[] oldTab = table;\n    int oldCap = (oldTab == null) ? 0 : oldTab.length;\n    int oldThr = threshold;\n    int newCap, newThr = 0;\n    if (oldCap > 0) { // å¯¹åº”æ•°ç»„æ‰©å®¹\n        if (oldCap >= MAXIMUM_CAPACITY) {\n            threshold = Integer.MAX_VALUE;\n            return oldTab;\n        }\n        // å°†æ•°ç»„å¤§å°æ‰©å¤§ä¸€å€\n        else if ((newCap = oldCap << 1) < MAXIMUM_CAPACITY &&\n                 oldCap >= DEFAULT_INITIAL_CAPACITY)\n            // å°†é˜ˆå€¼æ‰©å¤§ä¸€å€\n            newThr = oldThr << 1; // double threshold\n    }\n    else if (oldThr > 0) // å¯¹åº”ä½¿ç”¨ new HashMap(int initialCapacity) åˆå§‹åŒ–åï¼Œç¬¬ä¸€æ¬¡ put çš„æ—¶å€™\n        newCap = oldThr;\n    else {// å¯¹åº”ä½¿ç”¨ new HashMap() åˆå§‹åŒ–åï¼Œç¬¬ä¸€æ¬¡ put çš„æ—¶å€™\n        newCap = DEFAULT_INITIAL_CAPACITY;\n        newThr = (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);\n    }\n \n    if (newThr == 0) {\n        float ft = (float)newCap * loadFactor;\n        newThr = (newCap < MAXIMUM_CAPACITY && ft < (float)MAXIMUM_CAPACITY ?\n                  (int)ft : Integer.MAX_VALUE);\n    }\n    threshold = newThr;\n \n    // ç”¨æ–°çš„æ•°ç»„å¤§å°åˆå§‹åŒ–æ–°çš„æ•°ç»„\n    Node<K,V>[] newTab = (Node<K,V>[])new Node[newCap];\n    table = newTab; // å¦‚æœæ˜¯åˆå§‹åŒ–æ•°ç»„ï¼Œåˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œè¿”å› newTab å³å¯\n \n    if (oldTab != null) {\n        // å¼€å§‹éå†åŸæ•°ç»„ï¼Œè¿›è¡Œæ•°æ®è¿ç§»ã€‚\n        for (int j = 0; j < oldCap; ++j) {\n            Node<K,V> e;\n            if ((e = oldTab[j]) != null) {\n                oldTab[j] = null;\n                // å¦‚æœè¯¥æ•°ç»„ä½ç½®ä¸Šåªæœ‰å•ä¸ªå…ƒç´ ï¼Œé‚£å°±ç®€å•äº†ï¼Œç®€å•è¿ç§»è¿™ä¸ªå…ƒç´ å°±å¯ä»¥äº†\n                if (e.next == null)\n                    newTab[e.hash & (newCap - 1)] = e;\n                // å¦‚æœæ˜¯çº¢é»‘æ ‘ï¼Œå…·ä½“æˆ‘ä»¬å°±ä¸å±•å¼€äº†\n                else if (e instanceof TreeNode)\n                    ((TreeNode<K,V>)e).split(this, newTab, j, oldCap);\n                else { \n                    // è¿™å—æ˜¯å¤„ç†é“¾è¡¨çš„æƒ…å†µï¼Œ\n                    // éœ€è¦å°†æ­¤é“¾è¡¨æ‹†æˆä¸¤ä¸ªé“¾è¡¨ï¼Œæ”¾åˆ°æ–°çš„æ•°ç»„ä¸­ï¼Œå¹¶ä¸”ä¿ç•™åŸæ¥çš„å…ˆåé¡ºåº\n                    // loHeadã€loTail å¯¹åº”ä¸€æ¡é“¾è¡¨ï¼ŒhiHeadã€hiTail å¯¹åº”å¦ä¸€æ¡é“¾è¡¨ï¼Œä»£ç è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„\n                    Node<K,V> loHead = null, loTail = null;\n                    Node<K,V> hiHead = null, hiTail = null;\n                    Node<K,V> next;\n                    do {\n                        next = e.next;\n                        if ((e.hash & oldCap) == 0) {\n                            if (loTail == null)\n                                loHead = e;\n                            else\n                                loTail.next = e;\n                            loTail = e;\n                        }\n                        else {\n                            if (hiTail == null)\n                                hiHead = e;\n                            else\n                                hiTail.next = e;\n                            hiTail = e;\n                        }\n                    } while ((e = next) != null);\n                    if (loTail != null) {\n                        loTail.next = null;\n                        // ç¬¬ä¸€æ¡é“¾è¡¨\n                        newTab[j] = loHead;\n                    }\n                    if (hiTail != null) {\n                        hiTail.next = null;\n                        // ç¬¬äºŒæ¡é“¾è¡¨çš„æ–°çš„ä½ç½®æ˜¯ j + oldCapï¼Œè¿™ä¸ªå¾ˆå¥½ç†è§£\n                        newTab[j + oldCap] = hiHead;\n                    }\n                }\n            }\n        }\n    }\n    return newTab;\n}\n```\n\n#### get è¿‡ç¨‹åˆ†æ\n\nç›¸å¯¹äº put æ¥è¯´ï¼Œget çœŸçš„å¤ªç®€å•äº†ã€‚\n\n1. è®¡ç®— key çš„ hash å€¼ï¼Œæ ¹æ® hash å€¼æ‰¾åˆ°å¯¹åº”æ•°ç»„ä¸‹æ ‡: hash & (length-1)\n2. åˆ¤æ–­æ•°ç»„è¯¥ä½ç½®å¤„çš„å…ƒç´ æ˜¯å¦åˆšå¥½å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„ï¼Œå¦‚æœä¸æ˜¯ï¼Œèµ°ç¬¬ä¸‰æ­¥\n3. åˆ¤æ–­è¯¥å…ƒç´ ç±»å‹æ˜¯å¦æ˜¯ TreeNodeï¼Œå¦‚æœæ˜¯ï¼Œç”¨çº¢é»‘æ ‘çš„æ–¹æ³•å–æ•°æ®ï¼Œå¦‚æœä¸æ˜¯ï¼Œèµ°ç¬¬å››æ­¥\n4. éå†é“¾è¡¨ï¼Œç›´åˆ°æ‰¾åˆ°ç›¸ç­‰(==æˆ–equals)çš„ key.\n\n```\npublic V get(Object key) {\n    Node<K,V> e;\n    return (e = getNode(hash(key), key)) == null ? null : e.value;\n}\n```\n\n```\nfinal Node<K,V> getNode(int hash, Object key) {\n    Node<K,V>[] tab; Node<K,V> first, e; int n; K k;\n    if ((tab = table) != null && (n = tab.length) > 0 &&\n        (first = tab[(n - 1) & hash]) != null) {\n        // åˆ¤æ–­ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æ˜¯ä¸æ˜¯å°±æ˜¯éœ€è¦çš„\n        if (first.hash == hash && // always check first node\n            ((k = first.key) == key || (key != null && key.equals(k))))\n            return first;\n        if ((e = first.next) != null) {\n            // åˆ¤æ–­æ˜¯å¦æ˜¯çº¢é»‘æ ‘\n            if (first instanceof TreeNode)\n                return ((TreeNode<K,V>)first).getTreeNode(hash, key);\n \n            // é“¾è¡¨éå†\n            do {\n                if (e.hash == hash &&\n                    ((k = e.key) == key || (key != null && key.equals(k))))\n                    return e;\n            } while ((e = e.next) != null);\n        }\n    }\n    return null;\n}\n```\n\n## Java8 ConcurrentHashMap\n\nJava7 ä¸­å®ç°çš„ ConcurrentHashMap è¯´å®è¯è¿˜æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼ŒJava8 å¯¹ ConcurrentHashMap è¿›è¡Œäº†æ¯”è¾ƒå¤§çš„æ”¹åŠ¨ã€‚å»ºè®®è¯»è€…å¯ä»¥å‚è€ƒ Java8 ä¸­ HashMap ç›¸å¯¹äº Java7 HashMap çš„æ”¹åŠ¨ï¼Œå¯¹äº ConcurrentHashMapï¼ŒJava8 ä¹Ÿå¼•å…¥äº†çº¢é»‘æ ‘ã€‚\n\nè¯´å®è¯ï¼ŒJava8 ConcurrentHashMap æºç çœŸå¿ƒä¸ç®€å•ï¼Œæœ€éš¾çš„åœ¨äºæ‰©å®¹ï¼Œæ•°æ®è¿ç§»æ“ä½œä¸å®¹æ˜“çœ‹æ‡‚ã€‚\n\næˆ‘ä»¬å…ˆç”¨ä¸€ä¸ªç¤ºæ„å›¾æ¥æè¿°ä¸‹å…¶ç»“æ„ï¼š\n\n![](http://qianniu.javastack.cn/18-12-4/335817.jpg)\n\nç»“æ„ä¸Šå’Œ Java8 çš„ HashMap åŸºæœ¬ä¸Šä¸€æ ·ï¼Œä¸è¿‡å®ƒè¦ä¿è¯çº¿ç¨‹å®‰å…¨æ€§ï¼Œæ‰€ä»¥åœ¨æºç ä¸Šç¡®å®è¦å¤æ‚ä¸€äº›ã€‚æ¨èé˜…è¯»ï¼š[å‡ ç§çº¿ç¨‹å®‰å…¨çš„Mapè§£æ](https://mp.weixin.qq.com/s/5Y5_6qn2g6kIVmQia_0R6g)ã€‚\n\n#### åˆå§‹åŒ–\n\n```\n// è¿™æ„é€ å‡½æ•°é‡Œï¼Œä»€ä¹ˆéƒ½ä¸å¹²\npublic ConcurrentHashMap() {\n}\npublic ConcurrentHashMap(int initialCapacity) {\n    if (initialCapacity < 0)\n        throw new IllegalArgumentException();\n    int cap = ((initialCapacity >= (MAXIMUM_CAPACITY >>> 1)) ?\n               MAXIMUM_CAPACITY :\n               tableSizeFor(initialCapacity + (initialCapacity >>> 1) + 1));\n    this.sizeCtl = cap;\n}\n```\n\nè¿™ä¸ªåˆå§‹åŒ–æ–¹æ³•æœ‰ç‚¹æ„æ€ï¼Œé€šè¿‡æä¾›åˆå§‹å®¹é‡ï¼Œè®¡ç®—äº† sizeCtlï¼ŒsizeCtl = ã€ (1.5 * initialCapacity + 1)ï¼Œç„¶åå‘ä¸Šå–æœ€è¿‘çš„ 2 çš„ n æ¬¡æ–¹ã€‘ã€‚å¦‚ initialCapacity ä¸º 10ï¼Œé‚£ä¹ˆå¾—åˆ° sizeCtl ä¸º 16ï¼Œå¦‚æœ initialCapacity ä¸º 11ï¼Œå¾—åˆ° sizeCtl ä¸º 32ã€‚\n\nsizeCtl è¿™ä¸ªå±æ€§ä½¿ç”¨çš„åœºæ™¯å¾ˆå¤šï¼Œä¸è¿‡åªè¦è·Ÿç€æ–‡ç« çš„æ€è·¯æ¥ï¼Œå°±ä¸ä¼šè¢«å®ƒææ™•äº†ã€‚\n\nå¦‚æœä½ çˆ±æŠ˜è…¾ï¼Œä¹Ÿå¯ä»¥çœ‹ä¸‹å¦ä¸€ä¸ªæœ‰ä¸‰ä¸ªå‚æ•°çš„æ„é€ æ–¹æ³•ï¼Œè¿™é‡Œæˆ‘å°±ä¸è¯´äº†ï¼Œå¤§éƒ¨åˆ†æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨æ— å‚æ„é€ å‡½æ•°è¿›è¡Œå®ä¾‹åŒ–ï¼Œæˆ‘ä»¬ä¹ŸæŒ‰ç…§è¿™ä¸ªæ€è·¯æ¥è¿›è¡Œæºç åˆ†æå§ã€‚\n\n#### put è¿‡ç¨‹åˆ†æ\n\nä»”ç»†åœ°ä¸€è¡Œä¸€è¡Œä»£ç çœ‹ä¸‹å»ï¼š\n\n```\npublic V put(K key, V value) {\n    return putVal(key, value, false);\n}\nfinal V putVal(K key, V value, boolean onlyIfAbsent) {\n    if (key == null || value == null) throw new NullPointerException();\n    // å¾—åˆ° hash å€¼\n    int hash = spread(key.hashCode());\n    // ç”¨äºè®°å½•ç›¸åº”é“¾è¡¨çš„é•¿åº¦\n    int binCount = 0;\n    for (Node<K,V>[] tab = table;;) {\n        Node<K,V> f; int n, i, fh;\n        // å¦‚æœæ•°ç»„\"ç©º\"ï¼Œè¿›è¡Œæ•°ç»„åˆå§‹åŒ–\n        if (tab == null || (n = tab.length) == 0)\n            // åˆå§‹åŒ–æ•°ç»„ï¼Œåé¢ä¼šè¯¦ç»†ä»‹ç»\n            tab = initTable();\n \n        // æ‰¾è¯¥ hash å€¼å¯¹åº”çš„æ•°ç»„ä¸‹æ ‡ï¼Œå¾—åˆ°ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ f\n        else if ((f = tabAt(tab, i = (n - 1) & hash)) == null) {\n            // å¦‚æœæ•°ç»„è¯¥ä½ç½®ä¸ºç©ºï¼Œ\n            //    ç”¨ä¸€æ¬¡ CAS æ“ä½œå°†è¿™ä¸ªæ–°å€¼æ”¾å…¥å…¶ä¸­å³å¯ï¼Œè¿™ä¸ª put æ“ä½œå·®ä¸å¤šå°±ç»“æŸäº†ï¼Œå¯ä»¥æ‹‰åˆ°æœ€åé¢äº†\n            //          å¦‚æœ CAS å¤±è´¥ï¼Œé‚£å°±æ˜¯æœ‰å¹¶å‘æ“ä½œï¼Œè¿›åˆ°ä¸‹ä¸€ä¸ªå¾ªç¯å°±å¥½äº†\n            if (casTabAt(tab, i, null,\n                         new Node<K,V>(hash, key, value, null)))\n                break;                   // no lock when adding to empty bin\n        }\n        // hash å±…ç„¶å¯ä»¥ç­‰äº MOVEDï¼Œè¿™ä¸ªéœ€è¦åˆ°åé¢æ‰èƒ½çœ‹æ˜ç™½ï¼Œä¸è¿‡ä»åå­—ä¸Šä¹Ÿèƒ½çŒœåˆ°ï¼Œè‚¯å®šæ˜¯å› ä¸ºåœ¨æ‰©å®¹\n        else if ((fh = f.hash) == MOVED)\n            // å¸®åŠ©æ•°æ®è¿ç§»ï¼Œè¿™ä¸ªç­‰åˆ°çœ‹å®Œæ•°æ®è¿ç§»éƒ¨åˆ†çš„ä»‹ç»åï¼Œå†ç†è§£è¿™ä¸ªå°±å¾ˆç®€å•äº†\n            tab = helpTransfer(tab, f);\n \n        else { // åˆ°è¿™é‡Œå°±æ˜¯è¯´ï¼Œf æ˜¯è¯¥ä½ç½®çš„å¤´ç»“ç‚¹ï¼Œè€Œä¸”ä¸ä¸ºç©º\n \n            V oldVal = null;\n            // è·å–æ•°ç»„è¯¥ä½ç½®çš„å¤´ç»“ç‚¹çš„ç›‘è§†å™¨é”\n            synchronized (f) {\n                if (tabAt(tab, i) == f) {\n                    if (fh >= 0) { // å¤´ç»“ç‚¹çš„ hash å€¼å¤§äº 0ï¼Œè¯´æ˜æ˜¯é“¾è¡¨\n                        // ç”¨äºç´¯åŠ ï¼Œè®°å½•é“¾è¡¨çš„é•¿åº¦\n                        binCount = 1;\n                        // éå†é“¾è¡¨\n                        for (Node<K,V> e = f;; ++binCount) {\n                            K ek;\n                            // å¦‚æœå‘ç°äº†\"ç›¸ç­‰\"çš„ keyï¼Œåˆ¤æ–­æ˜¯å¦è¦è¿›è¡Œå€¼è¦†ç›–ï¼Œç„¶åä¹Ÿå°±å¯ä»¥ break äº†\n                            if (e.hash == hash &&\n                                ((ek = e.key) == key ||\n                                 (ek != null && key.equals(ek)))) {\n                                oldVal = e.val;\n                                if (!onlyIfAbsent)\n                                    e.val = value;\n                                break;\n                            }\n                            // åˆ°äº†é“¾è¡¨çš„æœ€æœ«ç«¯ï¼Œå°†è¿™ä¸ªæ–°å€¼æ”¾åˆ°é“¾è¡¨çš„æœ€åé¢\n                            Node<K,V> pred = e;\n                            if ((e = e.next) == null) {\n                                pred.next = new Node<K,V>(hash, key,\n                                                          value, null);\n                                break;\n                            }\n                        }\n                    }\n                    else if (f instanceof TreeBin) { // çº¢é»‘æ ‘\n                        Node<K,V> p;\n                        binCount = 2;\n                        // è°ƒç”¨çº¢é»‘æ ‘çš„æ’å€¼æ–¹æ³•æ’å…¥æ–°èŠ‚ç‚¹\n                        if ((p = ((TreeBin<K,V>)f).putTreeVal(hash, key,\n                                                       value)) != null) {\n                            oldVal = p.val;\n                            if (!onlyIfAbsent)\n                                p.val = value;\n                        }\n                    }\n                }\n            }\n            // binCount != 0 è¯´æ˜ä¸Šé¢åœ¨åšé“¾è¡¨æ“ä½œ\n            if (binCount != 0) {\n                // åˆ¤æ–­æ˜¯å¦è¦å°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œä¸´ç•Œå€¼å’Œ HashMap ä¸€æ ·ï¼Œä¹Ÿæ˜¯ 8\n                if (binCount >= TREEIFY_THRESHOLD)\n                    // è¿™ä¸ªæ–¹æ³•å’Œ HashMap ä¸­ç¨å¾®æœ‰ä¸€ç‚¹ç‚¹ä¸åŒï¼Œé‚£å°±æ˜¯å®ƒä¸æ˜¯ä¸€å®šä¼šè¿›è¡Œçº¢é»‘æ ‘è½¬æ¢ï¼Œ\n                    // å¦‚æœå½“å‰æ•°ç»„çš„é•¿åº¦å°äº 64ï¼Œé‚£ä¹ˆä¼šé€‰æ‹©è¿›è¡Œæ•°ç»„æ‰©å®¹ï¼Œè€Œä¸æ˜¯è½¬æ¢ä¸ºçº¢é»‘æ ‘\n                    //    å…·ä½“æºç æˆ‘ä»¬å°±ä¸çœ‹äº†ï¼Œæ‰©å®¹éƒ¨åˆ†åé¢è¯´\n                    treeifyBin(tab, i);\n                if (oldVal != null)\n                    return oldVal;\n                break;\n            }\n        }\n    }\n    // \n    addCount(1L, binCount);\n    return null;\n}\n```\n\nput çš„ä¸»æµç¨‹çœ‹å®Œäº†ï¼Œä½†æ˜¯è‡³å°‘ç•™ä¸‹äº†å‡ ä¸ªé—®é¢˜ï¼Œç¬¬ä¸€ä¸ªæ˜¯åˆå§‹åŒ–ï¼Œç¬¬äºŒä¸ªæ˜¯æ‰©å®¹ï¼Œç¬¬ä¸‰ä¸ªæ˜¯å¸®åŠ©æ•°æ®è¿ç§»ï¼Œè¿™äº›æˆ‘ä»¬éƒ½ä¼šåœ¨åé¢è¿›è¡Œä¸€ä¸€ä»‹ç»ã€‚\n\n###### åˆå§‹åŒ–æ•°ç»„ï¼šinitTable\n\nè¿™ä¸ªæ¯”è¾ƒç®€å•ï¼Œä¸»è¦å°±æ˜¯åˆå§‹åŒ–ä¸€ä¸ªåˆé€‚å¤§å°çš„æ•°ç»„ï¼Œç„¶åä¼šè®¾ç½® sizeCtlã€‚\n\nåˆå§‹åŒ–æ–¹æ³•ä¸­çš„å¹¶å‘é—®é¢˜æ˜¯é€šè¿‡å¯¹ sizeCtl è¿›è¡Œä¸€ä¸ª CAS æ“ä½œæ¥æ§åˆ¶çš„ã€‚\n\n```\nprivate final Node<K,V>[] initTable() {\n    Node<K,V>[] tab; int sc;\n    while ((tab = table) == null || tab.length == 0) {\n        // åˆå§‹åŒ–çš„\"åŠŸåŠ³\"è¢«å…¶ä»–çº¿ç¨‹\"æŠ¢å»\"äº†\n        if ((sc = sizeCtl) < 0)\n            Thread.yield(); // lost initialization race; just spin\n        // CAS ä¸€ä¸‹ï¼Œå°† sizeCtl è®¾ç½®ä¸º -1ï¼Œä»£è¡¨æŠ¢åˆ°äº†é”\n        else if (U.compareAndSwapInt(this, SIZECTL, sc, -1)) {\n            try {\n                if ((tab = table) == null || tab.length == 0) {\n                    // DEFAULT_CAPACITY é»˜è®¤åˆå§‹å®¹é‡æ˜¯ 16\n                    int n = (sc > 0) ? sc : DEFAULT_CAPACITY;\n                    // åˆå§‹åŒ–æ•°ç»„ï¼Œé•¿åº¦ä¸º 16 æˆ–åˆå§‹åŒ–æ—¶æä¾›çš„é•¿åº¦\n                    Node<K,V>[] nt = (Node<K,V>[])new Node<?,?>[n];\n                    // å°†è¿™ä¸ªæ•°ç»„èµ‹å€¼ç»™ tableï¼Œtable æ˜¯ volatile çš„\n                    table = tab = nt;\n                    // å¦‚æœ n ä¸º 16 çš„è¯ï¼Œé‚£ä¹ˆè¿™é‡Œ sc = 12\n                    // å…¶å®å°±æ˜¯ 0.75 * n\n                    sc = n - (n >>> 2);\n                }\n            } finally {\n                // è®¾ç½® sizeCtl ä¸º scï¼Œæˆ‘ä»¬å°±å½“æ˜¯ 12 å§\n                sizeCtl = sc;\n            }\n            break;\n        }\n    }\n    return tab;\n}\n```\n\n###### é“¾è¡¨è½¬çº¢é»‘æ ‘: treeifyBin\n\nå‰é¢æˆ‘ä»¬åœ¨ put æºç åˆ†æä¹Ÿè¯´è¿‡ï¼ŒtreeifyBin ä¸ä¸€å®šå°±ä¼šè¿›è¡Œçº¢é»‘æ ‘è½¬æ¢ï¼Œä¹Ÿå¯èƒ½æ˜¯ä»…ä»…åšæ•°ç»„æ‰©å®¹ã€‚æˆ‘ä»¬è¿˜æ˜¯è¿›è¡Œæºç åˆ†æå§ã€‚\n\n```\nprivate final void treeifyBin(Node<K,V>[] tab, int index) {\n    Node<K,V> b; int n, sc;\n    if (tab != null) {\n        // MIN_TREEIFY_CAPACITY ä¸º 64\n        // æ‰€ä»¥ï¼Œå¦‚æœæ•°ç»„é•¿åº¦å°äº 64 çš„æ—¶å€™ï¼Œå…¶å®ä¹Ÿå°±æ˜¯ 32 æˆ–è€… 16 æˆ–è€…æ›´å°çš„æ—¶å€™ï¼Œä¼šè¿›è¡Œæ•°ç»„æ‰©å®¹\n        if ((n = tab.length) < MIN_TREEIFY_CAPACITY)\n            // åé¢æˆ‘ä»¬å†è¯¦ç»†åˆ†æè¿™ä¸ªæ–¹æ³•\n            tryPresize(n << 1);\n        // b æ˜¯å¤´ç»“ç‚¹\n        else if ((b = tabAt(tab, index)) != null && b.hash >= 0) {\n            // åŠ é”\n            synchronized (b) {\n \n                if (tabAt(tab, index) == b) {\n                    // ä¸‹é¢å°±æ˜¯éå†é“¾è¡¨ï¼Œå»ºç«‹ä¸€é¢—çº¢é»‘æ ‘\n                    TreeNode<K,V> hd = null, tl = null;\n                    for (Node<K,V> e = b; e != null; e = e.next) {\n                        TreeNode<K,V> p =\n                            new TreeNode<K,V>(e.hash, e.key, e.val,\n                                              null, null);\n                        if ((p.prev = tl) == null)\n                            hd = p;\n                        else\n                            tl.next = p;\n                        tl = p;\n                    }\n                    // å°†çº¢é»‘æ ‘è®¾ç½®åˆ°æ•°ç»„ç›¸åº”ä½ç½®ä¸­\n                    setTabAt(tab, index, new TreeBin<K,V>(hd));\n                }\n            }\n        }\n    }\n}\n```\n\n\n#### æ‰©å®¹ï¼štryPresize\n\nå¦‚æœè¯´ Java8 ConcurrentHashMap çš„æºç ä¸ç®€å•ï¼Œé‚£ä¹ˆè¯´çš„å°±æ˜¯æ‰©å®¹æ“ä½œå’Œè¿ç§»æ“ä½œã€‚\n\nè¿™ä¸ªæ–¹æ³•è¦å®Œå®Œå…¨å…¨çœ‹æ‡‚è¿˜éœ€è¦çœ‹ä¹‹åçš„ transfer æ–¹æ³•ï¼Œè¯»è€…åº”è¯¥æå‰çŸ¥é“è¿™ç‚¹ã€‚\n\nè¿™é‡Œçš„æ‰©å®¹ä¹Ÿæ˜¯åšç¿»å€æ‰©å®¹çš„ï¼Œæ‰©å®¹åæ•°ç»„å®¹é‡ä¸ºåŸæ¥çš„ 2 å€ã€‚\n\n```\n// é¦–å…ˆè¦è¯´æ˜çš„æ˜¯ï¼Œæ–¹æ³•å‚æ•° size ä¼ è¿›æ¥çš„æ—¶å€™å°±å·²ç»ç¿»äº†å€äº†\nprivate final void tryPresize(int size) {\n    // cï¼šsize çš„ 1.5 å€ï¼Œå†åŠ  1ï¼Œå†å¾€ä¸Šå–æœ€è¿‘çš„ 2 çš„ n æ¬¡æ–¹ã€‚\n    int c = (size >= (MAXIMUM_CAPACITY >>> 1)) ? MAXIMUM_CAPACITY :\n        tableSizeFor(size + (size >>> 1) + 1);\n    int sc;\n    while ((sc = sizeCtl) >= 0) {\n        Node<K,V>[] tab = table; int n;\n \n        // è¿™ä¸ª if åˆ†æ”¯å’Œä¹‹å‰è¯´çš„åˆå§‹åŒ–æ•°ç»„çš„ä»£ç åŸºæœ¬ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥ä¸ç”¨ç®¡è¿™å—ä»£ç \n        if (tab == null || (n = tab.length) == 0) {\n            n = (sc > c) ? sc : c;\n            if (U.compareAndSwapInt(this, SIZECTL, sc, -1)) {\n                try {\n                    if (table == tab) {\n                        @SuppressWarnings(\"unchecked\")\n                        Node<K,V>[] nt = (Node<K,V>[])new Node<?,?>[n];\n                        table = nt;\n                        sc = n - (n >>> 2); // 0.75 * n\n                    }\n                } finally {\n                    sizeCtl = sc;\n                }\n            }\n        }\n        else if (c <= sc || n >= MAXIMUM_CAPACITY)\n            break;\n        else if (tab == table) {\n            // æˆ‘æ²¡çœ‹æ‡‚ rs çš„çœŸæ­£å«ä¹‰æ˜¯ä»€ä¹ˆï¼Œä¸è¿‡ä¹Ÿå…³ç³»ä¸å¤§\n            int rs = resizeStamp(n);\n \n            if (sc < 0) {\n                Node<K,V>[] nt;\n                if ((sc >>> RESIZE_STAMP_SHIFT) != rs || sc == rs + 1 ||\n                    sc == rs + MAX_RESIZERS || (nt = nextTable) == null ||\n                    transferIndex <= 0)\n                    break;\n                // 2. ç”¨ CAS å°† sizeCtl åŠ  1ï¼Œç„¶åæ‰§è¡Œ transfer æ–¹æ³•\n                //    æ­¤æ—¶ nextTab ä¸ä¸º null\n                if (U.compareAndSwapInt(this, SIZECTL, sc, sc + 1))\n                    transfer(tab, nt);\n            }\n            // 1. å°† sizeCtl è®¾ç½®ä¸º (rs << RESIZE_STAMP_SHIFT) + 2)\n            //     æˆ‘æ˜¯æ²¡çœ‹æ‡‚è¿™ä¸ªå€¼çœŸæ­£çš„æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿä¸è¿‡å¯ä»¥è®¡ç®—å‡ºæ¥çš„æ˜¯ï¼Œç»“æœæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤§çš„è´Ÿæ•°\n            //  è°ƒç”¨ transfer æ–¹æ³•ï¼Œæ­¤æ—¶ nextTab å‚æ•°ä¸º null\n            else if (U.compareAndSwapInt(this, SIZECTL, sc,\n                                         (rs << RESIZE_STAMP_SHIFT) + 2))\n                transfer(tab, null);\n        }\n    }\n}\n```\n\nè¿™ä¸ªæ–¹æ³•çš„æ ¸å¿ƒåœ¨äº sizeCtl å€¼çš„æ“ä½œï¼Œé¦–å…ˆå°†å…¶è®¾ç½®ä¸ºä¸€ä¸ªè´Ÿæ•°ï¼Œç„¶åæ‰§è¡Œ transfer(tab, null)ï¼Œå†ä¸‹ä¸€ä¸ªå¾ªç¯å°† sizeCtl åŠ  1ï¼Œå¹¶æ‰§è¡Œ transfer(tab, nt)ï¼Œä¹‹åå¯èƒ½æ˜¯ç»§ç»­ sizeCtl åŠ  1ï¼Œå¹¶æ‰§è¡Œ transfer(tab, nt)ã€‚\n\næ‰€ä»¥ï¼Œå¯èƒ½çš„æ“ä½œå°±æ˜¯æ‰§è¡Œ **1 æ¬¡ transfer(tab, null) + å¤šæ¬¡ transfer(tab, nt)**ï¼Œè¿™é‡Œæ€ä¹ˆç»“æŸå¾ªç¯çš„éœ€è¦çœ‹å®Œ transfer æºç æ‰æ¸…æ¥šã€‚æ¨èé˜…è¯»ï¼š[30 ä¸ª Java é›†åˆé¢è¯•é—®é¢˜åŠç­”æ¡ˆ](https://mp.weixin.qq.com/s/Q5F604CUM_0x2co9mvADxw)ã€‚\n\n###### æ•°æ®è¿ç§»ï¼štransfer\n\nä¸‹é¢è¿™ä¸ªæ–¹æ³•å¾ˆç‚¹é•¿ï¼Œå°†åŸæ¥çš„ tab æ•°ç»„çš„å…ƒç´ è¿ç§»åˆ°æ–°çš„ nextTab æ•°ç»„ä¸­ã€‚\n\nè™½ç„¶æˆ‘ä»¬ä¹‹å‰è¯´çš„ tryPresize æ–¹æ³•ä¸­å¤šæ¬¡è°ƒç”¨ transfer ä¸æ¶‰åŠå¤šçº¿ç¨‹ï¼Œä½†æ˜¯è¿™ä¸ª transfer æ–¹æ³•å¯ä»¥åœ¨å…¶ä»–åœ°æ–¹è¢«è°ƒç”¨ï¼Œå…¸å‹åœ°ï¼Œæˆ‘ä»¬ä¹‹å‰åœ¨è¯´ put æ–¹æ³•çš„æ—¶å€™å°±è¯´è¿‡äº†ï¼Œè¯·å¾€ä¸Šçœ‹ put æ–¹æ³•ï¼Œæ˜¯ä¸æ˜¯æœ‰ä¸ªåœ°æ–¹è°ƒç”¨äº† helpTransfer æ–¹æ³•ï¼ŒhelpTransfer æ–¹æ³•ä¼šè°ƒç”¨ transfer æ–¹æ³•çš„ã€‚\n\næ­¤æ–¹æ³•æ”¯æŒå¤šçº¿ç¨‹æ‰§è¡Œï¼Œå¤–å›´è°ƒç”¨æ­¤æ–¹æ³•çš„æ—¶å€™ï¼Œä¼šä¿è¯ç¬¬ä¸€ä¸ªå‘èµ·æ•°æ®è¿ç§»çš„çº¿ç¨‹ï¼ŒnextTab å‚æ•°ä¸º nullï¼Œä¹‹åå†è°ƒç”¨æ­¤æ–¹æ³•çš„æ—¶å€™ï¼ŒnextTab ä¸ä¼šä¸º nullã€‚\n\né˜…è¯»æºç ä¹‹å‰ï¼Œå…ˆè¦ç†è§£å¹¶å‘æ“ä½œçš„æœºåˆ¶ã€‚åŸæ•°ç»„é•¿åº¦ä¸º nï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰ n ä¸ªè¿ç§»ä»»åŠ¡ï¼Œè®©æ¯ä¸ªçº¿ç¨‹æ¯æ¬¡è´Ÿè´£ä¸€ä¸ªå°ä»»åŠ¡æ˜¯æœ€ç®€å•çš„ï¼Œæ¯åšå®Œä¸€ä¸ªä»»åŠ¡å†æ£€æµ‹æ˜¯å¦æœ‰å…¶ä»–æ²¡åšå®Œçš„ä»»åŠ¡ï¼Œå¸®åŠ©è¿ç§»å°±å¯ä»¥äº†ï¼Œè€Œ Doug Lea ä½¿ç”¨äº†ä¸€ä¸ª strideï¼Œç®€å•ç†è§£å°±æ˜¯æ­¥é•¿ï¼Œæ¯ä¸ªçº¿ç¨‹æ¯æ¬¡è´Ÿè´£è¿ç§»å…¶ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œå¦‚æ¯æ¬¡è¿ç§» 16 ä¸ªå°ä»»åŠ¡ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªå…¨å±€çš„è°ƒåº¦è€…æ¥å®‰æ’å“ªä¸ªçº¿ç¨‹æ‰§è¡Œå“ªå‡ ä¸ªä»»åŠ¡ï¼Œè¿™ä¸ªå°±æ˜¯å±æ€§ transferIndex çš„ä½œç”¨ã€‚\n\nç¬¬ä¸€ä¸ªå‘èµ·æ•°æ®è¿ç§»çš„çº¿ç¨‹ä¼šå°† transferIndex æŒ‡å‘åŸæ•°ç»„æœ€åçš„ä½ç½®ï¼Œç„¶åä»åå¾€å‰çš„ stride ä¸ªä»»åŠ¡å±äºç¬¬ä¸€ä¸ªçº¿ç¨‹ï¼Œç„¶åå°† transferIndex æŒ‡å‘æ–°çš„ä½ç½®ï¼Œå†å¾€å‰çš„ stride ä¸ªä»»åŠ¡å±äºç¬¬äºŒä¸ªçº¿ç¨‹ï¼Œä¾æ­¤ç±»æ¨ã€‚å½“ç„¶ï¼Œè¿™é‡Œè¯´çš„ç¬¬äºŒä¸ªçº¿ç¨‹ä¸æ˜¯çœŸçš„ä¸€å®šæŒ‡ä»£äº†ç¬¬äºŒä¸ªçº¿ç¨‹ï¼Œä¹Ÿå¯ä»¥æ˜¯åŒä¸€ä¸ªçº¿ç¨‹ï¼Œè¿™ä¸ªè¯»è€…åº”è¯¥èƒ½ç†è§£å§ã€‚å…¶å®å°±æ˜¯å°†ä¸€ä¸ªå¤§çš„è¿ç§»ä»»åŠ¡åˆ†ä¸ºäº†ä¸€ä¸ªä¸ªä»»åŠ¡åŒ…ã€‚\n\n```\nprivate final void transfer(Node<K,V>[] tab, Node<K,V>[] nextTab) {\n    int n = tab.length, stride;\n \n    // stride åœ¨å•æ ¸ä¸‹ç›´æ¥ç­‰äº nï¼Œå¤šæ ¸æ¨¡å¼ä¸‹ä¸º (n>>>3)/NCPUï¼Œæœ€å°å€¼æ˜¯ 16\n    // stride å¯ä»¥ç†è§£ä¸ºâ€æ­¥é•¿â€œï¼Œæœ‰ n ä¸ªä½ç½®æ˜¯éœ€è¦è¿›è¡Œè¿ç§»çš„ï¼Œ\n    //   å°†è¿™ n ä¸ªä»»åŠ¡åˆ†ä¸ºå¤šä¸ªä»»åŠ¡åŒ…ï¼Œæ¯ä¸ªä»»åŠ¡åŒ…æœ‰ stride ä¸ªä»»åŠ¡\n    if ((stride = (NCPU > 1) ? (n >>> 3) / NCPU : n) < MIN_TRANSFER_STRIDE)\n        stride = MIN_TRANSFER_STRIDE; // subdivide range\n \n    // å¦‚æœ nextTab ä¸º nullï¼Œå…ˆè¿›è¡Œä¸€æ¬¡åˆå§‹åŒ–\n    //    å‰é¢æˆ‘ä»¬è¯´äº†ï¼Œå¤–å›´ä¼šä¿è¯ç¬¬ä¸€ä¸ªå‘èµ·è¿ç§»çš„çº¿ç¨‹è°ƒç”¨æ­¤æ–¹æ³•æ—¶ï¼Œå‚æ•° nextTab ä¸º null\n    //       ä¹‹åå‚ä¸è¿ç§»çš„çº¿ç¨‹è°ƒç”¨æ­¤æ–¹æ³•æ—¶ï¼ŒnextTab ä¸ä¼šä¸º null\n    if (nextTab == null) {\n        try {\n            // å®¹é‡ç¿»å€\n            Node<K,V>[] nt = (Node<K,V>[])new Node<?,?>[n << 1];\n            nextTab = nt;\n        } catch (Throwable ex) {      // try to cope with OOME\n            sizeCtl = Integer.MAX_VALUE;\n            return;\n        }\n        // nextTable æ˜¯ ConcurrentHashMap ä¸­çš„å±æ€§\n        nextTable = nextTab;\n        // transferIndex ä¹Ÿæ˜¯ ConcurrentHashMap çš„å±æ€§ï¼Œç”¨äºæ§åˆ¶è¿ç§»çš„ä½ç½®\n        transferIndex = n;\n    }\n \n    int nextn = nextTab.length;\n \n    // ForwardingNode ç¿»è¯‘è¿‡æ¥å°±æ˜¯æ­£åœ¨è¢«è¿ç§»çš„ Node\n    // è¿™ä¸ªæ„é€ æ–¹æ³•ä¼šç”Ÿæˆä¸€ä¸ªNodeï¼Œkeyã€value å’Œ next éƒ½ä¸º nullï¼Œå…³é”®æ˜¯ hash ä¸º MOVED\n    // åé¢æˆ‘ä»¬ä¼šçœ‹åˆ°ï¼ŒåŸæ•°ç»„ä¸­ä½ç½® i å¤„çš„èŠ‚ç‚¹å®Œæˆè¿ç§»å·¥ä½œåï¼Œ\n    //    å°±ä¼šå°†ä½ç½® i å¤„è®¾ç½®ä¸ºè¿™ä¸ª ForwardingNodeï¼Œç”¨æ¥å‘Šè¯‰å…¶ä»–çº¿ç¨‹è¯¥ä½ç½®å·²ç»å¤„ç†è¿‡äº†\n    //    æ‰€ä»¥å®ƒå…¶å®ç›¸å½“äºæ˜¯ä¸€ä¸ªæ ‡å¿—ã€‚\n    ForwardingNode<K,V> fwd = new ForwardingNode<K,V>(nextTab);\n \n \n    // advance æŒ‡çš„æ˜¯åšå®Œäº†ä¸€ä¸ªä½ç½®çš„è¿ç§»å·¥ä½œï¼Œå¯ä»¥å‡†å¤‡åšä¸‹ä¸€ä¸ªä½ç½®çš„äº†\n    boolean advance = true;\n    boolean finishing = false; // to ensure sweep before committing nextTab\n \n    /*\n     * ä¸‹é¢è¿™ä¸ª for å¾ªç¯ï¼Œæœ€éš¾ç†è§£çš„åœ¨å‰é¢ï¼Œè€Œè¦çœ‹æ‡‚å®ƒä»¬ï¼Œåº”è¯¥å…ˆçœ‹æ‡‚åé¢çš„ï¼Œç„¶åå†å€’å›æ¥çœ‹\n     * \n     */\n \n    // i æ˜¯ä½ç½®ç´¢å¼•ï¼Œbound æ˜¯è¾¹ç•Œï¼Œæ³¨æ„æ˜¯ä»åå¾€å‰\n    for (int i = 0, bound = 0;;) {\n        Node<K,V> f; int fh;\n \n        // ä¸‹é¢è¿™ä¸ª while çœŸçš„æ˜¯ä¸å¥½ç†è§£\n        // advance ä¸º true è¡¨ç¤ºå¯ä»¥è¿›è¡Œä¸‹ä¸€ä¸ªä½ç½®çš„è¿ç§»äº†\n        //   ç®€å•ç†è§£ç»“å±€ï¼ši æŒ‡å‘äº† transferIndexï¼Œbound æŒ‡å‘äº† transferIndex-stride\n        while (advance) {\n            int nextIndex, nextBound;\n            if (--i >= bound || finishing)\n                advance = false;\n \n            // å°† transferIndex å€¼èµ‹ç»™ nextIndex\n            // è¿™é‡Œ transferIndex ä¸€æ—¦å°äºç­‰äº 0ï¼Œè¯´æ˜åŸæ•°ç»„çš„æ‰€æœ‰ä½ç½®éƒ½æœ‰ç›¸åº”çš„çº¿ç¨‹å»å¤„ç†äº†\n            else if ((nextIndex = transferIndex) <= 0) {\n                i = -1;\n                advance = false;\n            }\n            else if (U.compareAndSwapInt\n                     (this, TRANSFERINDEX, nextIndex,\n                      nextBound = (nextIndex > stride ?\n                                   nextIndex - stride : 0))) {\n                // çœ‹æ‹¬å·ä¸­çš„ä»£ç ï¼ŒnextBound æ˜¯è¿™æ¬¡è¿ç§»ä»»åŠ¡çš„è¾¹ç•Œï¼Œæ³¨æ„ï¼Œæ˜¯ä»åå¾€å‰\n                bound = nextBound;\n                i = nextIndex - 1;\n                advance = false;\n            }\n        }\n        if (i < 0 || i >= n || i + n >= nextn) {\n            int sc;\n            if (finishing) {\n                // æ‰€æœ‰çš„è¿ç§»æ“ä½œå·²ç»å®Œæˆ\n                nextTable = null;\n                // å°†æ–°çš„ nextTab èµ‹å€¼ç»™ table å±æ€§ï¼Œå®Œæˆè¿ç§»\n                table = nextTab;\n                // é‡æ–°è®¡ç®— sizeCtlï¼šn æ˜¯åŸæ•°ç»„é•¿åº¦ï¼Œæ‰€ä»¥ sizeCtl å¾—å‡ºçš„å€¼å°†æ˜¯æ–°æ•°ç»„é•¿åº¦çš„ 0.75 å€\n                sizeCtl = (n << 1) - (n >>> 1);\n                return;\n            }\n \n            // ä¹‹å‰æˆ‘ä»¬è¯´è¿‡ï¼ŒsizeCtl åœ¨è¿ç§»å‰ä¼šè®¾ç½®ä¸º (rs << RESIZE_STAMP_SHIFT) + 2\n            // ç„¶åï¼Œæ¯æœ‰ä¸€ä¸ªçº¿ç¨‹å‚ä¸è¿ç§»å°±ä¼šå°† sizeCtl åŠ  1ï¼Œ\n            // è¿™é‡Œä½¿ç”¨ CAS æ“ä½œå¯¹ sizeCtl è¿›è¡Œå‡ 1ï¼Œä»£è¡¨åšå®Œäº†å±äºè‡ªå·±çš„ä»»åŠ¡\n            if (U.compareAndSwapInt(this, SIZECTL, sc = sizeCtl, sc - 1)) {\n                // ä»»åŠ¡ç»“æŸï¼Œæ–¹æ³•é€€å‡º\n                if ((sc - 2) != resizeStamp(n) << RESIZE_STAMP_SHIFT)\n                    return;\n \n                // åˆ°è¿™é‡Œï¼Œè¯´æ˜ (sc - 2) == resizeStamp(n) << RESIZE_STAMP_SHIFTï¼Œ\n                // ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰€æœ‰çš„è¿ç§»ä»»åŠ¡éƒ½åšå®Œäº†ï¼Œä¹Ÿå°±ä¼šè¿›å…¥åˆ°ä¸Šé¢çš„ if(finishing){} åˆ†æ”¯äº†\n                finishing = advance = true;\n                i = n; // recheck before commit\n            }\n        }\n        // å¦‚æœä½ç½® i å¤„æ˜¯ç©ºçš„ï¼Œæ²¡æœ‰ä»»ä½•èŠ‚ç‚¹ï¼Œé‚£ä¹ˆæ”¾å…¥åˆšåˆšåˆå§‹åŒ–çš„ ForwardingNode â€ç©ºèŠ‚ç‚¹â€œ\n        else if ((f = tabAt(tab, i)) == null)\n            advance = casTabAt(tab, i, null, fwd);\n        // è¯¥ä½ç½®å¤„æ˜¯ä¸€ä¸ª ForwardingNodeï¼Œä»£è¡¨è¯¥ä½ç½®å·²ç»è¿ç§»è¿‡äº†\n        else if ((fh = f.hash) == MOVED)\n            advance = true; // already processed\n        else {\n            // å¯¹æ•°ç»„è¯¥ä½ç½®å¤„çš„ç»“ç‚¹åŠ é”ï¼Œå¼€å§‹å¤„ç†æ•°ç»„è¯¥ä½ç½®å¤„çš„è¿ç§»å·¥ä½œ\n            synchronized (f) {\n                if (tabAt(tab, i) == f) {\n                    Node<K,V> ln, hn;\n                    // å¤´ç»“ç‚¹çš„ hash å¤§äº 0ï¼Œè¯´æ˜æ˜¯é“¾è¡¨çš„ Node èŠ‚ç‚¹\n                    if (fh >= 0) {\n                        // ä¸‹é¢è¿™ä¸€å—å’Œ Java7 ä¸­çš„ ConcurrentHashMap è¿ç§»æ˜¯å·®ä¸å¤šçš„ï¼Œ\n                        // éœ€è¦å°†é“¾è¡¨ä¸€åˆ†ä¸ºäºŒï¼Œ\n                        //   æ‰¾åˆ°åŸé“¾è¡¨ä¸­çš„ lastRunï¼Œç„¶å lastRun åŠå…¶ä¹‹åçš„èŠ‚ç‚¹æ˜¯ä¸€èµ·è¿›è¡Œè¿ç§»çš„\n                        //   lastRun ä¹‹å‰çš„èŠ‚ç‚¹éœ€è¦è¿›è¡Œå…‹éš†ï¼Œç„¶ååˆ†åˆ°ä¸¤ä¸ªé“¾è¡¨ä¸­\n                        int runBit = fh & n;\n                        Node<K,V> lastRun = f;\n                        for (Node<K,V> p = f.next; p != null; p = p.next) {\n                            int b = p.hash & n;\n                            if (b != runBit) {\n                                runBit = b;\n                                lastRun = p;\n                            }\n                        }\n                        if (runBit == 0) {\n                            ln = lastRun;\n                            hn = null;\n                        }\n                        else {\n                            hn = lastRun;\n                            ln = null;\n                        }\n                        for (Node<K,V> p = f; p != lastRun; p = p.next) {\n                            int ph = p.hash; K pk = p.key; V pv = p.val;\n                            if ((ph & n) == 0)\n                                ln = new Node<K,V>(ph, pk, pv, ln);\n                            else\n                                hn = new Node<K,V>(ph, pk, pv, hn);\n                        }\n                        // å…¶ä¸­çš„ä¸€ä¸ªé“¾è¡¨æ”¾åœ¨æ–°æ•°ç»„çš„ä½ç½® i\n                        setTabAt(nextTab, i, ln);\n                        // å¦ä¸€ä¸ªé“¾è¡¨æ”¾åœ¨æ–°æ•°ç»„çš„ä½ç½® i+n\n                        setTabAt(nextTab, i + n, hn);\n                        // å°†åŸæ•°ç»„è¯¥ä½ç½®å¤„è®¾ç½®ä¸º fwdï¼Œä»£è¡¨è¯¥ä½ç½®å·²ç»å¤„ç†å®Œæ¯•ï¼Œ\n                        //    å…¶ä»–çº¿ç¨‹ä¸€æ—¦çœ‹åˆ°è¯¥ä½ç½®çš„ hash å€¼ä¸º MOVEDï¼Œå°±ä¸ä¼šè¿›è¡Œè¿ç§»äº†\n                        setTabAt(tab, i, fwd);\n                        // advance è®¾ç½®ä¸º trueï¼Œä»£è¡¨è¯¥ä½ç½®å·²ç»è¿ç§»å®Œæ¯•\n                        advance = true;\n                    }\n                    else if (f instanceof TreeBin) {\n                        // çº¢é»‘æ ‘çš„è¿ç§»\n                        TreeBin<K,V> t = (TreeBin<K,V>)f;\n                        TreeNode<K,V> lo = null, loTail = null;\n                        TreeNode<K,V> hi = null, hiTail = null;\n                        int lc = 0, hc = 0;\n                        for (Node<K,V> e = t.first; e != null; e = e.next) {\n                            int h = e.hash;\n                            TreeNode<K,V> p = new TreeNode<K,V>\n                                (h, e.key, e.val, null, null);\n                            if ((h & n) == 0) {\n                                if ((p.prev = loTail) == null)\n                                    lo = p;\n                                else\n                                    loTail.next = p;\n                                loTail = p;\n                                ++lc;\n                            }\n                            else {\n                                if ((p.prev = hiTail) == null)\n                                    hi = p;\n                                else\n                                    hiTail.next = p;\n                                hiTail = p;\n                                ++hc;\n                            }\n                        }\n                        // å¦‚æœä¸€åˆ†ä¸ºäºŒåï¼ŒèŠ‚ç‚¹æ•°å°‘äº 8ï¼Œé‚£ä¹ˆå°†çº¢é»‘æ ‘è½¬æ¢å›é“¾è¡¨\n                        ln = (lc <= UNTREEIFY_THRESHOLD) ? untreeify(lo) :\n                            (hc != 0) ? new TreeBin<K,V>(lo) : t;\n                        hn = (hc <= UNTREEIFY_THRESHOLD) ? untreeify(hi) :\n                            (lc != 0) ? new TreeBin<K,V>(hi) : t;\n \n                        // å°† ln æ”¾ç½®åœ¨æ–°æ•°ç»„çš„ä½ç½® i\n                        setTabAt(nextTab, i, ln);\n                        // å°† hn æ”¾ç½®åœ¨æ–°æ•°ç»„çš„ä½ç½® i+n\n                        setTabAt(nextTab, i + n, hn);\n                        // å°†åŸæ•°ç»„è¯¥ä½ç½®å¤„è®¾ç½®ä¸º fwdï¼Œä»£è¡¨è¯¥ä½ç½®å·²ç»å¤„ç†å®Œæ¯•ï¼Œ\n                        //    å…¶ä»–çº¿ç¨‹ä¸€æ—¦çœ‹åˆ°è¯¥ä½ç½®çš„ hash å€¼ä¸º MOVEDï¼Œå°±ä¸ä¼šè¿›è¡Œè¿ç§»äº†\n                        setTabAt(tab, i, fwd);\n                        // advance è®¾ç½®ä¸º trueï¼Œä»£è¡¨è¯¥ä½ç½®å·²ç»è¿ç§»å®Œæ¯•\n                        advance = true;\n                    }\n                }\n            }\n        }\n    }\n}\n```\n\nè¯´åˆ°åº•ï¼Œtransfer è¿™ä¸ªæ–¹æ³•å¹¶æ²¡æœ‰å®ç°æ‰€æœ‰çš„è¿ç§»ä»»åŠ¡ï¼Œæ¯æ¬¡è°ƒç”¨è¿™ä¸ªæ–¹æ³•åªå®ç°äº† transferIndex å¾€å‰ stride ä¸ªä½ç½®çš„è¿ç§»å·¥ä½œï¼Œå…¶ä»–çš„éœ€è¦ç”±å¤–å›´æ¥æ§åˆ¶ã€‚\n\nè¿™ä¸ªæ—¶å€™ï¼Œå†å›å»ä»”ç»†çœ‹ tryPresize æ–¹æ³•å¯èƒ½å°±ä¼šæ›´åŠ æ¸…æ™°ä¸€äº›äº†ã€‚\n\n#### get è¿‡ç¨‹åˆ†æ\n\nget æ–¹æ³•ä»æ¥éƒ½æ˜¯æœ€ç®€å•çš„ï¼Œè¿™é‡Œä¹Ÿä¸ä¾‹å¤–ï¼š\n\n1.è®¡ç®— hash å€¼\n\n2.æ ¹æ® hash å€¼æ‰¾åˆ°æ•°ç»„å¯¹åº”ä½ç½®: (n â€“ 1) & h\n\n3.æ ¹æ®è¯¥ä½ç½®å¤„ç»“ç‚¹æ€§è´¨è¿›è¡Œç›¸åº”æŸ¥æ‰¾\n\n- å¦‚æœè¯¥ä½ç½®ä¸º nullï¼Œé‚£ä¹ˆç›´æ¥è¿”å› null å°±å¯ä»¥äº†\n- å¦‚æœè¯¥ä½ç½®å¤„çš„èŠ‚ç‚¹åˆšå¥½å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„ï¼Œè¿”å›è¯¥èŠ‚ç‚¹çš„å€¼å³å¯\n- å¦‚æœè¯¥ä½ç½®èŠ‚ç‚¹çš„ hash å€¼å°äº 0ï¼Œè¯´æ˜æ­£åœ¨æ‰©å®¹ï¼Œæˆ–è€…æ˜¯çº¢é»‘æ ‘ï¼Œåé¢æˆ‘ä»¬å†ä»‹ç» find æ–¹æ³•\n- å¦‚æœä»¥ä¸Š 3 æ¡éƒ½ä¸æ»¡è¶³ï¼Œé‚£å°±æ˜¯é“¾è¡¨ï¼Œè¿›è¡Œéå†æ¯”å¯¹å³å¯ã€‚\n\n```\npublic V get(Object key) {\n    Node<K,V>[] tab; Node<K,V> e, p; int n, eh; K ek;\n    int h = spread(key.hashCode());\n    if ((tab = table) != null && (n = tab.length) > 0 &&\n        (e = tabAt(tab, (n - 1) & h)) != null) {\n        // åˆ¤æ–­å¤´ç»“ç‚¹æ˜¯å¦å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„èŠ‚ç‚¹\n        if ((eh = e.hash) == h) {\n            if ((ek = e.key) == key || (ek != null && key.equals(ek)))\n                return e.val;\n        }\n        // å¦‚æœå¤´ç»“ç‚¹çš„ hash å°äº 0ï¼Œè¯´æ˜ æ­£åœ¨æ‰©å®¹ï¼Œæˆ–è€…è¯¥ä½ç½®æ˜¯çº¢é»‘æ ‘\n        else if (eh < 0)\n            // å‚è€ƒ ForwardingNode.find(int h, Object k) å’Œ TreeBin.find(int h, Object k)\n            return (p = e.find(h, key)) != null ? p.val : null;\n \n        // éå†é“¾è¡¨\n        while ((e = e.next) != null) {\n            if (e.hash == h &&\n                ((ek = e.key) == key || (ek != null && key.equals(ek))))\n                return e.val;\n        }\n    }\n    return null;\n}\n```\n\nç®€å•è¯´ä¸€å¥ï¼Œæ­¤æ–¹æ³•çš„å¤§éƒ¨åˆ†å†…å®¹éƒ½å¾ˆç®€å•ï¼Œåªæœ‰æ­£å¥½ç¢°åˆ°æ‰©å®¹çš„æƒ…å†µï¼ŒForwardingNode.find(int h, Object k) ç¨å¾®å¤æ‚ä¸€äº›ï¼Œä¸è¿‡åœ¨äº†è§£äº†æ•°æ®è¿ç§»çš„è¿‡ç¨‹åï¼Œè¿™ä¸ªä¹Ÿå°±ä¸éš¾äº†ï¼Œæ‰€ä»¥é™äºç¯‡å¹…è¿™é‡Œä¹Ÿä¸å±•å¼€è¯´äº†ã€‚\n\n## æ€»ç»“\n\nå…¶å®ä¹Ÿä¸æ˜¯å¾ˆéš¾å˜›ï¼Œè™½ç„¶æ²¡æœ‰åƒä¹‹å‰çš„ AQS å’Œçº¿ç¨‹æ± ä¸€æ ·ä¸€è¡Œä¸€è¡Œæºç è¿›è¡Œåˆ†æï¼Œä½†è¿˜æ˜¯æŠŠæ‰€æœ‰åˆå­¦è€…å¯èƒ½ä¼šç³Šæ¶‚çš„åœ°æ–¹éƒ½è¿›è¡Œäº†æ·±å…¥çš„ä»‹ç»ï¼Œåªè¦æ˜¯ç¨å¾®æœ‰ç‚¹åŸºç¡€çš„è¯»è€…ï¼Œåº”è¯¥æ˜¯å¾ˆå®¹æ˜“å°±èƒ½çœ‹æ‡‚ HashMap å’Œ ConcurrentHashMap æºç äº†ã€‚\n\nçœ‹æºç ä¸ç®—æ˜¯ç›®çš„å§ï¼Œæ·±å…¥åœ°äº†è§£ Doug Lea çš„è®¾è®¡æ€è·¯ï¼Œæˆ‘è§‰å¾—è¿˜æŒºæœ‰è¶£çš„ï¼Œå¤§å¸ˆå°±æ˜¯å¤§å¸ˆï¼Œä»£ç å†™å¾—çœŸçš„æ˜¯å¥½å•Šã€‚\n\næˆ‘å‘ç°å¾ˆå¤šäººéƒ½ä»¥ä¸ºæˆ‘å†™åšå®¢ä¸»è¦æ˜¯æºç åˆ†æï¼Œè¯´çœŸçš„ï¼Œæˆ‘å¯¹äºæºç åˆ†ææ²¡æœ‰é‚£ä¹ˆå¤§çƒ­æƒ…ï¼Œä¸»è¦éƒ½æ˜¯ä¸ºäº†ç”¨æºç è¯´äº‹ç½¢äº†ï¼Œå¯èƒ½ä¹‹åçš„æ–‡ç« è¿˜æ˜¯ä¼šæœ‰æ¯”è¾ƒå¤šçš„æºç åˆ†ææˆåˆ†ï¼Œå¤§å®¶è¯¥æ€ä¹ˆçœ‹å°±æ€ä¹ˆçœ‹å§ã€‚\n\nä¸è¦è„¸åœ°è‡ªä»¥ä¸ºæœ¬æ–‡çš„è´¨é‡è¿˜æ˜¯æŒºé«˜çš„ï¼Œä¿¡æ¯é‡æ¯”è¾ƒå¤§ï¼Œå¦‚æœä½ è§‰å¾—æœ‰å†™å¾—ä¸å¥½çš„åœ°æ–¹ï¼Œæˆ–è€…è¯´çœ‹å®Œæœ¬æ–‡ä½ è¿˜æ˜¯æ²¡çœ‹æ‡‚å®ƒä»¬ï¼Œé‚£ä¹ˆè¯·æå‡ºæ¥~~~\n\n","slug":"é›†åˆ/HashMap, ConcurrentHashMap åŸç†åŠæºç ","published":1,"updated":"2025-10-15T07:21:29.773Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu07710051qkd4az5ndksw","content":"<p>ç½‘ä¸Šå…³äº HashMap å’Œ ConcurrentHashMap çš„æ–‡ç« ç¡®å®ä¸å°‘ï¼Œä¸è¿‡ç¼ºæ–¤å°‘ä¸¤çš„æ–‡ç« æ¯”è¾ƒå¤šï¼Œæ‰€ä»¥æ‰æƒ³è‡ªå·±ä¹Ÿå†™ä¸€ç¯‡ï¼ŒæŠŠç»†èŠ‚è¯´æ¸…æ¥šè¯´é€ï¼Œå°¤å…¶åƒ Java8 ä¸­çš„ ConcurrentHashMapï¼Œå¤§éƒ¨åˆ†æ–‡ç« éƒ½è¯´ä¸æ¸…æ¥šã€‚ç»ˆå½’æ˜¯å¸Œæœ›èƒ½é™ä½å¤§å®¶å­¦ä¹ çš„æˆæœ¬ï¼Œä¸å¸Œæœ›å¤§å®¶åˆ°å¤„æ‰¾å„ç§ä¸æ˜¯å¾ˆé è°±çš„æ–‡ç« ï¼Œçœ‹å®Œä¸€ç¯‡åˆä¸€ç¯‡ï¼Œå¯æ˜¯è¿˜æ˜¯æ¨¡æ¨¡ç³Šç³Šã€‚</p>\n<p><strong>é˜…è¯»å»ºè®®ï¼š</strong> å››èŠ‚åŸºæœ¬ä¸Šå¯ä»¥è¿›è¡Œç‹¬ç«‹é˜…è¯»ï¼Œå»ºè®®åˆå­¦è€…å¯æŒ‰ç…§ä»¥ä¸‹é¡ºåºè¿›è¡Œé˜…è¯»ï¼Œå¯é€‚å½“é™ä½é˜…è¯»é—¨æ§›ã€‚</p>\n<blockquote>\n<p>Java7 HashMap -&gt; Java7 ConcurrentHashMap -&gt; Java8 HashMap -&gt; Java8 ConcurrentHashMap </p>\n</blockquote>\n<p><strong>é˜…è¯»å‰æï¼š</strong> æœ¬æ–‡åˆ†æçš„æ˜¯æºç ï¼Œæ‰€ä»¥è‡³å°‘è¯»è€…è¦ç†Ÿæ‚‰å®ƒä»¬çš„æ¥å£ä½¿ç”¨ï¼ŒåŒæ—¶ï¼Œå¯¹äºå¹¶å‘ï¼Œè¯»è€…è‡³å°‘è¦çŸ¥é“ CASã€ReentrantLockã€UNSAFE æ“ä½œè¿™å‡ ä¸ªåŸºæœ¬çš„çŸ¥è¯†ï¼Œæ–‡ä¸­ä¸ä¼šå¯¹è¿™äº›çŸ¥è¯†è¿›è¡Œä»‹ç»ã€‚Java8 ç”¨åˆ°äº†çº¢é»‘æ ‘ï¼Œä¸è¿‡æœ¬æ–‡ä¸ä¼šè¿›è¡Œå±•å¼€ï¼Œæ„Ÿå…´è¶£çš„è¯»è€…è¯·è‡ªè¡ŒæŸ¥æ‰¾ç›¸å…³èµ„æ–™ã€‚</p>\n<h2 id=\"Java7-HashMap\"><a href=\"#Java7-HashMap\" class=\"headerlink\" title=\"Java7 HashMap\"></a>Java7 HashMap</h2><p>HashMap æ˜¯æœ€ç®€å•çš„ï¼Œä¸€æ¥æˆ‘ä»¬éå¸¸ç†Ÿæ‚‰ï¼ŒäºŒæ¥å°±æ˜¯å®ƒä¸æ”¯æŒå¹¶å‘æ“ä½œï¼Œæ‰€ä»¥æºç ä¹Ÿéå¸¸ç®€å•ã€‚</p>\n<p>é¦–å…ˆï¼Œæˆ‘ä»¬ç”¨ä¸‹é¢è¿™å¼ å›¾æ¥ä»‹ç» HashMap çš„ç»“æ„ã€‚</p>\n<p><img src=\"http://qianniu.javastack.cn/18-12-4/65827660.jpg\"></p>\n<p>è¿™ä¸ªä»…ä»…æ˜¯ç¤ºæ„å›¾ï¼Œå› ä¸ºæ²¡æœ‰è€ƒè™‘åˆ°æ•°ç»„è¦æ‰©å®¹çš„æƒ…å†µï¼Œå…·ä½“çš„åé¢å†è¯´ã€‚</p>\n<p>å¤§æ–¹å‘ä¸Šï¼ŒHashMap é‡Œé¢æ˜¯ä¸€ä¸ª<strong>æ•°ç»„</strong>ï¼Œç„¶åæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ª<strong>å•å‘é“¾è¡¨</strong>ã€‚</p>\n<p>ä¸Šå›¾ä¸­ï¼Œæ¯ä¸ªç»¿è‰²çš„å®ä½“æ˜¯åµŒå¥—ç±» Entry çš„å®ä¾‹ï¼ŒEntry åŒ…å«å››ä¸ªå±æ€§ï¼škey, value, hash å€¼å’Œç”¨äºå•å‘é“¾è¡¨çš„ nextã€‚</p>\n<p>capacityï¼šå½“å‰æ•°ç»„å®¹é‡ï¼Œå§‹ç»ˆä¿æŒ 2^nï¼Œå¯ä»¥æ‰©å®¹ï¼Œæ‰©å®¹åæ•°ç»„å¤§å°ä¸ºå½“å‰çš„ 2 å€ã€‚</p>\n<p>loadFactorï¼šè´Ÿè½½å› å­ï¼Œé»˜è®¤ä¸º 0.75ã€‚</p>\n<p>thresholdï¼šæ‰©å®¹çš„é˜ˆå€¼ï¼Œç­‰äº capacity * loadFactor</p>\n<h4 id=\"put-è¿‡ç¨‹åˆ†æ\"><a href=\"#put-è¿‡ç¨‹åˆ†æ\" class=\"headerlink\" title=\"put è¿‡ç¨‹åˆ†æ\"></a>put è¿‡ç¨‹åˆ†æ</h4><p>è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œè·Ÿç€ä»£ç èµ°ä¸€éå§ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public V put(K key, V value) &#123;\n    &#x2F;&#x2F; å½“æ’å…¥ç¬¬ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œéœ€è¦å…ˆåˆå§‹åŒ–æ•°ç»„å¤§å°\n    if (table &#x3D;&#x3D; EMPTY_TABLE) &#123;\n        inflateTable(threshold);\n    &#125;\n    &#x2F;&#x2F; å¦‚æœ key ä¸º nullï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å¾€é‡Œçœ‹ï¼Œæœ€ç»ˆä¼šå°†è¿™ä¸ª entry æ”¾åˆ° table[0] ä¸­\n    if (key &#x3D;&#x3D; null)\n        return putForNullKey(value);\n    &#x2F;&#x2F; 1. æ±‚ key çš„ hash å€¼\n    int hash &#x3D; hash(key);\n    &#x2F;&#x2F; 2. æ‰¾åˆ°å¯¹åº”çš„æ•°ç»„ä¸‹æ ‡\n    int i &#x3D; indexFor(hash, table.length);\n    &#x2F;&#x2F; 3. éå†ä¸€ä¸‹å¯¹åº”ä¸‹æ ‡å¤„çš„é“¾è¡¨ï¼Œçœ‹æ˜¯å¦æœ‰é‡å¤çš„ key å·²ç»å­˜åœ¨ï¼Œ\n    &#x2F;&#x2F;    å¦‚æœæœ‰ï¼Œç›´æ¥è¦†ç›–ï¼Œput æ–¹æ³•è¿”å›æ—§å€¼å°±ç»“æŸäº†\n    for (Entry&lt;K,V&gt; e &#x3D; table[i]; e !&#x3D; null; e &#x3D; e.next) &#123;\n        Object k;\n        if (e.hash &#x3D;&#x3D; hash &amp;&amp; ((k &#x3D; e.key) &#x3D;&#x3D; key || key.equals(k))) &#123;\n            V oldValue &#x3D; e.value;\n            e.value &#x3D; value;\n            e.recordAccess(this);\n            return oldValue;\n        &#125;\n    &#125;\n \n    modCount++;\n    &#x2F;&#x2F; 4. ä¸å­˜åœ¨é‡å¤çš„ keyï¼Œå°†æ­¤ entry æ·»åŠ åˆ°é“¾è¡¨ä¸­ï¼Œç»†èŠ‚åé¢è¯´\n    addEntry(hash, key, value, i);\n    return null;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h6 id=\"æ•°ç»„åˆå§‹åŒ–\"><a href=\"#æ•°ç»„åˆå§‹åŒ–\" class=\"headerlink\" title=\"æ•°ç»„åˆå§‹åŒ–\"></a>æ•°ç»„åˆå§‹åŒ–</h6><p>åœ¨ç¬¬ä¸€ä¸ªå…ƒç´ æ’å…¥ HashMap çš„æ—¶å€™åšä¸€æ¬¡æ•°ç»„çš„åˆå§‹åŒ–ï¼Œå°±æ˜¯å…ˆç¡®å®šåˆå§‹çš„æ•°ç»„å¤§å°ï¼Œå¹¶è®¡ç®—æ•°ç»„æ‰©å®¹çš„é˜ˆå€¼ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private void inflateTable(int toSize) &#123;\n    &#x2F;&#x2F; ä¿è¯æ•°ç»„å¤§å°ä¸€å®šæ˜¯ 2 çš„ n æ¬¡æ–¹ã€‚\n    &#x2F;&#x2F; æ¯”å¦‚è¿™æ ·åˆå§‹åŒ–ï¼šnew HashMap(20)ï¼Œé‚£ä¹ˆå¤„ç†æˆåˆå§‹æ•°ç»„å¤§å°æ˜¯ 32\n    int capacity &#x3D; roundUpToPowerOf2(toSize);\n    &#x2F;&#x2F; è®¡ç®—æ‰©å®¹é˜ˆå€¼ï¼šcapacity * loadFactor\n    threshold &#x3D; (int) Math.min(capacity * loadFactor, MAXIMUM_CAPACITY + 1);\n    &#x2F;&#x2F; ç®—æ˜¯åˆå§‹åŒ–æ•°ç»„å§\n    table &#x3D; new Entry[capacity];\n    initHashSeedAsNeeded(capacity); &#x2F;&#x2F;ignore\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™é‡Œæœ‰ä¸€ä¸ªå°†æ•°ç»„å¤§å°ä¿æŒä¸º 2 çš„ n æ¬¡æ–¹çš„åšæ³•ï¼ŒJava7 å’Œ Java8 çš„ HashMap å’Œ ConcurrentHashMap éƒ½æœ‰ç›¸åº”çš„è¦æ±‚ï¼Œåªä¸è¿‡å®ç°çš„ä»£ç ç¨å¾®æœ‰äº›ä¸åŒï¼Œåé¢å†çœ‹åˆ°çš„æ—¶å€™å°±çŸ¥é“äº†ã€‚</p>\n<h6 id=\"è®¡ç®—å…·ä½“æ•°ç»„ä½ç½®\"><a href=\"#è®¡ç®—å…·ä½“æ•°ç»„ä½ç½®\" class=\"headerlink\" title=\"è®¡ç®—å…·ä½“æ•°ç»„ä½ç½®\"></a>è®¡ç®—å…·ä½“æ•°ç»„ä½ç½®</h6><p>è¿™ä¸ªç®€å•ï¼Œæˆ‘ä»¬è‡ªå·±ä¹Ÿèƒ½ YY ä¸€ä¸ªï¼šä½¿ç”¨ key çš„ hash å€¼å¯¹æ•°ç»„é•¿åº¦è¿›è¡Œå–æ¨¡å°±å¯ä»¥äº†ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">static int indexFor(int hash, int length) &#123;\n    &#x2F;&#x2F; assert Integer.bitCount(length) &#x3D;&#x3D; 1 : &quot;length must be a non-zero power of 2&quot;;\n    return hash &amp; (length-1);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªæ–¹æ³•å¾ˆç®€å•ï¼Œç®€å•è¯´å°±æ˜¯å– hash å€¼çš„ä½ n ä½ã€‚å¦‚åœ¨æ•°ç»„é•¿åº¦ä¸º 32 çš„æ—¶å€™ï¼Œå…¶å®å–çš„å°±æ˜¯ key çš„ hash å€¼çš„ä½ 5 ä½ï¼Œä½œä¸ºå®ƒåœ¨æ•°ç»„ä¸­çš„ä¸‹æ ‡ä½ç½®ã€‚</p>\n<h6 id=\"æ·»åŠ èŠ‚ç‚¹åˆ°é“¾è¡¨ä¸­\"><a href=\"#æ·»åŠ èŠ‚ç‚¹åˆ°é“¾è¡¨ä¸­\" class=\"headerlink\" title=\"æ·»åŠ èŠ‚ç‚¹åˆ°é“¾è¡¨ä¸­\"></a>æ·»åŠ èŠ‚ç‚¹åˆ°é“¾è¡¨ä¸­</h6><p>æ‰¾åˆ°æ•°ç»„ä¸‹æ ‡åï¼Œä¼šå…ˆè¿›è¡Œ key åˆ¤é‡ï¼Œå¦‚æœæ²¡æœ‰é‡å¤ï¼Œå°±å‡†å¤‡å°†æ–°å€¼æ”¾å…¥åˆ°é“¾è¡¨çš„è¡¨å¤´ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">void addEntry(int hash, K key, V value, int bucketIndex) &#123;\n    &#x2F;&#x2F; å¦‚æœå½“å‰ HashMap å¤§å°å·²ç»è¾¾åˆ°äº†é˜ˆå€¼ï¼Œå¹¶ä¸”æ–°å€¼è¦æ’å…¥çš„æ•°ç»„ä½ç½®å·²ç»æœ‰å…ƒç´ äº†ï¼Œé‚£ä¹ˆè¦æ‰©å®¹\n    if ((size &gt;&#x3D; threshold) &amp;&amp; (null !&#x3D; table[bucketIndex])) &#123;\n        &#x2F;&#x2F; æ‰©å®¹ï¼Œåé¢ä¼šä»‹ç»ä¸€ä¸‹\n        resize(2 * table.length);\n        &#x2F;&#x2F; æ‰©å®¹ä»¥åï¼Œé‡æ–°è®¡ç®— hash å€¼\n        hash &#x3D; (null !&#x3D; key) ? hash(key) : 0;\n        &#x2F;&#x2F; é‡æ–°è®¡ç®—æ‰©å®¹åçš„æ–°çš„ä¸‹æ ‡\n        bucketIndex &#x3D; indexFor(hash, table.length);\n    &#125;\n    &#x2F;&#x2F; å¾€ä¸‹çœ‹\n    createEntry(hash, key, value, bucketIndex);\n&#125;\n\n&#x2F;&#x2F; è¿™ä¸ªå¾ˆç®€å•ï¼Œå…¶å®å°±æ˜¯å°†æ–°å€¼æ”¾åˆ°é“¾è¡¨çš„è¡¨å¤´ï¼Œç„¶å size++\nvoid createEntry(int hash, K key, V value, int bucketIndex) &#123;\n    Entry&lt;K,V&gt; e &#x3D; table[bucketIndex];\n    table[bucketIndex] &#x3D; new Entry&lt;&gt;(hash, key, value, e);\n    size++;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªæ–¹æ³•çš„ä¸»è¦é€»è¾‘å°±æ˜¯å…ˆåˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹ï¼Œéœ€è¦çš„è¯å…ˆæ‰©å®¹ï¼Œç„¶åå†å°†è¿™ä¸ªæ–°çš„æ•°æ®æ’å…¥åˆ°æ‰©å®¹åçš„æ•°ç»„çš„ç›¸åº”ä½ç½®å¤„çš„é“¾è¡¨çš„è¡¨å¤´ã€‚</p>\n<h6 id=\"æ•°ç»„æ‰©å®¹\"><a href=\"#æ•°ç»„æ‰©å®¹\" class=\"headerlink\" title=\"æ•°ç»„æ‰©å®¹\"></a>æ•°ç»„æ‰©å®¹</h6><p>å‰é¢æˆ‘ä»¬çœ‹åˆ°ï¼Œåœ¨æ’å…¥æ–°å€¼çš„æ—¶å€™ï¼Œå¦‚æœå½“å‰çš„ size å·²ç»è¾¾åˆ°äº†é˜ˆå€¼ï¼Œå¹¶ä¸”è¦æ’å…¥çš„æ•°ç»„ä½ç½®ä¸Šå·²ç»æœ‰å…ƒç´ ï¼Œé‚£ä¹ˆå°±ä¼šè§¦å‘æ‰©å®¹ï¼Œæ‰©å®¹åï¼Œæ•°ç»„å¤§å°ä¸ºåŸæ¥çš„ 2 å€ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">void resize(int newCapacity) &#123;\n    Entry[] oldTable &#x3D; table;\n    int oldCapacity &#x3D; oldTable.length;\n    if (oldCapacity &#x3D;&#x3D; MAXIMUM_CAPACITY) &#123;\n        threshold &#x3D; Integer.MAX_VALUE;\n        return;\n    &#125;\n    &#x2F;&#x2F; æ–°çš„æ•°ç»„\n    Entry[] newTable &#x3D; new Entry[newCapacity];\n    &#x2F;&#x2F; å°†åŸæ¥æ•°ç»„ä¸­çš„å€¼è¿ç§»åˆ°æ–°çš„æ›´å¤§çš„æ•°ç»„ä¸­\n    transfer(newTable, initHashSeedAsNeeded(newCapacity));\n    table &#x3D; newTable;\n    threshold &#x3D; (int)Math.min(newCapacity * loadFactor, MAXIMUM_CAPACITY + 1);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ‰©å®¹å°±æ˜¯ç”¨ä¸€ä¸ªæ–°çš„å¤§æ•°ç»„æ›¿æ¢åŸæ¥çš„å°æ•°ç»„ï¼Œå¹¶å°†åŸæ¥æ•°ç»„ä¸­çš„å€¼è¿ç§»åˆ°æ–°çš„æ•°ç»„ä¸­ã€‚</p>\n<p>ç”±äºæ˜¯åŒå€æ‰©å®¹ï¼Œè¿ç§»è¿‡ç¨‹ä¸­ï¼Œä¼šå°†åŸæ¥ table[i] ä¸­çš„é“¾è¡¨çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œåˆ†æ‹†åˆ°æ–°çš„æ•°ç»„çš„ newTable[i] å’Œ newTable[i + oldLength] ä½ç½®ä¸Šã€‚å¦‚åŸæ¥æ•°ç»„é•¿åº¦æ˜¯ 16ï¼Œé‚£ä¹ˆæ‰©å®¹åï¼ŒåŸæ¥ table[0] å¤„çš„é“¾è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ ä¼šè¢«åˆ†é…åˆ°æ–°æ•°ç»„ä¸­ newTable[0] å’Œ newTable[16] è¿™ä¸¤ä¸ªä½ç½®ã€‚ä»£ç æ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œå°±ä¸å±•å¼€äº†ã€‚</p>\n<h4 id=\"get-è¿‡ç¨‹åˆ†æ\"><a href=\"#get-è¿‡ç¨‹åˆ†æ\" class=\"headerlink\" title=\"get è¿‡ç¨‹åˆ†æ\"></a>get è¿‡ç¨‹åˆ†æ</h4><p>ç›¸å¯¹äº put è¿‡ç¨‹ï¼Œget è¿‡ç¨‹æ˜¯éå¸¸ç®€å•çš„ã€‚</p>\n<ol>\n<li>æ ¹æ® key è®¡ç®— hash å€¼ã€‚</li>\n<li>æ‰¾åˆ°ç›¸åº”çš„æ•°ç»„ä¸‹æ ‡ï¼šhash &amp; (length â€“ 1)ã€‚</li>\n<li>éå†è¯¥æ•°ç»„ä½ç½®å¤„çš„é“¾è¡¨ï¼Œç›´åˆ°æ‰¾åˆ°ç›¸ç­‰(&#x3D;&#x3D;æˆ–equals)çš„ keyã€‚</li>\n</ol>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public V get(Object key) &#123;\n    &#x2F;&#x2F; ä¹‹å‰è¯´è¿‡ï¼Œkey ä¸º null çš„è¯ï¼Œä¼šè¢«æ”¾åˆ° table[0]ï¼Œæ‰€ä»¥åªè¦éå†ä¸‹ table[0] å¤„çš„é“¾è¡¨å°±å¯ä»¥äº†\n    if (key &#x3D;&#x3D; null)\n        return getForNullKey();\n    &#x2F;&#x2F; \n    Entry&lt;K,V&gt; entry &#x3D; getEntry(key);\n \n    return null &#x3D;&#x3D; entry ? null : entry.getValue();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>getEntry(key):</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">final Entry&lt;K,V&gt; getEntry(Object key) &#123;\n    if (size &#x3D;&#x3D; 0) &#123;\n        return null;\n    &#125;\n \n    int hash &#x3D; (key &#x3D;&#x3D; null) ? 0 : hash(key);\n    &#x2F;&#x2F; ç¡®å®šæ•°ç»„ä¸‹æ ‡ï¼Œç„¶åä»å¤´å¼€å§‹éå†é“¾è¡¨ï¼Œç›´åˆ°æ‰¾åˆ°ä¸ºæ­¢\n    for (Entry&lt;K,V&gt; e &#x3D; table[indexFor(hash, table.length)];\n         e !&#x3D; null;\n         e &#x3D; e.next) &#123;\n        Object k;\n        if (e.hash &#x3D;&#x3D; hash &amp;&amp;\n            ((k &#x3D; e.key) &#x3D;&#x3D; key || (key !&#x3D; null &amp;&amp; key.equals(k))))\n            return e;\n    &#125;\n    return null;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"Java7-ConcurrentHashMap\"><a href=\"#Java7-ConcurrentHashMap\" class=\"headerlink\" title=\"Java7 ConcurrentHashMap\"></a>Java7 ConcurrentHashMap</h2><p>ConcurrentHashMap å’Œ HashMap æ€è·¯æ˜¯å·®ä¸å¤šçš„ï¼Œä½†æ˜¯å› ä¸ºå®ƒæ”¯æŒå¹¶å‘æ“ä½œï¼Œæ‰€ä»¥è¦å¤æ‚ä¸€äº›ã€‚</p>\n<p>æ•´ä¸ª ConcurrentHashMap ç”±ä¸€ä¸ªä¸ª Segment ç»„æˆï¼ŒSegment ä»£è¡¨â€éƒ¨åˆ†â€œæˆ–â€ä¸€æ®µâ€œçš„æ„æ€ï¼Œæ‰€ä»¥å¾ˆå¤šåœ°æ–¹éƒ½ä¼šå°†å…¶æè¿°ä¸º<strong>åˆ†æ®µé”</strong>ã€‚æ³¨æ„ï¼Œè¡Œæ–‡ä¸­ï¼Œæˆ‘å¾ˆå¤šåœ°æ–¹ç”¨äº† <strong>â€œæ§½â€</strong> æ¥ä»£è¡¨ä¸€ä¸ª segmentã€‚</p>\n<p>ç®€å•ç†è§£å°±æ˜¯ï¼ŒConcurrentHashMap æ˜¯ä¸€ä¸ª Segment æ•°ç»„ï¼ŒSegment é€šè¿‡ç»§æ‰¿ ReentrantLock æ¥è¿›è¡ŒåŠ é”ï¼Œæ‰€ä»¥æ¯æ¬¡éœ€è¦åŠ é”çš„æ“ä½œé”ä½çš„æ˜¯ä¸€ä¸ª segmentï¼Œè¿™æ ·åªè¦ä¿è¯æ¯ä¸ª Segment æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä¹Ÿå°±å®ç°äº†å…¨å±€çš„çº¿ç¨‹å®‰å…¨ã€‚æ¨èé˜…è¯»ï¼š<a href=\"https://mp.weixin.qq.com/s/0CI9od4DIxRrmOGFJw0SuQ\">å²ä¸Šæœ€å…¨ Java å¤šçº¿ç¨‹é¢è¯•é¢˜åŠç­”æ¡ˆ</a>ã€‚</p>\n<p><img src=\"http://qianniu.javastack.cn/18-12-4/75121838.jpg\"></p>\n<p><strong>concurrencyLevelï¼š</strong> å¹¶è¡Œçº§åˆ«ã€å¹¶å‘æ•°ã€Segment æ•°ï¼Œæ€ä¹ˆç¿»è¯‘ä¸é‡è¦ï¼Œç†è§£å®ƒã€‚é»˜è®¤æ˜¯ 16ï¼Œä¹Ÿå°±æ˜¯è¯´ ConcurrentHashMap æœ‰ 16 ä¸ª Segmentsï¼Œæ‰€ä»¥ç†è®ºä¸Šï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæœ€å¤šå¯ä»¥åŒæ—¶æ”¯æŒ 16 ä¸ªçº¿ç¨‹å¹¶å‘å†™ï¼Œåªè¦å®ƒä»¬çš„æ“ä½œåˆ†åˆ«åˆ†å¸ƒåœ¨ä¸åŒçš„ Segment ä¸Šã€‚è¿™ä¸ªå€¼å¯ä»¥åœ¨åˆå§‹åŒ–çš„æ—¶å€™è®¾ç½®ä¸ºå…¶ä»–å€¼ï¼Œä½†æ˜¯ä¸€æ—¦åˆå§‹åŒ–ä»¥åï¼Œå®ƒæ˜¯ä¸å¯ä»¥æ‰©å®¹çš„ã€‚</p>\n<p>å†å…·ä½“åˆ°æ¯ä¸ª Segment å†…éƒ¨ï¼Œå…¶å®æ¯ä¸ª Segment å¾ˆåƒä¹‹å‰ä»‹ç»çš„ HashMapï¼Œä¸è¿‡å®ƒè¦ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œæ‰€ä»¥å¤„ç†èµ·æ¥è¦éº»çƒ¦äº›ã€‚æ¨èé˜…è¯»ï¼š<a href=\"https://mp.weixin.qq.com/s/5Y5_6qn2g6kIVmQia_0R6g\">å‡ ç§çº¿ç¨‹å®‰å…¨çš„Mapè§£æ</a>ã€‚</p>\n<h4 id=\"åˆå§‹åŒ–\"><a href=\"#åˆå§‹åŒ–\" class=\"headerlink\" title=\"åˆå§‹åŒ–\"></a>åˆå§‹åŒ–</h4><p>initialCapacityï¼šåˆå§‹å®¹é‡ï¼Œè¿™ä¸ªå€¼æŒ‡çš„æ˜¯æ•´ä¸ª ConcurrentHashMap çš„åˆå§‹å®¹é‡ï¼Œå®é™…æ“ä½œçš„æ—¶å€™éœ€è¦å¹³å‡åˆ†ç»™æ¯ä¸ª Segmentã€‚</p>\n<p>loadFactorï¼šè´Ÿè½½å› å­ï¼Œä¹‹å‰æˆ‘ä»¬è¯´äº†ï¼ŒSegment æ•°ç»„ä¸å¯ä»¥æ‰©å®¹ï¼Œæ‰€ä»¥è¿™ä¸ªè´Ÿè½½å› å­æ˜¯ç»™æ¯ä¸ª Segment å†…éƒ¨ä½¿ç”¨çš„ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public ConcurrentHashMap(int initialCapacity,\n                         float loadFactor, int concurrencyLevel) &#123;\n    if (!(loadFactor &gt; 0) || initialCapacity &lt; 0 || concurrencyLevel &lt;&#x3D; 0)\n        throw new IllegalArgumentException();\n    if (concurrencyLevel &gt; MAX_SEGMENTS)\n        concurrencyLevel &#x3D; MAX_SEGMENTS;\n    &#x2F;&#x2F; Find power-of-two sizes best matching arguments\n    int sshift &#x3D; 0;\n    int ssize &#x3D; 1;\n    &#x2F;&#x2F; è®¡ç®—å¹¶è¡Œçº§åˆ« ssizeï¼Œå› ä¸ºè¦ä¿æŒå¹¶è¡Œçº§åˆ«æ˜¯ 2 çš„ n æ¬¡æ–¹\n    while (ssize &lt; concurrencyLevel) &#123;\n        ++sshift;\n        ssize &lt;&lt;&#x3D; 1;\n    &#125;\n    &#x2F;&#x2F; æˆ‘ä»¬è¿™é‡Œå…ˆä¸è¦é‚£ä¹ˆçƒ§è„‘ï¼Œç”¨é»˜è®¤å€¼ï¼ŒconcurrencyLevel ä¸º 16ï¼Œsshift ä¸º 4\n    &#x2F;&#x2F; é‚£ä¹ˆè®¡ç®—å‡º segmentShift ä¸º 28ï¼ŒsegmentMask ä¸º 15ï¼Œåé¢ä¼šç”¨åˆ°è¿™ä¸¤ä¸ªå€¼\n    this.segmentShift &#x3D; 32 - sshift;\n    this.segmentMask &#x3D; ssize - 1;\n \n    if (initialCapacity &gt; MAXIMUM_CAPACITY)\n        initialCapacity &#x3D; MAXIMUM_CAPACITY;\n \n    &#x2F;&#x2F; initialCapacity æ˜¯è®¾ç½®æ•´ä¸ª map åˆå§‹çš„å¤§å°ï¼Œ\n    &#x2F;&#x2F; è¿™é‡Œæ ¹æ® initialCapacity è®¡ç®— Segment æ•°ç»„ä¸­æ¯ä¸ªä½ç½®å¯ä»¥åˆ†åˆ°çš„å¤§å°\n    &#x2F;&#x2F; å¦‚ initialCapacity ä¸º 64ï¼Œé‚£ä¹ˆæ¯ä¸ª Segment æˆ–ç§°ä¹‹ä¸º&quot;æ§½&quot;å¯ä»¥åˆ†åˆ° 4 ä¸ª\n    int c &#x3D; initialCapacity &#x2F; ssize;\n    if (c * ssize &lt; initialCapacity)\n        ++c;\n    &#x2F;&#x2F; é»˜è®¤ MIN_SEGMENT_TABLE_CAPACITY æ˜¯ 2ï¼Œè¿™ä¸ªå€¼ä¹Ÿæ˜¯æœ‰è®²ç©¶çš„ï¼Œå› ä¸ºè¿™æ ·çš„è¯ï¼Œå¯¹äºå…·ä½“çš„æ§½ä¸Šï¼Œ\n    &#x2F;&#x2F; æ’å…¥ä¸€ä¸ªå…ƒç´ ä¸è‡³äºæ‰©å®¹ï¼Œæ’å…¥ç¬¬äºŒä¸ªçš„æ—¶å€™æ‰ä¼šæ‰©å®¹\n    int cap &#x3D; MIN_SEGMENT_TABLE_CAPACITY; \n    while (cap &lt; c)\n        cap &lt;&lt;&#x3D; 1;\n \n    &#x2F;&#x2F; åˆ›å»º Segment æ•°ç»„ï¼Œ\n    &#x2F;&#x2F; å¹¶åˆ›å»ºæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´  segment[0]\n    Segment&lt;K,V&gt; s0 &#x3D;\n        new Segment&lt;K,V&gt;(loadFactor, (int)(cap * loadFactor),\n                         (HashEntry&lt;K,V&gt;[])new HashEntry[cap]);\n    Segment&lt;K,V&gt;[] ss &#x3D; (Segment&lt;K,V&gt;[])new Segment[ssize];\n    &#x2F;&#x2F; å¾€æ•°ç»„å†™å…¥ segment[0]\n    UNSAFE.putOrderedObject(ss, SBASE, s0); &#x2F;&#x2F; ordered write of segments[0]\n    this.segments &#x3D; ss;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>åˆå§‹åŒ–å®Œæˆï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ª Segment æ•°ç»„ã€‚</p>\n<p>æˆ‘ä»¬å°±å½“æ˜¯ç”¨ new ConcurrentHashMap() æ— å‚æ„é€ å‡½æ•°è¿›è¡Œåˆå§‹åŒ–çš„ï¼Œé‚£ä¹ˆåˆå§‹åŒ–å®Œæˆåï¼š</p>\n<ul>\n<li>Segment æ•°ç»„é•¿åº¦ä¸º 16ï¼Œä¸å¯ä»¥æ‰©å®¹</li>\n<li>Segment[i] çš„é»˜è®¤å¤§å°ä¸º 2ï¼Œè´Ÿè½½å› å­æ˜¯ 0.75ï¼Œå¾—å‡ºåˆå§‹é˜ˆå€¼ä¸º 1.5ï¼Œä¹Ÿå°±æ˜¯ä»¥åæ’å…¥ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ä¼šè§¦å‘æ‰©å®¹ï¼Œæ’å…¥ç¬¬äºŒä¸ªä¼šè¿›è¡Œç¬¬ä¸€æ¬¡æ‰©å®¹</li>\n<li>è¿™é‡Œåˆå§‹åŒ–äº† segment[0]ï¼Œå…¶ä»–ä½ç½®è¿˜æ˜¯ nullï¼Œè‡³äºä¸ºä»€ä¹ˆè¦åˆå§‹åŒ– segment[0]ï¼Œåé¢çš„ä»£ç ä¼šä»‹ç»</li>\n<li>å½“å‰ segmentShift çš„å€¼ä¸º 32 â€“ 4 &#x3D; 28ï¼ŒsegmentMask ä¸º 16 â€“ 1 &#x3D; 15ï¼Œå§‘ä¸”æŠŠå®ƒä»¬ç®€å•ç¿»è¯‘ä¸ºç§»ä½æ•°å’Œæ©ç ï¼Œè¿™ä¸¤ä¸ªå€¼é©¬ä¸Šå°±ä¼šç”¨åˆ°ã€‚</li>\n</ul>\n<h4 id=\"put-è¿‡ç¨‹åˆ†æ-1\"><a href=\"#put-è¿‡ç¨‹åˆ†æ-1\" class=\"headerlink\" title=\"put è¿‡ç¨‹åˆ†æ\"></a>put è¿‡ç¨‹åˆ†æ</h4><p>æˆ‘ä»¬å…ˆçœ‹ put çš„ä¸»æµç¨‹ï¼Œå¯¹äºå…¶ä¸­çš„ä¸€äº›å…³é”®ç»†èŠ‚æ“ä½œï¼Œåé¢ä¼šè¿›è¡Œè¯¦ç»†ä»‹ç»ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public V put(K key, V value) &#123;\n    Segment&lt;K,V&gt; s;\n    if (value &#x3D;&#x3D; null)\n        throw new NullPointerException();\n    &#x2F;&#x2F; 1. è®¡ç®— key çš„ hash å€¼\n    int hash &#x3D; hash(key);\n    &#x2F;&#x2F; 2. æ ¹æ® hash å€¼æ‰¾åˆ° Segment æ•°ç»„ä¸­çš„ä½ç½® j\n    &#x2F;&#x2F;    hash æ˜¯ 32 ä½ï¼Œæ— ç¬¦å·å³ç§» segmentShift(28) ä½ï¼Œå‰©ä¸‹ä½ 4 ä½ï¼Œ\n    &#x2F;&#x2F;    ç„¶åå’Œ segmentMask(15) åšä¸€æ¬¡ä¸æ“ä½œï¼Œä¹Ÿå°±æ˜¯è¯´ j æ˜¯ hash å€¼çš„æœ€å 4 ä½ï¼Œä¹Ÿå°±æ˜¯æ§½çš„æ•°ç»„ä¸‹æ ‡\n    int j &#x3D; (hash &gt;&gt;&gt; segmentShift) &amp; segmentMask;\n    &#x2F;&#x2F; åˆšåˆšè¯´äº†ï¼Œåˆå§‹åŒ–çš„æ—¶å€™åˆå§‹åŒ–äº† segment[0]ï¼Œä½†æ˜¯å…¶ä»–ä½ç½®è¿˜æ˜¯ nullï¼Œ\n    &#x2F;&#x2F; ensureSegment(j) å¯¹ segment[j] è¿›è¡Œåˆå§‹åŒ–\n    if ((s &#x3D; (Segment&lt;K,V&gt;)UNSAFE.getObject          &#x2F;&#x2F; nonvolatile; recheck\n         (segments, (j &lt;&lt; SSHIFT) + SBASE)) &#x3D;&#x3D; null) &#x2F;&#x2F;  in ensureSegment\n        s &#x3D; ensureSegment(j);\n    &#x2F;&#x2F; 3. æ’å…¥æ–°å€¼åˆ° æ§½ s ä¸­\n    return s.put(key, hash, value, false);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¬¬ä¸€å±‚çš®å¾ˆç®€å•ï¼Œæ ¹æ® hash å€¼å¾ˆå¿«å°±èƒ½æ‰¾åˆ°ç›¸åº”çš„ Segmentï¼Œä¹‹åå°±æ˜¯ Segment å†…éƒ¨çš„ put æ“ä½œäº†ã€‚</p>\n<p>Segment å†…éƒ¨æ˜¯ç”± <strong>æ•°ç»„+é“¾è¡¨</strong> ç»„æˆçš„ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">final V put(K key, int hash, V value, boolean onlyIfAbsent) &#123;\n    &#x2F;&#x2F; åœ¨å¾€è¯¥ segment å†™å…¥å‰ï¼Œéœ€è¦å…ˆè·å–è¯¥ segment çš„ç‹¬å é”\n    &#x2F;&#x2F;    å…ˆçœ‹ä¸»æµç¨‹ï¼Œåé¢è¿˜ä¼šå…·ä½“ä»‹ç»è¿™éƒ¨åˆ†å†…å®¹\n    HashEntry&lt;K,V&gt; node &#x3D; tryLock() ? null :\n        scanAndLockForPut(key, hash, value);\n    V oldValue;\n    try &#123;\n        &#x2F;&#x2F; è¿™ä¸ªæ˜¯ segment å†…éƒ¨çš„æ•°ç»„\n        HashEntry&lt;K,V&gt;[] tab &#x3D; table;\n        &#x2F;&#x2F; å†åˆ©ç”¨ hash å€¼ï¼Œæ±‚åº”è¯¥æ”¾ç½®çš„æ•°ç»„ä¸‹æ ‡\n        int index &#x3D; (tab.length - 1) &amp; hash;\n        &#x2F;&#x2F; first æ˜¯æ•°ç»„è¯¥ä½ç½®å¤„çš„é“¾è¡¨çš„è¡¨å¤´\n        HashEntry&lt;K,V&gt; first &#x3D; entryAt(tab, index);\n \n        &#x2F;&#x2F; ä¸‹é¢è¿™ä¸² for å¾ªç¯è™½ç„¶å¾ˆé•¿ï¼Œä¸è¿‡ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œæƒ³æƒ³è¯¥ä½ç½®æ²¡æœ‰ä»»ä½•å…ƒç´ å’Œå·²ç»å­˜åœ¨ä¸€ä¸ªé“¾è¡¨è¿™ä¸¤ç§æƒ…å†µ\n        for (HashEntry&lt;K,V&gt; e &#x3D; first;;) &#123;\n            if (e !&#x3D; null) &#123;\n                K k;\n                if ((k &#x3D; e.key) &#x3D;&#x3D; key ||\n                    (e.hash &#x3D;&#x3D; hash &amp;&amp; key.equals(k))) &#123;\n                    oldValue &#x3D; e.value;\n                    if (!onlyIfAbsent) &#123;\n                        &#x2F;&#x2F; è¦†ç›–æ—§å€¼\n                        e.value &#x3D; value;\n                        ++modCount;\n                    &#125;\n                    break;\n                &#125;\n                &#x2F;&#x2F; ç»§ç»­é¡ºç€é“¾è¡¨èµ°\n                e &#x3D; e.next;\n            &#125;\n            else &#123;\n                &#x2F;&#x2F; node åˆ°åº•æ˜¯ä¸æ˜¯ nullï¼Œè¿™ä¸ªè¦çœ‹è·å–é”çš„è¿‡ç¨‹ï¼Œä¸è¿‡å’Œè¿™é‡Œéƒ½æ²¡æœ‰å…³ç³»ã€‚\n                &#x2F;&#x2F; å¦‚æœä¸ä¸º nullï¼Œé‚£å°±ç›´æ¥å°†å®ƒè®¾ç½®ä¸ºé“¾è¡¨è¡¨å¤´ï¼›å¦‚æœæ˜¯nullï¼Œåˆå§‹åŒ–å¹¶è®¾ç½®ä¸ºé“¾è¡¨è¡¨å¤´ã€‚\n                if (node !&#x3D; null)\n                    node.setNext(first);\n                else\n                    node &#x3D; new HashEntry&lt;K,V&gt;(hash, key, value, first);\n \n                int c &#x3D; count + 1;\n                &#x2F;&#x2F; å¦‚æœè¶…è¿‡äº†è¯¥ segment çš„é˜ˆå€¼ï¼Œè¿™ä¸ª segment éœ€è¦æ‰©å®¹\n                if (c &gt; threshold &amp;&amp; tab.length &lt; MAXIMUM_CAPACITY)\n                    rehash(node); &#x2F;&#x2F; æ‰©å®¹åé¢ä¹Ÿä¼šå…·ä½“åˆ†æ\n                else\n                    &#x2F;&#x2F; æ²¡æœ‰è¾¾åˆ°é˜ˆå€¼ï¼Œå°† node æ”¾åˆ°æ•°ç»„ tab çš„ index ä½ç½®ï¼Œ\n                    &#x2F;&#x2F; å…¶å®å°±æ˜¯å°†æ–°çš„èŠ‚ç‚¹è®¾ç½®æˆåŸé“¾è¡¨çš„è¡¨å¤´\n                    setEntryAt(tab, index, node);\n                ++modCount;\n                count &#x3D; c;\n                oldValue &#x3D; null;\n                break;\n            &#125;\n        &#125;\n    &#125; finally &#123;\n        &#x2F;&#x2F; è§£é”\n        unlock();\n    &#125;\n    return oldValue;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ•´ä½“æµç¨‹è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œç”±äºæœ‰ç‹¬å é”çš„ä¿æŠ¤ï¼Œæ‰€ä»¥ segment å†…éƒ¨çš„æ“ä½œå¹¶ä¸å¤æ‚ã€‚è‡³äºè¿™é‡Œé¢çš„å¹¶å‘é—®é¢˜ï¼Œæˆ‘ä»¬ç¨åå†è¿›è¡Œä»‹ç»ã€‚</p>\n<p>åˆ°è¿™é‡Œ put æ“ä½œå°±ç»“æŸäº†ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¯´ä¸€è¯´å…¶ä¸­å‡ æ­¥å…³é”®çš„æ“ä½œã€‚</p>\n<h6 id=\"åˆå§‹åŒ–æ§½-ensureSegment\"><a href=\"#åˆå§‹åŒ–æ§½-ensureSegment\" class=\"headerlink\" title=\"åˆå§‹åŒ–æ§½: ensureSegment\"></a>åˆå§‹åŒ–æ§½: ensureSegment</h6><p>ConcurrentHashMap åˆå§‹åŒ–çš„æ—¶å€™ä¼šåˆå§‹åŒ–ç¬¬ä¸€ä¸ªæ§½ segment[0]ï¼Œå¯¹äºå…¶ä»–æ§½æ¥è¯´ï¼Œåœ¨æ’å…¥ç¬¬ä¸€ä¸ªå€¼çš„æ—¶å€™è¿›è¡Œåˆå§‹åŒ–ã€‚</p>\n<p>è¿™é‡Œéœ€è¦è€ƒè™‘å¹¶å‘ï¼Œå› ä¸ºå¾ˆå¯èƒ½ä¼šæœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶è¿›æ¥åˆå§‹åŒ–åŒä¸€ä¸ªæ§½ segment[k]ï¼Œä¸è¿‡åªè¦æœ‰ä¸€ä¸ªæˆåŠŸäº†å°±å¯ä»¥ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private Segment&lt;K,V&gt; ensureSegment(int k) &#123;\n    final Segment&lt;K,V&gt;[] ss &#x3D; this.segments;\n    long u &#x3D; (k &lt;&lt; SSHIFT) + SBASE; &#x2F;&#x2F; raw offset\n    Segment&lt;K,V&gt; seg;\n    if ((seg &#x3D; (Segment&lt;K,V&gt;)UNSAFE.getObjectVolatile(ss, u)) &#x3D;&#x3D; null) &#123;\n        &#x2F;&#x2F; è¿™é‡Œçœ‹åˆ°ä¸ºä»€ä¹ˆä¹‹å‰è¦åˆå§‹åŒ– segment[0] äº†ï¼Œ\n        &#x2F;&#x2F; ä½¿ç”¨å½“å‰ segment[0] å¤„çš„æ•°ç»„é•¿åº¦å’Œè´Ÿè½½å› å­æ¥åˆå§‹åŒ– segment[k]\n        &#x2F;&#x2F; ä¸ºä»€ä¹ˆè¦ç”¨â€œå½“å‰â€ï¼Œå› ä¸º segment[0] å¯èƒ½æ—©å°±æ‰©å®¹è¿‡äº†\n        Segment&lt;K,V&gt; proto &#x3D; ss[0];\n        int cap &#x3D; proto.table.length;\n        float lf &#x3D; proto.loadFactor;\n        int threshold &#x3D; (int)(cap * lf);\n \n        &#x2F;&#x2F; åˆå§‹åŒ– segment[k] å†…éƒ¨çš„æ•°ç»„\n        HashEntry&lt;K,V&gt;[] tab &#x3D; (HashEntry&lt;K,V&gt;[])new HashEntry[cap];\n        if ((seg &#x3D; (Segment&lt;K,V&gt;)UNSAFE.getObjectVolatile(ss, u))\n            &#x3D;&#x3D; null) &#123; &#x2F;&#x2F; å†æ¬¡æ£€æŸ¥ä¸€éè¯¥æ§½æ˜¯å¦è¢«å…¶ä»–çº¿ç¨‹åˆå§‹åŒ–äº†ã€‚\n \n            Segment&lt;K,V&gt; s &#x3D; new Segment&lt;K,V&gt;(lf, threshold, tab);\n            &#x2F;&#x2F; ä½¿ç”¨ while å¾ªç¯ï¼Œå†…éƒ¨ç”¨ CASï¼Œå½“å‰çº¿ç¨‹æˆåŠŸè®¾å€¼æˆ–å…¶ä»–çº¿ç¨‹æˆåŠŸè®¾å€¼åï¼Œé€€å‡º\n            while ((seg &#x3D; (Segment&lt;K,V&gt;)UNSAFE.getObjectVolatile(ss, u))\n                   &#x3D;&#x3D; null) &#123;\n                if (UNSAFE.compareAndSwapObject(ss, u, null, seg &#x3D; s))\n                    break;\n            &#125;\n        &#125;\n    &#125;\n    return seg;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ€»çš„æ¥è¯´ï¼ŒensureSegment(int k) æ¯”è¾ƒç®€å•ï¼Œå¯¹äºå¹¶å‘æ“ä½œä½¿ç”¨ CAS è¿›è¡Œæ§åˆ¶ã€‚</p>\n<blockquote>\n<p>å¦‚æœå½“å‰çº¿ç¨‹ CAS å¤±è´¥ï¼Œè¿™é‡Œçš„ while å¾ªç¯æ˜¯ä¸ºäº†å°† seg èµ‹å€¼è¿”å›ã€‚</p>\n</blockquote>\n<h6 id=\"è·å–å†™å…¥é”-scanAndLockForPut\"><a href=\"#è·å–å†™å…¥é”-scanAndLockForPut\" class=\"headerlink\" title=\"è·å–å†™å…¥é”: scanAndLockForPut\"></a>è·å–å†™å…¥é”: scanAndLockForPut</h6><p>å‰é¢æˆ‘ä»¬çœ‹åˆ°ï¼Œåœ¨å¾€æŸä¸ª segment ä¸­ put çš„æ—¶å€™ï¼Œé¦–å…ˆä¼šè°ƒç”¨ node &#x3D; tryLock() ? null : scanAndLockForPut(key, hash, value)ï¼Œä¹Ÿå°±æ˜¯è¯´å…ˆè¿›è¡Œä¸€æ¬¡ tryLock() å¿«é€Ÿè·å–è¯¥ segment çš„ç‹¬å é”ï¼Œå¦‚æœå¤±è´¥ï¼Œé‚£ä¹ˆè¿›å…¥åˆ° scanAndLockForPut è¿™ä¸ªæ–¹æ³•æ¥è·å–é”ã€‚</p>\n<p>ä¸‹é¢æˆ‘ä»¬æ¥å…·ä½“åˆ†æè¿™ä¸ªæ–¹æ³•ä¸­æ˜¯æ€ä¹ˆæ§åˆ¶åŠ é”çš„ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private HashEntry&lt;K,V&gt; scanAndLockForPut(K key, int hash, V value) &#123;\n    HashEntry&lt;K,V&gt; first &#x3D; entryForHash(this, hash);\n    HashEntry&lt;K,V&gt; e &#x3D; first;\n    HashEntry&lt;K,V&gt; node &#x3D; null;\n    int retries &#x3D; -1; &#x2F;&#x2F; negative while locating node\n \n    &#x2F;&#x2F; å¾ªç¯è·å–é”\n    while (!tryLock()) &#123;\n        HashEntry&lt;K,V&gt; f; &#x2F;&#x2F; to recheck first below\n        if (retries &lt; 0) &#123;\n            if (e &#x3D;&#x3D; null) &#123;\n                if (node &#x3D;&#x3D; null) &#x2F;&#x2F; speculatively create node\n                    &#x2F;&#x2F; è¿›åˆ°è¿™é‡Œè¯´æ˜æ•°ç»„è¯¥ä½ç½®çš„é“¾è¡¨æ˜¯ç©ºçš„ï¼Œæ²¡æœ‰ä»»ä½•å…ƒç´ \n                    &#x2F;&#x2F; å½“ç„¶ï¼Œè¿›åˆ°è¿™é‡Œçš„å¦ä¸€ä¸ªåŸå› æ˜¯ tryLock() å¤±è´¥ï¼Œæ‰€ä»¥è¯¥æ§½å­˜åœ¨å¹¶å‘ï¼Œä¸ä¸€å®šæ˜¯è¯¥ä½ç½®\n                    node &#x3D; new HashEntry&lt;K,V&gt;(hash, key, value, null);\n                retries &#x3D; 0;\n            &#125;\n            else if (key.equals(e.key))\n                retries &#x3D; 0;\n            else\n                &#x2F;&#x2F; é¡ºç€é“¾è¡¨å¾€ä¸‹èµ°\n                e &#x3D; e.next;\n        &#125;\n        &#x2F;&#x2F; é‡è¯•æ¬¡æ•°å¦‚æœè¶…è¿‡ MAX_SCAN_RETRIESï¼ˆå•æ ¸1å¤šæ ¸64ï¼‰ï¼Œé‚£ä¹ˆä¸æŠ¢äº†ï¼Œè¿›å…¥åˆ°é˜»å¡é˜Ÿåˆ—ç­‰å¾…é”\n        &#x2F;&#x2F;    lock() æ˜¯é˜»å¡æ–¹æ³•ï¼Œç›´åˆ°è·å–é”åè¿”å›\n        else if (++retries &gt; MAX_SCAN_RETRIES) &#123;\n            lock();\n            break;\n        &#125;\n        else if ((retries &amp; 1) &#x3D;&#x3D; 0 &amp;&amp;\n                 &#x2F;&#x2F; è¿™ä¸ªæ—¶å€™æ˜¯æœ‰å¤§é—®é¢˜äº†ï¼Œé‚£å°±æ˜¯æœ‰æ–°çš„å…ƒç´ è¿›åˆ°äº†é“¾è¡¨ï¼Œæˆä¸ºäº†æ–°çš„è¡¨å¤´\n                 &#x2F;&#x2F;     æ‰€ä»¥è¿™è¾¹çš„ç­–ç•¥æ˜¯ï¼Œç›¸å½“äºé‡æ–°èµ°ä¸€éè¿™ä¸ª scanAndLockForPut æ–¹æ³•\n                 (f &#x3D; entryForHash(this, hash)) !&#x3D; first) &#123;\n            e &#x3D; first &#x3D; f; &#x2F;&#x2F; re-traverse if entry changed\n            retries &#x3D; -1;\n        &#125;\n    &#125;\n    return node;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªæ–¹æ³•æœ‰ä¸¤ä¸ªå‡ºå£ï¼Œä¸€ä¸ªæ˜¯ tryLock() æˆåŠŸäº†ï¼Œå¾ªç¯ç»ˆæ­¢ï¼Œå¦ä¸€ä¸ªå°±æ˜¯é‡è¯•æ¬¡æ•°è¶…è¿‡äº† MAX_SCAN_RETRIESï¼Œè¿›åˆ° lock() æ–¹æ³•ï¼Œæ­¤æ–¹æ³•ä¼šé˜»å¡ç­‰å¾…ï¼Œç›´åˆ°æˆåŠŸæ‹¿åˆ°ç‹¬å é”ã€‚</p>\n<p>è¿™ä¸ªæ–¹æ³•å°±æ˜¯çœ‹ä¼¼å¤æ‚ï¼Œä½†æ˜¯å…¶å®å°±æ˜¯åšäº†ä¸€ä»¶äº‹ï¼Œé‚£å°±æ˜¯<strong>è·å–è¯¥ segment çš„ç‹¬å é”</strong>ï¼Œå¦‚æœéœ€è¦çš„è¯é¡ºä¾¿å®ä¾‹åŒ–äº†ä¸€ä¸‹ nodeã€‚</p>\n<h6 id=\"æ‰©å®¹-rehash\"><a href=\"#æ‰©å®¹-rehash\" class=\"headerlink\" title=\"æ‰©å®¹: rehash\"></a>æ‰©å®¹: rehash</h6><p>é‡å¤ä¸€ä¸‹ï¼Œsegment æ•°ç»„ä¸èƒ½æ‰©å®¹ï¼Œæ‰©å®¹æ˜¯ segment æ•°ç»„æŸä¸ªä½ç½®å†…éƒ¨çš„æ•°ç»„ HashEntry[] è¿›è¡Œæ‰©å®¹ï¼Œæ‰©å®¹åï¼Œå®¹é‡ä¸ºåŸæ¥çš„ 2 å€ã€‚</p>\n<p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦å›é¡¾ä¸€ä¸‹è§¦å‘æ‰©å®¹çš„åœ°æ–¹ï¼Œput çš„æ—¶å€™ï¼Œå¦‚æœåˆ¤æ–­è¯¥å€¼çš„æ’å…¥ä¼šå¯¼è‡´è¯¥ segment çš„å…ƒç´ ä¸ªæ•°è¶…è¿‡é˜ˆå€¼ï¼Œé‚£ä¹ˆå…ˆè¿›è¡Œæ‰©å®¹ï¼Œå†æ’å€¼ï¼Œè¯»è€…è¿™ä¸ªæ—¶å€™å¯ä»¥å›å» put æ–¹æ³•çœ‹ä¸€çœ¼ã€‚</p>\n<p>è¯¥æ–¹æ³•ä¸éœ€è¦è€ƒè™‘å¹¶å‘ï¼Œå› ä¸ºåˆ°è¿™é‡Œçš„æ—¶å€™ï¼Œæ˜¯æŒæœ‰è¯¥ segment çš„ç‹¬å é”çš„ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; æ–¹æ³•å‚æ•°ä¸Šçš„ node æ˜¯è¿™æ¬¡æ‰©å®¹åï¼Œéœ€è¦æ·»åŠ åˆ°æ–°çš„æ•°ç»„ä¸­çš„æ•°æ®ã€‚\nprivate void rehash(HashEntry&lt;K,V&gt; node) &#123;\n    HashEntry&lt;K,V&gt;[] oldTable &#x3D; table;\n    int oldCapacity &#x3D; oldTable.length;\n    &#x2F;&#x2F; 2 å€\n    int newCapacity &#x3D; oldCapacity &lt;&lt; 1;\n    threshold &#x3D; (int)(newCapacity * loadFactor);\n    &#x2F;&#x2F; åˆ›å»ºæ–°æ•°ç»„\n    HashEntry&lt;K,V&gt;[] newTable &#x3D;\n        (HashEntry&lt;K,V&gt;[]) new HashEntry[newCapacity];\n    &#x2F;&#x2F; æ–°çš„æ©ç ï¼Œå¦‚ä» 16 æ‰©å®¹åˆ° 32ï¼Œé‚£ä¹ˆ sizeMask ä¸º 31ï¼Œå¯¹åº”äºŒè¿›åˆ¶ â€˜000...00011111â€™\n    int sizeMask &#x3D; newCapacity - 1;\n \n    &#x2F;&#x2F; éå†åŸæ•°ç»„ï¼Œè€å¥—è·¯ï¼Œå°†åŸæ•°ç»„ä½ç½® i å¤„çš„é“¾è¡¨æ‹†åˆ†åˆ° æ–°æ•°ç»„ä½ç½® i å’Œ i+oldCap ä¸¤ä¸ªä½ç½®\n    for (int i &#x3D; 0; i &lt; oldCapacity ; i++) &#123;\n        &#x2F;&#x2F; e æ˜¯é“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ \n        HashEntry&lt;K,V&gt; e &#x3D; oldTable[i];\n        if (e !&#x3D; null) &#123;\n            HashEntry&lt;K,V&gt; next &#x3D; e.next;\n            &#x2F;&#x2F; è®¡ç®—åº”è¯¥æ”¾ç½®åœ¨æ–°æ•°ç»„ä¸­çš„ä½ç½®ï¼Œ\n            &#x2F;&#x2F; å‡è®¾åŸæ•°ç»„é•¿åº¦ä¸º 16ï¼Œe åœ¨ oldTable[3] å¤„ï¼Œé‚£ä¹ˆ idx åªå¯èƒ½æ˜¯ 3 æˆ–è€…æ˜¯ 3 + 16 &#x3D; 19\n            int idx &#x3D; e.hash &amp; sizeMask;\n            if (next &#x3D;&#x3D; null)   &#x2F;&#x2F; è¯¥ä½ç½®å¤„åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œé‚£æ¯”è¾ƒå¥½åŠ\n                newTable[idx] &#x3D; e;\n            else &#123; &#x2F;&#x2F; Reuse consecutive sequence at same slot\n                &#x2F;&#x2F; e æ˜¯é“¾è¡¨è¡¨å¤´\n                HashEntry&lt;K,V&gt; lastRun &#x3D; e;\n                &#x2F;&#x2F; idx æ˜¯å½“å‰é“¾è¡¨çš„å¤´ç»“ç‚¹ e çš„æ–°ä½ç½®\n                int lastIdx &#x3D; idx;\n \n                &#x2F;&#x2F; ä¸‹é¢è¿™ä¸ª for å¾ªç¯ä¼šæ‰¾åˆ°ä¸€ä¸ª lastRun èŠ‚ç‚¹ï¼Œè¿™ä¸ªèŠ‚ç‚¹ä¹‹åçš„æ‰€æœ‰å…ƒç´ æ˜¯å°†è¦æ”¾åˆ°ä¸€èµ·çš„\n                for (HashEntry&lt;K,V&gt; last &#x3D; next;\n                     last !&#x3D; null;\n                     last &#x3D; last.next) &#123;\n                    int k &#x3D; last.hash &amp; sizeMask;\n                    if (k !&#x3D; lastIdx) &#123;\n                        lastIdx &#x3D; k;\n                        lastRun &#x3D; last;\n                    &#125;\n                &#125;\n                &#x2F;&#x2F; å°† lastRun åŠå…¶ä¹‹åçš„æ‰€æœ‰èŠ‚ç‚¹ç»„æˆçš„è¿™ä¸ªé“¾è¡¨æ”¾åˆ° lastIdx è¿™ä¸ªä½ç½®\n                newTable[lastIdx] &#x3D; lastRun;\n                &#x2F;&#x2F; ä¸‹é¢çš„æ“ä½œæ˜¯å¤„ç† lastRun ä¹‹å‰çš„èŠ‚ç‚¹ï¼Œ\n                &#x2F;&#x2F;    è¿™äº›èŠ‚ç‚¹å¯èƒ½åˆ†é…åœ¨å¦ä¸€ä¸ªé“¾è¡¨ä¸­ï¼Œä¹Ÿå¯èƒ½åˆ†é…åˆ°ä¸Šé¢çš„é‚£ä¸ªé“¾è¡¨ä¸­\n                for (HashEntry&lt;K,V&gt; p &#x3D; e; p !&#x3D; lastRun; p &#x3D; p.next) &#123;\n                    V v &#x3D; p.value;\n                    int h &#x3D; p.hash;\n                    int k &#x3D; h &amp; sizeMask;\n                    HashEntry&lt;K,V&gt; n &#x3D; newTable[k];\n                    newTable[k] &#x3D; new HashEntry&lt;K,V&gt;(h, p.key, v, n);\n                &#125;\n            &#125;\n        &#125;\n    &#125;\n    &#x2F;&#x2F; å°†æ–°æ¥çš„ node æ”¾åˆ°æ–°æ•°ç»„ä¸­åˆšåˆšçš„ ä¸¤ä¸ªé“¾è¡¨ä¹‹ä¸€ çš„ å¤´éƒ¨\n    int nodeIndex &#x3D; node.hash &amp; sizeMask; &#x2F;&#x2F; add the new node\n    node.setNext(newTable[nodeIndex]);\n    newTable[nodeIndex] &#x3D; node;\n    table &#x3D; newTable;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™é‡Œçš„æ‰©å®¹æ¯”ä¹‹å‰çš„ HashMap è¦å¤æ‚ä¸€äº›ï¼Œä»£ç éš¾æ‡‚ä¸€ç‚¹ã€‚ä¸Šé¢æœ‰ä¸¤ä¸ªæŒ¨ç€çš„ for å¾ªç¯ï¼Œç¬¬ä¸€ä¸ª for æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ</p>\n<p>ä»”ç»†ä¸€çœ‹å‘ç°ï¼Œå¦‚æœæ²¡æœ‰ç¬¬ä¸€ä¸ª for å¾ªç¯ï¼Œä¹Ÿæ˜¯å¯ä»¥å·¥ä½œçš„ï¼Œä½†æ˜¯ï¼Œè¿™ä¸ª for å¾ªç¯ä¸‹æ¥ï¼Œå¦‚æœ lastRun çš„åé¢è¿˜æœ‰æ¯”è¾ƒå¤šçš„èŠ‚ç‚¹ï¼Œé‚£ä¹ˆè¿™æ¬¡å°±æ˜¯å€¼å¾—çš„ã€‚å› ä¸ºæˆ‘ä»¬åªéœ€è¦å…‹éš† lastRun å‰é¢çš„èŠ‚ç‚¹ï¼Œåé¢çš„ä¸€ä¸²èŠ‚ç‚¹è·Ÿç€ lastRun èµ°å°±æ˜¯äº†ï¼Œä¸éœ€è¦åšä»»ä½•æ“ä½œã€‚</p>\n<p>æˆ‘è§‰å¾— Doug Lea çš„è¿™ä¸ªæƒ³æ³•ä¹Ÿæ˜¯æŒºæœ‰æ„æ€çš„ï¼Œä¸è¿‡æ¯”è¾ƒåçš„æƒ…å†µå°±æ˜¯æ¯æ¬¡ lastRun éƒ½æ˜¯é“¾è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ æˆ–è€…å¾ˆé åçš„å…ƒç´ ï¼Œé‚£ä¹ˆè¿™æ¬¡éå†å°±æœ‰ç‚¹æµªè´¹äº†ã€‚<strong>ä¸è¿‡ Doug Lea ä¹Ÿè¯´äº†ï¼Œæ ¹æ®ç»Ÿè®¡ï¼Œå¦‚æœä½¿ç”¨é»˜è®¤çš„é˜ˆå€¼ï¼Œå¤§çº¦åªæœ‰ 1&#x2F;6 çš„èŠ‚ç‚¹éœ€è¦å…‹éš†ã€‚</strong></p>\n<h4 id=\"get-è¿‡ç¨‹åˆ†æ-1\"><a href=\"#get-è¿‡ç¨‹åˆ†æ-1\" class=\"headerlink\" title=\"get è¿‡ç¨‹åˆ†æ\"></a>get è¿‡ç¨‹åˆ†æ</h4><p>ç›¸å¯¹äº put æ¥è¯´ï¼Œget çœŸçš„ä¸è¦å¤ªç®€å•ã€‚</p>\n<ol>\n<li>è®¡ç®— hash å€¼ï¼Œæ‰¾åˆ° segment æ•°ç»„ä¸­çš„å…·ä½“ä½ç½®ï¼Œæˆ–æˆ‘ä»¬å‰é¢ç”¨çš„â€œæ§½â€</li>\n<li>æ§½ä¸­ä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ ¹æ® hash æ‰¾åˆ°æ•°ç»„ä¸­å…·ä½“çš„ä½ç½®</li>\n<li>åˆ°è¿™é‡Œæ˜¯é“¾è¡¨äº†ï¼Œé¡ºç€é“¾è¡¨è¿›è¡ŒæŸ¥æ‰¾å³å¯</li>\n</ol>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public V get(Object key) &#123;\n    Segment&lt;K,V&gt; s; &#x2F;&#x2F; manually integrate access methods to reduce overhead\n    HashEntry&lt;K,V&gt;[] tab;\n    &#x2F;&#x2F; 1. hash å€¼\n    int h &#x3D; hash(key);\n    long u &#x3D; (((h &gt;&gt;&gt; segmentShift) &amp; segmentMask) &lt;&lt; SSHIFT) + SBASE;\n    &#x2F;&#x2F; 2. æ ¹æ® hash æ‰¾åˆ°å¯¹åº”çš„ segment\n    if ((s &#x3D; (Segment&lt;K,V&gt;)UNSAFE.getObjectVolatile(segments, u)) !&#x3D; null &amp;&amp;\n        (tab &#x3D; s.table) !&#x3D; null) &#123;\n        &#x2F;&#x2F; 3. æ‰¾åˆ°segment å†…éƒ¨æ•°ç»„ç›¸åº”ä½ç½®çš„é“¾è¡¨ï¼Œéå†\n        for (HashEntry&lt;K,V&gt; e &#x3D; (HashEntry&lt;K,V&gt;) UNSAFE.getObjectVolatile\n                 (tab, ((long)(((tab.length - 1) &amp; h)) &lt;&lt; TSHIFT) + TBASE);\n             e !&#x3D; null; e &#x3D; e.next) &#123;\n            K k;\n            if ((k &#x3D; e.key) &#x3D;&#x3D; key || (e.hash &#x3D;&#x3D; h &amp;&amp; key.equals(k)))\n                return e.value;\n        &#125;\n    &#125;\n    return null;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"å¹¶å‘é—®é¢˜åˆ†æ\"><a href=\"#å¹¶å‘é—®é¢˜åˆ†æ\" class=\"headerlink\" title=\"å¹¶å‘é—®é¢˜åˆ†æ\"></a>å¹¶å‘é—®é¢˜åˆ†æ</h4><p>ç°åœ¨æˆ‘ä»¬å·²ç»è¯´å®Œäº† put è¿‡ç¨‹å’Œ get è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° get è¿‡ç¨‹ä¸­æ˜¯æ²¡æœ‰åŠ é”çš„ï¼Œé‚£è‡ªç„¶æˆ‘ä»¬å°±éœ€è¦å»è€ƒè™‘å¹¶å‘é—®é¢˜ã€‚</p>\n<p>æ·»åŠ èŠ‚ç‚¹çš„æ“ä½œ put å’Œåˆ é™¤èŠ‚ç‚¹çš„æ“ä½œ remove éƒ½æ˜¯è¦åŠ  segment ä¸Šçš„ç‹¬å é”çš„ï¼Œæ‰€ä»¥å®ƒä»¬ä¹‹é—´è‡ªç„¶ä¸ä¼šæœ‰é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘çš„é—®é¢˜å°±æ˜¯ get çš„æ—¶å€™åœ¨åŒä¸€ä¸ª segment ä¸­å‘ç”Ÿäº† put æˆ– remove æ“ä½œã€‚æ¨èé˜…è¯»ï¼š<a href=\"https://mp.weixin.qq.com/s/Q5F604CUM_0x2co9mvADxw\">30 ä¸ª Java é›†åˆé¢è¯•é—®é¢˜åŠç­”æ¡ˆ</a>ã€‚</p>\n<ul>\n<li><strong>put æ“ä½œçš„çº¿ç¨‹å®‰å…¨æ€§</strong></li>\n</ul>\n<ol>\n<li>åˆå§‹åŒ–æ§½ï¼Œè¿™ä¸ªæˆ‘ä»¬ä¹‹å‰å°±è¯´è¿‡äº†ï¼Œä½¿ç”¨äº† CAS æ¥åˆå§‹åŒ– Segment ä¸­çš„æ•°ç»„ã€‚</li>\n<li>æ·»åŠ èŠ‚ç‚¹åˆ°é“¾è¡¨çš„æ“ä½œæ˜¯æ’å…¥åˆ°è¡¨å¤´çš„ï¼Œæ‰€ä»¥ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™ get æ“ä½œåœ¨é“¾è¡¨éå†çš„è¿‡ç¨‹å·²ç»åˆ°äº†ä¸­é—´ï¼Œæ˜¯ä¸ä¼šå½±å“çš„ã€‚å½“ç„¶ï¼Œå¦ä¸€ä¸ªå¹¶å‘é—®é¢˜å°±æ˜¯ get æ“ä½œåœ¨ put ä¹‹åï¼Œéœ€è¦ä¿è¯åˆšåˆšæ’å…¥è¡¨å¤´çš„èŠ‚ç‚¹è¢«è¯»å–ï¼Œè¿™ä¸ªä¾èµ–äº setEntryAt æ–¹æ³•ä¸­ä½¿ç”¨çš„ UNSAFE.putOrderedObjectã€‚</li>\n<li>æ‰©å®¹ã€‚æ‰©å®¹æ˜¯æ–°åˆ›å»ºäº†æ•°ç»„ï¼Œç„¶åè¿›è¡Œè¿ç§»æ•°æ®ï¼Œæœ€åé¢å°† newTable è®¾ç½®ç»™å±æ€§ tableã€‚æ‰€ä»¥ï¼Œå¦‚æœ get æ“ä½œæ­¤æ—¶ä¹Ÿåœ¨è¿›è¡Œï¼Œé‚£ä¹ˆä¹Ÿæ²¡å…³ç³»ï¼Œå¦‚æœ get å…ˆè¡Œï¼Œé‚£ä¹ˆå°±æ˜¯åœ¨æ—§çš„ table ä¸ŠåšæŸ¥è¯¢æ“ä½œï¼›è€Œ put å…ˆè¡Œï¼Œé‚£ä¹ˆ put æ“ä½œçš„å¯è§æ€§ä¿è¯å°±æ˜¯ table ä½¿ç”¨äº† volatile å…³é”®å­—ã€‚</li>\n</ol>\n<ul>\n<li><strong>remove æ“ä½œçš„çº¿ç¨‹å®‰å…¨æ€§</strong></li>\n</ul>\n<p>remove æ“ä½œæˆ‘ä»¬æ²¡æœ‰åˆ†ææºç ï¼Œæ‰€ä»¥è¿™é‡Œè¯´çš„è¯»è€…æ„Ÿå…´è¶£çš„è¯è¿˜æ˜¯éœ€è¦åˆ°æºç ä¸­å»æ±‚å®ä¸€ä¸‹çš„ã€‚</p>\n<p>get æ“ä½œéœ€è¦éå†é“¾è¡¨ï¼Œä½†æ˜¯ remove æ“ä½œä¼šâ€ç ´åâ€é“¾è¡¨ã€‚</p>\n<p>å¦‚æœ remove ç ´åçš„èŠ‚ç‚¹ get æ“ä½œå·²ç»è¿‡å»äº†ï¼Œé‚£ä¹ˆè¿™é‡Œä¸å­˜åœ¨ä»»ä½•é—®é¢˜ã€‚</p>\n<p>å¦‚æœ remove å…ˆç ´åäº†ä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆ†ä¸¤ç§æƒ…å†µè€ƒè™‘ã€‚</p>\n<p>1ã€å¦‚æœæ­¤èŠ‚ç‚¹æ˜¯å¤´ç»“ç‚¹ï¼Œé‚£ä¹ˆéœ€è¦å°†å¤´ç»“ç‚¹çš„ next è®¾ç½®ä¸ºæ•°ç»„è¯¥ä½ç½®çš„å…ƒç´ ï¼Œtable è™½ç„¶ä½¿ç”¨äº† volatile ä¿®é¥°ï¼Œä½†æ˜¯ volatile å¹¶ä¸èƒ½æä¾›æ•°ç»„å†…éƒ¨æ“ä½œçš„å¯è§æ€§ä¿è¯ï¼Œæ‰€ä»¥æºç ä¸­ä½¿ç”¨äº† UNSAFE æ¥æ“ä½œæ•°ç»„ï¼Œè¯·çœ‹æ–¹æ³• setEntryAtã€‚</p>\n<p>2ã€å¦‚æœè¦åˆ é™¤çš„èŠ‚ç‚¹ä¸æ˜¯å¤´ç»“ç‚¹ï¼Œå®ƒä¼šå°†è¦åˆ é™¤èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹æ¥åˆ°å‰é©±èŠ‚ç‚¹ä¸­ï¼Œè¿™é‡Œçš„å¹¶å‘ä¿è¯å°±æ˜¯ next å±æ€§æ˜¯ volatile çš„ã€‚æ¨èé˜…è¯»ï¼š<a href=\"https://mp.weixin.qq.com/s/0CI9od4DIxRrmOGFJw0SuQ\">å²ä¸Šæœ€å…¨ Java å¤šçº¿ç¨‹é¢è¯•é¢˜åŠç­”æ¡ˆ</a>ã€‚</p>\n<h2 id=\"Java8-HashMap\"><a href=\"#Java8-HashMap\" class=\"headerlink\" title=\"Java8 HashMap\"></a>Java8 HashMap</h2><p>Java8 å¯¹ HashMap è¿›è¡Œäº†ä¸€äº›ä¿®æ”¹ï¼Œæœ€å¤§çš„ä¸åŒå°±æ˜¯åˆ©ç”¨äº†çº¢é»‘æ ‘ï¼Œæ‰€ä»¥å…¶ç”± <strong>æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘</strong> ç»„æˆã€‚</p>\n<p>æ ¹æ® Java7 HashMap çš„ä»‹ç»ï¼Œæˆ‘ä»¬çŸ¥é“ï¼ŒæŸ¥æ‰¾çš„æ—¶å€™ï¼Œæ ¹æ® hash å€¼æˆ‘ä»¬èƒ½å¤Ÿå¿«é€Ÿå®šä½åˆ°æ•°ç»„çš„å…·ä½“ä¸‹æ ‡ï¼Œä½†æ˜¯ä¹‹åçš„è¯ï¼Œéœ€è¦é¡ºç€é“¾è¡¨ä¸€ä¸ªä¸ªæ¯”è¾ƒä¸‹å»æ‰èƒ½æ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„ï¼Œæ—¶é—´å¤æ‚åº¦å–å†³äºé“¾è¡¨çš„é•¿åº¦ï¼Œä¸º **O(n)**ã€‚</p>\n<p>ä¸ºäº†é™ä½è¿™éƒ¨åˆ†çš„å¼€é”€ï¼Œåœ¨ Java8 ä¸­ï¼Œå½“é“¾è¡¨ä¸­çš„å…ƒç´ è¶…è¿‡äº† 8 ä¸ªä»¥åï¼Œä¼šå°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œåœ¨è¿™äº›ä½ç½®è¿›è¡ŒæŸ¥æ‰¾çš„æ—¶å€™å¯ä»¥é™ä½æ—¶é—´å¤æ‚åº¦ä¸º O(logN)ã€‚</p>\n<p>æ¥ä¸€å¼ å›¾ç®€å•ç¤ºæ„ä¸€ä¸‹å§ï¼š</p>\n<p><img src=\"http://qianniu.javastack.cn/18-12-4/75398751.jpg\"></p>\n<blockquote>\n<p>æ³¨æ„ï¼Œä¸Šå›¾æ˜¯ç¤ºæ„å›¾ï¼Œä¸»è¦æ˜¯æè¿°ç»“æ„ï¼Œä¸ä¼šè¾¾åˆ°è¿™ä¸ªçŠ¶æ€çš„ï¼Œå› ä¸ºè¿™ä¹ˆå¤šæ•°æ®çš„æ—¶å€™æ—©å°±æ‰©å®¹äº†ã€‚</p>\n</blockquote>\n<p>ä¸‹é¢ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç”¨ä»£ç æ¥ä»‹ç»å§ï¼Œä¸ªäººæ„Ÿè§‰ï¼ŒJava8 çš„æºç å¯è¯»æ€§è¦å·®ä¸€äº›ï¼Œä¸è¿‡ç²¾ç®€ä¸€äº›ã€‚</p>\n<p>Java7 ä¸­ä½¿ç”¨ Entry æ¥ä»£è¡¨æ¯ä¸ª HashMap ä¸­çš„æ•°æ®èŠ‚ç‚¹ï¼ŒJava8 ä¸­ä½¿ç”¨ <strong>Node</strong>ï¼ŒåŸºæœ¬æ²¡æœ‰åŒºåˆ«ï¼Œéƒ½æ˜¯ keyï¼Œvalueï¼Œhash å’Œ next è¿™å››ä¸ªå±æ€§ï¼Œä¸è¿‡ï¼ŒNode åªèƒ½ç”¨äºé“¾è¡¨çš„æƒ…å†µï¼Œçº¢é»‘æ ‘çš„æƒ…å†µéœ€è¦ä½¿ç”¨ <strong>TreeNode</strong>ã€‚</p>\n<p>æˆ‘ä»¬æ ¹æ®æ•°ç»„å…ƒç´ ä¸­ï¼Œç¬¬ä¸€ä¸ªèŠ‚ç‚¹æ•°æ®ç±»å‹æ˜¯ Node è¿˜æ˜¯ TreeNode æ¥åˆ¤æ–­è¯¥ä½ç½®ä¸‹æ˜¯é“¾è¡¨è¿˜æ˜¯çº¢é»‘æ ‘çš„ã€‚æ¨èé˜…è¯»ï¼š<a href=\"https://mp.weixin.qq.com/s/Q5F604CUM_0x2co9mvADxw\">30 ä¸ª Java é›†åˆé¢è¯•é—®é¢˜åŠç­”æ¡ˆ</a>ã€‚</p>\n<h4 id=\"put-è¿‡ç¨‹åˆ†æ-2\"><a href=\"#put-è¿‡ç¨‹åˆ†æ-2\" class=\"headerlink\" title=\"put è¿‡ç¨‹åˆ†æ\"></a>put è¿‡ç¨‹åˆ†æ</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">public V put(K key, V value) &#123;\n    return putVal(hash(key), key, value, false, true);\n&#125;\n \n&#x2F;&#x2F; ç¬¬ä¸‰ä¸ªå‚æ•° onlyIfAbsent å¦‚æœæ˜¯ trueï¼Œé‚£ä¹ˆåªæœ‰åœ¨ä¸å­˜åœ¨è¯¥ key æ—¶æ‰ä¼šè¿›è¡Œ put æ“ä½œ\n&#x2F;&#x2F; ç¬¬å››ä¸ªå‚æ•° evict æˆ‘ä»¬è¿™é‡Œä¸å…³å¿ƒ\nfinal V putVal(int hash, K key, V value, boolean onlyIfAbsent,\n               boolean evict) &#123;\n    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, i;\n    &#x2F;&#x2F; ç¬¬ä¸€æ¬¡ put å€¼çš„æ—¶å€™ï¼Œä¼šè§¦å‘ä¸‹é¢çš„ resize()ï¼Œç±»ä¼¼ java7 çš„ç¬¬ä¸€æ¬¡ put ä¹Ÿè¦åˆå§‹åŒ–æ•°ç»„é•¿åº¦\n    &#x2F;&#x2F; ç¬¬ä¸€æ¬¡ resize å’Œåç»­çš„æ‰©å®¹æœ‰äº›ä¸ä¸€æ ·ï¼Œå› ä¸ºè¿™æ¬¡æ˜¯æ•°ç»„ä» null åˆå§‹åŒ–åˆ°é»˜è®¤çš„ 16 æˆ–è‡ªå®šä¹‰çš„åˆå§‹å®¹é‡\n    if ((tab &#x3D; table) &#x3D;&#x3D; null || (n &#x3D; tab.length) &#x3D;&#x3D; 0)\n        n &#x3D; (tab &#x3D; resize()).length;\n    &#x2F;&#x2F; æ‰¾åˆ°å…·ä½“çš„æ•°ç»„ä¸‹æ ‡ï¼Œå¦‚æœæ­¤ä½ç½®æ²¡æœ‰å€¼ï¼Œé‚£ä¹ˆç›´æ¥åˆå§‹åŒ–ä¸€ä¸‹ Node å¹¶æ”¾ç½®åœ¨è¿™ä¸ªä½ç½®å°±å¯ä»¥äº†\n    if ((p &#x3D; tab[i &#x3D; (n - 1) &amp; hash]) &#x3D;&#x3D; null)\n        tab[i] &#x3D; newNode(hash, key, value, null);\n \n    else &#123;&#x2F;&#x2F; æ•°ç»„è¯¥ä½ç½®æœ‰æ•°æ®\n        Node&lt;K,V&gt; e; K k;\n        &#x2F;&#x2F; é¦–å…ˆï¼Œåˆ¤æ–­è¯¥ä½ç½®çš„ç¬¬ä¸€ä¸ªæ•°æ®å’Œæˆ‘ä»¬è¦æ’å…¥çš„æ•°æ®ï¼Œkey æ˜¯ä¸æ˜¯&quot;ç›¸ç­‰&quot;ï¼Œå¦‚æœæ˜¯ï¼Œå–å‡ºè¿™ä¸ªèŠ‚ç‚¹\n        if (p.hash &#x3D;&#x3D; hash &amp;&amp;\n            ((k &#x3D; p.key) &#x3D;&#x3D; key || (key !&#x3D; null &amp;&amp; key.equals(k))))\n            e &#x3D; p;\n        &#x2F;&#x2F; å¦‚æœè¯¥èŠ‚ç‚¹æ˜¯ä»£è¡¨çº¢é»‘æ ‘çš„èŠ‚ç‚¹ï¼Œè°ƒç”¨çº¢é»‘æ ‘çš„æ’å€¼æ–¹æ³•ï¼Œæœ¬æ–‡ä¸å±•å¼€è¯´çº¢é»‘æ ‘\n        else if (p instanceof TreeNode)\n            e &#x3D; ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value);\n        else &#123;\n            &#x2F;&#x2F; åˆ°è¿™é‡Œï¼Œè¯´æ˜æ•°ç»„è¯¥ä½ç½®ä¸Šæ˜¯ä¸€ä¸ªé“¾è¡¨\n            for (int binCount &#x3D; 0; ; ++binCount) &#123;\n                &#x2F;&#x2F; æ’å…¥åˆ°é“¾è¡¨çš„æœ€åé¢(Java7 æ˜¯æ’å…¥åˆ°é“¾è¡¨çš„æœ€å‰é¢)\n                if ((e &#x3D; p.next) &#x3D;&#x3D; null) &#123;\n                    p.next &#x3D; newNode(hash, key, value, null);\n                    &#x2F;&#x2F; TREEIFY_THRESHOLD ä¸º 8ï¼Œæ‰€ä»¥ï¼Œå¦‚æœæ–°æ’å…¥çš„å€¼æ˜¯é“¾è¡¨ä¸­çš„ç¬¬ 9 ä¸ª\n                    &#x2F;&#x2F; ä¼šè§¦å‘ä¸‹é¢çš„ treeifyBinï¼Œä¹Ÿå°±æ˜¯å°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘\n                    if (binCount &gt;&#x3D; TREEIFY_THRESHOLD - 1) &#x2F;&#x2F; -1 for 1st\n                        treeifyBin(tab, hash);\n                    break;\n                &#125;\n                &#x2F;&#x2F; å¦‚æœåœ¨è¯¥é“¾è¡¨ä¸­æ‰¾åˆ°äº†&quot;ç›¸ç­‰&quot;çš„ key(&#x3D;&#x3D; æˆ– equals)\n                if (e.hash &#x3D;&#x3D; hash &amp;&amp;\n                    ((k &#x3D; e.key) &#x3D;&#x3D; key || (key !&#x3D; null &amp;&amp; key.equals(k))))\n                    &#x2F;&#x2F; æ­¤æ—¶ breakï¼Œé‚£ä¹ˆ e ä¸ºé“¾è¡¨ä¸­[ä¸è¦æ’å…¥çš„æ–°å€¼çš„ key &quot;ç›¸ç­‰&quot;]çš„ node\n                    break;\n                p &#x3D; e;\n            &#125;\n        &#125;\n        &#x2F;&#x2F; e!&#x3D;null è¯´æ˜å­˜åœ¨æ—§å€¼çš„keyä¸è¦æ’å…¥çš„key&quot;ç›¸ç­‰&quot;\n        &#x2F;&#x2F; å¯¹äºæˆ‘ä»¬åˆ†æçš„putæ“ä½œï¼Œä¸‹é¢è¿™ä¸ª if å…¶å®å°±æ˜¯è¿›è¡Œ &quot;å€¼è¦†ç›–&quot;ï¼Œç„¶åè¿”å›æ—§å€¼\n        if (e !&#x3D; null) &#123;\n            V oldValue &#x3D; e.value;\n            if (!onlyIfAbsent || oldValue &#x3D;&#x3D; null)\n                e.value &#x3D; value;\n            afterNodeAccess(e);\n            return oldValue;\n        &#125;\n    &#125;\n    ++modCount;\n    &#x2F;&#x2F; å¦‚æœ HashMap ç”±äºæ–°æ’å…¥è¿™ä¸ªå€¼å¯¼è‡´ size å·²ç»è¶…è¿‡äº†é˜ˆå€¼ï¼Œéœ€è¦è¿›è¡Œæ‰©å®¹\n    if (++size &gt; threshold)\n        resize();\n    afterNodeInsertion(evict);\n    return null;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å’Œ Java7 ç¨å¾®æœ‰ç‚¹ä¸ä¸€æ ·çš„åœ°æ–¹å°±æ˜¯ï¼ŒJava7 æ˜¯å…ˆæ‰©å®¹åæ’å…¥æ–°å€¼çš„ï¼ŒJava8 å…ˆæ’å€¼å†æ‰©å®¹ï¼Œä¸è¿‡è¿™ä¸ªä¸é‡è¦ã€‚</p>\n<h6 id=\"æ•°ç»„æ‰©å®¹-1\"><a href=\"#æ•°ç»„æ‰©å®¹-1\" class=\"headerlink\" title=\"æ•°ç»„æ‰©å®¹\"></a>æ•°ç»„æ‰©å®¹</h6><p>resize() æ–¹æ³•ç”¨äº<strong>åˆå§‹åŒ–æ•°ç»„æˆ–æ•°ç»„æ‰©å®¹</strong>ï¼Œæ¯æ¬¡æ‰©å®¹åï¼Œå®¹é‡ä¸ºåŸæ¥çš„ 2 å€ï¼Œå¹¶è¿›è¡Œæ•°æ®è¿ç§»ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">final Node&lt;K,V&gt;[] resize() &#123;\n    Node&lt;K,V&gt;[] oldTab &#x3D; table;\n    int oldCap &#x3D; (oldTab &#x3D;&#x3D; null) ? 0 : oldTab.length;\n    int oldThr &#x3D; threshold;\n    int newCap, newThr &#x3D; 0;\n    if (oldCap &gt; 0) &#123; &#x2F;&#x2F; å¯¹åº”æ•°ç»„æ‰©å®¹\n        if (oldCap &gt;&#x3D; MAXIMUM_CAPACITY) &#123;\n            threshold &#x3D; Integer.MAX_VALUE;\n            return oldTab;\n        &#125;\n        &#x2F;&#x2F; å°†æ•°ç»„å¤§å°æ‰©å¤§ä¸€å€\n        else if ((newCap &#x3D; oldCap &lt;&lt; 1) &lt; MAXIMUM_CAPACITY &amp;&amp;\n                 oldCap &gt;&#x3D; DEFAULT_INITIAL_CAPACITY)\n            &#x2F;&#x2F; å°†é˜ˆå€¼æ‰©å¤§ä¸€å€\n            newThr &#x3D; oldThr &lt;&lt; 1; &#x2F;&#x2F; double threshold\n    &#125;\n    else if (oldThr &gt; 0) &#x2F;&#x2F; å¯¹åº”ä½¿ç”¨ new HashMap(int initialCapacity) åˆå§‹åŒ–åï¼Œç¬¬ä¸€æ¬¡ put çš„æ—¶å€™\n        newCap &#x3D; oldThr;\n    else &#123;&#x2F;&#x2F; å¯¹åº”ä½¿ç”¨ new HashMap() åˆå§‹åŒ–åï¼Œç¬¬ä¸€æ¬¡ put çš„æ—¶å€™\n        newCap &#x3D; DEFAULT_INITIAL_CAPACITY;\n        newThr &#x3D; (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);\n    &#125;\n \n    if (newThr &#x3D;&#x3D; 0) &#123;\n        float ft &#x3D; (float)newCap * loadFactor;\n        newThr &#x3D; (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (float)MAXIMUM_CAPACITY ?\n                  (int)ft : Integer.MAX_VALUE);\n    &#125;\n    threshold &#x3D; newThr;\n \n    &#x2F;&#x2F; ç”¨æ–°çš„æ•°ç»„å¤§å°åˆå§‹åŒ–æ–°çš„æ•°ç»„\n    Node&lt;K,V&gt;[] newTab &#x3D; (Node&lt;K,V&gt;[])new Node[newCap];\n    table &#x3D; newTab; &#x2F;&#x2F; å¦‚æœæ˜¯åˆå§‹åŒ–æ•°ç»„ï¼Œåˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œè¿”å› newTab å³å¯\n \n    if (oldTab !&#x3D; null) &#123;\n        &#x2F;&#x2F; å¼€å§‹éå†åŸæ•°ç»„ï¼Œè¿›è¡Œæ•°æ®è¿ç§»ã€‚\n        for (int j &#x3D; 0; j &lt; oldCap; ++j) &#123;\n            Node&lt;K,V&gt; e;\n            if ((e &#x3D; oldTab[j]) !&#x3D; null) &#123;\n                oldTab[j] &#x3D; null;\n                &#x2F;&#x2F; å¦‚æœè¯¥æ•°ç»„ä½ç½®ä¸Šåªæœ‰å•ä¸ªå…ƒç´ ï¼Œé‚£å°±ç®€å•äº†ï¼Œç®€å•è¿ç§»è¿™ä¸ªå…ƒç´ å°±å¯ä»¥äº†\n                if (e.next &#x3D;&#x3D; null)\n                    newTab[e.hash &amp; (newCap - 1)] &#x3D; e;\n                &#x2F;&#x2F; å¦‚æœæ˜¯çº¢é»‘æ ‘ï¼Œå…·ä½“æˆ‘ä»¬å°±ä¸å±•å¼€äº†\n                else if (e instanceof TreeNode)\n                    ((TreeNode&lt;K,V&gt;)e).split(this, newTab, j, oldCap);\n                else &#123; \n                    &#x2F;&#x2F; è¿™å—æ˜¯å¤„ç†é“¾è¡¨çš„æƒ…å†µï¼Œ\n                    &#x2F;&#x2F; éœ€è¦å°†æ­¤é“¾è¡¨æ‹†æˆä¸¤ä¸ªé“¾è¡¨ï¼Œæ”¾åˆ°æ–°çš„æ•°ç»„ä¸­ï¼Œå¹¶ä¸”ä¿ç•™åŸæ¥çš„å…ˆåé¡ºåº\n                    &#x2F;&#x2F; loHeadã€loTail å¯¹åº”ä¸€æ¡é“¾è¡¨ï¼ŒhiHeadã€hiTail å¯¹åº”å¦ä¸€æ¡é“¾è¡¨ï¼Œä»£ç è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„\n                    Node&lt;K,V&gt; loHead &#x3D; null, loTail &#x3D; null;\n                    Node&lt;K,V&gt; hiHead &#x3D; null, hiTail &#x3D; null;\n                    Node&lt;K,V&gt; next;\n                    do &#123;\n                        next &#x3D; e.next;\n                        if ((e.hash &amp; oldCap) &#x3D;&#x3D; 0) &#123;\n                            if (loTail &#x3D;&#x3D; null)\n                                loHead &#x3D; e;\n                            else\n                                loTail.next &#x3D; e;\n                            loTail &#x3D; e;\n                        &#125;\n                        else &#123;\n                            if (hiTail &#x3D;&#x3D; null)\n                                hiHead &#x3D; e;\n                            else\n                                hiTail.next &#x3D; e;\n                            hiTail &#x3D; e;\n                        &#125;\n                    &#125; while ((e &#x3D; next) !&#x3D; null);\n                    if (loTail !&#x3D; null) &#123;\n                        loTail.next &#x3D; null;\n                        &#x2F;&#x2F; ç¬¬ä¸€æ¡é“¾è¡¨\n                        newTab[j] &#x3D; loHead;\n                    &#125;\n                    if (hiTail !&#x3D; null) &#123;\n                        hiTail.next &#x3D; null;\n                        &#x2F;&#x2F; ç¬¬äºŒæ¡é“¾è¡¨çš„æ–°çš„ä½ç½®æ˜¯ j + oldCapï¼Œè¿™ä¸ªå¾ˆå¥½ç†è§£\n                        newTab[j + oldCap] &#x3D; hiHead;\n                    &#125;\n                &#125;\n            &#125;\n        &#125;\n    &#125;\n    return newTab;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"get-è¿‡ç¨‹åˆ†æ-2\"><a href=\"#get-è¿‡ç¨‹åˆ†æ-2\" class=\"headerlink\" title=\"get è¿‡ç¨‹åˆ†æ\"></a>get è¿‡ç¨‹åˆ†æ</h4><p>ç›¸å¯¹äº put æ¥è¯´ï¼Œget çœŸçš„å¤ªç®€å•äº†ã€‚</p>\n<ol>\n<li>è®¡ç®— key çš„ hash å€¼ï¼Œæ ¹æ® hash å€¼æ‰¾åˆ°å¯¹åº”æ•°ç»„ä¸‹æ ‡: hash &amp; (length-1)</li>\n<li>åˆ¤æ–­æ•°ç»„è¯¥ä½ç½®å¤„çš„å…ƒç´ æ˜¯å¦åˆšå¥½å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„ï¼Œå¦‚æœä¸æ˜¯ï¼Œèµ°ç¬¬ä¸‰æ­¥</li>\n<li>åˆ¤æ–­è¯¥å…ƒç´ ç±»å‹æ˜¯å¦æ˜¯ TreeNodeï¼Œå¦‚æœæ˜¯ï¼Œç”¨çº¢é»‘æ ‘çš„æ–¹æ³•å–æ•°æ®ï¼Œå¦‚æœä¸æ˜¯ï¼Œèµ°ç¬¬å››æ­¥</li>\n<li>éå†é“¾è¡¨ï¼Œç›´åˆ°æ‰¾åˆ°ç›¸ç­‰(&#x3D;&#x3D;æˆ–equals)çš„ key.</li>\n</ol>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public V get(Object key) &#123;\n    Node&lt;K,V&gt; e;\n    return (e &#x3D; getNode(hash(key), key)) &#x3D;&#x3D; null ? null : e.value;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">final Node&lt;K,V&gt; getNode(int hash, Object key) &#123;\n    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first, e; int n; K k;\n    if ((tab &#x3D; table) !&#x3D; null &amp;&amp; (n &#x3D; tab.length) &gt; 0 &amp;&amp;\n        (first &#x3D; tab[(n - 1) &amp; hash]) !&#x3D; null) &#123;\n        &#x2F;&#x2F; åˆ¤æ–­ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æ˜¯ä¸æ˜¯å°±æ˜¯éœ€è¦çš„\n        if (first.hash &#x3D;&#x3D; hash &amp;&amp; &#x2F;&#x2F; always check first node\n            ((k &#x3D; first.key) &#x3D;&#x3D; key || (key !&#x3D; null &amp;&amp; key.equals(k))))\n            return first;\n        if ((e &#x3D; first.next) !&#x3D; null) &#123;\n            &#x2F;&#x2F; åˆ¤æ–­æ˜¯å¦æ˜¯çº¢é»‘æ ‘\n            if (first instanceof TreeNode)\n                return ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);\n \n            &#x2F;&#x2F; é“¾è¡¨éå†\n            do &#123;\n                if (e.hash &#x3D;&#x3D; hash &amp;&amp;\n                    ((k &#x3D; e.key) &#x3D;&#x3D; key || (key !&#x3D; null &amp;&amp; key.equals(k))))\n                    return e;\n            &#125; while ((e &#x3D; e.next) !&#x3D; null);\n        &#125;\n    &#125;\n    return null;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"Java8-ConcurrentHashMap\"><a href=\"#Java8-ConcurrentHashMap\" class=\"headerlink\" title=\"Java8 ConcurrentHashMap\"></a>Java8 ConcurrentHashMap</h2><p>Java7 ä¸­å®ç°çš„ ConcurrentHashMap è¯´å®è¯è¿˜æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼ŒJava8 å¯¹ ConcurrentHashMap è¿›è¡Œäº†æ¯”è¾ƒå¤§çš„æ”¹åŠ¨ã€‚å»ºè®®è¯»è€…å¯ä»¥å‚è€ƒ Java8 ä¸­ HashMap ç›¸å¯¹äº Java7 HashMap çš„æ”¹åŠ¨ï¼Œå¯¹äº ConcurrentHashMapï¼ŒJava8 ä¹Ÿå¼•å…¥äº†çº¢é»‘æ ‘ã€‚</p>\n<p>è¯´å®è¯ï¼ŒJava8 ConcurrentHashMap æºç çœŸå¿ƒä¸ç®€å•ï¼Œæœ€éš¾çš„åœ¨äºæ‰©å®¹ï¼Œæ•°æ®è¿ç§»æ“ä½œä¸å®¹æ˜“çœ‹æ‡‚ã€‚</p>\n<p>æˆ‘ä»¬å…ˆç”¨ä¸€ä¸ªç¤ºæ„å›¾æ¥æè¿°ä¸‹å…¶ç»“æ„ï¼š</p>\n<p><img src=\"http://qianniu.javastack.cn/18-12-4/335817.jpg\"></p>\n<p>ç»“æ„ä¸Šå’Œ Java8 çš„ HashMap åŸºæœ¬ä¸Šä¸€æ ·ï¼Œä¸è¿‡å®ƒè¦ä¿è¯çº¿ç¨‹å®‰å…¨æ€§ï¼Œæ‰€ä»¥åœ¨æºç ä¸Šç¡®å®è¦å¤æ‚ä¸€äº›ã€‚æ¨èé˜…è¯»ï¼š<a href=\"https://mp.weixin.qq.com/s/5Y5_6qn2g6kIVmQia_0R6g\">å‡ ç§çº¿ç¨‹å®‰å…¨çš„Mapè§£æ</a>ã€‚</p>\n<h4 id=\"åˆå§‹åŒ–-1\"><a href=\"#åˆå§‹åŒ–-1\" class=\"headerlink\" title=\"åˆå§‹åŒ–\"></a>åˆå§‹åŒ–</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; è¿™æ„é€ å‡½æ•°é‡Œï¼Œä»€ä¹ˆéƒ½ä¸å¹²\npublic ConcurrentHashMap() &#123;\n&#125;\npublic ConcurrentHashMap(int initialCapacity) &#123;\n    if (initialCapacity &lt; 0)\n        throw new IllegalArgumentException();\n    int cap &#x3D; ((initialCapacity &gt;&#x3D; (MAXIMUM_CAPACITY &gt;&gt;&gt; 1)) ?\n               MAXIMUM_CAPACITY :\n               tableSizeFor(initialCapacity + (initialCapacity &gt;&gt;&gt; 1) + 1));\n    this.sizeCtl &#x3D; cap;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªåˆå§‹åŒ–æ–¹æ³•æœ‰ç‚¹æ„æ€ï¼Œé€šè¿‡æä¾›åˆå§‹å®¹é‡ï¼Œè®¡ç®—äº† sizeCtlï¼ŒsizeCtl &#x3D; ã€ (1.5 * initialCapacity + 1)ï¼Œç„¶åå‘ä¸Šå–æœ€è¿‘çš„ 2 çš„ n æ¬¡æ–¹ã€‘ã€‚å¦‚ initialCapacity ä¸º 10ï¼Œé‚£ä¹ˆå¾—åˆ° sizeCtl ä¸º 16ï¼Œå¦‚æœ initialCapacity ä¸º 11ï¼Œå¾—åˆ° sizeCtl ä¸º 32ã€‚</p>\n<p>sizeCtl è¿™ä¸ªå±æ€§ä½¿ç”¨çš„åœºæ™¯å¾ˆå¤šï¼Œä¸è¿‡åªè¦è·Ÿç€æ–‡ç« çš„æ€è·¯æ¥ï¼Œå°±ä¸ä¼šè¢«å®ƒææ™•äº†ã€‚</p>\n<p>å¦‚æœä½ çˆ±æŠ˜è…¾ï¼Œä¹Ÿå¯ä»¥çœ‹ä¸‹å¦ä¸€ä¸ªæœ‰ä¸‰ä¸ªå‚æ•°çš„æ„é€ æ–¹æ³•ï¼Œè¿™é‡Œæˆ‘å°±ä¸è¯´äº†ï¼Œå¤§éƒ¨åˆ†æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨æ— å‚æ„é€ å‡½æ•°è¿›è¡Œå®ä¾‹åŒ–ï¼Œæˆ‘ä»¬ä¹ŸæŒ‰ç…§è¿™ä¸ªæ€è·¯æ¥è¿›è¡Œæºç åˆ†æå§ã€‚</p>\n<h4 id=\"put-è¿‡ç¨‹åˆ†æ-3\"><a href=\"#put-è¿‡ç¨‹åˆ†æ-3\" class=\"headerlink\" title=\"put è¿‡ç¨‹åˆ†æ\"></a>put è¿‡ç¨‹åˆ†æ</h4><p>ä»”ç»†åœ°ä¸€è¡Œä¸€è¡Œä»£ç çœ‹ä¸‹å»ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public V put(K key, V value) &#123;\n    return putVal(key, value, false);\n&#125;\nfinal V putVal(K key, V value, boolean onlyIfAbsent) &#123;\n    if (key &#x3D;&#x3D; null || value &#x3D;&#x3D; null) throw new NullPointerException();\n    &#x2F;&#x2F; å¾—åˆ° hash å€¼\n    int hash &#x3D; spread(key.hashCode());\n    &#x2F;&#x2F; ç”¨äºè®°å½•ç›¸åº”é“¾è¡¨çš„é•¿åº¦\n    int binCount &#x3D; 0;\n    for (Node&lt;K,V&gt;[] tab &#x3D; table;;) &#123;\n        Node&lt;K,V&gt; f; int n, i, fh;\n        &#x2F;&#x2F; å¦‚æœæ•°ç»„&quot;ç©º&quot;ï¼Œè¿›è¡Œæ•°ç»„åˆå§‹åŒ–\n        if (tab &#x3D;&#x3D; null || (n &#x3D; tab.length) &#x3D;&#x3D; 0)\n            &#x2F;&#x2F; åˆå§‹åŒ–æ•°ç»„ï¼Œåé¢ä¼šè¯¦ç»†ä»‹ç»\n            tab &#x3D; initTable();\n \n        &#x2F;&#x2F; æ‰¾è¯¥ hash å€¼å¯¹åº”çš„æ•°ç»„ä¸‹æ ‡ï¼Œå¾—åˆ°ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ f\n        else if ((f &#x3D; tabAt(tab, i &#x3D; (n - 1) &amp; hash)) &#x3D;&#x3D; null) &#123;\n            &#x2F;&#x2F; å¦‚æœæ•°ç»„è¯¥ä½ç½®ä¸ºç©ºï¼Œ\n            &#x2F;&#x2F;    ç”¨ä¸€æ¬¡ CAS æ“ä½œå°†è¿™ä¸ªæ–°å€¼æ”¾å…¥å…¶ä¸­å³å¯ï¼Œè¿™ä¸ª put æ“ä½œå·®ä¸å¤šå°±ç»“æŸäº†ï¼Œå¯ä»¥æ‹‰åˆ°æœ€åé¢äº†\n            &#x2F;&#x2F;          å¦‚æœ CAS å¤±è´¥ï¼Œé‚£å°±æ˜¯æœ‰å¹¶å‘æ“ä½œï¼Œè¿›åˆ°ä¸‹ä¸€ä¸ªå¾ªç¯å°±å¥½äº†\n            if (casTabAt(tab, i, null,\n                         new Node&lt;K,V&gt;(hash, key, value, null)))\n                break;                   &#x2F;&#x2F; no lock when adding to empty bin\n        &#125;\n        &#x2F;&#x2F; hash å±…ç„¶å¯ä»¥ç­‰äº MOVEDï¼Œè¿™ä¸ªéœ€è¦åˆ°åé¢æ‰èƒ½çœ‹æ˜ç™½ï¼Œä¸è¿‡ä»åå­—ä¸Šä¹Ÿèƒ½çŒœåˆ°ï¼Œè‚¯å®šæ˜¯å› ä¸ºåœ¨æ‰©å®¹\n        else if ((fh &#x3D; f.hash) &#x3D;&#x3D; MOVED)\n            &#x2F;&#x2F; å¸®åŠ©æ•°æ®è¿ç§»ï¼Œè¿™ä¸ªç­‰åˆ°çœ‹å®Œæ•°æ®è¿ç§»éƒ¨åˆ†çš„ä»‹ç»åï¼Œå†ç†è§£è¿™ä¸ªå°±å¾ˆç®€å•äº†\n            tab &#x3D; helpTransfer(tab, f);\n \n        else &#123; &#x2F;&#x2F; åˆ°è¿™é‡Œå°±æ˜¯è¯´ï¼Œf æ˜¯è¯¥ä½ç½®çš„å¤´ç»“ç‚¹ï¼Œè€Œä¸”ä¸ä¸ºç©º\n \n            V oldVal &#x3D; null;\n            &#x2F;&#x2F; è·å–æ•°ç»„è¯¥ä½ç½®çš„å¤´ç»“ç‚¹çš„ç›‘è§†å™¨é”\n            synchronized (f) &#123;\n                if (tabAt(tab, i) &#x3D;&#x3D; f) &#123;\n                    if (fh &gt;&#x3D; 0) &#123; &#x2F;&#x2F; å¤´ç»“ç‚¹çš„ hash å€¼å¤§äº 0ï¼Œè¯´æ˜æ˜¯é“¾è¡¨\n                        &#x2F;&#x2F; ç”¨äºç´¯åŠ ï¼Œè®°å½•é“¾è¡¨çš„é•¿åº¦\n                        binCount &#x3D; 1;\n                        &#x2F;&#x2F; éå†é“¾è¡¨\n                        for (Node&lt;K,V&gt; e &#x3D; f;; ++binCount) &#123;\n                            K ek;\n                            &#x2F;&#x2F; å¦‚æœå‘ç°äº†&quot;ç›¸ç­‰&quot;çš„ keyï¼Œåˆ¤æ–­æ˜¯å¦è¦è¿›è¡Œå€¼è¦†ç›–ï¼Œç„¶åä¹Ÿå°±å¯ä»¥ break äº†\n                            if (e.hash &#x3D;&#x3D; hash &amp;&amp;\n                                ((ek &#x3D; e.key) &#x3D;&#x3D; key ||\n                                 (ek !&#x3D; null &amp;&amp; key.equals(ek)))) &#123;\n                                oldVal &#x3D; e.val;\n                                if (!onlyIfAbsent)\n                                    e.val &#x3D; value;\n                                break;\n                            &#125;\n                            &#x2F;&#x2F; åˆ°äº†é“¾è¡¨çš„æœ€æœ«ç«¯ï¼Œå°†è¿™ä¸ªæ–°å€¼æ”¾åˆ°é“¾è¡¨çš„æœ€åé¢\n                            Node&lt;K,V&gt; pred &#x3D; e;\n                            if ((e &#x3D; e.next) &#x3D;&#x3D; null) &#123;\n                                pred.next &#x3D; new Node&lt;K,V&gt;(hash, key,\n                                                          value, null);\n                                break;\n                            &#125;\n                        &#125;\n                    &#125;\n                    else if (f instanceof TreeBin) &#123; &#x2F;&#x2F; çº¢é»‘æ ‘\n                        Node&lt;K,V&gt; p;\n                        binCount &#x3D; 2;\n                        &#x2F;&#x2F; è°ƒç”¨çº¢é»‘æ ‘çš„æ’å€¼æ–¹æ³•æ’å…¥æ–°èŠ‚ç‚¹\n                        if ((p &#x3D; ((TreeBin&lt;K,V&gt;)f).putTreeVal(hash, key,\n                                                       value)) !&#x3D; null) &#123;\n                            oldVal &#x3D; p.val;\n                            if (!onlyIfAbsent)\n                                p.val &#x3D; value;\n                        &#125;\n                    &#125;\n                &#125;\n            &#125;\n            &#x2F;&#x2F; binCount !&#x3D; 0 è¯´æ˜ä¸Šé¢åœ¨åšé“¾è¡¨æ“ä½œ\n            if (binCount !&#x3D; 0) &#123;\n                &#x2F;&#x2F; åˆ¤æ–­æ˜¯å¦è¦å°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œä¸´ç•Œå€¼å’Œ HashMap ä¸€æ ·ï¼Œä¹Ÿæ˜¯ 8\n                if (binCount &gt;&#x3D; TREEIFY_THRESHOLD)\n                    &#x2F;&#x2F; è¿™ä¸ªæ–¹æ³•å’Œ HashMap ä¸­ç¨å¾®æœ‰ä¸€ç‚¹ç‚¹ä¸åŒï¼Œé‚£å°±æ˜¯å®ƒä¸æ˜¯ä¸€å®šä¼šè¿›è¡Œçº¢é»‘æ ‘è½¬æ¢ï¼Œ\n                    &#x2F;&#x2F; å¦‚æœå½“å‰æ•°ç»„çš„é•¿åº¦å°äº 64ï¼Œé‚£ä¹ˆä¼šé€‰æ‹©è¿›è¡Œæ•°ç»„æ‰©å®¹ï¼Œè€Œä¸æ˜¯è½¬æ¢ä¸ºçº¢é»‘æ ‘\n                    &#x2F;&#x2F;    å…·ä½“æºç æˆ‘ä»¬å°±ä¸çœ‹äº†ï¼Œæ‰©å®¹éƒ¨åˆ†åé¢è¯´\n                    treeifyBin(tab, i);\n                if (oldVal !&#x3D; null)\n                    return oldVal;\n                break;\n            &#125;\n        &#125;\n    &#125;\n    &#x2F;&#x2F; \n    addCount(1L, binCount);\n    return null;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>put çš„ä¸»æµç¨‹çœ‹å®Œäº†ï¼Œä½†æ˜¯è‡³å°‘ç•™ä¸‹äº†å‡ ä¸ªé—®é¢˜ï¼Œç¬¬ä¸€ä¸ªæ˜¯åˆå§‹åŒ–ï¼Œç¬¬äºŒä¸ªæ˜¯æ‰©å®¹ï¼Œç¬¬ä¸‰ä¸ªæ˜¯å¸®åŠ©æ•°æ®è¿ç§»ï¼Œè¿™äº›æˆ‘ä»¬éƒ½ä¼šåœ¨åé¢è¿›è¡Œä¸€ä¸€ä»‹ç»ã€‚</p>\n<h6 id=\"åˆå§‹åŒ–æ•°ç»„ï¼šinitTable\"><a href=\"#åˆå§‹åŒ–æ•°ç»„ï¼šinitTable\" class=\"headerlink\" title=\"åˆå§‹åŒ–æ•°ç»„ï¼šinitTable\"></a>åˆå§‹åŒ–æ•°ç»„ï¼šinitTable</h6><p>è¿™ä¸ªæ¯”è¾ƒç®€å•ï¼Œä¸»è¦å°±æ˜¯åˆå§‹åŒ–ä¸€ä¸ªåˆé€‚å¤§å°çš„æ•°ç»„ï¼Œç„¶åä¼šè®¾ç½® sizeCtlã€‚</p>\n<p>åˆå§‹åŒ–æ–¹æ³•ä¸­çš„å¹¶å‘é—®é¢˜æ˜¯é€šè¿‡å¯¹ sizeCtl è¿›è¡Œä¸€ä¸ª CAS æ“ä½œæ¥æ§åˆ¶çš„ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private final Node&lt;K,V&gt;[] initTable() &#123;\n    Node&lt;K,V&gt;[] tab; int sc;\n    while ((tab &#x3D; table) &#x3D;&#x3D; null || tab.length &#x3D;&#x3D; 0) &#123;\n        &#x2F;&#x2F; åˆå§‹åŒ–çš„&quot;åŠŸåŠ³&quot;è¢«å…¶ä»–çº¿ç¨‹&quot;æŠ¢å»&quot;äº†\n        if ((sc &#x3D; sizeCtl) &lt; 0)\n            Thread.yield(); &#x2F;&#x2F; lost initialization race; just spin\n        &#x2F;&#x2F; CAS ä¸€ä¸‹ï¼Œå°† sizeCtl è®¾ç½®ä¸º -1ï¼Œä»£è¡¨æŠ¢åˆ°äº†é”\n        else if (U.compareAndSwapInt(this, SIZECTL, sc, -1)) &#123;\n            try &#123;\n                if ((tab &#x3D; table) &#x3D;&#x3D; null || tab.length &#x3D;&#x3D; 0) &#123;\n                    &#x2F;&#x2F; DEFAULT_CAPACITY é»˜è®¤åˆå§‹å®¹é‡æ˜¯ 16\n                    int n &#x3D; (sc &gt; 0) ? sc : DEFAULT_CAPACITY;\n                    &#x2F;&#x2F; åˆå§‹åŒ–æ•°ç»„ï¼Œé•¿åº¦ä¸º 16 æˆ–åˆå§‹åŒ–æ—¶æä¾›çš„é•¿åº¦\n                    Node&lt;K,V&gt;[] nt &#x3D; (Node&lt;K,V&gt;[])new Node&lt;?,?&gt;[n];\n                    &#x2F;&#x2F; å°†è¿™ä¸ªæ•°ç»„èµ‹å€¼ç»™ tableï¼Œtable æ˜¯ volatile çš„\n                    table &#x3D; tab &#x3D; nt;\n                    &#x2F;&#x2F; å¦‚æœ n ä¸º 16 çš„è¯ï¼Œé‚£ä¹ˆè¿™é‡Œ sc &#x3D; 12\n                    &#x2F;&#x2F; å…¶å®å°±æ˜¯ 0.75 * n\n                    sc &#x3D; n - (n &gt;&gt;&gt; 2);\n                &#125;\n            &#125; finally &#123;\n                &#x2F;&#x2F; è®¾ç½® sizeCtl ä¸º scï¼Œæˆ‘ä»¬å°±å½“æ˜¯ 12 å§\n                sizeCtl &#x3D; sc;\n            &#125;\n            break;\n        &#125;\n    &#125;\n    return tab;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h6 id=\"é“¾è¡¨è½¬çº¢é»‘æ ‘-treeifyBin\"><a href=\"#é“¾è¡¨è½¬çº¢é»‘æ ‘-treeifyBin\" class=\"headerlink\" title=\"é“¾è¡¨è½¬çº¢é»‘æ ‘: treeifyBin\"></a>é“¾è¡¨è½¬çº¢é»‘æ ‘: treeifyBin</h6><p>å‰é¢æˆ‘ä»¬åœ¨ put æºç åˆ†æä¹Ÿè¯´è¿‡ï¼ŒtreeifyBin ä¸ä¸€å®šå°±ä¼šè¿›è¡Œçº¢é»‘æ ‘è½¬æ¢ï¼Œä¹Ÿå¯èƒ½æ˜¯ä»…ä»…åšæ•°ç»„æ‰©å®¹ã€‚æˆ‘ä»¬è¿˜æ˜¯è¿›è¡Œæºç åˆ†æå§ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private final void treeifyBin(Node&lt;K,V&gt;[] tab, int index) &#123;\n    Node&lt;K,V&gt; b; int n, sc;\n    if (tab !&#x3D; null) &#123;\n        &#x2F;&#x2F; MIN_TREEIFY_CAPACITY ä¸º 64\n        &#x2F;&#x2F; æ‰€ä»¥ï¼Œå¦‚æœæ•°ç»„é•¿åº¦å°äº 64 çš„æ—¶å€™ï¼Œå…¶å®ä¹Ÿå°±æ˜¯ 32 æˆ–è€… 16 æˆ–è€…æ›´å°çš„æ—¶å€™ï¼Œä¼šè¿›è¡Œæ•°ç»„æ‰©å®¹\n        if ((n &#x3D; tab.length) &lt; MIN_TREEIFY_CAPACITY)\n            &#x2F;&#x2F; åé¢æˆ‘ä»¬å†è¯¦ç»†åˆ†æè¿™ä¸ªæ–¹æ³•\n            tryPresize(n &lt;&lt; 1);\n        &#x2F;&#x2F; b æ˜¯å¤´ç»“ç‚¹\n        else if ((b &#x3D; tabAt(tab, index)) !&#x3D; null &amp;&amp; b.hash &gt;&#x3D; 0) &#123;\n            &#x2F;&#x2F; åŠ é”\n            synchronized (b) &#123;\n \n                if (tabAt(tab, index) &#x3D;&#x3D; b) &#123;\n                    &#x2F;&#x2F; ä¸‹é¢å°±æ˜¯éå†é“¾è¡¨ï¼Œå»ºç«‹ä¸€é¢—çº¢é»‘æ ‘\n                    TreeNode&lt;K,V&gt; hd &#x3D; null, tl &#x3D; null;\n                    for (Node&lt;K,V&gt; e &#x3D; b; e !&#x3D; null; e &#x3D; e.next) &#123;\n                        TreeNode&lt;K,V&gt; p &#x3D;\n                            new TreeNode&lt;K,V&gt;(e.hash, e.key, e.val,\n                                              null, null);\n                        if ((p.prev &#x3D; tl) &#x3D;&#x3D; null)\n                            hd &#x3D; p;\n                        else\n                            tl.next &#x3D; p;\n                        tl &#x3D; p;\n                    &#125;\n                    &#x2F;&#x2F; å°†çº¢é»‘æ ‘è®¾ç½®åˆ°æ•°ç»„ç›¸åº”ä½ç½®ä¸­\n                    setTabAt(tab, index, new TreeBin&lt;K,V&gt;(hd));\n                &#125;\n            &#125;\n        &#125;\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n<h4 id=\"æ‰©å®¹ï¼štryPresize\"><a href=\"#æ‰©å®¹ï¼štryPresize\" class=\"headerlink\" title=\"æ‰©å®¹ï¼štryPresize\"></a>æ‰©å®¹ï¼štryPresize</h4><p>å¦‚æœè¯´ Java8 ConcurrentHashMap çš„æºç ä¸ç®€å•ï¼Œé‚£ä¹ˆè¯´çš„å°±æ˜¯æ‰©å®¹æ“ä½œå’Œè¿ç§»æ“ä½œã€‚</p>\n<p>è¿™ä¸ªæ–¹æ³•è¦å®Œå®Œå…¨å…¨çœ‹æ‡‚è¿˜éœ€è¦çœ‹ä¹‹åçš„ transfer æ–¹æ³•ï¼Œè¯»è€…åº”è¯¥æå‰çŸ¥é“è¿™ç‚¹ã€‚</p>\n<p>è¿™é‡Œçš„æ‰©å®¹ä¹Ÿæ˜¯åšç¿»å€æ‰©å®¹çš„ï¼Œæ‰©å®¹åæ•°ç»„å®¹é‡ä¸ºåŸæ¥çš„ 2 å€ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; é¦–å…ˆè¦è¯´æ˜çš„æ˜¯ï¼Œæ–¹æ³•å‚æ•° size ä¼ è¿›æ¥çš„æ—¶å€™å°±å·²ç»ç¿»äº†å€äº†\nprivate final void tryPresize(int size) &#123;\n    &#x2F;&#x2F; cï¼šsize çš„ 1.5 å€ï¼Œå†åŠ  1ï¼Œå†å¾€ä¸Šå–æœ€è¿‘çš„ 2 çš„ n æ¬¡æ–¹ã€‚\n    int c &#x3D; (size &gt;&#x3D; (MAXIMUM_CAPACITY &gt;&gt;&gt; 1)) ? MAXIMUM_CAPACITY :\n        tableSizeFor(size + (size &gt;&gt;&gt; 1) + 1);\n    int sc;\n    while ((sc &#x3D; sizeCtl) &gt;&#x3D; 0) &#123;\n        Node&lt;K,V&gt;[] tab &#x3D; table; int n;\n \n        &#x2F;&#x2F; è¿™ä¸ª if åˆ†æ”¯å’Œä¹‹å‰è¯´çš„åˆå§‹åŒ–æ•°ç»„çš„ä»£ç åŸºæœ¬ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥ä¸ç”¨ç®¡è¿™å—ä»£ç \n        if (tab &#x3D;&#x3D; null || (n &#x3D; tab.length) &#x3D;&#x3D; 0) &#123;\n            n &#x3D; (sc &gt; c) ? sc : c;\n            if (U.compareAndSwapInt(this, SIZECTL, sc, -1)) &#123;\n                try &#123;\n                    if (table &#x3D;&#x3D; tab) &#123;\n                        @SuppressWarnings(&quot;unchecked&quot;)\n                        Node&lt;K,V&gt;[] nt &#x3D; (Node&lt;K,V&gt;[])new Node&lt;?,?&gt;[n];\n                        table &#x3D; nt;\n                        sc &#x3D; n - (n &gt;&gt;&gt; 2); &#x2F;&#x2F; 0.75 * n\n                    &#125;\n                &#125; finally &#123;\n                    sizeCtl &#x3D; sc;\n                &#125;\n            &#125;\n        &#125;\n        else if (c &lt;&#x3D; sc || n &gt;&#x3D; MAXIMUM_CAPACITY)\n            break;\n        else if (tab &#x3D;&#x3D; table) &#123;\n            &#x2F;&#x2F; æˆ‘æ²¡çœ‹æ‡‚ rs çš„çœŸæ­£å«ä¹‰æ˜¯ä»€ä¹ˆï¼Œä¸è¿‡ä¹Ÿå…³ç³»ä¸å¤§\n            int rs &#x3D; resizeStamp(n);\n \n            if (sc &lt; 0) &#123;\n                Node&lt;K,V&gt;[] nt;\n                if ((sc &gt;&gt;&gt; RESIZE_STAMP_SHIFT) !&#x3D; rs || sc &#x3D;&#x3D; rs + 1 ||\n                    sc &#x3D;&#x3D; rs + MAX_RESIZERS || (nt &#x3D; nextTable) &#x3D;&#x3D; null ||\n                    transferIndex &lt;&#x3D; 0)\n                    break;\n                &#x2F;&#x2F; 2. ç”¨ CAS å°† sizeCtl åŠ  1ï¼Œç„¶åæ‰§è¡Œ transfer æ–¹æ³•\n                &#x2F;&#x2F;    æ­¤æ—¶ nextTab ä¸ä¸º null\n                if (U.compareAndSwapInt(this, SIZECTL, sc, sc + 1))\n                    transfer(tab, nt);\n            &#125;\n            &#x2F;&#x2F; 1. å°† sizeCtl è®¾ç½®ä¸º (rs &lt;&lt; RESIZE_STAMP_SHIFT) + 2)\n            &#x2F;&#x2F;     æˆ‘æ˜¯æ²¡çœ‹æ‡‚è¿™ä¸ªå€¼çœŸæ­£çš„æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿä¸è¿‡å¯ä»¥è®¡ç®—å‡ºæ¥çš„æ˜¯ï¼Œç»“æœæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤§çš„è´Ÿæ•°\n            &#x2F;&#x2F;  è°ƒç”¨ transfer æ–¹æ³•ï¼Œæ­¤æ—¶ nextTab å‚æ•°ä¸º null\n            else if (U.compareAndSwapInt(this, SIZECTL, sc,\n                                         (rs &lt;&lt; RESIZE_STAMP_SHIFT) + 2))\n                transfer(tab, null);\n        &#125;\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªæ–¹æ³•çš„æ ¸å¿ƒåœ¨äº sizeCtl å€¼çš„æ“ä½œï¼Œé¦–å…ˆå°†å…¶è®¾ç½®ä¸ºä¸€ä¸ªè´Ÿæ•°ï¼Œç„¶åæ‰§è¡Œ transfer(tab, null)ï¼Œå†ä¸‹ä¸€ä¸ªå¾ªç¯å°† sizeCtl åŠ  1ï¼Œå¹¶æ‰§è¡Œ transfer(tab, nt)ï¼Œä¹‹åå¯èƒ½æ˜¯ç»§ç»­ sizeCtl åŠ  1ï¼Œå¹¶æ‰§è¡Œ transfer(tab, nt)ã€‚</p>\n<p>æ‰€ä»¥ï¼Œå¯èƒ½çš„æ“ä½œå°±æ˜¯æ‰§è¡Œ **1 æ¬¡ transfer(tab, null) + å¤šæ¬¡ transfer(tab, nt)**ï¼Œè¿™é‡Œæ€ä¹ˆç»“æŸå¾ªç¯çš„éœ€è¦çœ‹å®Œ transfer æºç æ‰æ¸…æ¥šã€‚æ¨èé˜…è¯»ï¼š<a href=\"https://mp.weixin.qq.com/s/Q5F604CUM_0x2co9mvADxw\">30 ä¸ª Java é›†åˆé¢è¯•é—®é¢˜åŠç­”æ¡ˆ</a>ã€‚</p>\n<h6 id=\"æ•°æ®è¿ç§»ï¼štransfer\"><a href=\"#æ•°æ®è¿ç§»ï¼štransfer\" class=\"headerlink\" title=\"æ•°æ®è¿ç§»ï¼štransfer\"></a>æ•°æ®è¿ç§»ï¼štransfer</h6><p>ä¸‹é¢è¿™ä¸ªæ–¹æ³•å¾ˆç‚¹é•¿ï¼Œå°†åŸæ¥çš„ tab æ•°ç»„çš„å…ƒç´ è¿ç§»åˆ°æ–°çš„ nextTab æ•°ç»„ä¸­ã€‚</p>\n<p>è™½ç„¶æˆ‘ä»¬ä¹‹å‰è¯´çš„ tryPresize æ–¹æ³•ä¸­å¤šæ¬¡è°ƒç”¨ transfer ä¸æ¶‰åŠå¤šçº¿ç¨‹ï¼Œä½†æ˜¯è¿™ä¸ª transfer æ–¹æ³•å¯ä»¥åœ¨å…¶ä»–åœ°æ–¹è¢«è°ƒç”¨ï¼Œå…¸å‹åœ°ï¼Œæˆ‘ä»¬ä¹‹å‰åœ¨è¯´ put æ–¹æ³•çš„æ—¶å€™å°±è¯´è¿‡äº†ï¼Œè¯·å¾€ä¸Šçœ‹ put æ–¹æ³•ï¼Œæ˜¯ä¸æ˜¯æœ‰ä¸ªåœ°æ–¹è°ƒç”¨äº† helpTransfer æ–¹æ³•ï¼ŒhelpTransfer æ–¹æ³•ä¼šè°ƒç”¨ transfer æ–¹æ³•çš„ã€‚</p>\n<p>æ­¤æ–¹æ³•æ”¯æŒå¤šçº¿ç¨‹æ‰§è¡Œï¼Œå¤–å›´è°ƒç”¨æ­¤æ–¹æ³•çš„æ—¶å€™ï¼Œä¼šä¿è¯ç¬¬ä¸€ä¸ªå‘èµ·æ•°æ®è¿ç§»çš„çº¿ç¨‹ï¼ŒnextTab å‚æ•°ä¸º nullï¼Œä¹‹åå†è°ƒç”¨æ­¤æ–¹æ³•çš„æ—¶å€™ï¼ŒnextTab ä¸ä¼šä¸º nullã€‚</p>\n<p>é˜…è¯»æºç ä¹‹å‰ï¼Œå…ˆè¦ç†è§£å¹¶å‘æ“ä½œçš„æœºåˆ¶ã€‚åŸæ•°ç»„é•¿åº¦ä¸º nï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰ n ä¸ªè¿ç§»ä»»åŠ¡ï¼Œè®©æ¯ä¸ªçº¿ç¨‹æ¯æ¬¡è´Ÿè´£ä¸€ä¸ªå°ä»»åŠ¡æ˜¯æœ€ç®€å•çš„ï¼Œæ¯åšå®Œä¸€ä¸ªä»»åŠ¡å†æ£€æµ‹æ˜¯å¦æœ‰å…¶ä»–æ²¡åšå®Œçš„ä»»åŠ¡ï¼Œå¸®åŠ©è¿ç§»å°±å¯ä»¥äº†ï¼Œè€Œ Doug Lea ä½¿ç”¨äº†ä¸€ä¸ª strideï¼Œç®€å•ç†è§£å°±æ˜¯æ­¥é•¿ï¼Œæ¯ä¸ªçº¿ç¨‹æ¯æ¬¡è´Ÿè´£è¿ç§»å…¶ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œå¦‚æ¯æ¬¡è¿ç§» 16 ä¸ªå°ä»»åŠ¡ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªå…¨å±€çš„è°ƒåº¦è€…æ¥å®‰æ’å“ªä¸ªçº¿ç¨‹æ‰§è¡Œå“ªå‡ ä¸ªä»»åŠ¡ï¼Œè¿™ä¸ªå°±æ˜¯å±æ€§ transferIndex çš„ä½œç”¨ã€‚</p>\n<p>ç¬¬ä¸€ä¸ªå‘èµ·æ•°æ®è¿ç§»çš„çº¿ç¨‹ä¼šå°† transferIndex æŒ‡å‘åŸæ•°ç»„æœ€åçš„ä½ç½®ï¼Œç„¶åä»åå¾€å‰çš„ stride ä¸ªä»»åŠ¡å±äºç¬¬ä¸€ä¸ªçº¿ç¨‹ï¼Œç„¶åå°† transferIndex æŒ‡å‘æ–°çš„ä½ç½®ï¼Œå†å¾€å‰çš„ stride ä¸ªä»»åŠ¡å±äºç¬¬äºŒä¸ªçº¿ç¨‹ï¼Œä¾æ­¤ç±»æ¨ã€‚å½“ç„¶ï¼Œè¿™é‡Œè¯´çš„ç¬¬äºŒä¸ªçº¿ç¨‹ä¸æ˜¯çœŸçš„ä¸€å®šæŒ‡ä»£äº†ç¬¬äºŒä¸ªçº¿ç¨‹ï¼Œä¹Ÿå¯ä»¥æ˜¯åŒä¸€ä¸ªçº¿ç¨‹ï¼Œè¿™ä¸ªè¯»è€…åº”è¯¥èƒ½ç†è§£å§ã€‚å…¶å®å°±æ˜¯å°†ä¸€ä¸ªå¤§çš„è¿ç§»ä»»åŠ¡åˆ†ä¸ºäº†ä¸€ä¸ªä¸ªä»»åŠ¡åŒ…ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private final void transfer(Node&lt;K,V&gt;[] tab, Node&lt;K,V&gt;[] nextTab) &#123;\n    int n &#x3D; tab.length, stride;\n \n    &#x2F;&#x2F; stride åœ¨å•æ ¸ä¸‹ç›´æ¥ç­‰äº nï¼Œå¤šæ ¸æ¨¡å¼ä¸‹ä¸º (n&gt;&gt;&gt;3)&#x2F;NCPUï¼Œæœ€å°å€¼æ˜¯ 16\n    &#x2F;&#x2F; stride å¯ä»¥ç†è§£ä¸ºâ€æ­¥é•¿â€œï¼Œæœ‰ n ä¸ªä½ç½®æ˜¯éœ€è¦è¿›è¡Œè¿ç§»çš„ï¼Œ\n    &#x2F;&#x2F;   å°†è¿™ n ä¸ªä»»åŠ¡åˆ†ä¸ºå¤šä¸ªä»»åŠ¡åŒ…ï¼Œæ¯ä¸ªä»»åŠ¡åŒ…æœ‰ stride ä¸ªä»»åŠ¡\n    if ((stride &#x3D; (NCPU &gt; 1) ? (n &gt;&gt;&gt; 3) &#x2F; NCPU : n) &lt; MIN_TRANSFER_STRIDE)\n        stride &#x3D; MIN_TRANSFER_STRIDE; &#x2F;&#x2F; subdivide range\n \n    &#x2F;&#x2F; å¦‚æœ nextTab ä¸º nullï¼Œå…ˆè¿›è¡Œä¸€æ¬¡åˆå§‹åŒ–\n    &#x2F;&#x2F;    å‰é¢æˆ‘ä»¬è¯´äº†ï¼Œå¤–å›´ä¼šä¿è¯ç¬¬ä¸€ä¸ªå‘èµ·è¿ç§»çš„çº¿ç¨‹è°ƒç”¨æ­¤æ–¹æ³•æ—¶ï¼Œå‚æ•° nextTab ä¸º null\n    &#x2F;&#x2F;       ä¹‹åå‚ä¸è¿ç§»çš„çº¿ç¨‹è°ƒç”¨æ­¤æ–¹æ³•æ—¶ï¼ŒnextTab ä¸ä¼šä¸º null\n    if (nextTab &#x3D;&#x3D; null) &#123;\n        try &#123;\n            &#x2F;&#x2F; å®¹é‡ç¿»å€\n            Node&lt;K,V&gt;[] nt &#x3D; (Node&lt;K,V&gt;[])new Node&lt;?,?&gt;[n &lt;&lt; 1];\n            nextTab &#x3D; nt;\n        &#125; catch (Throwable ex) &#123;      &#x2F;&#x2F; try to cope with OOME\n            sizeCtl &#x3D; Integer.MAX_VALUE;\n            return;\n        &#125;\n        &#x2F;&#x2F; nextTable æ˜¯ ConcurrentHashMap ä¸­çš„å±æ€§\n        nextTable &#x3D; nextTab;\n        &#x2F;&#x2F; transferIndex ä¹Ÿæ˜¯ ConcurrentHashMap çš„å±æ€§ï¼Œç”¨äºæ§åˆ¶è¿ç§»çš„ä½ç½®\n        transferIndex &#x3D; n;\n    &#125;\n \n    int nextn &#x3D; nextTab.length;\n \n    &#x2F;&#x2F; ForwardingNode ç¿»è¯‘è¿‡æ¥å°±æ˜¯æ­£åœ¨è¢«è¿ç§»çš„ Node\n    &#x2F;&#x2F; è¿™ä¸ªæ„é€ æ–¹æ³•ä¼šç”Ÿæˆä¸€ä¸ªNodeï¼Œkeyã€value å’Œ next éƒ½ä¸º nullï¼Œå…³é”®æ˜¯ hash ä¸º MOVED\n    &#x2F;&#x2F; åé¢æˆ‘ä»¬ä¼šçœ‹åˆ°ï¼ŒåŸæ•°ç»„ä¸­ä½ç½® i å¤„çš„èŠ‚ç‚¹å®Œæˆè¿ç§»å·¥ä½œåï¼Œ\n    &#x2F;&#x2F;    å°±ä¼šå°†ä½ç½® i å¤„è®¾ç½®ä¸ºè¿™ä¸ª ForwardingNodeï¼Œç”¨æ¥å‘Šè¯‰å…¶ä»–çº¿ç¨‹è¯¥ä½ç½®å·²ç»å¤„ç†è¿‡äº†\n    &#x2F;&#x2F;    æ‰€ä»¥å®ƒå…¶å®ç›¸å½“äºæ˜¯ä¸€ä¸ªæ ‡å¿—ã€‚\n    ForwardingNode&lt;K,V&gt; fwd &#x3D; new ForwardingNode&lt;K,V&gt;(nextTab);\n \n \n    &#x2F;&#x2F; advance æŒ‡çš„æ˜¯åšå®Œäº†ä¸€ä¸ªä½ç½®çš„è¿ç§»å·¥ä½œï¼Œå¯ä»¥å‡†å¤‡åšä¸‹ä¸€ä¸ªä½ç½®çš„äº†\n    boolean advance &#x3D; true;\n    boolean finishing &#x3D; false; &#x2F;&#x2F; to ensure sweep before committing nextTab\n \n    &#x2F;*\n     * ä¸‹é¢è¿™ä¸ª for å¾ªç¯ï¼Œæœ€éš¾ç†è§£çš„åœ¨å‰é¢ï¼Œè€Œè¦çœ‹æ‡‚å®ƒä»¬ï¼Œåº”è¯¥å…ˆçœ‹æ‡‚åé¢çš„ï¼Œç„¶åå†å€’å›æ¥çœ‹\n     * \n     *&#x2F;\n \n    &#x2F;&#x2F; i æ˜¯ä½ç½®ç´¢å¼•ï¼Œbound æ˜¯è¾¹ç•Œï¼Œæ³¨æ„æ˜¯ä»åå¾€å‰\n    for (int i &#x3D; 0, bound &#x3D; 0;;) &#123;\n        Node&lt;K,V&gt; f; int fh;\n \n        &#x2F;&#x2F; ä¸‹é¢è¿™ä¸ª while çœŸçš„æ˜¯ä¸å¥½ç†è§£\n        &#x2F;&#x2F; advance ä¸º true è¡¨ç¤ºå¯ä»¥è¿›è¡Œä¸‹ä¸€ä¸ªä½ç½®çš„è¿ç§»äº†\n        &#x2F;&#x2F;   ç®€å•ç†è§£ç»“å±€ï¼ši æŒ‡å‘äº† transferIndexï¼Œbound æŒ‡å‘äº† transferIndex-stride\n        while (advance) &#123;\n            int nextIndex, nextBound;\n            if (--i &gt;&#x3D; bound || finishing)\n                advance &#x3D; false;\n \n            &#x2F;&#x2F; å°† transferIndex å€¼èµ‹ç»™ nextIndex\n            &#x2F;&#x2F; è¿™é‡Œ transferIndex ä¸€æ—¦å°äºç­‰äº 0ï¼Œè¯´æ˜åŸæ•°ç»„çš„æ‰€æœ‰ä½ç½®éƒ½æœ‰ç›¸åº”çš„çº¿ç¨‹å»å¤„ç†äº†\n            else if ((nextIndex &#x3D; transferIndex) &lt;&#x3D; 0) &#123;\n                i &#x3D; -1;\n                advance &#x3D; false;\n            &#125;\n            else if (U.compareAndSwapInt\n                     (this, TRANSFERINDEX, nextIndex,\n                      nextBound &#x3D; (nextIndex &gt; stride ?\n                                   nextIndex - stride : 0))) &#123;\n                &#x2F;&#x2F; çœ‹æ‹¬å·ä¸­çš„ä»£ç ï¼ŒnextBound æ˜¯è¿™æ¬¡è¿ç§»ä»»åŠ¡çš„è¾¹ç•Œï¼Œæ³¨æ„ï¼Œæ˜¯ä»åå¾€å‰\n                bound &#x3D; nextBound;\n                i &#x3D; nextIndex - 1;\n                advance &#x3D; false;\n            &#125;\n        &#125;\n        if (i &lt; 0 || i &gt;&#x3D; n || i + n &gt;&#x3D; nextn) &#123;\n            int sc;\n            if (finishing) &#123;\n                &#x2F;&#x2F; æ‰€æœ‰çš„è¿ç§»æ“ä½œå·²ç»å®Œæˆ\n                nextTable &#x3D; null;\n                &#x2F;&#x2F; å°†æ–°çš„ nextTab èµ‹å€¼ç»™ table å±æ€§ï¼Œå®Œæˆè¿ç§»\n                table &#x3D; nextTab;\n                &#x2F;&#x2F; é‡æ–°è®¡ç®— sizeCtlï¼šn æ˜¯åŸæ•°ç»„é•¿åº¦ï¼Œæ‰€ä»¥ sizeCtl å¾—å‡ºçš„å€¼å°†æ˜¯æ–°æ•°ç»„é•¿åº¦çš„ 0.75 å€\n                sizeCtl &#x3D; (n &lt;&lt; 1) - (n &gt;&gt;&gt; 1);\n                return;\n            &#125;\n \n            &#x2F;&#x2F; ä¹‹å‰æˆ‘ä»¬è¯´è¿‡ï¼ŒsizeCtl åœ¨è¿ç§»å‰ä¼šè®¾ç½®ä¸º (rs &lt;&lt; RESIZE_STAMP_SHIFT) + 2\n            &#x2F;&#x2F; ç„¶åï¼Œæ¯æœ‰ä¸€ä¸ªçº¿ç¨‹å‚ä¸è¿ç§»å°±ä¼šå°† sizeCtl åŠ  1ï¼Œ\n            &#x2F;&#x2F; è¿™é‡Œä½¿ç”¨ CAS æ“ä½œå¯¹ sizeCtl è¿›è¡Œå‡ 1ï¼Œä»£è¡¨åšå®Œäº†å±äºè‡ªå·±çš„ä»»åŠ¡\n            if (U.compareAndSwapInt(this, SIZECTL, sc &#x3D; sizeCtl, sc - 1)) &#123;\n                &#x2F;&#x2F; ä»»åŠ¡ç»“æŸï¼Œæ–¹æ³•é€€å‡º\n                if ((sc - 2) !&#x3D; resizeStamp(n) &lt;&lt; RESIZE_STAMP_SHIFT)\n                    return;\n \n                &#x2F;&#x2F; åˆ°è¿™é‡Œï¼Œè¯´æ˜ (sc - 2) &#x3D;&#x3D; resizeStamp(n) &lt;&lt; RESIZE_STAMP_SHIFTï¼Œ\n                &#x2F;&#x2F; ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰€æœ‰çš„è¿ç§»ä»»åŠ¡éƒ½åšå®Œäº†ï¼Œä¹Ÿå°±ä¼šè¿›å…¥åˆ°ä¸Šé¢çš„ if(finishing)&#123;&#125; åˆ†æ”¯äº†\n                finishing &#x3D; advance &#x3D; true;\n                i &#x3D; n; &#x2F;&#x2F; recheck before commit\n            &#125;\n        &#125;\n        &#x2F;&#x2F; å¦‚æœä½ç½® i å¤„æ˜¯ç©ºçš„ï¼Œæ²¡æœ‰ä»»ä½•èŠ‚ç‚¹ï¼Œé‚£ä¹ˆæ”¾å…¥åˆšåˆšåˆå§‹åŒ–çš„ ForwardingNode â€ç©ºèŠ‚ç‚¹â€œ\n        else if ((f &#x3D; tabAt(tab, i)) &#x3D;&#x3D; null)\n            advance &#x3D; casTabAt(tab, i, null, fwd);\n        &#x2F;&#x2F; è¯¥ä½ç½®å¤„æ˜¯ä¸€ä¸ª ForwardingNodeï¼Œä»£è¡¨è¯¥ä½ç½®å·²ç»è¿ç§»è¿‡äº†\n        else if ((fh &#x3D; f.hash) &#x3D;&#x3D; MOVED)\n            advance &#x3D; true; &#x2F;&#x2F; already processed\n        else &#123;\n            &#x2F;&#x2F; å¯¹æ•°ç»„è¯¥ä½ç½®å¤„çš„ç»“ç‚¹åŠ é”ï¼Œå¼€å§‹å¤„ç†æ•°ç»„è¯¥ä½ç½®å¤„çš„è¿ç§»å·¥ä½œ\n            synchronized (f) &#123;\n                if (tabAt(tab, i) &#x3D;&#x3D; f) &#123;\n                    Node&lt;K,V&gt; ln, hn;\n                    &#x2F;&#x2F; å¤´ç»“ç‚¹çš„ hash å¤§äº 0ï¼Œè¯´æ˜æ˜¯é“¾è¡¨çš„ Node èŠ‚ç‚¹\n                    if (fh &gt;&#x3D; 0) &#123;\n                        &#x2F;&#x2F; ä¸‹é¢è¿™ä¸€å—å’Œ Java7 ä¸­çš„ ConcurrentHashMap è¿ç§»æ˜¯å·®ä¸å¤šçš„ï¼Œ\n                        &#x2F;&#x2F; éœ€è¦å°†é“¾è¡¨ä¸€åˆ†ä¸ºäºŒï¼Œ\n                        &#x2F;&#x2F;   æ‰¾åˆ°åŸé“¾è¡¨ä¸­çš„ lastRunï¼Œç„¶å lastRun åŠå…¶ä¹‹åçš„èŠ‚ç‚¹æ˜¯ä¸€èµ·è¿›è¡Œè¿ç§»çš„\n                        &#x2F;&#x2F;   lastRun ä¹‹å‰çš„èŠ‚ç‚¹éœ€è¦è¿›è¡Œå…‹éš†ï¼Œç„¶ååˆ†åˆ°ä¸¤ä¸ªé“¾è¡¨ä¸­\n                        int runBit &#x3D; fh &amp; n;\n                        Node&lt;K,V&gt; lastRun &#x3D; f;\n                        for (Node&lt;K,V&gt; p &#x3D; f.next; p !&#x3D; null; p &#x3D; p.next) &#123;\n                            int b &#x3D; p.hash &amp; n;\n                            if (b !&#x3D; runBit) &#123;\n                                runBit &#x3D; b;\n                                lastRun &#x3D; p;\n                            &#125;\n                        &#125;\n                        if (runBit &#x3D;&#x3D; 0) &#123;\n                            ln &#x3D; lastRun;\n                            hn &#x3D; null;\n                        &#125;\n                        else &#123;\n                            hn &#x3D; lastRun;\n                            ln &#x3D; null;\n                        &#125;\n                        for (Node&lt;K,V&gt; p &#x3D; f; p !&#x3D; lastRun; p &#x3D; p.next) &#123;\n                            int ph &#x3D; p.hash; K pk &#x3D; p.key; V pv &#x3D; p.val;\n                            if ((ph &amp; n) &#x3D;&#x3D; 0)\n                                ln &#x3D; new Node&lt;K,V&gt;(ph, pk, pv, ln);\n                            else\n                                hn &#x3D; new Node&lt;K,V&gt;(ph, pk, pv, hn);\n                        &#125;\n                        &#x2F;&#x2F; å…¶ä¸­çš„ä¸€ä¸ªé“¾è¡¨æ”¾åœ¨æ–°æ•°ç»„çš„ä½ç½® i\n                        setTabAt(nextTab, i, ln);\n                        &#x2F;&#x2F; å¦ä¸€ä¸ªé“¾è¡¨æ”¾åœ¨æ–°æ•°ç»„çš„ä½ç½® i+n\n                        setTabAt(nextTab, i + n, hn);\n                        &#x2F;&#x2F; å°†åŸæ•°ç»„è¯¥ä½ç½®å¤„è®¾ç½®ä¸º fwdï¼Œä»£è¡¨è¯¥ä½ç½®å·²ç»å¤„ç†å®Œæ¯•ï¼Œ\n                        &#x2F;&#x2F;    å…¶ä»–çº¿ç¨‹ä¸€æ—¦çœ‹åˆ°è¯¥ä½ç½®çš„ hash å€¼ä¸º MOVEDï¼Œå°±ä¸ä¼šè¿›è¡Œè¿ç§»äº†\n                        setTabAt(tab, i, fwd);\n                        &#x2F;&#x2F; advance è®¾ç½®ä¸º trueï¼Œä»£è¡¨è¯¥ä½ç½®å·²ç»è¿ç§»å®Œæ¯•\n                        advance &#x3D; true;\n                    &#125;\n                    else if (f instanceof TreeBin) &#123;\n                        &#x2F;&#x2F; çº¢é»‘æ ‘çš„è¿ç§»\n                        TreeBin&lt;K,V&gt; t &#x3D; (TreeBin&lt;K,V&gt;)f;\n                        TreeNode&lt;K,V&gt; lo &#x3D; null, loTail &#x3D; null;\n                        TreeNode&lt;K,V&gt; hi &#x3D; null, hiTail &#x3D; null;\n                        int lc &#x3D; 0, hc &#x3D; 0;\n                        for (Node&lt;K,V&gt; e &#x3D; t.first; e !&#x3D; null; e &#x3D; e.next) &#123;\n                            int h &#x3D; e.hash;\n                            TreeNode&lt;K,V&gt; p &#x3D; new TreeNode&lt;K,V&gt;\n                                (h, e.key, e.val, null, null);\n                            if ((h &amp; n) &#x3D;&#x3D; 0) &#123;\n                                if ((p.prev &#x3D; loTail) &#x3D;&#x3D; null)\n                                    lo &#x3D; p;\n                                else\n                                    loTail.next &#x3D; p;\n                                loTail &#x3D; p;\n                                ++lc;\n                            &#125;\n                            else &#123;\n                                if ((p.prev &#x3D; hiTail) &#x3D;&#x3D; null)\n                                    hi &#x3D; p;\n                                else\n                                    hiTail.next &#x3D; p;\n                                hiTail &#x3D; p;\n                                ++hc;\n                            &#125;\n                        &#125;\n                        &#x2F;&#x2F; å¦‚æœä¸€åˆ†ä¸ºäºŒåï¼ŒèŠ‚ç‚¹æ•°å°‘äº 8ï¼Œé‚£ä¹ˆå°†çº¢é»‘æ ‘è½¬æ¢å›é“¾è¡¨\n                        ln &#x3D; (lc &lt;&#x3D; UNTREEIFY_THRESHOLD) ? untreeify(lo) :\n                            (hc !&#x3D; 0) ? new TreeBin&lt;K,V&gt;(lo) : t;\n                        hn &#x3D; (hc &lt;&#x3D; UNTREEIFY_THRESHOLD) ? untreeify(hi) :\n                            (lc !&#x3D; 0) ? new TreeBin&lt;K,V&gt;(hi) : t;\n \n                        &#x2F;&#x2F; å°† ln æ”¾ç½®åœ¨æ–°æ•°ç»„çš„ä½ç½® i\n                        setTabAt(nextTab, i, ln);\n                        &#x2F;&#x2F; å°† hn æ”¾ç½®åœ¨æ–°æ•°ç»„çš„ä½ç½® i+n\n                        setTabAt(nextTab, i + n, hn);\n                        &#x2F;&#x2F; å°†åŸæ•°ç»„è¯¥ä½ç½®å¤„è®¾ç½®ä¸º fwdï¼Œä»£è¡¨è¯¥ä½ç½®å·²ç»å¤„ç†å®Œæ¯•ï¼Œ\n                        &#x2F;&#x2F;    å…¶ä»–çº¿ç¨‹ä¸€æ—¦çœ‹åˆ°è¯¥ä½ç½®çš„ hash å€¼ä¸º MOVEDï¼Œå°±ä¸ä¼šè¿›è¡Œè¿ç§»äº†\n                        setTabAt(tab, i, fwd);\n                        &#x2F;&#x2F; advance è®¾ç½®ä¸º trueï¼Œä»£è¡¨è¯¥ä½ç½®å·²ç»è¿ç§»å®Œæ¯•\n                        advance &#x3D; true;\n                    &#125;\n                &#125;\n            &#125;\n        &#125;\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¯´åˆ°åº•ï¼Œtransfer è¿™ä¸ªæ–¹æ³•å¹¶æ²¡æœ‰å®ç°æ‰€æœ‰çš„è¿ç§»ä»»åŠ¡ï¼Œæ¯æ¬¡è°ƒç”¨è¿™ä¸ªæ–¹æ³•åªå®ç°äº† transferIndex å¾€å‰ stride ä¸ªä½ç½®çš„è¿ç§»å·¥ä½œï¼Œå…¶ä»–çš„éœ€è¦ç”±å¤–å›´æ¥æ§åˆ¶ã€‚</p>\n<p>è¿™ä¸ªæ—¶å€™ï¼Œå†å›å»ä»”ç»†çœ‹ tryPresize æ–¹æ³•å¯èƒ½å°±ä¼šæ›´åŠ æ¸…æ™°ä¸€äº›äº†ã€‚</p>\n<h4 id=\"get-è¿‡ç¨‹åˆ†æ-3\"><a href=\"#get-è¿‡ç¨‹åˆ†æ-3\" class=\"headerlink\" title=\"get è¿‡ç¨‹åˆ†æ\"></a>get è¿‡ç¨‹åˆ†æ</h4><p>get æ–¹æ³•ä»æ¥éƒ½æ˜¯æœ€ç®€å•çš„ï¼Œè¿™é‡Œä¹Ÿä¸ä¾‹å¤–ï¼š</p>\n<p>1.è®¡ç®— hash å€¼</p>\n<p>2.æ ¹æ® hash å€¼æ‰¾åˆ°æ•°ç»„å¯¹åº”ä½ç½®: (n â€“ 1) &amp; h</p>\n<p>3.æ ¹æ®è¯¥ä½ç½®å¤„ç»“ç‚¹æ€§è´¨è¿›è¡Œç›¸åº”æŸ¥æ‰¾</p>\n<ul>\n<li>å¦‚æœè¯¥ä½ç½®ä¸º nullï¼Œé‚£ä¹ˆç›´æ¥è¿”å› null å°±å¯ä»¥äº†</li>\n<li>å¦‚æœè¯¥ä½ç½®å¤„çš„èŠ‚ç‚¹åˆšå¥½å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„ï¼Œè¿”å›è¯¥èŠ‚ç‚¹çš„å€¼å³å¯</li>\n<li>å¦‚æœè¯¥ä½ç½®èŠ‚ç‚¹çš„ hash å€¼å°äº 0ï¼Œè¯´æ˜æ­£åœ¨æ‰©å®¹ï¼Œæˆ–è€…æ˜¯çº¢é»‘æ ‘ï¼Œåé¢æˆ‘ä»¬å†ä»‹ç» find æ–¹æ³•</li>\n<li>å¦‚æœä»¥ä¸Š 3 æ¡éƒ½ä¸æ»¡è¶³ï¼Œé‚£å°±æ˜¯é“¾è¡¨ï¼Œè¿›è¡Œéå†æ¯”å¯¹å³å¯ã€‚</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public V get(Object key) &#123;\n    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; e, p; int n, eh; K ek;\n    int h &#x3D; spread(key.hashCode());\n    if ((tab &#x3D; table) !&#x3D; null &amp;&amp; (n &#x3D; tab.length) &gt; 0 &amp;&amp;\n        (e &#x3D; tabAt(tab, (n - 1) &amp; h)) !&#x3D; null) &#123;\n        &#x2F;&#x2F; åˆ¤æ–­å¤´ç»“ç‚¹æ˜¯å¦å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„èŠ‚ç‚¹\n        if ((eh &#x3D; e.hash) &#x3D;&#x3D; h) &#123;\n            if ((ek &#x3D; e.key) &#x3D;&#x3D; key || (ek !&#x3D; null &amp;&amp; key.equals(ek)))\n                return e.val;\n        &#125;\n        &#x2F;&#x2F; å¦‚æœå¤´ç»“ç‚¹çš„ hash å°äº 0ï¼Œè¯´æ˜ æ­£åœ¨æ‰©å®¹ï¼Œæˆ–è€…è¯¥ä½ç½®æ˜¯çº¢é»‘æ ‘\n        else if (eh &lt; 0)\n            &#x2F;&#x2F; å‚è€ƒ ForwardingNode.find(int h, Object k) å’Œ TreeBin.find(int h, Object k)\n            return (p &#x3D; e.find(h, key)) !&#x3D; null ? p.val : null;\n \n        &#x2F;&#x2F; éå†é“¾è¡¨\n        while ((e &#x3D; e.next) !&#x3D; null) &#123;\n            if (e.hash &#x3D;&#x3D; h &amp;&amp;\n                ((ek &#x3D; e.key) &#x3D;&#x3D; key || (ek !&#x3D; null &amp;&amp; key.equals(ek))))\n                return e.val;\n        &#125;\n    &#125;\n    return null;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç®€å•è¯´ä¸€å¥ï¼Œæ­¤æ–¹æ³•çš„å¤§éƒ¨åˆ†å†…å®¹éƒ½å¾ˆç®€å•ï¼Œåªæœ‰æ­£å¥½ç¢°åˆ°æ‰©å®¹çš„æƒ…å†µï¼ŒForwardingNode.find(int h, Object k) ç¨å¾®å¤æ‚ä¸€äº›ï¼Œä¸è¿‡åœ¨äº†è§£äº†æ•°æ®è¿ç§»çš„è¿‡ç¨‹åï¼Œè¿™ä¸ªä¹Ÿå°±ä¸éš¾äº†ï¼Œæ‰€ä»¥é™äºç¯‡å¹…è¿™é‡Œä¹Ÿä¸å±•å¼€è¯´äº†ã€‚</p>\n<h2 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h2><p>å…¶å®ä¹Ÿä¸æ˜¯å¾ˆéš¾å˜›ï¼Œè™½ç„¶æ²¡æœ‰åƒä¹‹å‰çš„ AQS å’Œçº¿ç¨‹æ± ä¸€æ ·ä¸€è¡Œä¸€è¡Œæºç è¿›è¡Œåˆ†æï¼Œä½†è¿˜æ˜¯æŠŠæ‰€æœ‰åˆå­¦è€…å¯èƒ½ä¼šç³Šæ¶‚çš„åœ°æ–¹éƒ½è¿›è¡Œäº†æ·±å…¥çš„ä»‹ç»ï¼Œåªè¦æ˜¯ç¨å¾®æœ‰ç‚¹åŸºç¡€çš„è¯»è€…ï¼Œåº”è¯¥æ˜¯å¾ˆå®¹æ˜“å°±èƒ½çœ‹æ‡‚ HashMap å’Œ ConcurrentHashMap æºç äº†ã€‚</p>\n<p>çœ‹æºç ä¸ç®—æ˜¯ç›®çš„å§ï¼Œæ·±å…¥åœ°äº†è§£ Doug Lea çš„è®¾è®¡æ€è·¯ï¼Œæˆ‘è§‰å¾—è¿˜æŒºæœ‰è¶£çš„ï¼Œå¤§å¸ˆå°±æ˜¯å¤§å¸ˆï¼Œä»£ç å†™å¾—çœŸçš„æ˜¯å¥½å•Šã€‚</p>\n<p>æˆ‘å‘ç°å¾ˆå¤šäººéƒ½ä»¥ä¸ºæˆ‘å†™åšå®¢ä¸»è¦æ˜¯æºç åˆ†æï¼Œè¯´çœŸçš„ï¼Œæˆ‘å¯¹äºæºç åˆ†ææ²¡æœ‰é‚£ä¹ˆå¤§çƒ­æƒ…ï¼Œä¸»è¦éƒ½æ˜¯ä¸ºäº†ç”¨æºç è¯´äº‹ç½¢äº†ï¼Œå¯èƒ½ä¹‹åçš„æ–‡ç« è¿˜æ˜¯ä¼šæœ‰æ¯”è¾ƒå¤šçš„æºç åˆ†ææˆåˆ†ï¼Œå¤§å®¶è¯¥æ€ä¹ˆçœ‹å°±æ€ä¹ˆçœ‹å§ã€‚</p>\n<p>ä¸è¦è„¸åœ°è‡ªä»¥ä¸ºæœ¬æ–‡çš„è´¨é‡è¿˜æ˜¯æŒºé«˜çš„ï¼Œä¿¡æ¯é‡æ¯”è¾ƒå¤§ï¼Œå¦‚æœä½ è§‰å¾—æœ‰å†™å¾—ä¸å¥½çš„åœ°æ–¹ï¼Œæˆ–è€…è¯´çœ‹å®Œæœ¬æ–‡ä½ è¿˜æ˜¯æ²¡çœ‹æ‡‚å®ƒä»¬ï¼Œé‚£ä¹ˆè¯·æå‡ºæ¥~~~</p>\n","excerpt":"","more":"<p>ç½‘ä¸Šå…³äº HashMap å’Œ ConcurrentHashMap çš„æ–‡ç« ç¡®å®ä¸å°‘ï¼Œä¸è¿‡ç¼ºæ–¤å°‘ä¸¤çš„æ–‡ç« æ¯”è¾ƒå¤šï¼Œæ‰€ä»¥æ‰æƒ³è‡ªå·±ä¹Ÿå†™ä¸€ç¯‡ï¼ŒæŠŠç»†èŠ‚è¯´æ¸…æ¥šè¯´é€ï¼Œå°¤å…¶åƒ Java8 ä¸­çš„ ConcurrentHashMapï¼Œå¤§éƒ¨åˆ†æ–‡ç« éƒ½è¯´ä¸æ¸…æ¥šã€‚ç»ˆå½’æ˜¯å¸Œæœ›èƒ½é™ä½å¤§å®¶å­¦ä¹ çš„æˆæœ¬ï¼Œä¸å¸Œæœ›å¤§å®¶åˆ°å¤„æ‰¾å„ç§ä¸æ˜¯å¾ˆé è°±çš„æ–‡ç« ï¼Œçœ‹å®Œä¸€ç¯‡åˆä¸€ç¯‡ï¼Œå¯æ˜¯è¿˜æ˜¯æ¨¡æ¨¡ç³Šç³Šã€‚</p>\n<p><strong>é˜…è¯»å»ºè®®ï¼š</strong> å››èŠ‚åŸºæœ¬ä¸Šå¯ä»¥è¿›è¡Œç‹¬ç«‹é˜…è¯»ï¼Œå»ºè®®åˆå­¦è€…å¯æŒ‰ç…§ä»¥ä¸‹é¡ºåºè¿›è¡Œé˜…è¯»ï¼Œå¯é€‚å½“é™ä½é˜…è¯»é—¨æ§›ã€‚</p>\n<blockquote>\n<p>Java7 HashMap -&gt; Java7 ConcurrentHashMap -&gt; Java8 HashMap -&gt; Java8 ConcurrentHashMap </p>\n</blockquote>\n<p><strong>é˜…è¯»å‰æï¼š</strong> æœ¬æ–‡åˆ†æçš„æ˜¯æºç ï¼Œæ‰€ä»¥è‡³å°‘è¯»è€…è¦ç†Ÿæ‚‰å®ƒä»¬çš„æ¥å£ä½¿ç”¨ï¼ŒåŒæ—¶ï¼Œå¯¹äºå¹¶å‘ï¼Œè¯»è€…è‡³å°‘è¦çŸ¥é“ CASã€ReentrantLockã€UNSAFE æ“ä½œè¿™å‡ ä¸ªåŸºæœ¬çš„çŸ¥è¯†ï¼Œæ–‡ä¸­ä¸ä¼šå¯¹è¿™äº›çŸ¥è¯†è¿›è¡Œä»‹ç»ã€‚Java8 ç”¨åˆ°äº†çº¢é»‘æ ‘ï¼Œä¸è¿‡æœ¬æ–‡ä¸ä¼šè¿›è¡Œå±•å¼€ï¼Œæ„Ÿå…´è¶£çš„è¯»è€…è¯·è‡ªè¡ŒæŸ¥æ‰¾ç›¸å…³èµ„æ–™ã€‚</p>\n<h2 id=\"Java7-HashMap\"><a href=\"#Java7-HashMap\" class=\"headerlink\" title=\"Java7 HashMap\"></a>Java7 HashMap</h2><p>HashMap æ˜¯æœ€ç®€å•çš„ï¼Œä¸€æ¥æˆ‘ä»¬éå¸¸ç†Ÿæ‚‰ï¼ŒäºŒæ¥å°±æ˜¯å®ƒä¸æ”¯æŒå¹¶å‘æ“ä½œï¼Œæ‰€ä»¥æºç ä¹Ÿéå¸¸ç®€å•ã€‚</p>\n<p>é¦–å…ˆï¼Œæˆ‘ä»¬ç”¨ä¸‹é¢è¿™å¼ å›¾æ¥ä»‹ç» HashMap çš„ç»“æ„ã€‚</p>\n<p><img src=\"http://qianniu.javastack.cn/18-12-4/65827660.jpg\"></p>\n<p>è¿™ä¸ªä»…ä»…æ˜¯ç¤ºæ„å›¾ï¼Œå› ä¸ºæ²¡æœ‰è€ƒè™‘åˆ°æ•°ç»„è¦æ‰©å®¹çš„æƒ…å†µï¼Œå…·ä½“çš„åé¢å†è¯´ã€‚</p>\n<p>å¤§æ–¹å‘ä¸Šï¼ŒHashMap é‡Œé¢æ˜¯ä¸€ä¸ª<strong>æ•°ç»„</strong>ï¼Œç„¶åæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ª<strong>å•å‘é“¾è¡¨</strong>ã€‚</p>\n<p>ä¸Šå›¾ä¸­ï¼Œæ¯ä¸ªç»¿è‰²çš„å®ä½“æ˜¯åµŒå¥—ç±» Entry çš„å®ä¾‹ï¼ŒEntry åŒ…å«å››ä¸ªå±æ€§ï¼škey, value, hash å€¼å’Œç”¨äºå•å‘é“¾è¡¨çš„ nextã€‚</p>\n<p>capacityï¼šå½“å‰æ•°ç»„å®¹é‡ï¼Œå§‹ç»ˆä¿æŒ 2^nï¼Œå¯ä»¥æ‰©å®¹ï¼Œæ‰©å®¹åæ•°ç»„å¤§å°ä¸ºå½“å‰çš„ 2 å€ã€‚</p>\n<p>loadFactorï¼šè´Ÿè½½å› å­ï¼Œé»˜è®¤ä¸º 0.75ã€‚</p>\n<p>thresholdï¼šæ‰©å®¹çš„é˜ˆå€¼ï¼Œç­‰äº capacity * loadFactor</p>\n<h4 id=\"put-è¿‡ç¨‹åˆ†æ\"><a href=\"#put-è¿‡ç¨‹åˆ†æ\" class=\"headerlink\" title=\"put è¿‡ç¨‹åˆ†æ\"></a>put è¿‡ç¨‹åˆ†æ</h4><p>è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œè·Ÿç€ä»£ç èµ°ä¸€éå§ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public V put(K key, V value) &#123;\n    &#x2F;&#x2F; å½“æ’å…¥ç¬¬ä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œéœ€è¦å…ˆåˆå§‹åŒ–æ•°ç»„å¤§å°\n    if (table &#x3D;&#x3D; EMPTY_TABLE) &#123;\n        inflateTable(threshold);\n    &#125;\n    &#x2F;&#x2F; å¦‚æœ key ä¸º nullï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥å¾€é‡Œçœ‹ï¼Œæœ€ç»ˆä¼šå°†è¿™ä¸ª entry æ”¾åˆ° table[0] ä¸­\n    if (key &#x3D;&#x3D; null)\n        return putForNullKey(value);\n    &#x2F;&#x2F; 1. æ±‚ key çš„ hash å€¼\n    int hash &#x3D; hash(key);\n    &#x2F;&#x2F; 2. æ‰¾åˆ°å¯¹åº”çš„æ•°ç»„ä¸‹æ ‡\n    int i &#x3D; indexFor(hash, table.length);\n    &#x2F;&#x2F; 3. éå†ä¸€ä¸‹å¯¹åº”ä¸‹æ ‡å¤„çš„é“¾è¡¨ï¼Œçœ‹æ˜¯å¦æœ‰é‡å¤çš„ key å·²ç»å­˜åœ¨ï¼Œ\n    &#x2F;&#x2F;    å¦‚æœæœ‰ï¼Œç›´æ¥è¦†ç›–ï¼Œput æ–¹æ³•è¿”å›æ—§å€¼å°±ç»“æŸäº†\n    for (Entry&lt;K,V&gt; e &#x3D; table[i]; e !&#x3D; null; e &#x3D; e.next) &#123;\n        Object k;\n        if (e.hash &#x3D;&#x3D; hash &amp;&amp; ((k &#x3D; e.key) &#x3D;&#x3D; key || key.equals(k))) &#123;\n            V oldValue &#x3D; e.value;\n            e.value &#x3D; value;\n            e.recordAccess(this);\n            return oldValue;\n        &#125;\n    &#125;\n \n    modCount++;\n    &#x2F;&#x2F; 4. ä¸å­˜åœ¨é‡å¤çš„ keyï¼Œå°†æ­¤ entry æ·»åŠ åˆ°é“¾è¡¨ä¸­ï¼Œç»†èŠ‚åé¢è¯´\n    addEntry(hash, key, value, i);\n    return null;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h6 id=\"æ•°ç»„åˆå§‹åŒ–\"><a href=\"#æ•°ç»„åˆå§‹åŒ–\" class=\"headerlink\" title=\"æ•°ç»„åˆå§‹åŒ–\"></a>æ•°ç»„åˆå§‹åŒ–</h6><p>åœ¨ç¬¬ä¸€ä¸ªå…ƒç´ æ’å…¥ HashMap çš„æ—¶å€™åšä¸€æ¬¡æ•°ç»„çš„åˆå§‹åŒ–ï¼Œå°±æ˜¯å…ˆç¡®å®šåˆå§‹çš„æ•°ç»„å¤§å°ï¼Œå¹¶è®¡ç®—æ•°ç»„æ‰©å®¹çš„é˜ˆå€¼ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private void inflateTable(int toSize) &#123;\n    &#x2F;&#x2F; ä¿è¯æ•°ç»„å¤§å°ä¸€å®šæ˜¯ 2 çš„ n æ¬¡æ–¹ã€‚\n    &#x2F;&#x2F; æ¯”å¦‚è¿™æ ·åˆå§‹åŒ–ï¼šnew HashMap(20)ï¼Œé‚£ä¹ˆå¤„ç†æˆåˆå§‹æ•°ç»„å¤§å°æ˜¯ 32\n    int capacity &#x3D; roundUpToPowerOf2(toSize);\n    &#x2F;&#x2F; è®¡ç®—æ‰©å®¹é˜ˆå€¼ï¼šcapacity * loadFactor\n    threshold &#x3D; (int) Math.min(capacity * loadFactor, MAXIMUM_CAPACITY + 1);\n    &#x2F;&#x2F; ç®—æ˜¯åˆå§‹åŒ–æ•°ç»„å§\n    table &#x3D; new Entry[capacity];\n    initHashSeedAsNeeded(capacity); &#x2F;&#x2F;ignore\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™é‡Œæœ‰ä¸€ä¸ªå°†æ•°ç»„å¤§å°ä¿æŒä¸º 2 çš„ n æ¬¡æ–¹çš„åšæ³•ï¼ŒJava7 å’Œ Java8 çš„ HashMap å’Œ ConcurrentHashMap éƒ½æœ‰ç›¸åº”çš„è¦æ±‚ï¼Œåªä¸è¿‡å®ç°çš„ä»£ç ç¨å¾®æœ‰äº›ä¸åŒï¼Œåé¢å†çœ‹åˆ°çš„æ—¶å€™å°±çŸ¥é“äº†ã€‚</p>\n<h6 id=\"è®¡ç®—å…·ä½“æ•°ç»„ä½ç½®\"><a href=\"#è®¡ç®—å…·ä½“æ•°ç»„ä½ç½®\" class=\"headerlink\" title=\"è®¡ç®—å…·ä½“æ•°ç»„ä½ç½®\"></a>è®¡ç®—å…·ä½“æ•°ç»„ä½ç½®</h6><p>è¿™ä¸ªç®€å•ï¼Œæˆ‘ä»¬è‡ªå·±ä¹Ÿèƒ½ YY ä¸€ä¸ªï¼šä½¿ç”¨ key çš„ hash å€¼å¯¹æ•°ç»„é•¿åº¦è¿›è¡Œå–æ¨¡å°±å¯ä»¥äº†ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">static int indexFor(int hash, int length) &#123;\n    &#x2F;&#x2F; assert Integer.bitCount(length) &#x3D;&#x3D; 1 : &quot;length must be a non-zero power of 2&quot;;\n    return hash &amp; (length-1);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªæ–¹æ³•å¾ˆç®€å•ï¼Œç®€å•è¯´å°±æ˜¯å– hash å€¼çš„ä½ n ä½ã€‚å¦‚åœ¨æ•°ç»„é•¿åº¦ä¸º 32 çš„æ—¶å€™ï¼Œå…¶å®å–çš„å°±æ˜¯ key çš„ hash å€¼çš„ä½ 5 ä½ï¼Œä½œä¸ºå®ƒåœ¨æ•°ç»„ä¸­çš„ä¸‹æ ‡ä½ç½®ã€‚</p>\n<h6 id=\"æ·»åŠ èŠ‚ç‚¹åˆ°é“¾è¡¨ä¸­\"><a href=\"#æ·»åŠ èŠ‚ç‚¹åˆ°é“¾è¡¨ä¸­\" class=\"headerlink\" title=\"æ·»åŠ èŠ‚ç‚¹åˆ°é“¾è¡¨ä¸­\"></a>æ·»åŠ èŠ‚ç‚¹åˆ°é“¾è¡¨ä¸­</h6><p>æ‰¾åˆ°æ•°ç»„ä¸‹æ ‡åï¼Œä¼šå…ˆè¿›è¡Œ key åˆ¤é‡ï¼Œå¦‚æœæ²¡æœ‰é‡å¤ï¼Œå°±å‡†å¤‡å°†æ–°å€¼æ”¾å…¥åˆ°é“¾è¡¨çš„è¡¨å¤´ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">void addEntry(int hash, K key, V value, int bucketIndex) &#123;\n    &#x2F;&#x2F; å¦‚æœå½“å‰ HashMap å¤§å°å·²ç»è¾¾åˆ°äº†é˜ˆå€¼ï¼Œå¹¶ä¸”æ–°å€¼è¦æ’å…¥çš„æ•°ç»„ä½ç½®å·²ç»æœ‰å…ƒç´ äº†ï¼Œé‚£ä¹ˆè¦æ‰©å®¹\n    if ((size &gt;&#x3D; threshold) &amp;&amp; (null !&#x3D; table[bucketIndex])) &#123;\n        &#x2F;&#x2F; æ‰©å®¹ï¼Œåé¢ä¼šä»‹ç»ä¸€ä¸‹\n        resize(2 * table.length);\n        &#x2F;&#x2F; æ‰©å®¹ä»¥åï¼Œé‡æ–°è®¡ç®— hash å€¼\n        hash &#x3D; (null !&#x3D; key) ? hash(key) : 0;\n        &#x2F;&#x2F; é‡æ–°è®¡ç®—æ‰©å®¹åçš„æ–°çš„ä¸‹æ ‡\n        bucketIndex &#x3D; indexFor(hash, table.length);\n    &#125;\n    &#x2F;&#x2F; å¾€ä¸‹çœ‹\n    createEntry(hash, key, value, bucketIndex);\n&#125;\n\n&#x2F;&#x2F; è¿™ä¸ªå¾ˆç®€å•ï¼Œå…¶å®å°±æ˜¯å°†æ–°å€¼æ”¾åˆ°é“¾è¡¨çš„è¡¨å¤´ï¼Œç„¶å size++\nvoid createEntry(int hash, K key, V value, int bucketIndex) &#123;\n    Entry&lt;K,V&gt; e &#x3D; table[bucketIndex];\n    table[bucketIndex] &#x3D; new Entry&lt;&gt;(hash, key, value, e);\n    size++;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªæ–¹æ³•çš„ä¸»è¦é€»è¾‘å°±æ˜¯å…ˆåˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹ï¼Œéœ€è¦çš„è¯å…ˆæ‰©å®¹ï¼Œç„¶åå†å°†è¿™ä¸ªæ–°çš„æ•°æ®æ’å…¥åˆ°æ‰©å®¹åçš„æ•°ç»„çš„ç›¸åº”ä½ç½®å¤„çš„é“¾è¡¨çš„è¡¨å¤´ã€‚</p>\n<h6 id=\"æ•°ç»„æ‰©å®¹\"><a href=\"#æ•°ç»„æ‰©å®¹\" class=\"headerlink\" title=\"æ•°ç»„æ‰©å®¹\"></a>æ•°ç»„æ‰©å®¹</h6><p>å‰é¢æˆ‘ä»¬çœ‹åˆ°ï¼Œåœ¨æ’å…¥æ–°å€¼çš„æ—¶å€™ï¼Œå¦‚æœå½“å‰çš„ size å·²ç»è¾¾åˆ°äº†é˜ˆå€¼ï¼Œå¹¶ä¸”è¦æ’å…¥çš„æ•°ç»„ä½ç½®ä¸Šå·²ç»æœ‰å…ƒç´ ï¼Œé‚£ä¹ˆå°±ä¼šè§¦å‘æ‰©å®¹ï¼Œæ‰©å®¹åï¼Œæ•°ç»„å¤§å°ä¸ºåŸæ¥çš„ 2 å€ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">void resize(int newCapacity) &#123;\n    Entry[] oldTable &#x3D; table;\n    int oldCapacity &#x3D; oldTable.length;\n    if (oldCapacity &#x3D;&#x3D; MAXIMUM_CAPACITY) &#123;\n        threshold &#x3D; Integer.MAX_VALUE;\n        return;\n    &#125;\n    &#x2F;&#x2F; æ–°çš„æ•°ç»„\n    Entry[] newTable &#x3D; new Entry[newCapacity];\n    &#x2F;&#x2F; å°†åŸæ¥æ•°ç»„ä¸­çš„å€¼è¿ç§»åˆ°æ–°çš„æ›´å¤§çš„æ•°ç»„ä¸­\n    transfer(newTable, initHashSeedAsNeeded(newCapacity));\n    table &#x3D; newTable;\n    threshold &#x3D; (int)Math.min(newCapacity * loadFactor, MAXIMUM_CAPACITY + 1);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ‰©å®¹å°±æ˜¯ç”¨ä¸€ä¸ªæ–°çš„å¤§æ•°ç»„æ›¿æ¢åŸæ¥çš„å°æ•°ç»„ï¼Œå¹¶å°†åŸæ¥æ•°ç»„ä¸­çš„å€¼è¿ç§»åˆ°æ–°çš„æ•°ç»„ä¸­ã€‚</p>\n<p>ç”±äºæ˜¯åŒå€æ‰©å®¹ï¼Œè¿ç§»è¿‡ç¨‹ä¸­ï¼Œä¼šå°†åŸæ¥ table[i] ä¸­çš„é“¾è¡¨çš„æ‰€æœ‰èŠ‚ç‚¹ï¼Œåˆ†æ‹†åˆ°æ–°çš„æ•°ç»„çš„ newTable[i] å’Œ newTable[i + oldLength] ä½ç½®ä¸Šã€‚å¦‚åŸæ¥æ•°ç»„é•¿åº¦æ˜¯ 16ï¼Œé‚£ä¹ˆæ‰©å®¹åï¼ŒåŸæ¥ table[0] å¤„çš„é“¾è¡¨ä¸­çš„æ‰€æœ‰å…ƒç´ ä¼šè¢«åˆ†é…åˆ°æ–°æ•°ç»„ä¸­ newTable[0] å’Œ newTable[16] è¿™ä¸¤ä¸ªä½ç½®ã€‚ä»£ç æ¯”è¾ƒç®€å•ï¼Œè¿™é‡Œå°±ä¸å±•å¼€äº†ã€‚</p>\n<h4 id=\"get-è¿‡ç¨‹åˆ†æ\"><a href=\"#get-è¿‡ç¨‹åˆ†æ\" class=\"headerlink\" title=\"get è¿‡ç¨‹åˆ†æ\"></a>get è¿‡ç¨‹åˆ†æ</h4><p>ç›¸å¯¹äº put è¿‡ç¨‹ï¼Œget è¿‡ç¨‹æ˜¯éå¸¸ç®€å•çš„ã€‚</p>\n<ol>\n<li>æ ¹æ® key è®¡ç®— hash å€¼ã€‚</li>\n<li>æ‰¾åˆ°ç›¸åº”çš„æ•°ç»„ä¸‹æ ‡ï¼šhash &amp; (length â€“ 1)ã€‚</li>\n<li>éå†è¯¥æ•°ç»„ä½ç½®å¤„çš„é“¾è¡¨ï¼Œç›´åˆ°æ‰¾åˆ°ç›¸ç­‰(&#x3D;&#x3D;æˆ–equals)çš„ keyã€‚</li>\n</ol>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public V get(Object key) &#123;\n    &#x2F;&#x2F; ä¹‹å‰è¯´è¿‡ï¼Œkey ä¸º null çš„è¯ï¼Œä¼šè¢«æ”¾åˆ° table[0]ï¼Œæ‰€ä»¥åªè¦éå†ä¸‹ table[0] å¤„çš„é“¾è¡¨å°±å¯ä»¥äº†\n    if (key &#x3D;&#x3D; null)\n        return getForNullKey();\n    &#x2F;&#x2F; \n    Entry&lt;K,V&gt; entry &#x3D; getEntry(key);\n \n    return null &#x3D;&#x3D; entry ? null : entry.getValue();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>getEntry(key):</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">final Entry&lt;K,V&gt; getEntry(Object key) &#123;\n    if (size &#x3D;&#x3D; 0) &#123;\n        return null;\n    &#125;\n \n    int hash &#x3D; (key &#x3D;&#x3D; null) ? 0 : hash(key);\n    &#x2F;&#x2F; ç¡®å®šæ•°ç»„ä¸‹æ ‡ï¼Œç„¶åä»å¤´å¼€å§‹éå†é“¾è¡¨ï¼Œç›´åˆ°æ‰¾åˆ°ä¸ºæ­¢\n    for (Entry&lt;K,V&gt; e &#x3D; table[indexFor(hash, table.length)];\n         e !&#x3D; null;\n         e &#x3D; e.next) &#123;\n        Object k;\n        if (e.hash &#x3D;&#x3D; hash &amp;&amp;\n            ((k &#x3D; e.key) &#x3D;&#x3D; key || (key !&#x3D; null &amp;&amp; key.equals(k))))\n            return e;\n    &#125;\n    return null;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"Java7-ConcurrentHashMap\"><a href=\"#Java7-ConcurrentHashMap\" class=\"headerlink\" title=\"Java7 ConcurrentHashMap\"></a>Java7 ConcurrentHashMap</h2><p>ConcurrentHashMap å’Œ HashMap æ€è·¯æ˜¯å·®ä¸å¤šçš„ï¼Œä½†æ˜¯å› ä¸ºå®ƒæ”¯æŒå¹¶å‘æ“ä½œï¼Œæ‰€ä»¥è¦å¤æ‚ä¸€äº›ã€‚</p>\n<p>æ•´ä¸ª ConcurrentHashMap ç”±ä¸€ä¸ªä¸ª Segment ç»„æˆï¼ŒSegment ä»£è¡¨â€éƒ¨åˆ†â€œæˆ–â€ä¸€æ®µâ€œçš„æ„æ€ï¼Œæ‰€ä»¥å¾ˆå¤šåœ°æ–¹éƒ½ä¼šå°†å…¶æè¿°ä¸º<strong>åˆ†æ®µé”</strong>ã€‚æ³¨æ„ï¼Œè¡Œæ–‡ä¸­ï¼Œæˆ‘å¾ˆå¤šåœ°æ–¹ç”¨äº† <strong>â€œæ§½â€</strong> æ¥ä»£è¡¨ä¸€ä¸ª segmentã€‚</p>\n<p>ç®€å•ç†è§£å°±æ˜¯ï¼ŒConcurrentHashMap æ˜¯ä¸€ä¸ª Segment æ•°ç»„ï¼ŒSegment é€šè¿‡ç»§æ‰¿ ReentrantLock æ¥è¿›è¡ŒåŠ é”ï¼Œæ‰€ä»¥æ¯æ¬¡éœ€è¦åŠ é”çš„æ“ä½œé”ä½çš„æ˜¯ä¸€ä¸ª segmentï¼Œè¿™æ ·åªè¦ä¿è¯æ¯ä¸ª Segment æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä¹Ÿå°±å®ç°äº†å…¨å±€çš„çº¿ç¨‹å®‰å…¨ã€‚æ¨èé˜…è¯»ï¼š<a href=\"https://mp.weixin.qq.com/s/0CI9od4DIxRrmOGFJw0SuQ\">å²ä¸Šæœ€å…¨ Java å¤šçº¿ç¨‹é¢è¯•é¢˜åŠç­”æ¡ˆ</a>ã€‚</p>\n<p><img src=\"http://qianniu.javastack.cn/18-12-4/75121838.jpg\"></p>\n<p><strong>concurrencyLevelï¼š</strong> å¹¶è¡Œçº§åˆ«ã€å¹¶å‘æ•°ã€Segment æ•°ï¼Œæ€ä¹ˆç¿»è¯‘ä¸é‡è¦ï¼Œç†è§£å®ƒã€‚é»˜è®¤æ˜¯ 16ï¼Œä¹Ÿå°±æ˜¯è¯´ ConcurrentHashMap æœ‰ 16 ä¸ª Segmentsï¼Œæ‰€ä»¥ç†è®ºä¸Šï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæœ€å¤šå¯ä»¥åŒæ—¶æ”¯æŒ 16 ä¸ªçº¿ç¨‹å¹¶å‘å†™ï¼Œåªè¦å®ƒä»¬çš„æ“ä½œåˆ†åˆ«åˆ†å¸ƒåœ¨ä¸åŒçš„ Segment ä¸Šã€‚è¿™ä¸ªå€¼å¯ä»¥åœ¨åˆå§‹åŒ–çš„æ—¶å€™è®¾ç½®ä¸ºå…¶ä»–å€¼ï¼Œä½†æ˜¯ä¸€æ—¦åˆå§‹åŒ–ä»¥åï¼Œå®ƒæ˜¯ä¸å¯ä»¥æ‰©å®¹çš„ã€‚</p>\n<p>å†å…·ä½“åˆ°æ¯ä¸ª Segment å†…éƒ¨ï¼Œå…¶å®æ¯ä¸ª Segment å¾ˆåƒä¹‹å‰ä»‹ç»çš„ HashMapï¼Œä¸è¿‡å®ƒè¦ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œæ‰€ä»¥å¤„ç†èµ·æ¥è¦éº»çƒ¦äº›ã€‚æ¨èé˜…è¯»ï¼š<a href=\"https://mp.weixin.qq.com/s/5Y5_6qn2g6kIVmQia_0R6g\">å‡ ç§çº¿ç¨‹å®‰å…¨çš„Mapè§£æ</a>ã€‚</p>\n<h4 id=\"åˆå§‹åŒ–\"><a href=\"#åˆå§‹åŒ–\" class=\"headerlink\" title=\"åˆå§‹åŒ–\"></a>åˆå§‹åŒ–</h4><p>initialCapacityï¼šåˆå§‹å®¹é‡ï¼Œè¿™ä¸ªå€¼æŒ‡çš„æ˜¯æ•´ä¸ª ConcurrentHashMap çš„åˆå§‹å®¹é‡ï¼Œå®é™…æ“ä½œçš„æ—¶å€™éœ€è¦å¹³å‡åˆ†ç»™æ¯ä¸ª Segmentã€‚</p>\n<p>loadFactorï¼šè´Ÿè½½å› å­ï¼Œä¹‹å‰æˆ‘ä»¬è¯´äº†ï¼ŒSegment æ•°ç»„ä¸å¯ä»¥æ‰©å®¹ï¼Œæ‰€ä»¥è¿™ä¸ªè´Ÿè½½å› å­æ˜¯ç»™æ¯ä¸ª Segment å†…éƒ¨ä½¿ç”¨çš„ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public ConcurrentHashMap(int initialCapacity,\n                         float loadFactor, int concurrencyLevel) &#123;\n    if (!(loadFactor &gt; 0) || initialCapacity &lt; 0 || concurrencyLevel &lt;&#x3D; 0)\n        throw new IllegalArgumentException();\n    if (concurrencyLevel &gt; MAX_SEGMENTS)\n        concurrencyLevel &#x3D; MAX_SEGMENTS;\n    &#x2F;&#x2F; Find power-of-two sizes best matching arguments\n    int sshift &#x3D; 0;\n    int ssize &#x3D; 1;\n    &#x2F;&#x2F; è®¡ç®—å¹¶è¡Œçº§åˆ« ssizeï¼Œå› ä¸ºè¦ä¿æŒå¹¶è¡Œçº§åˆ«æ˜¯ 2 çš„ n æ¬¡æ–¹\n    while (ssize &lt; concurrencyLevel) &#123;\n        ++sshift;\n        ssize &lt;&lt;&#x3D; 1;\n    &#125;\n    &#x2F;&#x2F; æˆ‘ä»¬è¿™é‡Œå…ˆä¸è¦é‚£ä¹ˆçƒ§è„‘ï¼Œç”¨é»˜è®¤å€¼ï¼ŒconcurrencyLevel ä¸º 16ï¼Œsshift ä¸º 4\n    &#x2F;&#x2F; é‚£ä¹ˆè®¡ç®—å‡º segmentShift ä¸º 28ï¼ŒsegmentMask ä¸º 15ï¼Œåé¢ä¼šç”¨åˆ°è¿™ä¸¤ä¸ªå€¼\n    this.segmentShift &#x3D; 32 - sshift;\n    this.segmentMask &#x3D; ssize - 1;\n \n    if (initialCapacity &gt; MAXIMUM_CAPACITY)\n        initialCapacity &#x3D; MAXIMUM_CAPACITY;\n \n    &#x2F;&#x2F; initialCapacity æ˜¯è®¾ç½®æ•´ä¸ª map åˆå§‹çš„å¤§å°ï¼Œ\n    &#x2F;&#x2F; è¿™é‡Œæ ¹æ® initialCapacity è®¡ç®— Segment æ•°ç»„ä¸­æ¯ä¸ªä½ç½®å¯ä»¥åˆ†åˆ°çš„å¤§å°\n    &#x2F;&#x2F; å¦‚ initialCapacity ä¸º 64ï¼Œé‚£ä¹ˆæ¯ä¸ª Segment æˆ–ç§°ä¹‹ä¸º&quot;æ§½&quot;å¯ä»¥åˆ†åˆ° 4 ä¸ª\n    int c &#x3D; initialCapacity &#x2F; ssize;\n    if (c * ssize &lt; initialCapacity)\n        ++c;\n    &#x2F;&#x2F; é»˜è®¤ MIN_SEGMENT_TABLE_CAPACITY æ˜¯ 2ï¼Œè¿™ä¸ªå€¼ä¹Ÿæ˜¯æœ‰è®²ç©¶çš„ï¼Œå› ä¸ºè¿™æ ·çš„è¯ï¼Œå¯¹äºå…·ä½“çš„æ§½ä¸Šï¼Œ\n    &#x2F;&#x2F; æ’å…¥ä¸€ä¸ªå…ƒç´ ä¸è‡³äºæ‰©å®¹ï¼Œæ’å…¥ç¬¬äºŒä¸ªçš„æ—¶å€™æ‰ä¼šæ‰©å®¹\n    int cap &#x3D; MIN_SEGMENT_TABLE_CAPACITY; \n    while (cap &lt; c)\n        cap &lt;&lt;&#x3D; 1;\n \n    &#x2F;&#x2F; åˆ›å»º Segment æ•°ç»„ï¼Œ\n    &#x2F;&#x2F; å¹¶åˆ›å»ºæ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´  segment[0]\n    Segment&lt;K,V&gt; s0 &#x3D;\n        new Segment&lt;K,V&gt;(loadFactor, (int)(cap * loadFactor),\n                         (HashEntry&lt;K,V&gt;[])new HashEntry[cap]);\n    Segment&lt;K,V&gt;[] ss &#x3D; (Segment&lt;K,V&gt;[])new Segment[ssize];\n    &#x2F;&#x2F; å¾€æ•°ç»„å†™å…¥ segment[0]\n    UNSAFE.putOrderedObject(ss, SBASE, s0); &#x2F;&#x2F; ordered write of segments[0]\n    this.segments &#x3D; ss;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>åˆå§‹åŒ–å®Œæˆï¼Œæˆ‘ä»¬å¾—åˆ°äº†ä¸€ä¸ª Segment æ•°ç»„ã€‚</p>\n<p>æˆ‘ä»¬å°±å½“æ˜¯ç”¨ new ConcurrentHashMap() æ— å‚æ„é€ å‡½æ•°è¿›è¡Œåˆå§‹åŒ–çš„ï¼Œé‚£ä¹ˆåˆå§‹åŒ–å®Œæˆåï¼š</p>\n<ul>\n<li>Segment æ•°ç»„é•¿åº¦ä¸º 16ï¼Œä¸å¯ä»¥æ‰©å®¹</li>\n<li>Segment[i] çš„é»˜è®¤å¤§å°ä¸º 2ï¼Œè´Ÿè½½å› å­æ˜¯ 0.75ï¼Œå¾—å‡ºåˆå§‹é˜ˆå€¼ä¸º 1.5ï¼Œä¹Ÿå°±æ˜¯ä»¥åæ’å…¥ç¬¬ä¸€ä¸ªå…ƒç´ ä¸ä¼šè§¦å‘æ‰©å®¹ï¼Œæ’å…¥ç¬¬äºŒä¸ªä¼šè¿›è¡Œç¬¬ä¸€æ¬¡æ‰©å®¹</li>\n<li>è¿™é‡Œåˆå§‹åŒ–äº† segment[0]ï¼Œå…¶ä»–ä½ç½®è¿˜æ˜¯ nullï¼Œè‡³äºä¸ºä»€ä¹ˆè¦åˆå§‹åŒ– segment[0]ï¼Œåé¢çš„ä»£ç ä¼šä»‹ç»</li>\n<li>å½“å‰ segmentShift çš„å€¼ä¸º 32 â€“ 4 &#x3D; 28ï¼ŒsegmentMask ä¸º 16 â€“ 1 &#x3D; 15ï¼Œå§‘ä¸”æŠŠå®ƒä»¬ç®€å•ç¿»è¯‘ä¸ºç§»ä½æ•°å’Œæ©ç ï¼Œè¿™ä¸¤ä¸ªå€¼é©¬ä¸Šå°±ä¼šç”¨åˆ°ã€‚</li>\n</ul>\n<h4 id=\"put-è¿‡ç¨‹åˆ†æ-1\"><a href=\"#put-è¿‡ç¨‹åˆ†æ-1\" class=\"headerlink\" title=\"put è¿‡ç¨‹åˆ†æ\"></a>put è¿‡ç¨‹åˆ†æ</h4><p>æˆ‘ä»¬å…ˆçœ‹ put çš„ä¸»æµç¨‹ï¼Œå¯¹äºå…¶ä¸­çš„ä¸€äº›å…³é”®ç»†èŠ‚æ“ä½œï¼Œåé¢ä¼šè¿›è¡Œè¯¦ç»†ä»‹ç»ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public V put(K key, V value) &#123;\n    Segment&lt;K,V&gt; s;\n    if (value &#x3D;&#x3D; null)\n        throw new NullPointerException();\n    &#x2F;&#x2F; 1. è®¡ç®— key çš„ hash å€¼\n    int hash &#x3D; hash(key);\n    &#x2F;&#x2F; 2. æ ¹æ® hash å€¼æ‰¾åˆ° Segment æ•°ç»„ä¸­çš„ä½ç½® j\n    &#x2F;&#x2F;    hash æ˜¯ 32 ä½ï¼Œæ— ç¬¦å·å³ç§» segmentShift(28) ä½ï¼Œå‰©ä¸‹ä½ 4 ä½ï¼Œ\n    &#x2F;&#x2F;    ç„¶åå’Œ segmentMask(15) åšä¸€æ¬¡ä¸æ“ä½œï¼Œä¹Ÿå°±æ˜¯è¯´ j æ˜¯ hash å€¼çš„æœ€å 4 ä½ï¼Œä¹Ÿå°±æ˜¯æ§½çš„æ•°ç»„ä¸‹æ ‡\n    int j &#x3D; (hash &gt;&gt;&gt; segmentShift) &amp; segmentMask;\n    &#x2F;&#x2F; åˆšåˆšè¯´äº†ï¼Œåˆå§‹åŒ–çš„æ—¶å€™åˆå§‹åŒ–äº† segment[0]ï¼Œä½†æ˜¯å…¶ä»–ä½ç½®è¿˜æ˜¯ nullï¼Œ\n    &#x2F;&#x2F; ensureSegment(j) å¯¹ segment[j] è¿›è¡Œåˆå§‹åŒ–\n    if ((s &#x3D; (Segment&lt;K,V&gt;)UNSAFE.getObject          &#x2F;&#x2F; nonvolatile; recheck\n         (segments, (j &lt;&lt; SSHIFT) + SBASE)) &#x3D;&#x3D; null) &#x2F;&#x2F;  in ensureSegment\n        s &#x3D; ensureSegment(j);\n    &#x2F;&#x2F; 3. æ’å…¥æ–°å€¼åˆ° æ§½ s ä¸­\n    return s.put(key, hash, value, false);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¬¬ä¸€å±‚çš®å¾ˆç®€å•ï¼Œæ ¹æ® hash å€¼å¾ˆå¿«å°±èƒ½æ‰¾åˆ°ç›¸åº”çš„ Segmentï¼Œä¹‹åå°±æ˜¯ Segment å†…éƒ¨çš„ put æ“ä½œäº†ã€‚</p>\n<p>Segment å†…éƒ¨æ˜¯ç”± <strong>æ•°ç»„+é“¾è¡¨</strong> ç»„æˆçš„ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">final V put(K key, int hash, V value, boolean onlyIfAbsent) &#123;\n    &#x2F;&#x2F; åœ¨å¾€è¯¥ segment å†™å…¥å‰ï¼Œéœ€è¦å…ˆè·å–è¯¥ segment çš„ç‹¬å é”\n    &#x2F;&#x2F;    å…ˆçœ‹ä¸»æµç¨‹ï¼Œåé¢è¿˜ä¼šå…·ä½“ä»‹ç»è¿™éƒ¨åˆ†å†…å®¹\n    HashEntry&lt;K,V&gt; node &#x3D; tryLock() ? null :\n        scanAndLockForPut(key, hash, value);\n    V oldValue;\n    try &#123;\n        &#x2F;&#x2F; è¿™ä¸ªæ˜¯ segment å†…éƒ¨çš„æ•°ç»„\n        HashEntry&lt;K,V&gt;[] tab &#x3D; table;\n        &#x2F;&#x2F; å†åˆ©ç”¨ hash å€¼ï¼Œæ±‚åº”è¯¥æ”¾ç½®çš„æ•°ç»„ä¸‹æ ‡\n        int index &#x3D; (tab.length - 1) &amp; hash;\n        &#x2F;&#x2F; first æ˜¯æ•°ç»„è¯¥ä½ç½®å¤„çš„é“¾è¡¨çš„è¡¨å¤´\n        HashEntry&lt;K,V&gt; first &#x3D; entryAt(tab, index);\n \n        &#x2F;&#x2F; ä¸‹é¢è¿™ä¸² for å¾ªç¯è™½ç„¶å¾ˆé•¿ï¼Œä¸è¿‡ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œæƒ³æƒ³è¯¥ä½ç½®æ²¡æœ‰ä»»ä½•å…ƒç´ å’Œå·²ç»å­˜åœ¨ä¸€ä¸ªé“¾è¡¨è¿™ä¸¤ç§æƒ…å†µ\n        for (HashEntry&lt;K,V&gt; e &#x3D; first;;) &#123;\n            if (e !&#x3D; null) &#123;\n                K k;\n                if ((k &#x3D; e.key) &#x3D;&#x3D; key ||\n                    (e.hash &#x3D;&#x3D; hash &amp;&amp; key.equals(k))) &#123;\n                    oldValue &#x3D; e.value;\n                    if (!onlyIfAbsent) &#123;\n                        &#x2F;&#x2F; è¦†ç›–æ—§å€¼\n                        e.value &#x3D; value;\n                        ++modCount;\n                    &#125;\n                    break;\n                &#125;\n                &#x2F;&#x2F; ç»§ç»­é¡ºç€é“¾è¡¨èµ°\n                e &#x3D; e.next;\n            &#125;\n            else &#123;\n                &#x2F;&#x2F; node åˆ°åº•æ˜¯ä¸æ˜¯ nullï¼Œè¿™ä¸ªè¦çœ‹è·å–é”çš„è¿‡ç¨‹ï¼Œä¸è¿‡å’Œè¿™é‡Œéƒ½æ²¡æœ‰å…³ç³»ã€‚\n                &#x2F;&#x2F; å¦‚æœä¸ä¸º nullï¼Œé‚£å°±ç›´æ¥å°†å®ƒè®¾ç½®ä¸ºé“¾è¡¨è¡¨å¤´ï¼›å¦‚æœæ˜¯nullï¼Œåˆå§‹åŒ–å¹¶è®¾ç½®ä¸ºé“¾è¡¨è¡¨å¤´ã€‚\n                if (node !&#x3D; null)\n                    node.setNext(first);\n                else\n                    node &#x3D; new HashEntry&lt;K,V&gt;(hash, key, value, first);\n \n                int c &#x3D; count + 1;\n                &#x2F;&#x2F; å¦‚æœè¶…è¿‡äº†è¯¥ segment çš„é˜ˆå€¼ï¼Œè¿™ä¸ª segment éœ€è¦æ‰©å®¹\n                if (c &gt; threshold &amp;&amp; tab.length &lt; MAXIMUM_CAPACITY)\n                    rehash(node); &#x2F;&#x2F; æ‰©å®¹åé¢ä¹Ÿä¼šå…·ä½“åˆ†æ\n                else\n                    &#x2F;&#x2F; æ²¡æœ‰è¾¾åˆ°é˜ˆå€¼ï¼Œå°† node æ”¾åˆ°æ•°ç»„ tab çš„ index ä½ç½®ï¼Œ\n                    &#x2F;&#x2F; å…¶å®å°±æ˜¯å°†æ–°çš„èŠ‚ç‚¹è®¾ç½®æˆåŸé“¾è¡¨çš„è¡¨å¤´\n                    setEntryAt(tab, index, node);\n                ++modCount;\n                count &#x3D; c;\n                oldValue &#x3D; null;\n                break;\n            &#125;\n        &#125;\n    &#125; finally &#123;\n        &#x2F;&#x2F; è§£é”\n        unlock();\n    &#125;\n    return oldValue;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ•´ä½“æµç¨‹è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼Œç”±äºæœ‰ç‹¬å é”çš„ä¿æŠ¤ï¼Œæ‰€ä»¥ segment å†…éƒ¨çš„æ“ä½œå¹¶ä¸å¤æ‚ã€‚è‡³äºè¿™é‡Œé¢çš„å¹¶å‘é—®é¢˜ï¼Œæˆ‘ä»¬ç¨åå†è¿›è¡Œä»‹ç»ã€‚</p>\n<p>åˆ°è¿™é‡Œ put æ“ä½œå°±ç»“æŸäº†ï¼Œæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¯´ä¸€è¯´å…¶ä¸­å‡ æ­¥å…³é”®çš„æ“ä½œã€‚</p>\n<h6 id=\"åˆå§‹åŒ–æ§½-ensureSegment\"><a href=\"#åˆå§‹åŒ–æ§½-ensureSegment\" class=\"headerlink\" title=\"åˆå§‹åŒ–æ§½: ensureSegment\"></a>åˆå§‹åŒ–æ§½: ensureSegment</h6><p>ConcurrentHashMap åˆå§‹åŒ–çš„æ—¶å€™ä¼šåˆå§‹åŒ–ç¬¬ä¸€ä¸ªæ§½ segment[0]ï¼Œå¯¹äºå…¶ä»–æ§½æ¥è¯´ï¼Œåœ¨æ’å…¥ç¬¬ä¸€ä¸ªå€¼çš„æ—¶å€™è¿›è¡Œåˆå§‹åŒ–ã€‚</p>\n<p>è¿™é‡Œéœ€è¦è€ƒè™‘å¹¶å‘ï¼Œå› ä¸ºå¾ˆå¯èƒ½ä¼šæœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶è¿›æ¥åˆå§‹åŒ–åŒä¸€ä¸ªæ§½ segment[k]ï¼Œä¸è¿‡åªè¦æœ‰ä¸€ä¸ªæˆåŠŸäº†å°±å¯ä»¥ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private Segment&lt;K,V&gt; ensureSegment(int k) &#123;\n    final Segment&lt;K,V&gt;[] ss &#x3D; this.segments;\n    long u &#x3D; (k &lt;&lt; SSHIFT) + SBASE; &#x2F;&#x2F; raw offset\n    Segment&lt;K,V&gt; seg;\n    if ((seg &#x3D; (Segment&lt;K,V&gt;)UNSAFE.getObjectVolatile(ss, u)) &#x3D;&#x3D; null) &#123;\n        &#x2F;&#x2F; è¿™é‡Œçœ‹åˆ°ä¸ºä»€ä¹ˆä¹‹å‰è¦åˆå§‹åŒ– segment[0] äº†ï¼Œ\n        &#x2F;&#x2F; ä½¿ç”¨å½“å‰ segment[0] å¤„çš„æ•°ç»„é•¿åº¦å’Œè´Ÿè½½å› å­æ¥åˆå§‹åŒ– segment[k]\n        &#x2F;&#x2F; ä¸ºä»€ä¹ˆè¦ç”¨â€œå½“å‰â€ï¼Œå› ä¸º segment[0] å¯èƒ½æ—©å°±æ‰©å®¹è¿‡äº†\n        Segment&lt;K,V&gt; proto &#x3D; ss[0];\n        int cap &#x3D; proto.table.length;\n        float lf &#x3D; proto.loadFactor;\n        int threshold &#x3D; (int)(cap * lf);\n \n        &#x2F;&#x2F; åˆå§‹åŒ– segment[k] å†…éƒ¨çš„æ•°ç»„\n        HashEntry&lt;K,V&gt;[] tab &#x3D; (HashEntry&lt;K,V&gt;[])new HashEntry[cap];\n        if ((seg &#x3D; (Segment&lt;K,V&gt;)UNSAFE.getObjectVolatile(ss, u))\n            &#x3D;&#x3D; null) &#123; &#x2F;&#x2F; å†æ¬¡æ£€æŸ¥ä¸€éè¯¥æ§½æ˜¯å¦è¢«å…¶ä»–çº¿ç¨‹åˆå§‹åŒ–äº†ã€‚\n \n            Segment&lt;K,V&gt; s &#x3D; new Segment&lt;K,V&gt;(lf, threshold, tab);\n            &#x2F;&#x2F; ä½¿ç”¨ while å¾ªç¯ï¼Œå†…éƒ¨ç”¨ CASï¼Œå½“å‰çº¿ç¨‹æˆåŠŸè®¾å€¼æˆ–å…¶ä»–çº¿ç¨‹æˆåŠŸè®¾å€¼åï¼Œé€€å‡º\n            while ((seg &#x3D; (Segment&lt;K,V&gt;)UNSAFE.getObjectVolatile(ss, u))\n                   &#x3D;&#x3D; null) &#123;\n                if (UNSAFE.compareAndSwapObject(ss, u, null, seg &#x3D; s))\n                    break;\n            &#125;\n        &#125;\n    &#125;\n    return seg;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ€»çš„æ¥è¯´ï¼ŒensureSegment(int k) æ¯”è¾ƒç®€å•ï¼Œå¯¹äºå¹¶å‘æ“ä½œä½¿ç”¨ CAS è¿›è¡Œæ§åˆ¶ã€‚</p>\n<blockquote>\n<p>å¦‚æœå½“å‰çº¿ç¨‹ CAS å¤±è´¥ï¼Œè¿™é‡Œçš„ while å¾ªç¯æ˜¯ä¸ºäº†å°† seg èµ‹å€¼è¿”å›ã€‚</p>\n</blockquote>\n<h6 id=\"è·å–å†™å…¥é”-scanAndLockForPut\"><a href=\"#è·å–å†™å…¥é”-scanAndLockForPut\" class=\"headerlink\" title=\"è·å–å†™å…¥é”: scanAndLockForPut\"></a>è·å–å†™å…¥é”: scanAndLockForPut</h6><p>å‰é¢æˆ‘ä»¬çœ‹åˆ°ï¼Œåœ¨å¾€æŸä¸ª segment ä¸­ put çš„æ—¶å€™ï¼Œé¦–å…ˆä¼šè°ƒç”¨ node &#x3D; tryLock() ? null : scanAndLockForPut(key, hash, value)ï¼Œä¹Ÿå°±æ˜¯è¯´å…ˆè¿›è¡Œä¸€æ¬¡ tryLock() å¿«é€Ÿè·å–è¯¥ segment çš„ç‹¬å é”ï¼Œå¦‚æœå¤±è´¥ï¼Œé‚£ä¹ˆè¿›å…¥åˆ° scanAndLockForPut è¿™ä¸ªæ–¹æ³•æ¥è·å–é”ã€‚</p>\n<p>ä¸‹é¢æˆ‘ä»¬æ¥å…·ä½“åˆ†æè¿™ä¸ªæ–¹æ³•ä¸­æ˜¯æ€ä¹ˆæ§åˆ¶åŠ é”çš„ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private HashEntry&lt;K,V&gt; scanAndLockForPut(K key, int hash, V value) &#123;\n    HashEntry&lt;K,V&gt; first &#x3D; entryForHash(this, hash);\n    HashEntry&lt;K,V&gt; e &#x3D; first;\n    HashEntry&lt;K,V&gt; node &#x3D; null;\n    int retries &#x3D; -1; &#x2F;&#x2F; negative while locating node\n \n    &#x2F;&#x2F; å¾ªç¯è·å–é”\n    while (!tryLock()) &#123;\n        HashEntry&lt;K,V&gt; f; &#x2F;&#x2F; to recheck first below\n        if (retries &lt; 0) &#123;\n            if (e &#x3D;&#x3D; null) &#123;\n                if (node &#x3D;&#x3D; null) &#x2F;&#x2F; speculatively create node\n                    &#x2F;&#x2F; è¿›åˆ°è¿™é‡Œè¯´æ˜æ•°ç»„è¯¥ä½ç½®çš„é“¾è¡¨æ˜¯ç©ºçš„ï¼Œæ²¡æœ‰ä»»ä½•å…ƒç´ \n                    &#x2F;&#x2F; å½“ç„¶ï¼Œè¿›åˆ°è¿™é‡Œçš„å¦ä¸€ä¸ªåŸå› æ˜¯ tryLock() å¤±è´¥ï¼Œæ‰€ä»¥è¯¥æ§½å­˜åœ¨å¹¶å‘ï¼Œä¸ä¸€å®šæ˜¯è¯¥ä½ç½®\n                    node &#x3D; new HashEntry&lt;K,V&gt;(hash, key, value, null);\n                retries &#x3D; 0;\n            &#125;\n            else if (key.equals(e.key))\n                retries &#x3D; 0;\n            else\n                &#x2F;&#x2F; é¡ºç€é“¾è¡¨å¾€ä¸‹èµ°\n                e &#x3D; e.next;\n        &#125;\n        &#x2F;&#x2F; é‡è¯•æ¬¡æ•°å¦‚æœè¶…è¿‡ MAX_SCAN_RETRIESï¼ˆå•æ ¸1å¤šæ ¸64ï¼‰ï¼Œé‚£ä¹ˆä¸æŠ¢äº†ï¼Œè¿›å…¥åˆ°é˜»å¡é˜Ÿåˆ—ç­‰å¾…é”\n        &#x2F;&#x2F;    lock() æ˜¯é˜»å¡æ–¹æ³•ï¼Œç›´åˆ°è·å–é”åè¿”å›\n        else if (++retries &gt; MAX_SCAN_RETRIES) &#123;\n            lock();\n            break;\n        &#125;\n        else if ((retries &amp; 1) &#x3D;&#x3D; 0 &amp;&amp;\n                 &#x2F;&#x2F; è¿™ä¸ªæ—¶å€™æ˜¯æœ‰å¤§é—®é¢˜äº†ï¼Œé‚£å°±æ˜¯æœ‰æ–°çš„å…ƒç´ è¿›åˆ°äº†é“¾è¡¨ï¼Œæˆä¸ºäº†æ–°çš„è¡¨å¤´\n                 &#x2F;&#x2F;     æ‰€ä»¥è¿™è¾¹çš„ç­–ç•¥æ˜¯ï¼Œç›¸å½“äºé‡æ–°èµ°ä¸€éè¿™ä¸ª scanAndLockForPut æ–¹æ³•\n                 (f &#x3D; entryForHash(this, hash)) !&#x3D; first) &#123;\n            e &#x3D; first &#x3D; f; &#x2F;&#x2F; re-traverse if entry changed\n            retries &#x3D; -1;\n        &#125;\n    &#125;\n    return node;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªæ–¹æ³•æœ‰ä¸¤ä¸ªå‡ºå£ï¼Œä¸€ä¸ªæ˜¯ tryLock() æˆåŠŸäº†ï¼Œå¾ªç¯ç»ˆæ­¢ï¼Œå¦ä¸€ä¸ªå°±æ˜¯é‡è¯•æ¬¡æ•°è¶…è¿‡äº† MAX_SCAN_RETRIESï¼Œè¿›åˆ° lock() æ–¹æ³•ï¼Œæ­¤æ–¹æ³•ä¼šé˜»å¡ç­‰å¾…ï¼Œç›´åˆ°æˆåŠŸæ‹¿åˆ°ç‹¬å é”ã€‚</p>\n<p>è¿™ä¸ªæ–¹æ³•å°±æ˜¯çœ‹ä¼¼å¤æ‚ï¼Œä½†æ˜¯å…¶å®å°±æ˜¯åšäº†ä¸€ä»¶äº‹ï¼Œé‚£å°±æ˜¯<strong>è·å–è¯¥ segment çš„ç‹¬å é”</strong>ï¼Œå¦‚æœéœ€è¦çš„è¯é¡ºä¾¿å®ä¾‹åŒ–äº†ä¸€ä¸‹ nodeã€‚</p>\n<h6 id=\"æ‰©å®¹-rehash\"><a href=\"#æ‰©å®¹-rehash\" class=\"headerlink\" title=\"æ‰©å®¹: rehash\"></a>æ‰©å®¹: rehash</h6><p>é‡å¤ä¸€ä¸‹ï¼Œsegment æ•°ç»„ä¸èƒ½æ‰©å®¹ï¼Œæ‰©å®¹æ˜¯ segment æ•°ç»„æŸä¸ªä½ç½®å†…éƒ¨çš„æ•°ç»„ HashEntry[] è¿›è¡Œæ‰©å®¹ï¼Œæ‰©å®¹åï¼Œå®¹é‡ä¸ºåŸæ¥çš„ 2 å€ã€‚</p>\n<p>é¦–å…ˆï¼Œæˆ‘ä»¬è¦å›é¡¾ä¸€ä¸‹è§¦å‘æ‰©å®¹çš„åœ°æ–¹ï¼Œput çš„æ—¶å€™ï¼Œå¦‚æœåˆ¤æ–­è¯¥å€¼çš„æ’å…¥ä¼šå¯¼è‡´è¯¥ segment çš„å…ƒç´ ä¸ªæ•°è¶…è¿‡é˜ˆå€¼ï¼Œé‚£ä¹ˆå…ˆè¿›è¡Œæ‰©å®¹ï¼Œå†æ’å€¼ï¼Œè¯»è€…è¿™ä¸ªæ—¶å€™å¯ä»¥å›å» put æ–¹æ³•çœ‹ä¸€çœ¼ã€‚</p>\n<p>è¯¥æ–¹æ³•ä¸éœ€è¦è€ƒè™‘å¹¶å‘ï¼Œå› ä¸ºåˆ°è¿™é‡Œçš„æ—¶å€™ï¼Œæ˜¯æŒæœ‰è¯¥ segment çš„ç‹¬å é”çš„ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; æ–¹æ³•å‚æ•°ä¸Šçš„ node æ˜¯è¿™æ¬¡æ‰©å®¹åï¼Œéœ€è¦æ·»åŠ åˆ°æ–°çš„æ•°ç»„ä¸­çš„æ•°æ®ã€‚\nprivate void rehash(HashEntry&lt;K,V&gt; node) &#123;\n    HashEntry&lt;K,V&gt;[] oldTable &#x3D; table;\n    int oldCapacity &#x3D; oldTable.length;\n    &#x2F;&#x2F; 2 å€\n    int newCapacity &#x3D; oldCapacity &lt;&lt; 1;\n    threshold &#x3D; (int)(newCapacity * loadFactor);\n    &#x2F;&#x2F; åˆ›å»ºæ–°æ•°ç»„\n    HashEntry&lt;K,V&gt;[] newTable &#x3D;\n        (HashEntry&lt;K,V&gt;[]) new HashEntry[newCapacity];\n    &#x2F;&#x2F; æ–°çš„æ©ç ï¼Œå¦‚ä» 16 æ‰©å®¹åˆ° 32ï¼Œé‚£ä¹ˆ sizeMask ä¸º 31ï¼Œå¯¹åº”äºŒè¿›åˆ¶ â€˜000...00011111â€™\n    int sizeMask &#x3D; newCapacity - 1;\n \n    &#x2F;&#x2F; éå†åŸæ•°ç»„ï¼Œè€å¥—è·¯ï¼Œå°†åŸæ•°ç»„ä½ç½® i å¤„çš„é“¾è¡¨æ‹†åˆ†åˆ° æ–°æ•°ç»„ä½ç½® i å’Œ i+oldCap ä¸¤ä¸ªä½ç½®\n    for (int i &#x3D; 0; i &lt; oldCapacity ; i++) &#123;\n        &#x2F;&#x2F; e æ˜¯é“¾è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ \n        HashEntry&lt;K,V&gt; e &#x3D; oldTable[i];\n        if (e !&#x3D; null) &#123;\n            HashEntry&lt;K,V&gt; next &#x3D; e.next;\n            &#x2F;&#x2F; è®¡ç®—åº”è¯¥æ”¾ç½®åœ¨æ–°æ•°ç»„ä¸­çš„ä½ç½®ï¼Œ\n            &#x2F;&#x2F; å‡è®¾åŸæ•°ç»„é•¿åº¦ä¸º 16ï¼Œe åœ¨ oldTable[3] å¤„ï¼Œé‚£ä¹ˆ idx åªå¯èƒ½æ˜¯ 3 æˆ–è€…æ˜¯ 3 + 16 &#x3D; 19\n            int idx &#x3D; e.hash &amp; sizeMask;\n            if (next &#x3D;&#x3D; null)   &#x2F;&#x2F; è¯¥ä½ç½®å¤„åªæœ‰ä¸€ä¸ªå…ƒç´ ï¼Œé‚£æ¯”è¾ƒå¥½åŠ\n                newTable[idx] &#x3D; e;\n            else &#123; &#x2F;&#x2F; Reuse consecutive sequence at same slot\n                &#x2F;&#x2F; e æ˜¯é“¾è¡¨è¡¨å¤´\n                HashEntry&lt;K,V&gt; lastRun &#x3D; e;\n                &#x2F;&#x2F; idx æ˜¯å½“å‰é“¾è¡¨çš„å¤´ç»“ç‚¹ e çš„æ–°ä½ç½®\n                int lastIdx &#x3D; idx;\n \n                &#x2F;&#x2F; ä¸‹é¢è¿™ä¸ª for å¾ªç¯ä¼šæ‰¾åˆ°ä¸€ä¸ª lastRun èŠ‚ç‚¹ï¼Œè¿™ä¸ªèŠ‚ç‚¹ä¹‹åçš„æ‰€æœ‰å…ƒç´ æ˜¯å°†è¦æ”¾åˆ°ä¸€èµ·çš„\n                for (HashEntry&lt;K,V&gt; last &#x3D; next;\n                     last !&#x3D; null;\n                     last &#x3D; last.next) &#123;\n                    int k &#x3D; last.hash &amp; sizeMask;\n                    if (k !&#x3D; lastIdx) &#123;\n                        lastIdx &#x3D; k;\n                        lastRun &#x3D; last;\n                    &#125;\n                &#125;\n                &#x2F;&#x2F; å°† lastRun åŠå…¶ä¹‹åçš„æ‰€æœ‰èŠ‚ç‚¹ç»„æˆçš„è¿™ä¸ªé“¾è¡¨æ”¾åˆ° lastIdx è¿™ä¸ªä½ç½®\n                newTable[lastIdx] &#x3D; lastRun;\n                &#x2F;&#x2F; ä¸‹é¢çš„æ“ä½œæ˜¯å¤„ç† lastRun ä¹‹å‰çš„èŠ‚ç‚¹ï¼Œ\n                &#x2F;&#x2F;    è¿™äº›èŠ‚ç‚¹å¯èƒ½åˆ†é…åœ¨å¦ä¸€ä¸ªé“¾è¡¨ä¸­ï¼Œä¹Ÿå¯èƒ½åˆ†é…åˆ°ä¸Šé¢çš„é‚£ä¸ªé“¾è¡¨ä¸­\n                for (HashEntry&lt;K,V&gt; p &#x3D; e; p !&#x3D; lastRun; p &#x3D; p.next) &#123;\n                    V v &#x3D; p.value;\n                    int h &#x3D; p.hash;\n                    int k &#x3D; h &amp; sizeMask;\n                    HashEntry&lt;K,V&gt; n &#x3D; newTable[k];\n                    newTable[k] &#x3D; new HashEntry&lt;K,V&gt;(h, p.key, v, n);\n                &#125;\n            &#125;\n        &#125;\n    &#125;\n    &#x2F;&#x2F; å°†æ–°æ¥çš„ node æ”¾åˆ°æ–°æ•°ç»„ä¸­åˆšåˆšçš„ ä¸¤ä¸ªé“¾è¡¨ä¹‹ä¸€ çš„ å¤´éƒ¨\n    int nodeIndex &#x3D; node.hash &amp; sizeMask; &#x2F;&#x2F; add the new node\n    node.setNext(newTable[nodeIndex]);\n    newTable[nodeIndex] &#x3D; node;\n    table &#x3D; newTable;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™é‡Œçš„æ‰©å®¹æ¯”ä¹‹å‰çš„ HashMap è¦å¤æ‚ä¸€äº›ï¼Œä»£ç éš¾æ‡‚ä¸€ç‚¹ã€‚ä¸Šé¢æœ‰ä¸¤ä¸ªæŒ¨ç€çš„ for å¾ªç¯ï¼Œç¬¬ä¸€ä¸ª for æœ‰ä»€ä¹ˆç”¨å‘¢ï¼Ÿ</p>\n<p>ä»”ç»†ä¸€çœ‹å‘ç°ï¼Œå¦‚æœæ²¡æœ‰ç¬¬ä¸€ä¸ª for å¾ªç¯ï¼Œä¹Ÿæ˜¯å¯ä»¥å·¥ä½œçš„ï¼Œä½†æ˜¯ï¼Œè¿™ä¸ª for å¾ªç¯ä¸‹æ¥ï¼Œå¦‚æœ lastRun çš„åé¢è¿˜æœ‰æ¯”è¾ƒå¤šçš„èŠ‚ç‚¹ï¼Œé‚£ä¹ˆè¿™æ¬¡å°±æ˜¯å€¼å¾—çš„ã€‚å› ä¸ºæˆ‘ä»¬åªéœ€è¦å…‹éš† lastRun å‰é¢çš„èŠ‚ç‚¹ï¼Œåé¢çš„ä¸€ä¸²èŠ‚ç‚¹è·Ÿç€ lastRun èµ°å°±æ˜¯äº†ï¼Œä¸éœ€è¦åšä»»ä½•æ“ä½œã€‚</p>\n<p>æˆ‘è§‰å¾— Doug Lea çš„è¿™ä¸ªæƒ³æ³•ä¹Ÿæ˜¯æŒºæœ‰æ„æ€çš„ï¼Œä¸è¿‡æ¯”è¾ƒåçš„æƒ…å†µå°±æ˜¯æ¯æ¬¡ lastRun éƒ½æ˜¯é“¾è¡¨çš„æœ€åä¸€ä¸ªå…ƒç´ æˆ–è€…å¾ˆé åçš„å…ƒç´ ï¼Œé‚£ä¹ˆè¿™æ¬¡éå†å°±æœ‰ç‚¹æµªè´¹äº†ã€‚<strong>ä¸è¿‡ Doug Lea ä¹Ÿè¯´äº†ï¼Œæ ¹æ®ç»Ÿè®¡ï¼Œå¦‚æœä½¿ç”¨é»˜è®¤çš„é˜ˆå€¼ï¼Œå¤§çº¦åªæœ‰ 1&#x2F;6 çš„èŠ‚ç‚¹éœ€è¦å…‹éš†ã€‚</strong></p>\n<h4 id=\"get-è¿‡ç¨‹åˆ†æ-1\"><a href=\"#get-è¿‡ç¨‹åˆ†æ-1\" class=\"headerlink\" title=\"get è¿‡ç¨‹åˆ†æ\"></a>get è¿‡ç¨‹åˆ†æ</h4><p>ç›¸å¯¹äº put æ¥è¯´ï¼Œget çœŸçš„ä¸è¦å¤ªç®€å•ã€‚</p>\n<ol>\n<li>è®¡ç®— hash å€¼ï¼Œæ‰¾åˆ° segment æ•°ç»„ä¸­çš„å…·ä½“ä½ç½®ï¼Œæˆ–æˆ‘ä»¬å‰é¢ç”¨çš„â€œæ§½â€</li>\n<li>æ§½ä¸­ä¹Ÿæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ ¹æ® hash æ‰¾åˆ°æ•°ç»„ä¸­å…·ä½“çš„ä½ç½®</li>\n<li>åˆ°è¿™é‡Œæ˜¯é“¾è¡¨äº†ï¼Œé¡ºç€é“¾è¡¨è¿›è¡ŒæŸ¥æ‰¾å³å¯</li>\n</ol>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public V get(Object key) &#123;\n    Segment&lt;K,V&gt; s; &#x2F;&#x2F; manually integrate access methods to reduce overhead\n    HashEntry&lt;K,V&gt;[] tab;\n    &#x2F;&#x2F; 1. hash å€¼\n    int h &#x3D; hash(key);\n    long u &#x3D; (((h &gt;&gt;&gt; segmentShift) &amp; segmentMask) &lt;&lt; SSHIFT) + SBASE;\n    &#x2F;&#x2F; 2. æ ¹æ® hash æ‰¾åˆ°å¯¹åº”çš„ segment\n    if ((s &#x3D; (Segment&lt;K,V&gt;)UNSAFE.getObjectVolatile(segments, u)) !&#x3D; null &amp;&amp;\n        (tab &#x3D; s.table) !&#x3D; null) &#123;\n        &#x2F;&#x2F; 3. æ‰¾åˆ°segment å†…éƒ¨æ•°ç»„ç›¸åº”ä½ç½®çš„é“¾è¡¨ï¼Œéå†\n        for (HashEntry&lt;K,V&gt; e &#x3D; (HashEntry&lt;K,V&gt;) UNSAFE.getObjectVolatile\n                 (tab, ((long)(((tab.length - 1) &amp; h)) &lt;&lt; TSHIFT) + TBASE);\n             e !&#x3D; null; e &#x3D; e.next) &#123;\n            K k;\n            if ((k &#x3D; e.key) &#x3D;&#x3D; key || (e.hash &#x3D;&#x3D; h &amp;&amp; key.equals(k)))\n                return e.value;\n        &#125;\n    &#125;\n    return null;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"å¹¶å‘é—®é¢˜åˆ†æ\"><a href=\"#å¹¶å‘é—®é¢˜åˆ†æ\" class=\"headerlink\" title=\"å¹¶å‘é—®é¢˜åˆ†æ\"></a>å¹¶å‘é—®é¢˜åˆ†æ</h4><p>ç°åœ¨æˆ‘ä»¬å·²ç»è¯´å®Œäº† put è¿‡ç¨‹å’Œ get è¿‡ç¨‹ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° get è¿‡ç¨‹ä¸­æ˜¯æ²¡æœ‰åŠ é”çš„ï¼Œé‚£è‡ªç„¶æˆ‘ä»¬å°±éœ€è¦å»è€ƒè™‘å¹¶å‘é—®é¢˜ã€‚</p>\n<p>æ·»åŠ èŠ‚ç‚¹çš„æ“ä½œ put å’Œåˆ é™¤èŠ‚ç‚¹çš„æ“ä½œ remove éƒ½æ˜¯è¦åŠ  segment ä¸Šçš„ç‹¬å é”çš„ï¼Œæ‰€ä»¥å®ƒä»¬ä¹‹é—´è‡ªç„¶ä¸ä¼šæœ‰é—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦è€ƒè™‘çš„é—®é¢˜å°±æ˜¯ get çš„æ—¶å€™åœ¨åŒä¸€ä¸ª segment ä¸­å‘ç”Ÿäº† put æˆ– remove æ“ä½œã€‚æ¨èé˜…è¯»ï¼š<a href=\"https://mp.weixin.qq.com/s/Q5F604CUM_0x2co9mvADxw\">30 ä¸ª Java é›†åˆé¢è¯•é—®é¢˜åŠç­”æ¡ˆ</a>ã€‚</p>\n<ul>\n<li><strong>put æ“ä½œçš„çº¿ç¨‹å®‰å…¨æ€§</strong></li>\n</ul>\n<ol>\n<li>åˆå§‹åŒ–æ§½ï¼Œè¿™ä¸ªæˆ‘ä»¬ä¹‹å‰å°±è¯´è¿‡äº†ï¼Œä½¿ç”¨äº† CAS æ¥åˆå§‹åŒ– Segment ä¸­çš„æ•°ç»„ã€‚</li>\n<li>æ·»åŠ èŠ‚ç‚¹åˆ°é“¾è¡¨çš„æ“ä½œæ˜¯æ’å…¥åˆ°è¡¨å¤´çš„ï¼Œæ‰€ä»¥ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™ get æ“ä½œåœ¨é“¾è¡¨éå†çš„è¿‡ç¨‹å·²ç»åˆ°äº†ä¸­é—´ï¼Œæ˜¯ä¸ä¼šå½±å“çš„ã€‚å½“ç„¶ï¼Œå¦ä¸€ä¸ªå¹¶å‘é—®é¢˜å°±æ˜¯ get æ“ä½œåœ¨ put ä¹‹åï¼Œéœ€è¦ä¿è¯åˆšåˆšæ’å…¥è¡¨å¤´çš„èŠ‚ç‚¹è¢«è¯»å–ï¼Œè¿™ä¸ªä¾èµ–äº setEntryAt æ–¹æ³•ä¸­ä½¿ç”¨çš„ UNSAFE.putOrderedObjectã€‚</li>\n<li>æ‰©å®¹ã€‚æ‰©å®¹æ˜¯æ–°åˆ›å»ºäº†æ•°ç»„ï¼Œç„¶åè¿›è¡Œè¿ç§»æ•°æ®ï¼Œæœ€åé¢å°† newTable è®¾ç½®ç»™å±æ€§ tableã€‚æ‰€ä»¥ï¼Œå¦‚æœ get æ“ä½œæ­¤æ—¶ä¹Ÿåœ¨è¿›è¡Œï¼Œé‚£ä¹ˆä¹Ÿæ²¡å…³ç³»ï¼Œå¦‚æœ get å…ˆè¡Œï¼Œé‚£ä¹ˆå°±æ˜¯åœ¨æ—§çš„ table ä¸ŠåšæŸ¥è¯¢æ“ä½œï¼›è€Œ put å…ˆè¡Œï¼Œé‚£ä¹ˆ put æ“ä½œçš„å¯è§æ€§ä¿è¯å°±æ˜¯ table ä½¿ç”¨äº† volatile å…³é”®å­—ã€‚</li>\n</ol>\n<ul>\n<li><strong>remove æ“ä½œçš„çº¿ç¨‹å®‰å…¨æ€§</strong></li>\n</ul>\n<p>remove æ“ä½œæˆ‘ä»¬æ²¡æœ‰åˆ†ææºç ï¼Œæ‰€ä»¥è¿™é‡Œè¯´çš„è¯»è€…æ„Ÿå…´è¶£çš„è¯è¿˜æ˜¯éœ€è¦åˆ°æºç ä¸­å»æ±‚å®ä¸€ä¸‹çš„ã€‚</p>\n<p>get æ“ä½œéœ€è¦éå†é“¾è¡¨ï¼Œä½†æ˜¯ remove æ“ä½œä¼šâ€ç ´åâ€é“¾è¡¨ã€‚</p>\n<p>å¦‚æœ remove ç ´åçš„èŠ‚ç‚¹ get æ“ä½œå·²ç»è¿‡å»äº†ï¼Œé‚£ä¹ˆè¿™é‡Œä¸å­˜åœ¨ä»»ä½•é—®é¢˜ã€‚</p>\n<p>å¦‚æœ remove å…ˆç ´åäº†ä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆ†ä¸¤ç§æƒ…å†µè€ƒè™‘ã€‚</p>\n<p>1ã€å¦‚æœæ­¤èŠ‚ç‚¹æ˜¯å¤´ç»“ç‚¹ï¼Œé‚£ä¹ˆéœ€è¦å°†å¤´ç»“ç‚¹çš„ next è®¾ç½®ä¸ºæ•°ç»„è¯¥ä½ç½®çš„å…ƒç´ ï¼Œtable è™½ç„¶ä½¿ç”¨äº† volatile ä¿®é¥°ï¼Œä½†æ˜¯ volatile å¹¶ä¸èƒ½æä¾›æ•°ç»„å†…éƒ¨æ“ä½œçš„å¯è§æ€§ä¿è¯ï¼Œæ‰€ä»¥æºç ä¸­ä½¿ç”¨äº† UNSAFE æ¥æ“ä½œæ•°ç»„ï¼Œè¯·çœ‹æ–¹æ³• setEntryAtã€‚</p>\n<p>2ã€å¦‚æœè¦åˆ é™¤çš„èŠ‚ç‚¹ä¸æ˜¯å¤´ç»“ç‚¹ï¼Œå®ƒä¼šå°†è¦åˆ é™¤èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹æ¥åˆ°å‰é©±èŠ‚ç‚¹ä¸­ï¼Œè¿™é‡Œçš„å¹¶å‘ä¿è¯å°±æ˜¯ next å±æ€§æ˜¯ volatile çš„ã€‚æ¨èé˜…è¯»ï¼š<a href=\"https://mp.weixin.qq.com/s/0CI9od4DIxRrmOGFJw0SuQ\">å²ä¸Šæœ€å…¨ Java å¤šçº¿ç¨‹é¢è¯•é¢˜åŠç­”æ¡ˆ</a>ã€‚</p>\n<h2 id=\"Java8-HashMap\"><a href=\"#Java8-HashMap\" class=\"headerlink\" title=\"Java8 HashMap\"></a>Java8 HashMap</h2><p>Java8 å¯¹ HashMap è¿›è¡Œäº†ä¸€äº›ä¿®æ”¹ï¼Œæœ€å¤§çš„ä¸åŒå°±æ˜¯åˆ©ç”¨äº†çº¢é»‘æ ‘ï¼Œæ‰€ä»¥å…¶ç”± <strong>æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘</strong> ç»„æˆã€‚</p>\n<p>æ ¹æ® Java7 HashMap çš„ä»‹ç»ï¼Œæˆ‘ä»¬çŸ¥é“ï¼ŒæŸ¥æ‰¾çš„æ—¶å€™ï¼Œæ ¹æ® hash å€¼æˆ‘ä»¬èƒ½å¤Ÿå¿«é€Ÿå®šä½åˆ°æ•°ç»„çš„å…·ä½“ä¸‹æ ‡ï¼Œä½†æ˜¯ä¹‹åçš„è¯ï¼Œéœ€è¦é¡ºç€é“¾è¡¨ä¸€ä¸ªä¸ªæ¯”è¾ƒä¸‹å»æ‰èƒ½æ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„ï¼Œæ—¶é—´å¤æ‚åº¦å–å†³äºé“¾è¡¨çš„é•¿åº¦ï¼Œä¸º **O(n)**ã€‚</p>\n<p>ä¸ºäº†é™ä½è¿™éƒ¨åˆ†çš„å¼€é”€ï¼Œåœ¨ Java8 ä¸­ï¼Œå½“é“¾è¡¨ä¸­çš„å…ƒç´ è¶…è¿‡äº† 8 ä¸ªä»¥åï¼Œä¼šå°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œåœ¨è¿™äº›ä½ç½®è¿›è¡ŒæŸ¥æ‰¾çš„æ—¶å€™å¯ä»¥é™ä½æ—¶é—´å¤æ‚åº¦ä¸º O(logN)ã€‚</p>\n<p>æ¥ä¸€å¼ å›¾ç®€å•ç¤ºæ„ä¸€ä¸‹å§ï¼š</p>\n<p><img src=\"http://qianniu.javastack.cn/18-12-4/75398751.jpg\"></p>\n<blockquote>\n<p>æ³¨æ„ï¼Œä¸Šå›¾æ˜¯ç¤ºæ„å›¾ï¼Œä¸»è¦æ˜¯æè¿°ç»“æ„ï¼Œä¸ä¼šè¾¾åˆ°è¿™ä¸ªçŠ¶æ€çš„ï¼Œå› ä¸ºè¿™ä¹ˆå¤šæ•°æ®çš„æ—¶å€™æ—©å°±æ‰©å®¹äº†ã€‚</p>\n</blockquote>\n<p>ä¸‹é¢ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç”¨ä»£ç æ¥ä»‹ç»å§ï¼Œä¸ªäººæ„Ÿè§‰ï¼ŒJava8 çš„æºç å¯è¯»æ€§è¦å·®ä¸€äº›ï¼Œä¸è¿‡ç²¾ç®€ä¸€äº›ã€‚</p>\n<p>Java7 ä¸­ä½¿ç”¨ Entry æ¥ä»£è¡¨æ¯ä¸ª HashMap ä¸­çš„æ•°æ®èŠ‚ç‚¹ï¼ŒJava8 ä¸­ä½¿ç”¨ <strong>Node</strong>ï¼ŒåŸºæœ¬æ²¡æœ‰åŒºåˆ«ï¼Œéƒ½æ˜¯ keyï¼Œvalueï¼Œhash å’Œ next è¿™å››ä¸ªå±æ€§ï¼Œä¸è¿‡ï¼ŒNode åªèƒ½ç”¨äºé“¾è¡¨çš„æƒ…å†µï¼Œçº¢é»‘æ ‘çš„æƒ…å†µéœ€è¦ä½¿ç”¨ <strong>TreeNode</strong>ã€‚</p>\n<p>æˆ‘ä»¬æ ¹æ®æ•°ç»„å…ƒç´ ä¸­ï¼Œç¬¬ä¸€ä¸ªèŠ‚ç‚¹æ•°æ®ç±»å‹æ˜¯ Node è¿˜æ˜¯ TreeNode æ¥åˆ¤æ–­è¯¥ä½ç½®ä¸‹æ˜¯é“¾è¡¨è¿˜æ˜¯çº¢é»‘æ ‘çš„ã€‚æ¨èé˜…è¯»ï¼š<a href=\"https://mp.weixin.qq.com/s/Q5F604CUM_0x2co9mvADxw\">30 ä¸ª Java é›†åˆé¢è¯•é—®é¢˜åŠç­”æ¡ˆ</a>ã€‚</p>\n<h4 id=\"put-è¿‡ç¨‹åˆ†æ-2\"><a href=\"#put-è¿‡ç¨‹åˆ†æ-2\" class=\"headerlink\" title=\"put è¿‡ç¨‹åˆ†æ\"></a>put è¿‡ç¨‹åˆ†æ</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">public V put(K key, V value) &#123;\n    return putVal(hash(key), key, value, false, true);\n&#125;\n \n&#x2F;&#x2F; ç¬¬ä¸‰ä¸ªå‚æ•° onlyIfAbsent å¦‚æœæ˜¯ trueï¼Œé‚£ä¹ˆåªæœ‰åœ¨ä¸å­˜åœ¨è¯¥ key æ—¶æ‰ä¼šè¿›è¡Œ put æ“ä½œ\n&#x2F;&#x2F; ç¬¬å››ä¸ªå‚æ•° evict æˆ‘ä»¬è¿™é‡Œä¸å…³å¿ƒ\nfinal V putVal(int hash, K key, V value, boolean onlyIfAbsent,\n               boolean evict) &#123;\n    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; p; int n, i;\n    &#x2F;&#x2F; ç¬¬ä¸€æ¬¡ put å€¼çš„æ—¶å€™ï¼Œä¼šè§¦å‘ä¸‹é¢çš„ resize()ï¼Œç±»ä¼¼ java7 çš„ç¬¬ä¸€æ¬¡ put ä¹Ÿè¦åˆå§‹åŒ–æ•°ç»„é•¿åº¦\n    &#x2F;&#x2F; ç¬¬ä¸€æ¬¡ resize å’Œåç»­çš„æ‰©å®¹æœ‰äº›ä¸ä¸€æ ·ï¼Œå› ä¸ºè¿™æ¬¡æ˜¯æ•°ç»„ä» null åˆå§‹åŒ–åˆ°é»˜è®¤çš„ 16 æˆ–è‡ªå®šä¹‰çš„åˆå§‹å®¹é‡\n    if ((tab &#x3D; table) &#x3D;&#x3D; null || (n &#x3D; tab.length) &#x3D;&#x3D; 0)\n        n &#x3D; (tab &#x3D; resize()).length;\n    &#x2F;&#x2F; æ‰¾åˆ°å…·ä½“çš„æ•°ç»„ä¸‹æ ‡ï¼Œå¦‚æœæ­¤ä½ç½®æ²¡æœ‰å€¼ï¼Œé‚£ä¹ˆç›´æ¥åˆå§‹åŒ–ä¸€ä¸‹ Node å¹¶æ”¾ç½®åœ¨è¿™ä¸ªä½ç½®å°±å¯ä»¥äº†\n    if ((p &#x3D; tab[i &#x3D; (n - 1) &amp; hash]) &#x3D;&#x3D; null)\n        tab[i] &#x3D; newNode(hash, key, value, null);\n \n    else &#123;&#x2F;&#x2F; æ•°ç»„è¯¥ä½ç½®æœ‰æ•°æ®\n        Node&lt;K,V&gt; e; K k;\n        &#x2F;&#x2F; é¦–å…ˆï¼Œåˆ¤æ–­è¯¥ä½ç½®çš„ç¬¬ä¸€ä¸ªæ•°æ®å’Œæˆ‘ä»¬è¦æ’å…¥çš„æ•°æ®ï¼Œkey æ˜¯ä¸æ˜¯&quot;ç›¸ç­‰&quot;ï¼Œå¦‚æœæ˜¯ï¼Œå–å‡ºè¿™ä¸ªèŠ‚ç‚¹\n        if (p.hash &#x3D;&#x3D; hash &amp;&amp;\n            ((k &#x3D; p.key) &#x3D;&#x3D; key || (key !&#x3D; null &amp;&amp; key.equals(k))))\n            e &#x3D; p;\n        &#x2F;&#x2F; å¦‚æœè¯¥èŠ‚ç‚¹æ˜¯ä»£è¡¨çº¢é»‘æ ‘çš„èŠ‚ç‚¹ï¼Œè°ƒç”¨çº¢é»‘æ ‘çš„æ’å€¼æ–¹æ³•ï¼Œæœ¬æ–‡ä¸å±•å¼€è¯´çº¢é»‘æ ‘\n        else if (p instanceof TreeNode)\n            e &#x3D; ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value);\n        else &#123;\n            &#x2F;&#x2F; åˆ°è¿™é‡Œï¼Œè¯´æ˜æ•°ç»„è¯¥ä½ç½®ä¸Šæ˜¯ä¸€ä¸ªé“¾è¡¨\n            for (int binCount &#x3D; 0; ; ++binCount) &#123;\n                &#x2F;&#x2F; æ’å…¥åˆ°é“¾è¡¨çš„æœ€åé¢(Java7 æ˜¯æ’å…¥åˆ°é“¾è¡¨çš„æœ€å‰é¢)\n                if ((e &#x3D; p.next) &#x3D;&#x3D; null) &#123;\n                    p.next &#x3D; newNode(hash, key, value, null);\n                    &#x2F;&#x2F; TREEIFY_THRESHOLD ä¸º 8ï¼Œæ‰€ä»¥ï¼Œå¦‚æœæ–°æ’å…¥çš„å€¼æ˜¯é“¾è¡¨ä¸­çš„ç¬¬ 9 ä¸ª\n                    &#x2F;&#x2F; ä¼šè§¦å‘ä¸‹é¢çš„ treeifyBinï¼Œä¹Ÿå°±æ˜¯å°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘\n                    if (binCount &gt;&#x3D; TREEIFY_THRESHOLD - 1) &#x2F;&#x2F; -1 for 1st\n                        treeifyBin(tab, hash);\n                    break;\n                &#125;\n                &#x2F;&#x2F; å¦‚æœåœ¨è¯¥é“¾è¡¨ä¸­æ‰¾åˆ°äº†&quot;ç›¸ç­‰&quot;çš„ key(&#x3D;&#x3D; æˆ– equals)\n                if (e.hash &#x3D;&#x3D; hash &amp;&amp;\n                    ((k &#x3D; e.key) &#x3D;&#x3D; key || (key !&#x3D; null &amp;&amp; key.equals(k))))\n                    &#x2F;&#x2F; æ­¤æ—¶ breakï¼Œé‚£ä¹ˆ e ä¸ºé“¾è¡¨ä¸­[ä¸è¦æ’å…¥çš„æ–°å€¼çš„ key &quot;ç›¸ç­‰&quot;]çš„ node\n                    break;\n                p &#x3D; e;\n            &#125;\n        &#125;\n        &#x2F;&#x2F; e!&#x3D;null è¯´æ˜å­˜åœ¨æ—§å€¼çš„keyä¸è¦æ’å…¥çš„key&quot;ç›¸ç­‰&quot;\n        &#x2F;&#x2F; å¯¹äºæˆ‘ä»¬åˆ†æçš„putæ“ä½œï¼Œä¸‹é¢è¿™ä¸ª if å…¶å®å°±æ˜¯è¿›è¡Œ &quot;å€¼è¦†ç›–&quot;ï¼Œç„¶åè¿”å›æ—§å€¼\n        if (e !&#x3D; null) &#123;\n            V oldValue &#x3D; e.value;\n            if (!onlyIfAbsent || oldValue &#x3D;&#x3D; null)\n                e.value &#x3D; value;\n            afterNodeAccess(e);\n            return oldValue;\n        &#125;\n    &#125;\n    ++modCount;\n    &#x2F;&#x2F; å¦‚æœ HashMap ç”±äºæ–°æ’å…¥è¿™ä¸ªå€¼å¯¼è‡´ size å·²ç»è¶…è¿‡äº†é˜ˆå€¼ï¼Œéœ€è¦è¿›è¡Œæ‰©å®¹\n    if (++size &gt; threshold)\n        resize();\n    afterNodeInsertion(evict);\n    return null;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å’Œ Java7 ç¨å¾®æœ‰ç‚¹ä¸ä¸€æ ·çš„åœ°æ–¹å°±æ˜¯ï¼ŒJava7 æ˜¯å…ˆæ‰©å®¹åæ’å…¥æ–°å€¼çš„ï¼ŒJava8 å…ˆæ’å€¼å†æ‰©å®¹ï¼Œä¸è¿‡è¿™ä¸ªä¸é‡è¦ã€‚</p>\n<h6 id=\"æ•°ç»„æ‰©å®¹-1\"><a href=\"#æ•°ç»„æ‰©å®¹-1\" class=\"headerlink\" title=\"æ•°ç»„æ‰©å®¹\"></a>æ•°ç»„æ‰©å®¹</h6><p>resize() æ–¹æ³•ç”¨äº<strong>åˆå§‹åŒ–æ•°ç»„æˆ–æ•°ç»„æ‰©å®¹</strong>ï¼Œæ¯æ¬¡æ‰©å®¹åï¼Œå®¹é‡ä¸ºåŸæ¥çš„ 2 å€ï¼Œå¹¶è¿›è¡Œæ•°æ®è¿ç§»ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">final Node&lt;K,V&gt;[] resize() &#123;\n    Node&lt;K,V&gt;[] oldTab &#x3D; table;\n    int oldCap &#x3D; (oldTab &#x3D;&#x3D; null) ? 0 : oldTab.length;\n    int oldThr &#x3D; threshold;\n    int newCap, newThr &#x3D; 0;\n    if (oldCap &gt; 0) &#123; &#x2F;&#x2F; å¯¹åº”æ•°ç»„æ‰©å®¹\n        if (oldCap &gt;&#x3D; MAXIMUM_CAPACITY) &#123;\n            threshold &#x3D; Integer.MAX_VALUE;\n            return oldTab;\n        &#125;\n        &#x2F;&#x2F; å°†æ•°ç»„å¤§å°æ‰©å¤§ä¸€å€\n        else if ((newCap &#x3D; oldCap &lt;&lt; 1) &lt; MAXIMUM_CAPACITY &amp;&amp;\n                 oldCap &gt;&#x3D; DEFAULT_INITIAL_CAPACITY)\n            &#x2F;&#x2F; å°†é˜ˆå€¼æ‰©å¤§ä¸€å€\n            newThr &#x3D; oldThr &lt;&lt; 1; &#x2F;&#x2F; double threshold\n    &#125;\n    else if (oldThr &gt; 0) &#x2F;&#x2F; å¯¹åº”ä½¿ç”¨ new HashMap(int initialCapacity) åˆå§‹åŒ–åï¼Œç¬¬ä¸€æ¬¡ put çš„æ—¶å€™\n        newCap &#x3D; oldThr;\n    else &#123;&#x2F;&#x2F; å¯¹åº”ä½¿ç”¨ new HashMap() åˆå§‹åŒ–åï¼Œç¬¬ä¸€æ¬¡ put çš„æ—¶å€™\n        newCap &#x3D; DEFAULT_INITIAL_CAPACITY;\n        newThr &#x3D; (int)(DEFAULT_LOAD_FACTOR * DEFAULT_INITIAL_CAPACITY);\n    &#125;\n \n    if (newThr &#x3D;&#x3D; 0) &#123;\n        float ft &#x3D; (float)newCap * loadFactor;\n        newThr &#x3D; (newCap &lt; MAXIMUM_CAPACITY &amp;&amp; ft &lt; (float)MAXIMUM_CAPACITY ?\n                  (int)ft : Integer.MAX_VALUE);\n    &#125;\n    threshold &#x3D; newThr;\n \n    &#x2F;&#x2F; ç”¨æ–°çš„æ•°ç»„å¤§å°åˆå§‹åŒ–æ–°çš„æ•°ç»„\n    Node&lt;K,V&gt;[] newTab &#x3D; (Node&lt;K,V&gt;[])new Node[newCap];\n    table &#x3D; newTab; &#x2F;&#x2F; å¦‚æœæ˜¯åˆå§‹åŒ–æ•°ç»„ï¼Œåˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼Œè¿”å› newTab å³å¯\n \n    if (oldTab !&#x3D; null) &#123;\n        &#x2F;&#x2F; å¼€å§‹éå†åŸæ•°ç»„ï¼Œè¿›è¡Œæ•°æ®è¿ç§»ã€‚\n        for (int j &#x3D; 0; j &lt; oldCap; ++j) &#123;\n            Node&lt;K,V&gt; e;\n            if ((e &#x3D; oldTab[j]) !&#x3D; null) &#123;\n                oldTab[j] &#x3D; null;\n                &#x2F;&#x2F; å¦‚æœè¯¥æ•°ç»„ä½ç½®ä¸Šåªæœ‰å•ä¸ªå…ƒç´ ï¼Œé‚£å°±ç®€å•äº†ï¼Œç®€å•è¿ç§»è¿™ä¸ªå…ƒç´ å°±å¯ä»¥äº†\n                if (e.next &#x3D;&#x3D; null)\n                    newTab[e.hash &amp; (newCap - 1)] &#x3D; e;\n                &#x2F;&#x2F; å¦‚æœæ˜¯çº¢é»‘æ ‘ï¼Œå…·ä½“æˆ‘ä»¬å°±ä¸å±•å¼€äº†\n                else if (e instanceof TreeNode)\n                    ((TreeNode&lt;K,V&gt;)e).split(this, newTab, j, oldCap);\n                else &#123; \n                    &#x2F;&#x2F; è¿™å—æ˜¯å¤„ç†é“¾è¡¨çš„æƒ…å†µï¼Œ\n                    &#x2F;&#x2F; éœ€è¦å°†æ­¤é“¾è¡¨æ‹†æˆä¸¤ä¸ªé“¾è¡¨ï¼Œæ”¾åˆ°æ–°çš„æ•°ç»„ä¸­ï¼Œå¹¶ä¸”ä¿ç•™åŸæ¥çš„å…ˆåé¡ºåº\n                    &#x2F;&#x2F; loHeadã€loTail å¯¹åº”ä¸€æ¡é“¾è¡¨ï¼ŒhiHeadã€hiTail å¯¹åº”å¦ä¸€æ¡é“¾è¡¨ï¼Œä»£ç è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„\n                    Node&lt;K,V&gt; loHead &#x3D; null, loTail &#x3D; null;\n                    Node&lt;K,V&gt; hiHead &#x3D; null, hiTail &#x3D; null;\n                    Node&lt;K,V&gt; next;\n                    do &#123;\n                        next &#x3D; e.next;\n                        if ((e.hash &amp; oldCap) &#x3D;&#x3D; 0) &#123;\n                            if (loTail &#x3D;&#x3D; null)\n                                loHead &#x3D; e;\n                            else\n                                loTail.next &#x3D; e;\n                            loTail &#x3D; e;\n                        &#125;\n                        else &#123;\n                            if (hiTail &#x3D;&#x3D; null)\n                                hiHead &#x3D; e;\n                            else\n                                hiTail.next &#x3D; e;\n                            hiTail &#x3D; e;\n                        &#125;\n                    &#125; while ((e &#x3D; next) !&#x3D; null);\n                    if (loTail !&#x3D; null) &#123;\n                        loTail.next &#x3D; null;\n                        &#x2F;&#x2F; ç¬¬ä¸€æ¡é“¾è¡¨\n                        newTab[j] &#x3D; loHead;\n                    &#125;\n                    if (hiTail !&#x3D; null) &#123;\n                        hiTail.next &#x3D; null;\n                        &#x2F;&#x2F; ç¬¬äºŒæ¡é“¾è¡¨çš„æ–°çš„ä½ç½®æ˜¯ j + oldCapï¼Œè¿™ä¸ªå¾ˆå¥½ç†è§£\n                        newTab[j + oldCap] &#x3D; hiHead;\n                    &#125;\n                &#125;\n            &#125;\n        &#125;\n    &#125;\n    return newTab;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"get-è¿‡ç¨‹åˆ†æ-2\"><a href=\"#get-è¿‡ç¨‹åˆ†æ-2\" class=\"headerlink\" title=\"get è¿‡ç¨‹åˆ†æ\"></a>get è¿‡ç¨‹åˆ†æ</h4><p>ç›¸å¯¹äº put æ¥è¯´ï¼Œget çœŸçš„å¤ªç®€å•äº†ã€‚</p>\n<ol>\n<li>è®¡ç®— key çš„ hash å€¼ï¼Œæ ¹æ® hash å€¼æ‰¾åˆ°å¯¹åº”æ•°ç»„ä¸‹æ ‡: hash &amp; (length-1)</li>\n<li>åˆ¤æ–­æ•°ç»„è¯¥ä½ç½®å¤„çš„å…ƒç´ æ˜¯å¦åˆšå¥½å°±æ˜¯æˆ‘ä»¬è¦æ‰¾çš„ï¼Œå¦‚æœä¸æ˜¯ï¼Œèµ°ç¬¬ä¸‰æ­¥</li>\n<li>åˆ¤æ–­è¯¥å…ƒç´ ç±»å‹æ˜¯å¦æ˜¯ TreeNodeï¼Œå¦‚æœæ˜¯ï¼Œç”¨çº¢é»‘æ ‘çš„æ–¹æ³•å–æ•°æ®ï¼Œå¦‚æœä¸æ˜¯ï¼Œèµ°ç¬¬å››æ­¥</li>\n<li>éå†é“¾è¡¨ï¼Œç›´åˆ°æ‰¾åˆ°ç›¸ç­‰(&#x3D;&#x3D;æˆ–equals)çš„ key.</li>\n</ol>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public V get(Object key) &#123;\n    Node&lt;K,V&gt; e;\n    return (e &#x3D; getNode(hash(key), key)) &#x3D;&#x3D; null ? null : e.value;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">final Node&lt;K,V&gt; getNode(int hash, Object key) &#123;\n    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; first, e; int n; K k;\n    if ((tab &#x3D; table) !&#x3D; null &amp;&amp; (n &#x3D; tab.length) &gt; 0 &amp;&amp;\n        (first &#x3D; tab[(n - 1) &amp; hash]) !&#x3D; null) &#123;\n        &#x2F;&#x2F; åˆ¤æ–­ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æ˜¯ä¸æ˜¯å°±æ˜¯éœ€è¦çš„\n        if (first.hash &#x3D;&#x3D; hash &amp;&amp; &#x2F;&#x2F; always check first node\n            ((k &#x3D; first.key) &#x3D;&#x3D; key || (key !&#x3D; null &amp;&amp; key.equals(k))))\n            return first;\n        if ((e &#x3D; first.next) !&#x3D; null) &#123;\n            &#x2F;&#x2F; åˆ¤æ–­æ˜¯å¦æ˜¯çº¢é»‘æ ‘\n            if (first instanceof TreeNode)\n                return ((TreeNode&lt;K,V&gt;)first).getTreeNode(hash, key);\n \n            &#x2F;&#x2F; é“¾è¡¨éå†\n            do &#123;\n                if (e.hash &#x3D;&#x3D; hash &amp;&amp;\n                    ((k &#x3D; e.key) &#x3D;&#x3D; key || (key !&#x3D; null &amp;&amp; key.equals(k))))\n                    return e;\n            &#125; while ((e &#x3D; e.next) !&#x3D; null);\n        &#125;\n    &#125;\n    return null;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"Java8-ConcurrentHashMap\"><a href=\"#Java8-ConcurrentHashMap\" class=\"headerlink\" title=\"Java8 ConcurrentHashMap\"></a>Java8 ConcurrentHashMap</h2><p>Java7 ä¸­å®ç°çš„ ConcurrentHashMap è¯´å®è¯è¿˜æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼ŒJava8 å¯¹ ConcurrentHashMap è¿›è¡Œäº†æ¯”è¾ƒå¤§çš„æ”¹åŠ¨ã€‚å»ºè®®è¯»è€…å¯ä»¥å‚è€ƒ Java8 ä¸­ HashMap ç›¸å¯¹äº Java7 HashMap çš„æ”¹åŠ¨ï¼Œå¯¹äº ConcurrentHashMapï¼ŒJava8 ä¹Ÿå¼•å…¥äº†çº¢é»‘æ ‘ã€‚</p>\n<p>è¯´å®è¯ï¼ŒJava8 ConcurrentHashMap æºç çœŸå¿ƒä¸ç®€å•ï¼Œæœ€éš¾çš„åœ¨äºæ‰©å®¹ï¼Œæ•°æ®è¿ç§»æ“ä½œä¸å®¹æ˜“çœ‹æ‡‚ã€‚</p>\n<p>æˆ‘ä»¬å…ˆç”¨ä¸€ä¸ªç¤ºæ„å›¾æ¥æè¿°ä¸‹å…¶ç»“æ„ï¼š</p>\n<p><img src=\"http://qianniu.javastack.cn/18-12-4/335817.jpg\"></p>\n<p>ç»“æ„ä¸Šå’Œ Java8 çš„ HashMap åŸºæœ¬ä¸Šä¸€æ ·ï¼Œä¸è¿‡å®ƒè¦ä¿è¯çº¿ç¨‹å®‰å…¨æ€§ï¼Œæ‰€ä»¥åœ¨æºç ä¸Šç¡®å®è¦å¤æ‚ä¸€äº›ã€‚æ¨èé˜…è¯»ï¼š<a href=\"https://mp.weixin.qq.com/s/5Y5_6qn2g6kIVmQia_0R6g\">å‡ ç§çº¿ç¨‹å®‰å…¨çš„Mapè§£æ</a>ã€‚</p>\n<h4 id=\"åˆå§‹åŒ–-1\"><a href=\"#åˆå§‹åŒ–-1\" class=\"headerlink\" title=\"åˆå§‹åŒ–\"></a>åˆå§‹åŒ–</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; è¿™æ„é€ å‡½æ•°é‡Œï¼Œä»€ä¹ˆéƒ½ä¸å¹²\npublic ConcurrentHashMap() &#123;\n&#125;\npublic ConcurrentHashMap(int initialCapacity) &#123;\n    if (initialCapacity &lt; 0)\n        throw new IllegalArgumentException();\n    int cap &#x3D; ((initialCapacity &gt;&#x3D; (MAXIMUM_CAPACITY &gt;&gt;&gt; 1)) ?\n               MAXIMUM_CAPACITY :\n               tableSizeFor(initialCapacity + (initialCapacity &gt;&gt;&gt; 1) + 1));\n    this.sizeCtl &#x3D; cap;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªåˆå§‹åŒ–æ–¹æ³•æœ‰ç‚¹æ„æ€ï¼Œé€šè¿‡æä¾›åˆå§‹å®¹é‡ï¼Œè®¡ç®—äº† sizeCtlï¼ŒsizeCtl &#x3D; ã€ (1.5 * initialCapacity + 1)ï¼Œç„¶åå‘ä¸Šå–æœ€è¿‘çš„ 2 çš„ n æ¬¡æ–¹ã€‘ã€‚å¦‚ initialCapacity ä¸º 10ï¼Œé‚£ä¹ˆå¾—åˆ° sizeCtl ä¸º 16ï¼Œå¦‚æœ initialCapacity ä¸º 11ï¼Œå¾—åˆ° sizeCtl ä¸º 32ã€‚</p>\n<p>sizeCtl è¿™ä¸ªå±æ€§ä½¿ç”¨çš„åœºæ™¯å¾ˆå¤šï¼Œä¸è¿‡åªè¦è·Ÿç€æ–‡ç« çš„æ€è·¯æ¥ï¼Œå°±ä¸ä¼šè¢«å®ƒææ™•äº†ã€‚</p>\n<p>å¦‚æœä½ çˆ±æŠ˜è…¾ï¼Œä¹Ÿå¯ä»¥çœ‹ä¸‹å¦ä¸€ä¸ªæœ‰ä¸‰ä¸ªå‚æ•°çš„æ„é€ æ–¹æ³•ï¼Œè¿™é‡Œæˆ‘å°±ä¸è¯´äº†ï¼Œå¤§éƒ¨åˆ†æ—¶å€™ï¼Œæˆ‘ä»¬ä¼šä½¿ç”¨æ— å‚æ„é€ å‡½æ•°è¿›è¡Œå®ä¾‹åŒ–ï¼Œæˆ‘ä»¬ä¹ŸæŒ‰ç…§è¿™ä¸ªæ€è·¯æ¥è¿›è¡Œæºç åˆ†æå§ã€‚</p>\n<h4 id=\"put-è¿‡ç¨‹åˆ†æ-3\"><a href=\"#put-è¿‡ç¨‹åˆ†æ-3\" class=\"headerlink\" title=\"put è¿‡ç¨‹åˆ†æ\"></a>put è¿‡ç¨‹åˆ†æ</h4><p>ä»”ç»†åœ°ä¸€è¡Œä¸€è¡Œä»£ç çœ‹ä¸‹å»ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public V put(K key, V value) &#123;\n    return putVal(key, value, false);\n&#125;\nfinal V putVal(K key, V value, boolean onlyIfAbsent) &#123;\n    if (key &#x3D;&#x3D; null || value &#x3D;&#x3D; null) throw new NullPointerException();\n    &#x2F;&#x2F; å¾—åˆ° hash å€¼\n    int hash &#x3D; spread(key.hashCode());\n    &#x2F;&#x2F; ç”¨äºè®°å½•ç›¸åº”é“¾è¡¨çš„é•¿åº¦\n    int binCount &#x3D; 0;\n    for (Node&lt;K,V&gt;[] tab &#x3D; table;;) &#123;\n        Node&lt;K,V&gt; f; int n, i, fh;\n        &#x2F;&#x2F; å¦‚æœæ•°ç»„&quot;ç©º&quot;ï¼Œè¿›è¡Œæ•°ç»„åˆå§‹åŒ–\n        if (tab &#x3D;&#x3D; null || (n &#x3D; tab.length) &#x3D;&#x3D; 0)\n            &#x2F;&#x2F; åˆå§‹åŒ–æ•°ç»„ï¼Œåé¢ä¼šè¯¦ç»†ä»‹ç»\n            tab &#x3D; initTable();\n \n        &#x2F;&#x2F; æ‰¾è¯¥ hash å€¼å¯¹åº”çš„æ•°ç»„ä¸‹æ ‡ï¼Œå¾—åˆ°ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ f\n        else if ((f &#x3D; tabAt(tab, i &#x3D; (n - 1) &amp; hash)) &#x3D;&#x3D; null) &#123;\n            &#x2F;&#x2F; å¦‚æœæ•°ç»„è¯¥ä½ç½®ä¸ºç©ºï¼Œ\n            &#x2F;&#x2F;    ç”¨ä¸€æ¬¡ CAS æ“ä½œå°†è¿™ä¸ªæ–°å€¼æ”¾å…¥å…¶ä¸­å³å¯ï¼Œè¿™ä¸ª put æ“ä½œå·®ä¸å¤šå°±ç»“æŸäº†ï¼Œå¯ä»¥æ‹‰åˆ°æœ€åé¢äº†\n            &#x2F;&#x2F;          å¦‚æœ CAS å¤±è´¥ï¼Œé‚£å°±æ˜¯æœ‰å¹¶å‘æ“ä½œï¼Œè¿›åˆ°ä¸‹ä¸€ä¸ªå¾ªç¯å°±å¥½äº†\n            if (casTabAt(tab, i, null,\n                         new Node&lt;K,V&gt;(hash, key, value, null)))\n                break;                   &#x2F;&#x2F; no lock when adding to empty bin\n        &#125;\n        &#x2F;&#x2F; hash å±…ç„¶å¯ä»¥ç­‰äº MOVEDï¼Œè¿™ä¸ªéœ€è¦åˆ°åé¢æ‰èƒ½çœ‹æ˜ç™½ï¼Œä¸è¿‡ä»åå­—ä¸Šä¹Ÿèƒ½çŒœåˆ°ï¼Œè‚¯å®šæ˜¯å› ä¸ºåœ¨æ‰©å®¹\n        else if ((fh &#x3D; f.hash) &#x3D;&#x3D; MOVED)\n            &#x2F;&#x2F; å¸®åŠ©æ•°æ®è¿ç§»ï¼Œè¿™ä¸ªç­‰åˆ°çœ‹å®Œæ•°æ®è¿ç§»éƒ¨åˆ†çš„ä»‹ç»åï¼Œå†ç†è§£è¿™ä¸ªå°±å¾ˆç®€å•äº†\n            tab &#x3D; helpTransfer(tab, f);\n \n        else &#123; &#x2F;&#x2F; åˆ°è¿™é‡Œå°±æ˜¯è¯´ï¼Œf æ˜¯è¯¥ä½ç½®çš„å¤´ç»“ç‚¹ï¼Œè€Œä¸”ä¸ä¸ºç©º\n \n            V oldVal &#x3D; null;\n            &#x2F;&#x2F; è·å–æ•°ç»„è¯¥ä½ç½®çš„å¤´ç»“ç‚¹çš„ç›‘è§†å™¨é”\n            synchronized (f) &#123;\n                if (tabAt(tab, i) &#x3D;&#x3D; f) &#123;\n                    if (fh &gt;&#x3D; 0) &#123; &#x2F;&#x2F; å¤´ç»“ç‚¹çš„ hash å€¼å¤§äº 0ï¼Œè¯´æ˜æ˜¯é“¾è¡¨\n                        &#x2F;&#x2F; ç”¨äºç´¯åŠ ï¼Œè®°å½•é“¾è¡¨çš„é•¿åº¦\n                        binCount &#x3D; 1;\n                        &#x2F;&#x2F; éå†é“¾è¡¨\n                        for (Node&lt;K,V&gt; e &#x3D; f;; ++binCount) &#123;\n                            K ek;\n                            &#x2F;&#x2F; å¦‚æœå‘ç°äº†&quot;ç›¸ç­‰&quot;çš„ keyï¼Œåˆ¤æ–­æ˜¯å¦è¦è¿›è¡Œå€¼è¦†ç›–ï¼Œç„¶åä¹Ÿå°±å¯ä»¥ break äº†\n                            if (e.hash &#x3D;&#x3D; hash &amp;&amp;\n                                ((ek &#x3D; e.key) &#x3D;&#x3D; key ||\n                                 (ek !&#x3D; null &amp;&amp; key.equals(ek)))) &#123;\n                                oldVal &#x3D; e.val;\n                                if (!onlyIfAbsent)\n                                    e.val &#x3D; value;\n                                break;\n                            &#125;\n                            &#x2F;&#x2F; åˆ°äº†é“¾è¡¨çš„æœ€æœ«ç«¯ï¼Œå°†è¿™ä¸ªæ–°å€¼æ”¾åˆ°é“¾è¡¨çš„æœ€åé¢\n                            Node&lt;K,V&gt; pred &#x3D; e;\n                            if ((e &#x3D; e.next) &#x3D;&#x3D; null) &#123;\n                                pred.next &#x3D; new Node&lt;K,V&gt;(hash, key,\n                                                          value, null);\n                                break;\n                            &#125;\n                        &#125;\n                    &#125;\n                    else if (f instanceof TreeBin) &#123; &#x2F;&#x2F; çº¢é»‘æ ‘\n                        Node&lt;K,V&gt; p;\n                        binCount &#x3D; 2;\n                        &#x2F;&#x2F; è°ƒç”¨çº¢é»‘æ ‘çš„æ’å€¼æ–¹æ³•æ’å…¥æ–°èŠ‚ç‚¹\n                        if ((p &#x3D; ((TreeBin&lt;K,V&gt;)f).putTreeVal(hash, key,\n                                                       value)) !&#x3D; null) &#123;\n                            oldVal &#x3D; p.val;\n                            if (!onlyIfAbsent)\n                                p.val &#x3D; value;\n                        &#125;\n                    &#125;\n                &#125;\n            &#125;\n            &#x2F;&#x2F; binCount !&#x3D; 0 è¯´æ˜ä¸Šé¢åœ¨åšé“¾è¡¨æ“ä½œ\n            if (binCount !&#x3D; 0) &#123;\n                &#x2F;&#x2F; åˆ¤æ–­æ˜¯å¦è¦å°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œä¸´ç•Œå€¼å’Œ HashMap ä¸€æ ·ï¼Œä¹Ÿæ˜¯ 8\n                if (binCount &gt;&#x3D; TREEIFY_THRESHOLD)\n                    &#x2F;&#x2F; è¿™ä¸ªæ–¹æ³•å’Œ HashMap ä¸­ç¨å¾®æœ‰ä¸€ç‚¹ç‚¹ä¸åŒï¼Œé‚£å°±æ˜¯å®ƒä¸æ˜¯ä¸€å®šä¼šè¿›è¡Œçº¢é»‘æ ‘è½¬æ¢ï¼Œ\n                    &#x2F;&#x2F; å¦‚æœå½“å‰æ•°ç»„çš„é•¿åº¦å°äº 64ï¼Œé‚£ä¹ˆä¼šé€‰æ‹©è¿›è¡Œæ•°ç»„æ‰©å®¹ï¼Œè€Œä¸æ˜¯è½¬æ¢ä¸ºçº¢é»‘æ ‘\n                    &#x2F;&#x2F;    å…·ä½“æºç æˆ‘ä»¬å°±ä¸çœ‹äº†ï¼Œæ‰©å®¹éƒ¨åˆ†åé¢è¯´\n                    treeifyBin(tab, i);\n                if (oldVal !&#x3D; null)\n                    return oldVal;\n                break;\n            &#125;\n        &#125;\n    &#125;\n    &#x2F;&#x2F; \n    addCount(1L, binCount);\n    return null;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>put çš„ä¸»æµç¨‹çœ‹å®Œäº†ï¼Œä½†æ˜¯è‡³å°‘ç•™ä¸‹äº†å‡ ä¸ªé—®é¢˜ï¼Œç¬¬ä¸€ä¸ªæ˜¯åˆå§‹åŒ–ï¼Œç¬¬äºŒä¸ªæ˜¯æ‰©å®¹ï¼Œç¬¬ä¸‰ä¸ªæ˜¯å¸®åŠ©æ•°æ®è¿ç§»ï¼Œè¿™äº›æˆ‘ä»¬éƒ½ä¼šåœ¨åé¢è¿›è¡Œä¸€ä¸€ä»‹ç»ã€‚</p>\n<h6 id=\"åˆå§‹åŒ–æ•°ç»„ï¼šinitTable\"><a href=\"#åˆå§‹åŒ–æ•°ç»„ï¼šinitTable\" class=\"headerlink\" title=\"åˆå§‹åŒ–æ•°ç»„ï¼šinitTable\"></a>åˆå§‹åŒ–æ•°ç»„ï¼šinitTable</h6><p>è¿™ä¸ªæ¯”è¾ƒç®€å•ï¼Œä¸»è¦å°±æ˜¯åˆå§‹åŒ–ä¸€ä¸ªåˆé€‚å¤§å°çš„æ•°ç»„ï¼Œç„¶åä¼šè®¾ç½® sizeCtlã€‚</p>\n<p>åˆå§‹åŒ–æ–¹æ³•ä¸­çš„å¹¶å‘é—®é¢˜æ˜¯é€šè¿‡å¯¹ sizeCtl è¿›è¡Œä¸€ä¸ª CAS æ“ä½œæ¥æ§åˆ¶çš„ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private final Node&lt;K,V&gt;[] initTable() &#123;\n    Node&lt;K,V&gt;[] tab; int sc;\n    while ((tab &#x3D; table) &#x3D;&#x3D; null || tab.length &#x3D;&#x3D; 0) &#123;\n        &#x2F;&#x2F; åˆå§‹åŒ–çš„&quot;åŠŸåŠ³&quot;è¢«å…¶ä»–çº¿ç¨‹&quot;æŠ¢å»&quot;äº†\n        if ((sc &#x3D; sizeCtl) &lt; 0)\n            Thread.yield(); &#x2F;&#x2F; lost initialization race; just spin\n        &#x2F;&#x2F; CAS ä¸€ä¸‹ï¼Œå°† sizeCtl è®¾ç½®ä¸º -1ï¼Œä»£è¡¨æŠ¢åˆ°äº†é”\n        else if (U.compareAndSwapInt(this, SIZECTL, sc, -1)) &#123;\n            try &#123;\n                if ((tab &#x3D; table) &#x3D;&#x3D; null || tab.length &#x3D;&#x3D; 0) &#123;\n                    &#x2F;&#x2F; DEFAULT_CAPACITY é»˜è®¤åˆå§‹å®¹é‡æ˜¯ 16\n                    int n &#x3D; (sc &gt; 0) ? sc : DEFAULT_CAPACITY;\n                    &#x2F;&#x2F; åˆå§‹åŒ–æ•°ç»„ï¼Œé•¿åº¦ä¸º 16 æˆ–åˆå§‹åŒ–æ—¶æä¾›çš„é•¿åº¦\n                    Node&lt;K,V&gt;[] nt &#x3D; (Node&lt;K,V&gt;[])new Node&lt;?,?&gt;[n];\n                    &#x2F;&#x2F; å°†è¿™ä¸ªæ•°ç»„èµ‹å€¼ç»™ tableï¼Œtable æ˜¯ volatile çš„\n                    table &#x3D; tab &#x3D; nt;\n                    &#x2F;&#x2F; å¦‚æœ n ä¸º 16 çš„è¯ï¼Œé‚£ä¹ˆè¿™é‡Œ sc &#x3D; 12\n                    &#x2F;&#x2F; å…¶å®å°±æ˜¯ 0.75 * n\n                    sc &#x3D; n - (n &gt;&gt;&gt; 2);\n                &#125;\n            &#125; finally &#123;\n                &#x2F;&#x2F; è®¾ç½® sizeCtl ä¸º scï¼Œæˆ‘ä»¬å°±å½“æ˜¯ 12 å§\n                sizeCtl &#x3D; sc;\n            &#125;\n            break;\n        &#125;\n    &#125;\n    return tab;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h6 id=\"é“¾è¡¨è½¬çº¢é»‘æ ‘-treeifyBin\"><a href=\"#é“¾è¡¨è½¬çº¢é»‘æ ‘-treeifyBin\" class=\"headerlink\" title=\"é“¾è¡¨è½¬çº¢é»‘æ ‘: treeifyBin\"></a>é“¾è¡¨è½¬çº¢é»‘æ ‘: treeifyBin</h6><p>å‰é¢æˆ‘ä»¬åœ¨ put æºç åˆ†æä¹Ÿè¯´è¿‡ï¼ŒtreeifyBin ä¸ä¸€å®šå°±ä¼šè¿›è¡Œçº¢é»‘æ ‘è½¬æ¢ï¼Œä¹Ÿå¯èƒ½æ˜¯ä»…ä»…åšæ•°ç»„æ‰©å®¹ã€‚æˆ‘ä»¬è¿˜æ˜¯è¿›è¡Œæºç åˆ†æå§ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private final void treeifyBin(Node&lt;K,V&gt;[] tab, int index) &#123;\n    Node&lt;K,V&gt; b; int n, sc;\n    if (tab !&#x3D; null) &#123;\n        &#x2F;&#x2F; MIN_TREEIFY_CAPACITY ä¸º 64\n        &#x2F;&#x2F; æ‰€ä»¥ï¼Œå¦‚æœæ•°ç»„é•¿åº¦å°äº 64 çš„æ—¶å€™ï¼Œå…¶å®ä¹Ÿå°±æ˜¯ 32 æˆ–è€… 16 æˆ–è€…æ›´å°çš„æ—¶å€™ï¼Œä¼šè¿›è¡Œæ•°ç»„æ‰©å®¹\n        if ((n &#x3D; tab.length) &lt; MIN_TREEIFY_CAPACITY)\n            &#x2F;&#x2F; åé¢æˆ‘ä»¬å†è¯¦ç»†åˆ†æè¿™ä¸ªæ–¹æ³•\n            tryPresize(n &lt;&lt; 1);\n        &#x2F;&#x2F; b æ˜¯å¤´ç»“ç‚¹\n        else if ((b &#x3D; tabAt(tab, index)) !&#x3D; null &amp;&amp; b.hash &gt;&#x3D; 0) &#123;\n            &#x2F;&#x2F; åŠ é”\n            synchronized (b) &#123;\n \n                if (tabAt(tab, index) &#x3D;&#x3D; b) &#123;\n                    &#x2F;&#x2F; ä¸‹é¢å°±æ˜¯éå†é“¾è¡¨ï¼Œå»ºç«‹ä¸€é¢—çº¢é»‘æ ‘\n                    TreeNode&lt;K,V&gt; hd &#x3D; null, tl &#x3D; null;\n                    for (Node&lt;K,V&gt; e &#x3D; b; e !&#x3D; null; e &#x3D; e.next) &#123;\n                        TreeNode&lt;K,V&gt; p &#x3D;\n                            new TreeNode&lt;K,V&gt;(e.hash, e.key, e.val,\n                                              null, null);\n                        if ((p.prev &#x3D; tl) &#x3D;&#x3D; null)\n                            hd &#x3D; p;\n                        else\n                            tl.next &#x3D; p;\n                        tl &#x3D; p;\n                    &#125;\n                    &#x2F;&#x2F; å°†çº¢é»‘æ ‘è®¾ç½®åˆ°æ•°ç»„ç›¸åº”ä½ç½®ä¸­\n                    setTabAt(tab, index, new TreeBin&lt;K,V&gt;(hd));\n                &#125;\n            &#125;\n        &#125;\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n<h4 id=\"æ‰©å®¹ï¼štryPresize\"><a href=\"#æ‰©å®¹ï¼štryPresize\" class=\"headerlink\" title=\"æ‰©å®¹ï¼štryPresize\"></a>æ‰©å®¹ï¼štryPresize</h4><p>å¦‚æœè¯´ Java8 ConcurrentHashMap çš„æºç ä¸ç®€å•ï¼Œé‚£ä¹ˆè¯´çš„å°±æ˜¯æ‰©å®¹æ“ä½œå’Œè¿ç§»æ“ä½œã€‚</p>\n<p>è¿™ä¸ªæ–¹æ³•è¦å®Œå®Œå…¨å…¨çœ‹æ‡‚è¿˜éœ€è¦çœ‹ä¹‹åçš„ transfer æ–¹æ³•ï¼Œè¯»è€…åº”è¯¥æå‰çŸ¥é“è¿™ç‚¹ã€‚</p>\n<p>è¿™é‡Œçš„æ‰©å®¹ä¹Ÿæ˜¯åšç¿»å€æ‰©å®¹çš„ï¼Œæ‰©å®¹åæ•°ç»„å®¹é‡ä¸ºåŸæ¥çš„ 2 å€ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; é¦–å…ˆè¦è¯´æ˜çš„æ˜¯ï¼Œæ–¹æ³•å‚æ•° size ä¼ è¿›æ¥çš„æ—¶å€™å°±å·²ç»ç¿»äº†å€äº†\nprivate final void tryPresize(int size) &#123;\n    &#x2F;&#x2F; cï¼šsize çš„ 1.5 å€ï¼Œå†åŠ  1ï¼Œå†å¾€ä¸Šå–æœ€è¿‘çš„ 2 çš„ n æ¬¡æ–¹ã€‚\n    int c &#x3D; (size &gt;&#x3D; (MAXIMUM_CAPACITY &gt;&gt;&gt; 1)) ? MAXIMUM_CAPACITY :\n        tableSizeFor(size + (size &gt;&gt;&gt; 1) + 1);\n    int sc;\n    while ((sc &#x3D; sizeCtl) &gt;&#x3D; 0) &#123;\n        Node&lt;K,V&gt;[] tab &#x3D; table; int n;\n \n        &#x2F;&#x2F; è¿™ä¸ª if åˆ†æ”¯å’Œä¹‹å‰è¯´çš„åˆå§‹åŒ–æ•°ç»„çš„ä»£ç åŸºæœ¬ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œåœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯ä»¥ä¸ç”¨ç®¡è¿™å—ä»£ç \n        if (tab &#x3D;&#x3D; null || (n &#x3D; tab.length) &#x3D;&#x3D; 0) &#123;\n            n &#x3D; (sc &gt; c) ? sc : c;\n            if (U.compareAndSwapInt(this, SIZECTL, sc, -1)) &#123;\n                try &#123;\n                    if (table &#x3D;&#x3D; tab) &#123;\n                        @SuppressWarnings(&quot;unchecked&quot;)\n                        Node&lt;K,V&gt;[] nt &#x3D; (Node&lt;K,V&gt;[])new Node&lt;?,?&gt;[n];\n                        table &#x3D; nt;\n                        sc &#x3D; n - (n &gt;&gt;&gt; 2); &#x2F;&#x2F; 0.75 * n\n                    &#125;\n                &#125; finally &#123;\n                    sizeCtl &#x3D; sc;\n                &#125;\n            &#125;\n        &#125;\n        else if (c &lt;&#x3D; sc || n &gt;&#x3D; MAXIMUM_CAPACITY)\n            break;\n        else if (tab &#x3D;&#x3D; table) &#123;\n            &#x2F;&#x2F; æˆ‘æ²¡çœ‹æ‡‚ rs çš„çœŸæ­£å«ä¹‰æ˜¯ä»€ä¹ˆï¼Œä¸è¿‡ä¹Ÿå…³ç³»ä¸å¤§\n            int rs &#x3D; resizeStamp(n);\n \n            if (sc &lt; 0) &#123;\n                Node&lt;K,V&gt;[] nt;\n                if ((sc &gt;&gt;&gt; RESIZE_STAMP_SHIFT) !&#x3D; rs || sc &#x3D;&#x3D; rs + 1 ||\n                    sc &#x3D;&#x3D; rs + MAX_RESIZERS || (nt &#x3D; nextTable) &#x3D;&#x3D; null ||\n                    transferIndex &lt;&#x3D; 0)\n                    break;\n                &#x2F;&#x2F; 2. ç”¨ CAS å°† sizeCtl åŠ  1ï¼Œç„¶åæ‰§è¡Œ transfer æ–¹æ³•\n                &#x2F;&#x2F;    æ­¤æ—¶ nextTab ä¸ä¸º null\n                if (U.compareAndSwapInt(this, SIZECTL, sc, sc + 1))\n                    transfer(tab, nt);\n            &#125;\n            &#x2F;&#x2F; 1. å°† sizeCtl è®¾ç½®ä¸º (rs &lt;&lt; RESIZE_STAMP_SHIFT) + 2)\n            &#x2F;&#x2F;     æˆ‘æ˜¯æ²¡çœ‹æ‡‚è¿™ä¸ªå€¼çœŸæ­£çš„æ„ä¹‰æ˜¯ä»€ä¹ˆï¼Ÿä¸è¿‡å¯ä»¥è®¡ç®—å‡ºæ¥çš„æ˜¯ï¼Œç»“æœæ˜¯ä¸€ä¸ªæ¯”è¾ƒå¤§çš„è´Ÿæ•°\n            &#x2F;&#x2F;  è°ƒç”¨ transfer æ–¹æ³•ï¼Œæ­¤æ—¶ nextTab å‚æ•°ä¸º null\n            else if (U.compareAndSwapInt(this, SIZECTL, sc,\n                                         (rs &lt;&lt; RESIZE_STAMP_SHIFT) + 2))\n                transfer(tab, null);\n        &#125;\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªæ–¹æ³•çš„æ ¸å¿ƒåœ¨äº sizeCtl å€¼çš„æ“ä½œï¼Œé¦–å…ˆå°†å…¶è®¾ç½®ä¸ºä¸€ä¸ªè´Ÿæ•°ï¼Œç„¶åæ‰§è¡Œ transfer(tab, null)ï¼Œå†ä¸‹ä¸€ä¸ªå¾ªç¯å°† sizeCtl åŠ  1ï¼Œå¹¶æ‰§è¡Œ transfer(tab, nt)ï¼Œä¹‹åå¯èƒ½æ˜¯ç»§ç»­ sizeCtl åŠ  1ï¼Œå¹¶æ‰§è¡Œ transfer(tab, nt)ã€‚</p>\n<p>æ‰€ä»¥ï¼Œå¯èƒ½çš„æ“ä½œå°±æ˜¯æ‰§è¡Œ **1 æ¬¡ transfer(tab, null) + å¤šæ¬¡ transfer(tab, nt)**ï¼Œè¿™é‡Œæ€ä¹ˆç»“æŸå¾ªç¯çš„éœ€è¦çœ‹å®Œ transfer æºç æ‰æ¸…æ¥šã€‚æ¨èé˜…è¯»ï¼š<a href=\"https://mp.weixin.qq.com/s/Q5F604CUM_0x2co9mvADxw\">30 ä¸ª Java é›†åˆé¢è¯•é—®é¢˜åŠç­”æ¡ˆ</a>ã€‚</p>\n<h6 id=\"æ•°æ®è¿ç§»ï¼štransfer\"><a href=\"#æ•°æ®è¿ç§»ï¼štransfer\" class=\"headerlink\" title=\"æ•°æ®è¿ç§»ï¼štransfer\"></a>æ•°æ®è¿ç§»ï¼štransfer</h6><p>ä¸‹é¢è¿™ä¸ªæ–¹æ³•å¾ˆç‚¹é•¿ï¼Œå°†åŸæ¥çš„ tab æ•°ç»„çš„å…ƒç´ è¿ç§»åˆ°æ–°çš„ nextTab æ•°ç»„ä¸­ã€‚</p>\n<p>è™½ç„¶æˆ‘ä»¬ä¹‹å‰è¯´çš„ tryPresize æ–¹æ³•ä¸­å¤šæ¬¡è°ƒç”¨ transfer ä¸æ¶‰åŠå¤šçº¿ç¨‹ï¼Œä½†æ˜¯è¿™ä¸ª transfer æ–¹æ³•å¯ä»¥åœ¨å…¶ä»–åœ°æ–¹è¢«è°ƒç”¨ï¼Œå…¸å‹åœ°ï¼Œæˆ‘ä»¬ä¹‹å‰åœ¨è¯´ put æ–¹æ³•çš„æ—¶å€™å°±è¯´è¿‡äº†ï¼Œè¯·å¾€ä¸Šçœ‹ put æ–¹æ³•ï¼Œæ˜¯ä¸æ˜¯æœ‰ä¸ªåœ°æ–¹è°ƒç”¨äº† helpTransfer æ–¹æ³•ï¼ŒhelpTransfer æ–¹æ³•ä¼šè°ƒç”¨ transfer æ–¹æ³•çš„ã€‚</p>\n<p>æ­¤æ–¹æ³•æ”¯æŒå¤šçº¿ç¨‹æ‰§è¡Œï¼Œå¤–å›´è°ƒç”¨æ­¤æ–¹æ³•çš„æ—¶å€™ï¼Œä¼šä¿è¯ç¬¬ä¸€ä¸ªå‘èµ·æ•°æ®è¿ç§»çš„çº¿ç¨‹ï¼ŒnextTab å‚æ•°ä¸º nullï¼Œä¹‹åå†è°ƒç”¨æ­¤æ–¹æ³•çš„æ—¶å€™ï¼ŒnextTab ä¸ä¼šä¸º nullã€‚</p>\n<p>é˜…è¯»æºç ä¹‹å‰ï¼Œå…ˆè¦ç†è§£å¹¶å‘æ“ä½œçš„æœºåˆ¶ã€‚åŸæ•°ç»„é•¿åº¦ä¸º nï¼Œæ‰€ä»¥æˆ‘ä»¬æœ‰ n ä¸ªè¿ç§»ä»»åŠ¡ï¼Œè®©æ¯ä¸ªçº¿ç¨‹æ¯æ¬¡è´Ÿè´£ä¸€ä¸ªå°ä»»åŠ¡æ˜¯æœ€ç®€å•çš„ï¼Œæ¯åšå®Œä¸€ä¸ªä»»åŠ¡å†æ£€æµ‹æ˜¯å¦æœ‰å…¶ä»–æ²¡åšå®Œçš„ä»»åŠ¡ï¼Œå¸®åŠ©è¿ç§»å°±å¯ä»¥äº†ï¼Œè€Œ Doug Lea ä½¿ç”¨äº†ä¸€ä¸ª strideï¼Œç®€å•ç†è§£å°±æ˜¯æ­¥é•¿ï¼Œæ¯ä¸ªçº¿ç¨‹æ¯æ¬¡è´Ÿè´£è¿ç§»å…¶ä¸­çš„ä¸€éƒ¨åˆ†ï¼Œå¦‚æ¯æ¬¡è¿ç§» 16 ä¸ªå°ä»»åŠ¡ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å°±éœ€è¦ä¸€ä¸ªå…¨å±€çš„è°ƒåº¦è€…æ¥å®‰æ’å“ªä¸ªçº¿ç¨‹æ‰§è¡Œå“ªå‡ ä¸ªä»»åŠ¡ï¼Œè¿™ä¸ªå°±æ˜¯å±æ€§ transferIndex çš„ä½œç”¨ã€‚</p>\n<p>ç¬¬ä¸€ä¸ªå‘èµ·æ•°æ®è¿ç§»çš„çº¿ç¨‹ä¼šå°† transferIndex æŒ‡å‘åŸæ•°ç»„æœ€åçš„ä½ç½®ï¼Œç„¶åä»åå¾€å‰çš„ stride ä¸ªä»»åŠ¡å±äºç¬¬ä¸€ä¸ªçº¿ç¨‹ï¼Œç„¶åå°† transferIndex æŒ‡å‘æ–°çš„ä½ç½®ï¼Œå†å¾€å‰çš„ stride ä¸ªä»»åŠ¡å±äºç¬¬äºŒä¸ªçº¿ç¨‹ï¼Œä¾æ­¤ç±»æ¨ã€‚å½“ç„¶ï¼Œè¿™é‡Œè¯´çš„ç¬¬äºŒä¸ªçº¿ç¨‹ä¸æ˜¯çœŸçš„ä¸€å®šæŒ‡ä»£äº†ç¬¬äºŒä¸ªçº¿ç¨‹ï¼Œä¹Ÿå¯ä»¥æ˜¯åŒä¸€ä¸ªçº¿ç¨‹ï¼Œè¿™ä¸ªè¯»è€…åº”è¯¥èƒ½ç†è§£å§ã€‚å…¶å®å°±æ˜¯å°†ä¸€ä¸ªå¤§çš„è¿ç§»ä»»åŠ¡åˆ†ä¸ºäº†ä¸€ä¸ªä¸ªä»»åŠ¡åŒ…ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private final void transfer(Node&lt;K,V&gt;[] tab, Node&lt;K,V&gt;[] nextTab) &#123;\n    int n &#x3D; tab.length, stride;\n \n    &#x2F;&#x2F; stride åœ¨å•æ ¸ä¸‹ç›´æ¥ç­‰äº nï¼Œå¤šæ ¸æ¨¡å¼ä¸‹ä¸º (n&gt;&gt;&gt;3)&#x2F;NCPUï¼Œæœ€å°å€¼æ˜¯ 16\n    &#x2F;&#x2F; stride å¯ä»¥ç†è§£ä¸ºâ€æ­¥é•¿â€œï¼Œæœ‰ n ä¸ªä½ç½®æ˜¯éœ€è¦è¿›è¡Œè¿ç§»çš„ï¼Œ\n    &#x2F;&#x2F;   å°†è¿™ n ä¸ªä»»åŠ¡åˆ†ä¸ºå¤šä¸ªä»»åŠ¡åŒ…ï¼Œæ¯ä¸ªä»»åŠ¡åŒ…æœ‰ stride ä¸ªä»»åŠ¡\n    if ((stride &#x3D; (NCPU &gt; 1) ? (n &gt;&gt;&gt; 3) &#x2F; NCPU : n) &lt; MIN_TRANSFER_STRIDE)\n        stride &#x3D; MIN_TRANSFER_STRIDE; &#x2F;&#x2F; subdivide range\n \n    &#x2F;&#x2F; å¦‚æœ nextTab ä¸º nullï¼Œå…ˆè¿›è¡Œä¸€æ¬¡åˆå§‹åŒ–\n    &#x2F;&#x2F;    å‰é¢æˆ‘ä»¬è¯´äº†ï¼Œå¤–å›´ä¼šä¿è¯ç¬¬ä¸€ä¸ªå‘èµ·è¿ç§»çš„çº¿ç¨‹è°ƒç”¨æ­¤æ–¹æ³•æ—¶ï¼Œå‚æ•° nextTab ä¸º null\n    &#x2F;&#x2F;       ä¹‹åå‚ä¸è¿ç§»çš„çº¿ç¨‹è°ƒç”¨æ­¤æ–¹æ³•æ—¶ï¼ŒnextTab ä¸ä¼šä¸º null\n    if (nextTab &#x3D;&#x3D; null) &#123;\n        try &#123;\n            &#x2F;&#x2F; å®¹é‡ç¿»å€\n            Node&lt;K,V&gt;[] nt &#x3D; (Node&lt;K,V&gt;[])new Node&lt;?,?&gt;[n &lt;&lt; 1];\n            nextTab &#x3D; nt;\n        &#125; catch (Throwable ex) &#123;      &#x2F;&#x2F; try to cope with OOME\n            sizeCtl &#x3D; Integer.MAX_VALUE;\n            return;\n        &#125;\n        &#x2F;&#x2F; nextTable æ˜¯ ConcurrentHashMap ä¸­çš„å±æ€§\n        nextTable &#x3D; nextTab;\n        &#x2F;&#x2F; transferIndex ä¹Ÿæ˜¯ ConcurrentHashMap çš„å±æ€§ï¼Œç”¨äºæ§åˆ¶è¿ç§»çš„ä½ç½®\n        transferIndex &#x3D; n;\n    &#125;\n \n    int nextn &#x3D; nextTab.length;\n \n    &#x2F;&#x2F; ForwardingNode ç¿»è¯‘è¿‡æ¥å°±æ˜¯æ­£åœ¨è¢«è¿ç§»çš„ Node\n    &#x2F;&#x2F; è¿™ä¸ªæ„é€ æ–¹æ³•ä¼šç”Ÿæˆä¸€ä¸ªNodeï¼Œkeyã€value å’Œ next éƒ½ä¸º nullï¼Œå…³é”®æ˜¯ hash ä¸º MOVED\n    &#x2F;&#x2F; åé¢æˆ‘ä»¬ä¼šçœ‹åˆ°ï¼ŒåŸæ•°ç»„ä¸­ä½ç½® i å¤„çš„èŠ‚ç‚¹å®Œæˆè¿ç§»å·¥ä½œåï¼Œ\n    &#x2F;&#x2F;    å°±ä¼šå°†ä½ç½® i å¤„è®¾ç½®ä¸ºè¿™ä¸ª ForwardingNodeï¼Œç”¨æ¥å‘Šè¯‰å…¶ä»–çº¿ç¨‹è¯¥ä½ç½®å·²ç»å¤„ç†è¿‡äº†\n    &#x2F;&#x2F;    æ‰€ä»¥å®ƒå…¶å®ç›¸å½“äºæ˜¯ä¸€ä¸ªæ ‡å¿—ã€‚\n    ForwardingNode&lt;K,V&gt; fwd &#x3D; new ForwardingNode&lt;K,V&gt;(nextTab);\n \n \n    &#x2F;&#x2F; advance æŒ‡çš„æ˜¯åšå®Œäº†ä¸€ä¸ªä½ç½®çš„è¿ç§»å·¥ä½œï¼Œå¯ä»¥å‡†å¤‡åšä¸‹ä¸€ä¸ªä½ç½®çš„äº†\n    boolean advance &#x3D; true;\n    boolean finishing &#x3D; false; &#x2F;&#x2F; to ensure sweep before committing nextTab\n \n    &#x2F;*\n     * ä¸‹é¢è¿™ä¸ª for å¾ªç¯ï¼Œæœ€éš¾ç†è§£çš„åœ¨å‰é¢ï¼Œè€Œè¦çœ‹æ‡‚å®ƒä»¬ï¼Œåº”è¯¥å…ˆçœ‹æ‡‚åé¢çš„ï¼Œç„¶åå†å€’å›æ¥çœ‹\n     * \n     *&#x2F;\n \n    &#x2F;&#x2F; i æ˜¯ä½ç½®ç´¢å¼•ï¼Œbound æ˜¯è¾¹ç•Œï¼Œæ³¨æ„æ˜¯ä»åå¾€å‰\n    for (int i &#x3D; 0, bound &#x3D; 0;;) &#123;\n        Node&lt;K,V&gt; f; int fh;\n \n        &#x2F;&#x2F; ä¸‹é¢è¿™ä¸ª while çœŸçš„æ˜¯ä¸å¥½ç†è§£\n        &#x2F;&#x2F; advance ä¸º true è¡¨ç¤ºå¯ä»¥è¿›è¡Œä¸‹ä¸€ä¸ªä½ç½®çš„è¿ç§»äº†\n        &#x2F;&#x2F;   ç®€å•ç†è§£ç»“å±€ï¼ši æŒ‡å‘äº† transferIndexï¼Œbound æŒ‡å‘äº† transferIndex-stride\n        while (advance) &#123;\n            int nextIndex, nextBound;\n            if (--i &gt;&#x3D; bound || finishing)\n                advance &#x3D; false;\n \n            &#x2F;&#x2F; å°† transferIndex å€¼èµ‹ç»™ nextIndex\n            &#x2F;&#x2F; è¿™é‡Œ transferIndex ä¸€æ—¦å°äºç­‰äº 0ï¼Œè¯´æ˜åŸæ•°ç»„çš„æ‰€æœ‰ä½ç½®éƒ½æœ‰ç›¸åº”çš„çº¿ç¨‹å»å¤„ç†äº†\n            else if ((nextIndex &#x3D; transferIndex) &lt;&#x3D; 0) &#123;\n                i &#x3D; -1;\n                advance &#x3D; false;\n            &#125;\n            else if (U.compareAndSwapInt\n                     (this, TRANSFERINDEX, nextIndex,\n                      nextBound &#x3D; (nextIndex &gt; stride ?\n                                   nextIndex - stride : 0))) &#123;\n                &#x2F;&#x2F; çœ‹æ‹¬å·ä¸­çš„ä»£ç ï¼ŒnextBound æ˜¯è¿™æ¬¡è¿ç§»ä»»åŠ¡çš„è¾¹ç•Œï¼Œæ³¨æ„ï¼Œæ˜¯ä»åå¾€å‰\n                bound &#x3D; nextBound;\n                i &#x3D; nextIndex - 1;\n                advance &#x3D; false;\n            &#125;\n        &#125;\n        if (i &lt; 0 || i &gt;&#x3D; n || i + n &gt;&#x3D; nextn) &#123;\n            int sc;\n            if (finishing) &#123;\n                &#x2F;&#x2F; æ‰€æœ‰çš„è¿ç§»æ“ä½œå·²ç»å®Œæˆ\n                nextTable &#x3D; null;\n                &#x2F;&#x2F; å°†æ–°çš„ nextTab èµ‹å€¼ç»™ table å±æ€§ï¼Œå®Œæˆè¿ç§»\n                table &#x3D; nextTab;\n                &#x2F;&#x2F; é‡æ–°è®¡ç®— sizeCtlï¼šn æ˜¯åŸæ•°ç»„é•¿åº¦ï¼Œæ‰€ä»¥ sizeCtl å¾—å‡ºçš„å€¼å°†æ˜¯æ–°æ•°ç»„é•¿åº¦çš„ 0.75 å€\n                sizeCtl &#x3D; (n &lt;&lt; 1) - (n &gt;&gt;&gt; 1);\n                return;\n            &#125;\n \n            &#x2F;&#x2F; ä¹‹å‰æˆ‘ä»¬è¯´è¿‡ï¼ŒsizeCtl åœ¨è¿ç§»å‰ä¼šè®¾ç½®ä¸º (rs &lt;&lt; RESIZE_STAMP_SHIFT) + 2\n            &#x2F;&#x2F; ç„¶åï¼Œæ¯æœ‰ä¸€ä¸ªçº¿ç¨‹å‚ä¸è¿ç§»å°±ä¼šå°† sizeCtl åŠ  1ï¼Œ\n            &#x2F;&#x2F; è¿™é‡Œä½¿ç”¨ CAS æ“ä½œå¯¹ sizeCtl è¿›è¡Œå‡ 1ï¼Œä»£è¡¨åšå®Œäº†å±äºè‡ªå·±çš„ä»»åŠ¡\n            if (U.compareAndSwapInt(this, SIZECTL, sc &#x3D; sizeCtl, sc - 1)) &#123;\n                &#x2F;&#x2F; ä»»åŠ¡ç»“æŸï¼Œæ–¹æ³•é€€å‡º\n                if ((sc - 2) !&#x3D; resizeStamp(n) &lt;&lt; RESIZE_STAMP_SHIFT)\n                    return;\n \n                &#x2F;&#x2F; åˆ°è¿™é‡Œï¼Œè¯´æ˜ (sc - 2) &#x3D;&#x3D; resizeStamp(n) &lt;&lt; RESIZE_STAMP_SHIFTï¼Œ\n                &#x2F;&#x2F; ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰€æœ‰çš„è¿ç§»ä»»åŠ¡éƒ½åšå®Œäº†ï¼Œä¹Ÿå°±ä¼šè¿›å…¥åˆ°ä¸Šé¢çš„ if(finishing)&#123;&#125; åˆ†æ”¯äº†\n                finishing &#x3D; advance &#x3D; true;\n                i &#x3D; n; &#x2F;&#x2F; recheck before commit\n            &#125;\n        &#125;\n        &#x2F;&#x2F; å¦‚æœä½ç½® i å¤„æ˜¯ç©ºçš„ï¼Œæ²¡æœ‰ä»»ä½•èŠ‚ç‚¹ï¼Œé‚£ä¹ˆæ”¾å…¥åˆšåˆšåˆå§‹åŒ–çš„ ForwardingNode â€ç©ºèŠ‚ç‚¹â€œ\n        else if ((f &#x3D; tabAt(tab, i)) &#x3D;&#x3D; null)\n            advance &#x3D; casTabAt(tab, i, null, fwd);\n        &#x2F;&#x2F; è¯¥ä½ç½®å¤„æ˜¯ä¸€ä¸ª ForwardingNodeï¼Œä»£è¡¨è¯¥ä½ç½®å·²ç»è¿ç§»è¿‡äº†\n        else if ((fh &#x3D; f.hash) &#x3D;&#x3D; MOVED)\n            advance &#x3D; true; &#x2F;&#x2F; already processed\n        else &#123;\n            &#x2F;&#x2F; å¯¹æ•°ç»„è¯¥ä½ç½®å¤„çš„ç»“ç‚¹åŠ é”ï¼Œå¼€å§‹å¤„ç†æ•°ç»„è¯¥ä½ç½®å¤„çš„è¿ç§»å·¥ä½œ\n            synchronized (f) &#123;\n                if (tabAt(tab, i) &#x3D;&#x3D; f) &#123;\n                    Node&lt;K,V&gt; ln, hn;\n                    &#x2F;&#x2F; å¤´ç»“ç‚¹çš„ hash å¤§äº 0ï¼Œè¯´æ˜æ˜¯é“¾è¡¨çš„ Node èŠ‚ç‚¹\n                    if (fh &gt;&#x3D; 0) &#123;\n                        &#x2F;&#x2F; ä¸‹é¢è¿™ä¸€å—å’Œ Java7 ä¸­çš„ ConcurrentHashMap è¿ç§»æ˜¯å·®ä¸å¤šçš„ï¼Œ\n                        &#x2F;&#x2F; éœ€è¦å°†é“¾è¡¨ä¸€åˆ†ä¸ºäºŒï¼Œ\n                        &#x2F;&#x2F;   æ‰¾åˆ°åŸé“¾è¡¨ä¸­çš„ lastRunï¼Œç„¶å lastRun åŠå…¶ä¹‹åçš„èŠ‚ç‚¹æ˜¯ä¸€èµ·è¿›è¡Œè¿ç§»çš„\n                        &#x2F;&#x2F;   lastRun ä¹‹å‰çš„èŠ‚ç‚¹éœ€è¦è¿›è¡Œå…‹éš†ï¼Œç„¶ååˆ†åˆ°ä¸¤ä¸ªé“¾è¡¨ä¸­\n                        int runBit &#x3D; fh &amp; n;\n                        Node&lt;K,V&gt; lastRun &#x3D; f;\n                        for (Node&lt;K,V&gt; p &#x3D; f.next; p !&#x3D; null; p &#x3D; p.next) &#123;\n                            int b &#x3D; p.hash &amp; n;\n                            if (b !&#x3D; runBit) &#123;\n                                runBit &#x3D; b;\n                                lastRun &#x3D; p;\n                            &#125;\n                        &#125;\n                        if (runBit &#x3D;&#x3D; 0) &#123;\n                            ln &#x3D; lastRun;\n                            hn &#x3D; null;\n                        &#125;\n                        else &#123;\n                            hn &#x3D; lastRun;\n                            ln &#x3D; null;\n                        &#125;\n                        for (Node&lt;K,V&gt; p &#x3D; f; p !&#x3D; lastRun; p &#x3D; p.next) &#123;\n                            int ph &#x3D; p.hash; K pk &#x3D; p.key; V pv &#x3D; p.val;\n                            if ((ph &amp; n) &#x3D;&#x3D; 0)\n                                ln &#x3D; new Node&lt;K,V&gt;(ph, pk, pv, ln);\n                            else\n                                hn &#x3D; new Node&lt;K,V&gt;(ph, pk, pv, hn);\n                        &#125;\n                        &#x2F;&#x2F; å…¶ä¸­çš„ä¸€ä¸ªé“¾è¡¨æ”¾åœ¨æ–°æ•°ç»„çš„ä½ç½® i\n                        setTabAt(nextTab, i, ln);\n                        &#x2F;&#x2F; å¦ä¸€ä¸ªé“¾è¡¨æ”¾åœ¨æ–°æ•°ç»„çš„ä½ç½® i+n\n                        setTabAt(nextTab, i + n, hn);\n                        &#x2F;&#x2F; å°†åŸæ•°ç»„è¯¥ä½ç½®å¤„è®¾ç½®ä¸º fwdï¼Œä»£è¡¨è¯¥ä½ç½®å·²ç»å¤„ç†å®Œæ¯•ï¼Œ\n                        &#x2F;&#x2F;    å…¶ä»–çº¿ç¨‹ä¸€æ—¦çœ‹åˆ°è¯¥ä½ç½®çš„ hash å€¼ä¸º MOVEDï¼Œå°±ä¸ä¼šè¿›è¡Œè¿ç§»äº†\n                        setTabAt(tab, i, fwd);\n                        &#x2F;&#x2F; advance è®¾ç½®ä¸º trueï¼Œä»£è¡¨è¯¥ä½ç½®å·²ç»è¿ç§»å®Œæ¯•\n                        advance &#x3D; true;\n                    &#125;\n                    else if (f instanceof TreeBin) &#123;\n                        &#x2F;&#x2F; çº¢é»‘æ ‘çš„è¿ç§»\n                        TreeBin&lt;K,V&gt; t &#x3D; (TreeBin&lt;K,V&gt;)f;\n                        TreeNode&lt;K,V&gt; lo &#x3D; null, loTail &#x3D; null;\n                        TreeNode&lt;K,V&gt; hi &#x3D; null, hiTail &#x3D; null;\n                        int lc &#x3D; 0, hc &#x3D; 0;\n                        for (Node&lt;K,V&gt; e &#x3D; t.first; e !&#x3D; null; e &#x3D; e.next) &#123;\n                            int h &#x3D; e.hash;\n                            TreeNode&lt;K,V&gt; p &#x3D; new TreeNode&lt;K,V&gt;\n                                (h, e.key, e.val, null, null);\n                            if ((h &amp; n) &#x3D;&#x3D; 0) &#123;\n                                if ((p.prev &#x3D; loTail) &#x3D;&#x3D; null)\n                                    lo &#x3D; p;\n                                else\n                                    loTail.next &#x3D; p;\n                                loTail &#x3D; p;\n                                ++lc;\n                            &#125;\n                            else &#123;\n                                if ((p.prev &#x3D; hiTail) &#x3D;&#x3D; null)\n                                    hi &#x3D; p;\n                                else\n                                    hiTail.next &#x3D; p;\n                                hiTail &#x3D; p;\n                                ++hc;\n                            &#125;\n                        &#125;\n                        &#x2F;&#x2F; å¦‚æœä¸€åˆ†ä¸ºäºŒåï¼ŒèŠ‚ç‚¹æ•°å°‘äº 8ï¼Œé‚£ä¹ˆå°†çº¢é»‘æ ‘è½¬æ¢å›é“¾è¡¨\n                        ln &#x3D; (lc &lt;&#x3D; UNTREEIFY_THRESHOLD) ? untreeify(lo) :\n                            (hc !&#x3D; 0) ? new TreeBin&lt;K,V&gt;(lo) : t;\n                        hn &#x3D; (hc &lt;&#x3D; UNTREEIFY_THRESHOLD) ? untreeify(hi) :\n                            (lc !&#x3D; 0) ? new TreeBin&lt;K,V&gt;(hi) : t;\n \n                        &#x2F;&#x2F; å°† ln æ”¾ç½®åœ¨æ–°æ•°ç»„çš„ä½ç½® i\n                        setTabAt(nextTab, i, ln);\n                        &#x2F;&#x2F; å°† hn æ”¾ç½®åœ¨æ–°æ•°ç»„çš„ä½ç½® i+n\n                        setTabAt(nextTab, i + n, hn);\n                        &#x2F;&#x2F; å°†åŸæ•°ç»„è¯¥ä½ç½®å¤„è®¾ç½®ä¸º fwdï¼Œä»£è¡¨è¯¥ä½ç½®å·²ç»å¤„ç†å®Œæ¯•ï¼Œ\n                        &#x2F;&#x2F;    å…¶ä»–çº¿ç¨‹ä¸€æ—¦çœ‹åˆ°è¯¥ä½ç½®çš„ hash å€¼ä¸º MOVEDï¼Œå°±ä¸ä¼šè¿›è¡Œè¿ç§»äº†\n                        setTabAt(tab, i, fwd);\n                        &#x2F;&#x2F; advance è®¾ç½®ä¸º trueï¼Œä»£è¡¨è¯¥ä½ç½®å·²ç»è¿ç§»å®Œæ¯•\n                        advance &#x3D; true;\n                    &#125;\n                &#125;\n            &#125;\n        &#125;\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¯´åˆ°åº•ï¼Œtransfer è¿™ä¸ªæ–¹æ³•å¹¶æ²¡æœ‰å®ç°æ‰€æœ‰çš„è¿ç§»ä»»åŠ¡ï¼Œæ¯æ¬¡è°ƒç”¨è¿™ä¸ªæ–¹æ³•åªå®ç°äº† transferIndex å¾€å‰ stride ä¸ªä½ç½®çš„è¿ç§»å·¥ä½œï¼Œå…¶ä»–çš„éœ€è¦ç”±å¤–å›´æ¥æ§åˆ¶ã€‚</p>\n<p>è¿™ä¸ªæ—¶å€™ï¼Œå†å›å»ä»”ç»†çœ‹ tryPresize æ–¹æ³•å¯èƒ½å°±ä¼šæ›´åŠ æ¸…æ™°ä¸€äº›äº†ã€‚</p>\n<h4 id=\"get-è¿‡ç¨‹åˆ†æ-3\"><a href=\"#get-è¿‡ç¨‹åˆ†æ-3\" class=\"headerlink\" title=\"get è¿‡ç¨‹åˆ†æ\"></a>get è¿‡ç¨‹åˆ†æ</h4><p>get æ–¹æ³•ä»æ¥éƒ½æ˜¯æœ€ç®€å•çš„ï¼Œè¿™é‡Œä¹Ÿä¸ä¾‹å¤–ï¼š</p>\n<p>1.è®¡ç®— hash å€¼</p>\n<p>2.æ ¹æ® hash å€¼æ‰¾åˆ°æ•°ç»„å¯¹åº”ä½ç½®: (n â€“ 1) &amp; h</p>\n<p>3.æ ¹æ®è¯¥ä½ç½®å¤„ç»“ç‚¹æ€§è´¨è¿›è¡Œç›¸åº”æŸ¥æ‰¾</p>\n<ul>\n<li>å¦‚æœè¯¥ä½ç½®ä¸º nullï¼Œé‚£ä¹ˆç›´æ¥è¿”å› null å°±å¯ä»¥äº†</li>\n<li>å¦‚æœè¯¥ä½ç½®å¤„çš„èŠ‚ç‚¹åˆšå¥½å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„ï¼Œè¿”å›è¯¥èŠ‚ç‚¹çš„å€¼å³å¯</li>\n<li>å¦‚æœè¯¥ä½ç½®èŠ‚ç‚¹çš„ hash å€¼å°äº 0ï¼Œè¯´æ˜æ­£åœ¨æ‰©å®¹ï¼Œæˆ–è€…æ˜¯çº¢é»‘æ ‘ï¼Œåé¢æˆ‘ä»¬å†ä»‹ç» find æ–¹æ³•</li>\n<li>å¦‚æœä»¥ä¸Š 3 æ¡éƒ½ä¸æ»¡è¶³ï¼Œé‚£å°±æ˜¯é“¾è¡¨ï¼Œè¿›è¡Œéå†æ¯”å¯¹å³å¯ã€‚</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public V get(Object key) &#123;\n    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; e, p; int n, eh; K ek;\n    int h &#x3D; spread(key.hashCode());\n    if ((tab &#x3D; table) !&#x3D; null &amp;&amp; (n &#x3D; tab.length) &gt; 0 &amp;&amp;\n        (e &#x3D; tabAt(tab, (n - 1) &amp; h)) !&#x3D; null) &#123;\n        &#x2F;&#x2F; åˆ¤æ–­å¤´ç»“ç‚¹æ˜¯å¦å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„èŠ‚ç‚¹\n        if ((eh &#x3D; e.hash) &#x3D;&#x3D; h) &#123;\n            if ((ek &#x3D; e.key) &#x3D;&#x3D; key || (ek !&#x3D; null &amp;&amp; key.equals(ek)))\n                return e.val;\n        &#125;\n        &#x2F;&#x2F; å¦‚æœå¤´ç»“ç‚¹çš„ hash å°äº 0ï¼Œè¯´æ˜ æ­£åœ¨æ‰©å®¹ï¼Œæˆ–è€…è¯¥ä½ç½®æ˜¯çº¢é»‘æ ‘\n        else if (eh &lt; 0)\n            &#x2F;&#x2F; å‚è€ƒ ForwardingNode.find(int h, Object k) å’Œ TreeBin.find(int h, Object k)\n            return (p &#x3D; e.find(h, key)) !&#x3D; null ? p.val : null;\n \n        &#x2F;&#x2F; éå†é“¾è¡¨\n        while ((e &#x3D; e.next) !&#x3D; null) &#123;\n            if (e.hash &#x3D;&#x3D; h &amp;&amp;\n                ((ek &#x3D; e.key) &#x3D;&#x3D; key || (ek !&#x3D; null &amp;&amp; key.equals(ek))))\n                return e.val;\n        &#125;\n    &#125;\n    return null;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç®€å•è¯´ä¸€å¥ï¼Œæ­¤æ–¹æ³•çš„å¤§éƒ¨åˆ†å†…å®¹éƒ½å¾ˆç®€å•ï¼Œåªæœ‰æ­£å¥½ç¢°åˆ°æ‰©å®¹çš„æƒ…å†µï¼ŒForwardingNode.find(int h, Object k) ç¨å¾®å¤æ‚ä¸€äº›ï¼Œä¸è¿‡åœ¨äº†è§£äº†æ•°æ®è¿ç§»çš„è¿‡ç¨‹åï¼Œè¿™ä¸ªä¹Ÿå°±ä¸éš¾äº†ï¼Œæ‰€ä»¥é™äºç¯‡å¹…è¿™é‡Œä¹Ÿä¸å±•å¼€è¯´äº†ã€‚</p>\n<h2 id=\"æ€»ç»“\"><a href=\"#æ€»ç»“\" class=\"headerlink\" title=\"æ€»ç»“\"></a>æ€»ç»“</h2><p>å…¶å®ä¹Ÿä¸æ˜¯å¾ˆéš¾å˜›ï¼Œè™½ç„¶æ²¡æœ‰åƒä¹‹å‰çš„ AQS å’Œçº¿ç¨‹æ± ä¸€æ ·ä¸€è¡Œä¸€è¡Œæºç è¿›è¡Œåˆ†æï¼Œä½†è¿˜æ˜¯æŠŠæ‰€æœ‰åˆå­¦è€…å¯èƒ½ä¼šç³Šæ¶‚çš„åœ°æ–¹éƒ½è¿›è¡Œäº†æ·±å…¥çš„ä»‹ç»ï¼Œåªè¦æ˜¯ç¨å¾®æœ‰ç‚¹åŸºç¡€çš„è¯»è€…ï¼Œåº”è¯¥æ˜¯å¾ˆå®¹æ˜“å°±èƒ½çœ‹æ‡‚ HashMap å’Œ ConcurrentHashMap æºç äº†ã€‚</p>\n<p>çœ‹æºç ä¸ç®—æ˜¯ç›®çš„å§ï¼Œæ·±å…¥åœ°äº†è§£ Doug Lea çš„è®¾è®¡æ€è·¯ï¼Œæˆ‘è§‰å¾—è¿˜æŒºæœ‰è¶£çš„ï¼Œå¤§å¸ˆå°±æ˜¯å¤§å¸ˆï¼Œä»£ç å†™å¾—çœŸçš„æ˜¯å¥½å•Šã€‚</p>\n<p>æˆ‘å‘ç°å¾ˆå¤šäººéƒ½ä»¥ä¸ºæˆ‘å†™åšå®¢ä¸»è¦æ˜¯æºç åˆ†æï¼Œè¯´çœŸçš„ï¼Œæˆ‘å¯¹äºæºç åˆ†ææ²¡æœ‰é‚£ä¹ˆå¤§çƒ­æƒ…ï¼Œä¸»è¦éƒ½æ˜¯ä¸ºäº†ç”¨æºç è¯´äº‹ç½¢äº†ï¼Œå¯èƒ½ä¹‹åçš„æ–‡ç« è¿˜æ˜¯ä¼šæœ‰æ¯”è¾ƒå¤šçš„æºç åˆ†ææˆåˆ†ï¼Œå¤§å®¶è¯¥æ€ä¹ˆçœ‹å°±æ€ä¹ˆçœ‹å§ã€‚</p>\n<p>ä¸è¦è„¸åœ°è‡ªä»¥ä¸ºæœ¬æ–‡çš„è´¨é‡è¿˜æ˜¯æŒºé«˜çš„ï¼Œä¿¡æ¯é‡æ¯”è¾ƒå¤§ï¼Œå¦‚æœä½ è§‰å¾—æœ‰å†™å¾—ä¸å¥½çš„åœ°æ–¹ï¼Œæˆ–è€…è¯´çœ‹å®Œæœ¬æ–‡ä½ è¿˜æ˜¯æ²¡çœ‹æ‡‚å®ƒä»¬ï¼Œé‚£ä¹ˆè¯·æå‡ºæ¥~~~</p>\n"},{"title":"Java 10 å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä»‹ç»åŠå®æˆ˜","date":"2025-10-15T03:36:33.000Z","_content":"ç°åœ¨ Java 9 è¢«é—å¼ƒäº†ç›´æ¥å‡çº§åˆ°äº† Java 10ï¼Œä¹‹å‰ä¹Ÿå‘è¿‡ Java 10 æ–°ç‰¹æ€§çš„æ–‡ç« ï¼Œç°åœ¨æ˜¯å¼€å§‹å®æˆ˜ Java 10 çš„æ—¶å€™äº†ã€‚\n\nä»Šå¤©è¦å®æˆ˜çš„æ˜¯ Java 10 ä¸­æœ€é‡è¦çš„ç‰¹æ€§ï¼šå±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ï¼Œå¤§å®¶éƒ½çŸ¥é“æ˜¯ `var` å…³é”®å­—ï¼Œä½†å…·ä½“æ€ä¹ˆä½¿ç”¨ï¼ŒåŠè¦æ³¨æ„ä»€ä¹ˆè¦ç‚¹å‘¢ï¼Ÿ\n\næˆ‘ä»¬é€šè¿‡å‡ ä¸ªä¾‹å­æ¥è®²è§£å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­è¿™ä¸ªæ–°ç‰¹æ€§ï¼\n\n\n### ä»€ä¹ˆæ˜¯å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­\n\n```\nvar javastack = \"javastack\";\nSystem.out.println(javastack);\n```\n\nå¤§å®¶çœ‹å‡ºæ¥äº†ï¼Œå±€éƒ¨å˜é‡ç±»å‹æ¨æ–­å°±æ˜¯å·¦è¾¹çš„ç±»å‹ç›´æ¥ä½¿ç”¨ `var` å®šä¹‰ï¼Œè€Œä¸ç”¨å†™å…·ä½“çš„ç±»å‹ï¼Œç¼–è¯‘å™¨èƒ½æ ¹æ®å³è¾¹çš„è¡¨è¾¾å¼è‡ªåŠ¨æ¨æ–­ç±»å‹ï¼Œå¦‚ä¸Šé¢çš„ `String` ã€‚\n\n```\nvar javastack = \"javastack\";\n```\n\nå°±ç­‰äºï¼š\n\n```\nString javastack = \"javastack\";\n```\n\n### å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä½¿ç”¨ç¤ºä¾‹\n\næ—¢ç„¶å«å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ï¼Œä»¥åªèƒ½ç”¨åœ¨å±€éƒ¨å˜é‡ä¸­ï¼Œä¸‹é¢ç»™å‡ºæ›´å¤šä½¿ç”¨ç¤ºä¾‹ã€‚\n\n**1ã€å­—é¢é‡å®šä¹‰å±€éƒ¨å˜é‡**\n\n```\nprivate static void testVar() {\n\tvar javastack = \"javastack\";\n\tSystem.out.println(javastack);\n}\n```\n\n**2ã€æ¥æ”¶æ–¹æ³•è¿”å›å€¼å®šä¹‰å±€éƒ¨å˜é‡**\n\n\n```\nprivate static void testMethod() {\n\tvar javastack = getJavastack();\n\tSystem.out.println(javastack);\n}\n\npublic static String getJavastack() {\n\treturn \"javastack\";\n}\n```\n\n**3ã€å¾ªç¯ä¸­å®šä¹‰å±€éƒ¨å˜é‡**\n\n```\nprivate static void testLoop() {\n\tfor (var i = 0; i < 3; i++) {\n\t\tfor (var m = 10; m < 15; m++) {\n\t\t\tSystem.out.println(i + m);\n\t\t}\n\t}\n}\n```\n\n**4ã€æ³›å‹ç»“åˆå±€éƒ¨å˜é‡**\n\n```\nprivate static void testGeneric() {\n\t// è¡¨è¾¾å¼1\n\tList<String> list1 = new ArrayList<>();\n\tlist1.add(\"javastack\");\n\n\t// è¡¨è¾¾å¼2\n\tvar list2 = new ArrayList<>();\n\tlist2.add(2018);\n\n\t// è¡¨è¾¾å¼3\n\tvar list3 = new ArrayList<String>();\n\tlist3.add(\"javastack\");\n}\n```\n\nè¡¨è¾¾å¼1åé¢ `<>` é‡Œé¢ jdk 1.7+å¼€å§‹æ˜¯ä¸ç”¨å¸¦å…·ä½“ç±»å‹çš„ï¼Œåœ¨æ¥å£ä¸­æŒ‡æ˜å°±è¡Œäº†ã€‚\n\nè¡¨è¾¾å¼2ä¸­å¦‚æœä½¿ç”¨ `var` çš„è¯ï¼Œ`<>` é‡Œé¢é»˜è®¤ä¼šæ˜¯ `Object` çš„ï¼Œæ‰€ä»¥å¯ä»¥æ·»åŠ ä»»æ„ç±»å‹ã€‚\n\nè¡¨è¾¾å¼3ä¸­åœ¨ `<>` å¼ºåˆ¶ä½¿ç”¨äº† String æ¥æŒ‡å®šæ³›å‹ã€‚\n\n\n### å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä¸èƒ½ç”¨åœ¨ä»¥ä¸‹åœºæ™¯\n\n**1ã€ç±»æˆå‘˜å˜é‡ç±»å‹**\n\n```\n// ç¼–è¯‘æŠ¥é”™\nprivate var javastack = \"JavaæŠ€æœ¯\";\n```\n\n**2ã€æ–¹æ³•è¿”å›ç±»å‹**\n\n```\n/**\n * ç¼–è¯‘æŠ¥é”™\n * @return\n */\npublic static var getJavastack(){\n \treturn \"JavaæŠ€æœ¯\";\n}\n```\n\n**3ã€Lambda è¡¨è¾¾å¼**\n\n```\nprivate static void testLambda() {\n\tRunnable runnable = () -> System.out.println(\"javastack\");\n\n\t// ç¼–è¯‘æŠ¥é”™\n\t// var runnable = () -> System.out.println(\"javastack\");\n}\n```\n\nä»¥ä¸Š 3 ç§åœºæ™¯æ˜¯è‚¯å®šä¸èƒ½ä½¿ç”¨ `var` çš„ï¼Œå…¶ä»–åœºåˆæœ‰å¾…éªŒè¯ã€‚\n\n\n### å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä¼˜ç¼ºç‚¹\n\n**ä¼˜ç‚¹ï¼šç®€åŒ–ä»£ç **\n\n```\nCopyOnWriteArrayList list1 = new CopyOnWriteArrayList();\nConcurrentModificationException cme1 = new ConcurrentModificationException();\nDefaultServiceUnavailableRetryStrategy strategy1 = new\n\t\tDefaultServiceUnavailableRetryStrategy();\n\nvar list2 = new CopyOnWriteArrayList<>();\nvar cme2 = new ConcurrentModificationException();\nvar strategy2 = new DefaultServiceUnavailableRetryStrategy();\n```\n\nä»ä»¥ä¸Šä»£ç å¯ä»¥çœ‹å‡ºï¼Œå¾ˆé•¿çš„å®šä¹‰ç±»å‹ä¼šæ˜¾å¾—ä»£ç å¾ˆå†—é•¿ï¼Œä½¿ç”¨ var å¤§å¤§ç®€åŒ–äº†ä»£ç ç¼–å†™ï¼ŒåŒæ—¶ç±»å‹ç»Ÿä¸€æ˜¾å¾—ä»£ç å¾ˆå¯¹é½ã€‚\n\n**ç¼ºç‚¹ï¼šæ©ç›–ç±»å‹**\n\n```\nvar token = new JsonParserDelegate(parser).currentToken();\n```\n\nçœ‹ä»¥ä¸Šä»£ç ï¼Œä¸è¿›å»çœ‹è¿”å›ç»“æœç±»å‹ï¼Œè°çŸ¥é“è¿”å›çš„ç±»å‹æ˜¯ä»€ä¹ˆï¼Ÿæ‰€ä»¥è¿™ç§æƒ…å†µæœ€å¥½åˆ«ä½¿ç”¨ `var`ï¼Œè€Œä½¿ç”¨å…·ä½“çš„æŠ½è±¡ç±»ã€æ¥å£æˆ–è€…å®ä¾‹ç±»å‹ã€‚\n\n### varå…³é”®å­—åŸç†\n\nvarå…¶å®å°±æ˜¯ Java 10 å¢åŠ çš„ä¸€ç§è¯­æ³•ç³–è€Œå·²ï¼Œåœ¨ç¼–è¯‘æœŸé—´ä¼šè‡ªåŠ¨æ¨æ–­å®é™…ç±»å‹ï¼Œå…¶ç¼–è¯‘åçš„å­—èŠ‚ç å’Œå®é™…ç±»å‹ä¸€è‡´ï¼Œå¦‚ä»¥ä¸‹ä¾‹å­æ‰€ç¤ºã€‚\n\n\n```\nprivate static void testByteCode() {\n\tString javastack1 = \"javastack\";\n\tvar javastack2 = \"javastack\";\n}\n```\n\nç¼–è¯‘æˆå­—èŠ‚ç åï¼š\n\n```\nprivate static testByteCode()V\nL0\nLINENUMBER 22 L0\nLDC \"javastack\"\nASTORE 0\nL1\nLINENUMBER 23 L1\nLDC \"javastack\"\nASTORE 1\nL2\nLINENUMBER 24 L2\nRETURN\nL3\nLOCALVARIABLE javastack1 Ljava/lang/String; L1 L3 0\nLOCALVARIABLE javastack2 Ljava/lang/String; L2 L3 1\nMAXSTACK = 1\nMAXLOCALS = 2\n```\n\nå¯ä»¥çœ‹å‡º `javastack1` å’Œ `javastack2` éƒ½æ˜¯è™šæ‹Ÿæœºæ‰€è®¤è¯†çš„çš„æœ¬åœ°å˜é‡ç±»å‹ï¼š`java.lang.String`ï¼Œè™šæ‹Ÿæœºå¹¶ä¸è®¤è¯† var,  æ‰€ä»¥ `var` å¹¶ä¸ç¥å¥‡ã€‚\n\nOKï¼Œæœ¬æ¬¡ Java 10 å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­å®æˆ˜æ–‡ç« å°±åˆ°è¿™é‡Œäº†ï¼Œåç»­å¸¦æ¥æ›´å¤šçš„ Java 10 çš„å®æˆ˜æ–¹é¢çš„æ–‡ç« ã€‚\n\n\n","source":"_posts/æ–°ç‰¹æ€§/Java10/Java 10 å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä»‹ç»åŠå®æˆ˜.md","raw":"---\ntitle: Java 10 å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä»‹ç»åŠå®æˆ˜\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: æ–°ç‰¹æ€§\n---\nç°åœ¨ Java 9 è¢«é—å¼ƒäº†ç›´æ¥å‡çº§åˆ°äº† Java 10ï¼Œä¹‹å‰ä¹Ÿå‘è¿‡ Java 10 æ–°ç‰¹æ€§çš„æ–‡ç« ï¼Œç°åœ¨æ˜¯å¼€å§‹å®æˆ˜ Java 10 çš„æ—¶å€™äº†ã€‚\n\nä»Šå¤©è¦å®æˆ˜çš„æ˜¯ Java 10 ä¸­æœ€é‡è¦çš„ç‰¹æ€§ï¼šå±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ï¼Œå¤§å®¶éƒ½çŸ¥é“æ˜¯ `var` å…³é”®å­—ï¼Œä½†å…·ä½“æ€ä¹ˆä½¿ç”¨ï¼ŒåŠè¦æ³¨æ„ä»€ä¹ˆè¦ç‚¹å‘¢ï¼Ÿ\n\næˆ‘ä»¬é€šè¿‡å‡ ä¸ªä¾‹å­æ¥è®²è§£å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­è¿™ä¸ªæ–°ç‰¹æ€§ï¼\n\n\n### ä»€ä¹ˆæ˜¯å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­\n\n```\nvar javastack = \"javastack\";\nSystem.out.println(javastack);\n```\n\nå¤§å®¶çœ‹å‡ºæ¥äº†ï¼Œå±€éƒ¨å˜é‡ç±»å‹æ¨æ–­å°±æ˜¯å·¦è¾¹çš„ç±»å‹ç›´æ¥ä½¿ç”¨ `var` å®šä¹‰ï¼Œè€Œä¸ç”¨å†™å…·ä½“çš„ç±»å‹ï¼Œç¼–è¯‘å™¨èƒ½æ ¹æ®å³è¾¹çš„è¡¨è¾¾å¼è‡ªåŠ¨æ¨æ–­ç±»å‹ï¼Œå¦‚ä¸Šé¢çš„ `String` ã€‚\n\n```\nvar javastack = \"javastack\";\n```\n\nå°±ç­‰äºï¼š\n\n```\nString javastack = \"javastack\";\n```\n\n### å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä½¿ç”¨ç¤ºä¾‹\n\næ—¢ç„¶å«å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ï¼Œä»¥åªèƒ½ç”¨åœ¨å±€éƒ¨å˜é‡ä¸­ï¼Œä¸‹é¢ç»™å‡ºæ›´å¤šä½¿ç”¨ç¤ºä¾‹ã€‚\n\n**1ã€å­—é¢é‡å®šä¹‰å±€éƒ¨å˜é‡**\n\n```\nprivate static void testVar() {\n\tvar javastack = \"javastack\";\n\tSystem.out.println(javastack);\n}\n```\n\n**2ã€æ¥æ”¶æ–¹æ³•è¿”å›å€¼å®šä¹‰å±€éƒ¨å˜é‡**\n\n\n```\nprivate static void testMethod() {\n\tvar javastack = getJavastack();\n\tSystem.out.println(javastack);\n}\n\npublic static String getJavastack() {\n\treturn \"javastack\";\n}\n```\n\n**3ã€å¾ªç¯ä¸­å®šä¹‰å±€éƒ¨å˜é‡**\n\n```\nprivate static void testLoop() {\n\tfor (var i = 0; i < 3; i++) {\n\t\tfor (var m = 10; m < 15; m++) {\n\t\t\tSystem.out.println(i + m);\n\t\t}\n\t}\n}\n```\n\n**4ã€æ³›å‹ç»“åˆå±€éƒ¨å˜é‡**\n\n```\nprivate static void testGeneric() {\n\t// è¡¨è¾¾å¼1\n\tList<String> list1 = new ArrayList<>();\n\tlist1.add(\"javastack\");\n\n\t// è¡¨è¾¾å¼2\n\tvar list2 = new ArrayList<>();\n\tlist2.add(2018);\n\n\t// è¡¨è¾¾å¼3\n\tvar list3 = new ArrayList<String>();\n\tlist3.add(\"javastack\");\n}\n```\n\nè¡¨è¾¾å¼1åé¢ `<>` é‡Œé¢ jdk 1.7+å¼€å§‹æ˜¯ä¸ç”¨å¸¦å…·ä½“ç±»å‹çš„ï¼Œåœ¨æ¥å£ä¸­æŒ‡æ˜å°±è¡Œäº†ã€‚\n\nè¡¨è¾¾å¼2ä¸­å¦‚æœä½¿ç”¨ `var` çš„è¯ï¼Œ`<>` é‡Œé¢é»˜è®¤ä¼šæ˜¯ `Object` çš„ï¼Œæ‰€ä»¥å¯ä»¥æ·»åŠ ä»»æ„ç±»å‹ã€‚\n\nè¡¨è¾¾å¼3ä¸­åœ¨ `<>` å¼ºåˆ¶ä½¿ç”¨äº† String æ¥æŒ‡å®šæ³›å‹ã€‚\n\n\n### å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä¸èƒ½ç”¨åœ¨ä»¥ä¸‹åœºæ™¯\n\n**1ã€ç±»æˆå‘˜å˜é‡ç±»å‹**\n\n```\n// ç¼–è¯‘æŠ¥é”™\nprivate var javastack = \"JavaæŠ€æœ¯\";\n```\n\n**2ã€æ–¹æ³•è¿”å›ç±»å‹**\n\n```\n/**\n * ç¼–è¯‘æŠ¥é”™\n * @return\n */\npublic static var getJavastack(){\n \treturn \"JavaæŠ€æœ¯\";\n}\n```\n\n**3ã€Lambda è¡¨è¾¾å¼**\n\n```\nprivate static void testLambda() {\n\tRunnable runnable = () -> System.out.println(\"javastack\");\n\n\t// ç¼–è¯‘æŠ¥é”™\n\t// var runnable = () -> System.out.println(\"javastack\");\n}\n```\n\nä»¥ä¸Š 3 ç§åœºæ™¯æ˜¯è‚¯å®šä¸èƒ½ä½¿ç”¨ `var` çš„ï¼Œå…¶ä»–åœºåˆæœ‰å¾…éªŒè¯ã€‚\n\n\n### å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä¼˜ç¼ºç‚¹\n\n**ä¼˜ç‚¹ï¼šç®€åŒ–ä»£ç **\n\n```\nCopyOnWriteArrayList list1 = new CopyOnWriteArrayList();\nConcurrentModificationException cme1 = new ConcurrentModificationException();\nDefaultServiceUnavailableRetryStrategy strategy1 = new\n\t\tDefaultServiceUnavailableRetryStrategy();\n\nvar list2 = new CopyOnWriteArrayList<>();\nvar cme2 = new ConcurrentModificationException();\nvar strategy2 = new DefaultServiceUnavailableRetryStrategy();\n```\n\nä»ä»¥ä¸Šä»£ç å¯ä»¥çœ‹å‡ºï¼Œå¾ˆé•¿çš„å®šä¹‰ç±»å‹ä¼šæ˜¾å¾—ä»£ç å¾ˆå†—é•¿ï¼Œä½¿ç”¨ var å¤§å¤§ç®€åŒ–äº†ä»£ç ç¼–å†™ï¼ŒåŒæ—¶ç±»å‹ç»Ÿä¸€æ˜¾å¾—ä»£ç å¾ˆå¯¹é½ã€‚\n\n**ç¼ºç‚¹ï¼šæ©ç›–ç±»å‹**\n\n```\nvar token = new JsonParserDelegate(parser).currentToken();\n```\n\nçœ‹ä»¥ä¸Šä»£ç ï¼Œä¸è¿›å»çœ‹è¿”å›ç»“æœç±»å‹ï¼Œè°çŸ¥é“è¿”å›çš„ç±»å‹æ˜¯ä»€ä¹ˆï¼Ÿæ‰€ä»¥è¿™ç§æƒ…å†µæœ€å¥½åˆ«ä½¿ç”¨ `var`ï¼Œè€Œä½¿ç”¨å…·ä½“çš„æŠ½è±¡ç±»ã€æ¥å£æˆ–è€…å®ä¾‹ç±»å‹ã€‚\n\n### varå…³é”®å­—åŸç†\n\nvarå…¶å®å°±æ˜¯ Java 10 å¢åŠ çš„ä¸€ç§è¯­æ³•ç³–è€Œå·²ï¼Œåœ¨ç¼–è¯‘æœŸé—´ä¼šè‡ªåŠ¨æ¨æ–­å®é™…ç±»å‹ï¼Œå…¶ç¼–è¯‘åçš„å­—èŠ‚ç å’Œå®é™…ç±»å‹ä¸€è‡´ï¼Œå¦‚ä»¥ä¸‹ä¾‹å­æ‰€ç¤ºã€‚\n\n\n```\nprivate static void testByteCode() {\n\tString javastack1 = \"javastack\";\n\tvar javastack2 = \"javastack\";\n}\n```\n\nç¼–è¯‘æˆå­—èŠ‚ç åï¼š\n\n```\nprivate static testByteCode()V\nL0\nLINENUMBER 22 L0\nLDC \"javastack\"\nASTORE 0\nL1\nLINENUMBER 23 L1\nLDC \"javastack\"\nASTORE 1\nL2\nLINENUMBER 24 L2\nRETURN\nL3\nLOCALVARIABLE javastack1 Ljava/lang/String; L1 L3 0\nLOCALVARIABLE javastack2 Ljava/lang/String; L2 L3 1\nMAXSTACK = 1\nMAXLOCALS = 2\n```\n\nå¯ä»¥çœ‹å‡º `javastack1` å’Œ `javastack2` éƒ½æ˜¯è™šæ‹Ÿæœºæ‰€è®¤è¯†çš„çš„æœ¬åœ°å˜é‡ç±»å‹ï¼š`java.lang.String`ï¼Œè™šæ‹Ÿæœºå¹¶ä¸è®¤è¯† var,  æ‰€ä»¥ `var` å¹¶ä¸ç¥å¥‡ã€‚\n\nOKï¼Œæœ¬æ¬¡ Java 10 å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­å®æˆ˜æ–‡ç« å°±åˆ°è¿™é‡Œäº†ï¼Œåç»­å¸¦æ¥æ›´å¤šçš„ Java 10 çš„å®æˆ˜æ–¹é¢çš„æ–‡ç« ã€‚\n\n\n","slug":"æ–°ç‰¹æ€§/Java10/Java 10 å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä»‹ç»åŠå®æˆ˜","published":1,"updated":"2025-10-15T07:20:51.453Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu07710054qkd46z658v2m","content":"<p>ç°åœ¨ Java 9 è¢«é—å¼ƒäº†ç›´æ¥å‡çº§åˆ°äº† Java 10ï¼Œä¹‹å‰ä¹Ÿå‘è¿‡ Java 10 æ–°ç‰¹æ€§çš„æ–‡ç« ï¼Œç°åœ¨æ˜¯å¼€å§‹å®æˆ˜ Java 10 çš„æ—¶å€™äº†ã€‚</p>\n<p>ä»Šå¤©è¦å®æˆ˜çš„æ˜¯ Java 10 ä¸­æœ€é‡è¦çš„ç‰¹æ€§ï¼šå±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ï¼Œå¤§å®¶éƒ½çŸ¥é“æ˜¯ <code>var</code> å…³é”®å­—ï¼Œä½†å…·ä½“æ€ä¹ˆä½¿ç”¨ï¼ŒåŠè¦æ³¨æ„ä»€ä¹ˆè¦ç‚¹å‘¢ï¼Ÿ</p>\n<p>æˆ‘ä»¬é€šè¿‡å‡ ä¸ªä¾‹å­æ¥è®²è§£å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­è¿™ä¸ªæ–°ç‰¹æ€§ï¼</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­\"><a href=\"#ä»€ä¹ˆæ˜¯å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­\"></a>ä»€ä¹ˆæ˜¯å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">var javastack &#x3D; &quot;javastack&quot;;\nSystem.out.println(javastack);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>å¤§å®¶çœ‹å‡ºæ¥äº†ï¼Œå±€éƒ¨å˜é‡ç±»å‹æ¨æ–­å°±æ˜¯å·¦è¾¹çš„ç±»å‹ç›´æ¥ä½¿ç”¨ <code>var</code> å®šä¹‰ï¼Œè€Œä¸ç”¨å†™å…·ä½“çš„ç±»å‹ï¼Œç¼–è¯‘å™¨èƒ½æ ¹æ®å³è¾¹çš„è¡¨è¾¾å¼è‡ªåŠ¨æ¨æ–­ç±»å‹ï¼Œå¦‚ä¸Šé¢çš„ <code>String</code> ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">var javastack &#x3D; &quot;javastack&quot;;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>å°±ç­‰äºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">String javastack &#x3D; &quot;javastack&quot;;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä½¿ç”¨ç¤ºä¾‹\"><a href=\"#å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä½¿ç”¨ç¤ºä¾‹\" class=\"headerlink\" title=\"å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä½¿ç”¨ç¤ºä¾‹\"></a>å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä½¿ç”¨ç¤ºä¾‹</h3><p>æ—¢ç„¶å«å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ï¼Œä»¥åªèƒ½ç”¨åœ¨å±€éƒ¨å˜é‡ä¸­ï¼Œä¸‹é¢ç»™å‡ºæ›´å¤šä½¿ç”¨ç¤ºä¾‹ã€‚</p>\n<p><strong>1ã€å­—é¢é‡å®šä¹‰å±€éƒ¨å˜é‡</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void testVar() &#123;\n\tvar javastack &#x3D; &quot;javastack&quot;;\n\tSystem.out.println(javastack);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>2ã€æ¥æ”¶æ–¹æ³•è¿”å›å€¼å®šä¹‰å±€éƒ¨å˜é‡</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void testMethod() &#123;\n\tvar javastack &#x3D; getJavastack();\n\tSystem.out.println(javastack);\n&#125;\n\npublic static String getJavastack() &#123;\n\treturn &quot;javastack&quot;;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>3ã€å¾ªç¯ä¸­å®šä¹‰å±€éƒ¨å˜é‡</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void testLoop() &#123;\n\tfor (var i &#x3D; 0; i &lt; 3; i++) &#123;\n\t\tfor (var m &#x3D; 10; m &lt; 15; m++) &#123;\n\t\t\tSystem.out.println(i + m);\n\t\t&#125;\n\t&#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>4ã€æ³›å‹ç»“åˆå±€éƒ¨å˜é‡</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void testGeneric() &#123;\n\t&#x2F;&#x2F; è¡¨è¾¾å¼1\n\tList&lt;String&gt; list1 &#x3D; new ArrayList&lt;&gt;();\n\tlist1.add(&quot;javastack&quot;);\n\n\t&#x2F;&#x2F; è¡¨è¾¾å¼2\n\tvar list2 &#x3D; new ArrayList&lt;&gt;();\n\tlist2.add(2018);\n\n\t&#x2F;&#x2F; è¡¨è¾¾å¼3\n\tvar list3 &#x3D; new ArrayList&lt;String&gt;();\n\tlist3.add(&quot;javastack&quot;);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¡¨è¾¾å¼1åé¢ <code>&lt;&gt;</code> é‡Œé¢ jdk 1.7+å¼€å§‹æ˜¯ä¸ç”¨å¸¦å…·ä½“ç±»å‹çš„ï¼Œåœ¨æ¥å£ä¸­æŒ‡æ˜å°±è¡Œäº†ã€‚</p>\n<p>è¡¨è¾¾å¼2ä¸­å¦‚æœä½¿ç”¨ <code>var</code> çš„è¯ï¼Œ<code>&lt;&gt;</code> é‡Œé¢é»˜è®¤ä¼šæ˜¯ <code>Object</code> çš„ï¼Œæ‰€ä»¥å¯ä»¥æ·»åŠ ä»»æ„ç±»å‹ã€‚</p>\n<p>è¡¨è¾¾å¼3ä¸­åœ¨ <code>&lt;&gt;</code> å¼ºåˆ¶ä½¿ç”¨äº† String æ¥æŒ‡å®šæ³›å‹ã€‚</p>\n<h3 id=\"å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä¸èƒ½ç”¨åœ¨ä»¥ä¸‹åœºæ™¯\"><a href=\"#å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä¸èƒ½ç”¨åœ¨ä»¥ä¸‹åœºæ™¯\" class=\"headerlink\" title=\"å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä¸èƒ½ç”¨åœ¨ä»¥ä¸‹åœºæ™¯\"></a>å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä¸èƒ½ç”¨åœ¨ä»¥ä¸‹åœºæ™¯</h3><p><strong>1ã€ç±»æˆå‘˜å˜é‡ç±»å‹</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; ç¼–è¯‘æŠ¥é”™\nprivate var javastack &#x3D; &quot;JavaæŠ€æœ¯&quot;;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p><strong>2ã€æ–¹æ³•è¿”å›ç±»å‹</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * ç¼–è¯‘æŠ¥é”™\n * @return\n *&#x2F;\npublic static var getJavastack()&#123;\n \treturn &quot;JavaæŠ€æœ¯&quot;;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>3ã€Lambda è¡¨è¾¾å¼</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void testLambda() &#123;\n\tRunnable runnable &#x3D; () -&gt; System.out.println(&quot;javastack&quot;);\n\n\t&#x2F;&#x2F; ç¼–è¯‘æŠ¥é”™\n\t&#x2F;&#x2F; var runnable &#x3D; () -&gt; System.out.println(&quot;javastack&quot;);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä»¥ä¸Š 3 ç§åœºæ™¯æ˜¯è‚¯å®šä¸èƒ½ä½¿ç”¨ <code>var</code> çš„ï¼Œå…¶ä»–åœºåˆæœ‰å¾…éªŒè¯ã€‚</p>\n<h3 id=\"å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä¼˜ç¼ºç‚¹\"><a href=\"#å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä¼˜ç¼ºç‚¹\" class=\"headerlink\" title=\"å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä¼˜ç¼ºç‚¹\"></a>å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä¼˜ç¼ºç‚¹</h3><p><strong>ä¼˜ç‚¹ï¼šç®€åŒ–ä»£ç </strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">CopyOnWriteArrayList list1 &#x3D; new CopyOnWriteArrayList();\nConcurrentModificationException cme1 &#x3D; new ConcurrentModificationException();\nDefaultServiceUnavailableRetryStrategy strategy1 &#x3D; new\n\t\tDefaultServiceUnavailableRetryStrategy();\n\nvar list2 &#x3D; new CopyOnWriteArrayList&lt;&gt;();\nvar cme2 &#x3D; new ConcurrentModificationException();\nvar strategy2 &#x3D; new DefaultServiceUnavailableRetryStrategy();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä»ä»¥ä¸Šä»£ç å¯ä»¥çœ‹å‡ºï¼Œå¾ˆé•¿çš„å®šä¹‰ç±»å‹ä¼šæ˜¾å¾—ä»£ç å¾ˆå†—é•¿ï¼Œä½¿ç”¨ var å¤§å¤§ç®€åŒ–äº†ä»£ç ç¼–å†™ï¼ŒåŒæ—¶ç±»å‹ç»Ÿä¸€æ˜¾å¾—ä»£ç å¾ˆå¯¹é½ã€‚</p>\n<p><strong>ç¼ºç‚¹ï¼šæ©ç›–ç±»å‹</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">var token &#x3D; new JsonParserDelegate(parser).currentToken();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>çœ‹ä»¥ä¸Šä»£ç ï¼Œä¸è¿›å»çœ‹è¿”å›ç»“æœç±»å‹ï¼Œè°çŸ¥é“è¿”å›çš„ç±»å‹æ˜¯ä»€ä¹ˆï¼Ÿæ‰€ä»¥è¿™ç§æƒ…å†µæœ€å¥½åˆ«ä½¿ç”¨ <code>var</code>ï¼Œè€Œä½¿ç”¨å…·ä½“çš„æŠ½è±¡ç±»ã€æ¥å£æˆ–è€…å®ä¾‹ç±»å‹ã€‚</p>\n<h3 id=\"varå…³é”®å­—åŸç†\"><a href=\"#varå…³é”®å­—åŸç†\" class=\"headerlink\" title=\"varå…³é”®å­—åŸç†\"></a>varå…³é”®å­—åŸç†</h3><p>varå…¶å®å°±æ˜¯ Java 10 å¢åŠ çš„ä¸€ç§è¯­æ³•ç³–è€Œå·²ï¼Œåœ¨ç¼–è¯‘æœŸé—´ä¼šè‡ªåŠ¨æ¨æ–­å®é™…ç±»å‹ï¼Œå…¶ç¼–è¯‘åçš„å­—èŠ‚ç å’Œå®é™…ç±»å‹ä¸€è‡´ï¼Œå¦‚ä»¥ä¸‹ä¾‹å­æ‰€ç¤ºã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void testByteCode() &#123;\n\tString javastack1 &#x3D; &quot;javastack&quot;;\n\tvar javastack2 &#x3D; &quot;javastack&quot;;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¼–è¯‘æˆå­—èŠ‚ç åï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static testByteCode()V\nL0\nLINENUMBER 22 L0\nLDC &quot;javastack&quot;\nASTORE 0\nL1\nLINENUMBER 23 L1\nLDC &quot;javastack&quot;\nASTORE 1\nL2\nLINENUMBER 24 L2\nRETURN\nL3\nLOCALVARIABLE javastack1 Ljava&#x2F;lang&#x2F;String; L1 L3 0\nLOCALVARIABLE javastack2 Ljava&#x2F;lang&#x2F;String; L2 L3 1\nMAXSTACK &#x3D; 1\nMAXLOCALS &#x3D; 2<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥çœ‹å‡º <code>javastack1</code> å’Œ <code>javastack2</code> éƒ½æ˜¯è™šæ‹Ÿæœºæ‰€è®¤è¯†çš„çš„æœ¬åœ°å˜é‡ç±»å‹ï¼š<code>java.lang.String</code>ï¼Œè™šæ‹Ÿæœºå¹¶ä¸è®¤è¯† var,  æ‰€ä»¥ <code>var</code> å¹¶ä¸ç¥å¥‡ã€‚</p>\n<p>OKï¼Œæœ¬æ¬¡ Java 10 å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­å®æˆ˜æ–‡ç« å°±åˆ°è¿™é‡Œäº†ï¼Œåç»­å¸¦æ¥æ›´å¤šçš„ Java 10 çš„å®æˆ˜æ–¹é¢çš„æ–‡ç« ã€‚</p>\n","excerpt":"","more":"<p>ç°åœ¨ Java 9 è¢«é—å¼ƒäº†ç›´æ¥å‡çº§åˆ°äº† Java 10ï¼Œä¹‹å‰ä¹Ÿå‘è¿‡ Java 10 æ–°ç‰¹æ€§çš„æ–‡ç« ï¼Œç°åœ¨æ˜¯å¼€å§‹å®æˆ˜ Java 10 çš„æ—¶å€™äº†ã€‚</p>\n<p>ä»Šå¤©è¦å®æˆ˜çš„æ˜¯ Java 10 ä¸­æœ€é‡è¦çš„ç‰¹æ€§ï¼šå±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ï¼Œå¤§å®¶éƒ½çŸ¥é“æ˜¯ <code>var</code> å…³é”®å­—ï¼Œä½†å…·ä½“æ€ä¹ˆä½¿ç”¨ï¼ŒåŠè¦æ³¨æ„ä»€ä¹ˆè¦ç‚¹å‘¢ï¼Ÿ</p>\n<p>æˆ‘ä»¬é€šè¿‡å‡ ä¸ªä¾‹å­æ¥è®²è§£å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­è¿™ä¸ªæ–°ç‰¹æ€§ï¼</p>\n<h3 id=\"ä»€ä¹ˆæ˜¯å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­\"><a href=\"#ä»€ä¹ˆæ˜¯å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­\"></a>ä»€ä¹ˆæ˜¯å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">var javastack &#x3D; &quot;javastack&quot;;\nSystem.out.println(javastack);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>å¤§å®¶çœ‹å‡ºæ¥äº†ï¼Œå±€éƒ¨å˜é‡ç±»å‹æ¨æ–­å°±æ˜¯å·¦è¾¹çš„ç±»å‹ç›´æ¥ä½¿ç”¨ <code>var</code> å®šä¹‰ï¼Œè€Œä¸ç”¨å†™å…·ä½“çš„ç±»å‹ï¼Œç¼–è¯‘å™¨èƒ½æ ¹æ®å³è¾¹çš„è¡¨è¾¾å¼è‡ªåŠ¨æ¨æ–­ç±»å‹ï¼Œå¦‚ä¸Šé¢çš„ <code>String</code> ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">var javastack &#x3D; &quot;javastack&quot;;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>å°±ç­‰äºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">String javastack &#x3D; &quot;javastack&quot;;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h3 id=\"å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä½¿ç”¨ç¤ºä¾‹\"><a href=\"#å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä½¿ç”¨ç¤ºä¾‹\" class=\"headerlink\" title=\"å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä½¿ç”¨ç¤ºä¾‹\"></a>å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä½¿ç”¨ç¤ºä¾‹</h3><p>æ—¢ç„¶å«å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ï¼Œä»¥åªèƒ½ç”¨åœ¨å±€éƒ¨å˜é‡ä¸­ï¼Œä¸‹é¢ç»™å‡ºæ›´å¤šä½¿ç”¨ç¤ºä¾‹ã€‚</p>\n<p><strong>1ã€å­—é¢é‡å®šä¹‰å±€éƒ¨å˜é‡</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void testVar() &#123;\n\tvar javastack &#x3D; &quot;javastack&quot;;\n\tSystem.out.println(javastack);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>2ã€æ¥æ”¶æ–¹æ³•è¿”å›å€¼å®šä¹‰å±€éƒ¨å˜é‡</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void testMethod() &#123;\n\tvar javastack &#x3D; getJavastack();\n\tSystem.out.println(javastack);\n&#125;\n\npublic static String getJavastack() &#123;\n\treturn &quot;javastack&quot;;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>3ã€å¾ªç¯ä¸­å®šä¹‰å±€éƒ¨å˜é‡</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void testLoop() &#123;\n\tfor (var i &#x3D; 0; i &lt; 3; i++) &#123;\n\t\tfor (var m &#x3D; 10; m &lt; 15; m++) &#123;\n\t\t\tSystem.out.println(i + m);\n\t\t&#125;\n\t&#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>4ã€æ³›å‹ç»“åˆå±€éƒ¨å˜é‡</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void testGeneric() &#123;\n\t&#x2F;&#x2F; è¡¨è¾¾å¼1\n\tList&lt;String&gt; list1 &#x3D; new ArrayList&lt;&gt;();\n\tlist1.add(&quot;javastack&quot;);\n\n\t&#x2F;&#x2F; è¡¨è¾¾å¼2\n\tvar list2 &#x3D; new ArrayList&lt;&gt;();\n\tlist2.add(2018);\n\n\t&#x2F;&#x2F; è¡¨è¾¾å¼3\n\tvar list3 &#x3D; new ArrayList&lt;String&gt;();\n\tlist3.add(&quot;javastack&quot;);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¡¨è¾¾å¼1åé¢ <code>&lt;&gt;</code> é‡Œé¢ jdk 1.7+å¼€å§‹æ˜¯ä¸ç”¨å¸¦å…·ä½“ç±»å‹çš„ï¼Œåœ¨æ¥å£ä¸­æŒ‡æ˜å°±è¡Œäº†ã€‚</p>\n<p>è¡¨è¾¾å¼2ä¸­å¦‚æœä½¿ç”¨ <code>var</code> çš„è¯ï¼Œ<code>&lt;&gt;</code> é‡Œé¢é»˜è®¤ä¼šæ˜¯ <code>Object</code> çš„ï¼Œæ‰€ä»¥å¯ä»¥æ·»åŠ ä»»æ„ç±»å‹ã€‚</p>\n<p>è¡¨è¾¾å¼3ä¸­åœ¨ <code>&lt;&gt;</code> å¼ºåˆ¶ä½¿ç”¨äº† String æ¥æŒ‡å®šæ³›å‹ã€‚</p>\n<h3 id=\"å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä¸èƒ½ç”¨åœ¨ä»¥ä¸‹åœºæ™¯\"><a href=\"#å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä¸èƒ½ç”¨åœ¨ä»¥ä¸‹åœºæ™¯\" class=\"headerlink\" title=\"å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä¸èƒ½ç”¨åœ¨ä»¥ä¸‹åœºæ™¯\"></a>å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä¸èƒ½ç”¨åœ¨ä»¥ä¸‹åœºæ™¯</h3><p><strong>1ã€ç±»æˆå‘˜å˜é‡ç±»å‹</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; ç¼–è¯‘æŠ¥é”™\nprivate var javastack &#x3D; &quot;JavaæŠ€æœ¯&quot;;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p><strong>2ã€æ–¹æ³•è¿”å›ç±»å‹</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;**\n * ç¼–è¯‘æŠ¥é”™\n * @return\n *&#x2F;\npublic static var getJavastack()&#123;\n \treturn &quot;JavaæŠ€æœ¯&quot;;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>3ã€Lambda è¡¨è¾¾å¼</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void testLambda() &#123;\n\tRunnable runnable &#x3D; () -&gt; System.out.println(&quot;javastack&quot;);\n\n\t&#x2F;&#x2F; ç¼–è¯‘æŠ¥é”™\n\t&#x2F;&#x2F; var runnable &#x3D; () -&gt; System.out.println(&quot;javastack&quot;);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä»¥ä¸Š 3 ç§åœºæ™¯æ˜¯è‚¯å®šä¸èƒ½ä½¿ç”¨ <code>var</code> çš„ï¼Œå…¶ä»–åœºåˆæœ‰å¾…éªŒè¯ã€‚</p>\n<h3 id=\"å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä¼˜ç¼ºç‚¹\"><a href=\"#å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä¼˜ç¼ºç‚¹\" class=\"headerlink\" title=\"å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä¼˜ç¼ºç‚¹\"></a>å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ä¼˜ç¼ºç‚¹</h3><p><strong>ä¼˜ç‚¹ï¼šç®€åŒ–ä»£ç </strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">CopyOnWriteArrayList list1 &#x3D; new CopyOnWriteArrayList();\nConcurrentModificationException cme1 &#x3D; new ConcurrentModificationException();\nDefaultServiceUnavailableRetryStrategy strategy1 &#x3D; new\n\t\tDefaultServiceUnavailableRetryStrategy();\n\nvar list2 &#x3D; new CopyOnWriteArrayList&lt;&gt;();\nvar cme2 &#x3D; new ConcurrentModificationException();\nvar strategy2 &#x3D; new DefaultServiceUnavailableRetryStrategy();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä»ä»¥ä¸Šä»£ç å¯ä»¥çœ‹å‡ºï¼Œå¾ˆé•¿çš„å®šä¹‰ç±»å‹ä¼šæ˜¾å¾—ä»£ç å¾ˆå†—é•¿ï¼Œä½¿ç”¨ var å¤§å¤§ç®€åŒ–äº†ä»£ç ç¼–å†™ï¼ŒåŒæ—¶ç±»å‹ç»Ÿä¸€æ˜¾å¾—ä»£ç å¾ˆå¯¹é½ã€‚</p>\n<p><strong>ç¼ºç‚¹ï¼šæ©ç›–ç±»å‹</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">var token &#x3D; new JsonParserDelegate(parser).currentToken();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>çœ‹ä»¥ä¸Šä»£ç ï¼Œä¸è¿›å»çœ‹è¿”å›ç»“æœç±»å‹ï¼Œè°çŸ¥é“è¿”å›çš„ç±»å‹æ˜¯ä»€ä¹ˆï¼Ÿæ‰€ä»¥è¿™ç§æƒ…å†µæœ€å¥½åˆ«ä½¿ç”¨ <code>var</code>ï¼Œè€Œä½¿ç”¨å…·ä½“çš„æŠ½è±¡ç±»ã€æ¥å£æˆ–è€…å®ä¾‹ç±»å‹ã€‚</p>\n<h3 id=\"varå…³é”®å­—åŸç†\"><a href=\"#varå…³é”®å­—åŸç†\" class=\"headerlink\" title=\"varå…³é”®å­—åŸç†\"></a>varå…³é”®å­—åŸç†</h3><p>varå…¶å®å°±æ˜¯ Java 10 å¢åŠ çš„ä¸€ç§è¯­æ³•ç³–è€Œå·²ï¼Œåœ¨ç¼–è¯‘æœŸé—´ä¼šè‡ªåŠ¨æ¨æ–­å®é™…ç±»å‹ï¼Œå…¶ç¼–è¯‘åçš„å­—èŠ‚ç å’Œå®é™…ç±»å‹ä¸€è‡´ï¼Œå¦‚ä»¥ä¸‹ä¾‹å­æ‰€ç¤ºã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void testByteCode() &#123;\n\tString javastack1 &#x3D; &quot;javastack&quot;;\n\tvar javastack2 &#x3D; &quot;javastack&quot;;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¼–è¯‘æˆå­—èŠ‚ç åï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static testByteCode()V\nL0\nLINENUMBER 22 L0\nLDC &quot;javastack&quot;\nASTORE 0\nL1\nLINENUMBER 23 L1\nLDC &quot;javastack&quot;\nASTORE 1\nL2\nLINENUMBER 24 L2\nRETURN\nL3\nLOCALVARIABLE javastack1 Ljava&#x2F;lang&#x2F;String; L1 L3 0\nLOCALVARIABLE javastack2 Ljava&#x2F;lang&#x2F;String; L2 L3 1\nMAXSTACK &#x3D; 1\nMAXLOCALS &#x3D; 2<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥çœ‹å‡º <code>javastack1</code> å’Œ <code>javastack2</code> éƒ½æ˜¯è™šæ‹Ÿæœºæ‰€è®¤è¯†çš„çš„æœ¬åœ°å˜é‡ç±»å‹ï¼š<code>java.lang.String</code>ï¼Œè™šæ‹Ÿæœºå¹¶ä¸è®¤è¯† var,  æ‰€ä»¥ <code>var</code> å¹¶ä¸ç¥å¥‡ã€‚</p>\n<p>OKï¼Œæœ¬æ¬¡ Java 10 å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­å®æˆ˜æ–‡ç« å°±åˆ°è¿™é‡Œäº†ï¼Œåç»­å¸¦æ¥æ›´å¤šçš„ Java 10 çš„å®æˆ˜æ–¹é¢çš„æ–‡ç« ã€‚</p>\n"},{"title":"Java 10 çš„ 10 ä¸ªæ–°ç‰¹æ€§ï¼Œå°†å½»åº•æ”¹å˜ä½ å†™ä»£ç çš„æ–¹å¼","date":"2025-10-15T03:36:33.000Z","_content":"\n![image](http://img.javastack.cn/18-3-8/94675270.jpg)\n\nJava 9æ‰å‘å¸ƒå‡ ä¸ªæœˆï¼Œå¾ˆå¤šç©æ„éƒ½æ²¡æ•´æ˜ç™½ï¼Œç°åœ¨Java 10åˆå¿«è¦æ¥äº†ã€‚ã€‚\n\nè¿™æ—¶å€™æˆ‘çœŸå°¼ç›æƒ³è¯´ï¼šçº¿ä¸Šç”¨çš„JDK 7 ç”šè‡³JDK 6ï¼ŒJDK 8 è¿˜æ²¡ç”¨ç†Ÿï¼ŒJDK 9 æ‰å‘å¸ƒä¸ä¹…ä¸çŸ¥é“å•¥ç©æ„ï¼ŒJDK 10â€¦â€¦\n\nåˆšå­¦Javaçš„åŒå­¦æ˜¯ä¸æ˜¯æ„Ÿè§‰ä¸€è„¸è’™é€¼ï¼Ÿï¼ï¼ï¼\n\nå°±è¿æˆ‘è¿™ä¸ªè€å¸æœºä¹ŸåŒæ ·æ„Ÿè§‰å¦‚æ­¤ï¼\n\nJava æ›´æ–°è¶Šæ¥è¶Šå¿«ï¼Œæˆ‘ä»¬åšæŠ€æœ¯çš„ä¹Ÿè¦è·Ÿä¸Šæ­¥ä¼ï¼Œä¸ç„¶æ€»ä¼šæ…¢åˆ«äººä¸€æ‹ï¼Œè¿™æ–°ä¸œè¥¿ä»å›½å¤–åˆ°å›½å†…åº”ç”¨ä¸€èˆ¬è¦å¥½å‡ å¹´çš„æ—¶é—´ï¼Œå¦‚æœæˆ‘ä»¬æå‰äº†è§£å¹¶åº”ç”¨è¿™äº›æ–°æŠ€æœ¯å¯¹è‡ªå·±ä¸æ˜¯åäº‹ã€‚\n\n### Java 10çš„æ–°ç‰¹æ€§\n\nè¯´äº†è¿™ä¹ˆå¤šï¼Œçœ‹Java 10éƒ½ä¼šæœ‰å“ªäº›ç‰¹æ€§æ¥æ”¹å˜æˆ‘ä»¬å†™ä»£ç çš„æ–¹å¼å‘¢ï¼Ÿï¼\n\n#### 1.å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­\n\nå±€éƒ¨å˜é‡ç±»å‹æ¨æ–­å¯ä»¥è¯´æ˜¯Java 10ä¸­æœ€å€¼å¾—æ³¨æ„çš„ç‰¹æ€§ï¼Œè¿™æ˜¯Javaè¯­è¨€å¼€å‘äººå‘˜ä¸ºäº†ç®€åŒ–Javaåº”ç”¨ç¨‹åºçš„ç¼–å†™è€Œé‡‡å–çš„åˆä¸€æ­¥ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\n\n![image](http://img.javastack.cn/18-3-8/56770623.jpg)\n\nè¿™ä¸ªæ–°åŠŸèƒ½å°†ä¸ºJavaå¢åŠ ä¸€äº›è¯­æ³•ç³– - ç®€åŒ–å®ƒå¹¶æ”¹å–„å¼€å‘è€…ä½“éªŒã€‚æ–°çš„è¯­æ³•å°†å‡å°‘ä¸ç¼–å†™Javaç›¸å…³çš„å†—é•¿åº¦ï¼ŒåŒæ—¶ä¿æŒå¯¹é™æ€ç±»å‹å®‰å…¨æ€§çš„æ‰¿è¯ºã€‚\n\nå±€éƒ¨å˜é‡ç±»å‹æ¨æ–­å°†å¼•å…¥\"var\"å…³é”®å­—ï¼Œä¹Ÿå°±æ˜¯ä½ å¯ä»¥éšæ„å®šä¹‰å˜é‡è€Œä¸å¿…æŒ‡å®šå˜é‡çš„ç±»å‹ï¼Œå¦‚ï¼š\n\n```\nList <String> list = new ArrayList <String>ï¼ˆï¼‰; \nStream <String> stream = getStreamï¼ˆï¼‰;\n```\n\nå°†è¢«ä¸‹é¢è¿™ä¸ªæ–°è¯­æ³•æ‰€å–ä»£ï¼š\n\n```\nvar list = new ArrayList <String>ï¼ˆï¼‰; \nvar stream = getStreamï¼ˆï¼‰;\n```\n\nçœ‹å®Œæ˜¯ä¸æ˜¯æœ‰ç‚¹JSçš„å³è§†æ„Ÿï¼Ÿï¼Ÿï¼Ÿè¶Šæ¥è¶ŠåƒJSäº†å—ï¼Ÿï¼è™½ç„¶ç±»å‹æ¨æ–­åœ¨Javaä¸­ä¸æ˜¯ä¸€ä¸ªæ–°æ¦‚å¿µï¼Œä½†åœ¨å±€éƒ¨å˜é‡ä¸­ç¡®æ˜¯å¾ˆå¤§çš„ä¸€ä¸ªæ”¹è¿›ã€‚\n\nè¯´åˆ°ç±»å‹æ¨æ–­ï¼Œä»JDK 5å¼•è¿›æ³›å‹ï¼Œåˆ°JDK 7çš„\"<>\"æ“ä½œç¬¦å…è®¸ä¸ç»‘å®šç±»å‹è€Œåˆå§‹åŒ–Listï¼Œå†åˆ°JDK 8çš„Lambdaè¡¨è¾¾å¼ï¼Œå†åˆ°ç°åœ¨JDK 10çš„å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ï¼ŒJavaç±»å‹æ¨æ–­æ­£å¤§åˆ€é˜”æ–§çš„å‘å‰å‘å±•ã€‚\n\n```\n// è¯¥è¿ç®—ç¬¦å…è®¸åœ¨æ²¡æœ‰ç»‘å®šArrayList <>çš„ç±»å‹çš„æƒ…å†µä¸‹åˆå§‹åŒ–åˆ—è¡¨\nList <String> list = new LinkedList <>ï¼ˆï¼‰;\n```\n\n**å±€éƒ¨å˜é‡ç±»å‹æ¨èä»…é™äºå¦‚ä¸‹ä½¿ç”¨åœºæ™¯ï¼š**\n\n- å±€éƒ¨å˜é‡åˆå§‹åŒ–\n- forå¾ªç¯å†…éƒ¨ç´¢å¼•å˜é‡\n- ä¼ ç»Ÿçš„forå¾ªç¯å£°æ˜å˜é‡\n\n**Javaå®˜æ–¹è¡¨ç¤ºï¼Œå®ƒä¸èƒ½ç”¨äºä»¥ä¸‹å‡ ä¸ªåœ°æ–¹ï¼š**\n\n- æ–¹æ³•å‚æ•°\n- æ„é€ å‡½æ•°å‚æ•°\n- æ–¹æ³•è¿”å›ç±»å‹\n- å­—æ®µ\n- æ•è·è¡¨è¾¾å¼ï¼ˆæˆ–ä»»ä½•å…¶ä»–ç±»å‹çš„å˜é‡å£°æ˜ï¼‰\n\n#### 2.GCæ”¹è¿›å’Œå…¶ä»–å†…åŠ¡ç®¡ç†\n\nJDK 10ä¸­æœ‰2ä¸ªJEPä¸“é—¨ç”¨äºæ”¹è¿›å½“å‰çš„åƒåœ¾æ”¶é›†å…ƒç´ ã€‚\n\nç¬¬ä¸€ä¸ªåƒåœ¾æ”¶é›†å™¨æ¥å£æ˜¯ï¼ˆJEP 304ï¼‰ï¼Œå®ƒå°†å¼•å…¥ä¸€ä¸ªçº¯å‡€çš„åƒåœ¾æ”¶é›†å™¨æ¥å£ï¼Œä»¥å¸®åŠ©æ”¹è¿›ä¸åŒåƒåœ¾æ”¶é›†å™¨çš„æºä»£ç éš”ç¦»ã€‚\n\né¢„å®šç”¨äºJava 10çš„ç¬¬äºŒä¸ªJEPæ˜¯é’ˆå¯¹G1çš„å¹¶è¡Œå®Œå…¨GCï¼ˆJEP 307ï¼‰ï¼Œå…¶é‡ç‚¹åœ¨äºé€šè¿‡å®Œå…¨GCå¹¶è¡Œæ¥æ”¹å–„G1æœ€åæƒ…å†µçš„ç­‰å¾…æ—¶é—´ã€‚G1æ˜¯Java 9ä¸­çš„é»˜è®¤GCï¼Œå¹¶ä¸”æ­¤JEPçš„ç›®æ ‡æ˜¯ä½¿G1å¹³è¡Œã€‚\n\n#### 3.çº¿ç¨‹æœ¬åœ°æ¡æ‰‹ï¼ˆJEP 312ï¼‰\n\nJDK 10å°†å¼•å…¥ä¸€ç§åœ¨çº¿ç¨‹ä¸Šæ‰§è¡Œå›è°ƒçš„æ–°æ–¹æ³•ï¼Œå› æ­¤è¿™å°†ä¼šå¾ˆæ–¹ä¾¿èƒ½åœæ­¢å•ä¸ªçº¿ç¨‹è€Œä¸æ˜¯åœæ­¢å…¨éƒ¨çº¿ç¨‹æˆ–è€…ä¸€ä¸ªéƒ½ä¸åœã€‚\n\n#### 4.å¤‡ç”¨å†…å­˜è®¾å¤‡ä¸Šçš„å †åˆ†é…ï¼ˆJEP 316ï¼‰\n\nå…è®¸HotSpot VMåœ¨å¤‡ç”¨å†…å­˜è®¾å¤‡ä¸Šåˆ†é…Javaå¯¹è±¡å †å†…å­˜ï¼Œè¯¥å†…å­˜è®¾å¤‡å°†ç”±ç”¨æˆ·æŒ‡å®šã€‚\n\n#### 5.å…¶ä»–Unicodeè¯­è¨€ - æ ‡è®°æ‰©å±•ï¼ˆJEP 314ï¼‰\n\nç›®æ ‡æ˜¯å¢å¼ºjava.util.LocaleåŠå…¶ç›¸å…³çš„APIï¼Œä»¥ä¾¿å®ç°è¯­è¨€æ ‡è®°è¯­æ³•çš„å…¶ä»–Unicodeæ‰©å±•ï¼ˆBCP 47ï¼‰ã€‚\n\n#### 6.åŸºäºJavaçš„å®éªŒæ€§JITç¼–è¯‘å™¨ï¼ˆJEP 317ï¼‰\n\nOracleå¸Œæœ›å°†å…¶Java JITç¼–è¯‘å™¨Graalç”¨ä½œLinux / x64å¹³å°ä¸Šçš„å®éªŒæ€§JITç¼–è¯‘å™¨ã€‚\n\n#### 7.æ ¹è¯ä¹¦ï¼ˆJEP 319ï¼‰\n\nè¿™ä¸ªçš„ç›®æ ‡æ˜¯åœ¨Oracleçš„Java SEä¸­å¼€æºæ ¹è¯ä¹¦ã€‚\n\n#### 8.æ ¹è¯ä¹¦è®¤è¯ç¨‹åºï¼ˆCAï¼‰\n\nè¿™å°†ä½¿OpenJDKå¯¹å¼€å‘äººå‘˜æ›´å…·å¸å¼•åŠ›ï¼Œå®ƒè¿˜æ—¨åœ¨å‡å°‘OpenJDKå’ŒOracle JDKæ„å»ºä¹‹é—´çš„å·®å¼‚ã€‚\n\n#### 9.å°†JDKç”Ÿæ€æ•´åˆåˆ°å•ä¸ªå­˜å‚¨åº“ä¸­ï¼ˆJEP 296ï¼‰\n\næ­¤JEPçš„ä¸»è¦ç›®æ ‡æ˜¯æ‰§è¡Œä¸€äº›å†…å­˜ç®¡ç†ï¼Œå¹¶å°†JDKç”Ÿæ€çš„ä¼—å¤šå­˜å‚¨åº“ç»„åˆåˆ°ä¸€ä¸ªå­˜å‚¨åº“ä¸­ã€‚\n\n#### 10.åˆ é™¤Native-Headerç”Ÿæˆå·¥å…·ï¼ˆjavahï¼‰ï¼ˆJEP 313ï¼‰\n\nä»JDKä¸­ç§»é™¤äº†javahå·¥å…·ï¼Œè¿™ä¸ªå¾ˆç®€å•å¹¶ä¸”å¾ˆé‡è¦ã€‚\n\n### å°é²œ\n\nå°±åƒæ‰€æœ‰å…¶ä»–JDKç‰ˆæœ¬ä¸€æ ·ï¼ŒOracleå·²ç»å‘å¸ƒäº†ä¸€ä¸ªJava 10åˆå§‹å€™é€‰ç‰ˆæœ¬ï¼ŒJavaå¼€å‘è€…å¯ä»¥ä¸‹è½½æ­¤ç‰ˆæœ¬ç”¨æ¥æµ‹è¯•æ–°åŠŸèƒ½ã€‚å¦‚æœä½ å¯¹Java 10æŠ±æœ‰æœŸå¾…æƒ³ææ—©å°è¯•ï¼Œé‚£ä¹ˆç°åœ¨å°±å¼€å§‹å§ï¼\n\n> å°é²œåœ°å€ï¼šhttp://openjdk.java.net/projects/jdk/10/\n\n#### æœ€åçš„æ„Ÿæ‚Ÿ\n\nå¯¹äºç¬¬ä¸€ç‚¹æ–°ç‰¹æ€§æ¥è¯´ç¡®å®æ˜¯ä¸€ä¸ªå¤§çš„è·¨è¶Šï¼Œå…¶ä»–ç‰¹æ€§æˆ–å¤šæˆ–å°‘éƒ½èƒ½å¸¦ç»™å¼€å‘è€…ç¦éŸ³ã€‚ä½†æœ€ç»ˆJava 10ä¼šæ˜¯ä»€ä¹ˆæ ·ï¼Œæˆ–è®¸è¿˜ä¼šå¢åŠ æ›´å¤šå®ç”¨æ€§çš„æ–°åŠŸèƒ½æˆ–è€…ä¼˜åŒ–ï¼Œæˆ‘ä»¬è¿˜å¾—æœŸå¾…ï¼\n\nç°åœ¨è¦åšçš„å°±æ˜¯ï¼Œèµ¶ç´§ç†Ÿæ‚‰JDK 8ï¼Œç°åœ¨å·²ç»æ˜¯å¾ˆå¤šäº’è”ç½‘ä¼ä¸šæ ‡é…äº†ã€‚å¦‚æœè¿˜åœ¨ä½¿ç”¨JDK4-7ï¼Œé‚£çœŸçš„æ˜¯è¦OUTäº†ã€‚ã€‚\n\nåœ¨ä¸ä¹…çš„å°†æ¥ï¼ŒJava 10å°†å½»åº•æ”¹å˜ä½ å†™ä»£ç çš„æ–¹å¼ï¼\n\n","source":"_posts/æ–°ç‰¹æ€§/Java10/Java 10 çš„ 10 ä¸ªæ–°ç‰¹æ€§ï¼Œå°†å½»åº•æ”¹å˜ä½ å†™ä»£ç çš„æ–¹å¼.md","raw":"---\ntitle: Java 10 çš„ 10 ä¸ªæ–°ç‰¹æ€§ï¼Œå°†å½»åº•æ”¹å˜ä½ å†™ä»£ç çš„æ–¹å¼\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: æ–°ç‰¹æ€§\n---\n\n![image](http://img.javastack.cn/18-3-8/94675270.jpg)\n\nJava 9æ‰å‘å¸ƒå‡ ä¸ªæœˆï¼Œå¾ˆå¤šç©æ„éƒ½æ²¡æ•´æ˜ç™½ï¼Œç°åœ¨Java 10åˆå¿«è¦æ¥äº†ã€‚ã€‚\n\nè¿™æ—¶å€™æˆ‘çœŸå°¼ç›æƒ³è¯´ï¼šçº¿ä¸Šç”¨çš„JDK 7 ç”šè‡³JDK 6ï¼ŒJDK 8 è¿˜æ²¡ç”¨ç†Ÿï¼ŒJDK 9 æ‰å‘å¸ƒä¸ä¹…ä¸çŸ¥é“å•¥ç©æ„ï¼ŒJDK 10â€¦â€¦\n\nåˆšå­¦Javaçš„åŒå­¦æ˜¯ä¸æ˜¯æ„Ÿè§‰ä¸€è„¸è’™é€¼ï¼Ÿï¼ï¼ï¼\n\nå°±è¿æˆ‘è¿™ä¸ªè€å¸æœºä¹ŸåŒæ ·æ„Ÿè§‰å¦‚æ­¤ï¼\n\nJava æ›´æ–°è¶Šæ¥è¶Šå¿«ï¼Œæˆ‘ä»¬åšæŠ€æœ¯çš„ä¹Ÿè¦è·Ÿä¸Šæ­¥ä¼ï¼Œä¸ç„¶æ€»ä¼šæ…¢åˆ«äººä¸€æ‹ï¼Œè¿™æ–°ä¸œè¥¿ä»å›½å¤–åˆ°å›½å†…åº”ç”¨ä¸€èˆ¬è¦å¥½å‡ å¹´çš„æ—¶é—´ï¼Œå¦‚æœæˆ‘ä»¬æå‰äº†è§£å¹¶åº”ç”¨è¿™äº›æ–°æŠ€æœ¯å¯¹è‡ªå·±ä¸æ˜¯åäº‹ã€‚\n\n### Java 10çš„æ–°ç‰¹æ€§\n\nè¯´äº†è¿™ä¹ˆå¤šï¼Œçœ‹Java 10éƒ½ä¼šæœ‰å“ªäº›ç‰¹æ€§æ¥æ”¹å˜æˆ‘ä»¬å†™ä»£ç çš„æ–¹å¼å‘¢ï¼Ÿï¼\n\n#### 1.å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­\n\nå±€éƒ¨å˜é‡ç±»å‹æ¨æ–­å¯ä»¥è¯´æ˜¯Java 10ä¸­æœ€å€¼å¾—æ³¨æ„çš„ç‰¹æ€§ï¼Œè¿™æ˜¯Javaè¯­è¨€å¼€å‘äººå‘˜ä¸ºäº†ç®€åŒ–Javaåº”ç”¨ç¨‹åºçš„ç¼–å†™è€Œé‡‡å–çš„åˆä¸€æ­¥ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚\n\n![image](http://img.javastack.cn/18-3-8/56770623.jpg)\n\nè¿™ä¸ªæ–°åŠŸèƒ½å°†ä¸ºJavaå¢åŠ ä¸€äº›è¯­æ³•ç³– - ç®€åŒ–å®ƒå¹¶æ”¹å–„å¼€å‘è€…ä½“éªŒã€‚æ–°çš„è¯­æ³•å°†å‡å°‘ä¸ç¼–å†™Javaç›¸å…³çš„å†—é•¿åº¦ï¼ŒåŒæ—¶ä¿æŒå¯¹é™æ€ç±»å‹å®‰å…¨æ€§çš„æ‰¿è¯ºã€‚\n\nå±€éƒ¨å˜é‡ç±»å‹æ¨æ–­å°†å¼•å…¥\"var\"å…³é”®å­—ï¼Œä¹Ÿå°±æ˜¯ä½ å¯ä»¥éšæ„å®šä¹‰å˜é‡è€Œä¸å¿…æŒ‡å®šå˜é‡çš„ç±»å‹ï¼Œå¦‚ï¼š\n\n```\nList <String> list = new ArrayList <String>ï¼ˆï¼‰; \nStream <String> stream = getStreamï¼ˆï¼‰;\n```\n\nå°†è¢«ä¸‹é¢è¿™ä¸ªæ–°è¯­æ³•æ‰€å–ä»£ï¼š\n\n```\nvar list = new ArrayList <String>ï¼ˆï¼‰; \nvar stream = getStreamï¼ˆï¼‰;\n```\n\nçœ‹å®Œæ˜¯ä¸æ˜¯æœ‰ç‚¹JSçš„å³è§†æ„Ÿï¼Ÿï¼Ÿï¼Ÿè¶Šæ¥è¶ŠåƒJSäº†å—ï¼Ÿï¼è™½ç„¶ç±»å‹æ¨æ–­åœ¨Javaä¸­ä¸æ˜¯ä¸€ä¸ªæ–°æ¦‚å¿µï¼Œä½†åœ¨å±€éƒ¨å˜é‡ä¸­ç¡®æ˜¯å¾ˆå¤§çš„ä¸€ä¸ªæ”¹è¿›ã€‚\n\nè¯´åˆ°ç±»å‹æ¨æ–­ï¼Œä»JDK 5å¼•è¿›æ³›å‹ï¼Œåˆ°JDK 7çš„\"<>\"æ“ä½œç¬¦å…è®¸ä¸ç»‘å®šç±»å‹è€Œåˆå§‹åŒ–Listï¼Œå†åˆ°JDK 8çš„Lambdaè¡¨è¾¾å¼ï¼Œå†åˆ°ç°åœ¨JDK 10çš„å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ï¼ŒJavaç±»å‹æ¨æ–­æ­£å¤§åˆ€é˜”æ–§çš„å‘å‰å‘å±•ã€‚\n\n```\n// è¯¥è¿ç®—ç¬¦å…è®¸åœ¨æ²¡æœ‰ç»‘å®šArrayList <>çš„ç±»å‹çš„æƒ…å†µä¸‹åˆå§‹åŒ–åˆ—è¡¨\nList <String> list = new LinkedList <>ï¼ˆï¼‰;\n```\n\n**å±€éƒ¨å˜é‡ç±»å‹æ¨èä»…é™äºå¦‚ä¸‹ä½¿ç”¨åœºæ™¯ï¼š**\n\n- å±€éƒ¨å˜é‡åˆå§‹åŒ–\n- forå¾ªç¯å†…éƒ¨ç´¢å¼•å˜é‡\n- ä¼ ç»Ÿçš„forå¾ªç¯å£°æ˜å˜é‡\n\n**Javaå®˜æ–¹è¡¨ç¤ºï¼Œå®ƒä¸èƒ½ç”¨äºä»¥ä¸‹å‡ ä¸ªåœ°æ–¹ï¼š**\n\n- æ–¹æ³•å‚æ•°\n- æ„é€ å‡½æ•°å‚æ•°\n- æ–¹æ³•è¿”å›ç±»å‹\n- å­—æ®µ\n- æ•è·è¡¨è¾¾å¼ï¼ˆæˆ–ä»»ä½•å…¶ä»–ç±»å‹çš„å˜é‡å£°æ˜ï¼‰\n\n#### 2.GCæ”¹è¿›å’Œå…¶ä»–å†…åŠ¡ç®¡ç†\n\nJDK 10ä¸­æœ‰2ä¸ªJEPä¸“é—¨ç”¨äºæ”¹è¿›å½“å‰çš„åƒåœ¾æ”¶é›†å…ƒç´ ã€‚\n\nç¬¬ä¸€ä¸ªåƒåœ¾æ”¶é›†å™¨æ¥å£æ˜¯ï¼ˆJEP 304ï¼‰ï¼Œå®ƒå°†å¼•å…¥ä¸€ä¸ªçº¯å‡€çš„åƒåœ¾æ”¶é›†å™¨æ¥å£ï¼Œä»¥å¸®åŠ©æ”¹è¿›ä¸åŒåƒåœ¾æ”¶é›†å™¨çš„æºä»£ç éš”ç¦»ã€‚\n\né¢„å®šç”¨äºJava 10çš„ç¬¬äºŒä¸ªJEPæ˜¯é’ˆå¯¹G1çš„å¹¶è¡Œå®Œå…¨GCï¼ˆJEP 307ï¼‰ï¼Œå…¶é‡ç‚¹åœ¨äºé€šè¿‡å®Œå…¨GCå¹¶è¡Œæ¥æ”¹å–„G1æœ€åæƒ…å†µçš„ç­‰å¾…æ—¶é—´ã€‚G1æ˜¯Java 9ä¸­çš„é»˜è®¤GCï¼Œå¹¶ä¸”æ­¤JEPçš„ç›®æ ‡æ˜¯ä½¿G1å¹³è¡Œã€‚\n\n#### 3.çº¿ç¨‹æœ¬åœ°æ¡æ‰‹ï¼ˆJEP 312ï¼‰\n\nJDK 10å°†å¼•å…¥ä¸€ç§åœ¨çº¿ç¨‹ä¸Šæ‰§è¡Œå›è°ƒçš„æ–°æ–¹æ³•ï¼Œå› æ­¤è¿™å°†ä¼šå¾ˆæ–¹ä¾¿èƒ½åœæ­¢å•ä¸ªçº¿ç¨‹è€Œä¸æ˜¯åœæ­¢å…¨éƒ¨çº¿ç¨‹æˆ–è€…ä¸€ä¸ªéƒ½ä¸åœã€‚\n\n#### 4.å¤‡ç”¨å†…å­˜è®¾å¤‡ä¸Šçš„å †åˆ†é…ï¼ˆJEP 316ï¼‰\n\nå…è®¸HotSpot VMåœ¨å¤‡ç”¨å†…å­˜è®¾å¤‡ä¸Šåˆ†é…Javaå¯¹è±¡å †å†…å­˜ï¼Œè¯¥å†…å­˜è®¾å¤‡å°†ç”±ç”¨æˆ·æŒ‡å®šã€‚\n\n#### 5.å…¶ä»–Unicodeè¯­è¨€ - æ ‡è®°æ‰©å±•ï¼ˆJEP 314ï¼‰\n\nç›®æ ‡æ˜¯å¢å¼ºjava.util.LocaleåŠå…¶ç›¸å…³çš„APIï¼Œä»¥ä¾¿å®ç°è¯­è¨€æ ‡è®°è¯­æ³•çš„å…¶ä»–Unicodeæ‰©å±•ï¼ˆBCP 47ï¼‰ã€‚\n\n#### 6.åŸºäºJavaçš„å®éªŒæ€§JITç¼–è¯‘å™¨ï¼ˆJEP 317ï¼‰\n\nOracleå¸Œæœ›å°†å…¶Java JITç¼–è¯‘å™¨Graalç”¨ä½œLinux / x64å¹³å°ä¸Šçš„å®éªŒæ€§JITç¼–è¯‘å™¨ã€‚\n\n#### 7.æ ¹è¯ä¹¦ï¼ˆJEP 319ï¼‰\n\nè¿™ä¸ªçš„ç›®æ ‡æ˜¯åœ¨Oracleçš„Java SEä¸­å¼€æºæ ¹è¯ä¹¦ã€‚\n\n#### 8.æ ¹è¯ä¹¦è®¤è¯ç¨‹åºï¼ˆCAï¼‰\n\nè¿™å°†ä½¿OpenJDKå¯¹å¼€å‘äººå‘˜æ›´å…·å¸å¼•åŠ›ï¼Œå®ƒè¿˜æ—¨åœ¨å‡å°‘OpenJDKå’ŒOracle JDKæ„å»ºä¹‹é—´çš„å·®å¼‚ã€‚\n\n#### 9.å°†JDKç”Ÿæ€æ•´åˆåˆ°å•ä¸ªå­˜å‚¨åº“ä¸­ï¼ˆJEP 296ï¼‰\n\næ­¤JEPçš„ä¸»è¦ç›®æ ‡æ˜¯æ‰§è¡Œä¸€äº›å†…å­˜ç®¡ç†ï¼Œå¹¶å°†JDKç”Ÿæ€çš„ä¼—å¤šå­˜å‚¨åº“ç»„åˆåˆ°ä¸€ä¸ªå­˜å‚¨åº“ä¸­ã€‚\n\n#### 10.åˆ é™¤Native-Headerç”Ÿæˆå·¥å…·ï¼ˆjavahï¼‰ï¼ˆJEP 313ï¼‰\n\nä»JDKä¸­ç§»é™¤äº†javahå·¥å…·ï¼Œè¿™ä¸ªå¾ˆç®€å•å¹¶ä¸”å¾ˆé‡è¦ã€‚\n\n### å°é²œ\n\nå°±åƒæ‰€æœ‰å…¶ä»–JDKç‰ˆæœ¬ä¸€æ ·ï¼ŒOracleå·²ç»å‘å¸ƒäº†ä¸€ä¸ªJava 10åˆå§‹å€™é€‰ç‰ˆæœ¬ï¼ŒJavaå¼€å‘è€…å¯ä»¥ä¸‹è½½æ­¤ç‰ˆæœ¬ç”¨æ¥æµ‹è¯•æ–°åŠŸèƒ½ã€‚å¦‚æœä½ å¯¹Java 10æŠ±æœ‰æœŸå¾…æƒ³ææ—©å°è¯•ï¼Œé‚£ä¹ˆç°åœ¨å°±å¼€å§‹å§ï¼\n\n> å°é²œåœ°å€ï¼šhttp://openjdk.java.net/projects/jdk/10/\n\n#### æœ€åçš„æ„Ÿæ‚Ÿ\n\nå¯¹äºç¬¬ä¸€ç‚¹æ–°ç‰¹æ€§æ¥è¯´ç¡®å®æ˜¯ä¸€ä¸ªå¤§çš„è·¨è¶Šï¼Œå…¶ä»–ç‰¹æ€§æˆ–å¤šæˆ–å°‘éƒ½èƒ½å¸¦ç»™å¼€å‘è€…ç¦éŸ³ã€‚ä½†æœ€ç»ˆJava 10ä¼šæ˜¯ä»€ä¹ˆæ ·ï¼Œæˆ–è®¸è¿˜ä¼šå¢åŠ æ›´å¤šå®ç”¨æ€§çš„æ–°åŠŸèƒ½æˆ–è€…ä¼˜åŒ–ï¼Œæˆ‘ä»¬è¿˜å¾—æœŸå¾…ï¼\n\nç°åœ¨è¦åšçš„å°±æ˜¯ï¼Œèµ¶ç´§ç†Ÿæ‚‰JDK 8ï¼Œç°åœ¨å·²ç»æ˜¯å¾ˆå¤šäº’è”ç½‘ä¼ä¸šæ ‡é…äº†ã€‚å¦‚æœè¿˜åœ¨ä½¿ç”¨JDK4-7ï¼Œé‚£çœŸçš„æ˜¯è¦OUTäº†ã€‚ã€‚\n\nåœ¨ä¸ä¹…çš„å°†æ¥ï¼ŒJava 10å°†å½»åº•æ”¹å˜ä½ å†™ä»£ç çš„æ–¹å¼ï¼\n\n","slug":"æ–°ç‰¹æ€§/Java10/Java 10 çš„ 10 ä¸ªæ–°ç‰¹æ€§ï¼Œå°†å½»åº•æ”¹å˜ä½ å†™ä»£ç çš„æ–¹å¼","published":1,"updated":"2025-10-15T07:20:51.431Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu07720058qkd43z0c8xvf","content":"<p><img src=\"http://img.javastack.cn/18-3-8/94675270.jpg\" alt=\"image\"></p>\n<p>Java 9æ‰å‘å¸ƒå‡ ä¸ªæœˆï¼Œå¾ˆå¤šç©æ„éƒ½æ²¡æ•´æ˜ç™½ï¼Œç°åœ¨Java 10åˆå¿«è¦æ¥äº†ã€‚ã€‚</p>\n<p>è¿™æ—¶å€™æˆ‘çœŸå°¼ç›æƒ³è¯´ï¼šçº¿ä¸Šç”¨çš„JDK 7 ç”šè‡³JDK 6ï¼ŒJDK 8 è¿˜æ²¡ç”¨ç†Ÿï¼ŒJDK 9 æ‰å‘å¸ƒä¸ä¹…ä¸çŸ¥é“å•¥ç©æ„ï¼ŒJDK 10â€¦â€¦</p>\n<p>åˆšå­¦Javaçš„åŒå­¦æ˜¯ä¸æ˜¯æ„Ÿè§‰ä¸€è„¸è’™é€¼ï¼Ÿï¼ï¼ï¼</p>\n<p>å°±è¿æˆ‘è¿™ä¸ªè€å¸æœºä¹ŸåŒæ ·æ„Ÿè§‰å¦‚æ­¤ï¼</p>\n<p>Java æ›´æ–°è¶Šæ¥è¶Šå¿«ï¼Œæˆ‘ä»¬åšæŠ€æœ¯çš„ä¹Ÿè¦è·Ÿä¸Šæ­¥ä¼ï¼Œä¸ç„¶æ€»ä¼šæ…¢åˆ«äººä¸€æ‹ï¼Œè¿™æ–°ä¸œè¥¿ä»å›½å¤–åˆ°å›½å†…åº”ç”¨ä¸€èˆ¬è¦å¥½å‡ å¹´çš„æ—¶é—´ï¼Œå¦‚æœæˆ‘ä»¬æå‰äº†è§£å¹¶åº”ç”¨è¿™äº›æ–°æŠ€æœ¯å¯¹è‡ªå·±ä¸æ˜¯åäº‹ã€‚</p>\n<h3 id=\"Java-10çš„æ–°ç‰¹æ€§\"><a href=\"#Java-10çš„æ–°ç‰¹æ€§\" class=\"headerlink\" title=\"Java 10çš„æ–°ç‰¹æ€§\"></a>Java 10çš„æ–°ç‰¹æ€§</h3><p>è¯´äº†è¿™ä¹ˆå¤šï¼Œçœ‹Java 10éƒ½ä¼šæœ‰å“ªäº›ç‰¹æ€§æ¥æ”¹å˜æˆ‘ä»¬å†™ä»£ç çš„æ–¹å¼å‘¢ï¼Ÿï¼</p>\n<h4 id=\"1-å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­\"><a href=\"#1-å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­\" class=\"headerlink\" title=\"1.å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­\"></a>1.å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­</h4><p>å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­å¯ä»¥è¯´æ˜¯Java 10ä¸­æœ€å€¼å¾—æ³¨æ„çš„ç‰¹æ€§ï¼Œè¿™æ˜¯Javaè¯­è¨€å¼€å‘äººå‘˜ä¸ºäº†ç®€åŒ–Javaåº”ç”¨ç¨‹åºçš„ç¼–å†™è€Œé‡‡å–çš„åˆä¸€æ­¥ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>\n<p><img src=\"http://img.javastack.cn/18-3-8/56770623.jpg\" alt=\"image\"></p>\n<p>è¿™ä¸ªæ–°åŠŸèƒ½å°†ä¸ºJavaå¢åŠ ä¸€äº›è¯­æ³•ç³– - ç®€åŒ–å®ƒå¹¶æ”¹å–„å¼€å‘è€…ä½“éªŒã€‚æ–°çš„è¯­æ³•å°†å‡å°‘ä¸ç¼–å†™Javaç›¸å…³çš„å†—é•¿åº¦ï¼ŒåŒæ—¶ä¿æŒå¯¹é™æ€ç±»å‹å®‰å…¨æ€§çš„æ‰¿è¯ºã€‚</p>\n<p>å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­å°†å¼•å…¥â€varâ€å…³é”®å­—ï¼Œä¹Ÿå°±æ˜¯ä½ å¯ä»¥éšæ„å®šä¹‰å˜é‡è€Œä¸å¿…æŒ‡å®šå˜é‡çš„ç±»å‹ï¼Œå¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">List &lt;String&gt; list &#x3D; new ArrayList &lt;String&gt;ï¼ˆï¼‰; \nStream &lt;String&gt; stream &#x3D; getStreamï¼ˆï¼‰;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>å°†è¢«ä¸‹é¢è¿™ä¸ªæ–°è¯­æ³•æ‰€å–ä»£ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">var list &#x3D; new ArrayList &lt;String&gt;ï¼ˆï¼‰; \nvar stream &#x3D; getStreamï¼ˆï¼‰;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>çœ‹å®Œæ˜¯ä¸æ˜¯æœ‰ç‚¹JSçš„å³è§†æ„Ÿï¼Ÿï¼Ÿï¼Ÿè¶Šæ¥è¶ŠåƒJSäº†å—ï¼Ÿï¼è™½ç„¶ç±»å‹æ¨æ–­åœ¨Javaä¸­ä¸æ˜¯ä¸€ä¸ªæ–°æ¦‚å¿µï¼Œä½†åœ¨å±€éƒ¨å˜é‡ä¸­ç¡®æ˜¯å¾ˆå¤§çš„ä¸€ä¸ªæ”¹è¿›ã€‚</p>\n<p>è¯´åˆ°ç±»å‹æ¨æ–­ï¼Œä»JDK 5å¼•è¿›æ³›å‹ï¼Œåˆ°JDK 7çš„â€&lt;&gt;â€æ“ä½œç¬¦å…è®¸ä¸ç»‘å®šç±»å‹è€Œåˆå§‹åŒ–Listï¼Œå†åˆ°JDK 8çš„Lambdaè¡¨è¾¾å¼ï¼Œå†åˆ°ç°åœ¨JDK 10çš„å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ï¼ŒJavaç±»å‹æ¨æ–­æ­£å¤§åˆ€é˜”æ–§çš„å‘å‰å‘å±•ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; è¯¥è¿ç®—ç¬¦å…è®¸åœ¨æ²¡æœ‰ç»‘å®šArrayList &lt;&gt;çš„ç±»å‹çš„æƒ…å†µä¸‹åˆå§‹åŒ–åˆ—è¡¨\nList &lt;String&gt; list &#x3D; new LinkedList &lt;&gt;ï¼ˆï¼‰;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p><strong>å±€éƒ¨å˜é‡ç±»å‹æ¨èä»…é™äºå¦‚ä¸‹ä½¿ç”¨åœºæ™¯ï¼š</strong></p>\n<ul>\n<li>å±€éƒ¨å˜é‡åˆå§‹åŒ–</li>\n<li>forå¾ªç¯å†…éƒ¨ç´¢å¼•å˜é‡</li>\n<li>ä¼ ç»Ÿçš„forå¾ªç¯å£°æ˜å˜é‡</li>\n</ul>\n<p><strong>Javaå®˜æ–¹è¡¨ç¤ºï¼Œå®ƒä¸èƒ½ç”¨äºä»¥ä¸‹å‡ ä¸ªåœ°æ–¹ï¼š</strong></p>\n<ul>\n<li>æ–¹æ³•å‚æ•°</li>\n<li>æ„é€ å‡½æ•°å‚æ•°</li>\n<li>æ–¹æ³•è¿”å›ç±»å‹</li>\n<li>å­—æ®µ</li>\n<li>æ•è·è¡¨è¾¾å¼ï¼ˆæˆ–ä»»ä½•å…¶ä»–ç±»å‹çš„å˜é‡å£°æ˜ï¼‰</li>\n</ul>\n<h4 id=\"2-GCæ”¹è¿›å’Œå…¶ä»–å†…åŠ¡ç®¡ç†\"><a href=\"#2-GCæ”¹è¿›å’Œå…¶ä»–å†…åŠ¡ç®¡ç†\" class=\"headerlink\" title=\"2.GCæ”¹è¿›å’Œå…¶ä»–å†…åŠ¡ç®¡ç†\"></a>2.GCæ”¹è¿›å’Œå…¶ä»–å†…åŠ¡ç®¡ç†</h4><p>JDK 10ä¸­æœ‰2ä¸ªJEPä¸“é—¨ç”¨äºæ”¹è¿›å½“å‰çš„åƒåœ¾æ”¶é›†å…ƒç´ ã€‚</p>\n<p>ç¬¬ä¸€ä¸ªåƒåœ¾æ”¶é›†å™¨æ¥å£æ˜¯ï¼ˆJEP 304ï¼‰ï¼Œå®ƒå°†å¼•å…¥ä¸€ä¸ªçº¯å‡€çš„åƒåœ¾æ”¶é›†å™¨æ¥å£ï¼Œä»¥å¸®åŠ©æ”¹è¿›ä¸åŒåƒåœ¾æ”¶é›†å™¨çš„æºä»£ç éš”ç¦»ã€‚</p>\n<p>é¢„å®šç”¨äºJava 10çš„ç¬¬äºŒä¸ªJEPæ˜¯é’ˆå¯¹G1çš„å¹¶è¡Œå®Œå…¨GCï¼ˆJEP 307ï¼‰ï¼Œå…¶é‡ç‚¹åœ¨äºé€šè¿‡å®Œå…¨GCå¹¶è¡Œæ¥æ”¹å–„G1æœ€åæƒ…å†µçš„ç­‰å¾…æ—¶é—´ã€‚G1æ˜¯Java 9ä¸­çš„é»˜è®¤GCï¼Œå¹¶ä¸”æ­¤JEPçš„ç›®æ ‡æ˜¯ä½¿G1å¹³è¡Œã€‚</p>\n<h4 id=\"3-çº¿ç¨‹æœ¬åœ°æ¡æ‰‹ï¼ˆJEP-312ï¼‰\"><a href=\"#3-çº¿ç¨‹æœ¬åœ°æ¡æ‰‹ï¼ˆJEP-312ï¼‰\" class=\"headerlink\" title=\"3.çº¿ç¨‹æœ¬åœ°æ¡æ‰‹ï¼ˆJEP 312ï¼‰\"></a>3.çº¿ç¨‹æœ¬åœ°æ¡æ‰‹ï¼ˆJEP 312ï¼‰</h4><p>JDK 10å°†å¼•å…¥ä¸€ç§åœ¨çº¿ç¨‹ä¸Šæ‰§è¡Œå›è°ƒçš„æ–°æ–¹æ³•ï¼Œå› æ­¤è¿™å°†ä¼šå¾ˆæ–¹ä¾¿èƒ½åœæ­¢å•ä¸ªçº¿ç¨‹è€Œä¸æ˜¯åœæ­¢å…¨éƒ¨çº¿ç¨‹æˆ–è€…ä¸€ä¸ªéƒ½ä¸åœã€‚</p>\n<h4 id=\"4-å¤‡ç”¨å†…å­˜è®¾å¤‡ä¸Šçš„å †åˆ†é…ï¼ˆJEP-316ï¼‰\"><a href=\"#4-å¤‡ç”¨å†…å­˜è®¾å¤‡ä¸Šçš„å †åˆ†é…ï¼ˆJEP-316ï¼‰\" class=\"headerlink\" title=\"4.å¤‡ç”¨å†…å­˜è®¾å¤‡ä¸Šçš„å †åˆ†é…ï¼ˆJEP 316ï¼‰\"></a>4.å¤‡ç”¨å†…å­˜è®¾å¤‡ä¸Šçš„å †åˆ†é…ï¼ˆJEP 316ï¼‰</h4><p>å…è®¸HotSpot VMåœ¨å¤‡ç”¨å†…å­˜è®¾å¤‡ä¸Šåˆ†é…Javaå¯¹è±¡å †å†…å­˜ï¼Œè¯¥å†…å­˜è®¾å¤‡å°†ç”±ç”¨æˆ·æŒ‡å®šã€‚</p>\n<h4 id=\"5-å…¶ä»–Unicodeè¯­è¨€-æ ‡è®°æ‰©å±•ï¼ˆJEP-314ï¼‰\"><a href=\"#5-å…¶ä»–Unicodeè¯­è¨€-æ ‡è®°æ‰©å±•ï¼ˆJEP-314ï¼‰\" class=\"headerlink\" title=\"5.å…¶ä»–Unicodeè¯­è¨€ - æ ‡è®°æ‰©å±•ï¼ˆJEP 314ï¼‰\"></a>5.å…¶ä»–Unicodeè¯­è¨€ - æ ‡è®°æ‰©å±•ï¼ˆJEP 314ï¼‰</h4><p>ç›®æ ‡æ˜¯å¢å¼ºjava.util.LocaleåŠå…¶ç›¸å…³çš„APIï¼Œä»¥ä¾¿å®ç°è¯­è¨€æ ‡è®°è¯­æ³•çš„å…¶ä»–Unicodeæ‰©å±•ï¼ˆBCP 47ï¼‰ã€‚</p>\n<h4 id=\"6-åŸºäºJavaçš„å®éªŒæ€§JITç¼–è¯‘å™¨ï¼ˆJEP-317ï¼‰\"><a href=\"#6-åŸºäºJavaçš„å®éªŒæ€§JITç¼–è¯‘å™¨ï¼ˆJEP-317ï¼‰\" class=\"headerlink\" title=\"6.åŸºäºJavaçš„å®éªŒæ€§JITç¼–è¯‘å™¨ï¼ˆJEP 317ï¼‰\"></a>6.åŸºäºJavaçš„å®éªŒæ€§JITç¼–è¯‘å™¨ï¼ˆJEP 317ï¼‰</h4><p>Oracleå¸Œæœ›å°†å…¶Java JITç¼–è¯‘å™¨Graalç”¨ä½œLinux &#x2F; x64å¹³å°ä¸Šçš„å®éªŒæ€§JITç¼–è¯‘å™¨ã€‚</p>\n<h4 id=\"7-æ ¹è¯ä¹¦ï¼ˆJEP-319ï¼‰\"><a href=\"#7-æ ¹è¯ä¹¦ï¼ˆJEP-319ï¼‰\" class=\"headerlink\" title=\"7.æ ¹è¯ä¹¦ï¼ˆJEP 319ï¼‰\"></a>7.æ ¹è¯ä¹¦ï¼ˆJEP 319ï¼‰</h4><p>è¿™ä¸ªçš„ç›®æ ‡æ˜¯åœ¨Oracleçš„Java SEä¸­å¼€æºæ ¹è¯ä¹¦ã€‚</p>\n<h4 id=\"8-æ ¹è¯ä¹¦è®¤è¯ç¨‹åºï¼ˆCAï¼‰\"><a href=\"#8-æ ¹è¯ä¹¦è®¤è¯ç¨‹åºï¼ˆCAï¼‰\" class=\"headerlink\" title=\"8.æ ¹è¯ä¹¦è®¤è¯ç¨‹åºï¼ˆCAï¼‰\"></a>8.æ ¹è¯ä¹¦è®¤è¯ç¨‹åºï¼ˆCAï¼‰</h4><p>è¿™å°†ä½¿OpenJDKå¯¹å¼€å‘äººå‘˜æ›´å…·å¸å¼•åŠ›ï¼Œå®ƒè¿˜æ—¨åœ¨å‡å°‘OpenJDKå’ŒOracle JDKæ„å»ºä¹‹é—´çš„å·®å¼‚ã€‚</p>\n<h4 id=\"9-å°†JDKç”Ÿæ€æ•´åˆåˆ°å•ä¸ªå­˜å‚¨åº“ä¸­ï¼ˆJEP-296ï¼‰\"><a href=\"#9-å°†JDKç”Ÿæ€æ•´åˆåˆ°å•ä¸ªå­˜å‚¨åº“ä¸­ï¼ˆJEP-296ï¼‰\" class=\"headerlink\" title=\"9.å°†JDKç”Ÿæ€æ•´åˆåˆ°å•ä¸ªå­˜å‚¨åº“ä¸­ï¼ˆJEP 296ï¼‰\"></a>9.å°†JDKç”Ÿæ€æ•´åˆåˆ°å•ä¸ªå­˜å‚¨åº“ä¸­ï¼ˆJEP 296ï¼‰</h4><p>æ­¤JEPçš„ä¸»è¦ç›®æ ‡æ˜¯æ‰§è¡Œä¸€äº›å†…å­˜ç®¡ç†ï¼Œå¹¶å°†JDKç”Ÿæ€çš„ä¼—å¤šå­˜å‚¨åº“ç»„åˆåˆ°ä¸€ä¸ªå­˜å‚¨åº“ä¸­ã€‚</p>\n<h4 id=\"10-åˆ é™¤Native-Headerç”Ÿæˆå·¥å…·ï¼ˆjavahï¼‰ï¼ˆJEP-313ï¼‰\"><a href=\"#10-åˆ é™¤Native-Headerç”Ÿæˆå·¥å…·ï¼ˆjavahï¼‰ï¼ˆJEP-313ï¼‰\" class=\"headerlink\" title=\"10.åˆ é™¤Native-Headerç”Ÿæˆå·¥å…·ï¼ˆjavahï¼‰ï¼ˆJEP 313ï¼‰\"></a>10.åˆ é™¤Native-Headerç”Ÿæˆå·¥å…·ï¼ˆjavahï¼‰ï¼ˆJEP 313ï¼‰</h4><p>ä»JDKä¸­ç§»é™¤äº†javahå·¥å…·ï¼Œè¿™ä¸ªå¾ˆç®€å•å¹¶ä¸”å¾ˆé‡è¦ã€‚</p>\n<h3 id=\"å°é²œ\"><a href=\"#å°é²œ\" class=\"headerlink\" title=\"å°é²œ\"></a>å°é²œ</h3><p>å°±åƒæ‰€æœ‰å…¶ä»–JDKç‰ˆæœ¬ä¸€æ ·ï¼ŒOracleå·²ç»å‘å¸ƒäº†ä¸€ä¸ªJava 10åˆå§‹å€™é€‰ç‰ˆæœ¬ï¼ŒJavaå¼€å‘è€…å¯ä»¥ä¸‹è½½æ­¤ç‰ˆæœ¬ç”¨æ¥æµ‹è¯•æ–°åŠŸèƒ½ã€‚å¦‚æœä½ å¯¹Java 10æŠ±æœ‰æœŸå¾…æƒ³ææ—©å°è¯•ï¼Œé‚£ä¹ˆç°åœ¨å°±å¼€å§‹å§ï¼</p>\n<blockquote>\n<p>å°é²œåœ°å€ï¼š<a href=\"http://openjdk.java.net/projects/jdk/10/\">http://openjdk.java.net/projects/jdk/10/</a></p>\n</blockquote>\n<h4 id=\"æœ€åçš„æ„Ÿæ‚Ÿ\"><a href=\"#æœ€åçš„æ„Ÿæ‚Ÿ\" class=\"headerlink\" title=\"æœ€åçš„æ„Ÿæ‚Ÿ\"></a>æœ€åçš„æ„Ÿæ‚Ÿ</h4><p>å¯¹äºç¬¬ä¸€ç‚¹æ–°ç‰¹æ€§æ¥è¯´ç¡®å®æ˜¯ä¸€ä¸ªå¤§çš„è·¨è¶Šï¼Œå…¶ä»–ç‰¹æ€§æˆ–å¤šæˆ–å°‘éƒ½èƒ½å¸¦ç»™å¼€å‘è€…ç¦éŸ³ã€‚ä½†æœ€ç»ˆJava 10ä¼šæ˜¯ä»€ä¹ˆæ ·ï¼Œæˆ–è®¸è¿˜ä¼šå¢åŠ æ›´å¤šå®ç”¨æ€§çš„æ–°åŠŸèƒ½æˆ–è€…ä¼˜åŒ–ï¼Œæˆ‘ä»¬è¿˜å¾—æœŸå¾…ï¼</p>\n<p>ç°åœ¨è¦åšçš„å°±æ˜¯ï¼Œèµ¶ç´§ç†Ÿæ‚‰JDK 8ï¼Œç°åœ¨å·²ç»æ˜¯å¾ˆå¤šäº’è”ç½‘ä¼ä¸šæ ‡é…äº†ã€‚å¦‚æœè¿˜åœ¨ä½¿ç”¨JDK4-7ï¼Œé‚£çœŸçš„æ˜¯è¦OUTäº†ã€‚ã€‚</p>\n<p>åœ¨ä¸ä¹…çš„å°†æ¥ï¼ŒJava 10å°†å½»åº•æ”¹å˜ä½ å†™ä»£ç çš„æ–¹å¼ï¼</p>\n","excerpt":"","more":"<p><img src=\"http://img.javastack.cn/18-3-8/94675270.jpg\" alt=\"image\"></p>\n<p>Java 9æ‰å‘å¸ƒå‡ ä¸ªæœˆï¼Œå¾ˆå¤šç©æ„éƒ½æ²¡æ•´æ˜ç™½ï¼Œç°åœ¨Java 10åˆå¿«è¦æ¥äº†ã€‚ã€‚</p>\n<p>è¿™æ—¶å€™æˆ‘çœŸå°¼ç›æƒ³è¯´ï¼šçº¿ä¸Šç”¨çš„JDK 7 ç”šè‡³JDK 6ï¼ŒJDK 8 è¿˜æ²¡ç”¨ç†Ÿï¼ŒJDK 9 æ‰å‘å¸ƒä¸ä¹…ä¸çŸ¥é“å•¥ç©æ„ï¼ŒJDK 10â€¦â€¦</p>\n<p>åˆšå­¦Javaçš„åŒå­¦æ˜¯ä¸æ˜¯æ„Ÿè§‰ä¸€è„¸è’™é€¼ï¼Ÿï¼ï¼ï¼</p>\n<p>å°±è¿æˆ‘è¿™ä¸ªè€å¸æœºä¹ŸåŒæ ·æ„Ÿè§‰å¦‚æ­¤ï¼</p>\n<p>Java æ›´æ–°è¶Šæ¥è¶Šå¿«ï¼Œæˆ‘ä»¬åšæŠ€æœ¯çš„ä¹Ÿè¦è·Ÿä¸Šæ­¥ä¼ï¼Œä¸ç„¶æ€»ä¼šæ…¢åˆ«äººä¸€æ‹ï¼Œè¿™æ–°ä¸œè¥¿ä»å›½å¤–åˆ°å›½å†…åº”ç”¨ä¸€èˆ¬è¦å¥½å‡ å¹´çš„æ—¶é—´ï¼Œå¦‚æœæˆ‘ä»¬æå‰äº†è§£å¹¶åº”ç”¨è¿™äº›æ–°æŠ€æœ¯å¯¹è‡ªå·±ä¸æ˜¯åäº‹ã€‚</p>\n<h3 id=\"Java-10çš„æ–°ç‰¹æ€§\"><a href=\"#Java-10çš„æ–°ç‰¹æ€§\" class=\"headerlink\" title=\"Java 10çš„æ–°ç‰¹æ€§\"></a>Java 10çš„æ–°ç‰¹æ€§</h3><p>è¯´äº†è¿™ä¹ˆå¤šï¼Œçœ‹Java 10éƒ½ä¼šæœ‰å“ªäº›ç‰¹æ€§æ¥æ”¹å˜æˆ‘ä»¬å†™ä»£ç çš„æ–¹å¼å‘¢ï¼Ÿï¼</p>\n<h4 id=\"1-å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­\"><a href=\"#1-å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­\" class=\"headerlink\" title=\"1.å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­\"></a>1.å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­</h4><p>å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­å¯ä»¥è¯´æ˜¯Java 10ä¸­æœ€å€¼å¾—æ³¨æ„çš„ç‰¹æ€§ï¼Œè¿™æ˜¯Javaè¯­è¨€å¼€å‘äººå‘˜ä¸ºäº†ç®€åŒ–Javaåº”ç”¨ç¨‹åºçš„ç¼–å†™è€Œé‡‡å–çš„åˆä¸€æ­¥ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>\n<p><img src=\"http://img.javastack.cn/18-3-8/56770623.jpg\" alt=\"image\"></p>\n<p>è¿™ä¸ªæ–°åŠŸèƒ½å°†ä¸ºJavaå¢åŠ ä¸€äº›è¯­æ³•ç³– - ç®€åŒ–å®ƒå¹¶æ”¹å–„å¼€å‘è€…ä½“éªŒã€‚æ–°çš„è¯­æ³•å°†å‡å°‘ä¸ç¼–å†™Javaç›¸å…³çš„å†—é•¿åº¦ï¼ŒåŒæ—¶ä¿æŒå¯¹é™æ€ç±»å‹å®‰å…¨æ€§çš„æ‰¿è¯ºã€‚</p>\n<p>å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­å°†å¼•å…¥â€varâ€å…³é”®å­—ï¼Œä¹Ÿå°±æ˜¯ä½ å¯ä»¥éšæ„å®šä¹‰å˜é‡è€Œä¸å¿…æŒ‡å®šå˜é‡çš„ç±»å‹ï¼Œå¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">List &lt;String&gt; list &#x3D; new ArrayList &lt;String&gt;ï¼ˆï¼‰; \nStream &lt;String&gt; stream &#x3D; getStreamï¼ˆï¼‰;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>å°†è¢«ä¸‹é¢è¿™ä¸ªæ–°è¯­æ³•æ‰€å–ä»£ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">var list &#x3D; new ArrayList &lt;String&gt;ï¼ˆï¼‰; \nvar stream &#x3D; getStreamï¼ˆï¼‰;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>çœ‹å®Œæ˜¯ä¸æ˜¯æœ‰ç‚¹JSçš„å³è§†æ„Ÿï¼Ÿï¼Ÿï¼Ÿè¶Šæ¥è¶ŠåƒJSäº†å—ï¼Ÿï¼è™½ç„¶ç±»å‹æ¨æ–­åœ¨Javaä¸­ä¸æ˜¯ä¸€ä¸ªæ–°æ¦‚å¿µï¼Œä½†åœ¨å±€éƒ¨å˜é‡ä¸­ç¡®æ˜¯å¾ˆå¤§çš„ä¸€ä¸ªæ”¹è¿›ã€‚</p>\n<p>è¯´åˆ°ç±»å‹æ¨æ–­ï¼Œä»JDK 5å¼•è¿›æ³›å‹ï¼Œåˆ°JDK 7çš„â€&lt;&gt;â€æ“ä½œç¬¦å…è®¸ä¸ç»‘å®šç±»å‹è€Œåˆå§‹åŒ–Listï¼Œå†åˆ°JDK 8çš„Lambdaè¡¨è¾¾å¼ï¼Œå†åˆ°ç°åœ¨JDK 10çš„å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ï¼ŒJavaç±»å‹æ¨æ–­æ­£å¤§åˆ€é˜”æ–§çš„å‘å‰å‘å±•ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; è¯¥è¿ç®—ç¬¦å…è®¸åœ¨æ²¡æœ‰ç»‘å®šArrayList &lt;&gt;çš„ç±»å‹çš„æƒ…å†µä¸‹åˆå§‹åŒ–åˆ—è¡¨\nList &lt;String&gt; list &#x3D; new LinkedList &lt;&gt;ï¼ˆï¼‰;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p><strong>å±€éƒ¨å˜é‡ç±»å‹æ¨èä»…é™äºå¦‚ä¸‹ä½¿ç”¨åœºæ™¯ï¼š</strong></p>\n<ul>\n<li>å±€éƒ¨å˜é‡åˆå§‹åŒ–</li>\n<li>forå¾ªç¯å†…éƒ¨ç´¢å¼•å˜é‡</li>\n<li>ä¼ ç»Ÿçš„forå¾ªç¯å£°æ˜å˜é‡</li>\n</ul>\n<p><strong>Javaå®˜æ–¹è¡¨ç¤ºï¼Œå®ƒä¸èƒ½ç”¨äºä»¥ä¸‹å‡ ä¸ªåœ°æ–¹ï¼š</strong></p>\n<ul>\n<li>æ–¹æ³•å‚æ•°</li>\n<li>æ„é€ å‡½æ•°å‚æ•°</li>\n<li>æ–¹æ³•è¿”å›ç±»å‹</li>\n<li>å­—æ®µ</li>\n<li>æ•è·è¡¨è¾¾å¼ï¼ˆæˆ–ä»»ä½•å…¶ä»–ç±»å‹çš„å˜é‡å£°æ˜ï¼‰</li>\n</ul>\n<h4 id=\"2-GCæ”¹è¿›å’Œå…¶ä»–å†…åŠ¡ç®¡ç†\"><a href=\"#2-GCæ”¹è¿›å’Œå…¶ä»–å†…åŠ¡ç®¡ç†\" class=\"headerlink\" title=\"2.GCæ”¹è¿›å’Œå…¶ä»–å†…åŠ¡ç®¡ç†\"></a>2.GCæ”¹è¿›å’Œå…¶ä»–å†…åŠ¡ç®¡ç†</h4><p>JDK 10ä¸­æœ‰2ä¸ªJEPä¸“é—¨ç”¨äºæ”¹è¿›å½“å‰çš„åƒåœ¾æ”¶é›†å…ƒç´ ã€‚</p>\n<p>ç¬¬ä¸€ä¸ªåƒåœ¾æ”¶é›†å™¨æ¥å£æ˜¯ï¼ˆJEP 304ï¼‰ï¼Œå®ƒå°†å¼•å…¥ä¸€ä¸ªçº¯å‡€çš„åƒåœ¾æ”¶é›†å™¨æ¥å£ï¼Œä»¥å¸®åŠ©æ”¹è¿›ä¸åŒåƒåœ¾æ”¶é›†å™¨çš„æºä»£ç éš”ç¦»ã€‚</p>\n<p>é¢„å®šç”¨äºJava 10çš„ç¬¬äºŒä¸ªJEPæ˜¯é’ˆå¯¹G1çš„å¹¶è¡Œå®Œå…¨GCï¼ˆJEP 307ï¼‰ï¼Œå…¶é‡ç‚¹åœ¨äºé€šè¿‡å®Œå…¨GCå¹¶è¡Œæ¥æ”¹å–„G1æœ€åæƒ…å†µçš„ç­‰å¾…æ—¶é—´ã€‚G1æ˜¯Java 9ä¸­çš„é»˜è®¤GCï¼Œå¹¶ä¸”æ­¤JEPçš„ç›®æ ‡æ˜¯ä½¿G1å¹³è¡Œã€‚</p>\n<h4 id=\"3-çº¿ç¨‹æœ¬åœ°æ¡æ‰‹ï¼ˆJEP-312ï¼‰\"><a href=\"#3-çº¿ç¨‹æœ¬åœ°æ¡æ‰‹ï¼ˆJEP-312ï¼‰\" class=\"headerlink\" title=\"3.çº¿ç¨‹æœ¬åœ°æ¡æ‰‹ï¼ˆJEP 312ï¼‰\"></a>3.çº¿ç¨‹æœ¬åœ°æ¡æ‰‹ï¼ˆJEP 312ï¼‰</h4><p>JDK 10å°†å¼•å…¥ä¸€ç§åœ¨çº¿ç¨‹ä¸Šæ‰§è¡Œå›è°ƒçš„æ–°æ–¹æ³•ï¼Œå› æ­¤è¿™å°†ä¼šå¾ˆæ–¹ä¾¿èƒ½åœæ­¢å•ä¸ªçº¿ç¨‹è€Œä¸æ˜¯åœæ­¢å…¨éƒ¨çº¿ç¨‹æˆ–è€…ä¸€ä¸ªéƒ½ä¸åœã€‚</p>\n<h4 id=\"4-å¤‡ç”¨å†…å­˜è®¾å¤‡ä¸Šçš„å †åˆ†é…ï¼ˆJEP-316ï¼‰\"><a href=\"#4-å¤‡ç”¨å†…å­˜è®¾å¤‡ä¸Šçš„å †åˆ†é…ï¼ˆJEP-316ï¼‰\" class=\"headerlink\" title=\"4.å¤‡ç”¨å†…å­˜è®¾å¤‡ä¸Šçš„å †åˆ†é…ï¼ˆJEP 316ï¼‰\"></a>4.å¤‡ç”¨å†…å­˜è®¾å¤‡ä¸Šçš„å †åˆ†é…ï¼ˆJEP 316ï¼‰</h4><p>å…è®¸HotSpot VMåœ¨å¤‡ç”¨å†…å­˜è®¾å¤‡ä¸Šåˆ†é…Javaå¯¹è±¡å †å†…å­˜ï¼Œè¯¥å†…å­˜è®¾å¤‡å°†ç”±ç”¨æˆ·æŒ‡å®šã€‚</p>\n<h4 id=\"5-å…¶ä»–Unicodeè¯­è¨€-æ ‡è®°æ‰©å±•ï¼ˆJEP-314ï¼‰\"><a href=\"#5-å…¶ä»–Unicodeè¯­è¨€-æ ‡è®°æ‰©å±•ï¼ˆJEP-314ï¼‰\" class=\"headerlink\" title=\"5.å…¶ä»–Unicodeè¯­è¨€ - æ ‡è®°æ‰©å±•ï¼ˆJEP 314ï¼‰\"></a>5.å…¶ä»–Unicodeè¯­è¨€ - æ ‡è®°æ‰©å±•ï¼ˆJEP 314ï¼‰</h4><p>ç›®æ ‡æ˜¯å¢å¼ºjava.util.LocaleåŠå…¶ç›¸å…³çš„APIï¼Œä»¥ä¾¿å®ç°è¯­è¨€æ ‡è®°è¯­æ³•çš„å…¶ä»–Unicodeæ‰©å±•ï¼ˆBCP 47ï¼‰ã€‚</p>\n<h4 id=\"6-åŸºäºJavaçš„å®éªŒæ€§JITç¼–è¯‘å™¨ï¼ˆJEP-317ï¼‰\"><a href=\"#6-åŸºäºJavaçš„å®éªŒæ€§JITç¼–è¯‘å™¨ï¼ˆJEP-317ï¼‰\" class=\"headerlink\" title=\"6.åŸºäºJavaçš„å®éªŒæ€§JITç¼–è¯‘å™¨ï¼ˆJEP 317ï¼‰\"></a>6.åŸºäºJavaçš„å®éªŒæ€§JITç¼–è¯‘å™¨ï¼ˆJEP 317ï¼‰</h4><p>Oracleå¸Œæœ›å°†å…¶Java JITç¼–è¯‘å™¨Graalç”¨ä½œLinux &#x2F; x64å¹³å°ä¸Šçš„å®éªŒæ€§JITç¼–è¯‘å™¨ã€‚</p>\n<h4 id=\"7-æ ¹è¯ä¹¦ï¼ˆJEP-319ï¼‰\"><a href=\"#7-æ ¹è¯ä¹¦ï¼ˆJEP-319ï¼‰\" class=\"headerlink\" title=\"7.æ ¹è¯ä¹¦ï¼ˆJEP 319ï¼‰\"></a>7.æ ¹è¯ä¹¦ï¼ˆJEP 319ï¼‰</h4><p>è¿™ä¸ªçš„ç›®æ ‡æ˜¯åœ¨Oracleçš„Java SEä¸­å¼€æºæ ¹è¯ä¹¦ã€‚</p>\n<h4 id=\"8-æ ¹è¯ä¹¦è®¤è¯ç¨‹åºï¼ˆCAï¼‰\"><a href=\"#8-æ ¹è¯ä¹¦è®¤è¯ç¨‹åºï¼ˆCAï¼‰\" class=\"headerlink\" title=\"8.æ ¹è¯ä¹¦è®¤è¯ç¨‹åºï¼ˆCAï¼‰\"></a>8.æ ¹è¯ä¹¦è®¤è¯ç¨‹åºï¼ˆCAï¼‰</h4><p>è¿™å°†ä½¿OpenJDKå¯¹å¼€å‘äººå‘˜æ›´å…·å¸å¼•åŠ›ï¼Œå®ƒè¿˜æ—¨åœ¨å‡å°‘OpenJDKå’ŒOracle JDKæ„å»ºä¹‹é—´çš„å·®å¼‚ã€‚</p>\n<h4 id=\"9-å°†JDKç”Ÿæ€æ•´åˆåˆ°å•ä¸ªå­˜å‚¨åº“ä¸­ï¼ˆJEP-296ï¼‰\"><a href=\"#9-å°†JDKç”Ÿæ€æ•´åˆåˆ°å•ä¸ªå­˜å‚¨åº“ä¸­ï¼ˆJEP-296ï¼‰\" class=\"headerlink\" title=\"9.å°†JDKç”Ÿæ€æ•´åˆåˆ°å•ä¸ªå­˜å‚¨åº“ä¸­ï¼ˆJEP 296ï¼‰\"></a>9.å°†JDKç”Ÿæ€æ•´åˆåˆ°å•ä¸ªå­˜å‚¨åº“ä¸­ï¼ˆJEP 296ï¼‰</h4><p>æ­¤JEPçš„ä¸»è¦ç›®æ ‡æ˜¯æ‰§è¡Œä¸€äº›å†…å­˜ç®¡ç†ï¼Œå¹¶å°†JDKç”Ÿæ€çš„ä¼—å¤šå­˜å‚¨åº“ç»„åˆåˆ°ä¸€ä¸ªå­˜å‚¨åº“ä¸­ã€‚</p>\n<h4 id=\"10-åˆ é™¤Native-Headerç”Ÿæˆå·¥å…·ï¼ˆjavahï¼‰ï¼ˆJEP-313ï¼‰\"><a href=\"#10-åˆ é™¤Native-Headerç”Ÿæˆå·¥å…·ï¼ˆjavahï¼‰ï¼ˆJEP-313ï¼‰\" class=\"headerlink\" title=\"10.åˆ é™¤Native-Headerç”Ÿæˆå·¥å…·ï¼ˆjavahï¼‰ï¼ˆJEP 313ï¼‰\"></a>10.åˆ é™¤Native-Headerç”Ÿæˆå·¥å…·ï¼ˆjavahï¼‰ï¼ˆJEP 313ï¼‰</h4><p>ä»JDKä¸­ç§»é™¤äº†javahå·¥å…·ï¼Œè¿™ä¸ªå¾ˆç®€å•å¹¶ä¸”å¾ˆé‡è¦ã€‚</p>\n<h3 id=\"å°é²œ\"><a href=\"#å°é²œ\" class=\"headerlink\" title=\"å°é²œ\"></a>å°é²œ</h3><p>å°±åƒæ‰€æœ‰å…¶ä»–JDKç‰ˆæœ¬ä¸€æ ·ï¼ŒOracleå·²ç»å‘å¸ƒäº†ä¸€ä¸ªJava 10åˆå§‹å€™é€‰ç‰ˆæœ¬ï¼ŒJavaå¼€å‘è€…å¯ä»¥ä¸‹è½½æ­¤ç‰ˆæœ¬ç”¨æ¥æµ‹è¯•æ–°åŠŸèƒ½ã€‚å¦‚æœä½ å¯¹Java 10æŠ±æœ‰æœŸå¾…æƒ³ææ—©å°è¯•ï¼Œé‚£ä¹ˆç°åœ¨å°±å¼€å§‹å§ï¼</p>\n<blockquote>\n<p>å°é²œåœ°å€ï¼š<a href=\"http://openjdk.java.net/projects/jdk/10/\">http://openjdk.java.net/projects/jdk/10/</a></p>\n</blockquote>\n<h4 id=\"æœ€åçš„æ„Ÿæ‚Ÿ\"><a href=\"#æœ€åçš„æ„Ÿæ‚Ÿ\" class=\"headerlink\" title=\"æœ€åçš„æ„Ÿæ‚Ÿ\"></a>æœ€åçš„æ„Ÿæ‚Ÿ</h4><p>å¯¹äºç¬¬ä¸€ç‚¹æ–°ç‰¹æ€§æ¥è¯´ç¡®å®æ˜¯ä¸€ä¸ªå¤§çš„è·¨è¶Šï¼Œå…¶ä»–ç‰¹æ€§æˆ–å¤šæˆ–å°‘éƒ½èƒ½å¸¦ç»™å¼€å‘è€…ç¦éŸ³ã€‚ä½†æœ€ç»ˆJava 10ä¼šæ˜¯ä»€ä¹ˆæ ·ï¼Œæˆ–è®¸è¿˜ä¼šå¢åŠ æ›´å¤šå®ç”¨æ€§çš„æ–°åŠŸèƒ½æˆ–è€…ä¼˜åŒ–ï¼Œæˆ‘ä»¬è¿˜å¾—æœŸå¾…ï¼</p>\n<p>ç°åœ¨è¦åšçš„å°±æ˜¯ï¼Œèµ¶ç´§ç†Ÿæ‚‰JDK 8ï¼Œç°åœ¨å·²ç»æ˜¯å¾ˆå¤šäº’è”ç½‘ä¼ä¸šæ ‡é…äº†ã€‚å¦‚æœè¿˜åœ¨ä½¿ç”¨JDK4-7ï¼Œé‚£çœŸçš„æ˜¯è¦OUTäº†ã€‚ã€‚</p>\n<p>åœ¨ä¸ä¹…çš„å°†æ¥ï¼ŒJava 10å°†å½»åº•æ”¹å˜ä½ å†™ä»£ç çš„æ–¹å¼ï¼</p>\n"},{"title":"Java 11 æ­£å¼å‘å¸ƒï¼Œè¿™ 8 ä¸ªæ–°ç‰¹æ€§æ•™ä½ å†™å‡ºæ›´ç‰›é€¼çš„ä»£ç ","date":"2025-10-15T03:36:33.000Z","_content":"\nç¾å›½æ—¶é—´ 09 æœˆ 25 æ—¥ï¼ŒOralce æ­£å¼å‘å¸ƒäº† Java 11ï¼Œè¿™æ˜¯æ® Java 8 ä»¥åæ”¯æŒçš„é¦–ä¸ªé•¿æœŸç‰ˆæœ¬ã€‚\n\nä¸ºä»€ä¹ˆè¯´æ˜¯é•¿æœŸç‰ˆæœ¬ï¼Œçœ‹ä¸‹é¢çš„å®˜æ–¹å‘å¸ƒçš„æ”¯æŒè·¯çº¿å›¾è¡¨ã€‚\n\n![](http://qianniu.javastack.cn/18-9-26/91229065.jpg)\n\nå¯ä»¥çœ‹å‡º Java 8 æ‰©å±•æ”¯æŒåˆ° 2025 å¹´ï¼Œè€Œ Java 11 æ‰©å±•æ”¯æŒåˆ° 2026 å¹´ã€‚\n\nç°åœ¨å¤§éƒ¨åˆ†éƒ½åœ¨ç”¨ Java 8ï¼ŒJava 9 å’Œ 10 ç›®å‰å¾ˆå°‘æœ‰äººåœ¨ç”¨ï¼Œè‡³å°‘æˆ‘æ²¡æœ‰å‘ç°æœ‰å…¬å¸åœ¨ç”Ÿäº§ç¯å¢ƒåº”ç”¨çš„ï¼Œé‚£å°±æ˜¯æ‰¾æ­»ã€‚\n\nç°åœ¨ Java 11 é•¿æœŸæ”¯æŒï¼Œä¹Ÿå·²ç»åŒ…å«äº† 9 å’Œ 10 çš„å…¨éƒ¨åŠŸèƒ½ï¼Œ9 å’Œ 10 è‡ªç„¶å°±æ´»åˆ°å¤´äº†ã€‚ã€‚\n\né‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹ä¸‹ ä» Java 9 - 11 éƒ½æœ‰å“ªäº›é‡è¦çš„æ–°ç‰¹æ€§å‘¢ï¼Ÿ\n\n#### 1ã€æœ¬åœ°å˜é‡ç±»å‹æ¨æ–­\n\nè¿™ä¸ªåšä¸»å·²ç»å†™è¿‡ä¸€ç¯‡æ–‡ç« ï¼Œè¯¦ç»†çš„ä»‹ç»äº† Java 10 å¸¦æ¥çš„è¿™ä¸ªæ–°ç‰¹æ€§ã€‚\n\nä»€ä¹ˆæ˜¯å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ï¼Ÿ\n\n```\nvar javastack = \"javastack\";\nSystem.out.println(javastack);\n```\n\nå¤§å®¶çœ‹å‡ºæ¥äº†ï¼Œå±€éƒ¨å˜é‡ç±»å‹æ¨æ–­å°±æ˜¯å·¦è¾¹çš„ç±»å‹ç›´æ¥ä½¿ç”¨ `var` å®šä¹‰ï¼Œè€Œä¸ç”¨å†™å…·ä½“çš„ç±»å‹ï¼Œç¼–è¯‘å™¨èƒ½æ ¹æ®å³è¾¹çš„è¡¨è¾¾å¼è‡ªåŠ¨æ¨æ–­ç±»å‹ï¼Œå¦‚ä¸Šé¢çš„ `String` ã€‚\n\n```\nvar javastack = \"javastack\";\n```\n\nå°±ç­‰äºï¼š\n\n```\nString javastack = \"javastack\";\n```\n\næ›´å¤šä½¿ç”¨è¯¦æƒ…è¯·å‚è€ƒè¿™ç¯‡æ–‡ç« ã€Š[Java 10 å®æˆ˜ç¬¬ 1 ç¯‡ï¼šå±€éƒ¨å˜é‡ç±»å‹æ¨æ–­](https://mp.weixin.qq.com/s/4zUtQPUn5LYw43IRLm0Dwg)ã€‹ï¼Œè¿™é‡Œä¸å†é‡å¤äº†ã€‚\n\n\n#### 2ã€å­—ç¬¦ä¸²åŠ å¼º\n\nJava 11 å¢åŠ äº†ä¸€ç³»åˆ—çš„å­—ç¬¦ä¸²å¤„ç†æ–¹æ³•ï¼Œå¦‚ä»¥ä¸‹æ‰€ç¤ºã€‚\n\n```\n// åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºç™½\n\" \".isBlank();                // true\n\n// å»é™¤é¦–å°¾ç©ºæ ¼\n\" Javastack \".strip();          // \"Javastack\"\n\n// å»é™¤å°¾éƒ¨ç©ºæ ¼ \n\" Javastack \".stripTrailing();  // \" Javastack\"\n\n// å»é™¤é¦–éƒ¨ç©ºæ ¼ \n\" Javastack \".stripLeading();   // \"Javastack \"\n\n// å¤åˆ¶å­—ç¬¦ä¸²\n\"Java\".repeat(3);             // \"JavaJavaJava\"\n\n// è¡Œæ•°ç»Ÿè®¡\n\"A\\nB\\nC\".lines().count();    // 3\n```\n\n#### 3ã€é›†åˆåŠ å¼º\n\nè‡ª Java 9 å¼€å§‹ï¼ŒJdk é‡Œé¢ä¸ºé›†åˆï¼ˆList/ Set/ Mapï¼‰éƒ½æ·»åŠ äº† `of` å’Œ `copyOf` æ–¹æ³•ï¼Œå®ƒä»¬ä¸¤ä¸ªéƒ½ç”¨æ¥åˆ›å»ºä¸å¯å˜çš„é›†åˆï¼Œæ¥çœ‹ä¸‹å®ƒä»¬çš„ä½¿ç”¨å’ŒåŒºåˆ«ã€‚\n\n**ç¤ºä¾‹1ï¼š**\n\n```\nvar list = List.of(\"Java\", \"Python\", \"C\");\nvar copy = List.copyOf(list);\nSystem.out.println(list == copy);   // true\n```\n\n**ç¤ºä¾‹2ï¼š**\n\n```\nvar list = new ArrayList<String>();\nvar copy = List.copyOf(list);\nSystem.out.println(list == copy);   // false\n```\n\nç¤ºä¾‹1å’Œ2ä»£ç å·®ä¸å¤šï¼Œä¸ºä»€ä¹ˆä¸€ä¸ªä¸ºtrue,ä¸€ä¸ªä¸ºfalse?\n\næ¥çœ‹ä¸‹å®ƒä»¬çš„æºç ï¼š\n\n```\nstatic <E> List<E> of(E... elements) {\n    switch (elements.length) { // implicit null check of elements\n        case 0:\n            return ImmutableCollections.emptyList();\n        case 1:\n            return new ImmutableCollections.List12<>(elements[0]);\n        case 2:\n            return new ImmutableCollections.List12<>(elements[0], elements[1]);\n        default:\n            return new ImmutableCollections.ListN<>(elements);\n    }\n}\n\nstatic <E> List<E> copyOf(Collection<? extends E> coll) {\n    return ImmutableCollections.listCopy(coll);\n}\n\nstatic <E> List<E> listCopy(Collection<? extends E> coll) {\n    if (coll instanceof AbstractImmutableList && coll.getClass() != SubList.class) {\n        return (List<E>)coll;\n    } else {\n        return (List<E>)List.of(coll.toArray());\n    }\n}\n```\n\nå¯ä»¥çœ‹å‡º `copyOf` æ–¹æ³•ä¼šå…ˆåˆ¤æ–­æ¥æºé›†åˆæ˜¯ä¸æ˜¯ `AbstractImmutableList` ç±»å‹çš„ï¼Œå¦‚æœæ˜¯ï¼Œå°±ç›´æ¥è¿”å›ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™è°ƒç”¨ `of` åˆ›å»ºä¸€ä¸ªæ–°çš„é›†åˆã€‚\n\nç¤ºä¾‹2å› ä¸ºç”¨çš„ new åˆ›å»ºçš„é›†åˆï¼Œä¸å±äºä¸å¯å˜ `AbstractImmutableList` ç±»çš„å­ç±»ï¼Œæ‰€ä»¥ `copyOf` æ–¹æ³•åˆåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œæ‰€ä»¥ä¸ºfalse.\n\n> æ³¨æ„ï¼šä½¿ç”¨ of å’Œ copyOf åˆ›å»ºçš„é›†åˆä¸ºä¸å¯å˜é›†åˆï¼Œä¸èƒ½è¿›è¡Œæ·»åŠ ã€åˆ é™¤ã€æ›¿æ¢ã€æ’åºç­‰æ“ä½œï¼Œä¸ç„¶ä¼šæŠ¥ `java.lang.UnsupportedOperationException` å¼‚å¸¸ã€‚\n\nä¸Šé¢æ¼”ç¤ºäº† List çš„ of å’Œ copyOf æ–¹æ³•ï¼ŒSet å’Œ Map æ¥å£éƒ½æœ‰ã€‚\n\n#### 4ã€Stream åŠ å¼º\n\nStream æ˜¯ Java 8 ä¸­çš„æ–°ç‰¹æ€§ï¼ŒJava 9 å¼€å§‹å¯¹ Stream å¢åŠ äº†ä»¥ä¸‹ 4 ä¸ªæ–°æ–¹æ³•ã€‚\n\n1) å¢åŠ å•ä¸ªå‚æ•°æ„é€ æ–¹æ³•ï¼Œå¯ä¸ºnull\n\n```\nStream.ofNullable(null).count(); // 0\n```\n\n2) å¢åŠ  takeWhile å’Œ dropWhile æ–¹æ³•\n\n```\nStream.of(1, 2, 3, 2, 1)\n    .takeWhile(n -> n < 3)\n    .collect(Collectors.toList());  // [1, 2]\n```\n\nä»å¼€å§‹è®¡ç®—ï¼Œå½“ n < 3 æ—¶å°±æˆªæ­¢ã€‚\n    \n```\nStream.of(1, 2, 3, 2, 1)\n    .dropWhile(n -> n < 3)\n    .collect(Collectors.toList());  // [3, 2, 1]\n```\n\nè¿™ä¸ªå’Œä¸Šé¢çš„ç›¸åï¼Œä¸€æ—¦ n < 3 ä¸æˆç«‹å°±å¼€å§‹è®¡ç®—ã€‚\n\n3ï¼‰iterateé‡è½½\n\nè¿™ä¸ª iterate æ–¹æ³•çš„æ–°é‡è½½æ–¹æ³•ï¼Œå¯ä»¥è®©ä½ æä¾›ä¸€ä¸ª Predicate (åˆ¤æ–­æ¡ä»¶)æ¥æŒ‡å®šä»€ä¹ˆæ—¶å€™ç»“æŸè¿­ä»£ã€‚\n\nå¦‚æœä½ å¯¹ JDK 8 ä¸­çš„ Stream è¿˜ä¸ç†Ÿæ‚‰ï¼Œå¯ä»¥çœ‹ä¹‹å‰åˆ†äº«çš„è¿™ä¸€ç³»åˆ—æ•™ç¨‹ã€‚\n\n#### 5ã€Optional åŠ å¼º\n\nOpthonal ä¹Ÿå¢åŠ äº†å‡ ä¸ªéå¸¸é…·çš„æ–¹æ³•ï¼Œç°åœ¨å¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†ä¸€ä¸ª Optional è½¬æ¢æˆä¸€ä¸ª Stream, æˆ–è€…å½“ä¸€ä¸ªç©º Optional æ—¶ç»™å®ƒä¸€ä¸ªæ›¿ä»£çš„ã€‚\n\n```\nOptional.of(\"javastack\").orElseThrow();     // javastack\nOptional.of(\"javastack\").stream().count();  // 1\nOptional.ofNullable(null)\n    .or(() -> Optional.of(\"javastack\"))\n    .get();   // javastack\n```\n\n#### 6ã€InputStream åŠ å¼º\n\nInputStream ç»ˆäºæœ‰äº†ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æ–¹æ³•ï¼štransferToï¼Œå¯ä»¥ç”¨æ¥å°†æ•°æ®ç›´æ¥ä¼ è¾“åˆ° OutputStreamï¼Œè¿™æ˜¯åœ¨å¤„ç†åŸå§‹æ•°æ®æµæ—¶éå¸¸å¸¸è§çš„ä¸€ç§ç”¨æ³•ï¼Œå¦‚ä¸‹ç¤ºä¾‹ã€‚\n\n```\nvar classLoader = ClassLoader.getSystemClassLoader();\nvar inputStream = classLoader.getResourceAsStream(\"javastack.txt\");\nvar javastack = File.createTempFile(\"javastack2\", \"txt\");\ntry (var outputStream = new FileOutputStream(javastack)) {\n    inputStream.transferTo(outputStream);\n}\n```\n\n#### 7ã€HTTP Client API\n\nè¿™æ˜¯ Java 9 å¼€å§‹å¼•å…¥çš„ä¸€ä¸ªå¤„ç† HTTP è¯·æ±‚çš„çš„å­µåŒ– HTTP Client  APIï¼Œè¯¥ API æ”¯æŒåŒæ­¥å’Œå¼‚æ­¥ï¼Œè€Œåœ¨ Java 11 ä¸­å·²ç»ä¸ºæ­£å¼å¯ç”¨çŠ¶æ€ï¼Œä½ å¯ä»¥åœ¨ `java.net` åŒ…ä¸­æ‰¾åˆ°è¿™ä¸ª APIã€‚\n\næ¥çœ‹ä¸€ä¸‹ HTTP Client çš„ç”¨æ³•ï¼š\n\n```\nvar request = HttpRequest.newBuilder()\n    .uri(URI.create(\"https://javastack.cn\"))\n    .GET()\n    .build();\nvar client = HttpClient.newHttpClient();\n\n// åŒæ­¥\nHttpResponse<String> response = client.send(request, HttpResponse.BodyHandlers.ofString());\nSystem.out.println(response.body());\n\n// å¼‚æ­¥\nclient.sendAsync(request, HttpResponse.BodyHandlers.ofString())\n    .thenApply(HttpResponse::body)\n    .thenAccept(System.out::println);\n```\n\nä¸Šé¢çš„ `.GET()` å¯ä»¥çœç•¥ï¼Œé»˜è®¤è¯·æ±‚æ–¹å¼ä¸º Getï¼\n\næ›´å¤šä½¿ç”¨ç¤ºä¾‹å¯ä»¥çœ‹è¿™ä¸ª APIï¼Œåç»­æœ‰æœºä¼šå†åšæ¼”ç¤ºã€‚\n\nç°åœ¨ Java è‡ªå¸¦äº†è¿™ä¸ª HTTP Client APIï¼Œæˆ‘ä»¬ä»¥åè¿˜æœ‰å¿…è¦ç”¨ Apache çš„ HttpClient å·¥å…·åŒ…å—ï¼Ÿ\n\n#### 8ã€åŒ–ç¹ä¸ºç®€ï¼Œä¸€ä¸ªå‘½ä»¤ç¼–è¯‘è¿è¡Œæºä»£ç \n\nçœ‹ä¸‹é¢çš„ä»£ç ã€‚\n\n```\n// ç¼–è¯‘\njavac Javastack.java\n\n// è¿è¡Œ\njava Javastack\n```\n\nåœ¨æˆ‘ä»¬çš„è®¤çŸ¥é‡Œé¢ï¼Œè¦è¿è¡Œä¸€ä¸ª Java æºä»£ç å¿…é¡»å…ˆç¼–è¯‘ï¼Œå†è¿è¡Œï¼Œä¸¤æ­¥æ‰§è¡ŒåŠ¨ä½œã€‚è€Œåœ¨æœªæ¥çš„ Java 11 ç‰ˆæœ¬ä¸­ï¼Œé€šè¿‡ä¸€ä¸ª `java` å‘½ä»¤å°±ç›´æ¥æå®šäº†ï¼Œå¦‚ä»¥ä¸‹æ‰€ç¤ºã€‚\n\n```\njava Javastack.java\n```\n\n#### æ›´å¤šæ–°ç‰¹æ€§\n\n- Flow API for reactive programming\n- Java Module System\n- Application Class Data Sharing\n- Dynamic Class-File Constants\n- Java REPL (JShell)\n- Flight Recorder\n- Unicode 10\n- G1: Full Parallel Garbage Collector\n- ZGC: Scalable Low-Latency Garbage Collector\n- Epsilon: No-Op Garbage Collector\n- Deprecate the Nashorn JavaScript Engine\n- ...\n\n#### å†å²æ–°ç‰¹æ€§æ–‡ç« \n\n- Java 11 è¦æ¥äº†ï¼Œç¼–è¯‘è¿è¡Œä¸€ä¸ªå‘½ä»¤æå®š\n- JDK 11 å‘å¸ƒè®¡åˆ’æ¥äº†ï¼Œå·²ç¡®å®š 3ä¸ª æ–°ç‰¹æ€§\n- Java 10 å®æˆ˜ç¬¬ 1 ç¯‡ï¼šå±€éƒ¨å˜é‡ç±»å‹æ¨æ–­\n- JDK 5 ~ 10 æ–°ç‰¹æ€§å€¾æƒ…æ•´ç†\n- JDK 10 çš„ 10 ä¸ªæ–°ç‰¹æ€§\n- JDK 10 æœ€é‡è¦çš„ 5 ä¸ªæ–°ç‰¹æ€§\n- JDK 9 çš„ 9 ä¸ªæ–°ç‰¹æ€§\n- JDK 9 æ–°ç‰¹æ€§å®æˆ˜ï¼šç®€åŒ–æµå…³é—­æ–°å§¿åŠ¿\n- JDK 8 çš„æ’åºå¤§æ³•\n- JDK 8 æ–°ç‰¹æ€§ä¹‹ Lambda è¡¨è¾¾å¼\n- JDK 8 æ–°ç‰¹æ€§ä¹‹å‡½æ•°å¼æ¥å£\n- JDK 8 æ–°ç‰¹æ€§ä¹‹æ–¹æ³•å¼•ç”¨\n- JDK 8 æ–°ç‰¹æ€§ä¹‹æ¥å£é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•\n- JDK 8 æ–°ç‰¹æ€§ä¹‹ Optional\n- JDK 8 æ–°ç‰¹æ€§ä¹‹é‡å¤æ³¨è§£\n- JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµ\n- JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸€ï¼‰åŸºç¡€ä½“éªŒ\n- JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆäºŒï¼‰å…³é”®çŸ¥è¯†ç‚¹\n- JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸‰ï¼‰ç¼©å‡æ“ä½œ\n- JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆå››ï¼‰å¹¶è¡Œæµ\n- JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆäº”ï¼‰æ˜ å°„\n- JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆå…­ï¼‰æ”¶é›†ç¼©\n- JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸ƒï¼‰æµä¸è¿­ä»£å™¨\n- JDK 8 æ–°ç‰¹æ€§ä¹‹æ‰©å±•ç¯‡\n\n\n#### ç»“æŸè¯­\n\nç°åœ¨è®¸å¤šäººè¿˜åœ¨ä½¿ç”¨ Java 8 æˆ–è€… 7ï¼Œä¸è¿‡ 8 åœ¨ 2019 å¹´åˆå°±ä¼šç»“æŸå…è´¹æ›´æ–°ã€‚ç°åœ¨ 11 æ˜¯é•¿æœŸæ”¯æŒç‰ˆæœ¬ï¼Œæ­£æ˜¯å­¦ä¹ å’Œä¸Šæ‰‹ 11 çš„å¥½æ—¶æœºï¼Œå†™è¿™ç¯‡æ–‡ç« å¸Œæœ›èƒ½å¯¹ä½ æœ‰æ‰€å¯å‘ã€‚\n\nå¦‚æœä½ å–œæ¬¢çš„æˆ‘çš„æ–‡ç« ï¼Œå¯¹ä½ æœ‰å¸®åŠ©ï¼Œç‚¹èµè½¬å‘æ”¯æŒä¸€ä¸‹å§~\n\n","source":"_posts/æ–°ç‰¹æ€§/Java11/Java 11 æ­£å¼å‘å¸ƒï¼Œè¿™ 8 ä¸ªæ–°ç‰¹æ€§æ•™ä½ å†™å‡ºæ›´ç‰›é€¼çš„ä»£ç .md","raw":"---\ntitle: Java 11 æ­£å¼å‘å¸ƒï¼Œè¿™ 8 ä¸ªæ–°ç‰¹æ€§æ•™ä½ å†™å‡ºæ›´ç‰›é€¼çš„ä»£ç \ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: æ–°ç‰¹æ€§\n---\n\nç¾å›½æ—¶é—´ 09 æœˆ 25 æ—¥ï¼ŒOralce æ­£å¼å‘å¸ƒäº† Java 11ï¼Œè¿™æ˜¯æ® Java 8 ä»¥åæ”¯æŒçš„é¦–ä¸ªé•¿æœŸç‰ˆæœ¬ã€‚\n\nä¸ºä»€ä¹ˆè¯´æ˜¯é•¿æœŸç‰ˆæœ¬ï¼Œçœ‹ä¸‹é¢çš„å®˜æ–¹å‘å¸ƒçš„æ”¯æŒè·¯çº¿å›¾è¡¨ã€‚\n\n![](http://qianniu.javastack.cn/18-9-26/91229065.jpg)\n\nå¯ä»¥çœ‹å‡º Java 8 æ‰©å±•æ”¯æŒåˆ° 2025 å¹´ï¼Œè€Œ Java 11 æ‰©å±•æ”¯æŒåˆ° 2026 å¹´ã€‚\n\nç°åœ¨å¤§éƒ¨åˆ†éƒ½åœ¨ç”¨ Java 8ï¼ŒJava 9 å’Œ 10 ç›®å‰å¾ˆå°‘æœ‰äººåœ¨ç”¨ï¼Œè‡³å°‘æˆ‘æ²¡æœ‰å‘ç°æœ‰å…¬å¸åœ¨ç”Ÿäº§ç¯å¢ƒåº”ç”¨çš„ï¼Œé‚£å°±æ˜¯æ‰¾æ­»ã€‚\n\nç°åœ¨ Java 11 é•¿æœŸæ”¯æŒï¼Œä¹Ÿå·²ç»åŒ…å«äº† 9 å’Œ 10 çš„å…¨éƒ¨åŠŸèƒ½ï¼Œ9 å’Œ 10 è‡ªç„¶å°±æ´»åˆ°å¤´äº†ã€‚ã€‚\n\né‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹ä¸‹ ä» Java 9 - 11 éƒ½æœ‰å“ªäº›é‡è¦çš„æ–°ç‰¹æ€§å‘¢ï¼Ÿ\n\n#### 1ã€æœ¬åœ°å˜é‡ç±»å‹æ¨æ–­\n\nè¿™ä¸ªåšä¸»å·²ç»å†™è¿‡ä¸€ç¯‡æ–‡ç« ï¼Œè¯¦ç»†çš„ä»‹ç»äº† Java 10 å¸¦æ¥çš„è¿™ä¸ªæ–°ç‰¹æ€§ã€‚\n\nä»€ä¹ˆæ˜¯å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ï¼Ÿ\n\n```\nvar javastack = \"javastack\";\nSystem.out.println(javastack);\n```\n\nå¤§å®¶çœ‹å‡ºæ¥äº†ï¼Œå±€éƒ¨å˜é‡ç±»å‹æ¨æ–­å°±æ˜¯å·¦è¾¹çš„ç±»å‹ç›´æ¥ä½¿ç”¨ `var` å®šä¹‰ï¼Œè€Œä¸ç”¨å†™å…·ä½“çš„ç±»å‹ï¼Œç¼–è¯‘å™¨èƒ½æ ¹æ®å³è¾¹çš„è¡¨è¾¾å¼è‡ªåŠ¨æ¨æ–­ç±»å‹ï¼Œå¦‚ä¸Šé¢çš„ `String` ã€‚\n\n```\nvar javastack = \"javastack\";\n```\n\nå°±ç­‰äºï¼š\n\n```\nString javastack = \"javastack\";\n```\n\næ›´å¤šä½¿ç”¨è¯¦æƒ…è¯·å‚è€ƒè¿™ç¯‡æ–‡ç« ã€Š[Java 10 å®æˆ˜ç¬¬ 1 ç¯‡ï¼šå±€éƒ¨å˜é‡ç±»å‹æ¨æ–­](https://mp.weixin.qq.com/s/4zUtQPUn5LYw43IRLm0Dwg)ã€‹ï¼Œè¿™é‡Œä¸å†é‡å¤äº†ã€‚\n\n\n#### 2ã€å­—ç¬¦ä¸²åŠ å¼º\n\nJava 11 å¢åŠ äº†ä¸€ç³»åˆ—çš„å­—ç¬¦ä¸²å¤„ç†æ–¹æ³•ï¼Œå¦‚ä»¥ä¸‹æ‰€ç¤ºã€‚\n\n```\n// åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºç™½\n\" \".isBlank();                // true\n\n// å»é™¤é¦–å°¾ç©ºæ ¼\n\" Javastack \".strip();          // \"Javastack\"\n\n// å»é™¤å°¾éƒ¨ç©ºæ ¼ \n\" Javastack \".stripTrailing();  // \" Javastack\"\n\n// å»é™¤é¦–éƒ¨ç©ºæ ¼ \n\" Javastack \".stripLeading();   // \"Javastack \"\n\n// å¤åˆ¶å­—ç¬¦ä¸²\n\"Java\".repeat(3);             // \"JavaJavaJava\"\n\n// è¡Œæ•°ç»Ÿè®¡\n\"A\\nB\\nC\".lines().count();    // 3\n```\n\n#### 3ã€é›†åˆåŠ å¼º\n\nè‡ª Java 9 å¼€å§‹ï¼ŒJdk é‡Œé¢ä¸ºé›†åˆï¼ˆList/ Set/ Mapï¼‰éƒ½æ·»åŠ äº† `of` å’Œ `copyOf` æ–¹æ³•ï¼Œå®ƒä»¬ä¸¤ä¸ªéƒ½ç”¨æ¥åˆ›å»ºä¸å¯å˜çš„é›†åˆï¼Œæ¥çœ‹ä¸‹å®ƒä»¬çš„ä½¿ç”¨å’ŒåŒºåˆ«ã€‚\n\n**ç¤ºä¾‹1ï¼š**\n\n```\nvar list = List.of(\"Java\", \"Python\", \"C\");\nvar copy = List.copyOf(list);\nSystem.out.println(list == copy);   // true\n```\n\n**ç¤ºä¾‹2ï¼š**\n\n```\nvar list = new ArrayList<String>();\nvar copy = List.copyOf(list);\nSystem.out.println(list == copy);   // false\n```\n\nç¤ºä¾‹1å’Œ2ä»£ç å·®ä¸å¤šï¼Œä¸ºä»€ä¹ˆä¸€ä¸ªä¸ºtrue,ä¸€ä¸ªä¸ºfalse?\n\næ¥çœ‹ä¸‹å®ƒä»¬çš„æºç ï¼š\n\n```\nstatic <E> List<E> of(E... elements) {\n    switch (elements.length) { // implicit null check of elements\n        case 0:\n            return ImmutableCollections.emptyList();\n        case 1:\n            return new ImmutableCollections.List12<>(elements[0]);\n        case 2:\n            return new ImmutableCollections.List12<>(elements[0], elements[1]);\n        default:\n            return new ImmutableCollections.ListN<>(elements);\n    }\n}\n\nstatic <E> List<E> copyOf(Collection<? extends E> coll) {\n    return ImmutableCollections.listCopy(coll);\n}\n\nstatic <E> List<E> listCopy(Collection<? extends E> coll) {\n    if (coll instanceof AbstractImmutableList && coll.getClass() != SubList.class) {\n        return (List<E>)coll;\n    } else {\n        return (List<E>)List.of(coll.toArray());\n    }\n}\n```\n\nå¯ä»¥çœ‹å‡º `copyOf` æ–¹æ³•ä¼šå…ˆåˆ¤æ–­æ¥æºé›†åˆæ˜¯ä¸æ˜¯ `AbstractImmutableList` ç±»å‹çš„ï¼Œå¦‚æœæ˜¯ï¼Œå°±ç›´æ¥è¿”å›ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™è°ƒç”¨ `of` åˆ›å»ºä¸€ä¸ªæ–°çš„é›†åˆã€‚\n\nç¤ºä¾‹2å› ä¸ºç”¨çš„ new åˆ›å»ºçš„é›†åˆï¼Œä¸å±äºä¸å¯å˜ `AbstractImmutableList` ç±»çš„å­ç±»ï¼Œæ‰€ä»¥ `copyOf` æ–¹æ³•åˆåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œæ‰€ä»¥ä¸ºfalse.\n\n> æ³¨æ„ï¼šä½¿ç”¨ of å’Œ copyOf åˆ›å»ºçš„é›†åˆä¸ºä¸å¯å˜é›†åˆï¼Œä¸èƒ½è¿›è¡Œæ·»åŠ ã€åˆ é™¤ã€æ›¿æ¢ã€æ’åºç­‰æ“ä½œï¼Œä¸ç„¶ä¼šæŠ¥ `java.lang.UnsupportedOperationException` å¼‚å¸¸ã€‚\n\nä¸Šé¢æ¼”ç¤ºäº† List çš„ of å’Œ copyOf æ–¹æ³•ï¼ŒSet å’Œ Map æ¥å£éƒ½æœ‰ã€‚\n\n#### 4ã€Stream åŠ å¼º\n\nStream æ˜¯ Java 8 ä¸­çš„æ–°ç‰¹æ€§ï¼ŒJava 9 å¼€å§‹å¯¹ Stream å¢åŠ äº†ä»¥ä¸‹ 4 ä¸ªæ–°æ–¹æ³•ã€‚\n\n1) å¢åŠ å•ä¸ªå‚æ•°æ„é€ æ–¹æ³•ï¼Œå¯ä¸ºnull\n\n```\nStream.ofNullable(null).count(); // 0\n```\n\n2) å¢åŠ  takeWhile å’Œ dropWhile æ–¹æ³•\n\n```\nStream.of(1, 2, 3, 2, 1)\n    .takeWhile(n -> n < 3)\n    .collect(Collectors.toList());  // [1, 2]\n```\n\nä»å¼€å§‹è®¡ç®—ï¼Œå½“ n < 3 æ—¶å°±æˆªæ­¢ã€‚\n    \n```\nStream.of(1, 2, 3, 2, 1)\n    .dropWhile(n -> n < 3)\n    .collect(Collectors.toList());  // [3, 2, 1]\n```\n\nè¿™ä¸ªå’Œä¸Šé¢çš„ç›¸åï¼Œä¸€æ—¦ n < 3 ä¸æˆç«‹å°±å¼€å§‹è®¡ç®—ã€‚\n\n3ï¼‰iterateé‡è½½\n\nè¿™ä¸ª iterate æ–¹æ³•çš„æ–°é‡è½½æ–¹æ³•ï¼Œå¯ä»¥è®©ä½ æä¾›ä¸€ä¸ª Predicate (åˆ¤æ–­æ¡ä»¶)æ¥æŒ‡å®šä»€ä¹ˆæ—¶å€™ç»“æŸè¿­ä»£ã€‚\n\nå¦‚æœä½ å¯¹ JDK 8 ä¸­çš„ Stream è¿˜ä¸ç†Ÿæ‚‰ï¼Œå¯ä»¥çœ‹ä¹‹å‰åˆ†äº«çš„è¿™ä¸€ç³»åˆ—æ•™ç¨‹ã€‚\n\n#### 5ã€Optional åŠ å¼º\n\nOpthonal ä¹Ÿå¢åŠ äº†å‡ ä¸ªéå¸¸é…·çš„æ–¹æ³•ï¼Œç°åœ¨å¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†ä¸€ä¸ª Optional è½¬æ¢æˆä¸€ä¸ª Stream, æˆ–è€…å½“ä¸€ä¸ªç©º Optional æ—¶ç»™å®ƒä¸€ä¸ªæ›¿ä»£çš„ã€‚\n\n```\nOptional.of(\"javastack\").orElseThrow();     // javastack\nOptional.of(\"javastack\").stream().count();  // 1\nOptional.ofNullable(null)\n    .or(() -> Optional.of(\"javastack\"))\n    .get();   // javastack\n```\n\n#### 6ã€InputStream åŠ å¼º\n\nInputStream ç»ˆäºæœ‰äº†ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æ–¹æ³•ï¼štransferToï¼Œå¯ä»¥ç”¨æ¥å°†æ•°æ®ç›´æ¥ä¼ è¾“åˆ° OutputStreamï¼Œè¿™æ˜¯åœ¨å¤„ç†åŸå§‹æ•°æ®æµæ—¶éå¸¸å¸¸è§çš„ä¸€ç§ç”¨æ³•ï¼Œå¦‚ä¸‹ç¤ºä¾‹ã€‚\n\n```\nvar classLoader = ClassLoader.getSystemClassLoader();\nvar inputStream = classLoader.getResourceAsStream(\"javastack.txt\");\nvar javastack = File.createTempFile(\"javastack2\", \"txt\");\ntry (var outputStream = new FileOutputStream(javastack)) {\n    inputStream.transferTo(outputStream);\n}\n```\n\n#### 7ã€HTTP Client API\n\nè¿™æ˜¯ Java 9 å¼€å§‹å¼•å…¥çš„ä¸€ä¸ªå¤„ç† HTTP è¯·æ±‚çš„çš„å­µåŒ– HTTP Client  APIï¼Œè¯¥ API æ”¯æŒåŒæ­¥å’Œå¼‚æ­¥ï¼Œè€Œåœ¨ Java 11 ä¸­å·²ç»ä¸ºæ­£å¼å¯ç”¨çŠ¶æ€ï¼Œä½ å¯ä»¥åœ¨ `java.net` åŒ…ä¸­æ‰¾åˆ°è¿™ä¸ª APIã€‚\n\næ¥çœ‹ä¸€ä¸‹ HTTP Client çš„ç”¨æ³•ï¼š\n\n```\nvar request = HttpRequest.newBuilder()\n    .uri(URI.create(\"https://javastack.cn\"))\n    .GET()\n    .build();\nvar client = HttpClient.newHttpClient();\n\n// åŒæ­¥\nHttpResponse<String> response = client.send(request, HttpResponse.BodyHandlers.ofString());\nSystem.out.println(response.body());\n\n// å¼‚æ­¥\nclient.sendAsync(request, HttpResponse.BodyHandlers.ofString())\n    .thenApply(HttpResponse::body)\n    .thenAccept(System.out::println);\n```\n\nä¸Šé¢çš„ `.GET()` å¯ä»¥çœç•¥ï¼Œé»˜è®¤è¯·æ±‚æ–¹å¼ä¸º Getï¼\n\næ›´å¤šä½¿ç”¨ç¤ºä¾‹å¯ä»¥çœ‹è¿™ä¸ª APIï¼Œåç»­æœ‰æœºä¼šå†åšæ¼”ç¤ºã€‚\n\nç°åœ¨ Java è‡ªå¸¦äº†è¿™ä¸ª HTTP Client APIï¼Œæˆ‘ä»¬ä»¥åè¿˜æœ‰å¿…è¦ç”¨ Apache çš„ HttpClient å·¥å…·åŒ…å—ï¼Ÿ\n\n#### 8ã€åŒ–ç¹ä¸ºç®€ï¼Œä¸€ä¸ªå‘½ä»¤ç¼–è¯‘è¿è¡Œæºä»£ç \n\nçœ‹ä¸‹é¢çš„ä»£ç ã€‚\n\n```\n// ç¼–è¯‘\njavac Javastack.java\n\n// è¿è¡Œ\njava Javastack\n```\n\nåœ¨æˆ‘ä»¬çš„è®¤çŸ¥é‡Œé¢ï¼Œè¦è¿è¡Œä¸€ä¸ª Java æºä»£ç å¿…é¡»å…ˆç¼–è¯‘ï¼Œå†è¿è¡Œï¼Œä¸¤æ­¥æ‰§è¡ŒåŠ¨ä½œã€‚è€Œåœ¨æœªæ¥çš„ Java 11 ç‰ˆæœ¬ä¸­ï¼Œé€šè¿‡ä¸€ä¸ª `java` å‘½ä»¤å°±ç›´æ¥æå®šäº†ï¼Œå¦‚ä»¥ä¸‹æ‰€ç¤ºã€‚\n\n```\njava Javastack.java\n```\n\n#### æ›´å¤šæ–°ç‰¹æ€§\n\n- Flow API for reactive programming\n- Java Module System\n- Application Class Data Sharing\n- Dynamic Class-File Constants\n- Java REPL (JShell)\n- Flight Recorder\n- Unicode 10\n- G1: Full Parallel Garbage Collector\n- ZGC: Scalable Low-Latency Garbage Collector\n- Epsilon: No-Op Garbage Collector\n- Deprecate the Nashorn JavaScript Engine\n- ...\n\n#### å†å²æ–°ç‰¹æ€§æ–‡ç« \n\n- Java 11 è¦æ¥äº†ï¼Œç¼–è¯‘è¿è¡Œä¸€ä¸ªå‘½ä»¤æå®š\n- JDK 11 å‘å¸ƒè®¡åˆ’æ¥äº†ï¼Œå·²ç¡®å®š 3ä¸ª æ–°ç‰¹æ€§\n- Java 10 å®æˆ˜ç¬¬ 1 ç¯‡ï¼šå±€éƒ¨å˜é‡ç±»å‹æ¨æ–­\n- JDK 5 ~ 10 æ–°ç‰¹æ€§å€¾æƒ…æ•´ç†\n- JDK 10 çš„ 10 ä¸ªæ–°ç‰¹æ€§\n- JDK 10 æœ€é‡è¦çš„ 5 ä¸ªæ–°ç‰¹æ€§\n- JDK 9 çš„ 9 ä¸ªæ–°ç‰¹æ€§\n- JDK 9 æ–°ç‰¹æ€§å®æˆ˜ï¼šç®€åŒ–æµå…³é—­æ–°å§¿åŠ¿\n- JDK 8 çš„æ’åºå¤§æ³•\n- JDK 8 æ–°ç‰¹æ€§ä¹‹ Lambda è¡¨è¾¾å¼\n- JDK 8 æ–°ç‰¹æ€§ä¹‹å‡½æ•°å¼æ¥å£\n- JDK 8 æ–°ç‰¹æ€§ä¹‹æ–¹æ³•å¼•ç”¨\n- JDK 8 æ–°ç‰¹æ€§ä¹‹æ¥å£é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•\n- JDK 8 æ–°ç‰¹æ€§ä¹‹ Optional\n- JDK 8 æ–°ç‰¹æ€§ä¹‹é‡å¤æ³¨è§£\n- JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµ\n- JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸€ï¼‰åŸºç¡€ä½“éªŒ\n- JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆäºŒï¼‰å…³é”®çŸ¥è¯†ç‚¹\n- JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸‰ï¼‰ç¼©å‡æ“ä½œ\n- JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆå››ï¼‰å¹¶è¡Œæµ\n- JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆäº”ï¼‰æ˜ å°„\n- JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆå…­ï¼‰æ”¶é›†ç¼©\n- JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸ƒï¼‰æµä¸è¿­ä»£å™¨\n- JDK 8 æ–°ç‰¹æ€§ä¹‹æ‰©å±•ç¯‡\n\n\n#### ç»“æŸè¯­\n\nç°åœ¨è®¸å¤šäººè¿˜åœ¨ä½¿ç”¨ Java 8 æˆ–è€… 7ï¼Œä¸è¿‡ 8 åœ¨ 2019 å¹´åˆå°±ä¼šç»“æŸå…è´¹æ›´æ–°ã€‚ç°åœ¨ 11 æ˜¯é•¿æœŸæ”¯æŒç‰ˆæœ¬ï¼Œæ­£æ˜¯å­¦ä¹ å’Œä¸Šæ‰‹ 11 çš„å¥½æ—¶æœºï¼Œå†™è¿™ç¯‡æ–‡ç« å¸Œæœ›èƒ½å¯¹ä½ æœ‰æ‰€å¯å‘ã€‚\n\nå¦‚æœä½ å–œæ¬¢çš„æˆ‘çš„æ–‡ç« ï¼Œå¯¹ä½ æœ‰å¸®åŠ©ï¼Œç‚¹èµè½¬å‘æ”¯æŒä¸€ä¸‹å§~\n\n","slug":"æ–°ç‰¹æ€§/Java11/Java 11 æ­£å¼å‘å¸ƒï¼Œè¿™ 8 ä¸ªæ–°ç‰¹æ€§æ•™ä½ å†™å‡ºæ›´ç‰›é€¼çš„ä»£ç ","published":1,"updated":"2025-10-15T07:20:51.502Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu0773005bqkd4boqfh6mo","content":"<p>ç¾å›½æ—¶é—´ 09 æœˆ 25 æ—¥ï¼ŒOralce æ­£å¼å‘å¸ƒäº† Java 11ï¼Œè¿™æ˜¯æ® Java 8 ä»¥åæ”¯æŒçš„é¦–ä¸ªé•¿æœŸç‰ˆæœ¬ã€‚</p>\n<p>ä¸ºä»€ä¹ˆè¯´æ˜¯é•¿æœŸç‰ˆæœ¬ï¼Œçœ‹ä¸‹é¢çš„å®˜æ–¹å‘å¸ƒçš„æ”¯æŒè·¯çº¿å›¾è¡¨ã€‚</p>\n<p><img src=\"http://qianniu.javastack.cn/18-9-26/91229065.jpg\"></p>\n<p>å¯ä»¥çœ‹å‡º Java 8 æ‰©å±•æ”¯æŒåˆ° 2025 å¹´ï¼Œè€Œ Java 11 æ‰©å±•æ”¯æŒåˆ° 2026 å¹´ã€‚</p>\n<p>ç°åœ¨å¤§éƒ¨åˆ†éƒ½åœ¨ç”¨ Java 8ï¼ŒJava 9 å’Œ 10 ç›®å‰å¾ˆå°‘æœ‰äººåœ¨ç”¨ï¼Œè‡³å°‘æˆ‘æ²¡æœ‰å‘ç°æœ‰å…¬å¸åœ¨ç”Ÿäº§ç¯å¢ƒåº”ç”¨çš„ï¼Œé‚£å°±æ˜¯æ‰¾æ­»ã€‚</p>\n<p>ç°åœ¨ Java 11 é•¿æœŸæ”¯æŒï¼Œä¹Ÿå·²ç»åŒ…å«äº† 9 å’Œ 10 çš„å…¨éƒ¨åŠŸèƒ½ï¼Œ9 å’Œ 10 è‡ªç„¶å°±æ´»åˆ°å¤´äº†ã€‚ã€‚</p>\n<p>é‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹ä¸‹ ä» Java 9 - 11 éƒ½æœ‰å“ªäº›é‡è¦çš„æ–°ç‰¹æ€§å‘¢ï¼Ÿ</p>\n<h4 id=\"1ã€æœ¬åœ°å˜é‡ç±»å‹æ¨æ–­\"><a href=\"#1ã€æœ¬åœ°å˜é‡ç±»å‹æ¨æ–­\" class=\"headerlink\" title=\"1ã€æœ¬åœ°å˜é‡ç±»å‹æ¨æ–­\"></a>1ã€æœ¬åœ°å˜é‡ç±»å‹æ¨æ–­</h4><p>è¿™ä¸ªåšä¸»å·²ç»å†™è¿‡ä¸€ç¯‡æ–‡ç« ï¼Œè¯¦ç»†çš„ä»‹ç»äº† Java 10 å¸¦æ¥çš„è¿™ä¸ªæ–°ç‰¹æ€§ã€‚</p>\n<p>ä»€ä¹ˆæ˜¯å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ï¼Ÿ</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">var javastack &#x3D; &quot;javastack&quot;;\nSystem.out.println(javastack);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>å¤§å®¶çœ‹å‡ºæ¥äº†ï¼Œå±€éƒ¨å˜é‡ç±»å‹æ¨æ–­å°±æ˜¯å·¦è¾¹çš„ç±»å‹ç›´æ¥ä½¿ç”¨ <code>var</code> å®šä¹‰ï¼Œè€Œä¸ç”¨å†™å…·ä½“çš„ç±»å‹ï¼Œç¼–è¯‘å™¨èƒ½æ ¹æ®å³è¾¹çš„è¡¨è¾¾å¼è‡ªåŠ¨æ¨æ–­ç±»å‹ï¼Œå¦‚ä¸Šé¢çš„ <code>String</code> ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">var javastack &#x3D; &quot;javastack&quot;;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>å°±ç­‰äºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">String javastack &#x3D; &quot;javastack&quot;;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>æ›´å¤šä½¿ç”¨è¯¦æƒ…è¯·å‚è€ƒè¿™ç¯‡æ–‡ç« ã€Š<a href=\"https://mp.weixin.qq.com/s/4zUtQPUn5LYw43IRLm0Dwg\">Java 10 å®æˆ˜ç¬¬ 1 ç¯‡ï¼šå±€éƒ¨å˜é‡ç±»å‹æ¨æ–­</a>ã€‹ï¼Œè¿™é‡Œä¸å†é‡å¤äº†ã€‚</p>\n<h4 id=\"2ã€å­—ç¬¦ä¸²åŠ å¼º\"><a href=\"#2ã€å­—ç¬¦ä¸²åŠ å¼º\" class=\"headerlink\" title=\"2ã€å­—ç¬¦ä¸²åŠ å¼º\"></a>2ã€å­—ç¬¦ä¸²åŠ å¼º</h4><p>Java 11 å¢åŠ äº†ä¸€ç³»åˆ—çš„å­—ç¬¦ä¸²å¤„ç†æ–¹æ³•ï¼Œå¦‚ä»¥ä¸‹æ‰€ç¤ºã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºç™½\n&quot; &quot;.isBlank();                &#x2F;&#x2F; true\n\n&#x2F;&#x2F; å»é™¤é¦–å°¾ç©ºæ ¼\n&quot; Javastack &quot;.strip();          &#x2F;&#x2F; &quot;Javastack&quot;\n\n&#x2F;&#x2F; å»é™¤å°¾éƒ¨ç©ºæ ¼ \n&quot; Javastack &quot;.stripTrailing();  &#x2F;&#x2F; &quot; Javastack&quot;\n\n&#x2F;&#x2F; å»é™¤é¦–éƒ¨ç©ºæ ¼ \n&quot; Javastack &quot;.stripLeading();   &#x2F;&#x2F; &quot;Javastack &quot;\n\n&#x2F;&#x2F; å¤åˆ¶å­—ç¬¦ä¸²\n&quot;Java&quot;.repeat(3);             &#x2F;&#x2F; &quot;JavaJavaJava&quot;\n\n&#x2F;&#x2F; è¡Œæ•°ç»Ÿè®¡\n&quot;A\\nB\\nC&quot;.lines().count();    &#x2F;&#x2F; 3<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"3ã€é›†åˆåŠ å¼º\"><a href=\"#3ã€é›†åˆåŠ å¼º\" class=\"headerlink\" title=\"3ã€é›†åˆåŠ å¼º\"></a>3ã€é›†åˆåŠ å¼º</h4><p>è‡ª Java 9 å¼€å§‹ï¼ŒJdk é‡Œé¢ä¸ºé›†åˆï¼ˆList&#x2F; Set&#x2F; Mapï¼‰éƒ½æ·»åŠ äº† <code>of</code> å’Œ <code>copyOf</code> æ–¹æ³•ï¼Œå®ƒä»¬ä¸¤ä¸ªéƒ½ç”¨æ¥åˆ›å»ºä¸å¯å˜çš„é›†åˆï¼Œæ¥çœ‹ä¸‹å®ƒä»¬çš„ä½¿ç”¨å’ŒåŒºåˆ«ã€‚</p>\n<p><strong>ç¤ºä¾‹1ï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">var list &#x3D; List.of(&quot;Java&quot;, &quot;Python&quot;, &quot;C&quot;);\nvar copy &#x3D; List.copyOf(list);\nSystem.out.println(list &#x3D;&#x3D; copy);   &#x2F;&#x2F; true<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>ç¤ºä¾‹2ï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">var list &#x3D; new ArrayList&lt;String&gt;();\nvar copy &#x3D; List.copyOf(list);\nSystem.out.println(list &#x3D;&#x3D; copy);   &#x2F;&#x2F; false<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¤ºä¾‹1å’Œ2ä»£ç å·®ä¸å¤šï¼Œä¸ºä»€ä¹ˆä¸€ä¸ªä¸ºtrue,ä¸€ä¸ªä¸ºfalse?</p>\n<p>æ¥çœ‹ä¸‹å®ƒä»¬çš„æºç ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">static &lt;E&gt; List&lt;E&gt; of(E... elements) &#123;\n    switch (elements.length) &#123; &#x2F;&#x2F; implicit null check of elements\n        case 0:\n            return ImmutableCollections.emptyList();\n        case 1:\n            return new ImmutableCollections.List12&lt;&gt;(elements[0]);\n        case 2:\n            return new ImmutableCollections.List12&lt;&gt;(elements[0], elements[1]);\n        default:\n            return new ImmutableCollections.ListN&lt;&gt;(elements);\n    &#125;\n&#125;\n\nstatic &lt;E&gt; List&lt;E&gt; copyOf(Collection&lt;? extends E&gt; coll) &#123;\n    return ImmutableCollections.listCopy(coll);\n&#125;\n\nstatic &lt;E&gt; List&lt;E&gt; listCopy(Collection&lt;? extends E&gt; coll) &#123;\n    if (coll instanceof AbstractImmutableList &amp;&amp; coll.getClass() !&#x3D; SubList.class) &#123;\n        return (List&lt;E&gt;)coll;\n    &#125; else &#123;\n        return (List&lt;E&gt;)List.of(coll.toArray());\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥çœ‹å‡º <code>copyOf</code> æ–¹æ³•ä¼šå…ˆåˆ¤æ–­æ¥æºé›†åˆæ˜¯ä¸æ˜¯ <code>AbstractImmutableList</code> ç±»å‹çš„ï¼Œå¦‚æœæ˜¯ï¼Œå°±ç›´æ¥è¿”å›ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™è°ƒç”¨ <code>of</code> åˆ›å»ºä¸€ä¸ªæ–°çš„é›†åˆã€‚</p>\n<p>ç¤ºä¾‹2å› ä¸ºç”¨çš„ new åˆ›å»ºçš„é›†åˆï¼Œä¸å±äºä¸å¯å˜ <code>AbstractImmutableList</code> ç±»çš„å­ç±»ï¼Œæ‰€ä»¥ <code>copyOf</code> æ–¹æ³•åˆåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œæ‰€ä»¥ä¸ºfalse.</p>\n<blockquote>\n<p>æ³¨æ„ï¼šä½¿ç”¨ of å’Œ copyOf åˆ›å»ºçš„é›†åˆä¸ºä¸å¯å˜é›†åˆï¼Œä¸èƒ½è¿›è¡Œæ·»åŠ ã€åˆ é™¤ã€æ›¿æ¢ã€æ’åºç­‰æ“ä½œï¼Œä¸ç„¶ä¼šæŠ¥ <code>java.lang.UnsupportedOperationException</code> å¼‚å¸¸ã€‚</p>\n</blockquote>\n<p>ä¸Šé¢æ¼”ç¤ºäº† List çš„ of å’Œ copyOf æ–¹æ³•ï¼ŒSet å’Œ Map æ¥å£éƒ½æœ‰ã€‚</p>\n<h4 id=\"4ã€Stream-åŠ å¼º\"><a href=\"#4ã€Stream-åŠ å¼º\" class=\"headerlink\" title=\"4ã€Stream åŠ å¼º\"></a>4ã€Stream åŠ å¼º</h4><p>Stream æ˜¯ Java 8 ä¸­çš„æ–°ç‰¹æ€§ï¼ŒJava 9 å¼€å§‹å¯¹ Stream å¢åŠ äº†ä»¥ä¸‹ 4 ä¸ªæ–°æ–¹æ³•ã€‚</p>\n<ol>\n<li>å¢åŠ å•ä¸ªå‚æ•°æ„é€ æ–¹æ³•ï¼Œå¯ä¸ºnull</li>\n</ol>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Stream.ofNullable(null).count(); &#x2F;&#x2F; 0<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ol start=\"2\">\n<li>å¢åŠ  takeWhile å’Œ dropWhile æ–¹æ³•</li>\n</ol>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Stream.of(1, 2, 3, 2, 1)\n    .takeWhile(n -&gt; n &lt; 3)\n    .collect(Collectors.toList());  &#x2F;&#x2F; [1, 2]<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ä»å¼€å§‹è®¡ç®—ï¼Œå½“ n &lt; 3 æ—¶å°±æˆªæ­¢ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Stream.of(1, 2, 3, 2, 1)\n    .dropWhile(n -&gt; n &lt; 3)\n    .collect(Collectors.toList());  &#x2F;&#x2F; [3, 2, 1]<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªå’Œä¸Šé¢çš„ç›¸åï¼Œä¸€æ—¦ n &lt; 3 ä¸æˆç«‹å°±å¼€å§‹è®¡ç®—ã€‚</p>\n<p>3ï¼‰iterateé‡è½½</p>\n<p>è¿™ä¸ª iterate æ–¹æ³•çš„æ–°é‡è½½æ–¹æ³•ï¼Œå¯ä»¥è®©ä½ æä¾›ä¸€ä¸ª Predicate (åˆ¤æ–­æ¡ä»¶)æ¥æŒ‡å®šä»€ä¹ˆæ—¶å€™ç»“æŸè¿­ä»£ã€‚</p>\n<p>å¦‚æœä½ å¯¹ JDK 8 ä¸­çš„ Stream è¿˜ä¸ç†Ÿæ‚‰ï¼Œå¯ä»¥çœ‹ä¹‹å‰åˆ†äº«çš„è¿™ä¸€ç³»åˆ—æ•™ç¨‹ã€‚</p>\n<h4 id=\"5ã€Optional-åŠ å¼º\"><a href=\"#5ã€Optional-åŠ å¼º\" class=\"headerlink\" title=\"5ã€Optional åŠ å¼º\"></a>5ã€Optional åŠ å¼º</h4><p>Opthonal ä¹Ÿå¢åŠ äº†å‡ ä¸ªéå¸¸é…·çš„æ–¹æ³•ï¼Œç°åœ¨å¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†ä¸€ä¸ª Optional è½¬æ¢æˆä¸€ä¸ª Stream, æˆ–è€…å½“ä¸€ä¸ªç©º Optional æ—¶ç»™å®ƒä¸€ä¸ªæ›¿ä»£çš„ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Optional.of(&quot;javastack&quot;).orElseThrow();     &#x2F;&#x2F; javastack\nOptional.of(&quot;javastack&quot;).stream().count();  &#x2F;&#x2F; 1\nOptional.ofNullable(null)\n    .or(() -&gt; Optional.of(&quot;javastack&quot;))\n    .get();   &#x2F;&#x2F; javastack<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"6ã€InputStream-åŠ å¼º\"><a href=\"#6ã€InputStream-åŠ å¼º\" class=\"headerlink\" title=\"6ã€InputStream åŠ å¼º\"></a>6ã€InputStream åŠ å¼º</h4><p>InputStream ç»ˆäºæœ‰äº†ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æ–¹æ³•ï¼štransferToï¼Œå¯ä»¥ç”¨æ¥å°†æ•°æ®ç›´æ¥ä¼ è¾“åˆ° OutputStreamï¼Œè¿™æ˜¯åœ¨å¤„ç†åŸå§‹æ•°æ®æµæ—¶éå¸¸å¸¸è§çš„ä¸€ç§ç”¨æ³•ï¼Œå¦‚ä¸‹ç¤ºä¾‹ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">var classLoader &#x3D; ClassLoader.getSystemClassLoader();\nvar inputStream &#x3D; classLoader.getResourceAsStream(&quot;javastack.txt&quot;);\nvar javastack &#x3D; File.createTempFile(&quot;javastack2&quot;, &quot;txt&quot;);\ntry (var outputStream &#x3D; new FileOutputStream(javastack)) &#123;\n    inputStream.transferTo(outputStream);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"7ã€HTTP-Client-API\"><a href=\"#7ã€HTTP-Client-API\" class=\"headerlink\" title=\"7ã€HTTP Client API\"></a>7ã€HTTP Client API</h4><p>è¿™æ˜¯ Java 9 å¼€å§‹å¼•å…¥çš„ä¸€ä¸ªå¤„ç† HTTP è¯·æ±‚çš„çš„å­µåŒ– HTTP Client  APIï¼Œè¯¥ API æ”¯æŒåŒæ­¥å’Œå¼‚æ­¥ï¼Œè€Œåœ¨ Java 11 ä¸­å·²ç»ä¸ºæ­£å¼å¯ç”¨çŠ¶æ€ï¼Œä½ å¯ä»¥åœ¨ <code>java.net</code> åŒ…ä¸­æ‰¾åˆ°è¿™ä¸ª APIã€‚</p>\n<p>æ¥çœ‹ä¸€ä¸‹ HTTP Client çš„ç”¨æ³•ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">var request &#x3D; HttpRequest.newBuilder()\n    .uri(URI.create(&quot;https:&#x2F;&#x2F;javastack.cn&quot;))\n    .GET()\n    .build();\nvar client &#x3D; HttpClient.newHttpClient();\n\n&#x2F;&#x2F; åŒæ­¥\nHttpResponse&lt;String&gt; response &#x3D; client.send(request, HttpResponse.BodyHandlers.ofString());\nSystem.out.println(response.body());\n\n&#x2F;&#x2F; å¼‚æ­¥\nclient.sendAsync(request, HttpResponse.BodyHandlers.ofString())\n    .thenApply(HttpResponse::body)\n    .thenAccept(System.out::println);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä¸Šé¢çš„ <code>.GET()</code> å¯ä»¥çœç•¥ï¼Œé»˜è®¤è¯·æ±‚æ–¹å¼ä¸º Getï¼</p>\n<p>æ›´å¤šä½¿ç”¨ç¤ºä¾‹å¯ä»¥çœ‹è¿™ä¸ª APIï¼Œåç»­æœ‰æœºä¼šå†åšæ¼”ç¤ºã€‚</p>\n<p>ç°åœ¨ Java è‡ªå¸¦äº†è¿™ä¸ª HTTP Client APIï¼Œæˆ‘ä»¬ä»¥åè¿˜æœ‰å¿…è¦ç”¨ Apache çš„ HttpClient å·¥å…·åŒ…å—ï¼Ÿ</p>\n<h4 id=\"8ã€åŒ–ç¹ä¸ºç®€ï¼Œä¸€ä¸ªå‘½ä»¤ç¼–è¯‘è¿è¡Œæºä»£ç \"><a href=\"#8ã€åŒ–ç¹ä¸ºç®€ï¼Œä¸€ä¸ªå‘½ä»¤ç¼–è¯‘è¿è¡Œæºä»£ç \" class=\"headerlink\" title=\"8ã€åŒ–ç¹ä¸ºç®€ï¼Œä¸€ä¸ªå‘½ä»¤ç¼–è¯‘è¿è¡Œæºä»£ç \"></a>8ã€åŒ–ç¹ä¸ºç®€ï¼Œä¸€ä¸ªå‘½ä»¤ç¼–è¯‘è¿è¡Œæºä»£ç </h4><p>çœ‹ä¸‹é¢çš„ä»£ç ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; ç¼–è¯‘\njavac Javastack.java\n\n&#x2F;&#x2F; è¿è¡Œ\njava Javastack<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>åœ¨æˆ‘ä»¬çš„è®¤çŸ¥é‡Œé¢ï¼Œè¦è¿è¡Œä¸€ä¸ª Java æºä»£ç å¿…é¡»å…ˆç¼–è¯‘ï¼Œå†è¿è¡Œï¼Œä¸¤æ­¥æ‰§è¡ŒåŠ¨ä½œã€‚è€Œåœ¨æœªæ¥çš„ Java 11 ç‰ˆæœ¬ä¸­ï¼Œé€šè¿‡ä¸€ä¸ª <code>java</code> å‘½ä»¤å°±ç›´æ¥æå®šäº†ï¼Œå¦‚ä»¥ä¸‹æ‰€ç¤ºã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">java Javastack.java<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"æ›´å¤šæ–°ç‰¹æ€§\"><a href=\"#æ›´å¤šæ–°ç‰¹æ€§\" class=\"headerlink\" title=\"æ›´å¤šæ–°ç‰¹æ€§\"></a>æ›´å¤šæ–°ç‰¹æ€§</h4><ul>\n<li>Flow API for reactive programming</li>\n<li>Java Module System</li>\n<li>Application Class Data Sharing</li>\n<li>Dynamic Class-File Constants</li>\n<li>Java REPL (JShell)</li>\n<li>Flight Recorder</li>\n<li>Unicode 10</li>\n<li>G1: Full Parallel Garbage Collector</li>\n<li>ZGC: Scalable Low-Latency Garbage Collector</li>\n<li>Epsilon: No-Op Garbage Collector</li>\n<li>Deprecate the Nashorn JavaScript Engine</li>\n<li>â€¦</li>\n</ul>\n<h4 id=\"å†å²æ–°ç‰¹æ€§æ–‡ç« \"><a href=\"#å†å²æ–°ç‰¹æ€§æ–‡ç« \" class=\"headerlink\" title=\"å†å²æ–°ç‰¹æ€§æ–‡ç« \"></a>å†å²æ–°ç‰¹æ€§æ–‡ç« </h4><ul>\n<li>Java 11 è¦æ¥äº†ï¼Œç¼–è¯‘è¿è¡Œä¸€ä¸ªå‘½ä»¤æå®š</li>\n<li>JDK 11 å‘å¸ƒè®¡åˆ’æ¥äº†ï¼Œå·²ç¡®å®š 3ä¸ª æ–°ç‰¹æ€§</li>\n<li>Java 10 å®æˆ˜ç¬¬ 1 ç¯‡ï¼šå±€éƒ¨å˜é‡ç±»å‹æ¨æ–­</li>\n<li>JDK 5 ~ 10 æ–°ç‰¹æ€§å€¾æƒ…æ•´ç†</li>\n<li>JDK 10 çš„ 10 ä¸ªæ–°ç‰¹æ€§</li>\n<li>JDK 10 æœ€é‡è¦çš„ 5 ä¸ªæ–°ç‰¹æ€§</li>\n<li>JDK 9 çš„ 9 ä¸ªæ–°ç‰¹æ€§</li>\n<li>JDK 9 æ–°ç‰¹æ€§å®æˆ˜ï¼šç®€åŒ–æµå…³é—­æ–°å§¿åŠ¿</li>\n<li>JDK 8 çš„æ’åºå¤§æ³•</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹ Lambda è¡¨è¾¾å¼</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹å‡½æ•°å¼æ¥å£</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹æ–¹æ³•å¼•ç”¨</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹æ¥å£é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹ Optional</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹é‡å¤æ³¨è§£</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµ</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸€ï¼‰åŸºç¡€ä½“éªŒ</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆäºŒï¼‰å…³é”®çŸ¥è¯†ç‚¹</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸‰ï¼‰ç¼©å‡æ“ä½œ</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆå››ï¼‰å¹¶è¡Œæµ</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆäº”ï¼‰æ˜ å°„</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆå…­ï¼‰æ”¶é›†ç¼©</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸ƒï¼‰æµä¸è¿­ä»£å™¨</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹æ‰©å±•ç¯‡</li>\n</ul>\n<h4 id=\"ç»“æŸè¯­\"><a href=\"#ç»“æŸè¯­\" class=\"headerlink\" title=\"ç»“æŸè¯­\"></a>ç»“æŸè¯­</h4><p>ç°åœ¨è®¸å¤šäººè¿˜åœ¨ä½¿ç”¨ Java 8 æˆ–è€… 7ï¼Œä¸è¿‡ 8 åœ¨ 2019 å¹´åˆå°±ä¼šç»“æŸå…è´¹æ›´æ–°ã€‚ç°åœ¨ 11 æ˜¯é•¿æœŸæ”¯æŒç‰ˆæœ¬ï¼Œæ­£æ˜¯å­¦ä¹ å’Œä¸Šæ‰‹ 11 çš„å¥½æ—¶æœºï¼Œå†™è¿™ç¯‡æ–‡ç« å¸Œæœ›èƒ½å¯¹ä½ æœ‰æ‰€å¯å‘ã€‚</p>\n<p>å¦‚æœä½ å–œæ¬¢çš„æˆ‘çš„æ–‡ç« ï¼Œå¯¹ä½ æœ‰å¸®åŠ©ï¼Œç‚¹èµè½¬å‘æ”¯æŒä¸€ä¸‹å§~</p>\n","excerpt":"","more":"<p>ç¾å›½æ—¶é—´ 09 æœˆ 25 æ—¥ï¼ŒOralce æ­£å¼å‘å¸ƒäº† Java 11ï¼Œè¿™æ˜¯æ® Java 8 ä»¥åæ”¯æŒçš„é¦–ä¸ªé•¿æœŸç‰ˆæœ¬ã€‚</p>\n<p>ä¸ºä»€ä¹ˆè¯´æ˜¯é•¿æœŸç‰ˆæœ¬ï¼Œçœ‹ä¸‹é¢çš„å®˜æ–¹å‘å¸ƒçš„æ”¯æŒè·¯çº¿å›¾è¡¨ã€‚</p>\n<p><img src=\"http://qianniu.javastack.cn/18-9-26/91229065.jpg\"></p>\n<p>å¯ä»¥çœ‹å‡º Java 8 æ‰©å±•æ”¯æŒåˆ° 2025 å¹´ï¼Œè€Œ Java 11 æ‰©å±•æ”¯æŒåˆ° 2026 å¹´ã€‚</p>\n<p>ç°åœ¨å¤§éƒ¨åˆ†éƒ½åœ¨ç”¨ Java 8ï¼ŒJava 9 å’Œ 10 ç›®å‰å¾ˆå°‘æœ‰äººåœ¨ç”¨ï¼Œè‡³å°‘æˆ‘æ²¡æœ‰å‘ç°æœ‰å…¬å¸åœ¨ç”Ÿäº§ç¯å¢ƒåº”ç”¨çš„ï¼Œé‚£å°±æ˜¯æ‰¾æ­»ã€‚</p>\n<p>ç°åœ¨ Java 11 é•¿æœŸæ”¯æŒï¼Œä¹Ÿå·²ç»åŒ…å«äº† 9 å’Œ 10 çš„å…¨éƒ¨åŠŸèƒ½ï¼Œ9 å’Œ 10 è‡ªç„¶å°±æ´»åˆ°å¤´äº†ã€‚ã€‚</p>\n<p>é‚£ä¹ˆæˆ‘ä»¬æ¥çœ‹ä¸‹ ä» Java 9 - 11 éƒ½æœ‰å“ªäº›é‡è¦çš„æ–°ç‰¹æ€§å‘¢ï¼Ÿ</p>\n<h4 id=\"1ã€æœ¬åœ°å˜é‡ç±»å‹æ¨æ–­\"><a href=\"#1ã€æœ¬åœ°å˜é‡ç±»å‹æ¨æ–­\" class=\"headerlink\" title=\"1ã€æœ¬åœ°å˜é‡ç±»å‹æ¨æ–­\"></a>1ã€æœ¬åœ°å˜é‡ç±»å‹æ¨æ–­</h4><p>è¿™ä¸ªåšä¸»å·²ç»å†™è¿‡ä¸€ç¯‡æ–‡ç« ï¼Œè¯¦ç»†çš„ä»‹ç»äº† Java 10 å¸¦æ¥çš„è¿™ä¸ªæ–°ç‰¹æ€§ã€‚</p>\n<p>ä»€ä¹ˆæ˜¯å±€éƒ¨å˜é‡ç±»å‹æ¨æ–­ï¼Ÿ</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">var javastack &#x3D; &quot;javastack&quot;;\nSystem.out.println(javastack);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>å¤§å®¶çœ‹å‡ºæ¥äº†ï¼Œå±€éƒ¨å˜é‡ç±»å‹æ¨æ–­å°±æ˜¯å·¦è¾¹çš„ç±»å‹ç›´æ¥ä½¿ç”¨ <code>var</code> å®šä¹‰ï¼Œè€Œä¸ç”¨å†™å…·ä½“çš„ç±»å‹ï¼Œç¼–è¯‘å™¨èƒ½æ ¹æ®å³è¾¹çš„è¡¨è¾¾å¼è‡ªåŠ¨æ¨æ–­ç±»å‹ï¼Œå¦‚ä¸Šé¢çš„ <code>String</code> ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">var javastack &#x3D; &quot;javastack&quot;;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>å°±ç­‰äºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">String javastack &#x3D; &quot;javastack&quot;;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>æ›´å¤šä½¿ç”¨è¯¦æƒ…è¯·å‚è€ƒè¿™ç¯‡æ–‡ç« ã€Š<a href=\"https://mp.weixin.qq.com/s/4zUtQPUn5LYw43IRLm0Dwg\">Java 10 å®æˆ˜ç¬¬ 1 ç¯‡ï¼šå±€éƒ¨å˜é‡ç±»å‹æ¨æ–­</a>ã€‹ï¼Œè¿™é‡Œä¸å†é‡å¤äº†ã€‚</p>\n<h4 id=\"2ã€å­—ç¬¦ä¸²åŠ å¼º\"><a href=\"#2ã€å­—ç¬¦ä¸²åŠ å¼º\" class=\"headerlink\" title=\"2ã€å­—ç¬¦ä¸²åŠ å¼º\"></a>2ã€å­—ç¬¦ä¸²åŠ å¼º</h4><p>Java 11 å¢åŠ äº†ä¸€ç³»åˆ—çš„å­—ç¬¦ä¸²å¤„ç†æ–¹æ³•ï¼Œå¦‚ä»¥ä¸‹æ‰€ç¤ºã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºç™½\n&quot; &quot;.isBlank();                &#x2F;&#x2F; true\n\n&#x2F;&#x2F; å»é™¤é¦–å°¾ç©ºæ ¼\n&quot; Javastack &quot;.strip();          &#x2F;&#x2F; &quot;Javastack&quot;\n\n&#x2F;&#x2F; å»é™¤å°¾éƒ¨ç©ºæ ¼ \n&quot; Javastack &quot;.stripTrailing();  &#x2F;&#x2F; &quot; Javastack&quot;\n\n&#x2F;&#x2F; å»é™¤é¦–éƒ¨ç©ºæ ¼ \n&quot; Javastack &quot;.stripLeading();   &#x2F;&#x2F; &quot;Javastack &quot;\n\n&#x2F;&#x2F; å¤åˆ¶å­—ç¬¦ä¸²\n&quot;Java&quot;.repeat(3);             &#x2F;&#x2F; &quot;JavaJavaJava&quot;\n\n&#x2F;&#x2F; è¡Œæ•°ç»Ÿè®¡\n&quot;A\\nB\\nC&quot;.lines().count();    &#x2F;&#x2F; 3<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"3ã€é›†åˆåŠ å¼º\"><a href=\"#3ã€é›†åˆåŠ å¼º\" class=\"headerlink\" title=\"3ã€é›†åˆåŠ å¼º\"></a>3ã€é›†åˆåŠ å¼º</h4><p>è‡ª Java 9 å¼€å§‹ï¼ŒJdk é‡Œé¢ä¸ºé›†åˆï¼ˆList&#x2F; Set&#x2F; Mapï¼‰éƒ½æ·»åŠ äº† <code>of</code> å’Œ <code>copyOf</code> æ–¹æ³•ï¼Œå®ƒä»¬ä¸¤ä¸ªéƒ½ç”¨æ¥åˆ›å»ºä¸å¯å˜çš„é›†åˆï¼Œæ¥çœ‹ä¸‹å®ƒä»¬çš„ä½¿ç”¨å’ŒåŒºåˆ«ã€‚</p>\n<p><strong>ç¤ºä¾‹1ï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">var list &#x3D; List.of(&quot;Java&quot;, &quot;Python&quot;, &quot;C&quot;);\nvar copy &#x3D; List.copyOf(list);\nSystem.out.println(list &#x3D;&#x3D; copy);   &#x2F;&#x2F; true<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>ç¤ºä¾‹2ï¼š</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">var list &#x3D; new ArrayList&lt;String&gt;();\nvar copy &#x3D; List.copyOf(list);\nSystem.out.println(list &#x3D;&#x3D; copy);   &#x2F;&#x2F; false<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¤ºä¾‹1å’Œ2ä»£ç å·®ä¸å¤šï¼Œä¸ºä»€ä¹ˆä¸€ä¸ªä¸ºtrue,ä¸€ä¸ªä¸ºfalse?</p>\n<p>æ¥çœ‹ä¸‹å®ƒä»¬çš„æºç ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">static &lt;E&gt; List&lt;E&gt; of(E... elements) &#123;\n    switch (elements.length) &#123; &#x2F;&#x2F; implicit null check of elements\n        case 0:\n            return ImmutableCollections.emptyList();\n        case 1:\n            return new ImmutableCollections.List12&lt;&gt;(elements[0]);\n        case 2:\n            return new ImmutableCollections.List12&lt;&gt;(elements[0], elements[1]);\n        default:\n            return new ImmutableCollections.ListN&lt;&gt;(elements);\n    &#125;\n&#125;\n\nstatic &lt;E&gt; List&lt;E&gt; copyOf(Collection&lt;? extends E&gt; coll) &#123;\n    return ImmutableCollections.listCopy(coll);\n&#125;\n\nstatic &lt;E&gt; List&lt;E&gt; listCopy(Collection&lt;? extends E&gt; coll) &#123;\n    if (coll instanceof AbstractImmutableList &amp;&amp; coll.getClass() !&#x3D; SubList.class) &#123;\n        return (List&lt;E&gt;)coll;\n    &#125; else &#123;\n        return (List&lt;E&gt;)List.of(coll.toArray());\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥çœ‹å‡º <code>copyOf</code> æ–¹æ³•ä¼šå…ˆåˆ¤æ–­æ¥æºé›†åˆæ˜¯ä¸æ˜¯ <code>AbstractImmutableList</code> ç±»å‹çš„ï¼Œå¦‚æœæ˜¯ï¼Œå°±ç›´æ¥è¿”å›ï¼Œå¦‚æœä¸æ˜¯ï¼Œåˆ™è°ƒç”¨ <code>of</code> åˆ›å»ºä¸€ä¸ªæ–°çš„é›†åˆã€‚</p>\n<p>ç¤ºä¾‹2å› ä¸ºç”¨çš„ new åˆ›å»ºçš„é›†åˆï¼Œä¸å±äºä¸å¯å˜ <code>AbstractImmutableList</code> ç±»çš„å­ç±»ï¼Œæ‰€ä»¥ <code>copyOf</code> æ–¹æ³•åˆåˆ›å»ºäº†ä¸€ä¸ªæ–°çš„å®ä¾‹ï¼Œæ‰€ä»¥ä¸ºfalse.</p>\n<blockquote>\n<p>æ³¨æ„ï¼šä½¿ç”¨ of å’Œ copyOf åˆ›å»ºçš„é›†åˆä¸ºä¸å¯å˜é›†åˆï¼Œä¸èƒ½è¿›è¡Œæ·»åŠ ã€åˆ é™¤ã€æ›¿æ¢ã€æ’åºç­‰æ“ä½œï¼Œä¸ç„¶ä¼šæŠ¥ <code>java.lang.UnsupportedOperationException</code> å¼‚å¸¸ã€‚</p>\n</blockquote>\n<p>ä¸Šé¢æ¼”ç¤ºäº† List çš„ of å’Œ copyOf æ–¹æ³•ï¼ŒSet å’Œ Map æ¥å£éƒ½æœ‰ã€‚</p>\n<h4 id=\"4ã€Stream-åŠ å¼º\"><a href=\"#4ã€Stream-åŠ å¼º\" class=\"headerlink\" title=\"4ã€Stream åŠ å¼º\"></a>4ã€Stream åŠ å¼º</h4><p>Stream æ˜¯ Java 8 ä¸­çš„æ–°ç‰¹æ€§ï¼ŒJava 9 å¼€å§‹å¯¹ Stream å¢åŠ äº†ä»¥ä¸‹ 4 ä¸ªæ–°æ–¹æ³•ã€‚</p>\n<ol>\n<li>å¢åŠ å•ä¸ªå‚æ•°æ„é€ æ–¹æ³•ï¼Œå¯ä¸ºnull</li>\n</ol>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Stream.ofNullable(null).count(); &#x2F;&#x2F; 0<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<ol start=\"2\">\n<li>å¢åŠ  takeWhile å’Œ dropWhile æ–¹æ³•</li>\n</ol>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Stream.of(1, 2, 3, 2, 1)\n    .takeWhile(n -&gt; n &lt; 3)\n    .collect(Collectors.toList());  &#x2F;&#x2F; [1, 2]<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ä»å¼€å§‹è®¡ç®—ï¼Œå½“ n &lt; 3 æ—¶å°±æˆªæ­¢ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Stream.of(1, 2, 3, 2, 1)\n    .dropWhile(n -&gt; n &lt; 3)\n    .collect(Collectors.toList());  &#x2F;&#x2F; [3, 2, 1]<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªå’Œä¸Šé¢çš„ç›¸åï¼Œä¸€æ—¦ n &lt; 3 ä¸æˆç«‹å°±å¼€å§‹è®¡ç®—ã€‚</p>\n<p>3ï¼‰iterateé‡è½½</p>\n<p>è¿™ä¸ª iterate æ–¹æ³•çš„æ–°é‡è½½æ–¹æ³•ï¼Œå¯ä»¥è®©ä½ æä¾›ä¸€ä¸ª Predicate (åˆ¤æ–­æ¡ä»¶)æ¥æŒ‡å®šä»€ä¹ˆæ—¶å€™ç»“æŸè¿­ä»£ã€‚</p>\n<p>å¦‚æœä½ å¯¹ JDK 8 ä¸­çš„ Stream è¿˜ä¸ç†Ÿæ‚‰ï¼Œå¯ä»¥çœ‹ä¹‹å‰åˆ†äº«çš„è¿™ä¸€ç³»åˆ—æ•™ç¨‹ã€‚</p>\n<h4 id=\"5ã€Optional-åŠ å¼º\"><a href=\"#5ã€Optional-åŠ å¼º\" class=\"headerlink\" title=\"5ã€Optional åŠ å¼º\"></a>5ã€Optional åŠ å¼º</h4><p>Opthonal ä¹Ÿå¢åŠ äº†å‡ ä¸ªéå¸¸é…·çš„æ–¹æ³•ï¼Œç°åœ¨å¯ä»¥å¾ˆæ–¹ä¾¿çš„å°†ä¸€ä¸ª Optional è½¬æ¢æˆä¸€ä¸ª Stream, æˆ–è€…å½“ä¸€ä¸ªç©º Optional æ—¶ç»™å®ƒä¸€ä¸ªæ›¿ä»£çš„ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Optional.of(&quot;javastack&quot;).orElseThrow();     &#x2F;&#x2F; javastack\nOptional.of(&quot;javastack&quot;).stream().count();  &#x2F;&#x2F; 1\nOptional.ofNullable(null)\n    .or(() -&gt; Optional.of(&quot;javastack&quot;))\n    .get();   &#x2F;&#x2F; javastack<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"6ã€InputStream-åŠ å¼º\"><a href=\"#6ã€InputStream-åŠ å¼º\" class=\"headerlink\" title=\"6ã€InputStream åŠ å¼º\"></a>6ã€InputStream åŠ å¼º</h4><p>InputStream ç»ˆäºæœ‰äº†ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æ–¹æ³•ï¼štransferToï¼Œå¯ä»¥ç”¨æ¥å°†æ•°æ®ç›´æ¥ä¼ è¾“åˆ° OutputStreamï¼Œè¿™æ˜¯åœ¨å¤„ç†åŸå§‹æ•°æ®æµæ—¶éå¸¸å¸¸è§çš„ä¸€ç§ç”¨æ³•ï¼Œå¦‚ä¸‹ç¤ºä¾‹ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">var classLoader &#x3D; ClassLoader.getSystemClassLoader();\nvar inputStream &#x3D; classLoader.getResourceAsStream(&quot;javastack.txt&quot;);\nvar javastack &#x3D; File.createTempFile(&quot;javastack2&quot;, &quot;txt&quot;);\ntry (var outputStream &#x3D; new FileOutputStream(javastack)) &#123;\n    inputStream.transferTo(outputStream);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"7ã€HTTP-Client-API\"><a href=\"#7ã€HTTP-Client-API\" class=\"headerlink\" title=\"7ã€HTTP Client API\"></a>7ã€HTTP Client API</h4><p>è¿™æ˜¯ Java 9 å¼€å§‹å¼•å…¥çš„ä¸€ä¸ªå¤„ç† HTTP è¯·æ±‚çš„çš„å­µåŒ– HTTP Client  APIï¼Œè¯¥ API æ”¯æŒåŒæ­¥å’Œå¼‚æ­¥ï¼Œè€Œåœ¨ Java 11 ä¸­å·²ç»ä¸ºæ­£å¼å¯ç”¨çŠ¶æ€ï¼Œä½ å¯ä»¥åœ¨ <code>java.net</code> åŒ…ä¸­æ‰¾åˆ°è¿™ä¸ª APIã€‚</p>\n<p>æ¥çœ‹ä¸€ä¸‹ HTTP Client çš„ç”¨æ³•ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">var request &#x3D; HttpRequest.newBuilder()\n    .uri(URI.create(&quot;https:&#x2F;&#x2F;javastack.cn&quot;))\n    .GET()\n    .build();\nvar client &#x3D; HttpClient.newHttpClient();\n\n&#x2F;&#x2F; åŒæ­¥\nHttpResponse&lt;String&gt; response &#x3D; client.send(request, HttpResponse.BodyHandlers.ofString());\nSystem.out.println(response.body());\n\n&#x2F;&#x2F; å¼‚æ­¥\nclient.sendAsync(request, HttpResponse.BodyHandlers.ofString())\n    .thenApply(HttpResponse::body)\n    .thenAccept(System.out::println);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä¸Šé¢çš„ <code>.GET()</code> å¯ä»¥çœç•¥ï¼Œé»˜è®¤è¯·æ±‚æ–¹å¼ä¸º Getï¼</p>\n<p>æ›´å¤šä½¿ç”¨ç¤ºä¾‹å¯ä»¥çœ‹è¿™ä¸ª APIï¼Œåç»­æœ‰æœºä¼šå†åšæ¼”ç¤ºã€‚</p>\n<p>ç°åœ¨ Java è‡ªå¸¦äº†è¿™ä¸ª HTTP Client APIï¼Œæˆ‘ä»¬ä»¥åè¿˜æœ‰å¿…è¦ç”¨ Apache çš„ HttpClient å·¥å…·åŒ…å—ï¼Ÿ</p>\n<h4 id=\"8ã€åŒ–ç¹ä¸ºç®€ï¼Œä¸€ä¸ªå‘½ä»¤ç¼–è¯‘è¿è¡Œæºä»£ç \"><a href=\"#8ã€åŒ–ç¹ä¸ºç®€ï¼Œä¸€ä¸ªå‘½ä»¤ç¼–è¯‘è¿è¡Œæºä»£ç \" class=\"headerlink\" title=\"8ã€åŒ–ç¹ä¸ºç®€ï¼Œä¸€ä¸ªå‘½ä»¤ç¼–è¯‘è¿è¡Œæºä»£ç \"></a>8ã€åŒ–ç¹ä¸ºç®€ï¼Œä¸€ä¸ªå‘½ä»¤ç¼–è¯‘è¿è¡Œæºä»£ç </h4><p>çœ‹ä¸‹é¢çš„ä»£ç ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; ç¼–è¯‘\njavac Javastack.java\n\n&#x2F;&#x2F; è¿è¡Œ\njava Javastack<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>åœ¨æˆ‘ä»¬çš„è®¤çŸ¥é‡Œé¢ï¼Œè¦è¿è¡Œä¸€ä¸ª Java æºä»£ç å¿…é¡»å…ˆç¼–è¯‘ï¼Œå†è¿è¡Œï¼Œä¸¤æ­¥æ‰§è¡ŒåŠ¨ä½œã€‚è€Œåœ¨æœªæ¥çš„ Java 11 ç‰ˆæœ¬ä¸­ï¼Œé€šè¿‡ä¸€ä¸ª <code>java</code> å‘½ä»¤å°±ç›´æ¥æå®šäº†ï¼Œå¦‚ä»¥ä¸‹æ‰€ç¤ºã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">java Javastack.java<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<h4 id=\"æ›´å¤šæ–°ç‰¹æ€§\"><a href=\"#æ›´å¤šæ–°ç‰¹æ€§\" class=\"headerlink\" title=\"æ›´å¤šæ–°ç‰¹æ€§\"></a>æ›´å¤šæ–°ç‰¹æ€§</h4><ul>\n<li>Flow API for reactive programming</li>\n<li>Java Module System</li>\n<li>Application Class Data Sharing</li>\n<li>Dynamic Class-File Constants</li>\n<li>Java REPL (JShell)</li>\n<li>Flight Recorder</li>\n<li>Unicode 10</li>\n<li>G1: Full Parallel Garbage Collector</li>\n<li>ZGC: Scalable Low-Latency Garbage Collector</li>\n<li>Epsilon: No-Op Garbage Collector</li>\n<li>Deprecate the Nashorn JavaScript Engine</li>\n<li>â€¦</li>\n</ul>\n<h4 id=\"å†å²æ–°ç‰¹æ€§æ–‡ç« \"><a href=\"#å†å²æ–°ç‰¹æ€§æ–‡ç« \" class=\"headerlink\" title=\"å†å²æ–°ç‰¹æ€§æ–‡ç« \"></a>å†å²æ–°ç‰¹æ€§æ–‡ç« </h4><ul>\n<li>Java 11 è¦æ¥äº†ï¼Œç¼–è¯‘è¿è¡Œä¸€ä¸ªå‘½ä»¤æå®š</li>\n<li>JDK 11 å‘å¸ƒè®¡åˆ’æ¥äº†ï¼Œå·²ç¡®å®š 3ä¸ª æ–°ç‰¹æ€§</li>\n<li>Java 10 å®æˆ˜ç¬¬ 1 ç¯‡ï¼šå±€éƒ¨å˜é‡ç±»å‹æ¨æ–­</li>\n<li>JDK 5 ~ 10 æ–°ç‰¹æ€§å€¾æƒ…æ•´ç†</li>\n<li>JDK 10 çš„ 10 ä¸ªæ–°ç‰¹æ€§</li>\n<li>JDK 10 æœ€é‡è¦çš„ 5 ä¸ªæ–°ç‰¹æ€§</li>\n<li>JDK 9 çš„ 9 ä¸ªæ–°ç‰¹æ€§</li>\n<li>JDK 9 æ–°ç‰¹æ€§å®æˆ˜ï¼šç®€åŒ–æµå…³é—­æ–°å§¿åŠ¿</li>\n<li>JDK 8 çš„æ’åºå¤§æ³•</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹ Lambda è¡¨è¾¾å¼</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹å‡½æ•°å¼æ¥å£</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹æ–¹æ³•å¼•ç”¨</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹æ¥å£é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹ Optional</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹é‡å¤æ³¨è§£</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµ</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸€ï¼‰åŸºç¡€ä½“éªŒ</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆäºŒï¼‰å…³é”®çŸ¥è¯†ç‚¹</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸‰ï¼‰ç¼©å‡æ“ä½œ</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆå››ï¼‰å¹¶è¡Œæµ</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆäº”ï¼‰æ˜ å°„</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆå…­ï¼‰æ”¶é›†ç¼©</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸ƒï¼‰æµä¸è¿­ä»£å™¨</li>\n<li>JDK 8 æ–°ç‰¹æ€§ä¹‹æ‰©å±•ç¯‡</li>\n</ul>\n<h4 id=\"ç»“æŸè¯­\"><a href=\"#ç»“æŸè¯­\" class=\"headerlink\" title=\"ç»“æŸè¯­\"></a>ç»“æŸè¯­</h4><p>ç°åœ¨è®¸å¤šäººè¿˜åœ¨ä½¿ç”¨ Java 8 æˆ–è€… 7ï¼Œä¸è¿‡ 8 åœ¨ 2019 å¹´åˆå°±ä¼šç»“æŸå…è´¹æ›´æ–°ã€‚ç°åœ¨ 11 æ˜¯é•¿æœŸæ”¯æŒç‰ˆæœ¬ï¼Œæ­£æ˜¯å­¦ä¹ å’Œä¸Šæ‰‹ 11 çš„å¥½æ—¶æœºï¼Œå†™è¿™ç¯‡æ–‡ç« å¸Œæœ›èƒ½å¯¹ä½ æœ‰æ‰€å¯å‘ã€‚</p>\n<p>å¦‚æœä½ å–œæ¬¢çš„æˆ‘çš„æ–‡ç« ï¼Œå¯¹ä½ æœ‰å¸®åŠ©ï¼Œç‚¹èµè½¬å‘æ”¯æŒä¸€ä¸‹å§~</p>\n"},{"title":"Java8 ä¹‹æ–°ç‰¹æ€§æ‰©å±•ç¯‡","date":"2025-10-15T03:36:33.000Z","_content":"\nä¹‹å‰åˆ†ç¯‡ç« è®²äº†ä¸€äº›JKD8ä¸­æ·»åŠ çš„æ–°ç‰¹æ€§ï¼Œè¿˜æœ‰ä¸€äº›æ–°ç‰¹æ€§è¿™é‡Œä¹Ÿä¸€å¹¶è®²ä¸‹ã€‚\n\n## BASE64\n\nbase64ç¼–ç è§£ç å·²ç»è¢«åŠ å…¥åˆ°äº†jdk8ä¸­äº†ã€‚\n\n```\nimport java.nio.charset.StandardCharsets;\nimport java.util.Base64;\n\npublic class Base64Test {\n\tpublic static void main(String[] args) {\n\t\tString text = \"hello javastack\";\n\n\t\tString encoded = Base64.getEncoder().encodeToString(text.getBytes(StandardCharsets.UTF_8));\n\t\tSystem.out.println(encoded);\n\n\t\tString decoded = new String(Base64.getDecoder().decode(encoded), StandardCharsets.UTF_8);\n\t\tSystem.out.println(decoded);\n\t}\n}\n```\n\n## Date/Time API(JSR 310)\n\næ–°çš„æ—¶é—´ã€æ—¥æœŸã€‚\n\n\n```\nClock clock = Clock.systemUTC();\nSystem.out.println(clock.instant());\nSystem.out.println(clock.millis());\n```\n\n\nè¾“å‡ºï¼š\n\n```\n2017-09-06T07:26:18.541Z\n1504682778593\n```\n\nå¯ä»¥ä»£æ›¿`System.currentTimeMillis()`æ–¹æ³•ã€‚\n\nå¦å¤–ï¼Œå¯ä»¥çœ‹ä¸‹LocalDateã€LocalTimeã€LocalDateTimeã€Durationçš„ç”¨æ³•ã€‚\n\n## Nashorn JavaScriptå¼•æ“\n\nå¯ä»¥è¿è¡Œjsä»£ç çš„å¼•æ“ã€‚\n\n\n```\nScriptEngineManager manager = new ScriptEngineManager();\nScriptEngine engine = manager.getEngineByName(\"JavaScript\");\n\nSystem.out.println(engine.getClass().getName());\nSystem.out.println(\"Result:\" + engine.eval(\"function f() { return 10; }; f() * 24;\"));\n```\nè¾“å‡ºï¼š\n\n```\njdk.nashorn.api.scripting.NashornScriptEngine\nResult:240.0\n```\n\n## JVMå†…å­˜å–æ¶ˆæ°¸ä¹…ä»£\n\nJDK8ä½¿ç”¨äº†Metaspaceï¼ˆJEP 122ï¼‰æ›¿æ¢æ°¸ä¹…ä»£ï¼ˆPermGen spaceï¼‰ã€‚å‚æ•°ä½¿ç”¨-XX:MetaSpaceSizeå’Œ-XX:MaxMetaspaceSizeä»£æ›¿åŸæ¥çš„-XX:PermSizeå’Œ-XX:MaxPermSizeã€‚\n\nè¿˜æœ‰ä¸€äº›åˆ«çš„æ–°ç‰¹æ€§ï¼Œä¸ªäººè§‰å¾—æŸäº›æ–°ç‰¹æ€§ç”¨å¤„ä¸æ˜¯å¾ˆå¤§ã€‚\n","source":"_posts/æ–°ç‰¹æ€§/Java8/Java8 ä¹‹æ–°ç‰¹æ€§æ‰©å±•ç¯‡.md","raw":"---\ntitle: Java8 ä¹‹æ–°ç‰¹æ€§æ‰©å±•ç¯‡\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: æ–°ç‰¹æ€§\n---\n\nä¹‹å‰åˆ†ç¯‡ç« è®²äº†ä¸€äº›JKD8ä¸­æ·»åŠ çš„æ–°ç‰¹æ€§ï¼Œè¿˜æœ‰ä¸€äº›æ–°ç‰¹æ€§è¿™é‡Œä¹Ÿä¸€å¹¶è®²ä¸‹ã€‚\n\n## BASE64\n\nbase64ç¼–ç è§£ç å·²ç»è¢«åŠ å…¥åˆ°äº†jdk8ä¸­äº†ã€‚\n\n```\nimport java.nio.charset.StandardCharsets;\nimport java.util.Base64;\n\npublic class Base64Test {\n\tpublic static void main(String[] args) {\n\t\tString text = \"hello javastack\";\n\n\t\tString encoded = Base64.getEncoder().encodeToString(text.getBytes(StandardCharsets.UTF_8));\n\t\tSystem.out.println(encoded);\n\n\t\tString decoded = new String(Base64.getDecoder().decode(encoded), StandardCharsets.UTF_8);\n\t\tSystem.out.println(decoded);\n\t}\n}\n```\n\n## Date/Time API(JSR 310)\n\næ–°çš„æ—¶é—´ã€æ—¥æœŸã€‚\n\n\n```\nClock clock = Clock.systemUTC();\nSystem.out.println(clock.instant());\nSystem.out.println(clock.millis());\n```\n\n\nè¾“å‡ºï¼š\n\n```\n2017-09-06T07:26:18.541Z\n1504682778593\n```\n\nå¯ä»¥ä»£æ›¿`System.currentTimeMillis()`æ–¹æ³•ã€‚\n\nå¦å¤–ï¼Œå¯ä»¥çœ‹ä¸‹LocalDateã€LocalTimeã€LocalDateTimeã€Durationçš„ç”¨æ³•ã€‚\n\n## Nashorn JavaScriptå¼•æ“\n\nå¯ä»¥è¿è¡Œjsä»£ç çš„å¼•æ“ã€‚\n\n\n```\nScriptEngineManager manager = new ScriptEngineManager();\nScriptEngine engine = manager.getEngineByName(\"JavaScript\");\n\nSystem.out.println(engine.getClass().getName());\nSystem.out.println(\"Result:\" + engine.eval(\"function f() { return 10; }; f() * 24;\"));\n```\nè¾“å‡ºï¼š\n\n```\njdk.nashorn.api.scripting.NashornScriptEngine\nResult:240.0\n```\n\n## JVMå†…å­˜å–æ¶ˆæ°¸ä¹…ä»£\n\nJDK8ä½¿ç”¨äº†Metaspaceï¼ˆJEP 122ï¼‰æ›¿æ¢æ°¸ä¹…ä»£ï¼ˆPermGen spaceï¼‰ã€‚å‚æ•°ä½¿ç”¨-XX:MetaSpaceSizeå’Œ-XX:MaxMetaspaceSizeä»£æ›¿åŸæ¥çš„-XX:PermSizeå’Œ-XX:MaxPermSizeã€‚\n\nè¿˜æœ‰ä¸€äº›åˆ«çš„æ–°ç‰¹æ€§ï¼Œä¸ªäººè§‰å¾—æŸäº›æ–°ç‰¹æ€§ç”¨å¤„ä¸æ˜¯å¾ˆå¤§ã€‚\n","slug":"æ–°ç‰¹æ€§/Java8/Java8 ä¹‹æ–°ç‰¹æ€§æ‰©å±•ç¯‡","published":1,"updated":"2025-10-15T07:20:51.461Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu0774005fqkd4eze9657b","content":"<p>ä¹‹å‰åˆ†ç¯‡ç« è®²äº†ä¸€äº›JKD8ä¸­æ·»åŠ çš„æ–°ç‰¹æ€§ï¼Œè¿˜æœ‰ä¸€äº›æ–°ç‰¹æ€§è¿™é‡Œä¹Ÿä¸€å¹¶è®²ä¸‹ã€‚</p>\n<h2 id=\"BASE64\"><a href=\"#BASE64\" class=\"headerlink\" title=\"BASE64\"></a>BASE64</h2><p>base64ç¼–ç è§£ç å·²ç»è¢«åŠ å…¥åˆ°äº†jdk8ä¸­äº†ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">import java.nio.charset.StandardCharsets;\nimport java.util.Base64;\n\npublic class Base64Test &#123;\n\tpublic static void main(String[] args) &#123;\n\t\tString text &#x3D; &quot;hello javastack&quot;;\n\n\t\tString encoded &#x3D; Base64.getEncoder().encodeToString(text.getBytes(StandardCharsets.UTF_8));\n\t\tSystem.out.println(encoded);\n\n\t\tString decoded &#x3D; new String(Base64.getDecoder().decode(encoded), StandardCharsets.UTF_8);\n\t\tSystem.out.println(decoded);\n\t&#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"Date-Time-API-JSR-310\"><a href=\"#Date-Time-API-JSR-310\" class=\"headerlink\" title=\"Date&#x2F;Time API(JSR 310)\"></a>Date&#x2F;Time API(JSR 310)</h2><p>æ–°çš„æ—¶é—´ã€æ—¥æœŸã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Clock clock &#x3D; Clock.systemUTC();\nSystem.out.println(clock.instant());\nSystem.out.println(clock.millis());<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n\n<p>è¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">2017-09-06T07:26:18.541Z\n1504682778593<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥ä»£æ›¿<code>System.currentTimeMillis()</code>æ–¹æ³•ã€‚</p>\n<p>å¦å¤–ï¼Œå¯ä»¥çœ‹ä¸‹LocalDateã€LocalTimeã€LocalDateTimeã€Durationçš„ç”¨æ³•ã€‚</p>\n<h2 id=\"Nashorn-JavaScriptå¼•æ“\"><a href=\"#Nashorn-JavaScriptå¼•æ“\" class=\"headerlink\" title=\"Nashorn JavaScriptå¼•æ“\"></a>Nashorn JavaScriptå¼•æ“</h2><p>å¯ä»¥è¿è¡Œjsä»£ç çš„å¼•æ“ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">ScriptEngineManager manager &#x3D; new ScriptEngineManager();\nScriptEngine engine &#x3D; manager.getEngineByName(&quot;JavaScript&quot;);\n\nSystem.out.println(engine.getClass().getName());\nSystem.out.println(&quot;Result:&quot; + engine.eval(&quot;function f() &#123; return 10; &#125;; f() * 24;&quot;));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>è¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">jdk.nashorn.api.scripting.NashornScriptEngine\nResult:240.0<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h2 id=\"JVMå†…å­˜å–æ¶ˆæ°¸ä¹…ä»£\"><a href=\"#JVMå†…å­˜å–æ¶ˆæ°¸ä¹…ä»£\" class=\"headerlink\" title=\"JVMå†…å­˜å–æ¶ˆæ°¸ä¹…ä»£\"></a>JVMå†…å­˜å–æ¶ˆæ°¸ä¹…ä»£</h2><p>JDK8ä½¿ç”¨äº†Metaspaceï¼ˆJEP 122ï¼‰æ›¿æ¢æ°¸ä¹…ä»£ï¼ˆPermGen spaceï¼‰ã€‚å‚æ•°ä½¿ç”¨-XX:MetaSpaceSizeå’Œ-XX:MaxMetaspaceSizeä»£æ›¿åŸæ¥çš„-XX:PermSizeå’Œ-XX:MaxPermSizeã€‚</p>\n<p>è¿˜æœ‰ä¸€äº›åˆ«çš„æ–°ç‰¹æ€§ï¼Œä¸ªäººè§‰å¾—æŸäº›æ–°ç‰¹æ€§ç”¨å¤„ä¸æ˜¯å¾ˆå¤§ã€‚</p>\n","excerpt":"","more":"<p>ä¹‹å‰åˆ†ç¯‡ç« è®²äº†ä¸€äº›JKD8ä¸­æ·»åŠ çš„æ–°ç‰¹æ€§ï¼Œè¿˜æœ‰ä¸€äº›æ–°ç‰¹æ€§è¿™é‡Œä¹Ÿä¸€å¹¶è®²ä¸‹ã€‚</p>\n<h2 id=\"BASE64\"><a href=\"#BASE64\" class=\"headerlink\" title=\"BASE64\"></a>BASE64</h2><p>base64ç¼–ç è§£ç å·²ç»è¢«åŠ å…¥åˆ°äº†jdk8ä¸­äº†ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">import java.nio.charset.StandardCharsets;\nimport java.util.Base64;\n\npublic class Base64Test &#123;\n\tpublic static void main(String[] args) &#123;\n\t\tString text &#x3D; &quot;hello javastack&quot;;\n\n\t\tString encoded &#x3D; Base64.getEncoder().encodeToString(text.getBytes(StandardCharsets.UTF_8));\n\t\tSystem.out.println(encoded);\n\n\t\tString decoded &#x3D; new String(Base64.getDecoder().decode(encoded), StandardCharsets.UTF_8);\n\t\tSystem.out.println(decoded);\n\t&#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"Date-Time-API-JSR-310\"><a href=\"#Date-Time-API-JSR-310\" class=\"headerlink\" title=\"Date&#x2F;Time API(JSR 310)\"></a>Date&#x2F;Time API(JSR 310)</h2><p>æ–°çš„æ—¶é—´ã€æ—¥æœŸã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Clock clock &#x3D; Clock.systemUTC();\nSystem.out.println(clock.instant());\nSystem.out.println(clock.millis());<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n\n<p>è¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">2017-09-06T07:26:18.541Z\n1504682778593<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥ä»£æ›¿<code>System.currentTimeMillis()</code>æ–¹æ³•ã€‚</p>\n<p>å¦å¤–ï¼Œå¯ä»¥çœ‹ä¸‹LocalDateã€LocalTimeã€LocalDateTimeã€Durationçš„ç”¨æ³•ã€‚</p>\n<h2 id=\"Nashorn-JavaScriptå¼•æ“\"><a href=\"#Nashorn-JavaScriptå¼•æ“\" class=\"headerlink\" title=\"Nashorn JavaScriptå¼•æ“\"></a>Nashorn JavaScriptå¼•æ“</h2><p>å¯ä»¥è¿è¡Œjsä»£ç çš„å¼•æ“ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">ScriptEngineManager manager &#x3D; new ScriptEngineManager();\nScriptEngine engine &#x3D; manager.getEngineByName(&quot;JavaScript&quot;);\n\nSystem.out.println(engine.getClass().getName());\nSystem.out.println(&quot;Result:&quot; + engine.eval(&quot;function f() &#123; return 10; &#125;; f() * 24;&quot;));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>è¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">jdk.nashorn.api.scripting.NashornScriptEngine\nResult:240.0<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<h2 id=\"JVMå†…å­˜å–æ¶ˆæ°¸ä¹…ä»£\"><a href=\"#JVMå†…å­˜å–æ¶ˆæ°¸ä¹…ä»£\" class=\"headerlink\" title=\"JVMå†…å­˜å–æ¶ˆæ°¸ä¹…ä»£\"></a>JVMå†…å­˜å–æ¶ˆæ°¸ä¹…ä»£</h2><p>JDK8ä½¿ç”¨äº†Metaspaceï¼ˆJEP 122ï¼‰æ›¿æ¢æ°¸ä¹…ä»£ï¼ˆPermGen spaceï¼‰ã€‚å‚æ•°ä½¿ç”¨-XX:MetaSpaceSizeå’Œ-XX:MaxMetaspaceSizeä»£æ›¿åŸæ¥çš„-XX:PermSizeå’Œ-XX:MaxPermSizeã€‚</p>\n<p>è¿˜æœ‰ä¸€äº›åˆ«çš„æ–°ç‰¹æ€§ï¼Œä¸ªäººè§‰å¾—æŸäº›æ–°ç‰¹æ€§ç”¨å¤„ä¸æ˜¯å¾ˆå¤§ã€‚</p>\n"},{"title":"Java 11 å·²å‘å¸ƒï¼ŒString è¿˜èƒ½è¿™æ ·ç©","date":"2025-10-15T03:36:33.000Z","_content":"\nåœ¨æ–‡ç« ã€Š[Java 11 æ­£å¼å‘å¸ƒï¼Œè¿™ 8 ä¸ªé€†å¤©æ–°ç‰¹æ€§æ•™ä½ å†™å‡ºæ›´ç‰›é€¼çš„ä»£ç ](https://mp.weixin.qq.com/s/SXEqAmfbmK4NklihukbE-Q)ã€‹ä¸­ï¼Œæˆ‘æœ‰ä»‹ç»åˆ° Java 11 çš„å…«ä¸ªæ–°ç‰¹æ€§ï¼Œå…¶ä¸­å…³äº String åŠ å¼ºéƒ¨åˆ†ï¼Œæˆ‘è§‰å¾—æœ‰ç‚¹æ„æ€ï¼Œè¿™é‡Œå•ç‹¬å†æ‹‰å‡ºæ¥è®²ã€‚\n\n**Java 11 å¢åŠ äº†ä¸€ç³»åˆ—çš„å­—ç¬¦ä¸²å¤„ç†æ–¹æ³•ï¼Œå¦‚ä»¥ä¸‹æ‰€ç¤ºã€‚**\n\n```\n// åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºç™½\n\" \".isBlank();                // true\n\n// å»é™¤é¦–å°¾ç©ºæ ¼\n\" Javastack \".strip();          // \"Javastack\"\n\n// å»é™¤å°¾éƒ¨ç©ºæ ¼ \n\" Javastack \".stripTrailing();  // \" Javastack\"\n\n// å»é™¤é¦–éƒ¨ç©ºæ ¼ \n\" Javastack \".stripLeading();   // \"Javastack \"\n\n// å¤åˆ¶å­—ç¬¦ä¸²\n\"Java\".repeat(3);             // \"JavaJavaJava\"\n\n// è¡Œæ•°ç»Ÿè®¡\n\"A\\nB\\nC\".lines().count();    // 3\n```\n\næœ€æœ‰æ„æ€çš„æ˜¯ `repeat` å’Œ `lines` æ–¹æ³•äº†ï¼Œæ¥çœ‹ä¸‹è¿˜èƒ½æ€ä¹ˆç©ï¼\n\n#### repeat\n\nrepeat æ–¹æ³•çš„ä½œç”¨å°±æ˜¯é‡å¤ä¸€ä¸ªå­—ç¬¦ä¸² N éï¼Œå¯ä»¥ç”¨æ¥ä»£æ›¿å·¥å…·ç±»ï¼š`org.apache.commons.lang3.StringUtils#repeat(java.lang.String, int)`ï¼Œæ¥çœ‹ä¸‹ `repeat` çš„æºç ã€‚\n\n```\npublic String repeat(int count) {\n    if (count < 0) {\n        throw new IllegalArgumentException(\"count is negative: \" + count);\n    }\n    if (count == 1) {\n        return this;\n    }\n    final int len = value.length;\n    if (len == 0 || count == 0) {\n        return \"\";\n    }\n    if (len == 1) {\n        final byte[] single = new byte[count];\n        Arrays.fill(single, value[0]);\n        return new String(single, coder);\n    }\n    if (Integer.MAX_VALUE / count < len) {\n        throw new OutOfMemoryError(\"Repeating \" + len + \" bytes String \" + count +\n                \" times will produce a String exceeding maximum size.\");\n    }\n    final int limit = len * count;\n    final byte[] multiple = new byte[limit];\n    System.arraycopy(value, 0, multiple, 0, len);\n    int copied = len;\n    for (; copied < limit - copied; copied <<= 1) {\n        System.arraycopy(multiple, 0, multiple, copied, copied);\n    }\n    System.arraycopy(multiple, 0, multiple, copied, limit - copied);\n    return new String(multiple, coder);\n}\n```\n\næ¥çœ‹ä¸‹æ›´å¤šçš„ç”¨æ³•ã€‚\n\n```\nString str = \"Java\";\n\n// å°äº0ï¼šjava.lang.IllegalArgumentException\nSystem.out.println(str.repeat(-2));\n\n// ç­‰äº0ï¼šç©ºç™½ä¸²ï¼ˆ\"\"ï¼‰\nSystem.out.println(str.repeat(0));\n\n// JavaJavaJava\nSystem.out.println(str.repeat(3));\n\n// java.lang.OutOfMemoryError\nSystem.out.println(str.repeat(Integer.MAX_VALUE));\n```\n\næ‰€ä»¥è¯´ repeat å¹¶ä¸æ˜¯å¯ä»¥æ— é™å¢é•¿çš„ï¼Œæœ‰ä½¿ç”¨é™åˆ¶çš„ï¼Œè¾¾åˆ°ä¸€å®šé‡å°±ä¼šæŠ¥å†…å­˜æº¢å‡ºå¼‚å¸¸ã€‚\n\n#### lines\n\n```\npublic Stream<String> lines() {\n    return isLatin1() ? StringLatin1.lines(value)\n                      : StringUTF16.lines(value);\n}\n```\nlines æ–¹æ³•è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸² Stream, å¯ä»¥è¯†åˆ« `\\n` å’Œ `\\r` æ¢è¡Œç¬¦æ¢è¡Œã€‚\n\n```\n// 4\nSystem.out.println(\"A\\nB\\nC\\rD\".lines().count());\n```\n\næ˜¯ä¸æ˜¯å¾ˆå¥½ï¼Ÿåœ¨å°†æ¥è‚¯å®šæœ‰æ­¦ä¹‹åœ°ï¼å¦‚æ‰¹é‡è¯»å–æ–‡ä»¶å†…å®¹åˆ°ä¸€ä¸ª Stream ä¸­ï¼Œå°±èƒ½å¾ˆå¥½çš„è¯†åˆ«è¡Œç»“æŸç¬¦äº†ã€‚\n\n\n\n","source":"_posts/æ–°ç‰¹æ€§/Java11/Java 11 å·²å‘å¸ƒï¼ŒString è¿˜èƒ½è¿™æ ·ç©.md","raw":"---\ntitle: Java 11 å·²å‘å¸ƒï¼ŒString è¿˜èƒ½è¿™æ ·ç©\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: æ–°ç‰¹æ€§\n---\n\nåœ¨æ–‡ç« ã€Š[Java 11 æ­£å¼å‘å¸ƒï¼Œè¿™ 8 ä¸ªé€†å¤©æ–°ç‰¹æ€§æ•™ä½ å†™å‡ºæ›´ç‰›é€¼çš„ä»£ç ](https://mp.weixin.qq.com/s/SXEqAmfbmK4NklihukbE-Q)ã€‹ä¸­ï¼Œæˆ‘æœ‰ä»‹ç»åˆ° Java 11 çš„å…«ä¸ªæ–°ç‰¹æ€§ï¼Œå…¶ä¸­å…³äº String åŠ å¼ºéƒ¨åˆ†ï¼Œæˆ‘è§‰å¾—æœ‰ç‚¹æ„æ€ï¼Œè¿™é‡Œå•ç‹¬å†æ‹‰å‡ºæ¥è®²ã€‚\n\n**Java 11 å¢åŠ äº†ä¸€ç³»åˆ—çš„å­—ç¬¦ä¸²å¤„ç†æ–¹æ³•ï¼Œå¦‚ä»¥ä¸‹æ‰€ç¤ºã€‚**\n\n```\n// åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºç™½\n\" \".isBlank();                // true\n\n// å»é™¤é¦–å°¾ç©ºæ ¼\n\" Javastack \".strip();          // \"Javastack\"\n\n// å»é™¤å°¾éƒ¨ç©ºæ ¼ \n\" Javastack \".stripTrailing();  // \" Javastack\"\n\n// å»é™¤é¦–éƒ¨ç©ºæ ¼ \n\" Javastack \".stripLeading();   // \"Javastack \"\n\n// å¤åˆ¶å­—ç¬¦ä¸²\n\"Java\".repeat(3);             // \"JavaJavaJava\"\n\n// è¡Œæ•°ç»Ÿè®¡\n\"A\\nB\\nC\".lines().count();    // 3\n```\n\næœ€æœ‰æ„æ€çš„æ˜¯ `repeat` å’Œ `lines` æ–¹æ³•äº†ï¼Œæ¥çœ‹ä¸‹è¿˜èƒ½æ€ä¹ˆç©ï¼\n\n#### repeat\n\nrepeat æ–¹æ³•çš„ä½œç”¨å°±æ˜¯é‡å¤ä¸€ä¸ªå­—ç¬¦ä¸² N éï¼Œå¯ä»¥ç”¨æ¥ä»£æ›¿å·¥å…·ç±»ï¼š`org.apache.commons.lang3.StringUtils#repeat(java.lang.String, int)`ï¼Œæ¥çœ‹ä¸‹ `repeat` çš„æºç ã€‚\n\n```\npublic String repeat(int count) {\n    if (count < 0) {\n        throw new IllegalArgumentException(\"count is negative: \" + count);\n    }\n    if (count == 1) {\n        return this;\n    }\n    final int len = value.length;\n    if (len == 0 || count == 0) {\n        return \"\";\n    }\n    if (len == 1) {\n        final byte[] single = new byte[count];\n        Arrays.fill(single, value[0]);\n        return new String(single, coder);\n    }\n    if (Integer.MAX_VALUE / count < len) {\n        throw new OutOfMemoryError(\"Repeating \" + len + \" bytes String \" + count +\n                \" times will produce a String exceeding maximum size.\");\n    }\n    final int limit = len * count;\n    final byte[] multiple = new byte[limit];\n    System.arraycopy(value, 0, multiple, 0, len);\n    int copied = len;\n    for (; copied < limit - copied; copied <<= 1) {\n        System.arraycopy(multiple, 0, multiple, copied, copied);\n    }\n    System.arraycopy(multiple, 0, multiple, copied, limit - copied);\n    return new String(multiple, coder);\n}\n```\n\næ¥çœ‹ä¸‹æ›´å¤šçš„ç”¨æ³•ã€‚\n\n```\nString str = \"Java\";\n\n// å°äº0ï¼šjava.lang.IllegalArgumentException\nSystem.out.println(str.repeat(-2));\n\n// ç­‰äº0ï¼šç©ºç™½ä¸²ï¼ˆ\"\"ï¼‰\nSystem.out.println(str.repeat(0));\n\n// JavaJavaJava\nSystem.out.println(str.repeat(3));\n\n// java.lang.OutOfMemoryError\nSystem.out.println(str.repeat(Integer.MAX_VALUE));\n```\n\næ‰€ä»¥è¯´ repeat å¹¶ä¸æ˜¯å¯ä»¥æ— é™å¢é•¿çš„ï¼Œæœ‰ä½¿ç”¨é™åˆ¶çš„ï¼Œè¾¾åˆ°ä¸€å®šé‡å°±ä¼šæŠ¥å†…å­˜æº¢å‡ºå¼‚å¸¸ã€‚\n\n#### lines\n\n```\npublic Stream<String> lines() {\n    return isLatin1() ? StringLatin1.lines(value)\n                      : StringUTF16.lines(value);\n}\n```\nlines æ–¹æ³•è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸² Stream, å¯ä»¥è¯†åˆ« `\\n` å’Œ `\\r` æ¢è¡Œç¬¦æ¢è¡Œã€‚\n\n```\n// 4\nSystem.out.println(\"A\\nB\\nC\\rD\".lines().count());\n```\n\næ˜¯ä¸æ˜¯å¾ˆå¥½ï¼Ÿåœ¨å°†æ¥è‚¯å®šæœ‰æ­¦ä¹‹åœ°ï¼å¦‚æ‰¹é‡è¯»å–æ–‡ä»¶å†…å®¹åˆ°ä¸€ä¸ª Stream ä¸­ï¼Œå°±èƒ½å¾ˆå¥½çš„è¯†åˆ«è¡Œç»“æŸç¬¦äº†ã€‚\n\n\n\n","slug":"æ–°ç‰¹æ€§/Java11/Java 11 å·²å‘å¸ƒï¼ŒString è¿˜èƒ½è¿™æ ·ç©","published":1,"updated":"2025-10-15T07:20:51.427Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu0775005iqkd44ykeei73","content":"<p>åœ¨æ–‡ç« ã€Š<a href=\"https://mp.weixin.qq.com/s/SXEqAmfbmK4NklihukbE-Q\">Java 11 æ­£å¼å‘å¸ƒï¼Œè¿™ 8 ä¸ªé€†å¤©æ–°ç‰¹æ€§æ•™ä½ å†™å‡ºæ›´ç‰›é€¼çš„ä»£ç </a>ã€‹ä¸­ï¼Œæˆ‘æœ‰ä»‹ç»åˆ° Java 11 çš„å…«ä¸ªæ–°ç‰¹æ€§ï¼Œå…¶ä¸­å…³äº String åŠ å¼ºéƒ¨åˆ†ï¼Œæˆ‘è§‰å¾—æœ‰ç‚¹æ„æ€ï¼Œè¿™é‡Œå•ç‹¬å†æ‹‰å‡ºæ¥è®²ã€‚</p>\n<p><strong>Java 11 å¢åŠ äº†ä¸€ç³»åˆ—çš„å­—ç¬¦ä¸²å¤„ç†æ–¹æ³•ï¼Œå¦‚ä»¥ä¸‹æ‰€ç¤ºã€‚</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºç™½\n&quot; &quot;.isBlank();                &#x2F;&#x2F; true\n\n&#x2F;&#x2F; å»é™¤é¦–å°¾ç©ºæ ¼\n&quot; Javastack &quot;.strip();          &#x2F;&#x2F; &quot;Javastack&quot;\n\n&#x2F;&#x2F; å»é™¤å°¾éƒ¨ç©ºæ ¼ \n&quot; Javastack &quot;.stripTrailing();  &#x2F;&#x2F; &quot; Javastack&quot;\n\n&#x2F;&#x2F; å»é™¤é¦–éƒ¨ç©ºæ ¼ \n&quot; Javastack &quot;.stripLeading();   &#x2F;&#x2F; &quot;Javastack &quot;\n\n&#x2F;&#x2F; å¤åˆ¶å­—ç¬¦ä¸²\n&quot;Java&quot;.repeat(3);             &#x2F;&#x2F; &quot;JavaJavaJava&quot;\n\n&#x2F;&#x2F; è¡Œæ•°ç»Ÿè®¡\n&quot;A\\nB\\nC&quot;.lines().count();    &#x2F;&#x2F; 3<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æœ€æœ‰æ„æ€çš„æ˜¯ <code>repeat</code> å’Œ <code>lines</code> æ–¹æ³•äº†ï¼Œæ¥çœ‹ä¸‹è¿˜èƒ½æ€ä¹ˆç©ï¼</p>\n<h4 id=\"repeat\"><a href=\"#repeat\" class=\"headerlink\" title=\"repeat\"></a>repeat</h4><p>repeat æ–¹æ³•çš„ä½œç”¨å°±æ˜¯é‡å¤ä¸€ä¸ªå­—ç¬¦ä¸² N éï¼Œå¯ä»¥ç”¨æ¥ä»£æ›¿å·¥å…·ç±»ï¼š<code>org.apache.commons.lang3.StringUtils#repeat(java.lang.String, int)</code>ï¼Œæ¥çœ‹ä¸‹ <code>repeat</code> çš„æºç ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public String repeat(int count) &#123;\n    if (count &lt; 0) &#123;\n        throw new IllegalArgumentException(&quot;count is negative: &quot; + count);\n    &#125;\n    if (count &#x3D;&#x3D; 1) &#123;\n        return this;\n    &#125;\n    final int len &#x3D; value.length;\n    if (len &#x3D;&#x3D; 0 || count &#x3D;&#x3D; 0) &#123;\n        return &quot;&quot;;\n    &#125;\n    if (len &#x3D;&#x3D; 1) &#123;\n        final byte[] single &#x3D; new byte[count];\n        Arrays.fill(single, value[0]);\n        return new String(single, coder);\n    &#125;\n    if (Integer.MAX_VALUE &#x2F; count &lt; len) &#123;\n        throw new OutOfMemoryError(&quot;Repeating &quot; + len + &quot; bytes String &quot; + count +\n                &quot; times will produce a String exceeding maximum size.&quot;);\n    &#125;\n    final int limit &#x3D; len * count;\n    final byte[] multiple &#x3D; new byte[limit];\n    System.arraycopy(value, 0, multiple, 0, len);\n    int copied &#x3D; len;\n    for (; copied &lt; limit - copied; copied &lt;&lt;&#x3D; 1) &#123;\n        System.arraycopy(multiple, 0, multiple, copied, copied);\n    &#125;\n    System.arraycopy(multiple, 0, multiple, copied, limit - copied);\n    return new String(multiple, coder);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ¥çœ‹ä¸‹æ›´å¤šçš„ç”¨æ³•ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">String str &#x3D; &quot;Java&quot;;\n\n&#x2F;&#x2F; å°äº0ï¼šjava.lang.IllegalArgumentException\nSystem.out.println(str.repeat(-2));\n\n&#x2F;&#x2F; ç­‰äº0ï¼šç©ºç™½ä¸²ï¼ˆ&quot;&quot;ï¼‰\nSystem.out.println(str.repeat(0));\n\n&#x2F;&#x2F; JavaJavaJava\nSystem.out.println(str.repeat(3));\n\n&#x2F;&#x2F; java.lang.OutOfMemoryError\nSystem.out.println(str.repeat(Integer.MAX_VALUE));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ‰€ä»¥è¯´ repeat å¹¶ä¸æ˜¯å¯ä»¥æ— é™å¢é•¿çš„ï¼Œæœ‰ä½¿ç”¨é™åˆ¶çš„ï¼Œè¾¾åˆ°ä¸€å®šé‡å°±ä¼šæŠ¥å†…å­˜æº¢å‡ºå¼‚å¸¸ã€‚</p>\n<h4 id=\"lines\"><a href=\"#lines\" class=\"headerlink\" title=\"lines\"></a>lines</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">public Stream&lt;String&gt; lines() &#123;\n    return isLatin1() ? StringLatin1.lines(value)\n                      : StringUTF16.lines(value);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<p>lines æ–¹æ³•è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸² Stream, å¯ä»¥è¯†åˆ« <code>\\n</code> å’Œ <code>\\r</code> æ¢è¡Œç¬¦æ¢è¡Œã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; 4\nSystem.out.println(&quot;A\\nB\\nC\\rD&quot;.lines().count());<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>æ˜¯ä¸æ˜¯å¾ˆå¥½ï¼Ÿåœ¨å°†æ¥è‚¯å®šæœ‰æ­¦ä¹‹åœ°ï¼å¦‚æ‰¹é‡è¯»å–æ–‡ä»¶å†…å®¹åˆ°ä¸€ä¸ª Stream ä¸­ï¼Œå°±èƒ½å¾ˆå¥½çš„è¯†åˆ«è¡Œç»“æŸç¬¦äº†ã€‚</p>\n","excerpt":"","more":"<p>åœ¨æ–‡ç« ã€Š<a href=\"https://mp.weixin.qq.com/s/SXEqAmfbmK4NklihukbE-Q\">Java 11 æ­£å¼å‘å¸ƒï¼Œè¿™ 8 ä¸ªé€†å¤©æ–°ç‰¹æ€§æ•™ä½ å†™å‡ºæ›´ç‰›é€¼çš„ä»£ç </a>ã€‹ä¸­ï¼Œæˆ‘æœ‰ä»‹ç»åˆ° Java 11 çš„å…«ä¸ªæ–°ç‰¹æ€§ï¼Œå…¶ä¸­å…³äº String åŠ å¼ºéƒ¨åˆ†ï¼Œæˆ‘è§‰å¾—æœ‰ç‚¹æ„æ€ï¼Œè¿™é‡Œå•ç‹¬å†æ‹‰å‡ºæ¥è®²ã€‚</p>\n<p><strong>Java 11 å¢åŠ äº†ä¸€ç³»åˆ—çš„å­—ç¬¦ä¸²å¤„ç†æ–¹æ³•ï¼Œå¦‚ä»¥ä¸‹æ‰€ç¤ºã€‚</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; åˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦ä¸ºç©ºç™½\n&quot; &quot;.isBlank();                &#x2F;&#x2F; true\n\n&#x2F;&#x2F; å»é™¤é¦–å°¾ç©ºæ ¼\n&quot; Javastack &quot;.strip();          &#x2F;&#x2F; &quot;Javastack&quot;\n\n&#x2F;&#x2F; å»é™¤å°¾éƒ¨ç©ºæ ¼ \n&quot; Javastack &quot;.stripTrailing();  &#x2F;&#x2F; &quot; Javastack&quot;\n\n&#x2F;&#x2F; å»é™¤é¦–éƒ¨ç©ºæ ¼ \n&quot; Javastack &quot;.stripLeading();   &#x2F;&#x2F; &quot;Javastack &quot;\n\n&#x2F;&#x2F; å¤åˆ¶å­—ç¬¦ä¸²\n&quot;Java&quot;.repeat(3);             &#x2F;&#x2F; &quot;JavaJavaJava&quot;\n\n&#x2F;&#x2F; è¡Œæ•°ç»Ÿè®¡\n&quot;A\\nB\\nC&quot;.lines().count();    &#x2F;&#x2F; 3<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æœ€æœ‰æ„æ€çš„æ˜¯ <code>repeat</code> å’Œ <code>lines</code> æ–¹æ³•äº†ï¼Œæ¥çœ‹ä¸‹è¿˜èƒ½æ€ä¹ˆç©ï¼</p>\n<h4 id=\"repeat\"><a href=\"#repeat\" class=\"headerlink\" title=\"repeat\"></a>repeat</h4><p>repeat æ–¹æ³•çš„ä½œç”¨å°±æ˜¯é‡å¤ä¸€ä¸ªå­—ç¬¦ä¸² N éï¼Œå¯ä»¥ç”¨æ¥ä»£æ›¿å·¥å…·ç±»ï¼š<code>org.apache.commons.lang3.StringUtils#repeat(java.lang.String, int)</code>ï¼Œæ¥çœ‹ä¸‹ <code>repeat</code> çš„æºç ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public String repeat(int count) &#123;\n    if (count &lt; 0) &#123;\n        throw new IllegalArgumentException(&quot;count is negative: &quot; + count);\n    &#125;\n    if (count &#x3D;&#x3D; 1) &#123;\n        return this;\n    &#125;\n    final int len &#x3D; value.length;\n    if (len &#x3D;&#x3D; 0 || count &#x3D;&#x3D; 0) &#123;\n        return &quot;&quot;;\n    &#125;\n    if (len &#x3D;&#x3D; 1) &#123;\n        final byte[] single &#x3D; new byte[count];\n        Arrays.fill(single, value[0]);\n        return new String(single, coder);\n    &#125;\n    if (Integer.MAX_VALUE &#x2F; count &lt; len) &#123;\n        throw new OutOfMemoryError(&quot;Repeating &quot; + len + &quot; bytes String &quot; + count +\n                &quot; times will produce a String exceeding maximum size.&quot;);\n    &#125;\n    final int limit &#x3D; len * count;\n    final byte[] multiple &#x3D; new byte[limit];\n    System.arraycopy(value, 0, multiple, 0, len);\n    int copied &#x3D; len;\n    for (; copied &lt; limit - copied; copied &lt;&lt;&#x3D; 1) &#123;\n        System.arraycopy(multiple, 0, multiple, copied, copied);\n    &#125;\n    System.arraycopy(multiple, 0, multiple, copied, limit - copied);\n    return new String(multiple, coder);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ¥çœ‹ä¸‹æ›´å¤šçš„ç”¨æ³•ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">String str &#x3D; &quot;Java&quot;;\n\n&#x2F;&#x2F; å°äº0ï¼šjava.lang.IllegalArgumentException\nSystem.out.println(str.repeat(-2));\n\n&#x2F;&#x2F; ç­‰äº0ï¼šç©ºç™½ä¸²ï¼ˆ&quot;&quot;ï¼‰\nSystem.out.println(str.repeat(0));\n\n&#x2F;&#x2F; JavaJavaJava\nSystem.out.println(str.repeat(3));\n\n&#x2F;&#x2F; java.lang.OutOfMemoryError\nSystem.out.println(str.repeat(Integer.MAX_VALUE));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ‰€ä»¥è¯´ repeat å¹¶ä¸æ˜¯å¯ä»¥æ— é™å¢é•¿çš„ï¼Œæœ‰ä½¿ç”¨é™åˆ¶çš„ï¼Œè¾¾åˆ°ä¸€å®šé‡å°±ä¼šæŠ¥å†…å­˜æº¢å‡ºå¼‚å¸¸ã€‚</p>\n<h4 id=\"lines\"><a href=\"#lines\" class=\"headerlink\" title=\"lines\"></a>lines</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">public Stream&lt;String&gt; lines() &#123;\n    return isLatin1() ? StringLatin1.lines(value)\n                      : StringUTF16.lines(value);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<p>lines æ–¹æ³•è¿”å›ä¸€ä¸ªå­—ç¬¦ä¸² Stream, å¯ä»¥è¯†åˆ« <code>\\n</code> å’Œ <code>\\r</code> æ¢è¡Œç¬¦æ¢è¡Œã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; 4\nSystem.out.println(&quot;A\\nB\\nC\\rD&quot;.lines().count());<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>æ˜¯ä¸æ˜¯å¾ˆå¥½ï¼Ÿåœ¨å°†æ¥è‚¯å®šæœ‰æ­¦ä¹‹åœ°ï¼å¦‚æ‰¹é‡è¯»å–æ–‡ä»¶å†…å®¹åˆ°ä¸€ä¸ª Stream ä¸­ï¼Œå°±èƒ½å¾ˆå¥½çš„è¯†åˆ«è¡Œç»“æŸç¬¦äº†ã€‚</p>\n"},{"title":"Java8 æ–°ç‰¹æ€§ä¹‹Lambdaè¡¨è¾¾å¼","date":"2025-10-15T03:36:33.000Z","_content":"\n## ä»€ä¹ˆæ˜¯Lambdaè¡¨è¾¾å¼\n\nJava 8çš„ä¸€ä¸ªå¤§äº®ç‚¹æ˜¯å¼•å…¥Lambdaè¡¨è¾¾å¼ï¼Œä½¿ç”¨å®ƒè®¾è®¡çš„ä»£ç ä¼šæ›´åŠ ç®€æ´ã€‚å½“å¼€å‘è€…åœ¨ç¼–å†™Lambdaè¡¨è¾¾å¼æ—¶ï¼Œä¹Ÿä¼šéšä¹‹è¢«ç¼–è¯‘æˆä¸€ä¸ªå‡½æ•°å¼æ¥å£ã€‚\n\n## Lambdaè¯­æ³•\n\nä¸€è¡Œæ‰§è¡Œè¯­å¥çš„å†™æ³•ï¼š\n\n```\n(parameters) -> expression\n```\n\nå¦‚æœæœ‰å¤šè¡Œæ‰§è¡Œè¯­å¥ï¼Œå¯ä»¥åŠ ä¸Š`{}`\n```\n(parameters) -> { statements; }\n```\n\nå¦‚ï¼š\n\n```\npublic int add(int x, int y) {\n    return x + y;\n}\n```\n\nè½¬æ¢æˆLambdaè¡¨è¾¾å¼æœ‰ä»¥ä¸‹å‡ ç§å†™æ³•ï¼š\n\n```\n// æŒ‡å®šå‚æ•°ç±»å‹åŠreturn\n(int x, int y) -> { return x + y; }\n\n// æŒ‡å®šå‚æ•°ç±»å‹ï¼Œä¸æŒ‡å®šreturn\n(int x, int y) -> x + y;\n\n// ä¸æŒ‡å®šå‚æ•°ç±»å‹å’Œreturnï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æ¨æ–­\n(x, y) -> x + y; \n\n```\n\n## Lambdaç”¨é€”\n\n#### 1ã€åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„å‡½æ•°å¼æ¥å£\n\nLambdaè¡¨è¾¾å¼çš„ç›®æ ‡ç±»å‹æ˜¯å‡½æ•°å¼æ¥å£ï¼Œä»€ä¹ˆæ˜¯å‡½æ•°å¼æ¥å£ä¹‹åä¼šè®²ã€‚\n\nä¸‹é¢æ‹¿åˆ›å»ºçº¿ç¨‹æ¥ä¸¾ä¾‹ï¼Œç”¨lambdaè¡¨è¾¾å¼å¯ä»¥æœ‰ä»¥ä¸‹å‡ ç§å†™æ³•ã€‚\n\n```\npublic static void main(String[] args) {\n\tnew Thread(new Runnable() {\n\t\t@Override\n\t\tpublic void run() {\n\t\t\tSystem.out.println(\"t1\");\n\t\t}\n\t}).start();\n\n\tRunnable runnable = () -> System.out.println(\"t2\");\n\tnew Thread(runnable).start();\n\n\tnew Thread(() -> System.out.println(\"t3\")).start();\n\n\tnew Thread(() -> run(\"t4\")).start();\n\n\tnew Thread(() -> {\n\t\tString str = \"t5\";\n\t\tSystem.out.println(str);\n\t}).start();\n\n}\n\nprivate static void run(String str) {\n\tSystem.out.println(str);\n}\n```\n\næœ€åè¾“å‡ºï¼š\n\n```\nt1\nt2\nt3\nt4\nt5\n```\n\n#### 2ã€é›†åˆæ‰¹é‡æ“ä½œ\n\nä¸‹é¢æ‰“å°listé›†åˆçš„ä¸¤ç§å†™æ³•æ˜¯ç­‰ä»·çš„ã€‚\n\n```\nList<String> list = Arrays.asList(\"a\",\"b\",\"c\");\nfor(String str : list){\n\tSystem.out.println(str);\n}\n\nlist.forEach((e) -> System.out.println(e));\n```\n\n#### 3ã€æµæ“ä½œ\n\nä¸‹é¢æ˜¯æµæŸ¥è¯¢listé›†åˆä¸­ç­‰äº`\"a\"`çš„æ•°é‡ã€‚\n\n```\nlist.stream().filter((e) -> \"a\".equals(e)).count();\n```\n\næ›´å¤šçš„Lambdaè¡¨è¾¾å¼åŠå…³äºæµæ›´å¤šå†…å®¹ä¹‹åé™†ç»­ä¼šè®²åˆ°ã€‚\n\n","source":"_posts/æ–°ç‰¹æ€§/Java8/Java8 æ–°ç‰¹æ€§ä¹‹Lambdaè¡¨è¾¾å¼.md","raw":"---\ntitle: Java8 æ–°ç‰¹æ€§ä¹‹Lambdaè¡¨è¾¾å¼\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: æ–°ç‰¹æ€§\n---\n\n## ä»€ä¹ˆæ˜¯Lambdaè¡¨è¾¾å¼\n\nJava 8çš„ä¸€ä¸ªå¤§äº®ç‚¹æ˜¯å¼•å…¥Lambdaè¡¨è¾¾å¼ï¼Œä½¿ç”¨å®ƒè®¾è®¡çš„ä»£ç ä¼šæ›´åŠ ç®€æ´ã€‚å½“å¼€å‘è€…åœ¨ç¼–å†™Lambdaè¡¨è¾¾å¼æ—¶ï¼Œä¹Ÿä¼šéšä¹‹è¢«ç¼–è¯‘æˆä¸€ä¸ªå‡½æ•°å¼æ¥å£ã€‚\n\n## Lambdaè¯­æ³•\n\nä¸€è¡Œæ‰§è¡Œè¯­å¥çš„å†™æ³•ï¼š\n\n```\n(parameters) -> expression\n```\n\nå¦‚æœæœ‰å¤šè¡Œæ‰§è¡Œè¯­å¥ï¼Œå¯ä»¥åŠ ä¸Š`{}`\n```\n(parameters) -> { statements; }\n```\n\nå¦‚ï¼š\n\n```\npublic int add(int x, int y) {\n    return x + y;\n}\n```\n\nè½¬æ¢æˆLambdaè¡¨è¾¾å¼æœ‰ä»¥ä¸‹å‡ ç§å†™æ³•ï¼š\n\n```\n// æŒ‡å®šå‚æ•°ç±»å‹åŠreturn\n(int x, int y) -> { return x + y; }\n\n// æŒ‡å®šå‚æ•°ç±»å‹ï¼Œä¸æŒ‡å®šreturn\n(int x, int y) -> x + y;\n\n// ä¸æŒ‡å®šå‚æ•°ç±»å‹å’Œreturnï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æ¨æ–­\n(x, y) -> x + y; \n\n```\n\n## Lambdaç”¨é€”\n\n#### 1ã€åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„å‡½æ•°å¼æ¥å£\n\nLambdaè¡¨è¾¾å¼çš„ç›®æ ‡ç±»å‹æ˜¯å‡½æ•°å¼æ¥å£ï¼Œä»€ä¹ˆæ˜¯å‡½æ•°å¼æ¥å£ä¹‹åä¼šè®²ã€‚\n\nä¸‹é¢æ‹¿åˆ›å»ºçº¿ç¨‹æ¥ä¸¾ä¾‹ï¼Œç”¨lambdaè¡¨è¾¾å¼å¯ä»¥æœ‰ä»¥ä¸‹å‡ ç§å†™æ³•ã€‚\n\n```\npublic static void main(String[] args) {\n\tnew Thread(new Runnable() {\n\t\t@Override\n\t\tpublic void run() {\n\t\t\tSystem.out.println(\"t1\");\n\t\t}\n\t}).start();\n\n\tRunnable runnable = () -> System.out.println(\"t2\");\n\tnew Thread(runnable).start();\n\n\tnew Thread(() -> System.out.println(\"t3\")).start();\n\n\tnew Thread(() -> run(\"t4\")).start();\n\n\tnew Thread(() -> {\n\t\tString str = \"t5\";\n\t\tSystem.out.println(str);\n\t}).start();\n\n}\n\nprivate static void run(String str) {\n\tSystem.out.println(str);\n}\n```\n\næœ€åè¾“å‡ºï¼š\n\n```\nt1\nt2\nt3\nt4\nt5\n```\n\n#### 2ã€é›†åˆæ‰¹é‡æ“ä½œ\n\nä¸‹é¢æ‰“å°listé›†åˆçš„ä¸¤ç§å†™æ³•æ˜¯ç­‰ä»·çš„ã€‚\n\n```\nList<String> list = Arrays.asList(\"a\",\"b\",\"c\");\nfor(String str : list){\n\tSystem.out.println(str);\n}\n\nlist.forEach((e) -> System.out.println(e));\n```\n\n#### 3ã€æµæ“ä½œ\n\nä¸‹é¢æ˜¯æµæŸ¥è¯¢listé›†åˆä¸­ç­‰äº`\"a\"`çš„æ•°é‡ã€‚\n\n```\nlist.stream().filter((e) -> \"a\".equals(e)).count();\n```\n\næ›´å¤šçš„Lambdaè¡¨è¾¾å¼åŠå…³äºæµæ›´å¤šå†…å®¹ä¹‹åé™†ç»­ä¼šè®²åˆ°ã€‚\n\n","slug":"æ–°ç‰¹æ€§/Java8/Java8 æ–°ç‰¹æ€§ä¹‹Lambdaè¡¨è¾¾å¼","published":1,"updated":"2025-10-15T07:20:51.510Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu0775005lqkd4g5wg2nkh","content":"<h2 id=\"ä»€ä¹ˆæ˜¯Lambdaè¡¨è¾¾å¼\"><a href=\"#ä»€ä¹ˆæ˜¯Lambdaè¡¨è¾¾å¼\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯Lambdaè¡¨è¾¾å¼\"></a>ä»€ä¹ˆæ˜¯Lambdaè¡¨è¾¾å¼</h2><p>Java 8çš„ä¸€ä¸ªå¤§äº®ç‚¹æ˜¯å¼•å…¥Lambdaè¡¨è¾¾å¼ï¼Œä½¿ç”¨å®ƒè®¾è®¡çš„ä»£ç ä¼šæ›´åŠ ç®€æ´ã€‚å½“å¼€å‘è€…åœ¨ç¼–å†™Lambdaè¡¨è¾¾å¼æ—¶ï¼Œä¹Ÿä¼šéšä¹‹è¢«ç¼–è¯‘æˆä¸€ä¸ªå‡½æ•°å¼æ¥å£ã€‚</p>\n<h2 id=\"Lambdaè¯­æ³•\"><a href=\"#Lambdaè¯­æ³•\" class=\"headerlink\" title=\"Lambdaè¯­æ³•\"></a>Lambdaè¯­æ³•</h2><p>ä¸€è¡Œæ‰§è¡Œè¯­å¥çš„å†™æ³•ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">(parameters) -&gt; expression<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>å¦‚æœæœ‰å¤šè¡Œæ‰§è¡Œè¯­å¥ï¼Œå¯ä»¥åŠ ä¸Š<code>&#123;&#125;</code></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">(parameters) -&gt; &#123; statements; &#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>å¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public int add(int x, int y) &#123;\n    return x + y;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>è½¬æ¢æˆLambdaè¡¨è¾¾å¼æœ‰ä»¥ä¸‹å‡ ç§å†™æ³•ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; æŒ‡å®šå‚æ•°ç±»å‹åŠreturn\n(int x, int y) -&gt; &#123; return x + y; &#125;\n\n&#x2F;&#x2F; æŒ‡å®šå‚æ•°ç±»å‹ï¼Œä¸æŒ‡å®šreturn\n(int x, int y) -&gt; x + y;\n\n&#x2F;&#x2F; ä¸æŒ‡å®šå‚æ•°ç±»å‹å’Œreturnï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æ¨æ–­\n(x, y) -&gt; x + y; \n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"Lambdaç”¨é€”\"><a href=\"#Lambdaç”¨é€”\" class=\"headerlink\" title=\"Lambdaç”¨é€”\"></a>Lambdaç”¨é€”</h2><h4 id=\"1ã€åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„å‡½æ•°å¼æ¥å£\"><a href=\"#1ã€åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„å‡½æ•°å¼æ¥å£\" class=\"headerlink\" title=\"1ã€åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„å‡½æ•°å¼æ¥å£\"></a>1ã€åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„å‡½æ•°å¼æ¥å£</h4><p>Lambdaè¡¨è¾¾å¼çš„ç›®æ ‡ç±»å‹æ˜¯å‡½æ•°å¼æ¥å£ï¼Œä»€ä¹ˆæ˜¯å‡½æ•°å¼æ¥å£ä¹‹åä¼šè®²ã€‚</p>\n<p>ä¸‹é¢æ‹¿åˆ›å»ºçº¿ç¨‹æ¥ä¸¾ä¾‹ï¼Œç”¨lambdaè¡¨è¾¾å¼å¯ä»¥æœ‰ä»¥ä¸‹å‡ ç§å†™æ³•ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n\tnew Thread(new Runnable() &#123;\n\t\t@Override\n\t\tpublic void run() &#123;\n\t\t\tSystem.out.println(&quot;t1&quot;);\n\t\t&#125;\n\t&#125;).start();\n\n\tRunnable runnable &#x3D; () -&gt; System.out.println(&quot;t2&quot;);\n\tnew Thread(runnable).start();\n\n\tnew Thread(() -&gt; System.out.println(&quot;t3&quot;)).start();\n\n\tnew Thread(() -&gt; run(&quot;t4&quot;)).start();\n\n\tnew Thread(() -&gt; &#123;\n\t\tString str &#x3D; &quot;t5&quot;;\n\t\tSystem.out.println(str);\n\t&#125;).start();\n\n&#125;\n\nprivate static void run(String str) &#123;\n\tSystem.out.println(str);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æœ€åè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">t1\nt2\nt3\nt4\nt5<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"2ã€é›†åˆæ‰¹é‡æ“ä½œ\"><a href=\"#2ã€é›†åˆæ‰¹é‡æ“ä½œ\" class=\"headerlink\" title=\"2ã€é›†åˆæ‰¹é‡æ“ä½œ\"></a>2ã€é›†åˆæ‰¹é‡æ“ä½œ</h4><p>ä¸‹é¢æ‰“å°listé›†åˆçš„ä¸¤ç§å†™æ³•æ˜¯ç­‰ä»·çš„ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;String&gt; list &#x3D; Arrays.asList(&quot;a&quot;,&quot;b&quot;,&quot;c&quot;);\nfor(String str : list)&#123;\n\tSystem.out.println(str);\n&#125;\n\nlist.forEach((e) -&gt; System.out.println(e));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"3ã€æµæ“ä½œ\"><a href=\"#3ã€æµæ“ä½œ\" class=\"headerlink\" title=\"3ã€æµæ“ä½œ\"></a>3ã€æµæ“ä½œ</h4><p>ä¸‹é¢æ˜¯æµæŸ¥è¯¢listé›†åˆä¸­ç­‰äº<code>&quot;a&quot;</code>çš„æ•°é‡ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">list.stream().filter((e) -&gt; &quot;a&quot;.equals(e)).count();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>æ›´å¤šçš„Lambdaè¡¨è¾¾å¼åŠå…³äºæµæ›´å¤šå†…å®¹ä¹‹åé™†ç»­ä¼šè®²åˆ°ã€‚</p>\n","excerpt":"","more":"<h2 id=\"ä»€ä¹ˆæ˜¯Lambdaè¡¨è¾¾å¼\"><a href=\"#ä»€ä¹ˆæ˜¯Lambdaè¡¨è¾¾å¼\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯Lambdaè¡¨è¾¾å¼\"></a>ä»€ä¹ˆæ˜¯Lambdaè¡¨è¾¾å¼</h2><p>Java 8çš„ä¸€ä¸ªå¤§äº®ç‚¹æ˜¯å¼•å…¥Lambdaè¡¨è¾¾å¼ï¼Œä½¿ç”¨å®ƒè®¾è®¡çš„ä»£ç ä¼šæ›´åŠ ç®€æ´ã€‚å½“å¼€å‘è€…åœ¨ç¼–å†™Lambdaè¡¨è¾¾å¼æ—¶ï¼Œä¹Ÿä¼šéšä¹‹è¢«ç¼–è¯‘æˆä¸€ä¸ªå‡½æ•°å¼æ¥å£ã€‚</p>\n<h2 id=\"Lambdaè¯­æ³•\"><a href=\"#Lambdaè¯­æ³•\" class=\"headerlink\" title=\"Lambdaè¯­æ³•\"></a>Lambdaè¯­æ³•</h2><p>ä¸€è¡Œæ‰§è¡Œè¯­å¥çš„å†™æ³•ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">(parameters) -&gt; expression<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>å¦‚æœæœ‰å¤šè¡Œæ‰§è¡Œè¯­å¥ï¼Œå¯ä»¥åŠ ä¸Š<code>&#123;&#125;</code></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">(parameters) -&gt; &#123; statements; &#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>å¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public int add(int x, int y) &#123;\n    return x + y;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>è½¬æ¢æˆLambdaè¡¨è¾¾å¼æœ‰ä»¥ä¸‹å‡ ç§å†™æ³•ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F; æŒ‡å®šå‚æ•°ç±»å‹åŠreturn\n(int x, int y) -&gt; &#123; return x + y; &#125;\n\n&#x2F;&#x2F; æŒ‡å®šå‚æ•°ç±»å‹ï¼Œä¸æŒ‡å®šreturn\n(int x, int y) -&gt; x + y;\n\n&#x2F;&#x2F; ä¸æŒ‡å®šå‚æ•°ç±»å‹å’Œreturnï¼Œç¼–è¯‘å™¨ä¼šè‡ªåŠ¨æ¨æ–­\n(x, y) -&gt; x + y; \n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"Lambdaç”¨é€”\"><a href=\"#Lambdaç”¨é€”\" class=\"headerlink\" title=\"Lambdaç”¨é€”\"></a>Lambdaç”¨é€”</h2><h4 id=\"1ã€åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„å‡½æ•°å¼æ¥å£\"><a href=\"#1ã€åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„å‡½æ•°å¼æ¥å£\" class=\"headerlink\" title=\"1ã€åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„å‡½æ•°å¼æ¥å£\"></a>1ã€åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„å‡½æ•°å¼æ¥å£</h4><p>Lambdaè¡¨è¾¾å¼çš„ç›®æ ‡ç±»å‹æ˜¯å‡½æ•°å¼æ¥å£ï¼Œä»€ä¹ˆæ˜¯å‡½æ•°å¼æ¥å£ä¹‹åä¼šè®²ã€‚</p>\n<p>ä¸‹é¢æ‹¿åˆ›å»ºçº¿ç¨‹æ¥ä¸¾ä¾‹ï¼Œç”¨lambdaè¡¨è¾¾å¼å¯ä»¥æœ‰ä»¥ä¸‹å‡ ç§å†™æ³•ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n\tnew Thread(new Runnable() &#123;\n\t\t@Override\n\t\tpublic void run() &#123;\n\t\t\tSystem.out.println(&quot;t1&quot;);\n\t\t&#125;\n\t&#125;).start();\n\n\tRunnable runnable &#x3D; () -&gt; System.out.println(&quot;t2&quot;);\n\tnew Thread(runnable).start();\n\n\tnew Thread(() -&gt; System.out.println(&quot;t3&quot;)).start();\n\n\tnew Thread(() -&gt; run(&quot;t4&quot;)).start();\n\n\tnew Thread(() -&gt; &#123;\n\t\tString str &#x3D; &quot;t5&quot;;\n\t\tSystem.out.println(str);\n\t&#125;).start();\n\n&#125;\n\nprivate static void run(String str) &#123;\n\tSystem.out.println(str);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æœ€åè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">t1\nt2\nt3\nt4\nt5<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"2ã€é›†åˆæ‰¹é‡æ“ä½œ\"><a href=\"#2ã€é›†åˆæ‰¹é‡æ“ä½œ\" class=\"headerlink\" title=\"2ã€é›†åˆæ‰¹é‡æ“ä½œ\"></a>2ã€é›†åˆæ‰¹é‡æ“ä½œ</h4><p>ä¸‹é¢æ‰“å°listé›†åˆçš„ä¸¤ç§å†™æ³•æ˜¯ç­‰ä»·çš„ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;String&gt; list &#x3D; Arrays.asList(&quot;a&quot;,&quot;b&quot;,&quot;c&quot;);\nfor(String str : list)&#123;\n\tSystem.out.println(str);\n&#125;\n\nlist.forEach((e) -&gt; System.out.println(e));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"3ã€æµæ“ä½œ\"><a href=\"#3ã€æµæ“ä½œ\" class=\"headerlink\" title=\"3ã€æµæ“ä½œ\"></a>3ã€æµæ“ä½œ</h4><p>ä¸‹é¢æ˜¯æµæŸ¥è¯¢listé›†åˆä¸­ç­‰äº<code>&quot;a&quot;</code>çš„æ•°é‡ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">list.stream().filter((e) -&gt; &quot;a&quot;.equals(e)).count();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>æ›´å¤šçš„Lambdaè¡¨è¾¾å¼åŠå…³äºæµæ›´å¤šå†…å®¹ä¹‹åé™†ç»­ä¼šè®²åˆ°ã€‚</p>\n"},{"title":"JJava8 æ–°ç‰¹æ€§ä¹‹Optional","date":"2025-10-15T03:36:33.000Z","_content":"\n## Optionalæ˜¯ä»€ä¹ˆ\n\n`java.util.Optional`\n\nJdk8æä¾›`Optional`ï¼Œä¸€ä¸ªå¯ä»¥åŒ…å«nullå€¼çš„å®¹å™¨å¯¹è±¡ï¼Œå¯ä»¥ç”¨æ¥ä»£æ›¿xx != nullçš„åˆ¤æ–­ã€‚\n\n## Optionalå¸¸ç”¨æ–¹æ³•\n\n### of\n\n\n```\npublic static <T> Optional<T> of(T value) {\n    return new Optional<>(value);\n}\n```\n\nä¸ºvalueåˆ›å»ºä¸€ä¸ªOptionalå¯¹è±¡ï¼Œå¦‚æœvalueä¸ºç©ºåˆ™ ä¼šæŠ¥å‡ºNullPointerExceptionå¼‚å¸¸ã€‚\n\n### ofNullable\n\n```\npublic static <T> Optional<T> ofNullable(T value) {\n    return value == null ? empty() : of(value);\n}\n```\n\nä¸ºvalueåˆ›å»ºä¸€ä¸ªOptionalå¯¹è±¡ï¼Œä½†å¯ä»¥å…è®¸valueä¸ºnullå€¼ã€‚\n\n### isPresent\n\n```\npublic boolean isPresent() {\n    return value != null;\n}\n```\n\nåˆ¤æ–­å½“å‰valueæ˜¯å¦ä¸ºnull,å¦‚æœä¸ä¸ºnullåˆ™è¿”å›trueï¼Œå¦åˆ™falseã€‚\n\n### ifPresent\n\nå¦‚æœä¸ä¸ºnullå€¼å°±æ‰§è¡Œå‡½æ•°å¼æ¥å£çš„å†…å®¹ã€‚\n\n```\npublic void ifPresent(Consumer<? super T> consumer) {\n    if (value != null)\n        consumer.accept(value);\n}\n```\n\n### get\n\n\n```\npublic T get() {\n    if (value == null) {\n        throw new NoSuchElementException(\"No value present\");\n    }\n    return value;\n}\n```\n\nè¿”å›å½“å‰çš„å€¼ï¼Œå¦‚æœä¸ºç©ºåˆ™æŠ¥å¼‚å¸¸ã€‚\n\n### orElse\n\nè¿”å›å½“å‰å€¼ï¼Œå¦‚æœä¸ºnullåˆ™è¿”å›otherã€‚\n\n```\npublic T orElse(T other) {\n    return value != null ? value : other;\n}\n```\n\n### orElseGet\n\norElseGetå’ŒorElseç±»ä¼¼ï¼Œåªæ˜¯orElseGetæ”¯æŒå‡½æ•°å¼æ¥å£æ¥ç”Ÿæˆotherå€¼ã€‚\n\n```\npublic T orElseGet(Supplier<? extends T> other) {\n    return value != null ? value : other.get();\n}\n```\n\n### orElseThrow\n\nå¦‚æœæœ‰å€¼åˆ™è¿”å›ï¼Œæ²¡æœ‰åˆ™ç”¨å‡½æ•°å¼æ¥å£æŠ›å‡ºç”Ÿæˆçš„å¼‚å¸¸ã€‚\n\n```\npublic <X extends Throwable> T orElseThrow(Supplier<? extends X> exceptionSupplier) throws X {\n    if (value != null) {\n        return value;\n    } else {\n        throw exceptionSupplier.get();\n    }\n}\n```\n\n## ç¤ºä¾‹\n\n```\npublic static void main(String[] args) {\n\ttestOf();\n\ttestNullable();\n}\n\n\nprivate static void testNullable() {\n\tUser user = null;\n\tUser john = new User(\"john\", 18);\n\tUser dick = new User(\"dick\", 12);\n\n\tSystem.out.println(Optional.ofNullable(user).orElse(john));\n\tSystem.out.println(Optional.ofNullable(john).get());\n\tSystem.out.println(Optional.ofNullable(dick).orElse(john));\n\tSystem.out.println(Optional.ofNullable(user).orElseGet(() -> john));\n\n\tSystem.out.println();\n}\n\nprivate static void testOf() {\n\ttry {\n\t\tUser user1 = new User();\n\t\tOptional<User> userOptional1 = Optional.of(user1);\n\t\tif (userOptional1.isPresent()) {\n\t\t\tSystem.out.println(\"user is not null\");\n\t\t}\n\n\t\tUser user2 = null;\n\t\tOptional<User> userOptional2 = Optional.of(user2);//NullPointerException\n\t\tif (userOptional2.isPresent()) {\n\t\t\tSystem.out.println(\"user is not null\");\n\t\t}\n\t} catch (Exception e) {\n\t\te.printStackTrace();\n\t}\n\tSystem.out.println();\n}\n```\n\n`Optional`åœ¨jdk8ä¸­æœ‰å¤§é‡ä½¿ç”¨ï¼Œæ¯”å¦‚åƒStreamæµä¸­ï¼Œä½†`Optional`ç”¨åœ¨nullåˆ¤æ–­æ„Ÿè§‰ä¹Ÿæ²¡ä»€ä¹ˆé¸Ÿç”¨ã€‚ã€‚\n\nåœ¨Spring4ä¸­ä¹Ÿå¯ä»¥ç”¨Optionalæ¥ä»£æ›¿autowired(require=false)çš„æƒ…å†µï¼Œå‚è€ƒå†å²Springç³»åˆ—æ–‡ç« ã€‚\n\n\n\n\n\n\n","source":"_posts/æ–°ç‰¹æ€§/Java8/Java8 æ–°ç‰¹æ€§ä¹‹Optional.md","raw":"---\ntitle: JJava8 æ–°ç‰¹æ€§ä¹‹Optional\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: æ–°ç‰¹æ€§\n---\n\n## Optionalæ˜¯ä»€ä¹ˆ\n\n`java.util.Optional`\n\nJdk8æä¾›`Optional`ï¼Œä¸€ä¸ªå¯ä»¥åŒ…å«nullå€¼çš„å®¹å™¨å¯¹è±¡ï¼Œå¯ä»¥ç”¨æ¥ä»£æ›¿xx != nullçš„åˆ¤æ–­ã€‚\n\n## Optionalå¸¸ç”¨æ–¹æ³•\n\n### of\n\n\n```\npublic static <T> Optional<T> of(T value) {\n    return new Optional<>(value);\n}\n```\n\nä¸ºvalueåˆ›å»ºä¸€ä¸ªOptionalå¯¹è±¡ï¼Œå¦‚æœvalueä¸ºç©ºåˆ™ ä¼šæŠ¥å‡ºNullPointerExceptionå¼‚å¸¸ã€‚\n\n### ofNullable\n\n```\npublic static <T> Optional<T> ofNullable(T value) {\n    return value == null ? empty() : of(value);\n}\n```\n\nä¸ºvalueåˆ›å»ºä¸€ä¸ªOptionalå¯¹è±¡ï¼Œä½†å¯ä»¥å…è®¸valueä¸ºnullå€¼ã€‚\n\n### isPresent\n\n```\npublic boolean isPresent() {\n    return value != null;\n}\n```\n\nåˆ¤æ–­å½“å‰valueæ˜¯å¦ä¸ºnull,å¦‚æœä¸ä¸ºnullåˆ™è¿”å›trueï¼Œå¦åˆ™falseã€‚\n\n### ifPresent\n\nå¦‚æœä¸ä¸ºnullå€¼å°±æ‰§è¡Œå‡½æ•°å¼æ¥å£çš„å†…å®¹ã€‚\n\n```\npublic void ifPresent(Consumer<? super T> consumer) {\n    if (value != null)\n        consumer.accept(value);\n}\n```\n\n### get\n\n\n```\npublic T get() {\n    if (value == null) {\n        throw new NoSuchElementException(\"No value present\");\n    }\n    return value;\n}\n```\n\nè¿”å›å½“å‰çš„å€¼ï¼Œå¦‚æœä¸ºç©ºåˆ™æŠ¥å¼‚å¸¸ã€‚\n\n### orElse\n\nè¿”å›å½“å‰å€¼ï¼Œå¦‚æœä¸ºnullåˆ™è¿”å›otherã€‚\n\n```\npublic T orElse(T other) {\n    return value != null ? value : other;\n}\n```\n\n### orElseGet\n\norElseGetå’ŒorElseç±»ä¼¼ï¼Œåªæ˜¯orElseGetæ”¯æŒå‡½æ•°å¼æ¥å£æ¥ç”Ÿæˆotherå€¼ã€‚\n\n```\npublic T orElseGet(Supplier<? extends T> other) {\n    return value != null ? value : other.get();\n}\n```\n\n### orElseThrow\n\nå¦‚æœæœ‰å€¼åˆ™è¿”å›ï¼Œæ²¡æœ‰åˆ™ç”¨å‡½æ•°å¼æ¥å£æŠ›å‡ºç”Ÿæˆçš„å¼‚å¸¸ã€‚\n\n```\npublic <X extends Throwable> T orElseThrow(Supplier<? extends X> exceptionSupplier) throws X {\n    if (value != null) {\n        return value;\n    } else {\n        throw exceptionSupplier.get();\n    }\n}\n```\n\n## ç¤ºä¾‹\n\n```\npublic static void main(String[] args) {\n\ttestOf();\n\ttestNullable();\n}\n\n\nprivate static void testNullable() {\n\tUser user = null;\n\tUser john = new User(\"john\", 18);\n\tUser dick = new User(\"dick\", 12);\n\n\tSystem.out.println(Optional.ofNullable(user).orElse(john));\n\tSystem.out.println(Optional.ofNullable(john).get());\n\tSystem.out.println(Optional.ofNullable(dick).orElse(john));\n\tSystem.out.println(Optional.ofNullable(user).orElseGet(() -> john));\n\n\tSystem.out.println();\n}\n\nprivate static void testOf() {\n\ttry {\n\t\tUser user1 = new User();\n\t\tOptional<User> userOptional1 = Optional.of(user1);\n\t\tif (userOptional1.isPresent()) {\n\t\t\tSystem.out.println(\"user is not null\");\n\t\t}\n\n\t\tUser user2 = null;\n\t\tOptional<User> userOptional2 = Optional.of(user2);//NullPointerException\n\t\tif (userOptional2.isPresent()) {\n\t\t\tSystem.out.println(\"user is not null\");\n\t\t}\n\t} catch (Exception e) {\n\t\te.printStackTrace();\n\t}\n\tSystem.out.println();\n}\n```\n\n`Optional`åœ¨jdk8ä¸­æœ‰å¤§é‡ä½¿ç”¨ï¼Œæ¯”å¦‚åƒStreamæµä¸­ï¼Œä½†`Optional`ç”¨åœ¨nullåˆ¤æ–­æ„Ÿè§‰ä¹Ÿæ²¡ä»€ä¹ˆé¸Ÿç”¨ã€‚ã€‚\n\nåœ¨Spring4ä¸­ä¹Ÿå¯ä»¥ç”¨Optionalæ¥ä»£æ›¿autowired(require=false)çš„æƒ…å†µï¼Œå‚è€ƒå†å²Springç³»åˆ—æ–‡ç« ã€‚\n\n\n\n\n\n\n","slug":"æ–°ç‰¹æ€§/Java8/Java8 æ–°ç‰¹æ€§ä¹‹Optional","published":1,"updated":"2025-10-15T07:20:51.398Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu0775005oqkd47g96fnmy","content":"<h2 id=\"Optionalæ˜¯ä»€ä¹ˆ\"><a href=\"#Optionalæ˜¯ä»€ä¹ˆ\" class=\"headerlink\" title=\"Optionalæ˜¯ä»€ä¹ˆ\"></a>Optionalæ˜¯ä»€ä¹ˆ</h2><p><code>java.util.Optional</code></p>\n<p>Jdk8æä¾›<code>Optional</code>ï¼Œä¸€ä¸ªå¯ä»¥åŒ…å«nullå€¼çš„å®¹å™¨å¯¹è±¡ï¼Œå¯ä»¥ç”¨æ¥ä»£æ›¿xx !&#x3D; nullçš„åˆ¤æ–­ã€‚</p>\n<h2 id=\"Optionalå¸¸ç”¨æ–¹æ³•\"><a href=\"#Optionalå¸¸ç”¨æ–¹æ³•\" class=\"headerlink\" title=\"Optionalå¸¸ç”¨æ–¹æ³•\"></a>Optionalå¸¸ç”¨æ–¹æ³•</h2><h3 id=\"of\"><a href=\"#of\" class=\"headerlink\" title=\"of\"></a>of</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">public static &lt;T&gt; Optional&lt;T&gt; of(T value) &#123;\n    return new Optional&lt;&gt;(value);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ä¸ºvalueåˆ›å»ºä¸€ä¸ªOptionalå¯¹è±¡ï¼Œå¦‚æœvalueä¸ºç©ºåˆ™ ä¼šæŠ¥å‡ºNullPointerExceptionå¼‚å¸¸ã€‚</p>\n<h3 id=\"ofNullable\"><a href=\"#ofNullable\" class=\"headerlink\" title=\"ofNullable\"></a>ofNullable</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">public static &lt;T&gt; Optional&lt;T&gt; ofNullable(T value) &#123;\n    return value &#x3D;&#x3D; null ? empty() : of(value);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ä¸ºvalueåˆ›å»ºä¸€ä¸ªOptionalå¯¹è±¡ï¼Œä½†å¯ä»¥å…è®¸valueä¸ºnullå€¼ã€‚</p>\n<h3 id=\"isPresent\"><a href=\"#isPresent\" class=\"headerlink\" title=\"isPresent\"></a>isPresent</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">public boolean isPresent() &#123;\n    return value !&#x3D; null;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>åˆ¤æ–­å½“å‰valueæ˜¯å¦ä¸ºnull,å¦‚æœä¸ä¸ºnullåˆ™è¿”å›trueï¼Œå¦åˆ™falseã€‚</p>\n<h3 id=\"ifPresent\"><a href=\"#ifPresent\" class=\"headerlink\" title=\"ifPresent\"></a>ifPresent</h3><p>å¦‚æœä¸ä¸ºnullå€¼å°±æ‰§è¡Œå‡½æ•°å¼æ¥å£çš„å†…å®¹ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public void ifPresent(Consumer&lt;? super T&gt; consumer) &#123;\n    if (value !&#x3D; null)\n        consumer.accept(value);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"get\"><a href=\"#get\" class=\"headerlink\" title=\"get\"></a>get</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">public T get() &#123;\n    if (value &#x3D;&#x3D; null) &#123;\n        throw new NoSuchElementException(&quot;No value present&quot;);\n    &#125;\n    return value;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿”å›å½“å‰çš„å€¼ï¼Œå¦‚æœä¸ºç©ºåˆ™æŠ¥å¼‚å¸¸ã€‚</p>\n<h3 id=\"orElse\"><a href=\"#orElse\" class=\"headerlink\" title=\"orElse\"></a>orElse</h3><p>è¿”å›å½“å‰å€¼ï¼Œå¦‚æœä¸ºnullåˆ™è¿”å›otherã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public T orElse(T other) &#123;\n    return value !&#x3D; null ? value : other;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"orElseGet\"><a href=\"#orElseGet\" class=\"headerlink\" title=\"orElseGet\"></a>orElseGet</h3><p>orElseGetå’ŒorElseç±»ä¼¼ï¼Œåªæ˜¯orElseGetæ”¯æŒå‡½æ•°å¼æ¥å£æ¥ç”Ÿæˆotherå€¼ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public T orElseGet(Supplier&lt;? extends T&gt; other) &#123;\n    return value !&#x3D; null ? value : other.get();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"orElseThrow\"><a href=\"#orElseThrow\" class=\"headerlink\" title=\"orElseThrow\"></a>orElseThrow</h3><p>å¦‚æœæœ‰å€¼åˆ™è¿”å›ï¼Œæ²¡æœ‰åˆ™ç”¨å‡½æ•°å¼æ¥å£æŠ›å‡ºç”Ÿæˆçš„å¼‚å¸¸ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public &lt;X extends Throwable&gt; T orElseThrow(Supplier&lt;? extends X&gt; exceptionSupplier) throws X &#123;\n    if (value !&#x3D; null) &#123;\n        return value;\n    &#125; else &#123;\n        throw exceptionSupplier.get();\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"ç¤ºä¾‹\"><a href=\"#ç¤ºä¾‹\" class=\"headerlink\" title=\"ç¤ºä¾‹\"></a>ç¤ºä¾‹</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n\ttestOf();\n\ttestNullable();\n&#125;\n\n\nprivate static void testNullable() &#123;\n\tUser user &#x3D; null;\n\tUser john &#x3D; new User(&quot;john&quot;, 18);\n\tUser dick &#x3D; new User(&quot;dick&quot;, 12);\n\n\tSystem.out.println(Optional.ofNullable(user).orElse(john));\n\tSystem.out.println(Optional.ofNullable(john).get());\n\tSystem.out.println(Optional.ofNullable(dick).orElse(john));\n\tSystem.out.println(Optional.ofNullable(user).orElseGet(() -&gt; john));\n\n\tSystem.out.println();\n&#125;\n\nprivate static void testOf() &#123;\n\ttry &#123;\n\t\tUser user1 &#x3D; new User();\n\t\tOptional&lt;User&gt; userOptional1 &#x3D; Optional.of(user1);\n\t\tif (userOptional1.isPresent()) &#123;\n\t\t\tSystem.out.println(&quot;user is not null&quot;);\n\t\t&#125;\n\n\t\tUser user2 &#x3D; null;\n\t\tOptional&lt;User&gt; userOptional2 &#x3D; Optional.of(user2);&#x2F;&#x2F;NullPointerException\n\t\tif (userOptional2.isPresent()) &#123;\n\t\t\tSystem.out.println(&quot;user is not null&quot;);\n\t\t&#125;\n\t&#125; catch (Exception e) &#123;\n\t\te.printStackTrace();\n\t&#125;\n\tSystem.out.println();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><code>Optional</code>åœ¨jdk8ä¸­æœ‰å¤§é‡ä½¿ç”¨ï¼Œæ¯”å¦‚åƒStreamæµä¸­ï¼Œä½†<code>Optional</code>ç”¨åœ¨nullåˆ¤æ–­æ„Ÿè§‰ä¹Ÿæ²¡ä»€ä¹ˆé¸Ÿç”¨ã€‚ã€‚</p>\n<p>åœ¨Spring4ä¸­ä¹Ÿå¯ä»¥ç”¨Optionalæ¥ä»£æ›¿autowired(require&#x3D;false)çš„æƒ…å†µï¼Œå‚è€ƒå†å²Springç³»åˆ—æ–‡ç« ã€‚</p>\n","excerpt":"","more":"<h2 id=\"Optionalæ˜¯ä»€ä¹ˆ\"><a href=\"#Optionalæ˜¯ä»€ä¹ˆ\" class=\"headerlink\" title=\"Optionalæ˜¯ä»€ä¹ˆ\"></a>Optionalæ˜¯ä»€ä¹ˆ</h2><p><code>java.util.Optional</code></p>\n<p>Jdk8æä¾›<code>Optional</code>ï¼Œä¸€ä¸ªå¯ä»¥åŒ…å«nullå€¼çš„å®¹å™¨å¯¹è±¡ï¼Œå¯ä»¥ç”¨æ¥ä»£æ›¿xx !&#x3D; nullçš„åˆ¤æ–­ã€‚</p>\n<h2 id=\"Optionalå¸¸ç”¨æ–¹æ³•\"><a href=\"#Optionalå¸¸ç”¨æ–¹æ³•\" class=\"headerlink\" title=\"Optionalå¸¸ç”¨æ–¹æ³•\"></a>Optionalå¸¸ç”¨æ–¹æ³•</h2><h3 id=\"of\"><a href=\"#of\" class=\"headerlink\" title=\"of\"></a>of</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">public static &lt;T&gt; Optional&lt;T&gt; of(T value) &#123;\n    return new Optional&lt;&gt;(value);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ä¸ºvalueåˆ›å»ºä¸€ä¸ªOptionalå¯¹è±¡ï¼Œå¦‚æœvalueä¸ºç©ºåˆ™ ä¼šæŠ¥å‡ºNullPointerExceptionå¼‚å¸¸ã€‚</p>\n<h3 id=\"ofNullable\"><a href=\"#ofNullable\" class=\"headerlink\" title=\"ofNullable\"></a>ofNullable</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">public static &lt;T&gt; Optional&lt;T&gt; ofNullable(T value) &#123;\n    return value &#x3D;&#x3D; null ? empty() : of(value);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ä¸ºvalueåˆ›å»ºä¸€ä¸ªOptionalå¯¹è±¡ï¼Œä½†å¯ä»¥å…è®¸valueä¸ºnullå€¼ã€‚</p>\n<h3 id=\"isPresent\"><a href=\"#isPresent\" class=\"headerlink\" title=\"isPresent\"></a>isPresent</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">public boolean isPresent() &#123;\n    return value !&#x3D; null;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>åˆ¤æ–­å½“å‰valueæ˜¯å¦ä¸ºnull,å¦‚æœä¸ä¸ºnullåˆ™è¿”å›trueï¼Œå¦åˆ™falseã€‚</p>\n<h3 id=\"ifPresent\"><a href=\"#ifPresent\" class=\"headerlink\" title=\"ifPresent\"></a>ifPresent</h3><p>å¦‚æœä¸ä¸ºnullå€¼å°±æ‰§è¡Œå‡½æ•°å¼æ¥å£çš„å†…å®¹ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public void ifPresent(Consumer&lt;? super T&gt; consumer) &#123;\n    if (value !&#x3D; null)\n        consumer.accept(value);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"get\"><a href=\"#get\" class=\"headerlink\" title=\"get\"></a>get</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\">public T get() &#123;\n    if (value &#x3D;&#x3D; null) &#123;\n        throw new NoSuchElementException(&quot;No value present&quot;);\n    &#125;\n    return value;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿”å›å½“å‰çš„å€¼ï¼Œå¦‚æœä¸ºç©ºåˆ™æŠ¥å¼‚å¸¸ã€‚</p>\n<h3 id=\"orElse\"><a href=\"#orElse\" class=\"headerlink\" title=\"orElse\"></a>orElse</h3><p>è¿”å›å½“å‰å€¼ï¼Œå¦‚æœä¸ºnullåˆ™è¿”å›otherã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public T orElse(T other) &#123;\n    return value !&#x3D; null ? value : other;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"orElseGet\"><a href=\"#orElseGet\" class=\"headerlink\" title=\"orElseGet\"></a>orElseGet</h3><p>orElseGetå’ŒorElseç±»ä¼¼ï¼Œåªæ˜¯orElseGetæ”¯æŒå‡½æ•°å¼æ¥å£æ¥ç”Ÿæˆotherå€¼ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public T orElseGet(Supplier&lt;? extends T&gt; other) &#123;\n    return value !&#x3D; null ? value : other.get();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<h3 id=\"orElseThrow\"><a href=\"#orElseThrow\" class=\"headerlink\" title=\"orElseThrow\"></a>orElseThrow</h3><p>å¦‚æœæœ‰å€¼åˆ™è¿”å›ï¼Œæ²¡æœ‰åˆ™ç”¨å‡½æ•°å¼æ¥å£æŠ›å‡ºç”Ÿæˆçš„å¼‚å¸¸ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public &lt;X extends Throwable&gt; T orElseThrow(Supplier&lt;? extends X&gt; exceptionSupplier) throws X &#123;\n    if (value !&#x3D; null) &#123;\n        return value;\n    &#125; else &#123;\n        throw exceptionSupplier.get();\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"ç¤ºä¾‹\"><a href=\"#ç¤ºä¾‹\" class=\"headerlink\" title=\"ç¤ºä¾‹\"></a>ç¤ºä¾‹</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n\ttestOf();\n\ttestNullable();\n&#125;\n\n\nprivate static void testNullable() &#123;\n\tUser user &#x3D; null;\n\tUser john &#x3D; new User(&quot;john&quot;, 18);\n\tUser dick &#x3D; new User(&quot;dick&quot;, 12);\n\n\tSystem.out.println(Optional.ofNullable(user).orElse(john));\n\tSystem.out.println(Optional.ofNullable(john).get());\n\tSystem.out.println(Optional.ofNullable(dick).orElse(john));\n\tSystem.out.println(Optional.ofNullable(user).orElseGet(() -&gt; john));\n\n\tSystem.out.println();\n&#125;\n\nprivate static void testOf() &#123;\n\ttry &#123;\n\t\tUser user1 &#x3D; new User();\n\t\tOptional&lt;User&gt; userOptional1 &#x3D; Optional.of(user1);\n\t\tif (userOptional1.isPresent()) &#123;\n\t\t\tSystem.out.println(&quot;user is not null&quot;);\n\t\t&#125;\n\n\t\tUser user2 &#x3D; null;\n\t\tOptional&lt;User&gt; userOptional2 &#x3D; Optional.of(user2);&#x2F;&#x2F;NullPointerException\n\t\tif (userOptional2.isPresent()) &#123;\n\t\t\tSystem.out.println(&quot;user is not null&quot;);\n\t\t&#125;\n\t&#125; catch (Exception e) &#123;\n\t\te.printStackTrace();\n\t&#125;\n\tSystem.out.println();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><code>Optional</code>åœ¨jdk8ä¸­æœ‰å¤§é‡ä½¿ç”¨ï¼Œæ¯”å¦‚åƒStreamæµä¸­ï¼Œä½†<code>Optional</code>ç”¨åœ¨nullåˆ¤æ–­æ„Ÿè§‰ä¹Ÿæ²¡ä»€ä¹ˆé¸Ÿç”¨ã€‚ã€‚</p>\n<p>åœ¨Spring4ä¸­ä¹Ÿå¯ä»¥ç”¨Optionalæ¥ä»£æ›¿autowired(require&#x3D;false)çš„æƒ…å†µï¼Œå‚è€ƒå†å²Springç³»åˆ—æ–‡ç« ã€‚</p>\n"},{"title":"Java8 æ–°ç‰¹æ€§ä¹‹å‡½æ•°å¼æ¥å£","date":"2025-10-15T03:36:33.000Z","_content":"\n## ä»€ä¹ˆæ˜¯å‡½æ•°å¼æ¥å£\n\nå…ˆæ¥çœ‹çœ‹ä¼ ç»Ÿçš„åˆ›å»ºçº¿ç¨‹æ˜¯æ€ä¹ˆå†™çš„\n\n\n```\nThread t1 = new Thread(new Runnable() {\n\t@Override\n\tpublic void run() {\n\t\tSystem.out.println(\"t1\");\n\t}\n});\nt1.start();\n```\n\nå†æ¥çœ‹çœ‹ä½¿ç”¨äº†å‡½æ•°å¼æ¥å£æ˜¯æ€ä¹ˆå†™çš„\n\n\n```\nThread t2 = new Thread(() -> System.out.println(\"t2\"));\nt2.start();\n```\n\nRunnableæ¥å£ç›´æ¥å¯ä»¥ä½¿ç”¨Lambdaè¡¨è¾¾å¼æ¥ç¼–å†™ï¼Œè¿™æ˜¯å› ä¸ºRunnableæ¥å£æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œæ¥çœ‹çœ‹Runnableçš„æºç ã€‚\n\n```\n@FunctionalInterface\npublic interface Runnable {\n\n    public abstract void run();\n    \n}\n```\nå‘ç°è¯¥æ¥å£åŠ ä¸Šäº†å‡½æ•°å¼æ¥å£çš„å®šä¹‰æ³¨è§£ï¼š`@FunctionalInterface`ï¼Œè¡¨æ˜è¯¥æ¥å£æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ã€‚\n\n\n```\n@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.TYPE)\npublic @interface FunctionalInterface {\n    \n}\n```\n\n\nåœ¨JDK8ä¸­ï¼Œé™¤äº†Runnbaleæ¥å£ï¼Œè¿˜æœ‰åƒComparatorã€Callableç­‰æ¥å£éƒ½åŠ ä¸Šäº†è¯¥æ³¨è§£å®šä¹‰ä¸ºå‡½æ•°å¼æ¥å£ã€‚\n\n## å†…ç½®å‡½æ•°å¼æ¥å£\n\nJDK8æä¾›äº†å‡ ä¸ªå†…ç½®çš„å‡½æ•°å¼æ¥å£ï¼Œç”¨åœ¨äº†è®¸å¤šAPIçš„åœ°æ–¹ï¼Œéƒ½å¯ä»¥æ‹¿æ¥ç”¨ï¼Œå¯ä»¥æ»¡è¶³å¤§éƒ¨åˆ†åº”ç”¨ã€‚\n\n```\n//Consumer<T> - Tä½œä¸ºè¾“å…¥ï¼Œæ‰§è¡ŒæŸç§åŠ¨ä½œä½†æ²¡æœ‰è¿”å›å€¼\nConsumer<String> con = (x) -> {\n\tSystem.out.println(x);\n};\ncon.accept(\"hello world\");\n\n//Supplier<T> - æ²¡æœ‰ä»»ä½•è¾“å…¥ï¼Œè¿”å›T\nSupplier<String> supp = () -> {\n\treturn \"Supplier\";\n};\nSystem.out.println(supp.get());\n\n//Predicate<T> -Tä½œä¸ºè¾“å…¥ï¼Œè¿”å›çš„booleanå€¼ä½œä¸ºè¾“å‡º\nPredicate<String> pre = (x) -> {\n\tSystem.out.print(x);\n\treturn x.startsWith(\"op\");\n};\nSystem.out.println(\": \" + pre.test(\"op, hello World\"));\n\n// Function<T, R> -Tä½œä¸ºè¾“å…¥ï¼Œè¿”å›çš„Rä½œä¸ºè¾“å‡º\nFunction<String, String> function = (x) -> {\n\tSystem.out.print(x + \": \");\n\treturn \"Function\";\n};\nSystem.out.println(function.apply(\"hello world\"));\n\n//BinaryOperator<T> -ä¸¤ä¸ªTä½œä¸ºè¾“å…¥ï¼Œè¿”å›ä¸€ä¸ªTä½œä¸ºè¾“å‡ºï¼Œå¯¹äºâ€œreduceâ€æ“ä½œå¾ˆæœ‰ç”¨\nBinaryOperator<String> bina = (x, y) -> {\n\tSystem.out.print(x + \" \" + y);\n\treturn \"BinaryOperator\";\n};\nSystem.out.println(\"  \" + bina.apply(\"hello \", \"world\"));\n```\n\n\n\n## è‡ªå®šä¹‰å‡½æ•°å¼æ¥å£\n\n#### 1ã€è‡ªå®šä¹‰ä¸€ä¸ªå‡½æ•°å¼æ¥å£\n\n```\n@FunctionalInterface\npublic interface CalcInterface<N, V> {\t\n\tV operation(N n1, N n2);\n}\n```\n\nè¿™é‡Œåªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œ@FunctionalInterfaceæ³¨è§£å¯ä»¥ä¸ç”¨å†™ï¼Œè‡³äºä¸ºä»€ä¹ˆå¯ä»¥å¾€ä¸‹çœ‹ã€‚\n\n#### 2ã€æ–°å»ºä¸€ä¸ªå¼•ç”¨å‡½æ•°å¼æ¥å£çš„ç±»\n\n```\npublic static class NumberOperation<N extends Number, V extends Number> {\n\n\tprivate N n1;\n\tprivate N n2;\n\n\tpublic NumberOperation(N n1, N n2) {\n\t\tthis.n1 = n1;\n\t\tthis.n2 = n2;\n\t}\n\n\tpublic V calc(CalcInterface<N, V> ci) {\n\t\tV v = ci.operation(n1, n2);\n\t\treturn v;\n\t}\n\n}\n```\n\n#### 3ã€æµ‹è¯•å‡½æ•°å¼æ¥å£\n\n```\nprivate static void testOperationFnInterface() {\n        NumberOperation<Integer, Integer> np = new NumberOperation(13, 10);\n    \n\tCalcInterface<Integer, Integer> addOper1 = (n1, n2) -> {\n\t\treturn n1 + n2;\n\t};\n\tCalcInterface<Integer, Integer> multiOper1 = (n1, n2) -> {\n\t\treturn n1 * n2;\n\t};\n\tSystem.out.println(np.calc1(addOper1));\n\tSystem.out.println(np.calc1(multiOper1));\n\t\n\t// ä¸Šé¢çš„å¯ä»¥ç®€å†™ä¸º\n\tSystem.out.println(np.calc1((n1, n2) -> n1 + n2));\n\tSystem.out.println(np.calc1((n1, n2) -> n1 * n2));\n}\n```\n\næœ€åè¾“å‡ºï¼š\n\n```\n23\n130\n23\n130\n```\n\n## å‡½æ•°å¼æ¥å£è§„èŒƒ\n\n1ã€@FunctionalInterfaceæ ‡è¯†ä¸ºä¸€ä¸ªå‡½æ•°å¼æ¥å£åªèƒ½ç”¨åœ¨åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ä¸Šã€‚\n\n2ã€æ¥å£ä¸­çš„é™æ€æ–¹æ³•ã€é»˜è®¤æ–¹æ³•ã€è¦†ç›–äº†Objectç±»çš„æ–¹æ³•éƒ½ä¸ç®—æŠ½è±¡æ–¹æ³•ã€‚\n\n3ã€@FunctionalInterfaceæ³¨è§£ä¸æ˜¯å¿…é¡»çš„ï¼Œå¦‚æœè¯¥æ¥å£åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•å¯ä»¥ä¸å†™ï¼Œå®ƒé»˜è®¤å°±ç¬¦åˆå‡½æ•°å¼æ¥å£ï¼Œä½†å»ºè®®éƒ½å†™ä¸Šè¯¥æ³¨è§£ï¼Œç¼–è¯‘å™¨ä¼šæ£€æŸ¥è¯¥æ¥å£æ˜¯å¦ç¬¦åˆå‡½æ•°å¼æ¥å£çš„è§„èŒƒã€‚\n\n\n## ä¸¾ä¾‹è¯´æ˜\n\næ­£ç¡®çš„å‡½æ•°å¼æ¥å£ã€‚\n\n```\n@FunctionalInterface\npublic interface CalcInterface<N, V> {\t\n\tV operation(N n1, N n2);\n}\n```\n\nåŠ äº†å‡ ä¸ªç¬¦åˆå‡½æ•°å¼çš„æ–¹æ³•ä¹Ÿæ²¡äº‹ï¼Œç¼–è¯‘å™¨ä¹Ÿä¸ä¼šæŠ¥é”™ã€‚\n\n```\n@FunctionalInterface\npublic interface CalcInterface<N, V> {\t\t\n\n\tV operation(N n1, N n2);\n   \n\tpublic boolean equals(Object object);\n\n\tpublic default void defaultMethod() {\n\n\t}\n\n\tpublic static void staticMethod() {\n\n\t}\n}\n```\n\nè¿™ä¸ªæ²¡ç”¨@FunctionalInterfaceå‡½æ•°å¼æ¥å£ï¼Œæœ‰ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œä¸èƒ½ç”¨äºLambdaè¡¨è¾¾å¼ã€‚\n\n```\npublic interface CalcInterface<N, V> {\t\n\tV operation(N n1, N n2);\n\tV operation2(N n1, N n2);\n}\n```\n\nè¿™ä¸ªæœ‰ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•çš„ç”¨@FunctionalInterfaceæ³¨è§£çš„å‡½æ•°å¼æ¥å£ç¼–è¯‘ä¼šæŠ¥é”™ã€‚\n\n```\n@FunctionalInterface\npublic interface CalcInterface<N, V> {\t\n\tV operation(N n1, N n2);\n\tV operation2(N n1, N n2);\n}\n```\n\nè¿™ä¸ªæ²¡æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œç¼–è¯‘æŠ¥é”™ã€‚\n\n```\npublic interface CalcInterface<N, V> {\t\n}\n```\n","source":"_posts/æ–°ç‰¹æ€§/Java8/Java8 æ–°ç‰¹æ€§ä¹‹å‡½æ•°å¼æ¥å£.md","raw":"---\ntitle: Java8 æ–°ç‰¹æ€§ä¹‹å‡½æ•°å¼æ¥å£\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: æ–°ç‰¹æ€§\n---\n\n## ä»€ä¹ˆæ˜¯å‡½æ•°å¼æ¥å£\n\nå…ˆæ¥çœ‹çœ‹ä¼ ç»Ÿçš„åˆ›å»ºçº¿ç¨‹æ˜¯æ€ä¹ˆå†™çš„\n\n\n```\nThread t1 = new Thread(new Runnable() {\n\t@Override\n\tpublic void run() {\n\t\tSystem.out.println(\"t1\");\n\t}\n});\nt1.start();\n```\n\nå†æ¥çœ‹çœ‹ä½¿ç”¨äº†å‡½æ•°å¼æ¥å£æ˜¯æ€ä¹ˆå†™çš„\n\n\n```\nThread t2 = new Thread(() -> System.out.println(\"t2\"));\nt2.start();\n```\n\nRunnableæ¥å£ç›´æ¥å¯ä»¥ä½¿ç”¨Lambdaè¡¨è¾¾å¼æ¥ç¼–å†™ï¼Œè¿™æ˜¯å› ä¸ºRunnableæ¥å£æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œæ¥çœ‹çœ‹Runnableçš„æºç ã€‚\n\n```\n@FunctionalInterface\npublic interface Runnable {\n\n    public abstract void run();\n    \n}\n```\nå‘ç°è¯¥æ¥å£åŠ ä¸Šäº†å‡½æ•°å¼æ¥å£çš„å®šä¹‰æ³¨è§£ï¼š`@FunctionalInterface`ï¼Œè¡¨æ˜è¯¥æ¥å£æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ã€‚\n\n\n```\n@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.TYPE)\npublic @interface FunctionalInterface {\n    \n}\n```\n\n\nåœ¨JDK8ä¸­ï¼Œé™¤äº†Runnbaleæ¥å£ï¼Œè¿˜æœ‰åƒComparatorã€Callableç­‰æ¥å£éƒ½åŠ ä¸Šäº†è¯¥æ³¨è§£å®šä¹‰ä¸ºå‡½æ•°å¼æ¥å£ã€‚\n\n## å†…ç½®å‡½æ•°å¼æ¥å£\n\nJDK8æä¾›äº†å‡ ä¸ªå†…ç½®çš„å‡½æ•°å¼æ¥å£ï¼Œç”¨åœ¨äº†è®¸å¤šAPIçš„åœ°æ–¹ï¼Œéƒ½å¯ä»¥æ‹¿æ¥ç”¨ï¼Œå¯ä»¥æ»¡è¶³å¤§éƒ¨åˆ†åº”ç”¨ã€‚\n\n```\n//Consumer<T> - Tä½œä¸ºè¾“å…¥ï¼Œæ‰§è¡ŒæŸç§åŠ¨ä½œä½†æ²¡æœ‰è¿”å›å€¼\nConsumer<String> con = (x) -> {\n\tSystem.out.println(x);\n};\ncon.accept(\"hello world\");\n\n//Supplier<T> - æ²¡æœ‰ä»»ä½•è¾“å…¥ï¼Œè¿”å›T\nSupplier<String> supp = () -> {\n\treturn \"Supplier\";\n};\nSystem.out.println(supp.get());\n\n//Predicate<T> -Tä½œä¸ºè¾“å…¥ï¼Œè¿”å›çš„booleanå€¼ä½œä¸ºè¾“å‡º\nPredicate<String> pre = (x) -> {\n\tSystem.out.print(x);\n\treturn x.startsWith(\"op\");\n};\nSystem.out.println(\": \" + pre.test(\"op, hello World\"));\n\n// Function<T, R> -Tä½œä¸ºè¾“å…¥ï¼Œè¿”å›çš„Rä½œä¸ºè¾“å‡º\nFunction<String, String> function = (x) -> {\n\tSystem.out.print(x + \": \");\n\treturn \"Function\";\n};\nSystem.out.println(function.apply(\"hello world\"));\n\n//BinaryOperator<T> -ä¸¤ä¸ªTä½œä¸ºè¾“å…¥ï¼Œè¿”å›ä¸€ä¸ªTä½œä¸ºè¾“å‡ºï¼Œå¯¹äºâ€œreduceâ€æ“ä½œå¾ˆæœ‰ç”¨\nBinaryOperator<String> bina = (x, y) -> {\n\tSystem.out.print(x + \" \" + y);\n\treturn \"BinaryOperator\";\n};\nSystem.out.println(\"  \" + bina.apply(\"hello \", \"world\"));\n```\n\n\n\n## è‡ªå®šä¹‰å‡½æ•°å¼æ¥å£\n\n#### 1ã€è‡ªå®šä¹‰ä¸€ä¸ªå‡½æ•°å¼æ¥å£\n\n```\n@FunctionalInterface\npublic interface CalcInterface<N, V> {\t\n\tV operation(N n1, N n2);\n}\n```\n\nè¿™é‡Œåªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œ@FunctionalInterfaceæ³¨è§£å¯ä»¥ä¸ç”¨å†™ï¼Œè‡³äºä¸ºä»€ä¹ˆå¯ä»¥å¾€ä¸‹çœ‹ã€‚\n\n#### 2ã€æ–°å»ºä¸€ä¸ªå¼•ç”¨å‡½æ•°å¼æ¥å£çš„ç±»\n\n```\npublic static class NumberOperation<N extends Number, V extends Number> {\n\n\tprivate N n1;\n\tprivate N n2;\n\n\tpublic NumberOperation(N n1, N n2) {\n\t\tthis.n1 = n1;\n\t\tthis.n2 = n2;\n\t}\n\n\tpublic V calc(CalcInterface<N, V> ci) {\n\t\tV v = ci.operation(n1, n2);\n\t\treturn v;\n\t}\n\n}\n```\n\n#### 3ã€æµ‹è¯•å‡½æ•°å¼æ¥å£\n\n```\nprivate static void testOperationFnInterface() {\n        NumberOperation<Integer, Integer> np = new NumberOperation(13, 10);\n    \n\tCalcInterface<Integer, Integer> addOper1 = (n1, n2) -> {\n\t\treturn n1 + n2;\n\t};\n\tCalcInterface<Integer, Integer> multiOper1 = (n1, n2) -> {\n\t\treturn n1 * n2;\n\t};\n\tSystem.out.println(np.calc1(addOper1));\n\tSystem.out.println(np.calc1(multiOper1));\n\t\n\t// ä¸Šé¢çš„å¯ä»¥ç®€å†™ä¸º\n\tSystem.out.println(np.calc1((n1, n2) -> n1 + n2));\n\tSystem.out.println(np.calc1((n1, n2) -> n1 * n2));\n}\n```\n\næœ€åè¾“å‡ºï¼š\n\n```\n23\n130\n23\n130\n```\n\n## å‡½æ•°å¼æ¥å£è§„èŒƒ\n\n1ã€@FunctionalInterfaceæ ‡è¯†ä¸ºä¸€ä¸ªå‡½æ•°å¼æ¥å£åªèƒ½ç”¨åœ¨åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ä¸Šã€‚\n\n2ã€æ¥å£ä¸­çš„é™æ€æ–¹æ³•ã€é»˜è®¤æ–¹æ³•ã€è¦†ç›–äº†Objectç±»çš„æ–¹æ³•éƒ½ä¸ç®—æŠ½è±¡æ–¹æ³•ã€‚\n\n3ã€@FunctionalInterfaceæ³¨è§£ä¸æ˜¯å¿…é¡»çš„ï¼Œå¦‚æœè¯¥æ¥å£åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•å¯ä»¥ä¸å†™ï¼Œå®ƒé»˜è®¤å°±ç¬¦åˆå‡½æ•°å¼æ¥å£ï¼Œä½†å»ºè®®éƒ½å†™ä¸Šè¯¥æ³¨è§£ï¼Œç¼–è¯‘å™¨ä¼šæ£€æŸ¥è¯¥æ¥å£æ˜¯å¦ç¬¦åˆå‡½æ•°å¼æ¥å£çš„è§„èŒƒã€‚\n\n\n## ä¸¾ä¾‹è¯´æ˜\n\næ­£ç¡®çš„å‡½æ•°å¼æ¥å£ã€‚\n\n```\n@FunctionalInterface\npublic interface CalcInterface<N, V> {\t\n\tV operation(N n1, N n2);\n}\n```\n\nåŠ äº†å‡ ä¸ªç¬¦åˆå‡½æ•°å¼çš„æ–¹æ³•ä¹Ÿæ²¡äº‹ï¼Œç¼–è¯‘å™¨ä¹Ÿä¸ä¼šæŠ¥é”™ã€‚\n\n```\n@FunctionalInterface\npublic interface CalcInterface<N, V> {\t\t\n\n\tV operation(N n1, N n2);\n   \n\tpublic boolean equals(Object object);\n\n\tpublic default void defaultMethod() {\n\n\t}\n\n\tpublic static void staticMethod() {\n\n\t}\n}\n```\n\nè¿™ä¸ªæ²¡ç”¨@FunctionalInterfaceå‡½æ•°å¼æ¥å£ï¼Œæœ‰ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œä¸èƒ½ç”¨äºLambdaè¡¨è¾¾å¼ã€‚\n\n```\npublic interface CalcInterface<N, V> {\t\n\tV operation(N n1, N n2);\n\tV operation2(N n1, N n2);\n}\n```\n\nè¿™ä¸ªæœ‰ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•çš„ç”¨@FunctionalInterfaceæ³¨è§£çš„å‡½æ•°å¼æ¥å£ç¼–è¯‘ä¼šæŠ¥é”™ã€‚\n\n```\n@FunctionalInterface\npublic interface CalcInterface<N, V> {\t\n\tV operation(N n1, N n2);\n\tV operation2(N n1, N n2);\n}\n```\n\nè¿™ä¸ªæ²¡æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œç¼–è¯‘æŠ¥é”™ã€‚\n\n```\npublic interface CalcInterface<N, V> {\t\n}\n```\n","slug":"æ–°ç‰¹æ€§/Java8/Java8 æ–°ç‰¹æ€§ä¹‹å‡½æ•°å¼æ¥å£","published":1,"updated":"2025-10-15T07:20:51.515Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu0776005rqkd4aqhv9mgk","content":"<h2 id=\"ä»€ä¹ˆæ˜¯å‡½æ•°å¼æ¥å£\"><a href=\"#ä»€ä¹ˆæ˜¯å‡½æ•°å¼æ¥å£\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯å‡½æ•°å¼æ¥å£\"></a>ä»€ä¹ˆæ˜¯å‡½æ•°å¼æ¥å£</h2><p>å…ˆæ¥çœ‹çœ‹ä¼ ç»Ÿçš„åˆ›å»ºçº¿ç¨‹æ˜¯æ€ä¹ˆå†™çš„</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Thread t1 &#x3D; new Thread(new Runnable() &#123;\n\t@Override\n\tpublic void run() &#123;\n\t\tSystem.out.println(&quot;t1&quot;);\n\t&#125;\n&#125;);\nt1.start();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å†æ¥çœ‹çœ‹ä½¿ç”¨äº†å‡½æ•°å¼æ¥å£æ˜¯æ€ä¹ˆå†™çš„</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Thread t2 &#x3D; new Thread(() -&gt; System.out.println(&quot;t2&quot;));\nt2.start();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>Runnableæ¥å£ç›´æ¥å¯ä»¥ä½¿ç”¨Lambdaè¡¨è¾¾å¼æ¥ç¼–å†™ï¼Œè¿™æ˜¯å› ä¸ºRunnableæ¥å£æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œæ¥çœ‹çœ‹Runnableçš„æºç ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@FunctionalInterface\npublic interface Runnable &#123;\n\n    public abstract void run();\n    \n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>å‘ç°è¯¥æ¥å£åŠ ä¸Šäº†å‡½æ•°å¼æ¥å£çš„å®šä¹‰æ³¨è§£ï¼š<code>@FunctionalInterface</code>ï¼Œè¡¨æ˜è¯¥æ¥å£æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.TYPE)\npublic @interface FunctionalInterface &#123;\n    \n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n<p>åœ¨JDK8ä¸­ï¼Œé™¤äº†Runnbaleæ¥å£ï¼Œè¿˜æœ‰åƒComparatorã€Callableç­‰æ¥å£éƒ½åŠ ä¸Šäº†è¯¥æ³¨è§£å®šä¹‰ä¸ºå‡½æ•°å¼æ¥å£ã€‚</p>\n<h2 id=\"å†…ç½®å‡½æ•°å¼æ¥å£\"><a href=\"#å†…ç½®å‡½æ•°å¼æ¥å£\" class=\"headerlink\" title=\"å†…ç½®å‡½æ•°å¼æ¥å£\"></a>å†…ç½®å‡½æ•°å¼æ¥å£</h2><p>JDK8æä¾›äº†å‡ ä¸ªå†…ç½®çš„å‡½æ•°å¼æ¥å£ï¼Œç”¨åœ¨äº†è®¸å¤šAPIçš„åœ°æ–¹ï¼Œéƒ½å¯ä»¥æ‹¿æ¥ç”¨ï¼Œå¯ä»¥æ»¡è¶³å¤§éƒ¨åˆ†åº”ç”¨ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F;Consumer&lt;T&gt; - Tä½œä¸ºè¾“å…¥ï¼Œæ‰§è¡ŒæŸç§åŠ¨ä½œä½†æ²¡æœ‰è¿”å›å€¼\nConsumer&lt;String&gt; con &#x3D; (x) -&gt; &#123;\n\tSystem.out.println(x);\n&#125;;\ncon.accept(&quot;hello world&quot;);\n\n&#x2F;&#x2F;Supplier&lt;T&gt; - æ²¡æœ‰ä»»ä½•è¾“å…¥ï¼Œè¿”å›T\nSupplier&lt;String&gt; supp &#x3D; () -&gt; &#123;\n\treturn &quot;Supplier&quot;;\n&#125;;\nSystem.out.println(supp.get());\n\n&#x2F;&#x2F;Predicate&lt;T&gt; -Tä½œä¸ºè¾“å…¥ï¼Œè¿”å›çš„booleanå€¼ä½œä¸ºè¾“å‡º\nPredicate&lt;String&gt; pre &#x3D; (x) -&gt; &#123;\n\tSystem.out.print(x);\n\treturn x.startsWith(&quot;op&quot;);\n&#125;;\nSystem.out.println(&quot;: &quot; + pre.test(&quot;op, hello World&quot;));\n\n&#x2F;&#x2F; Function&lt;T, R&gt; -Tä½œä¸ºè¾“å…¥ï¼Œè¿”å›çš„Rä½œä¸ºè¾“å‡º\nFunction&lt;String, String&gt; function &#x3D; (x) -&gt; &#123;\n\tSystem.out.print(x + &quot;: &quot;);\n\treturn &quot;Function&quot;;\n&#125;;\nSystem.out.println(function.apply(&quot;hello world&quot;));\n\n&#x2F;&#x2F;BinaryOperator&lt;T&gt; -ä¸¤ä¸ªTä½œä¸ºè¾“å…¥ï¼Œè¿”å›ä¸€ä¸ªTä½œä¸ºè¾“å‡ºï¼Œå¯¹äºâ€œreduceâ€æ“ä½œå¾ˆæœ‰ç”¨\nBinaryOperator&lt;String&gt; bina &#x3D; (x, y) -&gt; &#123;\n\tSystem.out.print(x + &quot; &quot; + y);\n\treturn &quot;BinaryOperator&quot;;\n&#125;;\nSystem.out.println(&quot;  &quot; + bina.apply(&quot;hello &quot;, &quot;world&quot;));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n\n<h2 id=\"è‡ªå®šä¹‰å‡½æ•°å¼æ¥å£\"><a href=\"#è‡ªå®šä¹‰å‡½æ•°å¼æ¥å£\" class=\"headerlink\" title=\"è‡ªå®šä¹‰å‡½æ•°å¼æ¥å£\"></a>è‡ªå®šä¹‰å‡½æ•°å¼æ¥å£</h2><h4 id=\"1ã€è‡ªå®šä¹‰ä¸€ä¸ªå‡½æ•°å¼æ¥å£\"><a href=\"#1ã€è‡ªå®šä¹‰ä¸€ä¸ªå‡½æ•°å¼æ¥å£\" class=\"headerlink\" title=\"1ã€è‡ªå®šä¹‰ä¸€ä¸ªå‡½æ•°å¼æ¥å£\"></a>1ã€è‡ªå®šä¹‰ä¸€ä¸ªå‡½æ•°å¼æ¥å£</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">@FunctionalInterface\npublic interface CalcInterface&lt;N, V&gt; &#123;\t\n\tV operation(N n1, N n2);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™é‡Œåªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œ@FunctionalInterfaceæ³¨è§£å¯ä»¥ä¸ç”¨å†™ï¼Œè‡³äºä¸ºä»€ä¹ˆå¯ä»¥å¾€ä¸‹çœ‹ã€‚</p>\n<h4 id=\"2ã€æ–°å»ºä¸€ä¸ªå¼•ç”¨å‡½æ•°å¼æ¥å£çš„ç±»\"><a href=\"#2ã€æ–°å»ºä¸€ä¸ªå¼•ç”¨å‡½æ•°å¼æ¥å£çš„ç±»\" class=\"headerlink\" title=\"2ã€æ–°å»ºä¸€ä¸ªå¼•ç”¨å‡½æ•°å¼æ¥å£çš„ç±»\"></a>2ã€æ–°å»ºä¸€ä¸ªå¼•ç”¨å‡½æ•°å¼æ¥å£çš„ç±»</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">public static class NumberOperation&lt;N extends Number, V extends Number&gt; &#123;\n\n\tprivate N n1;\n\tprivate N n2;\n\n\tpublic NumberOperation(N n1, N n2) &#123;\n\t\tthis.n1 &#x3D; n1;\n\t\tthis.n2 &#x3D; n2;\n\t&#125;\n\n\tpublic V calc(CalcInterface&lt;N, V&gt; ci) &#123;\n\t\tV v &#x3D; ci.operation(n1, n2);\n\t\treturn v;\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"3ã€æµ‹è¯•å‡½æ•°å¼æ¥å£\"><a href=\"#3ã€æµ‹è¯•å‡½æ•°å¼æ¥å£\" class=\"headerlink\" title=\"3ã€æµ‹è¯•å‡½æ•°å¼æ¥å£\"></a>3ã€æµ‹è¯•å‡½æ•°å¼æ¥å£</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void testOperationFnInterface() &#123;\n        NumberOperation&lt;Integer, Integer&gt; np &#x3D; new NumberOperation(13, 10);\n    \n\tCalcInterface&lt;Integer, Integer&gt; addOper1 &#x3D; (n1, n2) -&gt; &#123;\n\t\treturn n1 + n2;\n\t&#125;;\n\tCalcInterface&lt;Integer, Integer&gt; multiOper1 &#x3D; (n1, n2) -&gt; &#123;\n\t\treturn n1 * n2;\n\t&#125;;\n\tSystem.out.println(np.calc1(addOper1));\n\tSystem.out.println(np.calc1(multiOper1));\n\t\n\t&#x2F;&#x2F; ä¸Šé¢çš„å¯ä»¥ç®€å†™ä¸º\n\tSystem.out.println(np.calc1((n1, n2) -&gt; n1 + n2));\n\tSystem.out.println(np.calc1((n1, n2) -&gt; n1 * n2));\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æœ€åè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">23\n130\n23\n130<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"å‡½æ•°å¼æ¥å£è§„èŒƒ\"><a href=\"#å‡½æ•°å¼æ¥å£è§„èŒƒ\" class=\"headerlink\" title=\"å‡½æ•°å¼æ¥å£è§„èŒƒ\"></a>å‡½æ•°å¼æ¥å£è§„èŒƒ</h2><p>1ã€@FunctionalInterfaceæ ‡è¯†ä¸ºä¸€ä¸ªå‡½æ•°å¼æ¥å£åªèƒ½ç”¨åœ¨åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ä¸Šã€‚</p>\n<p>2ã€æ¥å£ä¸­çš„é™æ€æ–¹æ³•ã€é»˜è®¤æ–¹æ³•ã€è¦†ç›–äº†Objectç±»çš„æ–¹æ³•éƒ½ä¸ç®—æŠ½è±¡æ–¹æ³•ã€‚</p>\n<p>3ã€@FunctionalInterfaceæ³¨è§£ä¸æ˜¯å¿…é¡»çš„ï¼Œå¦‚æœè¯¥æ¥å£åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•å¯ä»¥ä¸å†™ï¼Œå®ƒé»˜è®¤å°±ç¬¦åˆå‡½æ•°å¼æ¥å£ï¼Œä½†å»ºè®®éƒ½å†™ä¸Šè¯¥æ³¨è§£ï¼Œç¼–è¯‘å™¨ä¼šæ£€æŸ¥è¯¥æ¥å£æ˜¯å¦ç¬¦åˆå‡½æ•°å¼æ¥å£çš„è§„èŒƒã€‚</p>\n<h2 id=\"ä¸¾ä¾‹è¯´æ˜\"><a href=\"#ä¸¾ä¾‹è¯´æ˜\" class=\"headerlink\" title=\"ä¸¾ä¾‹è¯´æ˜\"></a>ä¸¾ä¾‹è¯´æ˜</h2><p>æ­£ç¡®çš„å‡½æ•°å¼æ¥å£ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@FunctionalInterface\npublic interface CalcInterface&lt;N, V&gt; &#123;\t\n\tV operation(N n1, N n2);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>åŠ äº†å‡ ä¸ªç¬¦åˆå‡½æ•°å¼çš„æ–¹æ³•ä¹Ÿæ²¡äº‹ï¼Œç¼–è¯‘å™¨ä¹Ÿä¸ä¼šæŠ¥é”™ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@FunctionalInterface\npublic interface CalcInterface&lt;N, V&gt; &#123;\t\t\n\n\tV operation(N n1, N n2);\n   \n\tpublic boolean equals(Object object);\n\n\tpublic default void defaultMethod() &#123;\n\n\t&#125;\n\n\tpublic static void staticMethod() &#123;\n\n\t&#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªæ²¡ç”¨@FunctionalInterfaceå‡½æ•°å¼æ¥å£ï¼Œæœ‰ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œä¸èƒ½ç”¨äºLambdaè¡¨è¾¾å¼ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public interface CalcInterface&lt;N, V&gt; &#123;\t\n\tV operation(N n1, N n2);\n\tV operation2(N n1, N n2);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªæœ‰ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•çš„ç”¨@FunctionalInterfaceæ³¨è§£çš„å‡½æ•°å¼æ¥å£ç¼–è¯‘ä¼šæŠ¥é”™ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@FunctionalInterface\npublic interface CalcInterface&lt;N, V&gt; &#123;\t\n\tV operation(N n1, N n2);\n\tV operation2(N n1, N n2);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªæ²¡æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œç¼–è¯‘æŠ¥é”™ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public interface CalcInterface&lt;N, V&gt; &#123;\t\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n","excerpt":"","more":"<h2 id=\"ä»€ä¹ˆæ˜¯å‡½æ•°å¼æ¥å£\"><a href=\"#ä»€ä¹ˆæ˜¯å‡½æ•°å¼æ¥å£\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯å‡½æ•°å¼æ¥å£\"></a>ä»€ä¹ˆæ˜¯å‡½æ•°å¼æ¥å£</h2><p>å…ˆæ¥çœ‹çœ‹ä¼ ç»Ÿçš„åˆ›å»ºçº¿ç¨‹æ˜¯æ€ä¹ˆå†™çš„</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Thread t1 &#x3D; new Thread(new Runnable() &#123;\n\t@Override\n\tpublic void run() &#123;\n\t\tSystem.out.println(&quot;t1&quot;);\n\t&#125;\n&#125;);\nt1.start();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å†æ¥çœ‹çœ‹ä½¿ç”¨äº†å‡½æ•°å¼æ¥å£æ˜¯æ€ä¹ˆå†™çš„</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Thread t2 &#x3D; new Thread(() -&gt; System.out.println(&quot;t2&quot;));\nt2.start();<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>Runnableæ¥å£ç›´æ¥å¯ä»¥ä½¿ç”¨Lambdaè¡¨è¾¾å¼æ¥ç¼–å†™ï¼Œè¿™æ˜¯å› ä¸ºRunnableæ¥å£æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œæ¥çœ‹çœ‹Runnableçš„æºç ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@FunctionalInterface\npublic interface Runnable &#123;\n\n    public abstract void run();\n    \n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>å‘ç°è¯¥æ¥å£åŠ ä¸Šäº†å‡½æ•°å¼æ¥å£çš„å®šä¹‰æ³¨è§£ï¼š<code>@FunctionalInterface</code>ï¼Œè¡¨æ˜è¯¥æ¥å£æ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.TYPE)\npublic @interface FunctionalInterface &#123;\n    \n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n<p>åœ¨JDK8ä¸­ï¼Œé™¤äº†Runnbaleæ¥å£ï¼Œè¿˜æœ‰åƒComparatorã€Callableç­‰æ¥å£éƒ½åŠ ä¸Šäº†è¯¥æ³¨è§£å®šä¹‰ä¸ºå‡½æ•°å¼æ¥å£ã€‚</p>\n<h2 id=\"å†…ç½®å‡½æ•°å¼æ¥å£\"><a href=\"#å†…ç½®å‡½æ•°å¼æ¥å£\" class=\"headerlink\" title=\"å†…ç½®å‡½æ•°å¼æ¥å£\"></a>å†…ç½®å‡½æ•°å¼æ¥å£</h2><p>JDK8æä¾›äº†å‡ ä¸ªå†…ç½®çš„å‡½æ•°å¼æ¥å£ï¼Œç”¨åœ¨äº†è®¸å¤šAPIçš„åœ°æ–¹ï¼Œéƒ½å¯ä»¥æ‹¿æ¥ç”¨ï¼Œå¯ä»¥æ»¡è¶³å¤§éƒ¨åˆ†åº”ç”¨ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F;Consumer&lt;T&gt; - Tä½œä¸ºè¾“å…¥ï¼Œæ‰§è¡ŒæŸç§åŠ¨ä½œä½†æ²¡æœ‰è¿”å›å€¼\nConsumer&lt;String&gt; con &#x3D; (x) -&gt; &#123;\n\tSystem.out.println(x);\n&#125;;\ncon.accept(&quot;hello world&quot;);\n\n&#x2F;&#x2F;Supplier&lt;T&gt; - æ²¡æœ‰ä»»ä½•è¾“å…¥ï¼Œè¿”å›T\nSupplier&lt;String&gt; supp &#x3D; () -&gt; &#123;\n\treturn &quot;Supplier&quot;;\n&#125;;\nSystem.out.println(supp.get());\n\n&#x2F;&#x2F;Predicate&lt;T&gt; -Tä½œä¸ºè¾“å…¥ï¼Œè¿”å›çš„booleanå€¼ä½œä¸ºè¾“å‡º\nPredicate&lt;String&gt; pre &#x3D; (x) -&gt; &#123;\n\tSystem.out.print(x);\n\treturn x.startsWith(&quot;op&quot;);\n&#125;;\nSystem.out.println(&quot;: &quot; + pre.test(&quot;op, hello World&quot;));\n\n&#x2F;&#x2F; Function&lt;T, R&gt; -Tä½œä¸ºè¾“å…¥ï¼Œè¿”å›çš„Rä½œä¸ºè¾“å‡º\nFunction&lt;String, String&gt; function &#x3D; (x) -&gt; &#123;\n\tSystem.out.print(x + &quot;: &quot;);\n\treturn &quot;Function&quot;;\n&#125;;\nSystem.out.println(function.apply(&quot;hello world&quot;));\n\n&#x2F;&#x2F;BinaryOperator&lt;T&gt; -ä¸¤ä¸ªTä½œä¸ºè¾“å…¥ï¼Œè¿”å›ä¸€ä¸ªTä½œä¸ºè¾“å‡ºï¼Œå¯¹äºâ€œreduceâ€æ“ä½œå¾ˆæœ‰ç”¨\nBinaryOperator&lt;String&gt; bina &#x3D; (x, y) -&gt; &#123;\n\tSystem.out.print(x + &quot; &quot; + y);\n\treturn &quot;BinaryOperator&quot;;\n&#125;;\nSystem.out.println(&quot;  &quot; + bina.apply(&quot;hello &quot;, &quot;world&quot;));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n\n\n<h2 id=\"è‡ªå®šä¹‰å‡½æ•°å¼æ¥å£\"><a href=\"#è‡ªå®šä¹‰å‡½æ•°å¼æ¥å£\" class=\"headerlink\" title=\"è‡ªå®šä¹‰å‡½æ•°å¼æ¥å£\"></a>è‡ªå®šä¹‰å‡½æ•°å¼æ¥å£</h2><h4 id=\"1ã€è‡ªå®šä¹‰ä¸€ä¸ªå‡½æ•°å¼æ¥å£\"><a href=\"#1ã€è‡ªå®šä¹‰ä¸€ä¸ªå‡½æ•°å¼æ¥å£\" class=\"headerlink\" title=\"1ã€è‡ªå®šä¹‰ä¸€ä¸ªå‡½æ•°å¼æ¥å£\"></a>1ã€è‡ªå®šä¹‰ä¸€ä¸ªå‡½æ•°å¼æ¥å£</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">@FunctionalInterface\npublic interface CalcInterface&lt;N, V&gt; &#123;\t\n\tV operation(N n1, N n2);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™é‡Œåªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œ@FunctionalInterfaceæ³¨è§£å¯ä»¥ä¸ç”¨å†™ï¼Œè‡³äºä¸ºä»€ä¹ˆå¯ä»¥å¾€ä¸‹çœ‹ã€‚</p>\n<h4 id=\"2ã€æ–°å»ºä¸€ä¸ªå¼•ç”¨å‡½æ•°å¼æ¥å£çš„ç±»\"><a href=\"#2ã€æ–°å»ºä¸€ä¸ªå¼•ç”¨å‡½æ•°å¼æ¥å£çš„ç±»\" class=\"headerlink\" title=\"2ã€æ–°å»ºä¸€ä¸ªå¼•ç”¨å‡½æ•°å¼æ¥å£çš„ç±»\"></a>2ã€æ–°å»ºä¸€ä¸ªå¼•ç”¨å‡½æ•°å¼æ¥å£çš„ç±»</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">public static class NumberOperation&lt;N extends Number, V extends Number&gt; &#123;\n\n\tprivate N n1;\n\tprivate N n2;\n\n\tpublic NumberOperation(N n1, N n2) &#123;\n\t\tthis.n1 &#x3D; n1;\n\t\tthis.n2 &#x3D; n2;\n\t&#125;\n\n\tpublic V calc(CalcInterface&lt;N, V&gt; ci) &#123;\n\t\tV v &#x3D; ci.operation(n1, n2);\n\t\treturn v;\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"3ã€æµ‹è¯•å‡½æ•°å¼æ¥å£\"><a href=\"#3ã€æµ‹è¯•å‡½æ•°å¼æ¥å£\" class=\"headerlink\" title=\"3ã€æµ‹è¯•å‡½æ•°å¼æ¥å£\"></a>3ã€æµ‹è¯•å‡½æ•°å¼æ¥å£</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void testOperationFnInterface() &#123;\n        NumberOperation&lt;Integer, Integer&gt; np &#x3D; new NumberOperation(13, 10);\n    \n\tCalcInterface&lt;Integer, Integer&gt; addOper1 &#x3D; (n1, n2) -&gt; &#123;\n\t\treturn n1 + n2;\n\t&#125;;\n\tCalcInterface&lt;Integer, Integer&gt; multiOper1 &#x3D; (n1, n2) -&gt; &#123;\n\t\treturn n1 * n2;\n\t&#125;;\n\tSystem.out.println(np.calc1(addOper1));\n\tSystem.out.println(np.calc1(multiOper1));\n\t\n\t&#x2F;&#x2F; ä¸Šé¢çš„å¯ä»¥ç®€å†™ä¸º\n\tSystem.out.println(np.calc1((n1, n2) -&gt; n1 + n2));\n\tSystem.out.println(np.calc1((n1, n2) -&gt; n1 * n2));\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æœ€åè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">23\n130\n23\n130<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"å‡½æ•°å¼æ¥å£è§„èŒƒ\"><a href=\"#å‡½æ•°å¼æ¥å£è§„èŒƒ\" class=\"headerlink\" title=\"å‡½æ•°å¼æ¥å£è§„èŒƒ\"></a>å‡½æ•°å¼æ¥å£è§„èŒƒ</h2><p>1ã€@FunctionalInterfaceæ ‡è¯†ä¸ºä¸€ä¸ªå‡½æ•°å¼æ¥å£åªèƒ½ç”¨åœ¨åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ä¸Šã€‚</p>\n<p>2ã€æ¥å£ä¸­çš„é™æ€æ–¹æ³•ã€é»˜è®¤æ–¹æ³•ã€è¦†ç›–äº†Objectç±»çš„æ–¹æ³•éƒ½ä¸ç®—æŠ½è±¡æ–¹æ³•ã€‚</p>\n<p>3ã€@FunctionalInterfaceæ³¨è§£ä¸æ˜¯å¿…é¡»çš„ï¼Œå¦‚æœè¯¥æ¥å£åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•å¯ä»¥ä¸å†™ï¼Œå®ƒé»˜è®¤å°±ç¬¦åˆå‡½æ•°å¼æ¥å£ï¼Œä½†å»ºè®®éƒ½å†™ä¸Šè¯¥æ³¨è§£ï¼Œç¼–è¯‘å™¨ä¼šæ£€æŸ¥è¯¥æ¥å£æ˜¯å¦ç¬¦åˆå‡½æ•°å¼æ¥å£çš„è§„èŒƒã€‚</p>\n<h2 id=\"ä¸¾ä¾‹è¯´æ˜\"><a href=\"#ä¸¾ä¾‹è¯´æ˜\" class=\"headerlink\" title=\"ä¸¾ä¾‹è¯´æ˜\"></a>ä¸¾ä¾‹è¯´æ˜</h2><p>æ­£ç¡®çš„å‡½æ•°å¼æ¥å£ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@FunctionalInterface\npublic interface CalcInterface&lt;N, V&gt; &#123;\t\n\tV operation(N n1, N n2);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>åŠ äº†å‡ ä¸ªç¬¦åˆå‡½æ•°å¼çš„æ–¹æ³•ä¹Ÿæ²¡äº‹ï¼Œç¼–è¯‘å™¨ä¹Ÿä¸ä¼šæŠ¥é”™ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@FunctionalInterface\npublic interface CalcInterface&lt;N, V&gt; &#123;\t\t\n\n\tV operation(N n1, N n2);\n   \n\tpublic boolean equals(Object object);\n\n\tpublic default void defaultMethod() &#123;\n\n\t&#125;\n\n\tpublic static void staticMethod() &#123;\n\n\t&#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªæ²¡ç”¨@FunctionalInterfaceå‡½æ•°å¼æ¥å£ï¼Œæœ‰ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œä¸èƒ½ç”¨äºLambdaè¡¨è¾¾å¼ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public interface CalcInterface&lt;N, V&gt; &#123;\t\n\tV operation(N n1, N n2);\n\tV operation2(N n1, N n2);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªæœ‰ä¸¤ä¸ªæŠ½è±¡æ–¹æ³•çš„ç”¨@FunctionalInterfaceæ³¨è§£çš„å‡½æ•°å¼æ¥å£ç¼–è¯‘ä¼šæŠ¥é”™ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@FunctionalInterface\npublic interface CalcInterface&lt;N, V&gt; &#123;\t\n\tV operation(N n1, N n2);\n\tV operation2(N n1, N n2);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªæ²¡æœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œç¼–è¯‘æŠ¥é”™ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public interface CalcInterface&lt;N, V&gt; &#123;\t\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n"},{"title":"Java8 æ–°ç‰¹æ€§ä¹‹æ–¹æ³•å¼•ç”¨","date":"2025-10-15T03:36:33.000Z","_content":"\n## ä»€ä¹ˆæ˜¯æ–¹æ³•å¼•ç”¨\n\næ–¹æ³•å¼•ç”¨æ˜¯åªéœ€è¦ä½¿ç”¨æ–¹æ³•çš„åå­—ï¼Œè€Œå…·ä½“è°ƒç”¨äº¤ç»™å‡½æ•°å¼æ¥å£ï¼Œéœ€è¦å’ŒLambdaè¡¨è¾¾å¼é…åˆä½¿ç”¨ã€‚\n\nå¦‚ï¼š\n\n\n```\nList<String> list = Arrays.asList(\"a\",\"b\",\"c\");\nlist.forEach(str -> System.out.print(str));\nlist.forEach(System.out::print);\n```\n\nä¸Šé¢ä¸¤ç§å†™æ³•æ˜¯ç­‰ä»·çš„ã€‚\n\n\n## æ–¹æ³•å¼•ç”¨åˆ†ç±»\n\n### 1ã€æ„é€ å™¨æ–¹æ³•å¼•ç”¨\n\næ ¼å¼ï¼š`Class::new`ï¼Œè°ƒç”¨é»˜è®¤æ„é€ å™¨ã€‚\n\n### 2ã€ç±»é™æ€æ–¹æ³•å¼•ç”¨\n\næ ¼å¼ï¼š`Class::static_method`\n\n### 3ã€ç±»æ™®é€šæ–¹æ³•å¼•ç”¨\n\næ ¼å¼ï¼š`Class::method`ï¼Œæ–¹æ³•ä¸èƒ½å¸¦å‚æ•°ã€‚\n\n### 4ã€å®ä¾‹æ–¹æ³•å¼•ç”¨\n\næ ¼å¼ï¼š`instance::method`\n\n## ç¤ºä¾‹\n\nå¾€Userç±»æ·»åŠ æ–¹æ³•å¼•ç”¨æ–¹æ³•ï¼š\n\n\n```\npublic static User create(Supplier<User> supplier){\n\treturn supplier.get();\n}\n\npublic static void updateUsername(User user){\n\tuser.setUsername(user.getUsername() + \" updated.\");\n}\n\npublic void updateAge(){\n\tthis.setAge(this.getAge() + 10);\n}\n\npublic void changeAge(User user){\n\tuser.setAge(user.getAge() + 10);\n}\n```\n\næ–¹æ³•å¼•ç”¨æµ‹è¯•ï¼š\n\n```\npublic static void main(String[] args) {\n\tList<User> list = initList();\n\n\t// 1ã€æ„é€ å™¨æ–¹æ³•å¼•ç”¨\n\tUser newUser = User.create(User::new);\n\tnewUser.setAge(1);\n\tnewUser.setUsername(\"new\");\n\tSystem.out.println(newUser);\n\n\t// 2ã€ç±»é™æ€æ–¹æ³•å¼•ç”¨\n\tlist.forEach(User::updateUsername);\n\n\t// 3ã€ç±»æ™®é€šæ–¹æ³•å¼•ç”¨\n\tlist.forEach(User::updateAge);\n\n\t// 4ã€å®ä¾‹æ–¹æ³•å¼•ç”¨\n\tUser user = new User();\n\tlist.forEach(user::changeAge);\n\n\tlist.forEach(System.out::println);\n}\n\nprivate static List<User> initList() {\n\tList<User> list = new ArrayList<>();\n\tlist.add(new User(\"oaby\", 23));\n\tlist.add(new User(\"tom\", 11));\n\tlist.add(new User(\"john\", 16));\n\tlist.add(new User(\"jennis\", 26));\n\tlist.add(new User(\"tin\", 26));\n\tlist.add(new User(\"army\", 26));\n\tlist.add(new User(\"mack\", 19));\n\tlist.add(new User(\"jobs\", 65));\n\tlist.add(new User(\"jordan\", 23));\n\treturn list;\n}\n```\nè¾“å‡ºç»“æœï¼š\n\n```\nUser [username=new, age=1]\nUser [username=oaby updated., age=43]\nUser [username=tom updated., age=31]\nUser [username=john updated., age=36]\nUser [username=jennis updated., age=46]\nUser [username=tin updated., age=46]\nUser [username=army updated., age=46]\nUser [username=mack updated., age=39]\nUser [username=jobs updated., age=85]\nUser [username=jordan updated., age=43]\n```\n\nå¯ä»¥çœ‹å‡ºæ–¹æ³•å¼•ç”¨éƒ½ç”Ÿæ•ˆäº†ï¼Œusernameå’Œageéƒ½ç›¸åº”æ›´æ–°äº†ã€‚\n","source":"_posts/æ–°ç‰¹æ€§/Java8/Java8 æ–°ç‰¹æ€§ä¹‹æ–¹æ³•å¼•ç”¨.md","raw":"---\ntitle: Java8 æ–°ç‰¹æ€§ä¹‹æ–¹æ³•å¼•ç”¨\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: æ–°ç‰¹æ€§\n---\n\n## ä»€ä¹ˆæ˜¯æ–¹æ³•å¼•ç”¨\n\næ–¹æ³•å¼•ç”¨æ˜¯åªéœ€è¦ä½¿ç”¨æ–¹æ³•çš„åå­—ï¼Œè€Œå…·ä½“è°ƒç”¨äº¤ç»™å‡½æ•°å¼æ¥å£ï¼Œéœ€è¦å’ŒLambdaè¡¨è¾¾å¼é…åˆä½¿ç”¨ã€‚\n\nå¦‚ï¼š\n\n\n```\nList<String> list = Arrays.asList(\"a\",\"b\",\"c\");\nlist.forEach(str -> System.out.print(str));\nlist.forEach(System.out::print);\n```\n\nä¸Šé¢ä¸¤ç§å†™æ³•æ˜¯ç­‰ä»·çš„ã€‚\n\n\n## æ–¹æ³•å¼•ç”¨åˆ†ç±»\n\n### 1ã€æ„é€ å™¨æ–¹æ³•å¼•ç”¨\n\næ ¼å¼ï¼š`Class::new`ï¼Œè°ƒç”¨é»˜è®¤æ„é€ å™¨ã€‚\n\n### 2ã€ç±»é™æ€æ–¹æ³•å¼•ç”¨\n\næ ¼å¼ï¼š`Class::static_method`\n\n### 3ã€ç±»æ™®é€šæ–¹æ³•å¼•ç”¨\n\næ ¼å¼ï¼š`Class::method`ï¼Œæ–¹æ³•ä¸èƒ½å¸¦å‚æ•°ã€‚\n\n### 4ã€å®ä¾‹æ–¹æ³•å¼•ç”¨\n\næ ¼å¼ï¼š`instance::method`\n\n## ç¤ºä¾‹\n\nå¾€Userç±»æ·»åŠ æ–¹æ³•å¼•ç”¨æ–¹æ³•ï¼š\n\n\n```\npublic static User create(Supplier<User> supplier){\n\treturn supplier.get();\n}\n\npublic static void updateUsername(User user){\n\tuser.setUsername(user.getUsername() + \" updated.\");\n}\n\npublic void updateAge(){\n\tthis.setAge(this.getAge() + 10);\n}\n\npublic void changeAge(User user){\n\tuser.setAge(user.getAge() + 10);\n}\n```\n\næ–¹æ³•å¼•ç”¨æµ‹è¯•ï¼š\n\n```\npublic static void main(String[] args) {\n\tList<User> list = initList();\n\n\t// 1ã€æ„é€ å™¨æ–¹æ³•å¼•ç”¨\n\tUser newUser = User.create(User::new);\n\tnewUser.setAge(1);\n\tnewUser.setUsername(\"new\");\n\tSystem.out.println(newUser);\n\n\t// 2ã€ç±»é™æ€æ–¹æ³•å¼•ç”¨\n\tlist.forEach(User::updateUsername);\n\n\t// 3ã€ç±»æ™®é€šæ–¹æ³•å¼•ç”¨\n\tlist.forEach(User::updateAge);\n\n\t// 4ã€å®ä¾‹æ–¹æ³•å¼•ç”¨\n\tUser user = new User();\n\tlist.forEach(user::changeAge);\n\n\tlist.forEach(System.out::println);\n}\n\nprivate static List<User> initList() {\n\tList<User> list = new ArrayList<>();\n\tlist.add(new User(\"oaby\", 23));\n\tlist.add(new User(\"tom\", 11));\n\tlist.add(new User(\"john\", 16));\n\tlist.add(new User(\"jennis\", 26));\n\tlist.add(new User(\"tin\", 26));\n\tlist.add(new User(\"army\", 26));\n\tlist.add(new User(\"mack\", 19));\n\tlist.add(new User(\"jobs\", 65));\n\tlist.add(new User(\"jordan\", 23));\n\treturn list;\n}\n```\nè¾“å‡ºç»“æœï¼š\n\n```\nUser [username=new, age=1]\nUser [username=oaby updated., age=43]\nUser [username=tom updated., age=31]\nUser [username=john updated., age=36]\nUser [username=jennis updated., age=46]\nUser [username=tin updated., age=46]\nUser [username=army updated., age=46]\nUser [username=mack updated., age=39]\nUser [username=jobs updated., age=85]\nUser [username=jordan updated., age=43]\n```\n\nå¯ä»¥çœ‹å‡ºæ–¹æ³•å¼•ç”¨éƒ½ç”Ÿæ•ˆäº†ï¼Œusernameå’Œageéƒ½ç›¸åº”æ›´æ–°äº†ã€‚\n","slug":"æ–°ç‰¹æ€§/Java8/Java8 æ–°ç‰¹æ€§ä¹‹æ–¹æ³•å¼•ç”¨","published":1,"updated":"2025-10-15T07:20:51.389Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu0776005uqkd4b4172lae","content":"<h2 id=\"ä»€ä¹ˆæ˜¯æ–¹æ³•å¼•ç”¨\"><a href=\"#ä»€ä¹ˆæ˜¯æ–¹æ³•å¼•ç”¨\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯æ–¹æ³•å¼•ç”¨\"></a>ä»€ä¹ˆæ˜¯æ–¹æ³•å¼•ç”¨</h2><p>æ–¹æ³•å¼•ç”¨æ˜¯åªéœ€è¦ä½¿ç”¨æ–¹æ³•çš„åå­—ï¼Œè€Œå…·ä½“è°ƒç”¨äº¤ç»™å‡½æ•°å¼æ¥å£ï¼Œéœ€è¦å’ŒLambdaè¡¨è¾¾å¼é…åˆä½¿ç”¨ã€‚</p>\n<p>å¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;String&gt; list &#x3D; Arrays.asList(&quot;a&quot;,&quot;b&quot;,&quot;c&quot;);\nlist.forEach(str -&gt; System.out.print(str));\nlist.forEach(System.out::print);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ä¸Šé¢ä¸¤ç§å†™æ³•æ˜¯ç­‰ä»·çš„ã€‚</p>\n<h2 id=\"æ–¹æ³•å¼•ç”¨åˆ†ç±»\"><a href=\"#æ–¹æ³•å¼•ç”¨åˆ†ç±»\" class=\"headerlink\" title=\"æ–¹æ³•å¼•ç”¨åˆ†ç±»\"></a>æ–¹æ³•å¼•ç”¨åˆ†ç±»</h2><h3 id=\"1ã€æ„é€ å™¨æ–¹æ³•å¼•ç”¨\"><a href=\"#1ã€æ„é€ å™¨æ–¹æ³•å¼•ç”¨\" class=\"headerlink\" title=\"1ã€æ„é€ å™¨æ–¹æ³•å¼•ç”¨\"></a>1ã€æ„é€ å™¨æ–¹æ³•å¼•ç”¨</h3><p>æ ¼å¼ï¼š<code>Class::new</code>ï¼Œè°ƒç”¨é»˜è®¤æ„é€ å™¨ã€‚</p>\n<h3 id=\"2ã€ç±»é™æ€æ–¹æ³•å¼•ç”¨\"><a href=\"#2ã€ç±»é™æ€æ–¹æ³•å¼•ç”¨\" class=\"headerlink\" title=\"2ã€ç±»é™æ€æ–¹æ³•å¼•ç”¨\"></a>2ã€ç±»é™æ€æ–¹æ³•å¼•ç”¨</h3><p>æ ¼å¼ï¼š<code>Class::static_method</code></p>\n<h3 id=\"3ã€ç±»æ™®é€šæ–¹æ³•å¼•ç”¨\"><a href=\"#3ã€ç±»æ™®é€šæ–¹æ³•å¼•ç”¨\" class=\"headerlink\" title=\"3ã€ç±»æ™®é€šæ–¹æ³•å¼•ç”¨\"></a>3ã€ç±»æ™®é€šæ–¹æ³•å¼•ç”¨</h3><p>æ ¼å¼ï¼š<code>Class::method</code>ï¼Œæ–¹æ³•ä¸èƒ½å¸¦å‚æ•°ã€‚</p>\n<h3 id=\"4ã€å®ä¾‹æ–¹æ³•å¼•ç”¨\"><a href=\"#4ã€å®ä¾‹æ–¹æ³•å¼•ç”¨\" class=\"headerlink\" title=\"4ã€å®ä¾‹æ–¹æ³•å¼•ç”¨\"></a>4ã€å®ä¾‹æ–¹æ³•å¼•ç”¨</h3><p>æ ¼å¼ï¼š<code>instance::method</code></p>\n<h2 id=\"ç¤ºä¾‹\"><a href=\"#ç¤ºä¾‹\" class=\"headerlink\" title=\"ç¤ºä¾‹\"></a>ç¤ºä¾‹</h2><p>å¾€Userç±»æ·»åŠ æ–¹æ³•å¼•ç”¨æ–¹æ³•ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static User create(Supplier&lt;User&gt; supplier)&#123;\n\treturn supplier.get();\n&#125;\n\npublic static void updateUsername(User user)&#123;\n\tuser.setUsername(user.getUsername() + &quot; updated.&quot;);\n&#125;\n\npublic void updateAge()&#123;\n\tthis.setAge(this.getAge() + 10);\n&#125;\n\npublic void changeAge(User user)&#123;\n\tuser.setAge(user.getAge() + 10);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ–¹æ³•å¼•ç”¨æµ‹è¯•ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n\tList&lt;User&gt; list &#x3D; initList();\n\n\t&#x2F;&#x2F; 1ã€æ„é€ å™¨æ–¹æ³•å¼•ç”¨\n\tUser newUser &#x3D; User.create(User::new);\n\tnewUser.setAge(1);\n\tnewUser.setUsername(&quot;new&quot;);\n\tSystem.out.println(newUser);\n\n\t&#x2F;&#x2F; 2ã€ç±»é™æ€æ–¹æ³•å¼•ç”¨\n\tlist.forEach(User::updateUsername);\n\n\t&#x2F;&#x2F; 3ã€ç±»æ™®é€šæ–¹æ³•å¼•ç”¨\n\tlist.forEach(User::updateAge);\n\n\t&#x2F;&#x2F; 4ã€å®ä¾‹æ–¹æ³•å¼•ç”¨\n\tUser user &#x3D; new User();\n\tlist.forEach(user::changeAge);\n\n\tlist.forEach(System.out::println);\n&#125;\n\nprivate static List&lt;User&gt; initList() &#123;\n\tList&lt;User&gt; list &#x3D; new ArrayList&lt;&gt;();\n\tlist.add(new User(&quot;oaby&quot;, 23));\n\tlist.add(new User(&quot;tom&quot;, 11));\n\tlist.add(new User(&quot;john&quot;, 16));\n\tlist.add(new User(&quot;jennis&quot;, 26));\n\tlist.add(new User(&quot;tin&quot;, 26));\n\tlist.add(new User(&quot;army&quot;, 26));\n\tlist.add(new User(&quot;mack&quot;, 19));\n\tlist.add(new User(&quot;jobs&quot;, 65));\n\tlist.add(new User(&quot;jordan&quot;, 23));\n\treturn list;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>è¾“å‡ºç»“æœï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">User [username&#x3D;new, age&#x3D;1]\nUser [username&#x3D;oaby updated., age&#x3D;43]\nUser [username&#x3D;tom updated., age&#x3D;31]\nUser [username&#x3D;john updated., age&#x3D;36]\nUser [username&#x3D;jennis updated., age&#x3D;46]\nUser [username&#x3D;tin updated., age&#x3D;46]\nUser [username&#x3D;army updated., age&#x3D;46]\nUser [username&#x3D;mack updated., age&#x3D;39]\nUser [username&#x3D;jobs updated., age&#x3D;85]\nUser [username&#x3D;jordan updated., age&#x3D;43]<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥çœ‹å‡ºæ–¹æ³•å¼•ç”¨éƒ½ç”Ÿæ•ˆäº†ï¼Œusernameå’Œageéƒ½ç›¸åº”æ›´æ–°äº†ã€‚</p>\n","excerpt":"","more":"<h2 id=\"ä»€ä¹ˆæ˜¯æ–¹æ³•å¼•ç”¨\"><a href=\"#ä»€ä¹ˆæ˜¯æ–¹æ³•å¼•ç”¨\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯æ–¹æ³•å¼•ç”¨\"></a>ä»€ä¹ˆæ˜¯æ–¹æ³•å¼•ç”¨</h2><p>æ–¹æ³•å¼•ç”¨æ˜¯åªéœ€è¦ä½¿ç”¨æ–¹æ³•çš„åå­—ï¼Œè€Œå…·ä½“è°ƒç”¨äº¤ç»™å‡½æ•°å¼æ¥å£ï¼Œéœ€è¦å’ŒLambdaè¡¨è¾¾å¼é…åˆä½¿ç”¨ã€‚</p>\n<p>å¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;String&gt; list &#x3D; Arrays.asList(&quot;a&quot;,&quot;b&quot;,&quot;c&quot;);\nlist.forEach(str -&gt; System.out.print(str));\nlist.forEach(System.out::print);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ä¸Šé¢ä¸¤ç§å†™æ³•æ˜¯ç­‰ä»·çš„ã€‚</p>\n<h2 id=\"æ–¹æ³•å¼•ç”¨åˆ†ç±»\"><a href=\"#æ–¹æ³•å¼•ç”¨åˆ†ç±»\" class=\"headerlink\" title=\"æ–¹æ³•å¼•ç”¨åˆ†ç±»\"></a>æ–¹æ³•å¼•ç”¨åˆ†ç±»</h2><h3 id=\"1ã€æ„é€ å™¨æ–¹æ³•å¼•ç”¨\"><a href=\"#1ã€æ„é€ å™¨æ–¹æ³•å¼•ç”¨\" class=\"headerlink\" title=\"1ã€æ„é€ å™¨æ–¹æ³•å¼•ç”¨\"></a>1ã€æ„é€ å™¨æ–¹æ³•å¼•ç”¨</h3><p>æ ¼å¼ï¼š<code>Class::new</code>ï¼Œè°ƒç”¨é»˜è®¤æ„é€ å™¨ã€‚</p>\n<h3 id=\"2ã€ç±»é™æ€æ–¹æ³•å¼•ç”¨\"><a href=\"#2ã€ç±»é™æ€æ–¹æ³•å¼•ç”¨\" class=\"headerlink\" title=\"2ã€ç±»é™æ€æ–¹æ³•å¼•ç”¨\"></a>2ã€ç±»é™æ€æ–¹æ³•å¼•ç”¨</h3><p>æ ¼å¼ï¼š<code>Class::static_method</code></p>\n<h3 id=\"3ã€ç±»æ™®é€šæ–¹æ³•å¼•ç”¨\"><a href=\"#3ã€ç±»æ™®é€šæ–¹æ³•å¼•ç”¨\" class=\"headerlink\" title=\"3ã€ç±»æ™®é€šæ–¹æ³•å¼•ç”¨\"></a>3ã€ç±»æ™®é€šæ–¹æ³•å¼•ç”¨</h3><p>æ ¼å¼ï¼š<code>Class::method</code>ï¼Œæ–¹æ³•ä¸èƒ½å¸¦å‚æ•°ã€‚</p>\n<h3 id=\"4ã€å®ä¾‹æ–¹æ³•å¼•ç”¨\"><a href=\"#4ã€å®ä¾‹æ–¹æ³•å¼•ç”¨\" class=\"headerlink\" title=\"4ã€å®ä¾‹æ–¹æ³•å¼•ç”¨\"></a>4ã€å®ä¾‹æ–¹æ³•å¼•ç”¨</h3><p>æ ¼å¼ï¼š<code>instance::method</code></p>\n<h2 id=\"ç¤ºä¾‹\"><a href=\"#ç¤ºä¾‹\" class=\"headerlink\" title=\"ç¤ºä¾‹\"></a>ç¤ºä¾‹</h2><p>å¾€Userç±»æ·»åŠ æ–¹æ³•å¼•ç”¨æ–¹æ³•ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static User create(Supplier&lt;User&gt; supplier)&#123;\n\treturn supplier.get();\n&#125;\n\npublic static void updateUsername(User user)&#123;\n\tuser.setUsername(user.getUsername() + &quot; updated.&quot;);\n&#125;\n\npublic void updateAge()&#123;\n\tthis.setAge(this.getAge() + 10);\n&#125;\n\npublic void changeAge(User user)&#123;\n\tuser.setAge(user.getAge() + 10);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ–¹æ³•å¼•ç”¨æµ‹è¯•ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n\tList&lt;User&gt; list &#x3D; initList();\n\n\t&#x2F;&#x2F; 1ã€æ„é€ å™¨æ–¹æ³•å¼•ç”¨\n\tUser newUser &#x3D; User.create(User::new);\n\tnewUser.setAge(1);\n\tnewUser.setUsername(&quot;new&quot;);\n\tSystem.out.println(newUser);\n\n\t&#x2F;&#x2F; 2ã€ç±»é™æ€æ–¹æ³•å¼•ç”¨\n\tlist.forEach(User::updateUsername);\n\n\t&#x2F;&#x2F; 3ã€ç±»æ™®é€šæ–¹æ³•å¼•ç”¨\n\tlist.forEach(User::updateAge);\n\n\t&#x2F;&#x2F; 4ã€å®ä¾‹æ–¹æ³•å¼•ç”¨\n\tUser user &#x3D; new User();\n\tlist.forEach(user::changeAge);\n\n\tlist.forEach(System.out::println);\n&#125;\n\nprivate static List&lt;User&gt; initList() &#123;\n\tList&lt;User&gt; list &#x3D; new ArrayList&lt;&gt;();\n\tlist.add(new User(&quot;oaby&quot;, 23));\n\tlist.add(new User(&quot;tom&quot;, 11));\n\tlist.add(new User(&quot;john&quot;, 16));\n\tlist.add(new User(&quot;jennis&quot;, 26));\n\tlist.add(new User(&quot;tin&quot;, 26));\n\tlist.add(new User(&quot;army&quot;, 26));\n\tlist.add(new User(&quot;mack&quot;, 19));\n\tlist.add(new User(&quot;jobs&quot;, 65));\n\tlist.add(new User(&quot;jordan&quot;, 23));\n\treturn list;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>è¾“å‡ºç»“æœï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">User [username&#x3D;new, age&#x3D;1]\nUser [username&#x3D;oaby updated., age&#x3D;43]\nUser [username&#x3D;tom updated., age&#x3D;31]\nUser [username&#x3D;john updated., age&#x3D;36]\nUser [username&#x3D;jennis updated., age&#x3D;46]\nUser [username&#x3D;tin updated., age&#x3D;46]\nUser [username&#x3D;army updated., age&#x3D;46]\nUser [username&#x3D;mack updated., age&#x3D;39]\nUser [username&#x3D;jobs updated., age&#x3D;85]\nUser [username&#x3D;jordan updated., age&#x3D;43]<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥çœ‹å‡ºæ–¹æ³•å¼•ç”¨éƒ½ç”Ÿæ•ˆäº†ï¼Œusernameå’Œageéƒ½ç›¸åº”æ›´æ–°äº†ã€‚</p>\n"},{"title":"Java8 æ–°ç‰¹æ€§ä¹‹æ¥å£é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•","date":"2025-10-15T03:36:33.000Z","_content":"\n## æ¥å£é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•\n\næœ‰è¿™æ ·ä¸€äº›åœºæ™¯ï¼Œå¦‚æœä¸€ä¸ªæ¥å£è¦æ·»åŠ ä¸€ä¸ªæ–¹æ³•ï¼Œé‚£æ‰€æœ‰çš„æ¥å£å®ç°ç±»éƒ½è¦å»å®ç°ï¼Œè€ŒæŸäº›å®ç°ç±»æ ¹æœ¬å°±ä¸éœ€è¦å®ç°è¿™ä¸ªæ–¹æ³•ä¹Ÿè¦å†™ä¸€ä¸ªç©ºå®ç°ï¼Œæ‰€ä»¥æ¥å£é»˜è®¤æ–¹æ³•å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\n\næ¥å£é™æ€æ–¹æ³•ç±»ä¼¼äºé»˜è®¤æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸èƒ½åœ¨å®ç°ç±»ä¸­è¦†ç›–å®ƒä»¬ï¼Œå¯ä»¥é¿å…é»˜è®¤æ–¹æ³•åœ¨å®ç°ç±»ä¸­è¢«è¦†ç›–å®ç°ã€‚\n\nä¹‹å‰è®²è¿‡çš„JDK8çš„list.foreacheæ–¹æ³•ï¼Œçœ‹ä¸‹æºç ï¼Œå…¶å®ä¹Ÿæ˜¯java.lang.Iterableæ¥å£çš„é»˜è®¤æ–¹æ³•ã€‚\n\n```\ndefault void forEach(Consumer<? super T> action) {\n    Objects.requireNonNull(action);\n    for (T t : this) {\n        action.accept(t);\n    }\n}\n```\n\n## ç®€å•çš„ä¾‹å­\n\né»˜è®¤æ–¹æ³•ä»¥`default`ä¿®é¥°ï¼Œé™æ€æ–¹æ³•ç”¨`static`ã€‚\n\n```\npublic static void main(String[] args) {\n\tIUserInterface userInterface = new UserServiceImpl();\n\tSystem.out.println(userInterface.getDefaultUser1());\n\tSystem.out.println(IUserInterface.getDefaultUser2());\n}\n\ninterface IUserInterface {\n\n\tdefault User getDefaultUser1() {\n\t\treturn new User(\"Susan1\", 11);\n\t}\n\n\tstatic User getDefaultUser2() {\n\t\treturn new User(\"Susan2\", 22);\n\t}\n\n}\n\nstatic class UserServiceImpl implements IUserInterface {\n\n}\n```\n\n## æ³¨æ„è¦ç‚¹\n\n1ã€æ¥å£é»˜è®¤æ–¹æ³•ã€é™æ€æ–¹æ³•å¯ä»¥æœ‰å¤šä¸ªã€‚\n\n2ã€é»˜è®¤æ–¹æ³•é€šè¿‡å®ä¾‹è°ƒç”¨ï¼Œé™æ€æ–¹æ³•é€šè¿‡æ¥å£åè°ƒç”¨ã€‚\n\n3ã€`default`é»˜è®¤æ–¹æ³•å…³é”®å­—åªèƒ½ç”¨åœ¨æ¥å£ä¸­ã€‚\n\n4ã€é»˜è®¤æ–¹æ³•å¯ä»¥è¢«ç»§æ‰¿ï¼Œå¦‚æœç»§æ‰¿äº†å¤šä¸ªæ¥å£ï¼Œå¤šä¸ªæ¥å£éƒ½å®šä¹‰äº†å¤šä¸ªåŒæ ·çš„é»˜è®¤æ–¹æ³•ï¼Œå®ç°ç±»éœ€è¦é‡å†™é»˜è®¤æ–¹æ³•ä¸ç„¶ä¼šæŠ¥é”™ã€‚\n\n5ã€é™æ€æ–¹æ³•ä¸èƒ½è¢«ç»§æ‰¿åŠè¦†ç›–ï¼Œæ‰€ä»¥åªè¢«å…·ä½“æ‰€åœ¨çš„æ¥å£è°ƒç”¨ã€‚\n\n\n\n\n\n","source":"_posts/æ–°ç‰¹æ€§/Java8/Java8 æ–°ç‰¹æ€§ä¹‹æ¥å£é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•.md","raw":"---\ntitle: Java8 æ–°ç‰¹æ€§ä¹‹æ¥å£é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: æ–°ç‰¹æ€§\n---\n\n## æ¥å£é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•\n\næœ‰è¿™æ ·ä¸€äº›åœºæ™¯ï¼Œå¦‚æœä¸€ä¸ªæ¥å£è¦æ·»åŠ ä¸€ä¸ªæ–¹æ³•ï¼Œé‚£æ‰€æœ‰çš„æ¥å£å®ç°ç±»éƒ½è¦å»å®ç°ï¼Œè€ŒæŸäº›å®ç°ç±»æ ¹æœ¬å°±ä¸éœ€è¦å®ç°è¿™ä¸ªæ–¹æ³•ä¹Ÿè¦å†™ä¸€ä¸ªç©ºå®ç°ï¼Œæ‰€ä»¥æ¥å£é»˜è®¤æ–¹æ³•å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚\n\næ¥å£é™æ€æ–¹æ³•ç±»ä¼¼äºé»˜è®¤æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸èƒ½åœ¨å®ç°ç±»ä¸­è¦†ç›–å®ƒä»¬ï¼Œå¯ä»¥é¿å…é»˜è®¤æ–¹æ³•åœ¨å®ç°ç±»ä¸­è¢«è¦†ç›–å®ç°ã€‚\n\nä¹‹å‰è®²è¿‡çš„JDK8çš„list.foreacheæ–¹æ³•ï¼Œçœ‹ä¸‹æºç ï¼Œå…¶å®ä¹Ÿæ˜¯java.lang.Iterableæ¥å£çš„é»˜è®¤æ–¹æ³•ã€‚\n\n```\ndefault void forEach(Consumer<? super T> action) {\n    Objects.requireNonNull(action);\n    for (T t : this) {\n        action.accept(t);\n    }\n}\n```\n\n## ç®€å•çš„ä¾‹å­\n\né»˜è®¤æ–¹æ³•ä»¥`default`ä¿®é¥°ï¼Œé™æ€æ–¹æ³•ç”¨`static`ã€‚\n\n```\npublic static void main(String[] args) {\n\tIUserInterface userInterface = new UserServiceImpl();\n\tSystem.out.println(userInterface.getDefaultUser1());\n\tSystem.out.println(IUserInterface.getDefaultUser2());\n}\n\ninterface IUserInterface {\n\n\tdefault User getDefaultUser1() {\n\t\treturn new User(\"Susan1\", 11);\n\t}\n\n\tstatic User getDefaultUser2() {\n\t\treturn new User(\"Susan2\", 22);\n\t}\n\n}\n\nstatic class UserServiceImpl implements IUserInterface {\n\n}\n```\n\n## æ³¨æ„è¦ç‚¹\n\n1ã€æ¥å£é»˜è®¤æ–¹æ³•ã€é™æ€æ–¹æ³•å¯ä»¥æœ‰å¤šä¸ªã€‚\n\n2ã€é»˜è®¤æ–¹æ³•é€šè¿‡å®ä¾‹è°ƒç”¨ï¼Œé™æ€æ–¹æ³•é€šè¿‡æ¥å£åè°ƒç”¨ã€‚\n\n3ã€`default`é»˜è®¤æ–¹æ³•å…³é”®å­—åªèƒ½ç”¨åœ¨æ¥å£ä¸­ã€‚\n\n4ã€é»˜è®¤æ–¹æ³•å¯ä»¥è¢«ç»§æ‰¿ï¼Œå¦‚æœç»§æ‰¿äº†å¤šä¸ªæ¥å£ï¼Œå¤šä¸ªæ¥å£éƒ½å®šä¹‰äº†å¤šä¸ªåŒæ ·çš„é»˜è®¤æ–¹æ³•ï¼Œå®ç°ç±»éœ€è¦é‡å†™é»˜è®¤æ–¹æ³•ä¸ç„¶ä¼šæŠ¥é”™ã€‚\n\n5ã€é™æ€æ–¹æ³•ä¸èƒ½è¢«ç»§æ‰¿åŠè¦†ç›–ï¼Œæ‰€ä»¥åªè¢«å…·ä½“æ‰€åœ¨çš„æ¥å£è°ƒç”¨ã€‚\n\n\n\n\n\n","slug":"æ–°ç‰¹æ€§/Java8/Java8 æ–°ç‰¹æ€§ä¹‹æ¥å£é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•","published":1,"updated":"2025-10-15T07:20:51.412Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu0776005xqkd415qc4dkv","content":"<h2 id=\"æ¥å£é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•\"><a href=\"#æ¥å£é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•\" class=\"headerlink\" title=\"æ¥å£é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•\"></a>æ¥å£é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•</h2><p>æœ‰è¿™æ ·ä¸€äº›åœºæ™¯ï¼Œå¦‚æœä¸€ä¸ªæ¥å£è¦æ·»åŠ ä¸€ä¸ªæ–¹æ³•ï¼Œé‚£æ‰€æœ‰çš„æ¥å£å®ç°ç±»éƒ½è¦å»å®ç°ï¼Œè€ŒæŸäº›å®ç°ç±»æ ¹æœ¬å°±ä¸éœ€è¦å®ç°è¿™ä¸ªæ–¹æ³•ä¹Ÿè¦å†™ä¸€ä¸ªç©ºå®ç°ï¼Œæ‰€ä»¥æ¥å£é»˜è®¤æ–¹æ³•å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>\n<p>æ¥å£é™æ€æ–¹æ³•ç±»ä¼¼äºé»˜è®¤æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸èƒ½åœ¨å®ç°ç±»ä¸­è¦†ç›–å®ƒä»¬ï¼Œå¯ä»¥é¿å…é»˜è®¤æ–¹æ³•åœ¨å®ç°ç±»ä¸­è¢«è¦†ç›–å®ç°ã€‚</p>\n<p>ä¹‹å‰è®²è¿‡çš„JDK8çš„list.foreacheæ–¹æ³•ï¼Œçœ‹ä¸‹æºç ï¼Œå…¶å®ä¹Ÿæ˜¯java.lang.Iterableæ¥å£çš„é»˜è®¤æ–¹æ³•ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">default void forEach(Consumer&lt;? super T&gt; action) &#123;\n    Objects.requireNonNull(action);\n    for (T t : this) &#123;\n        action.accept(t);\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"ç®€å•çš„ä¾‹å­\"><a href=\"#ç®€å•çš„ä¾‹å­\" class=\"headerlink\" title=\"ç®€å•çš„ä¾‹å­\"></a>ç®€å•çš„ä¾‹å­</h2><p>é»˜è®¤æ–¹æ³•ä»¥<code>default</code>ä¿®é¥°ï¼Œé™æ€æ–¹æ³•ç”¨<code>static</code>ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n\tIUserInterface userInterface &#x3D; new UserServiceImpl();\n\tSystem.out.println(userInterface.getDefaultUser1());\n\tSystem.out.println(IUserInterface.getDefaultUser2());\n&#125;\n\ninterface IUserInterface &#123;\n\n\tdefault User getDefaultUser1() &#123;\n\t\treturn new User(&quot;Susan1&quot;, 11);\n\t&#125;\n\n\tstatic User getDefaultUser2() &#123;\n\t\treturn new User(&quot;Susan2&quot;, 22);\n\t&#125;\n\n&#125;\n\nstatic class UserServiceImpl implements IUserInterface &#123;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"æ³¨æ„è¦ç‚¹\"><a href=\"#æ³¨æ„è¦ç‚¹\" class=\"headerlink\" title=\"æ³¨æ„è¦ç‚¹\"></a>æ³¨æ„è¦ç‚¹</h2><p>1ã€æ¥å£é»˜è®¤æ–¹æ³•ã€é™æ€æ–¹æ³•å¯ä»¥æœ‰å¤šä¸ªã€‚</p>\n<p>2ã€é»˜è®¤æ–¹æ³•é€šè¿‡å®ä¾‹è°ƒç”¨ï¼Œé™æ€æ–¹æ³•é€šè¿‡æ¥å£åè°ƒç”¨ã€‚</p>\n<p>3ã€<code>default</code>é»˜è®¤æ–¹æ³•å…³é”®å­—åªèƒ½ç”¨åœ¨æ¥å£ä¸­ã€‚</p>\n<p>4ã€é»˜è®¤æ–¹æ³•å¯ä»¥è¢«ç»§æ‰¿ï¼Œå¦‚æœç»§æ‰¿äº†å¤šä¸ªæ¥å£ï¼Œå¤šä¸ªæ¥å£éƒ½å®šä¹‰äº†å¤šä¸ªåŒæ ·çš„é»˜è®¤æ–¹æ³•ï¼Œå®ç°ç±»éœ€è¦é‡å†™é»˜è®¤æ–¹æ³•ä¸ç„¶ä¼šæŠ¥é”™ã€‚</p>\n<p>5ã€é™æ€æ–¹æ³•ä¸èƒ½è¢«ç»§æ‰¿åŠè¦†ç›–ï¼Œæ‰€ä»¥åªè¢«å…·ä½“æ‰€åœ¨çš„æ¥å£è°ƒç”¨ã€‚</p>\n","excerpt":"","more":"<h2 id=\"æ¥å£é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•\"><a href=\"#æ¥å£é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•\" class=\"headerlink\" title=\"æ¥å£é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•\"></a>æ¥å£é»˜è®¤æ–¹æ³•ä¸é™æ€æ–¹æ³•</h2><p>æœ‰è¿™æ ·ä¸€äº›åœºæ™¯ï¼Œå¦‚æœä¸€ä¸ªæ¥å£è¦æ·»åŠ ä¸€ä¸ªæ–¹æ³•ï¼Œé‚£æ‰€æœ‰çš„æ¥å£å®ç°ç±»éƒ½è¦å»å®ç°ï¼Œè€ŒæŸäº›å®ç°ç±»æ ¹æœ¬å°±ä¸éœ€è¦å®ç°è¿™ä¸ªæ–¹æ³•ä¹Ÿè¦å†™ä¸€ä¸ªç©ºå®ç°ï¼Œæ‰€ä»¥æ¥å£é»˜è®¤æ–¹æ³•å°±æ˜¯ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>\n<p>æ¥å£é™æ€æ–¹æ³•ç±»ä¼¼äºé»˜è®¤æ–¹æ³•ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸èƒ½åœ¨å®ç°ç±»ä¸­è¦†ç›–å®ƒä»¬ï¼Œå¯ä»¥é¿å…é»˜è®¤æ–¹æ³•åœ¨å®ç°ç±»ä¸­è¢«è¦†ç›–å®ç°ã€‚</p>\n<p>ä¹‹å‰è®²è¿‡çš„JDK8çš„list.foreacheæ–¹æ³•ï¼Œçœ‹ä¸‹æºç ï¼Œå…¶å®ä¹Ÿæ˜¯java.lang.Iterableæ¥å£çš„é»˜è®¤æ–¹æ³•ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">default void forEach(Consumer&lt;? super T&gt; action) &#123;\n    Objects.requireNonNull(action);\n    for (T t : this) &#123;\n        action.accept(t);\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"ç®€å•çš„ä¾‹å­\"><a href=\"#ç®€å•çš„ä¾‹å­\" class=\"headerlink\" title=\"ç®€å•çš„ä¾‹å­\"></a>ç®€å•çš„ä¾‹å­</h2><p>é»˜è®¤æ–¹æ³•ä»¥<code>default</code>ä¿®é¥°ï¼Œé™æ€æ–¹æ³•ç”¨<code>static</code>ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n\tIUserInterface userInterface &#x3D; new UserServiceImpl();\n\tSystem.out.println(userInterface.getDefaultUser1());\n\tSystem.out.println(IUserInterface.getDefaultUser2());\n&#125;\n\ninterface IUserInterface &#123;\n\n\tdefault User getDefaultUser1() &#123;\n\t\treturn new User(&quot;Susan1&quot;, 11);\n\t&#125;\n\n\tstatic User getDefaultUser2() &#123;\n\t\treturn new User(&quot;Susan2&quot;, 22);\n\t&#125;\n\n&#125;\n\nstatic class UserServiceImpl implements IUserInterface &#123;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"æ³¨æ„è¦ç‚¹\"><a href=\"#æ³¨æ„è¦ç‚¹\" class=\"headerlink\" title=\"æ³¨æ„è¦ç‚¹\"></a>æ³¨æ„è¦ç‚¹</h2><p>1ã€æ¥å£é»˜è®¤æ–¹æ³•ã€é™æ€æ–¹æ³•å¯ä»¥æœ‰å¤šä¸ªã€‚</p>\n<p>2ã€é»˜è®¤æ–¹æ³•é€šè¿‡å®ä¾‹è°ƒç”¨ï¼Œé™æ€æ–¹æ³•é€šè¿‡æ¥å£åè°ƒç”¨ã€‚</p>\n<p>3ã€<code>default</code>é»˜è®¤æ–¹æ³•å…³é”®å­—åªèƒ½ç”¨åœ¨æ¥å£ä¸­ã€‚</p>\n<p>4ã€é»˜è®¤æ–¹æ³•å¯ä»¥è¢«ç»§æ‰¿ï¼Œå¦‚æœç»§æ‰¿äº†å¤šä¸ªæ¥å£ï¼Œå¤šä¸ªæ¥å£éƒ½å®šä¹‰äº†å¤šä¸ªåŒæ ·çš„é»˜è®¤æ–¹æ³•ï¼Œå®ç°ç±»éœ€è¦é‡å†™é»˜è®¤æ–¹æ³•ä¸ç„¶ä¼šæŠ¥é”™ã€‚</p>\n<p>5ã€é™æ€æ–¹æ³•ä¸èƒ½è¢«ç»§æ‰¿åŠè¦†ç›–ï¼Œæ‰€ä»¥åªè¢«å…·ä½“æ‰€åœ¨çš„æ¥å£è°ƒç”¨ã€‚</p>\n"},{"title":"Java8 æ–°ç‰¹æ€§ä¹‹é‡å¤æ³¨è§£","date":"2025-10-15T03:36:33.000Z","_content":"\n## ä»€ä¹ˆæ˜¯é‡å¤æ³¨è§£\n\nä¸‹é¢æ˜¯JDK8ä¸­çš„é‡å¤æ³¨è§£ï¼ˆ`java.lang.annotation.Repeatable`ï¼‰å®šä¹‰çš„æºç ã€‚\n\n```\n@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.ANNOTATION_TYPE)\npublic @interface Repeatable {\n    Class<? extends Annotation> value();\n}\n```\n\né‡å¤æ³¨è§£ï¼Œå³ä¸€ä¸ªæ³¨è§£å¯ä»¥åœ¨ä¸€ä¸ªç±»ã€æ–¹æ³•æˆ–è€…å­—æ®µä¸ŠåŒæ—¶ä½¿ç”¨å¤šæ¬¡ï¼Œå¦‚Springä¸­å¯ä»¥ä½¿ç”¨å¤šä¸ªæ‰«æç»„ä»¶æ¥æ‰«æå¤šä¸ªåŒ…çš„æ³¨è§£ã€‚\n\n```\n@ComponentScan\n@ComponentScan\npublic class Configuration{\n    \n}\n```\n\n**ComponentScan**\n\n```\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.TYPE)\n@Documented\n@Repeatable(ComponentScans.class)\npublic @interface ComponentScan {\n```\n\n**ComponentScans**\n\n```\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.TYPE)\n@Documented\n@Repeatable(ComponentScans.class)\npublic @interface ComponentScan {\n...\n```\n\n## é‡å¤æ³¨è§£å®ç°\n\nä¸‹é¢æ¥æ¼”ç¤ºä¸‹é‡å¤æ³¨è§£çš„å®ç°ã€‚\n\n\n```\npublic static void main(String[] args) {\n\tfor (Token token : UserToken.class.getAnnotationsByType(Token.class)) {\n\t\tSystem.out.println(token.value());\n\t}\n}\n\n@Target(ElementType.TYPE)\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface Tokens {\n\tToken[] value();\n}\n\n@Target(ElementType.TYPE)\n@Retention(RetentionPolicy.RUNTIME)\n@Repeatable(Tokens.class)\npublic @interface Token {\n\tString value();\n}\n\n@Token(\"666666\")\n@Token(\"888888\")\npublic interface UserToken {\n}\n```\n\nè¾“å‡ºç»“æœï¼š\n\n```\n666666\n888888\n```\n\n","source":"_posts/æ–°ç‰¹æ€§/Java8/Java8 æ–°ç‰¹æ€§ä¹‹é‡å¤æ³¨è§£.md","raw":"---\ntitle: Java8 æ–°ç‰¹æ€§ä¹‹é‡å¤æ³¨è§£\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: æ–°ç‰¹æ€§\n---\n\n## ä»€ä¹ˆæ˜¯é‡å¤æ³¨è§£\n\nä¸‹é¢æ˜¯JDK8ä¸­çš„é‡å¤æ³¨è§£ï¼ˆ`java.lang.annotation.Repeatable`ï¼‰å®šä¹‰çš„æºç ã€‚\n\n```\n@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.ANNOTATION_TYPE)\npublic @interface Repeatable {\n    Class<? extends Annotation> value();\n}\n```\n\né‡å¤æ³¨è§£ï¼Œå³ä¸€ä¸ªæ³¨è§£å¯ä»¥åœ¨ä¸€ä¸ªç±»ã€æ–¹æ³•æˆ–è€…å­—æ®µä¸ŠåŒæ—¶ä½¿ç”¨å¤šæ¬¡ï¼Œå¦‚Springä¸­å¯ä»¥ä½¿ç”¨å¤šä¸ªæ‰«æç»„ä»¶æ¥æ‰«æå¤šä¸ªåŒ…çš„æ³¨è§£ã€‚\n\n```\n@ComponentScan\n@ComponentScan\npublic class Configuration{\n    \n}\n```\n\n**ComponentScan**\n\n```\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.TYPE)\n@Documented\n@Repeatable(ComponentScans.class)\npublic @interface ComponentScan {\n```\n\n**ComponentScans**\n\n```\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.TYPE)\n@Documented\n@Repeatable(ComponentScans.class)\npublic @interface ComponentScan {\n...\n```\n\n## é‡å¤æ³¨è§£å®ç°\n\nä¸‹é¢æ¥æ¼”ç¤ºä¸‹é‡å¤æ³¨è§£çš„å®ç°ã€‚\n\n\n```\npublic static void main(String[] args) {\n\tfor (Token token : UserToken.class.getAnnotationsByType(Token.class)) {\n\t\tSystem.out.println(token.value());\n\t}\n}\n\n@Target(ElementType.TYPE)\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface Tokens {\n\tToken[] value();\n}\n\n@Target(ElementType.TYPE)\n@Retention(RetentionPolicy.RUNTIME)\n@Repeatable(Tokens.class)\npublic @interface Token {\n\tString value();\n}\n\n@Token(\"666666\")\n@Token(\"888888\")\npublic interface UserToken {\n}\n```\n\nè¾“å‡ºç»“æœï¼š\n\n```\n666666\n888888\n```\n\n","slug":"æ–°ç‰¹æ€§/Java8/Java8 æ–°ç‰¹æ€§ä¹‹é‡å¤æ³¨è§£","published":1,"updated":"2025-10-15T07:20:51.456Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu07770060qkd42y7u2124","content":"<h2 id=\"ä»€ä¹ˆæ˜¯é‡å¤æ³¨è§£\"><a href=\"#ä»€ä¹ˆæ˜¯é‡å¤æ³¨è§£\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯é‡å¤æ³¨è§£\"></a>ä»€ä¹ˆæ˜¯é‡å¤æ³¨è§£</h2><p>ä¸‹é¢æ˜¯JDK8ä¸­çš„é‡å¤æ³¨è§£ï¼ˆ<code>java.lang.annotation.Repeatable</code>ï¼‰å®šä¹‰çš„æºç ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.ANNOTATION_TYPE)\npublic @interface Repeatable &#123;\n    Class&lt;? extends Annotation&gt; value();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>é‡å¤æ³¨è§£ï¼Œå³ä¸€ä¸ªæ³¨è§£å¯ä»¥åœ¨ä¸€ä¸ªç±»ã€æ–¹æ³•æˆ–è€…å­—æ®µä¸ŠåŒæ—¶ä½¿ç”¨å¤šæ¬¡ï¼Œå¦‚Springä¸­å¯ä»¥ä½¿ç”¨å¤šä¸ªæ‰«æç»„ä»¶æ¥æ‰«æå¤šä¸ªåŒ…çš„æ³¨è§£ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@ComponentScan\n@ComponentScan\npublic class Configuration&#123;\n    \n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>ComponentScan</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.TYPE)\n@Documented\n@Repeatable(ComponentScans.class)\npublic @interface ComponentScan &#123;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>ComponentScans</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.TYPE)\n@Documented\n@Repeatable(ComponentScans.class)\npublic @interface ComponentScan &#123;\n...<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"é‡å¤æ³¨è§£å®ç°\"><a href=\"#é‡å¤æ³¨è§£å®ç°\" class=\"headerlink\" title=\"é‡å¤æ³¨è§£å®ç°\"></a>é‡å¤æ³¨è§£å®ç°</h2><p>ä¸‹é¢æ¥æ¼”ç¤ºä¸‹é‡å¤æ³¨è§£çš„å®ç°ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n\tfor (Token token : UserToken.class.getAnnotationsByType(Token.class)) &#123;\n\t\tSystem.out.println(token.value());\n\t&#125;\n&#125;\n\n@Target(ElementType.TYPE)\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface Tokens &#123;\n\tToken[] value();\n&#125;\n\n@Target(ElementType.TYPE)\n@Retention(RetentionPolicy.RUNTIME)\n@Repeatable(Tokens.class)\npublic @interface Token &#123;\n\tString value();\n&#125;\n\n@Token(&quot;666666&quot;)\n@Token(&quot;888888&quot;)\npublic interface UserToken &#123;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¾“å‡ºç»“æœï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">666666\n888888<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n","excerpt":"","more":"<h2 id=\"ä»€ä¹ˆæ˜¯é‡å¤æ³¨è§£\"><a href=\"#ä»€ä¹ˆæ˜¯é‡å¤æ³¨è§£\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯é‡å¤æ³¨è§£\"></a>ä»€ä¹ˆæ˜¯é‡å¤æ³¨è§£</h2><p>ä¸‹é¢æ˜¯JDK8ä¸­çš„é‡å¤æ³¨è§£ï¼ˆ<code>java.lang.annotation.Repeatable</code>ï¼‰å®šä¹‰çš„æºç ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@Documented\n@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.ANNOTATION_TYPE)\npublic @interface Repeatable &#123;\n    Class&lt;? extends Annotation&gt; value();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>é‡å¤æ³¨è§£ï¼Œå³ä¸€ä¸ªæ³¨è§£å¯ä»¥åœ¨ä¸€ä¸ªç±»ã€æ–¹æ³•æˆ–è€…å­—æ®µä¸ŠåŒæ—¶ä½¿ç”¨å¤šæ¬¡ï¼Œå¦‚Springä¸­å¯ä»¥ä½¿ç”¨å¤šä¸ªæ‰«æç»„ä»¶æ¥æ‰«æå¤šä¸ªåŒ…çš„æ³¨è§£ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@ComponentScan\n@ComponentScan\npublic class Configuration&#123;\n    \n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>ComponentScan</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.TYPE)\n@Documented\n@Repeatable(ComponentScans.class)\npublic @interface ComponentScan &#123;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>ComponentScans</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@Retention(RetentionPolicy.RUNTIME)\n@Target(ElementType.TYPE)\n@Documented\n@Repeatable(ComponentScans.class)\npublic @interface ComponentScan &#123;\n...<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h2 id=\"é‡å¤æ³¨è§£å®ç°\"><a href=\"#é‡å¤æ³¨è§£å®ç°\" class=\"headerlink\" title=\"é‡å¤æ³¨è§£å®ç°\"></a>é‡å¤æ³¨è§£å®ç°</h2><p>ä¸‹é¢æ¥æ¼”ç¤ºä¸‹é‡å¤æ³¨è§£çš„å®ç°ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) &#123;\n\tfor (Token token : UserToken.class.getAnnotationsByType(Token.class)) &#123;\n\t\tSystem.out.println(token.value());\n\t&#125;\n&#125;\n\n@Target(ElementType.TYPE)\n@Retention(RetentionPolicy.RUNTIME)\npublic @interface Tokens &#123;\n\tToken[] value();\n&#125;\n\n@Target(ElementType.TYPE)\n@Retention(RetentionPolicy.RUNTIME)\n@Repeatable(Tokens.class)\npublic @interface Token &#123;\n\tString value();\n&#125;\n\n@Token(&quot;666666&quot;)\n@Token(&quot;888888&quot;)\npublic interface UserToken &#123;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¾“å‡ºç»“æœï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">666666\n888888<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n"},{"title":"Java 12 éªšæ“ä½œï¼Œ Stringå±…ç„¶è¿˜èƒ½è¿™æ ·ç©","date":"2025-10-15T03:36:33.000Z","_content":"\nJava 13 éƒ½å¿«è¦æ¥äº†ï¼Œ12å¿…é¡»è·Ÿæ ˆé•¿å­¦èµ·ï¼\n\n[Java 13 å³å°†å‘å¸ƒï¼Œæ–°ç‰¹æ€§å¿…é¡»æŠ¢å…ˆçœ‹ï¼](https://mp.weixin.qq.com/s/Gg6KKz7vhDRpzeMR8CG4DA)\n\n\nJava 12 å·²ç»å‘å¸ƒæ•°æœˆäº†ï¼š[Java 12 æ­£å¼å‘å¸ƒï¼Œ8å¤§æ–°ç‰¹æ€§ï¼](https://mp.weixin.qq.com/s/IXOoSTq6qi4ZH63gCaKa3A)ï¼Œä»Šå¤©æˆ‘å†æ¥åˆ†äº«ä¸‹åœ¨ Java 12 ä¸­å…³äº String çš„ä¸‰ä¸ªéªšæ“ä½œï¼Œç»é€¼æœ‰ç”¨ã€‚\n\næ›´å¤šå…³äº Java çš„èµ„è®¯ã€å¹²è´§æ•™ç¨‹ã€ä»¥åŠå¥½æ¶ˆæ¯ï¼Œè¯·å…³æ³¨ï¼Œç¬¬ä¸€æ—¶é—´æ¨é€ã€‚\n\nåç¨³äº†ï¼Œå‡†å¤‡èµ·é£ï¼\n\n## 1ã€transform\n\ntransformï¼šå³å­—ç¬¦ä¸²è½¬æ¢ï¼Œæ¥çœ‹ä¸‹ transform çš„å®ç°æºç ï¼š\n\n```\npublic <R> R transform(Function<? super String, ? extends R> f) {\n    return f.apply(this);\n}\n```\n\nä¼ å…¥ä¸€ä¸ªå‡½æ•°å¼æ¥å£ Functionï¼Œæ¥å—ä¸€ä¸ªå€¼ï¼Œè¿”å›ä¸€ä¸ªå€¼ï¼Œå‚è€ƒï¼š[Java 8 æ–°ç‰¹æ€§ä¹‹å‡½æ•°å¼æ¥å£](https://mp.weixin.qq.com/s/nC3f17zZlXC08XNJWA-FBw)ã€‚\n\nåºŸè¯å°‘è¯´ï¼Œç›´æ¥ä¸Šæ‰‹å°±æ˜¯å¹²ï¼š\n\n```\nprivate static void testTransform() {\n    System.out.println(\"======test java 12 transform======\");\n    List<String> list1 = List.of(\"Java\", \" Python\", \" C++ \");\n    List<String> list2 = new ArrayList<>();\n\n    list1.forEach(element ->\n            list2.add(element.transform(String::strip)\n                    .transform(String::toUpperCase)\n                    .transform((e) -> \"Hi,\" + e))\n    );\n\n    list2.forEach(System.out::println);\n}\n```\n\nç»“æœè¾“å‡ºï¼š\n\n```\n======test java 12 transform======\nHi,JAVA\nHi,PYTHON\nHi,C++\n```\n\nç¤ºä¾‹æ˜¯å¯¹ä¸€ä¸ªå­—ç¬¦ä¸²è¿ç»­è½¬æ¢äº†ä¸‰éï¼Œä»£ç å¾ˆç®€å•ï¼Œå¤§å®¶éƒ½èƒ½é¢†ä¼šçš„ã€‚\n\n## 2ã€indent\n\nç›´æ¥çœ‹ç¤ºä¾‹å§ï¼š\n\n```\nprivate static void testIndent() {\n    System.out.println(\"======test java 12 indent======\");\n    String result = \"Java\\n Python\\nC++\".indent(3);\n    System.out.println(result);\n}\n```\n\nç»“æœè¾“å‡ºï¼š\n\n```\n======test java 12 indent======\n   Java\n    Python\n   C++\n```\n\næ¢è¡Œç¬¦ \\n åå‰ç¼©è¿› N ä¸ªç©ºæ ¼ï¼Œä¸º 0 æˆ–è´Ÿæ•°ä¸ç¼©è¿›ã€‚\n\nä»¥ä¸‹æ˜¯ indent çš„æ ¸å¿ƒæºç ï¼š\n\n```\nprivate String indent(int n, boolean removeBlanks) {\n    Stream<String> stream = removeBlanks ? lines(Integer.MAX_VALUE, Integer.MAX_VALUE)\n                                         : lines();\n    if (n > 0) {\n        final String spaces = \" \".repeat(n);\n        stream = stream.map(s -> spaces + s);\n    } else if (n == Integer.MIN_VALUE) {\n        stream = stream.map(s -> s.stripLeading());\n    } else if (n < 0) {\n        stream = stream.map(s -> s.substring(Math.min(-n, s.indexOfNonWhitespace())));\n    }\n    return stream.collect(Collectors.joining(\"\\n\", \"\", \"\\n\"));\n}\n```\n\nå…¶å®å°±æ˜¯è°ƒç”¨äº† lines() æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ª Streamï¼Œç„¶åå†å¾€å‰æ‹¼æ¥æŒ‡å®šæ•°é‡çš„ç©ºæ ¼ã€‚\n\nå‚è€ƒï¼šã€Š[Java 11 å·²å‘å¸ƒï¼ŒString è¿˜èƒ½è¿™æ ·ç©ï¼](https://mp.weixin.qq.com/s/OZKvkG5OhMXf4lTklZQzGQ)ã€‹è¿™ç¯‡æ–‡ç« å¯¹ lines() çš„ä»‹ç»ã€‚\n\n## 3ã€describeConstable\n\n```\nprivate static void testDescribeConstable() {\n    System.out.println(\"======test java 12 describeConstable======\");\n    String name = \"JavaæŠ€æœ¯\";\n    Optional<String> optional = name.describeConstable();\n    System.out.println(optional.get());\n}\n```\n\nç»“æœè¾“å‡ºï¼š\n\n```\n======test java 12 describeConstable======\nJavaæŠ€æœ¯\n```\n\nJava 12, String å®ç°äº† Constable æ¥å£ï¼š\n\n> java.lang.constant.Constable\n\nè¿™ä¸ªæ¥å£å°±æœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œæºç å¦‚ä¸‹ï¼š\n\n```\npublic interface Constable {\n\n    Optional<? extends ConstantDesc> describeConstable();\n    \n}\n```\n\nJava 12 String çš„å®ç°æºç ï¼š\n\n```\n@Override\npublic Optional<String> describeConstable() {\n    return Optional.of(this);\n}\n```\n\nå¾ˆç®€å•ï¼Œå…¶å®å°±æ˜¯è°ƒç”¨ Optional.of æ–¹æ³•è¿”å›ä¸€ä¸ª Optional ç±»å‹ï¼ŒOptionalä¸æ‡‚çš„å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š[Java 8 æ–°ç‰¹æ€§ä¹‹ Optional](https://mp.weixin.qq.com/s/uXw4eTZqLfj871FlciPh6Q)ã€‚\n\nå¥½äº†ï¼Œä»Šå¤©çš„åˆ†äº«å°±åˆ°è¿™ï¼Œæ”¶è—è½¬å‘ä¸€ä¸‹å§ï¼Œå¤šå­¦ä¹ äº†è§£ï¼Œæ—¥åå¿…å®šæœ‰ç”¨ï¼\n\nå†å² Java æ–°ç‰¹æ€§å¹²è´§åˆ†äº«ï¼š\n\n![](http://img.javastack.cn/20190613135450.png)\n![](http://img.javastack.cn/20190613135537.png)\n\n\n\nJava 12 æ–°ç‰¹æ€§ç»§ç»­æ›´æ–°ä¸­â€¦â€¦\n\n ","source":"_posts/æ–°ç‰¹æ€§/Java12/Java 12 éªšæ“ä½œï¼Œ Stringå±…ç„¶è¿˜èƒ½è¿™æ ·ç©.md","raw":"---\ntitle: Java 12 éªšæ“ä½œï¼Œ Stringå±…ç„¶è¿˜èƒ½è¿™æ ·ç©\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: æ–°ç‰¹æ€§\n---\n\nJava 13 éƒ½å¿«è¦æ¥äº†ï¼Œ12å¿…é¡»è·Ÿæ ˆé•¿å­¦èµ·ï¼\n\n[Java 13 å³å°†å‘å¸ƒï¼Œæ–°ç‰¹æ€§å¿…é¡»æŠ¢å…ˆçœ‹ï¼](https://mp.weixin.qq.com/s/Gg6KKz7vhDRpzeMR8CG4DA)\n\n\nJava 12 å·²ç»å‘å¸ƒæ•°æœˆäº†ï¼š[Java 12 æ­£å¼å‘å¸ƒï¼Œ8å¤§æ–°ç‰¹æ€§ï¼](https://mp.weixin.qq.com/s/IXOoSTq6qi4ZH63gCaKa3A)ï¼Œä»Šå¤©æˆ‘å†æ¥åˆ†äº«ä¸‹åœ¨ Java 12 ä¸­å…³äº String çš„ä¸‰ä¸ªéªšæ“ä½œï¼Œç»é€¼æœ‰ç”¨ã€‚\n\næ›´å¤šå…³äº Java çš„èµ„è®¯ã€å¹²è´§æ•™ç¨‹ã€ä»¥åŠå¥½æ¶ˆæ¯ï¼Œè¯·å…³æ³¨ï¼Œç¬¬ä¸€æ—¶é—´æ¨é€ã€‚\n\nåç¨³äº†ï¼Œå‡†å¤‡èµ·é£ï¼\n\n## 1ã€transform\n\ntransformï¼šå³å­—ç¬¦ä¸²è½¬æ¢ï¼Œæ¥çœ‹ä¸‹ transform çš„å®ç°æºç ï¼š\n\n```\npublic <R> R transform(Function<? super String, ? extends R> f) {\n    return f.apply(this);\n}\n```\n\nä¼ å…¥ä¸€ä¸ªå‡½æ•°å¼æ¥å£ Functionï¼Œæ¥å—ä¸€ä¸ªå€¼ï¼Œè¿”å›ä¸€ä¸ªå€¼ï¼Œå‚è€ƒï¼š[Java 8 æ–°ç‰¹æ€§ä¹‹å‡½æ•°å¼æ¥å£](https://mp.weixin.qq.com/s/nC3f17zZlXC08XNJWA-FBw)ã€‚\n\nåºŸè¯å°‘è¯´ï¼Œç›´æ¥ä¸Šæ‰‹å°±æ˜¯å¹²ï¼š\n\n```\nprivate static void testTransform() {\n    System.out.println(\"======test java 12 transform======\");\n    List<String> list1 = List.of(\"Java\", \" Python\", \" C++ \");\n    List<String> list2 = new ArrayList<>();\n\n    list1.forEach(element ->\n            list2.add(element.transform(String::strip)\n                    .transform(String::toUpperCase)\n                    .transform((e) -> \"Hi,\" + e))\n    );\n\n    list2.forEach(System.out::println);\n}\n```\n\nç»“æœè¾“å‡ºï¼š\n\n```\n======test java 12 transform======\nHi,JAVA\nHi,PYTHON\nHi,C++\n```\n\nç¤ºä¾‹æ˜¯å¯¹ä¸€ä¸ªå­—ç¬¦ä¸²è¿ç»­è½¬æ¢äº†ä¸‰éï¼Œä»£ç å¾ˆç®€å•ï¼Œå¤§å®¶éƒ½èƒ½é¢†ä¼šçš„ã€‚\n\n## 2ã€indent\n\nç›´æ¥çœ‹ç¤ºä¾‹å§ï¼š\n\n```\nprivate static void testIndent() {\n    System.out.println(\"======test java 12 indent======\");\n    String result = \"Java\\n Python\\nC++\".indent(3);\n    System.out.println(result);\n}\n```\n\nç»“æœè¾“å‡ºï¼š\n\n```\n======test java 12 indent======\n   Java\n    Python\n   C++\n```\n\næ¢è¡Œç¬¦ \\n åå‰ç¼©è¿› N ä¸ªç©ºæ ¼ï¼Œä¸º 0 æˆ–è´Ÿæ•°ä¸ç¼©è¿›ã€‚\n\nä»¥ä¸‹æ˜¯ indent çš„æ ¸å¿ƒæºç ï¼š\n\n```\nprivate String indent(int n, boolean removeBlanks) {\n    Stream<String> stream = removeBlanks ? lines(Integer.MAX_VALUE, Integer.MAX_VALUE)\n                                         : lines();\n    if (n > 0) {\n        final String spaces = \" \".repeat(n);\n        stream = stream.map(s -> spaces + s);\n    } else if (n == Integer.MIN_VALUE) {\n        stream = stream.map(s -> s.stripLeading());\n    } else if (n < 0) {\n        stream = stream.map(s -> s.substring(Math.min(-n, s.indexOfNonWhitespace())));\n    }\n    return stream.collect(Collectors.joining(\"\\n\", \"\", \"\\n\"));\n}\n```\n\nå…¶å®å°±æ˜¯è°ƒç”¨äº† lines() æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ª Streamï¼Œç„¶åå†å¾€å‰æ‹¼æ¥æŒ‡å®šæ•°é‡çš„ç©ºæ ¼ã€‚\n\nå‚è€ƒï¼šã€Š[Java 11 å·²å‘å¸ƒï¼ŒString è¿˜èƒ½è¿™æ ·ç©ï¼](https://mp.weixin.qq.com/s/OZKvkG5OhMXf4lTklZQzGQ)ã€‹è¿™ç¯‡æ–‡ç« å¯¹ lines() çš„ä»‹ç»ã€‚\n\n## 3ã€describeConstable\n\n```\nprivate static void testDescribeConstable() {\n    System.out.println(\"======test java 12 describeConstable======\");\n    String name = \"JavaæŠ€æœ¯\";\n    Optional<String> optional = name.describeConstable();\n    System.out.println(optional.get());\n}\n```\n\nç»“æœè¾“å‡ºï¼š\n\n```\n======test java 12 describeConstable======\nJavaæŠ€æœ¯\n```\n\nJava 12, String å®ç°äº† Constable æ¥å£ï¼š\n\n> java.lang.constant.Constable\n\nè¿™ä¸ªæ¥å£å°±æœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œæºç å¦‚ä¸‹ï¼š\n\n```\npublic interface Constable {\n\n    Optional<? extends ConstantDesc> describeConstable();\n    \n}\n```\n\nJava 12 String çš„å®ç°æºç ï¼š\n\n```\n@Override\npublic Optional<String> describeConstable() {\n    return Optional.of(this);\n}\n```\n\nå¾ˆç®€å•ï¼Œå…¶å®å°±æ˜¯è°ƒç”¨ Optional.of æ–¹æ³•è¿”å›ä¸€ä¸ª Optional ç±»å‹ï¼ŒOptionalä¸æ‡‚çš„å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š[Java 8 æ–°ç‰¹æ€§ä¹‹ Optional](https://mp.weixin.qq.com/s/uXw4eTZqLfj871FlciPh6Q)ã€‚\n\nå¥½äº†ï¼Œä»Šå¤©çš„åˆ†äº«å°±åˆ°è¿™ï¼Œæ”¶è—è½¬å‘ä¸€ä¸‹å§ï¼Œå¤šå­¦ä¹ äº†è§£ï¼Œæ—¥åå¿…å®šæœ‰ç”¨ï¼\n\nå†å² Java æ–°ç‰¹æ€§å¹²è´§åˆ†äº«ï¼š\n\n![](http://img.javastack.cn/20190613135450.png)\n![](http://img.javastack.cn/20190613135537.png)\n\n\n\nJava 12 æ–°ç‰¹æ€§ç»§ç»­æ›´æ–°ä¸­â€¦â€¦\n\n ","slug":"æ–°ç‰¹æ€§/Java12/Java 12 éªšæ“ä½œï¼Œ Stringå±…ç„¶è¿˜èƒ½è¿™æ ·ç©","published":1,"updated":"2025-10-15T07:20:51.435Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu07770063qkd4ef5d5z3h","content":"<p>Java 13 éƒ½å¿«è¦æ¥äº†ï¼Œ12å¿…é¡»è·Ÿæ ˆé•¿å­¦èµ·ï¼</p>\n<p><a href=\"https://mp.weixin.qq.com/s/Gg6KKz7vhDRpzeMR8CG4DA\">Java 13 å³å°†å‘å¸ƒï¼Œæ–°ç‰¹æ€§å¿…é¡»æŠ¢å…ˆçœ‹ï¼</a></p>\n<p>Java 12 å·²ç»å‘å¸ƒæ•°æœˆäº†ï¼š<a href=\"https://mp.weixin.qq.com/s/IXOoSTq6qi4ZH63gCaKa3A\">Java 12 æ­£å¼å‘å¸ƒï¼Œ8å¤§æ–°ç‰¹æ€§ï¼</a>ï¼Œä»Šå¤©æˆ‘å†æ¥åˆ†äº«ä¸‹åœ¨ Java 12 ä¸­å…³äº String çš„ä¸‰ä¸ªéªšæ“ä½œï¼Œç»é€¼æœ‰ç”¨ã€‚</p>\n<p>æ›´å¤šå…³äº Java çš„èµ„è®¯ã€å¹²è´§æ•™ç¨‹ã€ä»¥åŠå¥½æ¶ˆæ¯ï¼Œè¯·å…³æ³¨ï¼Œç¬¬ä¸€æ—¶é—´æ¨é€ã€‚</p>\n<p>åç¨³äº†ï¼Œå‡†å¤‡èµ·é£ï¼</p>\n<h2 id=\"1ã€transform\"><a href=\"#1ã€transform\" class=\"headerlink\" title=\"1ã€transform\"></a>1ã€transform</h2><p>transformï¼šå³å­—ç¬¦ä¸²è½¬æ¢ï¼Œæ¥çœ‹ä¸‹ transform çš„å®ç°æºç ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public &lt;R&gt; R transform(Function&lt;? super String, ? extends R&gt; f) &#123;\n    return f.apply(this);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ä¼ å…¥ä¸€ä¸ªå‡½æ•°å¼æ¥å£ Functionï¼Œæ¥å—ä¸€ä¸ªå€¼ï¼Œè¿”å›ä¸€ä¸ªå€¼ï¼Œå‚è€ƒï¼š<a href=\"https://mp.weixin.qq.com/s/nC3f17zZlXC08XNJWA-FBw\">Java 8 æ–°ç‰¹æ€§ä¹‹å‡½æ•°å¼æ¥å£</a>ã€‚</p>\n<p>åºŸè¯å°‘è¯´ï¼Œç›´æ¥ä¸Šæ‰‹å°±æ˜¯å¹²ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void testTransform() &#123;\n    System.out.println(&quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;test java 12 transform&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;);\n    List&lt;String&gt; list1 &#x3D; List.of(&quot;Java&quot;, &quot; Python&quot;, &quot; C++ &quot;);\n    List&lt;String&gt; list2 &#x3D; new ArrayList&lt;&gt;();\n\n    list1.forEach(element -&gt;\n            list2.add(element.transform(String::strip)\n                    .transform(String::toUpperCase)\n                    .transform((e) -&gt; &quot;Hi,&quot; + e))\n    );\n\n    list2.forEach(System.out::println);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç»“æœè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;test java 12 transform&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;\nHi,JAVA\nHi,PYTHON\nHi,C++<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¤ºä¾‹æ˜¯å¯¹ä¸€ä¸ªå­—ç¬¦ä¸²è¿ç»­è½¬æ¢äº†ä¸‰éï¼Œä»£ç å¾ˆç®€å•ï¼Œå¤§å®¶éƒ½èƒ½é¢†ä¼šçš„ã€‚</p>\n<h2 id=\"2ã€indent\"><a href=\"#2ã€indent\" class=\"headerlink\" title=\"2ã€indent\"></a>2ã€indent</h2><p>ç›´æ¥çœ‹ç¤ºä¾‹å§ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void testIndent() &#123;\n    System.out.println(&quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;test java 12 indent&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;);\n    String result &#x3D; &quot;Java\\n Python\\nC++&quot;.indent(3);\n    System.out.println(result);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç»“æœè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;test java 12 indent&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;\n   Java\n    Python\n   C++<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ¢è¡Œç¬¦ \\n åå‰ç¼©è¿› N ä¸ªç©ºæ ¼ï¼Œä¸º 0 æˆ–è´Ÿæ•°ä¸ç¼©è¿›ã€‚</p>\n<p>ä»¥ä¸‹æ˜¯ indent çš„æ ¸å¿ƒæºç ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private String indent(int n, boolean removeBlanks) &#123;\n    Stream&lt;String&gt; stream &#x3D; removeBlanks ? lines(Integer.MAX_VALUE, Integer.MAX_VALUE)\n                                         : lines();\n    if (n &gt; 0) &#123;\n        final String spaces &#x3D; &quot; &quot;.repeat(n);\n        stream &#x3D; stream.map(s -&gt; spaces + s);\n    &#125; else if (n &#x3D;&#x3D; Integer.MIN_VALUE) &#123;\n        stream &#x3D; stream.map(s -&gt; s.stripLeading());\n    &#125; else if (n &lt; 0) &#123;\n        stream &#x3D; stream.map(s -&gt; s.substring(Math.min(-n, s.indexOfNonWhitespace())));\n    &#125;\n    return stream.collect(Collectors.joining(&quot;\\n&quot;, &quot;&quot;, &quot;\\n&quot;));\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å…¶å®å°±æ˜¯è°ƒç”¨äº† lines() æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ª Streamï¼Œç„¶åå†å¾€å‰æ‹¼æ¥æŒ‡å®šæ•°é‡çš„ç©ºæ ¼ã€‚</p>\n<p>å‚è€ƒï¼šã€Š<a href=\"https://mp.weixin.qq.com/s/OZKvkG5OhMXf4lTklZQzGQ\">Java 11 å·²å‘å¸ƒï¼ŒString è¿˜èƒ½è¿™æ ·ç©ï¼</a>ã€‹è¿™ç¯‡æ–‡ç« å¯¹ lines() çš„ä»‹ç»ã€‚</p>\n<h2 id=\"3ã€describeConstable\"><a href=\"#3ã€describeConstable\" class=\"headerlink\" title=\"3ã€describeConstable\"></a>3ã€describeConstable</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void testDescribeConstable() &#123;\n    System.out.println(&quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;test java 12 describeConstable&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;);\n    String name &#x3D; &quot;JavaæŠ€æœ¯&quot;;\n    Optional&lt;String&gt; optional &#x3D; name.describeConstable();\n    System.out.println(optional.get());\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç»“æœè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;test java 12 describeConstable&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;\nJavaæŠ€æœ¯<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>Java 12, String å®ç°äº† Constable æ¥å£ï¼š</p>\n<blockquote>\n<p>java.lang.constant.Constable</p>\n</blockquote>\n<p>è¿™ä¸ªæ¥å£å°±æœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œæºç å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public interface Constable &#123;\n\n    Optional&lt;? extends ConstantDesc&gt; describeConstable();\n    \n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Java 12 String çš„å®ç°æºç ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@Override\npublic Optional&lt;String&gt; describeConstable() &#123;\n    return Optional.of(this);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¾ˆç®€å•ï¼Œå…¶å®å°±æ˜¯è°ƒç”¨ Optional.of æ–¹æ³•è¿”å›ä¸€ä¸ª Optional ç±»å‹ï¼ŒOptionalä¸æ‡‚çš„å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š<a href=\"https://mp.weixin.qq.com/s/uXw4eTZqLfj871FlciPh6Q\">Java 8 æ–°ç‰¹æ€§ä¹‹ Optional</a>ã€‚</p>\n<p>å¥½äº†ï¼Œä»Šå¤©çš„åˆ†äº«å°±åˆ°è¿™ï¼Œæ”¶è—è½¬å‘ä¸€ä¸‹å§ï¼Œå¤šå­¦ä¹ äº†è§£ï¼Œæ—¥åå¿…å®šæœ‰ç”¨ï¼</p>\n<p>å†å² Java æ–°ç‰¹æ€§å¹²è´§åˆ†äº«ï¼š</p>\n<p><img src=\"http://img.javastack.cn/20190613135450.png\"><br><img src=\"http://img.javastack.cn/20190613135537.png\"></p>\n<p>Java 12 æ–°ç‰¹æ€§ç»§ç»­æ›´æ–°ä¸­â€¦â€¦</p>\n","excerpt":"","more":"<p>Java 13 éƒ½å¿«è¦æ¥äº†ï¼Œ12å¿…é¡»è·Ÿæ ˆé•¿å­¦èµ·ï¼</p>\n<p><a href=\"https://mp.weixin.qq.com/s/Gg6KKz7vhDRpzeMR8CG4DA\">Java 13 å³å°†å‘å¸ƒï¼Œæ–°ç‰¹æ€§å¿…é¡»æŠ¢å…ˆçœ‹ï¼</a></p>\n<p>Java 12 å·²ç»å‘å¸ƒæ•°æœˆäº†ï¼š<a href=\"https://mp.weixin.qq.com/s/IXOoSTq6qi4ZH63gCaKa3A\">Java 12 æ­£å¼å‘å¸ƒï¼Œ8å¤§æ–°ç‰¹æ€§ï¼</a>ï¼Œä»Šå¤©æˆ‘å†æ¥åˆ†äº«ä¸‹åœ¨ Java 12 ä¸­å…³äº String çš„ä¸‰ä¸ªéªšæ“ä½œï¼Œç»é€¼æœ‰ç”¨ã€‚</p>\n<p>æ›´å¤šå…³äº Java çš„èµ„è®¯ã€å¹²è´§æ•™ç¨‹ã€ä»¥åŠå¥½æ¶ˆæ¯ï¼Œè¯·å…³æ³¨ï¼Œç¬¬ä¸€æ—¶é—´æ¨é€ã€‚</p>\n<p>åç¨³äº†ï¼Œå‡†å¤‡èµ·é£ï¼</p>\n<h2 id=\"1ã€transform\"><a href=\"#1ã€transform\" class=\"headerlink\" title=\"1ã€transform\"></a>1ã€transform</h2><p>transformï¼šå³å­—ç¬¦ä¸²è½¬æ¢ï¼Œæ¥çœ‹ä¸‹ transform çš„å®ç°æºç ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public &lt;R&gt; R transform(Function&lt;? super String, ? extends R&gt; f) &#123;\n    return f.apply(this);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ä¼ å…¥ä¸€ä¸ªå‡½æ•°å¼æ¥å£ Functionï¼Œæ¥å—ä¸€ä¸ªå€¼ï¼Œè¿”å›ä¸€ä¸ªå€¼ï¼Œå‚è€ƒï¼š<a href=\"https://mp.weixin.qq.com/s/nC3f17zZlXC08XNJWA-FBw\">Java 8 æ–°ç‰¹æ€§ä¹‹å‡½æ•°å¼æ¥å£</a>ã€‚</p>\n<p>åºŸè¯å°‘è¯´ï¼Œç›´æ¥ä¸Šæ‰‹å°±æ˜¯å¹²ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void testTransform() &#123;\n    System.out.println(&quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;test java 12 transform&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;);\n    List&lt;String&gt; list1 &#x3D; List.of(&quot;Java&quot;, &quot; Python&quot;, &quot; C++ &quot;);\n    List&lt;String&gt; list2 &#x3D; new ArrayList&lt;&gt;();\n\n    list1.forEach(element -&gt;\n            list2.add(element.transform(String::strip)\n                    .transform(String::toUpperCase)\n                    .transform((e) -&gt; &quot;Hi,&quot; + e))\n    );\n\n    list2.forEach(System.out::println);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç»“æœè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;test java 12 transform&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;\nHi,JAVA\nHi,PYTHON\nHi,C++<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¤ºä¾‹æ˜¯å¯¹ä¸€ä¸ªå­—ç¬¦ä¸²è¿ç»­è½¬æ¢äº†ä¸‰éï¼Œä»£ç å¾ˆç®€å•ï¼Œå¤§å®¶éƒ½èƒ½é¢†ä¼šçš„ã€‚</p>\n<h2 id=\"2ã€indent\"><a href=\"#2ã€indent\" class=\"headerlink\" title=\"2ã€indent\"></a>2ã€indent</h2><p>ç›´æ¥çœ‹ç¤ºä¾‹å§ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void testIndent() &#123;\n    System.out.println(&quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;test java 12 indent&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;);\n    String result &#x3D; &quot;Java\\n Python\\nC++&quot;.indent(3);\n    System.out.println(result);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç»“æœè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;test java 12 indent&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;\n   Java\n    Python\n   C++<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ¢è¡Œç¬¦ \\n åå‰ç¼©è¿› N ä¸ªç©ºæ ¼ï¼Œä¸º 0 æˆ–è´Ÿæ•°ä¸ç¼©è¿›ã€‚</p>\n<p>ä»¥ä¸‹æ˜¯ indent çš„æ ¸å¿ƒæºç ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private String indent(int n, boolean removeBlanks) &#123;\n    Stream&lt;String&gt; stream &#x3D; removeBlanks ? lines(Integer.MAX_VALUE, Integer.MAX_VALUE)\n                                         : lines();\n    if (n &gt; 0) &#123;\n        final String spaces &#x3D; &quot; &quot;.repeat(n);\n        stream &#x3D; stream.map(s -&gt; spaces + s);\n    &#125; else if (n &#x3D;&#x3D; Integer.MIN_VALUE) &#123;\n        stream &#x3D; stream.map(s -&gt; s.stripLeading());\n    &#125; else if (n &lt; 0) &#123;\n        stream &#x3D; stream.map(s -&gt; s.substring(Math.min(-n, s.indexOfNonWhitespace())));\n    &#125;\n    return stream.collect(Collectors.joining(&quot;\\n&quot;, &quot;&quot;, &quot;\\n&quot;));\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å…¶å®å°±æ˜¯è°ƒç”¨äº† lines() æ–¹æ³•æ¥åˆ›å»ºä¸€ä¸ª Streamï¼Œç„¶åå†å¾€å‰æ‹¼æ¥æŒ‡å®šæ•°é‡çš„ç©ºæ ¼ã€‚</p>\n<p>å‚è€ƒï¼šã€Š<a href=\"https://mp.weixin.qq.com/s/OZKvkG5OhMXf4lTklZQzGQ\">Java 11 å·²å‘å¸ƒï¼ŒString è¿˜èƒ½è¿™æ ·ç©ï¼</a>ã€‹è¿™ç¯‡æ–‡ç« å¯¹ lines() çš„ä»‹ç»ã€‚</p>\n<h2 id=\"3ã€describeConstable\"><a href=\"#3ã€describeConstable\" class=\"headerlink\" title=\"3ã€describeConstable\"></a>3ã€describeConstable</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void testDescribeConstable() &#123;\n    System.out.println(&quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;test java 12 describeConstable&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;);\n    String name &#x3D; &quot;JavaæŠ€æœ¯&quot;;\n    Optional&lt;String&gt; optional &#x3D; name.describeConstable();\n    System.out.println(optional.get());\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç»“æœè¾“å‡ºï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;test java 12 describeConstable&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;\nJavaæŠ€æœ¯<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>Java 12, String å®ç°äº† Constable æ¥å£ï¼š</p>\n<blockquote>\n<p>java.lang.constant.Constable</p>\n</blockquote>\n<p>è¿™ä¸ªæ¥å£å°±æœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œæºç å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public interface Constable &#123;\n\n    Optional&lt;? extends ConstantDesc&gt; describeConstable();\n    \n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Java 12 String çš„å®ç°æºç ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@Override\npublic Optional&lt;String&gt; describeConstable() &#123;\n    return Optional.of(this);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¾ˆç®€å•ï¼Œå…¶å®å°±æ˜¯è°ƒç”¨ Optional.of æ–¹æ³•è¿”å›ä¸€ä¸ª Optional ç±»å‹ï¼ŒOptionalä¸æ‡‚çš„å¯ä»¥å‚è€ƒè¿™ç¯‡æ–‡ç« ï¼š<a href=\"https://mp.weixin.qq.com/s/uXw4eTZqLfj871FlciPh6Q\">Java 8 æ–°ç‰¹æ€§ä¹‹ Optional</a>ã€‚</p>\n<p>å¥½äº†ï¼Œä»Šå¤©çš„åˆ†äº«å°±åˆ°è¿™ï¼Œæ”¶è—è½¬å‘ä¸€ä¸‹å§ï¼Œå¤šå­¦ä¹ äº†è§£ï¼Œæ—¥åå¿…å®šæœ‰ç”¨ï¼</p>\n<p>å†å² Java æ–°ç‰¹æ€§å¹²è´§åˆ†äº«ï¼š</p>\n<p><img src=\"http://img.javastack.cn/20190613135450.png\"><br><img src=\"http://img.javastack.cn/20190613135537.png\"></p>\n<p>Java 12 æ–°ç‰¹æ€§ç»§ç»­æ›´æ–°ä¸­â€¦â€¦</p>\n"},{"title":"Java 12 éªšæ“ä½œï¼Œ switchå±…ç„¶è¿˜èƒ½è¿™æ ·ç©ï¼","date":"2025-10-15T03:36:33.000Z","_content":"\nJava 13 éƒ½å¿«è¦æ¥äº†ï¼Œ12å¿…é¡»è·Ÿæ ˆé•¿å­¦èµ·ï¼\n\n[Java 13 å³å°†å‘å¸ƒï¼Œæ–°ç‰¹æ€§å¿…é¡»æŠ¢å…ˆçœ‹ï¼](https://mp.weixin.qq.com/s/Gg6KKz7vhDRpzeMR8CG4DA)\n\n\n**é‚£ä¹ˆåœ¨ Java 12 ä¸­å¯ä»¥æ€æ ·ç© switch?**\n\nå…ˆæ¥å®šä¹‰ä¸€ä¸ªæšä¸¾ç±»ï¼š\n\n```\npublic enum Status {\n    OPEN, INIT, PROCESS, PENDING, CLOSE;\n}\n```\n\nJava 12 ä¹‹å‰æ˜¯è¿™æ ·ç”¨çš„ï¼š\n\n```\nprivate static void testSwitch1(Status status) {\n    int result = 0;\n    switch (status) {\n        case OPEN:\n            result = 1;\n            break;\n        case PROCESS:\n            result = 2;\n            break;\n        case PENDING:\n            result = 2;\n            break;\n        case CLOSE:\n            result = 3;\n            break;\n        default:\n            throw new RuntimeException(\"çŠ¶æ€ä¸æ­£ç¡®\");\n    }\n    System.out.println(\"result is \" + result);\n}\n```\n\nJava 12 åå¯ä»¥è¿™æ ·ç”¨ï¼š\n\n```\nprivate static void testSwitch2(Status status) {\n    var result = switch (status) {\n        case OPEN -> 1;\n        case PROCESS, PENDING -> 2;\n        case CLOSE -> 3;\n        default -> throw new RuntimeException(\"çŠ¶æ€ä¸æ­£ç¡®\");\n    };\n    System.out.println(\"result is \" + result);\n}\n```\n\nç¤ºä¾‹ä»£ç çœ‹äº†éƒ½æ‡‚å§ï¼Œæ˜¯ä¸æ˜¯å¾ˆéªšï¼Ÿ\n\nJava 12 switch æœ‰ä»¥ä¸‹å‡ ç‚¹ç‰¹è‰²ï¼š\n\n- ç®­å¤´è¯­æ³• ->ï¼Œç±»ä¼¼ Java 8 ä¸­çš„ Lambda è¡¨è¾¾å¼ï¼›\n- å¯ä»¥ç›´æ¥è¿”å›å€¼ç»™ä¸€ä¸ªå˜é‡ï¼Œå¹¶ä¸”å¯ä»¥ä¸ç”¨ break å…³é”®å­—ï¼›\n- case æ¡ä»¶ï¼Œå¤šä¸ªå¯ä»¥å†™åœ¨ä¸€è¡Œï¼Œç”¨é€—å·åˆ†å¼€ï¼›\n- å¯ä»¥çœç•¥ break å…³é”®å­—ï¼›\n\nå½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ break å…³é”®å­—ï¼Œåé¢è·Ÿå€¼ï¼š\n\n```\nprivate static void testSwitch3(Status status) {\n    var result = switch (status) {\n        case OPEN -> {\n            break 1;\n        }\n        case PROCESS, PENDING -> {\n            break 2;\n        }\n        case CLOSE -> {\n            break 3;\n        }\n        default -> {\n            break 5;\n        }\n    };\n    System.out.println(\"result is \" + result);\n}\n```\n\nä¸æ¨èç”¨è¿™ç§ï¼Œåœ¨ç¼–è¯‘å™¨ä¹Ÿä¼šæ˜¾ç¤ºç°è‰²ï¼Œå¹¶æç¤ºä½ æ›´æ”¹ã€‚\n\næœ€åï¼Œè¿™ä¸ªæ–°ç‰¹æ€§æ˜¯ Java 12 é¢„è§ˆç‰ˆä¸­çš„ç‰¹æ€§ï¼š`JEP 325: Switch Expressions (Preview)`ï¼Œè¦ä½¿ç”¨è¿™ä¸ªæ–°ç‰¹æ€§ï¼Œè¯·åˆ‡æ¢è‡³ Java 12 é¢„è§ˆç‰ˆã€‚\n\n> å‚è€ƒ https://openjdk.java.net/jeps/325\n\nå¥½äº†ï¼Œä»Šå¤©çš„åˆ†äº«å°±åˆ°è¿™ï¼Œæ”¶è—è½¬å‘ä¸€ä¸‹å§ï¼Œå¤šå­¦ä¹ äº†è§£ï¼Œæ—¥åå¿…å®šæœ‰ç”¨ï¼\n\nå†å² Java æ–°ç‰¹æ€§å¹²è´§åˆ†äº«ï¼š\n\n![](http://img.javastack.cn/20190613135450.png)\n![](http://img.javastack.cn/20190613135537.png)\n\n\n\n","source":"_posts/æ–°ç‰¹æ€§/Java12/Java 12 éªšæ“ä½œï¼Œ switchå±…ç„¶è¿˜èƒ½è¿™æ ·ç©ï¼.md","raw":"---\ntitle: Java 12 éªšæ“ä½œï¼Œ switchå±…ç„¶è¿˜èƒ½è¿™æ ·ç©ï¼\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: æ–°ç‰¹æ€§\n---\n\nJava 13 éƒ½å¿«è¦æ¥äº†ï¼Œ12å¿…é¡»è·Ÿæ ˆé•¿å­¦èµ·ï¼\n\n[Java 13 å³å°†å‘å¸ƒï¼Œæ–°ç‰¹æ€§å¿…é¡»æŠ¢å…ˆçœ‹ï¼](https://mp.weixin.qq.com/s/Gg6KKz7vhDRpzeMR8CG4DA)\n\n\n**é‚£ä¹ˆåœ¨ Java 12 ä¸­å¯ä»¥æ€æ ·ç© switch?**\n\nå…ˆæ¥å®šä¹‰ä¸€ä¸ªæšä¸¾ç±»ï¼š\n\n```\npublic enum Status {\n    OPEN, INIT, PROCESS, PENDING, CLOSE;\n}\n```\n\nJava 12 ä¹‹å‰æ˜¯è¿™æ ·ç”¨çš„ï¼š\n\n```\nprivate static void testSwitch1(Status status) {\n    int result = 0;\n    switch (status) {\n        case OPEN:\n            result = 1;\n            break;\n        case PROCESS:\n            result = 2;\n            break;\n        case PENDING:\n            result = 2;\n            break;\n        case CLOSE:\n            result = 3;\n            break;\n        default:\n            throw new RuntimeException(\"çŠ¶æ€ä¸æ­£ç¡®\");\n    }\n    System.out.println(\"result is \" + result);\n}\n```\n\nJava 12 åå¯ä»¥è¿™æ ·ç”¨ï¼š\n\n```\nprivate static void testSwitch2(Status status) {\n    var result = switch (status) {\n        case OPEN -> 1;\n        case PROCESS, PENDING -> 2;\n        case CLOSE -> 3;\n        default -> throw new RuntimeException(\"çŠ¶æ€ä¸æ­£ç¡®\");\n    };\n    System.out.println(\"result is \" + result);\n}\n```\n\nç¤ºä¾‹ä»£ç çœ‹äº†éƒ½æ‡‚å§ï¼Œæ˜¯ä¸æ˜¯å¾ˆéªšï¼Ÿ\n\nJava 12 switch æœ‰ä»¥ä¸‹å‡ ç‚¹ç‰¹è‰²ï¼š\n\n- ç®­å¤´è¯­æ³• ->ï¼Œç±»ä¼¼ Java 8 ä¸­çš„ Lambda è¡¨è¾¾å¼ï¼›\n- å¯ä»¥ç›´æ¥è¿”å›å€¼ç»™ä¸€ä¸ªå˜é‡ï¼Œå¹¶ä¸”å¯ä»¥ä¸ç”¨ break å…³é”®å­—ï¼›\n- case æ¡ä»¶ï¼Œå¤šä¸ªå¯ä»¥å†™åœ¨ä¸€è¡Œï¼Œç”¨é€—å·åˆ†å¼€ï¼›\n- å¯ä»¥çœç•¥ break å…³é”®å­—ï¼›\n\nå½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ break å…³é”®å­—ï¼Œåé¢è·Ÿå€¼ï¼š\n\n```\nprivate static void testSwitch3(Status status) {\n    var result = switch (status) {\n        case OPEN -> {\n            break 1;\n        }\n        case PROCESS, PENDING -> {\n            break 2;\n        }\n        case CLOSE -> {\n            break 3;\n        }\n        default -> {\n            break 5;\n        }\n    };\n    System.out.println(\"result is \" + result);\n}\n```\n\nä¸æ¨èç”¨è¿™ç§ï¼Œåœ¨ç¼–è¯‘å™¨ä¹Ÿä¼šæ˜¾ç¤ºç°è‰²ï¼Œå¹¶æç¤ºä½ æ›´æ”¹ã€‚\n\næœ€åï¼Œè¿™ä¸ªæ–°ç‰¹æ€§æ˜¯ Java 12 é¢„è§ˆç‰ˆä¸­çš„ç‰¹æ€§ï¼š`JEP 325: Switch Expressions (Preview)`ï¼Œè¦ä½¿ç”¨è¿™ä¸ªæ–°ç‰¹æ€§ï¼Œè¯·åˆ‡æ¢è‡³ Java 12 é¢„è§ˆç‰ˆã€‚\n\n> å‚è€ƒ https://openjdk.java.net/jeps/325\n\nå¥½äº†ï¼Œä»Šå¤©çš„åˆ†äº«å°±åˆ°è¿™ï¼Œæ”¶è—è½¬å‘ä¸€ä¸‹å§ï¼Œå¤šå­¦ä¹ äº†è§£ï¼Œæ—¥åå¿…å®šæœ‰ç”¨ï¼\n\nå†å² Java æ–°ç‰¹æ€§å¹²è´§åˆ†äº«ï¼š\n\n![](http://img.javastack.cn/20190613135450.png)\n![](http://img.javastack.cn/20190613135537.png)\n\n\n\n","slug":"æ–°ç‰¹æ€§/Java12/Java 12 éªšæ“ä½œï¼Œ switchå±…ç„¶è¿˜èƒ½è¿™æ ·ç©ï¼","published":1,"updated":"2025-10-15T07:20:51.408Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu07770066qkd4giprgphe","content":"<p>Java 13 éƒ½å¿«è¦æ¥äº†ï¼Œ12å¿…é¡»è·Ÿæ ˆé•¿å­¦èµ·ï¼</p>\n<p><a href=\"https://mp.weixin.qq.com/s/Gg6KKz7vhDRpzeMR8CG4DA\">Java 13 å³å°†å‘å¸ƒï¼Œæ–°ç‰¹æ€§å¿…é¡»æŠ¢å…ˆçœ‹ï¼</a></p>\n<p><strong>é‚£ä¹ˆåœ¨ Java 12 ä¸­å¯ä»¥æ€æ ·ç© switch?</strong></p>\n<p>å…ˆæ¥å®šä¹‰ä¸€ä¸ªæšä¸¾ç±»ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public enum Status &#123;\n    OPEN, INIT, PROCESS, PENDING, CLOSE;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>Java 12 ä¹‹å‰æ˜¯è¿™æ ·ç”¨çš„ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void testSwitch1(Status status) &#123;\n    int result &#x3D; 0;\n    switch (status) &#123;\n        case OPEN:\n            result &#x3D; 1;\n            break;\n        case PROCESS:\n            result &#x3D; 2;\n            break;\n        case PENDING:\n            result &#x3D; 2;\n            break;\n        case CLOSE:\n            result &#x3D; 3;\n            break;\n        default:\n            throw new RuntimeException(&quot;çŠ¶æ€ä¸æ­£ç¡®&quot;);\n    &#125;\n    System.out.println(&quot;result is &quot; + result);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Java 12 åå¯ä»¥è¿™æ ·ç”¨ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void testSwitch2(Status status) &#123;\n    var result &#x3D; switch (status) &#123;\n        case OPEN -&gt; 1;\n        case PROCESS, PENDING -&gt; 2;\n        case CLOSE -&gt; 3;\n        default -&gt; throw new RuntimeException(&quot;çŠ¶æ€ä¸æ­£ç¡®&quot;);\n    &#125;;\n    System.out.println(&quot;result is &quot; + result);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¤ºä¾‹ä»£ç çœ‹äº†éƒ½æ‡‚å§ï¼Œæ˜¯ä¸æ˜¯å¾ˆéªšï¼Ÿ</p>\n<p>Java 12 switch æœ‰ä»¥ä¸‹å‡ ç‚¹ç‰¹è‰²ï¼š</p>\n<ul>\n<li>ç®­å¤´è¯­æ³• -&gt;ï¼Œç±»ä¼¼ Java 8 ä¸­çš„ Lambda è¡¨è¾¾å¼ï¼›</li>\n<li>å¯ä»¥ç›´æ¥è¿”å›å€¼ç»™ä¸€ä¸ªå˜é‡ï¼Œå¹¶ä¸”å¯ä»¥ä¸ç”¨ break å…³é”®å­—ï¼›</li>\n<li>case æ¡ä»¶ï¼Œå¤šä¸ªå¯ä»¥å†™åœ¨ä¸€è¡Œï¼Œç”¨é€—å·åˆ†å¼€ï¼›</li>\n<li>å¯ä»¥çœç•¥ break å…³é”®å­—ï¼›</li>\n</ul>\n<p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ break å…³é”®å­—ï¼Œåé¢è·Ÿå€¼ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void testSwitch3(Status status) &#123;\n    var result &#x3D; switch (status) &#123;\n        case OPEN -&gt; &#123;\n            break 1;\n        &#125;\n        case PROCESS, PENDING -&gt; &#123;\n            break 2;\n        &#125;\n        case CLOSE -&gt; &#123;\n            break 3;\n        &#125;\n        default -&gt; &#123;\n            break 5;\n        &#125;\n    &#125;;\n    System.out.println(&quot;result is &quot; + result);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä¸æ¨èç”¨è¿™ç§ï¼Œåœ¨ç¼–è¯‘å™¨ä¹Ÿä¼šæ˜¾ç¤ºç°è‰²ï¼Œå¹¶æç¤ºä½ æ›´æ”¹ã€‚</p>\n<p>æœ€åï¼Œè¿™ä¸ªæ–°ç‰¹æ€§æ˜¯ Java 12 é¢„è§ˆç‰ˆä¸­çš„ç‰¹æ€§ï¼š<code>JEP 325: Switch Expressions (Preview)</code>ï¼Œè¦ä½¿ç”¨è¿™ä¸ªæ–°ç‰¹æ€§ï¼Œè¯·åˆ‡æ¢è‡³ Java 12 é¢„è§ˆç‰ˆã€‚</p>\n<blockquote>\n<p>å‚è€ƒ <a href=\"https://openjdk.java.net/jeps/325\">https://openjdk.java.net/jeps/325</a></p>\n</blockquote>\n<p>å¥½äº†ï¼Œä»Šå¤©çš„åˆ†äº«å°±åˆ°è¿™ï¼Œæ”¶è—è½¬å‘ä¸€ä¸‹å§ï¼Œå¤šå­¦ä¹ äº†è§£ï¼Œæ—¥åå¿…å®šæœ‰ç”¨ï¼</p>\n<p>å†å² Java æ–°ç‰¹æ€§å¹²è´§åˆ†äº«ï¼š</p>\n<p><img src=\"http://img.javastack.cn/20190613135450.png\"><br><img src=\"http://img.javastack.cn/20190613135537.png\"></p>\n","excerpt":"","more":"<p>Java 13 éƒ½å¿«è¦æ¥äº†ï¼Œ12å¿…é¡»è·Ÿæ ˆé•¿å­¦èµ·ï¼</p>\n<p><a href=\"https://mp.weixin.qq.com/s/Gg6KKz7vhDRpzeMR8CG4DA\">Java 13 å³å°†å‘å¸ƒï¼Œæ–°ç‰¹æ€§å¿…é¡»æŠ¢å…ˆçœ‹ï¼</a></p>\n<p><strong>é‚£ä¹ˆåœ¨ Java 12 ä¸­å¯ä»¥æ€æ ·ç© switch?</strong></p>\n<p>å…ˆæ¥å®šä¹‰ä¸€ä¸ªæšä¸¾ç±»ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public enum Status &#123;\n    OPEN, INIT, PROCESS, PENDING, CLOSE;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>Java 12 ä¹‹å‰æ˜¯è¿™æ ·ç”¨çš„ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void testSwitch1(Status status) &#123;\n    int result &#x3D; 0;\n    switch (status) &#123;\n        case OPEN:\n            result &#x3D; 1;\n            break;\n        case PROCESS:\n            result &#x3D; 2;\n            break;\n        case PENDING:\n            result &#x3D; 2;\n            break;\n        case CLOSE:\n            result &#x3D; 3;\n            break;\n        default:\n            throw new RuntimeException(&quot;çŠ¶æ€ä¸æ­£ç¡®&quot;);\n    &#125;\n    System.out.println(&quot;result is &quot; + result);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>Java 12 åå¯ä»¥è¿™æ ·ç”¨ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void testSwitch2(Status status) &#123;\n    var result &#x3D; switch (status) &#123;\n        case OPEN -&gt; 1;\n        case PROCESS, PENDING -&gt; 2;\n        case CLOSE -&gt; 3;\n        default -&gt; throw new RuntimeException(&quot;çŠ¶æ€ä¸æ­£ç¡®&quot;);\n    &#125;;\n    System.out.println(&quot;result is &quot; + result);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¤ºä¾‹ä»£ç çœ‹äº†éƒ½æ‡‚å§ï¼Œæ˜¯ä¸æ˜¯å¾ˆéªšï¼Ÿ</p>\n<p>Java 12 switch æœ‰ä»¥ä¸‹å‡ ç‚¹ç‰¹è‰²ï¼š</p>\n<ul>\n<li>ç®­å¤´è¯­æ³• -&gt;ï¼Œç±»ä¼¼ Java 8 ä¸­çš„ Lambda è¡¨è¾¾å¼ï¼›</li>\n<li>å¯ä»¥ç›´æ¥è¿”å›å€¼ç»™ä¸€ä¸ªå˜é‡ï¼Œå¹¶ä¸”å¯ä»¥ä¸ç”¨ break å…³é”®å­—ï¼›</li>\n<li>case æ¡ä»¶ï¼Œå¤šä¸ªå¯ä»¥å†™åœ¨ä¸€è¡Œï¼Œç”¨é€—å·åˆ†å¼€ï¼›</li>\n<li>å¯ä»¥çœç•¥ break å…³é”®å­—ï¼›</li>\n</ul>\n<p>å½“ç„¶ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ break å…³é”®å­—ï¼Œåé¢è·Ÿå€¼ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void testSwitch3(Status status) &#123;\n    var result &#x3D; switch (status) &#123;\n        case OPEN -&gt; &#123;\n            break 1;\n        &#125;\n        case PROCESS, PENDING -&gt; &#123;\n            break 2;\n        &#125;\n        case CLOSE -&gt; &#123;\n            break 3;\n        &#125;\n        default -&gt; &#123;\n            break 5;\n        &#125;\n    &#125;;\n    System.out.println(&quot;result is &quot; + result);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä¸æ¨èç”¨è¿™ç§ï¼Œåœ¨ç¼–è¯‘å™¨ä¹Ÿä¼šæ˜¾ç¤ºç°è‰²ï¼Œå¹¶æç¤ºä½ æ›´æ”¹ã€‚</p>\n<p>æœ€åï¼Œè¿™ä¸ªæ–°ç‰¹æ€§æ˜¯ Java 12 é¢„è§ˆç‰ˆä¸­çš„ç‰¹æ€§ï¼š<code>JEP 325: Switch Expressions (Preview)</code>ï¼Œè¦ä½¿ç”¨è¿™ä¸ªæ–°ç‰¹æ€§ï¼Œè¯·åˆ‡æ¢è‡³ Java 12 é¢„è§ˆç‰ˆã€‚</p>\n<blockquote>\n<p>å‚è€ƒ <a href=\"https://openjdk.java.net/jeps/325\">https://openjdk.java.net/jeps/325</a></p>\n</blockquote>\n<p>å¥½äº†ï¼Œä»Šå¤©çš„åˆ†äº«å°±åˆ°è¿™ï¼Œæ”¶è—è½¬å‘ä¸€ä¸‹å§ï¼Œå¤šå­¦ä¹ äº†è§£ï¼Œæ—¥åå¿…å®šæœ‰ç”¨ï¼</p>\n<p>å†å² Java æ–°ç‰¹æ€§å¹²è´§åˆ†äº«ï¼š</p>\n<p><img src=\"http://img.javastack.cn/20190613135450.png\"><br><img src=\"http://img.javastack.cn/20190613135537.png\"></p>\n"},{"title":"Java 12 éªšæ“ä½œï¼Œ æ–‡ä»¶æ¯”å¯¹å±…ç„¶è¿˜èƒ½è¿™æ ·ç©ï¼","date":"2025-10-15T03:36:33.000Z","_content":"Java 13 éƒ½å¿«è¦æ¥äº†ï¼Œ12å¿…é¡»è·Ÿæ ˆé•¿å­¦èµ·ï¼\n\n[Java 13 å³å°†å‘å¸ƒï¼Œæ–°ç‰¹æ€§å¿…é¡»æŠ¢å…ˆçœ‹ï¼](https://mp.weixin.qq.com/s/Gg6KKz7vhDRpzeMR8CG4DA)\n\nä¹‹å‰åˆ†äº«äº†ä¸€äº› Java 12 çš„éªšæ“ä½œï¼Œä»Šå¤©ç»§ç»­ï¼Œä»Šå¤©è¦åˆ†äº«çš„æ˜¯ Java 12 ä¸­çš„æ–‡ä»¶æ¯”å¯¹éªšæ“ä½œã€‚\n\n**æˆ‘ä»¬æˆ–å¤šæˆ–å°‘ä¼šé‡åˆ°è¿™æ ·çš„éœ€æ±‚ï¼šæ€ä¹ˆæ¯”å¯¹ä¸¤ä¸ªæ–‡ä»¶ä¸­çš„å†…å®¹ä¸€æ ·ï¼Ÿ**\n\nä½ ä¼šæŠŠä¸¤ä¸ªæ–‡ä»¶ä¸­çš„å†…å®¹æ‹‰å‡ºæ¥ä¸€ä¸ªä¸ªå­—ç¬¦å¯¹æ¯”ï¼Œç„¶åæäº¤ä¸€å¤§å †ä¸æ€ä¹ˆä¼˜é›…çš„ä»£ç ï¼Ÿ\n\nè¿™æ ·ä½ å°±å¤ª OUT äº†ï¼\n\nåœ¨ Java 12 ä¸­ï¼Œä»…éœ€è¦ 1 è¡Œä»£ç å³å¯æå®šï¼\n\næ¥çœ‹ç¤ºä¾‹ä»£ç ï¼š\n\n```\npublic static void main(String[] args) throws IOException {\n    Path dir = Paths.get(\"d:/\");\n\n    Path path1 = dir.resolve(\"javastack1.txt\");\n\n    Path path2 = dir.resolve(\"javastack2.txt\");\n\n    long result = Files.mismatch(path1, path2);\n\n    System.out.println(result);\n}\n```\n\n**Files.mismatch ä¸€è¡Œæå®šï¼**\n\njavastack1 å’Œ javastack2 çš„å†…å®¹éƒ½æ˜¯ï¼š\n\n```\nwww.javastack.cn\n```\n\nè¿™æ—¶å€™è¾“å‡ºç»“æœï¼š-1ã€‚\n\nç°åœ¨æŠŠ javastack2 çš„å†…å®¹æ”¹æˆï¼š\n\n```\nhttp://www.javastack.cn\n```\n\nè¿™æ—¶å€™è¾“å‡ºç»“æœï¼š0ã€‚\n\nå†æŠŠ javastack2 çš„å†…å®¹æ”¹æˆï¼š\n\n```\nwww.javastack.cn/\n```\n\nè¿™æ—¶å€™è¾“å‡ºç»“æœï¼š16ã€‚\n\n**Files.mismatch**\n\nFiles.mismatchæ–¹æ³•æºç å¦‚ä¸‹ï¼š\n\n```\npublic static long mismatch(Path path, Path path2) throws IOException {\n    if (isSameFile(path, path2)) {\n        return -1;\n    }\n    byte[] buffer1 = new byte[BUFFER_SIZE];\n    byte[] buffer2 = new byte[BUFFER_SIZE];\n    try (InputStream in1 = Files.newInputStream(path);\n         InputStream in2 = Files.newInputStream(path2);) {\n        long totalRead = 0;\n        while (true) {\n            int nRead1 = in1.readNBytes(buffer1, 0, BUFFER_SIZE);\n            int nRead2 = in2.readNBytes(buffer2, 0, BUFFER_SIZE);\n\n            int i = Arrays.mismatch(buffer1, 0, nRead1, buffer2, 0, nRead2);\n            if (i > -1) {\n                return totalRead + i;\n            }\n            if (nRead1 < BUFFER_SIZE) {\n                // we've reached the end of the files, but found no mismatch\n                return -1;\n            }\n            totalRead += nRead1;\n        }\n    }\n}\n```\n\n- è¿”å›-1ï¼šåŒä¸€æ–‡ä»¶ï¼Œæˆ–è€…ä¸¤ä¸ªæ–‡ä»¶å†…å®¹ä¸€æ ·\n- è¿”å›å…¶ä»–æ•°å­—ï¼šæ–‡ä»¶å†…å®¹å¯¹æ¯”å·®å¼‚çš„ä½ç½®ï¼Œä»0å¼€å§‹\n\n**æ‰€ä»¥ï¼Œåªè¦è¿”å› -1ï¼Œè¯´æ˜æ–‡ä»¶å†…å®¹ç›¸åŒã€‚**\n\nå¥½äº†ï¼Œä»Šå¤©çš„åˆ†äº«å°±åˆ°è¿™ï¼Œè®°ä½äº†ï¼Œåˆ«è¯´æˆ‘æ²¡å‘Šè¯‰ä½ ã€‚ã€‚\n\næ”¶è—è½¬å‘ä¸€ä¸‹å§ï¼Œå¤šå­¦ä¹ äº†è§£ï¼Œæ—¥åå¿…å®šæœ‰ç”¨ï¼\n\nå†å² Java æ–°ç‰¹æ€§å¹²è´§åˆ†äº«ï¼š\n\n![](http://img.javastack.cn/20190613135450.png)\n![](http://img.javastack.cn/20190613135537.png)\n\n\n\n","source":"_posts/æ–°ç‰¹æ€§/Java12/Java 12 éªšæ“ä½œï¼Œ æ–‡ä»¶æ¯”å¯¹å±…ç„¶è¿˜èƒ½è¿™æ ·ç©ï¼.md","raw":"---\ntitle: Java 12 éªšæ“ä½œï¼Œ æ–‡ä»¶æ¯”å¯¹å±…ç„¶è¿˜èƒ½è¿™æ ·ç©ï¼\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: æ–°ç‰¹æ€§\n---\nJava 13 éƒ½å¿«è¦æ¥äº†ï¼Œ12å¿…é¡»è·Ÿæ ˆé•¿å­¦èµ·ï¼\n\n[Java 13 å³å°†å‘å¸ƒï¼Œæ–°ç‰¹æ€§å¿…é¡»æŠ¢å…ˆçœ‹ï¼](https://mp.weixin.qq.com/s/Gg6KKz7vhDRpzeMR8CG4DA)\n\nä¹‹å‰åˆ†äº«äº†ä¸€äº› Java 12 çš„éªšæ“ä½œï¼Œä»Šå¤©ç»§ç»­ï¼Œä»Šå¤©è¦åˆ†äº«çš„æ˜¯ Java 12 ä¸­çš„æ–‡ä»¶æ¯”å¯¹éªšæ“ä½œã€‚\n\n**æˆ‘ä»¬æˆ–å¤šæˆ–å°‘ä¼šé‡åˆ°è¿™æ ·çš„éœ€æ±‚ï¼šæ€ä¹ˆæ¯”å¯¹ä¸¤ä¸ªæ–‡ä»¶ä¸­çš„å†…å®¹ä¸€æ ·ï¼Ÿ**\n\nä½ ä¼šæŠŠä¸¤ä¸ªæ–‡ä»¶ä¸­çš„å†…å®¹æ‹‰å‡ºæ¥ä¸€ä¸ªä¸ªå­—ç¬¦å¯¹æ¯”ï¼Œç„¶åæäº¤ä¸€å¤§å †ä¸æ€ä¹ˆä¼˜é›…çš„ä»£ç ï¼Ÿ\n\nè¿™æ ·ä½ å°±å¤ª OUT äº†ï¼\n\nåœ¨ Java 12 ä¸­ï¼Œä»…éœ€è¦ 1 è¡Œä»£ç å³å¯æå®šï¼\n\næ¥çœ‹ç¤ºä¾‹ä»£ç ï¼š\n\n```\npublic static void main(String[] args) throws IOException {\n    Path dir = Paths.get(\"d:/\");\n\n    Path path1 = dir.resolve(\"javastack1.txt\");\n\n    Path path2 = dir.resolve(\"javastack2.txt\");\n\n    long result = Files.mismatch(path1, path2);\n\n    System.out.println(result);\n}\n```\n\n**Files.mismatch ä¸€è¡Œæå®šï¼**\n\njavastack1 å’Œ javastack2 çš„å†…å®¹éƒ½æ˜¯ï¼š\n\n```\nwww.javastack.cn\n```\n\nè¿™æ—¶å€™è¾“å‡ºç»“æœï¼š-1ã€‚\n\nç°åœ¨æŠŠ javastack2 çš„å†…å®¹æ”¹æˆï¼š\n\n```\nhttp://www.javastack.cn\n```\n\nè¿™æ—¶å€™è¾“å‡ºç»“æœï¼š0ã€‚\n\nå†æŠŠ javastack2 çš„å†…å®¹æ”¹æˆï¼š\n\n```\nwww.javastack.cn/\n```\n\nè¿™æ—¶å€™è¾“å‡ºç»“æœï¼š16ã€‚\n\n**Files.mismatch**\n\nFiles.mismatchæ–¹æ³•æºç å¦‚ä¸‹ï¼š\n\n```\npublic static long mismatch(Path path, Path path2) throws IOException {\n    if (isSameFile(path, path2)) {\n        return -1;\n    }\n    byte[] buffer1 = new byte[BUFFER_SIZE];\n    byte[] buffer2 = new byte[BUFFER_SIZE];\n    try (InputStream in1 = Files.newInputStream(path);\n         InputStream in2 = Files.newInputStream(path2);) {\n        long totalRead = 0;\n        while (true) {\n            int nRead1 = in1.readNBytes(buffer1, 0, BUFFER_SIZE);\n            int nRead2 = in2.readNBytes(buffer2, 0, BUFFER_SIZE);\n\n            int i = Arrays.mismatch(buffer1, 0, nRead1, buffer2, 0, nRead2);\n            if (i > -1) {\n                return totalRead + i;\n            }\n            if (nRead1 < BUFFER_SIZE) {\n                // we've reached the end of the files, but found no mismatch\n                return -1;\n            }\n            totalRead += nRead1;\n        }\n    }\n}\n```\n\n- è¿”å›-1ï¼šåŒä¸€æ–‡ä»¶ï¼Œæˆ–è€…ä¸¤ä¸ªæ–‡ä»¶å†…å®¹ä¸€æ ·\n- è¿”å›å…¶ä»–æ•°å­—ï¼šæ–‡ä»¶å†…å®¹å¯¹æ¯”å·®å¼‚çš„ä½ç½®ï¼Œä»0å¼€å§‹\n\n**æ‰€ä»¥ï¼Œåªè¦è¿”å› -1ï¼Œè¯´æ˜æ–‡ä»¶å†…å®¹ç›¸åŒã€‚**\n\nå¥½äº†ï¼Œä»Šå¤©çš„åˆ†äº«å°±åˆ°è¿™ï¼Œè®°ä½äº†ï¼Œåˆ«è¯´æˆ‘æ²¡å‘Šè¯‰ä½ ã€‚ã€‚\n\næ”¶è—è½¬å‘ä¸€ä¸‹å§ï¼Œå¤šå­¦ä¹ äº†è§£ï¼Œæ—¥åå¿…å®šæœ‰ç”¨ï¼\n\nå†å² Java æ–°ç‰¹æ€§å¹²è´§åˆ†äº«ï¼š\n\n![](http://img.javastack.cn/20190613135450.png)\n![](http://img.javastack.cn/20190613135537.png)\n\n\n\n","slug":"æ–°ç‰¹æ€§/Java12/Java 12 éªšæ“ä½œï¼Œ æ–‡ä»¶æ¯”å¯¹å±…ç„¶è¿˜èƒ½è¿™æ ·ç©ï¼","published":1,"updated":"2025-10-15T07:20:51.380Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu07770069qkd4ga92fel1","content":"<p>Java 13 éƒ½å¿«è¦æ¥äº†ï¼Œ12å¿…é¡»è·Ÿæ ˆé•¿å­¦èµ·ï¼</p>\n<p><a href=\"https://mp.weixin.qq.com/s/Gg6KKz7vhDRpzeMR8CG4DA\">Java 13 å³å°†å‘å¸ƒï¼Œæ–°ç‰¹æ€§å¿…é¡»æŠ¢å…ˆçœ‹ï¼</a></p>\n<p>ä¹‹å‰åˆ†äº«äº†ä¸€äº› Java 12 çš„éªšæ“ä½œï¼Œä»Šå¤©ç»§ç»­ï¼Œä»Šå¤©è¦åˆ†äº«çš„æ˜¯ Java 12 ä¸­çš„æ–‡ä»¶æ¯”å¯¹éªšæ“ä½œã€‚</p>\n<p><strong>æˆ‘ä»¬æˆ–å¤šæˆ–å°‘ä¼šé‡åˆ°è¿™æ ·çš„éœ€æ±‚ï¼šæ€ä¹ˆæ¯”å¯¹ä¸¤ä¸ªæ–‡ä»¶ä¸­çš„å†…å®¹ä¸€æ ·ï¼Ÿ</strong></p>\n<p>ä½ ä¼šæŠŠä¸¤ä¸ªæ–‡ä»¶ä¸­çš„å†…å®¹æ‹‰å‡ºæ¥ä¸€ä¸ªä¸ªå­—ç¬¦å¯¹æ¯”ï¼Œç„¶åæäº¤ä¸€å¤§å †ä¸æ€ä¹ˆä¼˜é›…çš„ä»£ç ï¼Ÿ</p>\n<p>è¿™æ ·ä½ å°±å¤ª OUT äº†ï¼</p>\n<p>åœ¨ Java 12 ä¸­ï¼Œä»…éœ€è¦ 1 è¡Œä»£ç å³å¯æå®šï¼</p>\n<p>æ¥çœ‹ç¤ºä¾‹ä»£ç ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) throws IOException &#123;\n    Path dir &#x3D; Paths.get(&quot;d:&#x2F;&quot;);\n\n    Path path1 &#x3D; dir.resolve(&quot;javastack1.txt&quot;);\n\n    Path path2 &#x3D; dir.resolve(&quot;javastack2.txt&quot;);\n\n    long result &#x3D; Files.mismatch(path1, path2);\n\n    System.out.println(result);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>Files.mismatch ä¸€è¡Œæå®šï¼</strong></p>\n<p>javastack1 å’Œ javastack2 çš„å†…å®¹éƒ½æ˜¯ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">www.javastack.cn<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>è¿™æ—¶å€™è¾“å‡ºç»“æœï¼š-1ã€‚</p>\n<p>ç°åœ¨æŠŠ javastack2 çš„å†…å®¹æ”¹æˆï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;www.javastack.cn<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>è¿™æ—¶å€™è¾“å‡ºç»“æœï¼š0ã€‚</p>\n<p>å†æŠŠ javastack2 çš„å†…å®¹æ”¹æˆï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">www.javastack.cn&#x2F;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>è¿™æ—¶å€™è¾“å‡ºç»“æœï¼š16ã€‚</p>\n<p><strong>Files.mismatch</strong></p>\n<p>Files.mismatchæ–¹æ³•æºç å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static long mismatch(Path path, Path path2) throws IOException &#123;\n    if (isSameFile(path, path2)) &#123;\n        return -1;\n    &#125;\n    byte[] buffer1 &#x3D; new byte[BUFFER_SIZE];\n    byte[] buffer2 &#x3D; new byte[BUFFER_SIZE];\n    try (InputStream in1 &#x3D; Files.newInputStream(path);\n         InputStream in2 &#x3D; Files.newInputStream(path2);) &#123;\n        long totalRead &#x3D; 0;\n        while (true) &#123;\n            int nRead1 &#x3D; in1.readNBytes(buffer1, 0, BUFFER_SIZE);\n            int nRead2 &#x3D; in2.readNBytes(buffer2, 0, BUFFER_SIZE);\n\n            int i &#x3D; Arrays.mismatch(buffer1, 0, nRead1, buffer2, 0, nRead2);\n            if (i &gt; -1) &#123;\n                return totalRead + i;\n            &#125;\n            if (nRead1 &lt; BUFFER_SIZE) &#123;\n                &#x2F;&#x2F; we&#39;ve reached the end of the files, but found no mismatch\n                return -1;\n            &#125;\n            totalRead +&#x3D; nRead1;\n        &#125;\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>è¿”å›-1ï¼šåŒä¸€æ–‡ä»¶ï¼Œæˆ–è€…ä¸¤ä¸ªæ–‡ä»¶å†…å®¹ä¸€æ ·</li>\n<li>è¿”å›å…¶ä»–æ•°å­—ï¼šæ–‡ä»¶å†…å®¹å¯¹æ¯”å·®å¼‚çš„ä½ç½®ï¼Œä»0å¼€å§‹</li>\n</ul>\n<p><strong>æ‰€ä»¥ï¼Œåªè¦è¿”å› -1ï¼Œè¯´æ˜æ–‡ä»¶å†…å®¹ç›¸åŒã€‚</strong></p>\n<p>å¥½äº†ï¼Œä»Šå¤©çš„åˆ†äº«å°±åˆ°è¿™ï¼Œè®°ä½äº†ï¼Œåˆ«è¯´æˆ‘æ²¡å‘Šè¯‰ä½ ã€‚ã€‚</p>\n<p>æ”¶è—è½¬å‘ä¸€ä¸‹å§ï¼Œå¤šå­¦ä¹ äº†è§£ï¼Œæ—¥åå¿…å®šæœ‰ç”¨ï¼</p>\n<p>å†å² Java æ–°ç‰¹æ€§å¹²è´§åˆ†äº«ï¼š</p>\n<p><img src=\"http://img.javastack.cn/20190613135450.png\"><br><img src=\"http://img.javastack.cn/20190613135537.png\"></p>\n","excerpt":"","more":"<p>Java 13 éƒ½å¿«è¦æ¥äº†ï¼Œ12å¿…é¡»è·Ÿæ ˆé•¿å­¦èµ·ï¼</p>\n<p><a href=\"https://mp.weixin.qq.com/s/Gg6KKz7vhDRpzeMR8CG4DA\">Java 13 å³å°†å‘å¸ƒï¼Œæ–°ç‰¹æ€§å¿…é¡»æŠ¢å…ˆçœ‹ï¼</a></p>\n<p>ä¹‹å‰åˆ†äº«äº†ä¸€äº› Java 12 çš„éªšæ“ä½œï¼Œä»Šå¤©ç»§ç»­ï¼Œä»Šå¤©è¦åˆ†äº«çš„æ˜¯ Java 12 ä¸­çš„æ–‡ä»¶æ¯”å¯¹éªšæ“ä½œã€‚</p>\n<p><strong>æˆ‘ä»¬æˆ–å¤šæˆ–å°‘ä¼šé‡åˆ°è¿™æ ·çš„éœ€æ±‚ï¼šæ€ä¹ˆæ¯”å¯¹ä¸¤ä¸ªæ–‡ä»¶ä¸­çš„å†…å®¹ä¸€æ ·ï¼Ÿ</strong></p>\n<p>ä½ ä¼šæŠŠä¸¤ä¸ªæ–‡ä»¶ä¸­çš„å†…å®¹æ‹‰å‡ºæ¥ä¸€ä¸ªä¸ªå­—ç¬¦å¯¹æ¯”ï¼Œç„¶åæäº¤ä¸€å¤§å †ä¸æ€ä¹ˆä¼˜é›…çš„ä»£ç ï¼Ÿ</p>\n<p>è¿™æ ·ä½ å°±å¤ª OUT äº†ï¼</p>\n<p>åœ¨ Java 12 ä¸­ï¼Œä»…éœ€è¦ 1 è¡Œä»£ç å³å¯æå®šï¼</p>\n<p>æ¥çœ‹ç¤ºä¾‹ä»£ç ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static void main(String[] args) throws IOException &#123;\n    Path dir &#x3D; Paths.get(&quot;d:&#x2F;&quot;);\n\n    Path path1 &#x3D; dir.resolve(&quot;javastack1.txt&quot;);\n\n    Path path2 &#x3D; dir.resolve(&quot;javastack2.txt&quot;);\n\n    long result &#x3D; Files.mismatch(path1, path2);\n\n    System.out.println(result);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>Files.mismatch ä¸€è¡Œæå®šï¼</strong></p>\n<p>javastack1 å’Œ javastack2 çš„å†…å®¹éƒ½æ˜¯ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">www.javastack.cn<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>è¿™æ—¶å€™è¾“å‡ºç»“æœï¼š-1ã€‚</p>\n<p>ç°åœ¨æŠŠ javastack2 çš„å†…å®¹æ”¹æˆï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">http:&#x2F;&#x2F;www.javastack.cn<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>è¿™æ—¶å€™è¾“å‡ºç»“æœï¼š0ã€‚</p>\n<p>å†æŠŠ javastack2 çš„å†…å®¹æ”¹æˆï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">www.javastack.cn&#x2F;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span></span></code></pre>\n\n<p>è¿™æ—¶å€™è¾“å‡ºç»“æœï¼š16ã€‚</p>\n<p><strong>Files.mismatch</strong></p>\n<p>Files.mismatchæ–¹æ³•æºç å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static long mismatch(Path path, Path path2) throws IOException &#123;\n    if (isSameFile(path, path2)) &#123;\n        return -1;\n    &#125;\n    byte[] buffer1 &#x3D; new byte[BUFFER_SIZE];\n    byte[] buffer2 &#x3D; new byte[BUFFER_SIZE];\n    try (InputStream in1 &#x3D; Files.newInputStream(path);\n         InputStream in2 &#x3D; Files.newInputStream(path2);) &#123;\n        long totalRead &#x3D; 0;\n        while (true) &#123;\n            int nRead1 &#x3D; in1.readNBytes(buffer1, 0, BUFFER_SIZE);\n            int nRead2 &#x3D; in2.readNBytes(buffer2, 0, BUFFER_SIZE);\n\n            int i &#x3D; Arrays.mismatch(buffer1, 0, nRead1, buffer2, 0, nRead2);\n            if (i &gt; -1) &#123;\n                return totalRead + i;\n            &#125;\n            if (nRead1 &lt; BUFFER_SIZE) &#123;\n                &#x2F;&#x2F; we&#39;ve reached the end of the files, but found no mismatch\n                return -1;\n            &#125;\n            totalRead +&#x3D; nRead1;\n        &#125;\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li>è¿”å›-1ï¼šåŒä¸€æ–‡ä»¶ï¼Œæˆ–è€…ä¸¤ä¸ªæ–‡ä»¶å†…å®¹ä¸€æ ·</li>\n<li>è¿”å›å…¶ä»–æ•°å­—ï¼šæ–‡ä»¶å†…å®¹å¯¹æ¯”å·®å¼‚çš„ä½ç½®ï¼Œä»0å¼€å§‹</li>\n</ul>\n<p><strong>æ‰€ä»¥ï¼Œåªè¦è¿”å› -1ï¼Œè¯´æ˜æ–‡ä»¶å†…å®¹ç›¸åŒã€‚</strong></p>\n<p>å¥½äº†ï¼Œä»Šå¤©çš„åˆ†äº«å°±åˆ°è¿™ï¼Œè®°ä½äº†ï¼Œåˆ«è¯´æˆ‘æ²¡å‘Šè¯‰ä½ ã€‚ã€‚</p>\n<p>æ”¶è—è½¬å‘ä¸€ä¸‹å§ï¼Œå¤šå­¦ä¹ äº†è§£ï¼Œæ—¥åå¿…å®šæœ‰ç”¨ï¼</p>\n<p>å†å² Java æ–°ç‰¹æ€§å¹²è´§åˆ†äº«ï¼š</p>\n<p><img src=\"http://img.javastack.cn/20190613135450.png\"><br><img src=\"http://img.javastack.cn/20190613135537.png\"></p>\n"},{"title":"Java9 ç®€åŒ–æµå…³é—­æ–°å§¿åŠ¿","date":"2025-10-15T03:36:33.000Z","_content":"![](http://img.javastack.cn/18-2-27/87594869.jpg)\n\nåšJavaå¼€å‘çš„éƒ½çŸ¥é“ï¼Œæ¯ä¸ªèµ„æºçš„æ‰“å¼€éƒ½éœ€è¦å¯¹åº”çš„å…³é—­æ“ä½œï¼Œä¸ç„¶å°±ä¼šä½¿èµ„æºä¸€ç›´å ç”¨è€Œé€ æˆèµ„æºæµªè´¹ï¼Œä»è€Œé™ä½ç³»ç»Ÿæ€§èƒ½ã€‚\n\nå…³äºèµ„æºçš„å…³é—­æ“ä½œï¼Œä»JDK7-JDK9æœ‰äº†ä¸å°‘çš„æå‡åŠç®€åŒ–ã€‚\n\n#### JDK6\n\nåœ¨JDK6åŠä¹‹å‰ï¼Œæ¯ä¸ªèµ„æºéƒ½éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å†™ä»£ç å…³é—­ï¼Œå¦‚ï¼š\n\n```\nFileInputStream fis = null;\nbyte[] buffer = new byte[1024];\ntry {\n\tfis = new FileInputStream(new File(\"E:\\\\JavaæŠ€æœ¯.txt\"));\n\twhile (fis.read(buffer) > 0) {\n\t\tSystem.out.println(new String(buffer));\n\t}\n} catch (Exception e) {\n\te.printStackTrace();\n} finally {\n\tif (fis != null) {\n\t\ttry {\n\t\t\tfis.close();\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n}\n```\n\nèµ„æºæ‰“å¼€ä½¿ç”¨å®Œåï¼Œå¿…é¡»åœ¨finallyå—ä¸­è¿›è¡Œæ‰‹åŠ¨å…³é—­ï¼æˆ‘ä»¬æœ‰çš„åŒäº‹ï¼Œåšä¸€ä¸ªæŸ¥è¯¢åŠŸèƒ½ç‚¹ï¼Œæ‰“å¼€äº†è¿æ¥æŸ¥è¯¢å®Œåæ²¡æœ‰æ‰‹åŠ¨å…³é—­ï¼Œæœ€åé€ æˆè¿æ¥æ± è¶…å‡ºæœ€å¤§è¿æ¥æ•°è€Œä½¿ç³»ç»ŸåŠŸèƒ½å µå¡ã€‚\n\n#### JDK7\n\nJDK7å‘å¸ƒåï¼Œæ·»åŠ äº†æ–°ç‰¹æ€§ï¼štry-with-resourcesè¯­å¥ã€‚æ‰€æœ‰éœ€è¦å…³é—­çš„èµ„æºåªè¦å®ç°äº†`java.lang.AutoCloseable`ï¼ˆjava.io.Closeableå°±å®ç°äº†è¿™ä¸ªæ¥å£ï¼‰æ¥å£å°±åœ¨ä¼šç¨‹åºç»“æŸåè‡ªåŠ¨å…³é—­ã€‚\n\nå¦‚ä¸Šé¢çš„è¯»å–æ–‡ä»¶çš„æµç¨‹åºç”¨JDK7æ¥å†™ï¼š\n\n```\nbyte[] buffer = new byte[1024];\ntry (FileInputStream fis = new FileInputStream(new File(\"E:\\\\JavaæŠ€æœ¯.txt\"))) {\n\twhile (fis.read(buffer) > 0) {\n\t\tSystem.out.println(new String(buffer));\n\t}\n} catch (Exception e) {\n\te.printStackTrace();\n}\n```\n\næ‰€æœ‰çš„èµ„æºåœ¨`try()`é‡Œé¢å®šä¹‰ï¼Œå¹¶å»æ‰äº†finallyæ¨¡å—ã€‚\n\nä¸‹é¢æˆ‘ä»¬æ¥å†™ä¸€ä¸ªè‡ªå®šä¹‰çš„æµæ¥çœ‹çœ‹æ˜¯å¦è‡ªåŠ¨å…³é—­äº†ã€‚\n\n**å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰è¾“å…¥è¾“å‡ºæµ**\n\n```\nclass MyInputStream implements AutoCloseable {\n\n\tvoid read(String content) {\n\t\tSystem.out.println(\"read content \" + content);\n\t}\n\n\t@Override\n\tpublic void close() throws Exception {\n\t\tSystem.out.println(\"input stream is closed.\");\n\t}\n\n}\n\nclass MyOutputStream implements AutoCloseable {\n\n\tvoid write(String content) {\n\t\tSystem.out.println(\"write content \" + content);\n\t}\n\n\t@Override\n\tpublic void close() throws Exception {\n\t\tSystem.out.println(\"out stream is closed.\");\n\t}\n\n}\n```\n\n**å•ä¸ªèµ„æºè‡ªåŠ¨å…³é—­**\n\n```\ntry (MyInputStream mis = new MyInputStream()) {\n\tmis.read(\"7_2\");\n} catch (Exception e) {\n\te.printStackTrace();\n}\n```\n\nè¾“å‡ºï¼š\n\n> read content 7_2\\\n> input stream is closed.\n\n**å¤šä¸ªèµ„æºè‡ªåŠ¨å…³é—­**\n\n`try()`é‡Œé¢å¯ä»¥å®šä¹‰å¤šä¸ªèµ„æºï¼Œå®ƒä»¬çš„å…³é—­é¡ºåºæ˜¯æœ€ååœ¨`try()`å®šä¹‰çš„èµ„æºå…ˆå…³é—­ã€‚\n\n```\ntry (MyInputStream mis = new MyInputStream(); MyOutputStream mos = new MyOutputStream()) {\n\tmis.read(\"7_3\");\n\tmos.write(\"7_3\");\n} catch (Exception e) {\n\te.printStackTrace();\n}\n```\n\nè¾“å‡ºï¼š\n\n> read content 7_3\\\n> write content 7_3\\\n> out stream is closed.\\\n> input stream is closed.\n\n#### JDK9\n\nJDK9å‘å¸ƒåï¼Œåˆç®€åŒ–äº†try-with-resourcesè¯­å¥çš„ç”¨æ³•ã€‚\n\n`try()`é‡Œé¢å¯ä»¥æ˜¯ä¸€ä¸ªå˜é‡ï¼Œä½†å¿…é¡»æ˜¯finalçš„æˆ–è€…ç­‰åŒfinalæ‰è¡Œã€‚å¦‚ä¸‹é¢çš„misï¼Œmoså®šä¹‰æˆå±€éƒ¨å˜é‡å¯ä»¥ä¸ç”¨finalï¼Œå±€éƒ¨å˜é‡å¯ä»¥ç­‰åŒäºfinalï¼Œä½†å®šä¹‰æˆæˆå‘˜å˜é‡å°±å¿…é¡»æ˜¯ç”¨finalä¿®é¥°çš„ï¼Œä¸ç„¶ä¼šç¼–è¯‘é”™è¯¯ã€‚\n\n```\nMyInputStream mis = new MyInputStream();\nMyOutputStream mos = new MyOutputStream();\ntry (mis; mos) {\n\tmis.read(\"1.9\");\n\tmos.write(\"1.9\");\n} catch (Exception e) {\n\te.printStackTrace();\n}\n```\n\nè¾“å‡ºï¼š\n\n> read content 1.9\\\n> write content 1.9\\\n> out stream is closed.\\\n> input stream is closed.\n\nå†æ¥çœ‹ä¸ªä¾‹å­ï¼š\n\n```\nConnection dbCon = DriverManager.getConnection(\"url\", \"user\", \"password\");\ntry (dbCon; ResultSet rs = dbCon.createStatement().executeQuery(\"select * from emp\")) {\n    while (rs.next()) {\n        System.out.println(\"In loadDataFromDB() =====>>>>>>>>>>>> \" + rs.getString(1));\n    }\n} catch (SQLException e) {\n    System.out.println(\"Exception occurs while reading the data from DB ->\" + e.getMessage());\n}\n```\n\ndbConå’Œrséƒ½èƒ½è¢«è‡ªåŠ¨å…³é—­ã€‚\n\nJKD9è™½ç„¶ç®€åŒ–äº†ï¼Œä½†æ„Ÿè§‰è¿˜æ˜¯æ²¡æœ‰ä»€ä¹ˆè´¨çš„å˜åŒ–ï¼Œå®é™…ç”¨é€”æˆ‘ä»¬å¯èƒ½ä¸å¸Œæœ›å…³å¿ƒèµ„æºçš„å…³é—­ï¼Œæˆ–è€…åœ¨æ–¹æ³•ç»“æŸä¹‹åå¦‚æœæ˜¯å±€éƒ¨å˜é‡å®ƒå°±èƒ½è‡ªåŠ¨å…³é—­ã€‚æˆ–è®¸æ˜¯æˆ‘ç«™çš„é«˜åº¦ä¸å¤Ÿï¼Œå®˜æ–¹æœ‰å…¶ä»–çš„è€ƒé‡ï¼Œä½†JDK9çš„è¿™ä¸€ç‚¹å˜åŒ–è¿˜æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚\n\næ›´å¤šJDK9çš„æ–°åŠŸèƒ½å®æˆ˜é™†ç»­æ›´æ–°ï¼Œå¦‚æœè§‰å¾—æœ‰ç”¨ï¼Œåˆ†äº«åˆ°æœ‹å‹åœˆç»™æ›´å¤šçš„äººå§ï¼\n\n","source":"_posts/æ–°ç‰¹æ€§/Java9/Java9 ç®€åŒ–æµå…³é—­æ–°å§¿åŠ¿.md","raw":"---\ntitle: Java9 ç®€åŒ–æµå…³é—­æ–°å§¿åŠ¿\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: æ–°ç‰¹æ€§\n---\n![](http://img.javastack.cn/18-2-27/87594869.jpg)\n\nåšJavaå¼€å‘çš„éƒ½çŸ¥é“ï¼Œæ¯ä¸ªèµ„æºçš„æ‰“å¼€éƒ½éœ€è¦å¯¹åº”çš„å…³é—­æ“ä½œï¼Œä¸ç„¶å°±ä¼šä½¿èµ„æºä¸€ç›´å ç”¨è€Œé€ æˆèµ„æºæµªè´¹ï¼Œä»è€Œé™ä½ç³»ç»Ÿæ€§èƒ½ã€‚\n\nå…³äºèµ„æºçš„å…³é—­æ“ä½œï¼Œä»JDK7-JDK9æœ‰äº†ä¸å°‘çš„æå‡åŠç®€åŒ–ã€‚\n\n#### JDK6\n\nåœ¨JDK6åŠä¹‹å‰ï¼Œæ¯ä¸ªèµ„æºéƒ½éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å†™ä»£ç å…³é—­ï¼Œå¦‚ï¼š\n\n```\nFileInputStream fis = null;\nbyte[] buffer = new byte[1024];\ntry {\n\tfis = new FileInputStream(new File(\"E:\\\\JavaæŠ€æœ¯.txt\"));\n\twhile (fis.read(buffer) > 0) {\n\t\tSystem.out.println(new String(buffer));\n\t}\n} catch (Exception e) {\n\te.printStackTrace();\n} finally {\n\tif (fis != null) {\n\t\ttry {\n\t\t\tfis.close();\n\t\t} catch (IOException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n}\n```\n\nèµ„æºæ‰“å¼€ä½¿ç”¨å®Œåï¼Œå¿…é¡»åœ¨finallyå—ä¸­è¿›è¡Œæ‰‹åŠ¨å…³é—­ï¼æˆ‘ä»¬æœ‰çš„åŒäº‹ï¼Œåšä¸€ä¸ªæŸ¥è¯¢åŠŸèƒ½ç‚¹ï¼Œæ‰“å¼€äº†è¿æ¥æŸ¥è¯¢å®Œåæ²¡æœ‰æ‰‹åŠ¨å…³é—­ï¼Œæœ€åé€ æˆè¿æ¥æ± è¶…å‡ºæœ€å¤§è¿æ¥æ•°è€Œä½¿ç³»ç»ŸåŠŸèƒ½å µå¡ã€‚\n\n#### JDK7\n\nJDK7å‘å¸ƒåï¼Œæ·»åŠ äº†æ–°ç‰¹æ€§ï¼štry-with-resourcesè¯­å¥ã€‚æ‰€æœ‰éœ€è¦å…³é—­çš„èµ„æºåªè¦å®ç°äº†`java.lang.AutoCloseable`ï¼ˆjava.io.Closeableå°±å®ç°äº†è¿™ä¸ªæ¥å£ï¼‰æ¥å£å°±åœ¨ä¼šç¨‹åºç»“æŸåè‡ªåŠ¨å…³é—­ã€‚\n\nå¦‚ä¸Šé¢çš„è¯»å–æ–‡ä»¶çš„æµç¨‹åºç”¨JDK7æ¥å†™ï¼š\n\n```\nbyte[] buffer = new byte[1024];\ntry (FileInputStream fis = new FileInputStream(new File(\"E:\\\\JavaæŠ€æœ¯.txt\"))) {\n\twhile (fis.read(buffer) > 0) {\n\t\tSystem.out.println(new String(buffer));\n\t}\n} catch (Exception e) {\n\te.printStackTrace();\n}\n```\n\næ‰€æœ‰çš„èµ„æºåœ¨`try()`é‡Œé¢å®šä¹‰ï¼Œå¹¶å»æ‰äº†finallyæ¨¡å—ã€‚\n\nä¸‹é¢æˆ‘ä»¬æ¥å†™ä¸€ä¸ªè‡ªå®šä¹‰çš„æµæ¥çœ‹çœ‹æ˜¯å¦è‡ªåŠ¨å…³é—­äº†ã€‚\n\n**å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰è¾“å…¥è¾“å‡ºæµ**\n\n```\nclass MyInputStream implements AutoCloseable {\n\n\tvoid read(String content) {\n\t\tSystem.out.println(\"read content \" + content);\n\t}\n\n\t@Override\n\tpublic void close() throws Exception {\n\t\tSystem.out.println(\"input stream is closed.\");\n\t}\n\n}\n\nclass MyOutputStream implements AutoCloseable {\n\n\tvoid write(String content) {\n\t\tSystem.out.println(\"write content \" + content);\n\t}\n\n\t@Override\n\tpublic void close() throws Exception {\n\t\tSystem.out.println(\"out stream is closed.\");\n\t}\n\n}\n```\n\n**å•ä¸ªèµ„æºè‡ªåŠ¨å…³é—­**\n\n```\ntry (MyInputStream mis = new MyInputStream()) {\n\tmis.read(\"7_2\");\n} catch (Exception e) {\n\te.printStackTrace();\n}\n```\n\nè¾“å‡ºï¼š\n\n> read content 7_2\\\n> input stream is closed.\n\n**å¤šä¸ªèµ„æºè‡ªåŠ¨å…³é—­**\n\n`try()`é‡Œé¢å¯ä»¥å®šä¹‰å¤šä¸ªèµ„æºï¼Œå®ƒä»¬çš„å…³é—­é¡ºåºæ˜¯æœ€ååœ¨`try()`å®šä¹‰çš„èµ„æºå…ˆå…³é—­ã€‚\n\n```\ntry (MyInputStream mis = new MyInputStream(); MyOutputStream mos = new MyOutputStream()) {\n\tmis.read(\"7_3\");\n\tmos.write(\"7_3\");\n} catch (Exception e) {\n\te.printStackTrace();\n}\n```\n\nè¾“å‡ºï¼š\n\n> read content 7_3\\\n> write content 7_3\\\n> out stream is closed.\\\n> input stream is closed.\n\n#### JDK9\n\nJDK9å‘å¸ƒåï¼Œåˆç®€åŒ–äº†try-with-resourcesè¯­å¥çš„ç”¨æ³•ã€‚\n\n`try()`é‡Œé¢å¯ä»¥æ˜¯ä¸€ä¸ªå˜é‡ï¼Œä½†å¿…é¡»æ˜¯finalçš„æˆ–è€…ç­‰åŒfinalæ‰è¡Œã€‚å¦‚ä¸‹é¢çš„misï¼Œmoså®šä¹‰æˆå±€éƒ¨å˜é‡å¯ä»¥ä¸ç”¨finalï¼Œå±€éƒ¨å˜é‡å¯ä»¥ç­‰åŒäºfinalï¼Œä½†å®šä¹‰æˆæˆå‘˜å˜é‡å°±å¿…é¡»æ˜¯ç”¨finalä¿®é¥°çš„ï¼Œä¸ç„¶ä¼šç¼–è¯‘é”™è¯¯ã€‚\n\n```\nMyInputStream mis = new MyInputStream();\nMyOutputStream mos = new MyOutputStream();\ntry (mis; mos) {\n\tmis.read(\"1.9\");\n\tmos.write(\"1.9\");\n} catch (Exception e) {\n\te.printStackTrace();\n}\n```\n\nè¾“å‡ºï¼š\n\n> read content 1.9\\\n> write content 1.9\\\n> out stream is closed.\\\n> input stream is closed.\n\nå†æ¥çœ‹ä¸ªä¾‹å­ï¼š\n\n```\nConnection dbCon = DriverManager.getConnection(\"url\", \"user\", \"password\");\ntry (dbCon; ResultSet rs = dbCon.createStatement().executeQuery(\"select * from emp\")) {\n    while (rs.next()) {\n        System.out.println(\"In loadDataFromDB() =====>>>>>>>>>>>> \" + rs.getString(1));\n    }\n} catch (SQLException e) {\n    System.out.println(\"Exception occurs while reading the data from DB ->\" + e.getMessage());\n}\n```\n\ndbConå’Œrséƒ½èƒ½è¢«è‡ªåŠ¨å…³é—­ã€‚\n\nJKD9è™½ç„¶ç®€åŒ–äº†ï¼Œä½†æ„Ÿè§‰è¿˜æ˜¯æ²¡æœ‰ä»€ä¹ˆè´¨çš„å˜åŒ–ï¼Œå®é™…ç”¨é€”æˆ‘ä»¬å¯èƒ½ä¸å¸Œæœ›å…³å¿ƒèµ„æºçš„å…³é—­ï¼Œæˆ–è€…åœ¨æ–¹æ³•ç»“æŸä¹‹åå¦‚æœæ˜¯å±€éƒ¨å˜é‡å®ƒå°±èƒ½è‡ªåŠ¨å…³é—­ã€‚æˆ–è®¸æ˜¯æˆ‘ç«™çš„é«˜åº¦ä¸å¤Ÿï¼Œå®˜æ–¹æœ‰å…¶ä»–çš„è€ƒé‡ï¼Œä½†JDK9çš„è¿™ä¸€ç‚¹å˜åŒ–è¿˜æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚\n\næ›´å¤šJDK9çš„æ–°åŠŸèƒ½å®æˆ˜é™†ç»­æ›´æ–°ï¼Œå¦‚æœè§‰å¾—æœ‰ç”¨ï¼Œåˆ†äº«åˆ°æœ‹å‹åœˆç»™æ›´å¤šçš„äººå§ï¼\n\n","slug":"æ–°ç‰¹æ€§/Java9/Java9 ç®€åŒ–æµå…³é—­æ–°å§¿åŠ¿","published":1,"updated":"2025-10-15T07:20:51.394Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu0778006cqkd47kih04u2","content":"<p><img src=\"http://img.javastack.cn/18-2-27/87594869.jpg\"></p>\n<p>åšJavaå¼€å‘çš„éƒ½çŸ¥é“ï¼Œæ¯ä¸ªèµ„æºçš„æ‰“å¼€éƒ½éœ€è¦å¯¹åº”çš„å…³é—­æ“ä½œï¼Œä¸ç„¶å°±ä¼šä½¿èµ„æºä¸€ç›´å ç”¨è€Œé€ æˆèµ„æºæµªè´¹ï¼Œä»è€Œé™ä½ç³»ç»Ÿæ€§èƒ½ã€‚</p>\n<p>å…³äºèµ„æºçš„å…³é—­æ“ä½œï¼Œä»JDK7-JDK9æœ‰äº†ä¸å°‘çš„æå‡åŠç®€åŒ–ã€‚</p>\n<h4 id=\"JDK6\"><a href=\"#JDK6\" class=\"headerlink\" title=\"JDK6\"></a>JDK6</h4><p>åœ¨JDK6åŠä¹‹å‰ï¼Œæ¯ä¸ªèµ„æºéƒ½éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å†™ä»£ç å…³é—­ï¼Œå¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">FileInputStream fis &#x3D; null;\nbyte[] buffer &#x3D; new byte[1024];\ntry &#123;\n\tfis &#x3D; new FileInputStream(new File(&quot;E:\\\\JavaæŠ€æœ¯.txt&quot;));\n\twhile (fis.read(buffer) &gt; 0) &#123;\n\t\tSystem.out.println(new String(buffer));\n\t&#125;\n&#125; catch (Exception e) &#123;\n\te.printStackTrace();\n&#125; finally &#123;\n\tif (fis !&#x3D; null) &#123;\n\t\ttry &#123;\n\t\t\tfis.close();\n\t\t&#125; catch (IOException e) &#123;\n\t\t\te.printStackTrace();\n\t\t&#125;\n\t&#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>èµ„æºæ‰“å¼€ä½¿ç”¨å®Œåï¼Œå¿…é¡»åœ¨finallyå—ä¸­è¿›è¡Œæ‰‹åŠ¨å…³é—­ï¼æˆ‘ä»¬æœ‰çš„åŒäº‹ï¼Œåšä¸€ä¸ªæŸ¥è¯¢åŠŸèƒ½ç‚¹ï¼Œæ‰“å¼€äº†è¿æ¥æŸ¥è¯¢å®Œåæ²¡æœ‰æ‰‹åŠ¨å…³é—­ï¼Œæœ€åé€ æˆè¿æ¥æ± è¶…å‡ºæœ€å¤§è¿æ¥æ•°è€Œä½¿ç³»ç»ŸåŠŸèƒ½å µå¡ã€‚</p>\n<h4 id=\"JDK7\"><a href=\"#JDK7\" class=\"headerlink\" title=\"JDK7\"></a>JDK7</h4><p>JDK7å‘å¸ƒåï¼Œæ·»åŠ äº†æ–°ç‰¹æ€§ï¼štry-with-resourcesè¯­å¥ã€‚æ‰€æœ‰éœ€è¦å…³é—­çš„èµ„æºåªè¦å®ç°äº†<code>java.lang.AutoCloseable</code>ï¼ˆjava.io.Closeableå°±å®ç°äº†è¿™ä¸ªæ¥å£ï¼‰æ¥å£å°±åœ¨ä¼šç¨‹åºç»“æŸåè‡ªåŠ¨å…³é—­ã€‚</p>\n<p>å¦‚ä¸Šé¢çš„è¯»å–æ–‡ä»¶çš„æµç¨‹åºç”¨JDK7æ¥å†™ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">byte[] buffer &#x3D; new byte[1024];\ntry (FileInputStream fis &#x3D; new FileInputStream(new File(&quot;E:\\\\JavaæŠ€æœ¯.txt&quot;))) &#123;\n\twhile (fis.read(buffer) &gt; 0) &#123;\n\t\tSystem.out.println(new String(buffer));\n\t&#125;\n&#125; catch (Exception e) &#123;\n\te.printStackTrace();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ‰€æœ‰çš„èµ„æºåœ¨<code>try()</code>é‡Œé¢å®šä¹‰ï¼Œå¹¶å»æ‰äº†finallyæ¨¡å—ã€‚</p>\n<p>ä¸‹é¢æˆ‘ä»¬æ¥å†™ä¸€ä¸ªè‡ªå®šä¹‰çš„æµæ¥çœ‹çœ‹æ˜¯å¦è‡ªåŠ¨å…³é—­äº†ã€‚</p>\n<p><strong>å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰è¾“å…¥è¾“å‡ºæµ</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">class MyInputStream implements AutoCloseable &#123;\n\n\tvoid read(String content) &#123;\n\t\tSystem.out.println(&quot;read content &quot; + content);\n\t&#125;\n\n\t@Override\n\tpublic void close() throws Exception &#123;\n\t\tSystem.out.println(&quot;input stream is closed.&quot;);\n\t&#125;\n\n&#125;\n\nclass MyOutputStream implements AutoCloseable &#123;\n\n\tvoid write(String content) &#123;\n\t\tSystem.out.println(&quot;write content &quot; + content);\n\t&#125;\n\n\t@Override\n\tpublic void close() throws Exception &#123;\n\t\tSystem.out.println(&quot;out stream is closed.&quot;);\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>å•ä¸ªèµ„æºè‡ªåŠ¨å…³é—­</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">try (MyInputStream mis &#x3D; new MyInputStream()) &#123;\n\tmis.read(&quot;7_2&quot;);\n&#125; catch (Exception e) &#123;\n\te.printStackTrace();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¾“å‡ºï¼š</p>\n<blockquote>\n<p>read content 7_2<br>input stream is closed.</p>\n</blockquote>\n<p><strong>å¤šä¸ªèµ„æºè‡ªåŠ¨å…³é—­</strong></p>\n<p><code>try()</code>é‡Œé¢å¯ä»¥å®šä¹‰å¤šä¸ªèµ„æºï¼Œå®ƒä»¬çš„å…³é—­é¡ºåºæ˜¯æœ€ååœ¨<code>try()</code>å®šä¹‰çš„èµ„æºå…ˆå…³é—­ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">try (MyInputStream mis &#x3D; new MyInputStream(); MyOutputStream mos &#x3D; new MyOutputStream()) &#123;\n\tmis.read(&quot;7_3&quot;);\n\tmos.write(&quot;7_3&quot;);\n&#125; catch (Exception e) &#123;\n\te.printStackTrace();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¾“å‡ºï¼š</p>\n<blockquote>\n<p>read content 7_3<br>write content 7_3<br>out stream is closed.<br>input stream is closed.</p>\n</blockquote>\n<h4 id=\"JDK9\"><a href=\"#JDK9\" class=\"headerlink\" title=\"JDK9\"></a>JDK9</h4><p>JDK9å‘å¸ƒåï¼Œåˆç®€åŒ–äº†try-with-resourcesè¯­å¥çš„ç”¨æ³•ã€‚</p>\n<p><code>try()</code>é‡Œé¢å¯ä»¥æ˜¯ä¸€ä¸ªå˜é‡ï¼Œä½†å¿…é¡»æ˜¯finalçš„æˆ–è€…ç­‰åŒfinalæ‰è¡Œã€‚å¦‚ä¸‹é¢çš„misï¼Œmoså®šä¹‰æˆå±€éƒ¨å˜é‡å¯ä»¥ä¸ç”¨finalï¼Œå±€éƒ¨å˜é‡å¯ä»¥ç­‰åŒäºfinalï¼Œä½†å®šä¹‰æˆæˆå‘˜å˜é‡å°±å¿…é¡»æ˜¯ç”¨finalä¿®é¥°çš„ï¼Œä¸ç„¶ä¼šç¼–è¯‘é”™è¯¯ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">MyInputStream mis &#x3D; new MyInputStream();\nMyOutputStream mos &#x3D; new MyOutputStream();\ntry (mis; mos) &#123;\n\tmis.read(&quot;1.9&quot;);\n\tmos.write(&quot;1.9&quot;);\n&#125; catch (Exception e) &#123;\n\te.printStackTrace();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¾“å‡ºï¼š</p>\n<blockquote>\n<p>read content 1.9<br>write content 1.9<br>out stream is closed.<br>input stream is closed.</p>\n</blockquote>\n<p>å†æ¥çœ‹ä¸ªä¾‹å­ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Connection dbCon &#x3D; DriverManager.getConnection(&quot;url&quot;, &quot;user&quot;, &quot;password&quot;);\ntry (dbCon; ResultSet rs &#x3D; dbCon.createStatement().executeQuery(&quot;select * from emp&quot;)) &#123;\n    while (rs.next()) &#123;\n        System.out.println(&quot;In loadDataFromDB() &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &quot; + rs.getString(1));\n    &#125;\n&#125; catch (SQLException e) &#123;\n    System.out.println(&quot;Exception occurs while reading the data from DB -&gt;&quot; + e.getMessage());\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>dbConå’Œrséƒ½èƒ½è¢«è‡ªåŠ¨å…³é—­ã€‚</p>\n<p>JKD9è™½ç„¶ç®€åŒ–äº†ï¼Œä½†æ„Ÿè§‰è¿˜æ˜¯æ²¡æœ‰ä»€ä¹ˆè´¨çš„å˜åŒ–ï¼Œå®é™…ç”¨é€”æˆ‘ä»¬å¯èƒ½ä¸å¸Œæœ›å…³å¿ƒèµ„æºçš„å…³é—­ï¼Œæˆ–è€…åœ¨æ–¹æ³•ç»“æŸä¹‹åå¦‚æœæ˜¯å±€éƒ¨å˜é‡å®ƒå°±èƒ½è‡ªåŠ¨å…³é—­ã€‚æˆ–è®¸æ˜¯æˆ‘ç«™çš„é«˜åº¦ä¸å¤Ÿï¼Œå®˜æ–¹æœ‰å…¶ä»–çš„è€ƒé‡ï¼Œä½†JDK9çš„è¿™ä¸€ç‚¹å˜åŒ–è¿˜æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚</p>\n<p>æ›´å¤šJDK9çš„æ–°åŠŸèƒ½å®æˆ˜é™†ç»­æ›´æ–°ï¼Œå¦‚æœè§‰å¾—æœ‰ç”¨ï¼Œåˆ†äº«åˆ°æœ‹å‹åœˆç»™æ›´å¤šçš„äººå§ï¼</p>\n","excerpt":"","more":"<p><img src=\"http://img.javastack.cn/18-2-27/87594869.jpg\"></p>\n<p>åšJavaå¼€å‘çš„éƒ½çŸ¥é“ï¼Œæ¯ä¸ªèµ„æºçš„æ‰“å¼€éƒ½éœ€è¦å¯¹åº”çš„å…³é—­æ“ä½œï¼Œä¸ç„¶å°±ä¼šä½¿èµ„æºä¸€ç›´å ç”¨è€Œé€ æˆèµ„æºæµªè´¹ï¼Œä»è€Œé™ä½ç³»ç»Ÿæ€§èƒ½ã€‚</p>\n<p>å…³äºèµ„æºçš„å…³é—­æ“ä½œï¼Œä»JDK7-JDK9æœ‰äº†ä¸å°‘çš„æå‡åŠç®€åŒ–ã€‚</p>\n<h4 id=\"JDK6\"><a href=\"#JDK6\" class=\"headerlink\" title=\"JDK6\"></a>JDK6</h4><p>åœ¨JDK6åŠä¹‹å‰ï¼Œæ¯ä¸ªèµ„æºéƒ½éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å†™ä»£ç å…³é—­ï¼Œå¦‚ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">FileInputStream fis &#x3D; null;\nbyte[] buffer &#x3D; new byte[1024];\ntry &#123;\n\tfis &#x3D; new FileInputStream(new File(&quot;E:\\\\JavaæŠ€æœ¯.txt&quot;));\n\twhile (fis.read(buffer) &gt; 0) &#123;\n\t\tSystem.out.println(new String(buffer));\n\t&#125;\n&#125; catch (Exception e) &#123;\n\te.printStackTrace();\n&#125; finally &#123;\n\tif (fis !&#x3D; null) &#123;\n\t\ttry &#123;\n\t\t\tfis.close();\n\t\t&#125; catch (IOException e) &#123;\n\t\t\te.printStackTrace();\n\t\t&#125;\n\t&#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>èµ„æºæ‰“å¼€ä½¿ç”¨å®Œåï¼Œå¿…é¡»åœ¨finallyå—ä¸­è¿›è¡Œæ‰‹åŠ¨å…³é—­ï¼æˆ‘ä»¬æœ‰çš„åŒäº‹ï¼Œåšä¸€ä¸ªæŸ¥è¯¢åŠŸèƒ½ç‚¹ï¼Œæ‰“å¼€äº†è¿æ¥æŸ¥è¯¢å®Œåæ²¡æœ‰æ‰‹åŠ¨å…³é—­ï¼Œæœ€åé€ æˆè¿æ¥æ± è¶…å‡ºæœ€å¤§è¿æ¥æ•°è€Œä½¿ç³»ç»ŸåŠŸèƒ½å µå¡ã€‚</p>\n<h4 id=\"JDK7\"><a href=\"#JDK7\" class=\"headerlink\" title=\"JDK7\"></a>JDK7</h4><p>JDK7å‘å¸ƒåï¼Œæ·»åŠ äº†æ–°ç‰¹æ€§ï¼štry-with-resourcesè¯­å¥ã€‚æ‰€æœ‰éœ€è¦å…³é—­çš„èµ„æºåªè¦å®ç°äº†<code>java.lang.AutoCloseable</code>ï¼ˆjava.io.Closeableå°±å®ç°äº†è¿™ä¸ªæ¥å£ï¼‰æ¥å£å°±åœ¨ä¼šç¨‹åºç»“æŸåè‡ªåŠ¨å…³é—­ã€‚</p>\n<p>å¦‚ä¸Šé¢çš„è¯»å–æ–‡ä»¶çš„æµç¨‹åºç”¨JDK7æ¥å†™ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">byte[] buffer &#x3D; new byte[1024];\ntry (FileInputStream fis &#x3D; new FileInputStream(new File(&quot;E:\\\\JavaæŠ€æœ¯.txt&quot;))) &#123;\n\twhile (fis.read(buffer) &gt; 0) &#123;\n\t\tSystem.out.println(new String(buffer));\n\t&#125;\n&#125; catch (Exception e) &#123;\n\te.printStackTrace();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ‰€æœ‰çš„èµ„æºåœ¨<code>try()</code>é‡Œé¢å®šä¹‰ï¼Œå¹¶å»æ‰äº†finallyæ¨¡å—ã€‚</p>\n<p>ä¸‹é¢æˆ‘ä»¬æ¥å†™ä¸€ä¸ªè‡ªå®šä¹‰çš„æµæ¥çœ‹çœ‹æ˜¯å¦è‡ªåŠ¨å…³é—­äº†ã€‚</p>\n<p><strong>å®šä¹‰ä¸€ä¸ªè‡ªå®šä¹‰è¾“å…¥è¾“å‡ºæµ</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">class MyInputStream implements AutoCloseable &#123;\n\n\tvoid read(String content) &#123;\n\t\tSystem.out.println(&quot;read content &quot; + content);\n\t&#125;\n\n\t@Override\n\tpublic void close() throws Exception &#123;\n\t\tSystem.out.println(&quot;input stream is closed.&quot;);\n\t&#125;\n\n&#125;\n\nclass MyOutputStream implements AutoCloseable &#123;\n\n\tvoid write(String content) &#123;\n\t\tSystem.out.println(&quot;write content &quot; + content);\n\t&#125;\n\n\t@Override\n\tpublic void close() throws Exception &#123;\n\t\tSystem.out.println(&quot;out stream is closed.&quot;);\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>å•ä¸ªèµ„æºè‡ªåŠ¨å…³é—­</strong></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">try (MyInputStream mis &#x3D; new MyInputStream()) &#123;\n\tmis.read(&quot;7_2&quot;);\n&#125; catch (Exception e) &#123;\n\te.printStackTrace();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¾“å‡ºï¼š</p>\n<blockquote>\n<p>read content 7_2<br>input stream is closed.</p>\n</blockquote>\n<p><strong>å¤šä¸ªèµ„æºè‡ªåŠ¨å…³é—­</strong></p>\n<p><code>try()</code>é‡Œé¢å¯ä»¥å®šä¹‰å¤šä¸ªèµ„æºï¼Œå®ƒä»¬çš„å…³é—­é¡ºåºæ˜¯æœ€ååœ¨<code>try()</code>å®šä¹‰çš„èµ„æºå…ˆå…³é—­ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">try (MyInputStream mis &#x3D; new MyInputStream(); MyOutputStream mos &#x3D; new MyOutputStream()) &#123;\n\tmis.read(&quot;7_3&quot;);\n\tmos.write(&quot;7_3&quot;);\n&#125; catch (Exception e) &#123;\n\te.printStackTrace();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¾“å‡ºï¼š</p>\n<blockquote>\n<p>read content 7_3<br>write content 7_3<br>out stream is closed.<br>input stream is closed.</p>\n</blockquote>\n<h4 id=\"JDK9\"><a href=\"#JDK9\" class=\"headerlink\" title=\"JDK9\"></a>JDK9</h4><p>JDK9å‘å¸ƒåï¼Œåˆç®€åŒ–äº†try-with-resourcesè¯­å¥çš„ç”¨æ³•ã€‚</p>\n<p><code>try()</code>é‡Œé¢å¯ä»¥æ˜¯ä¸€ä¸ªå˜é‡ï¼Œä½†å¿…é¡»æ˜¯finalçš„æˆ–è€…ç­‰åŒfinalæ‰è¡Œã€‚å¦‚ä¸‹é¢çš„misï¼Œmoså®šä¹‰æˆå±€éƒ¨å˜é‡å¯ä»¥ä¸ç”¨finalï¼Œå±€éƒ¨å˜é‡å¯ä»¥ç­‰åŒäºfinalï¼Œä½†å®šä¹‰æˆæˆå‘˜å˜é‡å°±å¿…é¡»æ˜¯ç”¨finalä¿®é¥°çš„ï¼Œä¸ç„¶ä¼šç¼–è¯‘é”™è¯¯ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">MyInputStream mis &#x3D; new MyInputStream();\nMyOutputStream mos &#x3D; new MyOutputStream();\ntry (mis; mos) &#123;\n\tmis.read(&quot;1.9&quot;);\n\tmos.write(&quot;1.9&quot;);\n&#125; catch (Exception e) &#123;\n\te.printStackTrace();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¾“å‡ºï¼š</p>\n<blockquote>\n<p>read content 1.9<br>write content 1.9<br>out stream is closed.<br>input stream is closed.</p>\n</blockquote>\n<p>å†æ¥çœ‹ä¸ªä¾‹å­ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Connection dbCon &#x3D; DriverManager.getConnection(&quot;url&quot;, &quot;user&quot;, &quot;password&quot;);\ntry (dbCon; ResultSet rs &#x3D; dbCon.createStatement().executeQuery(&quot;select * from emp&quot;)) &#123;\n    while (rs.next()) &#123;\n        System.out.println(&quot;In loadDataFromDB() &#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt; &quot; + rs.getString(1));\n    &#125;\n&#125; catch (SQLException e) &#123;\n    System.out.println(&quot;Exception occurs while reading the data from DB -&gt;&quot; + e.getMessage());\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>dbConå’Œrséƒ½èƒ½è¢«è‡ªåŠ¨å…³é—­ã€‚</p>\n<p>JKD9è™½ç„¶ç®€åŒ–äº†ï¼Œä½†æ„Ÿè§‰è¿˜æ˜¯æ²¡æœ‰ä»€ä¹ˆè´¨çš„å˜åŒ–ï¼Œå®é™…ç”¨é€”æˆ‘ä»¬å¯èƒ½ä¸å¸Œæœ›å…³å¿ƒèµ„æºçš„å…³é—­ï¼Œæˆ–è€…åœ¨æ–¹æ³•ç»“æŸä¹‹åå¦‚æœæ˜¯å±€éƒ¨å˜é‡å®ƒå°±èƒ½è‡ªåŠ¨å…³é—­ã€‚æˆ–è®¸æ˜¯æˆ‘ç«™çš„é«˜åº¦ä¸å¤Ÿï¼Œå®˜æ–¹æœ‰å…¶ä»–çš„è€ƒé‡ï¼Œä½†JDK9çš„è¿™ä¸€ç‚¹å˜åŒ–è¿˜æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚</p>\n<p>æ›´å¤šJDK9çš„æ–°åŠŸèƒ½å®æˆ˜é™†ç»­æ›´æ–°ï¼Œå¦‚æœè§‰å¾—æœ‰ç”¨ï¼Œåˆ†äº«åˆ°æœ‹å‹åœˆç»™æ›´å¤šçš„äººå§ï¼</p>\n"},{"title":"Java 8 åˆ›å»º Stream çš„ 10 ç§æ–¹å¼ï¼Œæˆ‘ä¿è¯ä½ å—ç›Šæ— ç©·!","date":"2025-10-15T03:36:33.000Z","_content":"\n![](http://img.javastack.cn/20190613135450.png)\n![](http://img.javastack.cn/20190613135537.png)\n\n\nä»Šå¤©æ¥åˆ†äº«ä¸‹åœ¨ Java 8 ä¸­åˆ›å»º Stream çš„ 10 ç§æ–¹å¼ï¼Œæˆ‘å°±æ•´ç†äº† 10 ç§ï¼Œå…¶å®è¿˜æœ‰æ›´å¤šï¼Œä»…ä¾›å¤§å®¶å‚è€ƒå­¦ä¹ ä¸‹ã€‚\n\n## 1ã€Stream.of å¯å˜å‚æ•°\n\n```\nStream<String> stream1 = Stream.of(\"A\", \"B\", \"C\");\nSystem.out.println(\"stream1:\" + stream1.collect(joining()));\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n> stream1:ABC\n\n## 2ã€Stream.of æ•°ç»„\n\n```\nString[] values = new String[]{\"A\", \"B\", \"C\"};\nStream<String> stream2 = Stream.of(values);\nSystem.out.println(\"stream2:\" + stream2.collect(joining()));\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n> stream2:ABC\n\nçœ‹ Stream.of æºç ï¼Œä¸Šé¢è¿™ä¸¤ç§æ–¹å¼å…¶å®å°±æ˜¯ç¬¬ä¸‰ç§æ–¹å¼çš„åŒ…è£…ç‰ˆã€‚\n\n```\npublic static<T> Stream<T> of(T... values) {\n    return Arrays.stream(values);\n}\n```\n\næˆ‘ä»¬ç›´æ¥ä½¿ç”¨æºç ä¸­çš„æ–¹å¼ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚\n\n## 3ã€Arrays.stream\n\n```\nString[] values = new String[]{\"A\", \"B\", \"C\"};\nStream<String> stream3 = Arrays.stream(values);\nSystem.out.println(\"stream3:\" + stream3.collect(joining()));\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n> stream3:ABC\n\n## 4ã€List\n\n```\nList<String> list = Arrays.asList(\"A\", \"B\", \"C\");\nStream<String> stream4 = list.stream();\nSystem.out.println(\"stream4:\" + stream4.collect(joining()));\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n> stream4:ABC\n\n## 5ã€Set\n\n```\nSet<String> set = new HashSet<>(Arrays.asList(\"A\", \"B\", \"C\"));\nStream<String> stream5 = set.stream();\nSystem.out.println(\"stream5:\" + stream5.collect(joining()));\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n> stream5:ABC\n\n## 6ã€Map\n\n```\nMap<String, String> map = new HashMap<>();\nmap.put(\"1\", \"A\");\nmap.put(\"2\", \"B\");\nmap.put(\"3\", \"C\");\nStream<String> stream6 = map.values().stream();\nSystem.out.println(\"stream6:\" + stream6.collect(joining()));\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n> stream6:ABC\n\n## 7ã€Stream.iterate\n\n```\nStream<String> stream7 = Stream.iterate(\"A\", e -> String.valueOf((char) (e.charAt(0) + 1))).limit(3);\nSystem.out.println(\"stream7:\" + stream7.collect(joining()));\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n> stream7:ABC\n\n## 8ã€Pattern\n\n```\nString value = \"A B C\";\nStream<String> stream8 = Pattern.compile(\"\\\\W\").splitAsStream(value);\nSystem.out.println(\"stream8:\" + stream8.collect(joining()));\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n> stream8:ABC\n\n## 9ã€Files.lines\n\n```\ntry {\n    Stream<String> stream9 = Files.lines(Paths.get(\"d:/data.txt\"));\n    System.out.println(\"stream9:\" + stream9.collect(joining()));\n} catch (IOException e) {\n    e.printStackTrace();\n}\n```\n\ndata.txtæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š\n\n```\nA\nB\nC\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n> stream9:ABC\n\n## 10ã€Stream.generate\n\n```\nStream<String> stream10 = Stream.generate(() -> \"A\").limit(3);\nSystem.out.println(\"stream10:\" + stream10.collect(joining()));\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n> stream10:AAA\n\nå¥½äº†ï¼Œè¿™æ˜¯æ ˆé•¿æ•´ç†çš„ 10 ç§åˆ›å»º Stream çš„æ–¹å¼ï¼Œæ˜¯ä¸æ˜¯å¾ˆéªšï¼Ÿå¦‚æœä½ è¿˜çŸ¥é“å…¶ä»–çš„éªšæ“ä½œï¼Œå¯ä»¥ç•™è¨€å‘Šè¯‰å¤§å®¶ï¼Œè®©å¤§å®¶è®°ä½ä½ çš„å¤´åƒå’ŒIDã€‚\n\n\n \n","source":"_posts/æ–°ç‰¹æ€§/Java8/Stream/Java 8 åˆ›å»º Stream çš„ 10 ç§æ–¹å¼ï¼Œæˆ‘ä¿è¯ä½ å—ç›Šæ— ç©·!.md","raw":"---\ntitle: Java 8 åˆ›å»º Stream çš„ 10 ç§æ–¹å¼ï¼Œæˆ‘ä¿è¯ä½ å—ç›Šæ— ç©·!\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: æ–°ç‰¹æ€§\n---\n\n![](http://img.javastack.cn/20190613135450.png)\n![](http://img.javastack.cn/20190613135537.png)\n\n\nä»Šå¤©æ¥åˆ†äº«ä¸‹åœ¨ Java 8 ä¸­åˆ›å»º Stream çš„ 10 ç§æ–¹å¼ï¼Œæˆ‘å°±æ•´ç†äº† 10 ç§ï¼Œå…¶å®è¿˜æœ‰æ›´å¤šï¼Œä»…ä¾›å¤§å®¶å‚è€ƒå­¦ä¹ ä¸‹ã€‚\n\n## 1ã€Stream.of å¯å˜å‚æ•°\n\n```\nStream<String> stream1 = Stream.of(\"A\", \"B\", \"C\");\nSystem.out.println(\"stream1:\" + stream1.collect(joining()));\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n> stream1:ABC\n\n## 2ã€Stream.of æ•°ç»„\n\n```\nString[] values = new String[]{\"A\", \"B\", \"C\"};\nStream<String> stream2 = Stream.of(values);\nSystem.out.println(\"stream2:\" + stream2.collect(joining()));\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n> stream2:ABC\n\nçœ‹ Stream.of æºç ï¼Œä¸Šé¢è¿™ä¸¤ç§æ–¹å¼å…¶å®å°±æ˜¯ç¬¬ä¸‰ç§æ–¹å¼çš„åŒ…è£…ç‰ˆã€‚\n\n```\npublic static<T> Stream<T> of(T... values) {\n    return Arrays.stream(values);\n}\n```\n\næˆ‘ä»¬ç›´æ¥ä½¿ç”¨æºç ä¸­çš„æ–¹å¼ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚\n\n## 3ã€Arrays.stream\n\n```\nString[] values = new String[]{\"A\", \"B\", \"C\"};\nStream<String> stream3 = Arrays.stream(values);\nSystem.out.println(\"stream3:\" + stream3.collect(joining()));\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n> stream3:ABC\n\n## 4ã€List\n\n```\nList<String> list = Arrays.asList(\"A\", \"B\", \"C\");\nStream<String> stream4 = list.stream();\nSystem.out.println(\"stream4:\" + stream4.collect(joining()));\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n> stream4:ABC\n\n## 5ã€Set\n\n```\nSet<String> set = new HashSet<>(Arrays.asList(\"A\", \"B\", \"C\"));\nStream<String> stream5 = set.stream();\nSystem.out.println(\"stream5:\" + stream5.collect(joining()));\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n> stream5:ABC\n\n## 6ã€Map\n\n```\nMap<String, String> map = new HashMap<>();\nmap.put(\"1\", \"A\");\nmap.put(\"2\", \"B\");\nmap.put(\"3\", \"C\");\nStream<String> stream6 = map.values().stream();\nSystem.out.println(\"stream6:\" + stream6.collect(joining()));\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n> stream6:ABC\n\n## 7ã€Stream.iterate\n\n```\nStream<String> stream7 = Stream.iterate(\"A\", e -> String.valueOf((char) (e.charAt(0) + 1))).limit(3);\nSystem.out.println(\"stream7:\" + stream7.collect(joining()));\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n> stream7:ABC\n\n## 8ã€Pattern\n\n```\nString value = \"A B C\";\nStream<String> stream8 = Pattern.compile(\"\\\\W\").splitAsStream(value);\nSystem.out.println(\"stream8:\" + stream8.collect(joining()));\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n> stream8:ABC\n\n## 9ã€Files.lines\n\n```\ntry {\n    Stream<String> stream9 = Files.lines(Paths.get(\"d:/data.txt\"));\n    System.out.println(\"stream9:\" + stream9.collect(joining()));\n} catch (IOException e) {\n    e.printStackTrace();\n}\n```\n\ndata.txtæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š\n\n```\nA\nB\nC\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n> stream9:ABC\n\n## 10ã€Stream.generate\n\n```\nStream<String> stream10 = Stream.generate(() -> \"A\").limit(3);\nSystem.out.println(\"stream10:\" + stream10.collect(joining()));\n```\n\nç¨‹åºè¾“å‡ºï¼š\n\n> stream10:AAA\n\nå¥½äº†ï¼Œè¿™æ˜¯æ ˆé•¿æ•´ç†çš„ 10 ç§åˆ›å»º Stream çš„æ–¹å¼ï¼Œæ˜¯ä¸æ˜¯å¾ˆéªšï¼Ÿå¦‚æœä½ è¿˜çŸ¥é“å…¶ä»–çš„éªšæ“ä½œï¼Œå¯ä»¥ç•™è¨€å‘Šè¯‰å¤§å®¶ï¼Œè®©å¤§å®¶è®°ä½ä½ çš„å¤´åƒå’ŒIDã€‚\n\n\n \n","slug":"æ–°ç‰¹æ€§/Java8/Stream/Java 8 åˆ›å»º Stream çš„ 10 ç§æ–¹å¼ï¼Œæˆ‘ä¿è¯ä½ å—ç›Šæ— ç©·!","published":1,"updated":"2025-10-15T07:20:51.449Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu0778006fqkd4ae9z6hs8","content":"<p><img src=\"http://img.javastack.cn/20190613135450.png\"><br><img src=\"http://img.javastack.cn/20190613135537.png\"></p>\n<p>ä»Šå¤©æ¥åˆ†äº«ä¸‹åœ¨ Java 8 ä¸­åˆ›å»º Stream çš„ 10 ç§æ–¹å¼ï¼Œæˆ‘å°±æ•´ç†äº† 10 ç§ï¼Œå…¶å®è¿˜æœ‰æ›´å¤šï¼Œä»…ä¾›å¤§å®¶å‚è€ƒå­¦ä¹ ä¸‹ã€‚</p>\n<h2 id=\"1ã€Stream-of-å¯å˜å‚æ•°\"><a href=\"#1ã€Stream-of-å¯å˜å‚æ•°\" class=\"headerlink\" title=\"1ã€Stream.of å¯å˜å‚æ•°\"></a>1ã€Stream.of å¯å˜å‚æ•°</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">Stream&lt;String&gt; stream1 &#x3D; Stream.of(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;);\nSystem.out.println(&quot;stream1:&quot; + stream1.collect(joining()));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<blockquote>\n<p>stream1:ABC</p>\n</blockquote>\n<h2 id=\"2ã€Stream-of-æ•°ç»„\"><a href=\"#2ã€Stream-of-æ•°ç»„\" class=\"headerlink\" title=\"2ã€Stream.of æ•°ç»„\"></a>2ã€Stream.of æ•°ç»„</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">String[] values &#x3D; new String[]&#123;&quot;A&quot;, &quot;B&quot;, &quot;C&quot;&#125;;\nStream&lt;String&gt; stream2 &#x3D; Stream.of(values);\nSystem.out.println(&quot;stream2:&quot; + stream2.collect(joining()));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<blockquote>\n<p>stream2:ABC</p>\n</blockquote>\n<p>çœ‹ Stream.of æºç ï¼Œä¸Šé¢è¿™ä¸¤ç§æ–¹å¼å…¶å®å°±æ˜¯ç¬¬ä¸‰ç§æ–¹å¼çš„åŒ…è£…ç‰ˆã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static&lt;T&gt; Stream&lt;T&gt; of(T... values) &#123;\n    return Arrays.stream(values);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>æˆ‘ä»¬ç›´æ¥ä½¿ç”¨æºç ä¸­çš„æ–¹å¼ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚</p>\n<h2 id=\"3ã€Arrays-stream\"><a href=\"#3ã€Arrays-stream\" class=\"headerlink\" title=\"3ã€Arrays.stream\"></a>3ã€Arrays.stream</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">String[] values &#x3D; new String[]&#123;&quot;A&quot;, &quot;B&quot;, &quot;C&quot;&#125;;\nStream&lt;String&gt; stream3 &#x3D; Arrays.stream(values);\nSystem.out.println(&quot;stream3:&quot; + stream3.collect(joining()));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<blockquote>\n<p>stream3:ABC</p>\n</blockquote>\n<h2 id=\"4ã€List\"><a href=\"#4ã€List\" class=\"headerlink\" title=\"4ã€List\"></a>4ã€List</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;String&gt; list &#x3D; Arrays.asList(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;);\nStream&lt;String&gt; stream4 &#x3D; list.stream();\nSystem.out.println(&quot;stream4:&quot; + stream4.collect(joining()));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<blockquote>\n<p>stream4:ABC</p>\n</blockquote>\n<h2 id=\"5ã€Set\"><a href=\"#5ã€Set\" class=\"headerlink\" title=\"5ã€Set\"></a>5ã€Set</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">Set&lt;String&gt; set &#x3D; new HashSet&lt;&gt;(Arrays.asList(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;));\nStream&lt;String&gt; stream5 &#x3D; set.stream();\nSystem.out.println(&quot;stream5:&quot; + stream5.collect(joining()));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<blockquote>\n<p>stream5:ABC</p>\n</blockquote>\n<h2 id=\"6ã€Map\"><a href=\"#6ã€Map\" class=\"headerlink\" title=\"6ã€Map\"></a>6ã€Map</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">Map&lt;String, String&gt; map &#x3D; new HashMap&lt;&gt;();\nmap.put(&quot;1&quot;, &quot;A&quot;);\nmap.put(&quot;2&quot;, &quot;B&quot;);\nmap.put(&quot;3&quot;, &quot;C&quot;);\nStream&lt;String&gt; stream6 &#x3D; map.values().stream();\nSystem.out.println(&quot;stream6:&quot; + stream6.collect(joining()));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<blockquote>\n<p>stream6:ABC</p>\n</blockquote>\n<h2 id=\"7ã€Stream-iterate\"><a href=\"#7ã€Stream-iterate\" class=\"headerlink\" title=\"7ã€Stream.iterate\"></a>7ã€Stream.iterate</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">Stream&lt;String&gt; stream7 &#x3D; Stream.iterate(&quot;A&quot;, e -&gt; String.valueOf((char) (e.charAt(0) + 1))).limit(3);\nSystem.out.println(&quot;stream7:&quot; + stream7.collect(joining()));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<blockquote>\n<p>stream7:ABC</p>\n</blockquote>\n<h2 id=\"8ã€Pattern\"><a href=\"#8ã€Pattern\" class=\"headerlink\" title=\"8ã€Pattern\"></a>8ã€Pattern</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">String value &#x3D; &quot;A B C&quot;;\nStream&lt;String&gt; stream8 &#x3D; Pattern.compile(&quot;\\\\W&quot;).splitAsStream(value);\nSystem.out.println(&quot;stream8:&quot; + stream8.collect(joining()));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<blockquote>\n<p>stream8:ABC</p>\n</blockquote>\n<h2 id=\"9ã€Files-lines\"><a href=\"#9ã€Files-lines\" class=\"headerlink\" title=\"9ã€Files.lines\"></a>9ã€Files.lines</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">try &#123;\n    Stream&lt;String&gt; stream9 &#x3D; Files.lines(Paths.get(&quot;d:&#x2F;data.txt&quot;));\n    System.out.println(&quot;stream9:&quot; + stream9.collect(joining()));\n&#125; catch (IOException e) &#123;\n    e.printStackTrace();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>data.txtæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">A\nB\nC<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<blockquote>\n<p>stream9:ABC</p>\n</blockquote>\n<h2 id=\"10ã€Stream-generate\"><a href=\"#10ã€Stream-generate\" class=\"headerlink\" title=\"10ã€Stream.generate\"></a>10ã€Stream.generate</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">Stream&lt;String&gt; stream10 &#x3D; Stream.generate(() -&gt; &quot;A&quot;).limit(3);\nSystem.out.println(&quot;stream10:&quot; + stream10.collect(joining()));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<blockquote>\n<p>stream10:AAA</p>\n</blockquote>\n<p>å¥½äº†ï¼Œè¿™æ˜¯æ ˆé•¿æ•´ç†çš„ 10 ç§åˆ›å»º Stream çš„æ–¹å¼ï¼Œæ˜¯ä¸æ˜¯å¾ˆéªšï¼Ÿå¦‚æœä½ è¿˜çŸ¥é“å…¶ä»–çš„éªšæ“ä½œï¼Œå¯ä»¥ç•™è¨€å‘Šè¯‰å¤§å®¶ï¼Œè®©å¤§å®¶è®°ä½ä½ çš„å¤´åƒå’ŒIDã€‚</p>\n","excerpt":"","more":"<p><img src=\"http://img.javastack.cn/20190613135450.png\"><br><img src=\"http://img.javastack.cn/20190613135537.png\"></p>\n<p>ä»Šå¤©æ¥åˆ†äº«ä¸‹åœ¨ Java 8 ä¸­åˆ›å»º Stream çš„ 10 ç§æ–¹å¼ï¼Œæˆ‘å°±æ•´ç†äº† 10 ç§ï¼Œå…¶å®è¿˜æœ‰æ›´å¤šï¼Œä»…ä¾›å¤§å®¶å‚è€ƒå­¦ä¹ ä¸‹ã€‚</p>\n<h2 id=\"1ã€Stream-of-å¯å˜å‚æ•°\"><a href=\"#1ã€Stream-of-å¯å˜å‚æ•°\" class=\"headerlink\" title=\"1ã€Stream.of å¯å˜å‚æ•°\"></a>1ã€Stream.of å¯å˜å‚æ•°</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">Stream&lt;String&gt; stream1 &#x3D; Stream.of(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;);\nSystem.out.println(&quot;stream1:&quot; + stream1.collect(joining()));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<blockquote>\n<p>stream1:ABC</p>\n</blockquote>\n<h2 id=\"2ã€Stream-of-æ•°ç»„\"><a href=\"#2ã€Stream-of-æ•°ç»„\" class=\"headerlink\" title=\"2ã€Stream.of æ•°ç»„\"></a>2ã€Stream.of æ•°ç»„</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">String[] values &#x3D; new String[]&#123;&quot;A&quot;, &quot;B&quot;, &quot;C&quot;&#125;;\nStream&lt;String&gt; stream2 &#x3D; Stream.of(values);\nSystem.out.println(&quot;stream2:&quot; + stream2.collect(joining()));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<blockquote>\n<p>stream2:ABC</p>\n</blockquote>\n<p>çœ‹ Stream.of æºç ï¼Œä¸Šé¢è¿™ä¸¤ç§æ–¹å¼å…¶å®å°±æ˜¯ç¬¬ä¸‰ç§æ–¹å¼çš„åŒ…è£…ç‰ˆã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static&lt;T&gt; Stream&lt;T&gt; of(T... values) &#123;\n    return Arrays.stream(values);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>æˆ‘ä»¬ç›´æ¥ä½¿ç”¨æºç ä¸­çš„æ–¹å¼ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚</p>\n<h2 id=\"3ã€Arrays-stream\"><a href=\"#3ã€Arrays-stream\" class=\"headerlink\" title=\"3ã€Arrays.stream\"></a>3ã€Arrays.stream</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">String[] values &#x3D; new String[]&#123;&quot;A&quot;, &quot;B&quot;, &quot;C&quot;&#125;;\nStream&lt;String&gt; stream3 &#x3D; Arrays.stream(values);\nSystem.out.println(&quot;stream3:&quot; + stream3.collect(joining()));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<blockquote>\n<p>stream3:ABC</p>\n</blockquote>\n<h2 id=\"4ã€List\"><a href=\"#4ã€List\" class=\"headerlink\" title=\"4ã€List\"></a>4ã€List</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;String&gt; list &#x3D; Arrays.asList(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;);\nStream&lt;String&gt; stream4 &#x3D; list.stream();\nSystem.out.println(&quot;stream4:&quot; + stream4.collect(joining()));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<blockquote>\n<p>stream4:ABC</p>\n</blockquote>\n<h2 id=\"5ã€Set\"><a href=\"#5ã€Set\" class=\"headerlink\" title=\"5ã€Set\"></a>5ã€Set</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">Set&lt;String&gt; set &#x3D; new HashSet&lt;&gt;(Arrays.asList(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;));\nStream&lt;String&gt; stream5 &#x3D; set.stream();\nSystem.out.println(&quot;stream5:&quot; + stream5.collect(joining()));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<blockquote>\n<p>stream5:ABC</p>\n</blockquote>\n<h2 id=\"6ã€Map\"><a href=\"#6ã€Map\" class=\"headerlink\" title=\"6ã€Map\"></a>6ã€Map</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">Map&lt;String, String&gt; map &#x3D; new HashMap&lt;&gt;();\nmap.put(&quot;1&quot;, &quot;A&quot;);\nmap.put(&quot;2&quot;, &quot;B&quot;);\nmap.put(&quot;3&quot;, &quot;C&quot;);\nStream&lt;String&gt; stream6 &#x3D; map.values().stream();\nSystem.out.println(&quot;stream6:&quot; + stream6.collect(joining()));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<blockquote>\n<p>stream6:ABC</p>\n</blockquote>\n<h2 id=\"7ã€Stream-iterate\"><a href=\"#7ã€Stream-iterate\" class=\"headerlink\" title=\"7ã€Stream.iterate\"></a>7ã€Stream.iterate</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">Stream&lt;String&gt; stream7 &#x3D; Stream.iterate(&quot;A&quot;, e -&gt; String.valueOf((char) (e.charAt(0) + 1))).limit(3);\nSystem.out.println(&quot;stream7:&quot; + stream7.collect(joining()));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<blockquote>\n<p>stream7:ABC</p>\n</blockquote>\n<h2 id=\"8ã€Pattern\"><a href=\"#8ã€Pattern\" class=\"headerlink\" title=\"8ã€Pattern\"></a>8ã€Pattern</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">String value &#x3D; &quot;A B C&quot;;\nStream&lt;String&gt; stream8 &#x3D; Pattern.compile(&quot;\\\\W&quot;).splitAsStream(value);\nSystem.out.println(&quot;stream8:&quot; + stream8.collect(joining()));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<blockquote>\n<p>stream8:ABC</p>\n</blockquote>\n<h2 id=\"9ã€Files-lines\"><a href=\"#9ã€Files-lines\" class=\"headerlink\" title=\"9ã€Files.lines\"></a>9ã€Files.lines</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">try &#123;\n    Stream&lt;String&gt; stream9 &#x3D; Files.lines(Paths.get(&quot;d:&#x2F;data.txt&quot;));\n    System.out.println(&quot;stream9:&quot; + stream9.collect(joining()));\n&#125; catch (IOException e) &#123;\n    e.printStackTrace();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>data.txtæ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">A\nB\nC<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<blockquote>\n<p>stream9:ABC</p>\n</blockquote>\n<h2 id=\"10ã€Stream-generate\"><a href=\"#10ã€Stream-generate\" class=\"headerlink\" title=\"10ã€Stream.generate\"></a>10ã€Stream.generate</h2><pre class=\"line-numbers language-none\"><code class=\"language-none\">Stream&lt;String&gt; stream10 &#x3D; Stream.generate(() -&gt; &quot;A&quot;).limit(3);\nSystem.out.println(&quot;stream10:&quot; + stream10.collect(joining()));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>ç¨‹åºè¾“å‡ºï¼š</p>\n<blockquote>\n<p>stream10:AAA</p>\n</blockquote>\n<p>å¥½äº†ï¼Œè¿™æ˜¯æ ˆé•¿æ•´ç†çš„ 10 ç§åˆ›å»º Stream çš„æ–¹å¼ï¼Œæ˜¯ä¸æ˜¯å¾ˆéªšï¼Ÿå¦‚æœä½ è¿˜çŸ¥é“å…¶ä»–çš„éªšæ“ä½œï¼Œå¯ä»¥ç•™è¨€å‘Šè¯‰å¤§å®¶ï¼Œè®©å¤§å®¶è®°ä½ä½ çš„å¤´åƒå’ŒIDã€‚</p>\n"},{"title":"Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸ƒï¼‰æµä¸è¿­ä»£å™¨ï¼Œæµç³»åˆ—å¤§ç»“å±€ï¼","date":"2025-10-15T03:36:33.000Z","_content":"\næ­å–œä½ ä»¬ï¼Œé©¬ä¸Šå°±è¦å­¦å®ŒJava8 Streamæµçš„ä¸€æ•´ç³»åˆ—äº†ï¼Œå…¶å®æˆ‘ç›¸ä¿¡Streamæµå¯¹å¾ˆå¤šä½¿ç”¨Javaçš„åŒå­¦æ¥è¯´ï¼Œéƒ½æ˜¯ä¸€ä¸ªçŸ¥è¯†ç›²ç‚¹ï¼Œå› ä¸ºè¿™ä¸ªåŸå› ï¼Œæˆ‘æ‰è¿™ä¹ˆç»†è‡´åœ°è®²è§£Streamæµçš„å„ä¸ªçŸ¥è¯†ç‚¹ï¼Œé€šè¿‡è¿™ä¸€æ•´ä¸ªç³»åˆ—ï¼Œæˆ‘ç›¸ä¿¡åªè¦è®¤çœŸçœ‹äº†çš„åŒå­¦ï¼Œéƒ½å·²æŒæ¡çš„å·®ä¸å¤šäº†ï¼Œå°±å·®å®æˆ˜äº†ã€‚\n\nå…¶å®æˆ‘åœ¨å·¥ä½œè¿‡ç¨‹ä¸­ï¼ŒStreamæµå¯¹æˆ‘çš„å¸®åŠ©çœŸçš„æŒºå¤§çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘æƒ³å’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹ï¼Œäºæ˜¯è¿™ç³»åˆ—çš„æ–‡ç« å°±å‡ºæ¥äº†ã€‚\n\nåœ¨æœ¬ç³»åˆ—æ–‡ç« å‘å¸ƒçš„æ—¶å€™ï¼Œæœ‰å¾ˆå¤šåŒå­¦åæ˜ ï¼ŒStreamæµçš„è°ƒè¯•å’ŒforEach()çš„è°ƒè¯•éƒ½ä¸æ˜¯ç‰¹åˆ«å‹å¥½ï¼Œé‚£æœ¬ç¯‡ç»™å‡ºä¸€ä¸ªæŠ˜ä¸­çš„è°ƒè¯•æ–¹æ³•ï¼Œè™½ç„¶ä¸èƒ½å®Œç¾è§£å†³è°ƒè¯•çš„é—®é¢˜ï¼Œä½†æ˜¯åŸºæœ¬ä¸Šå·²ç»èƒ½è§£å†³ç»å¤§éƒ¨åˆ†çš„è°ƒè¯•é—®é¢˜äº†ï¼Œæ²¡é”™ï¼Œå°±æ˜¯è¿­ä»£å™¨äº†ï¼Œå½“ç„¶è¿­ä»£å™¨é™¤äº†èƒ½è¾…åŠ©è°ƒè¯•ä»¥å¤–ï¼Œä»–æœ€é‡è¦çš„è¿˜æ˜¯éå†åŠŸèƒ½ã€‚\n\nè¿™ç¯‡æ–‡ç« é™¤äº†ä»‹ç»ä¼ ç»Ÿçš„è¿­ä»£å™¨å¤–ï¼Œè¿˜ä¼šä»‹ç»Java8ä¸­æ–°å¢çš„Spliteratorï¼Œå› ä¸ºåœ¨å¹¶è¡Œæµçš„åœºåˆï¼ŒSpliteratorç›¸å½“çš„å¥½ç”¨ã€‚\n\n#### æˆ‘ä»¬å…ˆç®€å•ä»‹ç»ä¸€ä¸‹ä¼ ç»Ÿçš„è¿­ä»£å™¨\n\nè¿­ä»£å™¨æ˜¯å®ç°äº†Iteratoræ¥å£çš„å¯¹è±¡ï¼Œå¹¶ä¸”Iteratoræ¥å£å…è®¸éå†ï¼Œè·å–æˆ–è€…ç§»é™¤å…ƒç´ ã€‚\n\n```\npublic interface Iterator<E> {\n  Iterator<T> iterator();\n  E next();\n  default void remove() {\n        throw new UnsupportedOperationException(\"remove\");\n  }\n  default void forEachRemaining(Consumer<? super E> action) {\n        Objects.requireNonNull(action);\n        while (hasNext())\n            action.accept(next());\n  }\n\n}\n```\n\nä½¿ç”¨Iteratorçš„ä¸€èˆ¬æ­¥éª¤ï¼š\n\n* (1)é€šè¿‡iterator()æ–¹æ³•ï¼Œè·å–æŒ‡å‘é›†åˆæˆ–æµå¼€å¤´çš„è¿­ä»£å™¨ã€‚\n\n* (2)å»ºç«‹ä¸€ä¸ªhasNext()æ–¹æ³•è°ƒç”¨å¾ªç¯ï¼Œåªè¦hasNext()è¿”å›true,å°±ç»§ç»­è¿­ä»£ã€‚\n\n* (3)åœ¨å¾ªç¯ä¸­ï¼Œé€šè¿‡è°ƒç”¨next()æ–¹æ³•è·å–æ¯ä¸ªå…ƒç´ ã€‚\n\n```\nprivate static void learnIterator() {\n    List<String> lists = Arrays.asList(\"A\", \"B\", \"C\", \"D\");\n\n    Iterator<String> iterator = lists.stream().iterator();\n\n    while (iterator.hasNext()) {\n        System.out.println(iterator.next());\n    }\n}\n```\n\nä½†æ˜¯å¦‚æœæˆ‘ä»¬ä¸ä¿®æ”¹é›†åˆçš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨forEach()å…¶å®æ›´åŠ ä¾¿åˆ©çš„ï¼Œå…¶å®ä¸¤ç§æ–¹å¼æœ¬è´¨ä¸Šé¢æ˜¯ä¸€æ ·çš„ï¼Œåœ¨ä½ ç¼–è¯‘ä¹‹åï¼ŒforEach()ä¼šè½¬æ¢æˆè¿­ä»£å™¨çš„æ–¹å¼è¿›è¡Œæ“ä½œäº†ã€‚æœ‰äº†è¿­ä»£å™¨ï¼Œç›¸ä¿¡è°ƒè¯•å°±å¾—æ–¹ä¾¿èµ·æ¥äº†ï¼Œå³ä½¿ä¸èƒ½ç›´æ¥è°ƒè¯•ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è¿­ä»£å™¨ï¼Œåæ¨ä¹‹å‰ï¼Œå¯èƒ½å‘ç”Ÿäº†ä»€ä¹ˆã€‚\n\nå€¼å¾—æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼šJava8ç»™åŸºæœ¬ç±»å‹çš„æµæä¾›äº†é¢å¤–çš„è¿­ä»£å™¨ï¼šPrimitiveIterator.OfInt,PrimitiveIterator.OfDouble,PrimitiveIterator.OfLong,PrimitiveIterator,ä½†è¿™äº›æ¥å£éƒ½æ˜¯æ¥æ‰©å±•è‡ªIteratoræ¥å£çš„ï¼Œæ‰€ä»¥ä½¿ç”¨ä¸Šé¢ä¹Ÿæ˜¯ç›¸åŒçš„ã€‚\n\n#### Spliterator\n\nSpliteratoræ˜¯Java8æ–°å¢çš„ä¸€ç§è¿­ä»£å™¨ï¼Œè¿™ç§è¿­ä»£å™¨ç”±`Spliterator`æ¥å£å®šä¹‰ï¼ŒSpliteratorä¹Ÿæœ‰æ™®é€šçš„éå†å…ƒç´ åŠŸèƒ½ï¼Œè¿™ä¸€ç‚¹ä¸åˆšæ‰è¯´çš„è¿­ä»£å™¨ç±»ä¼¼çš„ï¼Œä½†æ˜¯ï¼Œä½†æ˜¯Spliteratoræ–¹æ³•å’Œä½¿ç”¨è¿­ä»£å™¨çš„æ–¹æ³•æ˜¯ä¸åŒçš„ã€‚\n\nå¦å¤–ï¼Œå®ƒæä¾›çš„åŠŸèƒ½è¦æ¯”Iteratorå¤šã€‚æœ€ç»ˆè¦çš„ä¸€ç‚¹ï¼ŒSpliteratoræ”¯æŒå¹¶è¡Œè¿­ä»£ã€‚\n\n```\npublic interface Spliterator<T> {\n    boolean tryAdvance(Consumer<? super T> action);\n    int characteristics();\n    long estimateSize();\n   Spliterator<T> trySplit();\n   default void forEachRemaining(Consumer<? super T> action) {\n        do { } while (tryAdvance(action));\n   }\n}\n```\n\nå°†Spliteratorç”¨äºåŸºæœ¬è¿­ä»£ä»»åŠ¡æ˜¯éå¸¸ç®€å•çš„ï¼Œåªéœ€è¦è°ƒç”¨tryAdvance()æ–¹æ³•ï¼Œç›´è‡³å…¶è¿”å›false.å¦‚æœè¦ä¸ºåºåˆ—ä¸­çš„æ¯ä¸ªå…ƒç´ åº”ç”¨ç›¸åŒçš„åŠ¨ä½œï¼Œé‚£ä¹ˆforEachRemaining()æä¾›äº†ä¸€ç§æ›´åŠ é«˜æ•ˆçš„æ›¿ä»£æ–¹æ³•ã€‚\n\nå¯¹äºè¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œåœ¨æ¯æ¬¡è¿­ä»£ä¸­å°†å‘ç”Ÿçš„åŠ¨ä½œéƒ½ç”±`Consumer`å¯¹è±¡å®šä¹‰çš„æ“ä½œæ¥å†³å®šï¼Œ`Consumer`ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œä¼°è®¡å¤§å®¶å·²ç»çŸ¥é“æ€ä¹ˆåˆ†æäº†ï¼Œè¿™é‡Œå°±ä¸å¸¦å¤§å®¶åˆ†æäº†ï¼Œä»–çš„åŠ¨ä½œæ˜¯æŒ‡å®šäº†åœ¨è¿­ä»£ä¸­ä¸‹ä¸€ä¸ªå…ƒç´ ä¸Šæ‰§è¡Œçš„æ“ä½œã€‚ä¸‹é¢æ¥ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š\n\n```\nprivate static void learnIterator() {\n    List<String> lists = Arrays.asList(\"A\", \"B\", \"C\", \"D\");\n\n    Spliterator<String> spliterator = lists.stream().spliterator();\n\n    while (spliterator.tryAdvance(System.out::println));\n}\n```\n\nä½¿ç”¨forEachRemaining()æ–¹æ³•æ”¹è¿›è¿™ä¸ªä¾‹å­ï¼š\n\n```\nprivate static void learnIterator() {\n    List<String> lists = Arrays.asList(\"A\", \"B\", \"C\", \"D\");\n    lists.stream().spliterator().forEachRemaining(System.out::println);\n}\n```\n\næ³¨æ„ï¼Œä½¿ç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œä¸éœ€è¦æä¾›ä¸€ä¸ªå¾ªç¯æ¥ä¸€æ¬¡å¤„ç†ä¸€ä¸ªå…ƒç´ ï¼Œè€Œæ˜¯å°†å„ä¸ªå…ƒç´ ä½œä¸ºä¸€ä¸ªæ•´ä½“æ¥å¯¹å¾…ï¼Œè¿™æ˜¯Spliteratorçš„åˆä¸€ä¸ªä¼˜åŠ¿ã€‚\n\nSpliteratorçš„å¦ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„æ–¹æ³•æ˜¯trySplit()ï¼Œå®ƒå°†è¢«è¿­ä»£çš„å…ƒç´ åˆ’åˆ†æˆäº†ä¸¤éƒ¨åˆ†ï¼Œè¿”å›å…¶ä¸­ä¸€éƒ¨åˆ†çš„æ–°Spliterator,å¦ä¸€éƒ¨åˆ†åˆ™é€šè¿‡åŸæ¥çš„Spliteratorè®¿é—®ã€‚ä¸‹é¢å†ç»™ä¸€ä¸ªç®€å•çš„ä¾‹å­\n\n```\nprivate static void learnIterator() {\n    List<String> lists = Arrays.asList(\"A\", \"B\", \"C\", \"D\");\n\n    Spliterator<String> spliterator = lists.stream().spliterator();\n\n    Spliterator<String> stringSpliterator = spliterator.trySplit();\n\n    if (stringSpliterator != null) stringSpliterator.forEachRemaining(System.out::println);\n\n    System.out.println(\"------------------\");\n\n    spliterator.forEachRemaining(System.out::println);\n}\n```\n\næ‰“å°çš„ç»“æœï¼š\n\n```\nA\nB\n------------------\nC\nD\n```\n\nè¿™é‡Œåªæ˜¯ç»™å¤§å®¶æä¾›äº†è¿™ç§æ–¹å¼è€Œå·²ï¼Œä¾‹å­æœ¬èº«æ²¡æœ‰ä»€ä¹ˆå«ä¹‰ï¼Œä½†æ˜¯å½“ä½ å¯¹å¤§æ•°æ®é›†æ‰§è¡Œå¹¶è¡Œå¤„ç†æ—¶ï¼Œæ‹†åˆ†å¯èƒ½æ˜¯ææœ‰å¸®åŠ©çš„äº†ã€‚ä½†æ›´å¤šæƒ…å†µä¸‹ï¼Œè¦å¯¹æµæ‰§è¡Œå¹¶è¡Œæ“ä½œæ—¶ï¼Œä½¿ç”¨å…¶ä»–æŸä¸ªStreamæ–¹æ³•æ›´å¥½ï¼Œè€Œä¸å¿…æ‰‹åŠ¨å¤„ç†Spliteratorçš„è¿™äº›ç»†èŠ‚ï¼ŒSpliteratoræœ€é€‚åˆçš„åœºæ™¯æ˜¯ï¼Œç»™å®šçš„æ‰€æœ‰æ–¹æ³•éƒ½ä¸èƒ½æ»¡è¶³ä½ çš„è¦æ±‚æ—¶ï¼Œæ‰è€ƒè™‘ã€‚\n\n#### æœ€åæ¥ä¸€ä¸ªæ€»ç»“\n\nåˆ°è¿™é‡Œï¼ŒJava8 Streamæµçš„çŸ¥è¯†ï¼ŒåŸºæœ¬ä¸Šå·²ç»ä»‹ç»å®Œäº†ï¼Œç¼©å‡æ“ä½œï¼Œå¹¶è¡Œæµï¼Œæ˜ å°„ï¼Œè¿˜æœ‰æ”¶é›†æ˜¯Streamæµçš„æ ¸å¿ƒå†…å®¹ï¼Œä½†æ˜¯è¦æƒ³æŒæ¡å¥½è¿™äº›å†…å®¹ï¼Œç¬¬äºŒç¯‡çš„åŸºæœ¬çŸ¥è¯†ä½ æ˜¯è·‘ä¸æ‰çš„ï¼Œå› æ­¤æˆ‘çš„å»ºè®®è¿˜æ˜¯è€è€å®å®ï¼Œä»ç¬¬ä¸€ç¯‡å¼€å§‹è®¤çœŸçœ‹ï¼Œçœ‹å®Œè¿™7ç¯‡æ–‡ç« ï¼Œä½ åŸºæœ¬å·²ç»éå¸¸ç³»ç»Ÿåœ°æŒæ¡Java8çš„StreamæµçŸ¥è¯†äº†ã€‚\n\nå¤§å®¶ä¹Ÿä¸è¦å¿˜è®°`Collectors`ç±»ï¼Œé‡Œé¢æä¾›ç»™æˆ‘ä»¬çš„æ–¹æ³•ï¼ŒåŸºæœ¬ä¸Šèƒ½å¤„ç†å„ç§å„æ ·çš„æ”¶é›†å…ƒç´ é—®é¢˜äº†ï¼Œå¦‚æœä½ ä»ç¬¬ä¸€ç¯‡æ–‡ç« å¼€å§‹çœ‹ï¼Œä¸€ç›´çœ‹åˆ°è¿™é‡Œäº†ï¼Œé‚£ä½ ä»¥åå°½é‡å¤šä½¿ç”¨Streamæµæ¥å¤„ç†é›†åˆå§ï¼Œåªæ˜¯å­¦ä¼šè¿™äº›çŸ¥è¯†æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œè¦å¤šåœ¨ä½ ä»¬çš„é¡¹ç›®ä¸­è¿ç”¨ä»–ä»¬ï¼Œè¿™æ ·æ‰èƒ½æ›´åŠ å¥½åœ°ç†è§£ï¼Œå¦‚æœå¤§å®¶åœ¨ä½¿æœ‰çš„è¿‡ç¨‹ä¸­é‡åˆ°ä»€ä¹ˆæ ·çš„é—®é¢˜ï¼Œæ¬¢è¿æ¥è¿™é‡Œé¢ç•™è¨€ï¼Œæˆ‘çœ‹åˆ°äº†ï¼Œä¸€å®šç¬¬ä¸€æ—¶é—´å’Œå¤§å®¶ä¸€èµ·æ¢ç´¢è§£å†³çš„æ–¹æ³•ã€‚\n\n","source":"_posts/æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸ƒï¼‰æµä¸è¿­ä»£å™¨ï¼Œæµç³»åˆ—å¤§ç»“å±€ï¼.md","raw":"---\ntitle: Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸ƒï¼‰æµä¸è¿­ä»£å™¨ï¼Œæµç³»åˆ—å¤§ç»“å±€ï¼\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: æ–°ç‰¹æ€§\n---\n\næ­å–œä½ ä»¬ï¼Œé©¬ä¸Šå°±è¦å­¦å®ŒJava8 Streamæµçš„ä¸€æ•´ç³»åˆ—äº†ï¼Œå…¶å®æˆ‘ç›¸ä¿¡Streamæµå¯¹å¾ˆå¤šä½¿ç”¨Javaçš„åŒå­¦æ¥è¯´ï¼Œéƒ½æ˜¯ä¸€ä¸ªçŸ¥è¯†ç›²ç‚¹ï¼Œå› ä¸ºè¿™ä¸ªåŸå› ï¼Œæˆ‘æ‰è¿™ä¹ˆç»†è‡´åœ°è®²è§£Streamæµçš„å„ä¸ªçŸ¥è¯†ç‚¹ï¼Œé€šè¿‡è¿™ä¸€æ•´ä¸ªç³»åˆ—ï¼Œæˆ‘ç›¸ä¿¡åªè¦è®¤çœŸçœ‹äº†çš„åŒå­¦ï¼Œéƒ½å·²æŒæ¡çš„å·®ä¸å¤šäº†ï¼Œå°±å·®å®æˆ˜äº†ã€‚\n\nå…¶å®æˆ‘åœ¨å·¥ä½œè¿‡ç¨‹ä¸­ï¼ŒStreamæµå¯¹æˆ‘çš„å¸®åŠ©çœŸçš„æŒºå¤§çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘æƒ³å’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹ï¼Œäºæ˜¯è¿™ç³»åˆ—çš„æ–‡ç« å°±å‡ºæ¥äº†ã€‚\n\nåœ¨æœ¬ç³»åˆ—æ–‡ç« å‘å¸ƒçš„æ—¶å€™ï¼Œæœ‰å¾ˆå¤šåŒå­¦åæ˜ ï¼ŒStreamæµçš„è°ƒè¯•å’ŒforEach()çš„è°ƒè¯•éƒ½ä¸æ˜¯ç‰¹åˆ«å‹å¥½ï¼Œé‚£æœ¬ç¯‡ç»™å‡ºä¸€ä¸ªæŠ˜ä¸­çš„è°ƒè¯•æ–¹æ³•ï¼Œè™½ç„¶ä¸èƒ½å®Œç¾è§£å†³è°ƒè¯•çš„é—®é¢˜ï¼Œä½†æ˜¯åŸºæœ¬ä¸Šå·²ç»èƒ½è§£å†³ç»å¤§éƒ¨åˆ†çš„è°ƒè¯•é—®é¢˜äº†ï¼Œæ²¡é”™ï¼Œå°±æ˜¯è¿­ä»£å™¨äº†ï¼Œå½“ç„¶è¿­ä»£å™¨é™¤äº†èƒ½è¾…åŠ©è°ƒè¯•ä»¥å¤–ï¼Œä»–æœ€é‡è¦çš„è¿˜æ˜¯éå†åŠŸèƒ½ã€‚\n\nè¿™ç¯‡æ–‡ç« é™¤äº†ä»‹ç»ä¼ ç»Ÿçš„è¿­ä»£å™¨å¤–ï¼Œè¿˜ä¼šä»‹ç»Java8ä¸­æ–°å¢çš„Spliteratorï¼Œå› ä¸ºåœ¨å¹¶è¡Œæµçš„åœºåˆï¼ŒSpliteratorç›¸å½“çš„å¥½ç”¨ã€‚\n\n#### æˆ‘ä»¬å…ˆç®€å•ä»‹ç»ä¸€ä¸‹ä¼ ç»Ÿçš„è¿­ä»£å™¨\n\nè¿­ä»£å™¨æ˜¯å®ç°äº†Iteratoræ¥å£çš„å¯¹è±¡ï¼Œå¹¶ä¸”Iteratoræ¥å£å…è®¸éå†ï¼Œè·å–æˆ–è€…ç§»é™¤å…ƒç´ ã€‚\n\n```\npublic interface Iterator<E> {\n  Iterator<T> iterator();\n  E next();\n  default void remove() {\n        throw new UnsupportedOperationException(\"remove\");\n  }\n  default void forEachRemaining(Consumer<? super E> action) {\n        Objects.requireNonNull(action);\n        while (hasNext())\n            action.accept(next());\n  }\n\n}\n```\n\nä½¿ç”¨Iteratorçš„ä¸€èˆ¬æ­¥éª¤ï¼š\n\n* (1)é€šè¿‡iterator()æ–¹æ³•ï¼Œè·å–æŒ‡å‘é›†åˆæˆ–æµå¼€å¤´çš„è¿­ä»£å™¨ã€‚\n\n* (2)å»ºç«‹ä¸€ä¸ªhasNext()æ–¹æ³•è°ƒç”¨å¾ªç¯ï¼Œåªè¦hasNext()è¿”å›true,å°±ç»§ç»­è¿­ä»£ã€‚\n\n* (3)åœ¨å¾ªç¯ä¸­ï¼Œé€šè¿‡è°ƒç”¨next()æ–¹æ³•è·å–æ¯ä¸ªå…ƒç´ ã€‚\n\n```\nprivate static void learnIterator() {\n    List<String> lists = Arrays.asList(\"A\", \"B\", \"C\", \"D\");\n\n    Iterator<String> iterator = lists.stream().iterator();\n\n    while (iterator.hasNext()) {\n        System.out.println(iterator.next());\n    }\n}\n```\n\nä½†æ˜¯å¦‚æœæˆ‘ä»¬ä¸ä¿®æ”¹é›†åˆçš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨forEach()å…¶å®æ›´åŠ ä¾¿åˆ©çš„ï¼Œå…¶å®ä¸¤ç§æ–¹å¼æœ¬è´¨ä¸Šé¢æ˜¯ä¸€æ ·çš„ï¼Œåœ¨ä½ ç¼–è¯‘ä¹‹åï¼ŒforEach()ä¼šè½¬æ¢æˆè¿­ä»£å™¨çš„æ–¹å¼è¿›è¡Œæ“ä½œäº†ã€‚æœ‰äº†è¿­ä»£å™¨ï¼Œç›¸ä¿¡è°ƒè¯•å°±å¾—æ–¹ä¾¿èµ·æ¥äº†ï¼Œå³ä½¿ä¸èƒ½ç›´æ¥è°ƒè¯•ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è¿­ä»£å™¨ï¼Œåæ¨ä¹‹å‰ï¼Œå¯èƒ½å‘ç”Ÿäº†ä»€ä¹ˆã€‚\n\nå€¼å¾—æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼šJava8ç»™åŸºæœ¬ç±»å‹çš„æµæä¾›äº†é¢å¤–çš„è¿­ä»£å™¨ï¼šPrimitiveIterator.OfInt,PrimitiveIterator.OfDouble,PrimitiveIterator.OfLong,PrimitiveIterator,ä½†è¿™äº›æ¥å£éƒ½æ˜¯æ¥æ‰©å±•è‡ªIteratoræ¥å£çš„ï¼Œæ‰€ä»¥ä½¿ç”¨ä¸Šé¢ä¹Ÿæ˜¯ç›¸åŒçš„ã€‚\n\n#### Spliterator\n\nSpliteratoræ˜¯Java8æ–°å¢çš„ä¸€ç§è¿­ä»£å™¨ï¼Œè¿™ç§è¿­ä»£å™¨ç”±`Spliterator`æ¥å£å®šä¹‰ï¼ŒSpliteratorä¹Ÿæœ‰æ™®é€šçš„éå†å…ƒç´ åŠŸèƒ½ï¼Œè¿™ä¸€ç‚¹ä¸åˆšæ‰è¯´çš„è¿­ä»£å™¨ç±»ä¼¼çš„ï¼Œä½†æ˜¯ï¼Œä½†æ˜¯Spliteratoræ–¹æ³•å’Œä½¿ç”¨è¿­ä»£å™¨çš„æ–¹æ³•æ˜¯ä¸åŒçš„ã€‚\n\nå¦å¤–ï¼Œå®ƒæä¾›çš„åŠŸèƒ½è¦æ¯”Iteratorå¤šã€‚æœ€ç»ˆè¦çš„ä¸€ç‚¹ï¼ŒSpliteratoræ”¯æŒå¹¶è¡Œè¿­ä»£ã€‚\n\n```\npublic interface Spliterator<T> {\n    boolean tryAdvance(Consumer<? super T> action);\n    int characteristics();\n    long estimateSize();\n   Spliterator<T> trySplit();\n   default void forEachRemaining(Consumer<? super T> action) {\n        do { } while (tryAdvance(action));\n   }\n}\n```\n\nå°†Spliteratorç”¨äºåŸºæœ¬è¿­ä»£ä»»åŠ¡æ˜¯éå¸¸ç®€å•çš„ï¼Œåªéœ€è¦è°ƒç”¨tryAdvance()æ–¹æ³•ï¼Œç›´è‡³å…¶è¿”å›false.å¦‚æœè¦ä¸ºåºåˆ—ä¸­çš„æ¯ä¸ªå…ƒç´ åº”ç”¨ç›¸åŒçš„åŠ¨ä½œï¼Œé‚£ä¹ˆforEachRemaining()æä¾›äº†ä¸€ç§æ›´åŠ é«˜æ•ˆçš„æ›¿ä»£æ–¹æ³•ã€‚\n\nå¯¹äºè¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œåœ¨æ¯æ¬¡è¿­ä»£ä¸­å°†å‘ç”Ÿçš„åŠ¨ä½œéƒ½ç”±`Consumer`å¯¹è±¡å®šä¹‰çš„æ“ä½œæ¥å†³å®šï¼Œ`Consumer`ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œä¼°è®¡å¤§å®¶å·²ç»çŸ¥é“æ€ä¹ˆåˆ†æäº†ï¼Œè¿™é‡Œå°±ä¸å¸¦å¤§å®¶åˆ†æäº†ï¼Œä»–çš„åŠ¨ä½œæ˜¯æŒ‡å®šäº†åœ¨è¿­ä»£ä¸­ä¸‹ä¸€ä¸ªå…ƒç´ ä¸Šæ‰§è¡Œçš„æ“ä½œã€‚ä¸‹é¢æ¥ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š\n\n```\nprivate static void learnIterator() {\n    List<String> lists = Arrays.asList(\"A\", \"B\", \"C\", \"D\");\n\n    Spliterator<String> spliterator = lists.stream().spliterator();\n\n    while (spliterator.tryAdvance(System.out::println));\n}\n```\n\nä½¿ç”¨forEachRemaining()æ–¹æ³•æ”¹è¿›è¿™ä¸ªä¾‹å­ï¼š\n\n```\nprivate static void learnIterator() {\n    List<String> lists = Arrays.asList(\"A\", \"B\", \"C\", \"D\");\n    lists.stream().spliterator().forEachRemaining(System.out::println);\n}\n```\n\næ³¨æ„ï¼Œä½¿ç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œä¸éœ€è¦æä¾›ä¸€ä¸ªå¾ªç¯æ¥ä¸€æ¬¡å¤„ç†ä¸€ä¸ªå…ƒç´ ï¼Œè€Œæ˜¯å°†å„ä¸ªå…ƒç´ ä½œä¸ºä¸€ä¸ªæ•´ä½“æ¥å¯¹å¾…ï¼Œè¿™æ˜¯Spliteratorçš„åˆä¸€ä¸ªä¼˜åŠ¿ã€‚\n\nSpliteratorçš„å¦ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„æ–¹æ³•æ˜¯trySplit()ï¼Œå®ƒå°†è¢«è¿­ä»£çš„å…ƒç´ åˆ’åˆ†æˆäº†ä¸¤éƒ¨åˆ†ï¼Œè¿”å›å…¶ä¸­ä¸€éƒ¨åˆ†çš„æ–°Spliterator,å¦ä¸€éƒ¨åˆ†åˆ™é€šè¿‡åŸæ¥çš„Spliteratorè®¿é—®ã€‚ä¸‹é¢å†ç»™ä¸€ä¸ªç®€å•çš„ä¾‹å­\n\n```\nprivate static void learnIterator() {\n    List<String> lists = Arrays.asList(\"A\", \"B\", \"C\", \"D\");\n\n    Spliterator<String> spliterator = lists.stream().spliterator();\n\n    Spliterator<String> stringSpliterator = spliterator.trySplit();\n\n    if (stringSpliterator != null) stringSpliterator.forEachRemaining(System.out::println);\n\n    System.out.println(\"------------------\");\n\n    spliterator.forEachRemaining(System.out::println);\n}\n```\n\næ‰“å°çš„ç»“æœï¼š\n\n```\nA\nB\n------------------\nC\nD\n```\n\nè¿™é‡Œåªæ˜¯ç»™å¤§å®¶æä¾›äº†è¿™ç§æ–¹å¼è€Œå·²ï¼Œä¾‹å­æœ¬èº«æ²¡æœ‰ä»€ä¹ˆå«ä¹‰ï¼Œä½†æ˜¯å½“ä½ å¯¹å¤§æ•°æ®é›†æ‰§è¡Œå¹¶è¡Œå¤„ç†æ—¶ï¼Œæ‹†åˆ†å¯èƒ½æ˜¯ææœ‰å¸®åŠ©çš„äº†ã€‚ä½†æ›´å¤šæƒ…å†µä¸‹ï¼Œè¦å¯¹æµæ‰§è¡Œå¹¶è¡Œæ“ä½œæ—¶ï¼Œä½¿ç”¨å…¶ä»–æŸä¸ªStreamæ–¹æ³•æ›´å¥½ï¼Œè€Œä¸å¿…æ‰‹åŠ¨å¤„ç†Spliteratorçš„è¿™äº›ç»†èŠ‚ï¼ŒSpliteratoræœ€é€‚åˆçš„åœºæ™¯æ˜¯ï¼Œç»™å®šçš„æ‰€æœ‰æ–¹æ³•éƒ½ä¸èƒ½æ»¡è¶³ä½ çš„è¦æ±‚æ—¶ï¼Œæ‰è€ƒè™‘ã€‚\n\n#### æœ€åæ¥ä¸€ä¸ªæ€»ç»“\n\nåˆ°è¿™é‡Œï¼ŒJava8 Streamæµçš„çŸ¥è¯†ï¼ŒåŸºæœ¬ä¸Šå·²ç»ä»‹ç»å®Œäº†ï¼Œç¼©å‡æ“ä½œï¼Œå¹¶è¡Œæµï¼Œæ˜ å°„ï¼Œè¿˜æœ‰æ”¶é›†æ˜¯Streamæµçš„æ ¸å¿ƒå†…å®¹ï¼Œä½†æ˜¯è¦æƒ³æŒæ¡å¥½è¿™äº›å†…å®¹ï¼Œç¬¬äºŒç¯‡çš„åŸºæœ¬çŸ¥è¯†ä½ æ˜¯è·‘ä¸æ‰çš„ï¼Œå› æ­¤æˆ‘çš„å»ºè®®è¿˜æ˜¯è€è€å®å®ï¼Œä»ç¬¬ä¸€ç¯‡å¼€å§‹è®¤çœŸçœ‹ï¼Œçœ‹å®Œè¿™7ç¯‡æ–‡ç« ï¼Œä½ åŸºæœ¬å·²ç»éå¸¸ç³»ç»Ÿåœ°æŒæ¡Java8çš„StreamæµçŸ¥è¯†äº†ã€‚\n\nå¤§å®¶ä¹Ÿä¸è¦å¿˜è®°`Collectors`ç±»ï¼Œé‡Œé¢æä¾›ç»™æˆ‘ä»¬çš„æ–¹æ³•ï¼ŒåŸºæœ¬ä¸Šèƒ½å¤„ç†å„ç§å„æ ·çš„æ”¶é›†å…ƒç´ é—®é¢˜äº†ï¼Œå¦‚æœä½ ä»ç¬¬ä¸€ç¯‡æ–‡ç« å¼€å§‹çœ‹ï¼Œä¸€ç›´çœ‹åˆ°è¿™é‡Œäº†ï¼Œé‚£ä½ ä»¥åå°½é‡å¤šä½¿ç”¨Streamæµæ¥å¤„ç†é›†åˆå§ï¼Œåªæ˜¯å­¦ä¼šè¿™äº›çŸ¥è¯†æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œè¦å¤šåœ¨ä½ ä»¬çš„é¡¹ç›®ä¸­è¿ç”¨ä»–ä»¬ï¼Œè¿™æ ·æ‰èƒ½æ›´åŠ å¥½åœ°ç†è§£ï¼Œå¦‚æœå¤§å®¶åœ¨ä½¿æœ‰çš„è¿‡ç¨‹ä¸­é‡åˆ°ä»€ä¹ˆæ ·çš„é—®é¢˜ï¼Œæ¬¢è¿æ¥è¿™é‡Œé¢ç•™è¨€ï¼Œæˆ‘çœ‹åˆ°äº†ï¼Œä¸€å®šç¬¬ä¸€æ—¶é—´å’Œå¤§å®¶ä¸€èµ·æ¢ç´¢è§£å†³çš„æ–¹æ³•ã€‚\n\n","slug":"æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸ƒï¼‰æµä¸è¿­ä»£å™¨ï¼Œæµç³»åˆ—å¤§ç»“å±€ï¼","published":1,"updated":"2025-10-15T07:20:51.465Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu0779006iqkd45sit7qro","content":"<p>æ­å–œä½ ä»¬ï¼Œé©¬ä¸Šå°±è¦å­¦å®ŒJava8 Streamæµçš„ä¸€æ•´ç³»åˆ—äº†ï¼Œå…¶å®æˆ‘ç›¸ä¿¡Streamæµå¯¹å¾ˆå¤šä½¿ç”¨Javaçš„åŒå­¦æ¥è¯´ï¼Œéƒ½æ˜¯ä¸€ä¸ªçŸ¥è¯†ç›²ç‚¹ï¼Œå› ä¸ºè¿™ä¸ªåŸå› ï¼Œæˆ‘æ‰è¿™ä¹ˆç»†è‡´åœ°è®²è§£Streamæµçš„å„ä¸ªçŸ¥è¯†ç‚¹ï¼Œé€šè¿‡è¿™ä¸€æ•´ä¸ªç³»åˆ—ï¼Œæˆ‘ç›¸ä¿¡åªè¦è®¤çœŸçœ‹äº†çš„åŒå­¦ï¼Œéƒ½å·²æŒæ¡çš„å·®ä¸å¤šäº†ï¼Œå°±å·®å®æˆ˜äº†ã€‚</p>\n<p>å…¶å®æˆ‘åœ¨å·¥ä½œè¿‡ç¨‹ä¸­ï¼ŒStreamæµå¯¹æˆ‘çš„å¸®åŠ©çœŸçš„æŒºå¤§çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘æƒ³å’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹ï¼Œäºæ˜¯è¿™ç³»åˆ—çš„æ–‡ç« å°±å‡ºæ¥äº†ã€‚</p>\n<p>åœ¨æœ¬ç³»åˆ—æ–‡ç« å‘å¸ƒçš„æ—¶å€™ï¼Œæœ‰å¾ˆå¤šåŒå­¦åæ˜ ï¼ŒStreamæµçš„è°ƒè¯•å’ŒforEach()çš„è°ƒè¯•éƒ½ä¸æ˜¯ç‰¹åˆ«å‹å¥½ï¼Œé‚£æœ¬ç¯‡ç»™å‡ºä¸€ä¸ªæŠ˜ä¸­çš„è°ƒè¯•æ–¹æ³•ï¼Œè™½ç„¶ä¸èƒ½å®Œç¾è§£å†³è°ƒè¯•çš„é—®é¢˜ï¼Œä½†æ˜¯åŸºæœ¬ä¸Šå·²ç»èƒ½è§£å†³ç»å¤§éƒ¨åˆ†çš„è°ƒè¯•é—®é¢˜äº†ï¼Œæ²¡é”™ï¼Œå°±æ˜¯è¿­ä»£å™¨äº†ï¼Œå½“ç„¶è¿­ä»£å™¨é™¤äº†èƒ½è¾…åŠ©è°ƒè¯•ä»¥å¤–ï¼Œä»–æœ€é‡è¦çš„è¿˜æ˜¯éå†åŠŸèƒ½ã€‚</p>\n<p>è¿™ç¯‡æ–‡ç« é™¤äº†ä»‹ç»ä¼ ç»Ÿçš„è¿­ä»£å™¨å¤–ï¼Œè¿˜ä¼šä»‹ç»Java8ä¸­æ–°å¢çš„Spliteratorï¼Œå› ä¸ºåœ¨å¹¶è¡Œæµçš„åœºåˆï¼ŒSpliteratorç›¸å½“çš„å¥½ç”¨ã€‚</p>\n<h4 id=\"æˆ‘ä»¬å…ˆç®€å•ä»‹ç»ä¸€ä¸‹ä¼ ç»Ÿçš„è¿­ä»£å™¨\"><a href=\"#æˆ‘ä»¬å…ˆç®€å•ä»‹ç»ä¸€ä¸‹ä¼ ç»Ÿçš„è¿­ä»£å™¨\" class=\"headerlink\" title=\"æˆ‘ä»¬å…ˆç®€å•ä»‹ç»ä¸€ä¸‹ä¼ ç»Ÿçš„è¿­ä»£å™¨\"></a>æˆ‘ä»¬å…ˆç®€å•ä»‹ç»ä¸€ä¸‹ä¼ ç»Ÿçš„è¿­ä»£å™¨</h4><p>è¿­ä»£å™¨æ˜¯å®ç°äº†Iteratoræ¥å£çš„å¯¹è±¡ï¼Œå¹¶ä¸”Iteratoræ¥å£å…è®¸éå†ï¼Œè·å–æˆ–è€…ç§»é™¤å…ƒç´ ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public interface Iterator&lt;E&gt; &#123;\n  Iterator&lt;T&gt; iterator();\n  E next();\n  default void remove() &#123;\n        throw new UnsupportedOperationException(&quot;remove&quot;);\n  &#125;\n  default void forEachRemaining(Consumer&lt;? super E&gt; action) &#123;\n        Objects.requireNonNull(action);\n        while (hasNext())\n            action.accept(next());\n  &#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä½¿ç”¨Iteratorçš„ä¸€èˆ¬æ­¥éª¤ï¼š</p>\n<ul>\n<li><p>(1)é€šè¿‡iterator()æ–¹æ³•ï¼Œè·å–æŒ‡å‘é›†åˆæˆ–æµå¼€å¤´çš„è¿­ä»£å™¨ã€‚</p>\n</li>\n<li><p>(2)å»ºç«‹ä¸€ä¸ªhasNext()æ–¹æ³•è°ƒç”¨å¾ªç¯ï¼Œåªè¦hasNext()è¿”å›true,å°±ç»§ç»­è¿­ä»£ã€‚</p>\n</li>\n<li><p>(3)åœ¨å¾ªç¯ä¸­ï¼Œé€šè¿‡è°ƒç”¨next()æ–¹æ³•è·å–æ¯ä¸ªå…ƒç´ ã€‚</p>\n</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void learnIterator() &#123;\n    List&lt;String&gt; lists &#x3D; Arrays.asList(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;);\n\n    Iterator&lt;String&gt; iterator &#x3D; lists.stream().iterator();\n\n    while (iterator.hasNext()) &#123;\n        System.out.println(iterator.next());\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬ä¸ä¿®æ”¹é›†åˆçš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨forEach()å…¶å®æ›´åŠ ä¾¿åˆ©çš„ï¼Œå…¶å®ä¸¤ç§æ–¹å¼æœ¬è´¨ä¸Šé¢æ˜¯ä¸€æ ·çš„ï¼Œåœ¨ä½ ç¼–è¯‘ä¹‹åï¼ŒforEach()ä¼šè½¬æ¢æˆè¿­ä»£å™¨çš„æ–¹å¼è¿›è¡Œæ“ä½œäº†ã€‚æœ‰äº†è¿­ä»£å™¨ï¼Œç›¸ä¿¡è°ƒè¯•å°±å¾—æ–¹ä¾¿èµ·æ¥äº†ï¼Œå³ä½¿ä¸èƒ½ç›´æ¥è°ƒè¯•ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è¿­ä»£å™¨ï¼Œåæ¨ä¹‹å‰ï¼Œå¯èƒ½å‘ç”Ÿäº†ä»€ä¹ˆã€‚</p>\n<p>å€¼å¾—æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼šJava8ç»™åŸºæœ¬ç±»å‹çš„æµæä¾›äº†é¢å¤–çš„è¿­ä»£å™¨ï¼šPrimitiveIterator.OfInt,PrimitiveIterator.OfDouble,PrimitiveIterator.OfLong,PrimitiveIterator,ä½†è¿™äº›æ¥å£éƒ½æ˜¯æ¥æ‰©å±•è‡ªIteratoræ¥å£çš„ï¼Œæ‰€ä»¥ä½¿ç”¨ä¸Šé¢ä¹Ÿæ˜¯ç›¸åŒçš„ã€‚</p>\n<h4 id=\"Spliterator\"><a href=\"#Spliterator\" class=\"headerlink\" title=\"Spliterator\"></a>Spliterator</h4><p>Spliteratoræ˜¯Java8æ–°å¢çš„ä¸€ç§è¿­ä»£å™¨ï¼Œè¿™ç§è¿­ä»£å™¨ç”±<code>Spliterator</code>æ¥å£å®šä¹‰ï¼ŒSpliteratorä¹Ÿæœ‰æ™®é€šçš„éå†å…ƒç´ åŠŸèƒ½ï¼Œè¿™ä¸€ç‚¹ä¸åˆšæ‰è¯´çš„è¿­ä»£å™¨ç±»ä¼¼çš„ï¼Œä½†æ˜¯ï¼Œä½†æ˜¯Spliteratoræ–¹æ³•å’Œä½¿ç”¨è¿­ä»£å™¨çš„æ–¹æ³•æ˜¯ä¸åŒçš„ã€‚</p>\n<p>å¦å¤–ï¼Œå®ƒæä¾›çš„åŠŸèƒ½è¦æ¯”Iteratorå¤šã€‚æœ€ç»ˆè¦çš„ä¸€ç‚¹ï¼ŒSpliteratoræ”¯æŒå¹¶è¡Œè¿­ä»£ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public interface Spliterator&lt;T&gt; &#123;\n    boolean tryAdvance(Consumer&lt;? super T&gt; action);\n    int characteristics();\n    long estimateSize();\n   Spliterator&lt;T&gt; trySplit();\n   default void forEachRemaining(Consumer&lt;? super T&gt; action) &#123;\n        do &#123; &#125; while (tryAdvance(action));\n   &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å°†Spliteratorç”¨äºåŸºæœ¬è¿­ä»£ä»»åŠ¡æ˜¯éå¸¸ç®€å•çš„ï¼Œåªéœ€è¦è°ƒç”¨tryAdvance()æ–¹æ³•ï¼Œç›´è‡³å…¶è¿”å›false.å¦‚æœè¦ä¸ºåºåˆ—ä¸­çš„æ¯ä¸ªå…ƒç´ åº”ç”¨ç›¸åŒçš„åŠ¨ä½œï¼Œé‚£ä¹ˆforEachRemaining()æä¾›äº†ä¸€ç§æ›´åŠ é«˜æ•ˆçš„æ›¿ä»£æ–¹æ³•ã€‚</p>\n<p>å¯¹äºè¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œåœ¨æ¯æ¬¡è¿­ä»£ä¸­å°†å‘ç”Ÿçš„åŠ¨ä½œéƒ½ç”±<code>Consumer</code>å¯¹è±¡å®šä¹‰çš„æ“ä½œæ¥å†³å®šï¼Œ<code>Consumer</code>ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œä¼°è®¡å¤§å®¶å·²ç»çŸ¥é“æ€ä¹ˆåˆ†æäº†ï¼Œè¿™é‡Œå°±ä¸å¸¦å¤§å®¶åˆ†æäº†ï¼Œä»–çš„åŠ¨ä½œæ˜¯æŒ‡å®šäº†åœ¨è¿­ä»£ä¸­ä¸‹ä¸€ä¸ªå…ƒç´ ä¸Šæ‰§è¡Œçš„æ“ä½œã€‚ä¸‹é¢æ¥ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void learnIterator() &#123;\n    List&lt;String&gt; lists &#x3D; Arrays.asList(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;);\n\n    Spliterator&lt;String&gt; spliterator &#x3D; lists.stream().spliterator();\n\n    while (spliterator.tryAdvance(System.out::println));\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä½¿ç”¨forEachRemaining()æ–¹æ³•æ”¹è¿›è¿™ä¸ªä¾‹å­ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void learnIterator() &#123;\n    List&lt;String&gt; lists &#x3D; Arrays.asList(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;);\n    lists.stream().spliterator().forEachRemaining(System.out::println);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ³¨æ„ï¼Œä½¿ç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œä¸éœ€è¦æä¾›ä¸€ä¸ªå¾ªç¯æ¥ä¸€æ¬¡å¤„ç†ä¸€ä¸ªå…ƒç´ ï¼Œè€Œæ˜¯å°†å„ä¸ªå…ƒç´ ä½œä¸ºä¸€ä¸ªæ•´ä½“æ¥å¯¹å¾…ï¼Œè¿™æ˜¯Spliteratorçš„åˆä¸€ä¸ªä¼˜åŠ¿ã€‚</p>\n<p>Spliteratorçš„å¦ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„æ–¹æ³•æ˜¯trySplit()ï¼Œå®ƒå°†è¢«è¿­ä»£çš„å…ƒç´ åˆ’åˆ†æˆäº†ä¸¤éƒ¨åˆ†ï¼Œè¿”å›å…¶ä¸­ä¸€éƒ¨åˆ†çš„æ–°Spliterator,å¦ä¸€éƒ¨åˆ†åˆ™é€šè¿‡åŸæ¥çš„Spliteratorè®¿é—®ã€‚ä¸‹é¢å†ç»™ä¸€ä¸ªç®€å•çš„ä¾‹å­</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void learnIterator() &#123;\n    List&lt;String&gt; lists &#x3D; Arrays.asList(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;);\n\n    Spliterator&lt;String&gt; spliterator &#x3D; lists.stream().spliterator();\n\n    Spliterator&lt;String&gt; stringSpliterator &#x3D; spliterator.trySplit();\n\n    if (stringSpliterator !&#x3D; null) stringSpliterator.forEachRemaining(System.out::println);\n\n    System.out.println(&quot;------------------&quot;);\n\n    spliterator.forEachRemaining(System.out::println);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ‰“å°çš„ç»“æœï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">A\nB\n------------------\nC\nD<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™é‡Œåªæ˜¯ç»™å¤§å®¶æä¾›äº†è¿™ç§æ–¹å¼è€Œå·²ï¼Œä¾‹å­æœ¬èº«æ²¡æœ‰ä»€ä¹ˆå«ä¹‰ï¼Œä½†æ˜¯å½“ä½ å¯¹å¤§æ•°æ®é›†æ‰§è¡Œå¹¶è¡Œå¤„ç†æ—¶ï¼Œæ‹†åˆ†å¯èƒ½æ˜¯ææœ‰å¸®åŠ©çš„äº†ã€‚ä½†æ›´å¤šæƒ…å†µä¸‹ï¼Œè¦å¯¹æµæ‰§è¡Œå¹¶è¡Œæ“ä½œæ—¶ï¼Œä½¿ç”¨å…¶ä»–æŸä¸ªStreamæ–¹æ³•æ›´å¥½ï¼Œè€Œä¸å¿…æ‰‹åŠ¨å¤„ç†Spliteratorçš„è¿™äº›ç»†èŠ‚ï¼ŒSpliteratoræœ€é€‚åˆçš„åœºæ™¯æ˜¯ï¼Œç»™å®šçš„æ‰€æœ‰æ–¹æ³•éƒ½ä¸èƒ½æ»¡è¶³ä½ çš„è¦æ±‚æ—¶ï¼Œæ‰è€ƒè™‘ã€‚</p>\n<h4 id=\"æœ€åæ¥ä¸€ä¸ªæ€»ç»“\"><a href=\"#æœ€åæ¥ä¸€ä¸ªæ€»ç»“\" class=\"headerlink\" title=\"æœ€åæ¥ä¸€ä¸ªæ€»ç»“\"></a>æœ€åæ¥ä¸€ä¸ªæ€»ç»“</h4><p>åˆ°è¿™é‡Œï¼ŒJava8 Streamæµçš„çŸ¥è¯†ï¼ŒåŸºæœ¬ä¸Šå·²ç»ä»‹ç»å®Œäº†ï¼Œç¼©å‡æ“ä½œï¼Œå¹¶è¡Œæµï¼Œæ˜ å°„ï¼Œè¿˜æœ‰æ”¶é›†æ˜¯Streamæµçš„æ ¸å¿ƒå†…å®¹ï¼Œä½†æ˜¯è¦æƒ³æŒæ¡å¥½è¿™äº›å†…å®¹ï¼Œç¬¬äºŒç¯‡çš„åŸºæœ¬çŸ¥è¯†ä½ æ˜¯è·‘ä¸æ‰çš„ï¼Œå› æ­¤æˆ‘çš„å»ºè®®è¿˜æ˜¯è€è€å®å®ï¼Œä»ç¬¬ä¸€ç¯‡å¼€å§‹è®¤çœŸçœ‹ï¼Œçœ‹å®Œè¿™7ç¯‡æ–‡ç« ï¼Œä½ åŸºæœ¬å·²ç»éå¸¸ç³»ç»Ÿåœ°æŒæ¡Java8çš„StreamæµçŸ¥è¯†äº†ã€‚</p>\n<p>å¤§å®¶ä¹Ÿä¸è¦å¿˜è®°<code>Collectors</code>ç±»ï¼Œé‡Œé¢æä¾›ç»™æˆ‘ä»¬çš„æ–¹æ³•ï¼ŒåŸºæœ¬ä¸Šèƒ½å¤„ç†å„ç§å„æ ·çš„æ”¶é›†å…ƒç´ é—®é¢˜äº†ï¼Œå¦‚æœä½ ä»ç¬¬ä¸€ç¯‡æ–‡ç« å¼€å§‹çœ‹ï¼Œä¸€ç›´çœ‹åˆ°è¿™é‡Œäº†ï¼Œé‚£ä½ ä»¥åå°½é‡å¤šä½¿ç”¨Streamæµæ¥å¤„ç†é›†åˆå§ï¼Œåªæ˜¯å­¦ä¼šè¿™äº›çŸ¥è¯†æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œè¦å¤šåœ¨ä½ ä»¬çš„é¡¹ç›®ä¸­è¿ç”¨ä»–ä»¬ï¼Œè¿™æ ·æ‰èƒ½æ›´åŠ å¥½åœ°ç†è§£ï¼Œå¦‚æœå¤§å®¶åœ¨ä½¿æœ‰çš„è¿‡ç¨‹ä¸­é‡åˆ°ä»€ä¹ˆæ ·çš„é—®é¢˜ï¼Œæ¬¢è¿æ¥è¿™é‡Œé¢ç•™è¨€ï¼Œæˆ‘çœ‹åˆ°äº†ï¼Œä¸€å®šç¬¬ä¸€æ—¶é—´å’Œå¤§å®¶ä¸€èµ·æ¢ç´¢è§£å†³çš„æ–¹æ³•ã€‚</p>\n","excerpt":"","more":"<p>æ­å–œä½ ä»¬ï¼Œé©¬ä¸Šå°±è¦å­¦å®ŒJava8 Streamæµçš„ä¸€æ•´ç³»åˆ—äº†ï¼Œå…¶å®æˆ‘ç›¸ä¿¡Streamæµå¯¹å¾ˆå¤šä½¿ç”¨Javaçš„åŒå­¦æ¥è¯´ï¼Œéƒ½æ˜¯ä¸€ä¸ªçŸ¥è¯†ç›²ç‚¹ï¼Œå› ä¸ºè¿™ä¸ªåŸå› ï¼Œæˆ‘æ‰è¿™ä¹ˆç»†è‡´åœ°è®²è§£Streamæµçš„å„ä¸ªçŸ¥è¯†ç‚¹ï¼Œé€šè¿‡è¿™ä¸€æ•´ä¸ªç³»åˆ—ï¼Œæˆ‘ç›¸ä¿¡åªè¦è®¤çœŸçœ‹äº†çš„åŒå­¦ï¼Œéƒ½å·²æŒæ¡çš„å·®ä¸å¤šäº†ï¼Œå°±å·®å®æˆ˜äº†ã€‚</p>\n<p>å…¶å®æˆ‘åœ¨å·¥ä½œè¿‡ç¨‹ä¸­ï¼ŒStreamæµå¯¹æˆ‘çš„å¸®åŠ©çœŸçš„æŒºå¤§çš„ï¼Œæ‰€ä»¥ï¼Œæˆ‘æƒ³å’Œå¤§å®¶åˆ†äº«ä¸€ä¸‹ï¼Œäºæ˜¯è¿™ç³»åˆ—çš„æ–‡ç« å°±å‡ºæ¥äº†ã€‚</p>\n<p>åœ¨æœ¬ç³»åˆ—æ–‡ç« å‘å¸ƒçš„æ—¶å€™ï¼Œæœ‰å¾ˆå¤šåŒå­¦åæ˜ ï¼ŒStreamæµçš„è°ƒè¯•å’ŒforEach()çš„è°ƒè¯•éƒ½ä¸æ˜¯ç‰¹åˆ«å‹å¥½ï¼Œé‚£æœ¬ç¯‡ç»™å‡ºä¸€ä¸ªæŠ˜ä¸­çš„è°ƒè¯•æ–¹æ³•ï¼Œè™½ç„¶ä¸èƒ½å®Œç¾è§£å†³è°ƒè¯•çš„é—®é¢˜ï¼Œä½†æ˜¯åŸºæœ¬ä¸Šå·²ç»èƒ½è§£å†³ç»å¤§éƒ¨åˆ†çš„è°ƒè¯•é—®é¢˜äº†ï¼Œæ²¡é”™ï¼Œå°±æ˜¯è¿­ä»£å™¨äº†ï¼Œå½“ç„¶è¿­ä»£å™¨é™¤äº†èƒ½è¾…åŠ©è°ƒè¯•ä»¥å¤–ï¼Œä»–æœ€é‡è¦çš„è¿˜æ˜¯éå†åŠŸèƒ½ã€‚</p>\n<p>è¿™ç¯‡æ–‡ç« é™¤äº†ä»‹ç»ä¼ ç»Ÿçš„è¿­ä»£å™¨å¤–ï¼Œè¿˜ä¼šä»‹ç»Java8ä¸­æ–°å¢çš„Spliteratorï¼Œå› ä¸ºåœ¨å¹¶è¡Œæµçš„åœºåˆï¼ŒSpliteratorç›¸å½“çš„å¥½ç”¨ã€‚</p>\n<h4 id=\"æˆ‘ä»¬å…ˆç®€å•ä»‹ç»ä¸€ä¸‹ä¼ ç»Ÿçš„è¿­ä»£å™¨\"><a href=\"#æˆ‘ä»¬å…ˆç®€å•ä»‹ç»ä¸€ä¸‹ä¼ ç»Ÿçš„è¿­ä»£å™¨\" class=\"headerlink\" title=\"æˆ‘ä»¬å…ˆç®€å•ä»‹ç»ä¸€ä¸‹ä¼ ç»Ÿçš„è¿­ä»£å™¨\"></a>æˆ‘ä»¬å…ˆç®€å•ä»‹ç»ä¸€ä¸‹ä¼ ç»Ÿçš„è¿­ä»£å™¨</h4><p>è¿­ä»£å™¨æ˜¯å®ç°äº†Iteratoræ¥å£çš„å¯¹è±¡ï¼Œå¹¶ä¸”Iteratoræ¥å£å…è®¸éå†ï¼Œè·å–æˆ–è€…ç§»é™¤å…ƒç´ ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public interface Iterator&lt;E&gt; &#123;\n  Iterator&lt;T&gt; iterator();\n  E next();\n  default void remove() &#123;\n        throw new UnsupportedOperationException(&quot;remove&quot;);\n  &#125;\n  default void forEachRemaining(Consumer&lt;? super E&gt; action) &#123;\n        Objects.requireNonNull(action);\n        while (hasNext())\n            action.accept(next());\n  &#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä½¿ç”¨Iteratorçš„ä¸€èˆ¬æ­¥éª¤ï¼š</p>\n<ul>\n<li><p>(1)é€šè¿‡iterator()æ–¹æ³•ï¼Œè·å–æŒ‡å‘é›†åˆæˆ–æµå¼€å¤´çš„è¿­ä»£å™¨ã€‚</p>\n</li>\n<li><p>(2)å»ºç«‹ä¸€ä¸ªhasNext()æ–¹æ³•è°ƒç”¨å¾ªç¯ï¼Œåªè¦hasNext()è¿”å›true,å°±ç»§ç»­è¿­ä»£ã€‚</p>\n</li>\n<li><p>(3)åœ¨å¾ªç¯ä¸­ï¼Œé€šè¿‡è°ƒç”¨next()æ–¹æ³•è·å–æ¯ä¸ªå…ƒç´ ã€‚</p>\n</li>\n</ul>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void learnIterator() &#123;\n    List&lt;String&gt; lists &#x3D; Arrays.asList(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;);\n\n    Iterator&lt;String&gt; iterator &#x3D; lists.stream().iterator();\n\n    while (iterator.hasNext()) &#123;\n        System.out.println(iterator.next());\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬ä¸ä¿®æ”¹é›†åˆçš„æƒ…å†µä¸‹ï¼Œä½¿ç”¨forEach()å…¶å®æ›´åŠ ä¾¿åˆ©çš„ï¼Œå…¶å®ä¸¤ç§æ–¹å¼æœ¬è´¨ä¸Šé¢æ˜¯ä¸€æ ·çš„ï¼Œåœ¨ä½ ç¼–è¯‘ä¹‹åï¼ŒforEach()ä¼šè½¬æ¢æˆè¿­ä»£å™¨çš„æ–¹å¼è¿›è¡Œæ“ä½œäº†ã€‚æœ‰äº†è¿­ä»£å™¨ï¼Œç›¸ä¿¡è°ƒè¯•å°±å¾—æ–¹ä¾¿èµ·æ¥äº†ï¼Œå³ä½¿ä¸èƒ½ç›´æ¥è°ƒè¯•ï¼Œä¹Ÿå¯ä»¥é€šè¿‡è¿­ä»£å™¨ï¼Œåæ¨ä¹‹å‰ï¼Œå¯èƒ½å‘ç”Ÿäº†ä»€ä¹ˆã€‚</p>\n<p>å€¼å¾—æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼šJava8ç»™åŸºæœ¬ç±»å‹çš„æµæä¾›äº†é¢å¤–çš„è¿­ä»£å™¨ï¼šPrimitiveIterator.OfInt,PrimitiveIterator.OfDouble,PrimitiveIterator.OfLong,PrimitiveIterator,ä½†è¿™äº›æ¥å£éƒ½æ˜¯æ¥æ‰©å±•è‡ªIteratoræ¥å£çš„ï¼Œæ‰€ä»¥ä½¿ç”¨ä¸Šé¢ä¹Ÿæ˜¯ç›¸åŒçš„ã€‚</p>\n<h4 id=\"Spliterator\"><a href=\"#Spliterator\" class=\"headerlink\" title=\"Spliterator\"></a>Spliterator</h4><p>Spliteratoræ˜¯Java8æ–°å¢çš„ä¸€ç§è¿­ä»£å™¨ï¼Œè¿™ç§è¿­ä»£å™¨ç”±<code>Spliterator</code>æ¥å£å®šä¹‰ï¼ŒSpliteratorä¹Ÿæœ‰æ™®é€šçš„éå†å…ƒç´ åŠŸèƒ½ï¼Œè¿™ä¸€ç‚¹ä¸åˆšæ‰è¯´çš„è¿­ä»£å™¨ç±»ä¼¼çš„ï¼Œä½†æ˜¯ï¼Œä½†æ˜¯Spliteratoræ–¹æ³•å’Œä½¿ç”¨è¿­ä»£å™¨çš„æ–¹æ³•æ˜¯ä¸åŒçš„ã€‚</p>\n<p>å¦å¤–ï¼Œå®ƒæä¾›çš„åŠŸèƒ½è¦æ¯”Iteratorå¤šã€‚æœ€ç»ˆè¦çš„ä¸€ç‚¹ï¼ŒSpliteratoræ”¯æŒå¹¶è¡Œè¿­ä»£ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public interface Spliterator&lt;T&gt; &#123;\n    boolean tryAdvance(Consumer&lt;? super T&gt; action);\n    int characteristics();\n    long estimateSize();\n   Spliterator&lt;T&gt; trySplit();\n   default void forEachRemaining(Consumer&lt;? super T&gt; action) &#123;\n        do &#123; &#125; while (tryAdvance(action));\n   &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å°†Spliteratorç”¨äºåŸºæœ¬è¿­ä»£ä»»åŠ¡æ˜¯éå¸¸ç®€å•çš„ï¼Œåªéœ€è¦è°ƒç”¨tryAdvance()æ–¹æ³•ï¼Œç›´è‡³å…¶è¿”å›false.å¦‚æœè¦ä¸ºåºåˆ—ä¸­çš„æ¯ä¸ªå…ƒç´ åº”ç”¨ç›¸åŒçš„åŠ¨ä½œï¼Œé‚£ä¹ˆforEachRemaining()æä¾›äº†ä¸€ç§æ›´åŠ é«˜æ•ˆçš„æ›¿ä»£æ–¹æ³•ã€‚</p>\n<p>å¯¹äºè¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œåœ¨æ¯æ¬¡è¿­ä»£ä¸­å°†å‘ç”Ÿçš„åŠ¨ä½œéƒ½ç”±<code>Consumer</code>å¯¹è±¡å®šä¹‰çš„æ“ä½œæ¥å†³å®šï¼Œ<code>Consumer</code>ä¹Ÿæ˜¯ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œä¼°è®¡å¤§å®¶å·²ç»çŸ¥é“æ€ä¹ˆåˆ†æäº†ï¼Œè¿™é‡Œå°±ä¸å¸¦å¤§å®¶åˆ†æäº†ï¼Œä»–çš„åŠ¨ä½œæ˜¯æŒ‡å®šäº†åœ¨è¿­ä»£ä¸­ä¸‹ä¸€ä¸ªå…ƒç´ ä¸Šæ‰§è¡Œçš„æ“ä½œã€‚ä¸‹é¢æ¥ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void learnIterator() &#123;\n    List&lt;String&gt; lists &#x3D; Arrays.asList(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;);\n\n    Spliterator&lt;String&gt; spliterator &#x3D; lists.stream().spliterator();\n\n    while (spliterator.tryAdvance(System.out::println));\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä½¿ç”¨forEachRemaining()æ–¹æ³•æ”¹è¿›è¿™ä¸ªä¾‹å­ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void learnIterator() &#123;\n    List&lt;String&gt; lists &#x3D; Arrays.asList(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;);\n    lists.stream().spliterator().forEachRemaining(System.out::println);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ³¨æ„ï¼Œä½¿ç”¨è¿™ä¸ªæ–¹æ³•æ—¶ï¼Œä¸éœ€è¦æä¾›ä¸€ä¸ªå¾ªç¯æ¥ä¸€æ¬¡å¤„ç†ä¸€ä¸ªå…ƒç´ ï¼Œè€Œæ˜¯å°†å„ä¸ªå…ƒç´ ä½œä¸ºä¸€ä¸ªæ•´ä½“æ¥å¯¹å¾…ï¼Œè¿™æ˜¯Spliteratorçš„åˆä¸€ä¸ªä¼˜åŠ¿ã€‚</p>\n<p>Spliteratorçš„å¦ä¸€ä¸ªå€¼å¾—æ³¨æ„çš„æ–¹æ³•æ˜¯trySplit()ï¼Œå®ƒå°†è¢«è¿­ä»£çš„å…ƒç´ åˆ’åˆ†æˆäº†ä¸¤éƒ¨åˆ†ï¼Œè¿”å›å…¶ä¸­ä¸€éƒ¨åˆ†çš„æ–°Spliterator,å¦ä¸€éƒ¨åˆ†åˆ™é€šè¿‡åŸæ¥çš„Spliteratorè®¿é—®ã€‚ä¸‹é¢å†ç»™ä¸€ä¸ªç®€å•çš„ä¾‹å­</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void learnIterator() &#123;\n    List&lt;String&gt; lists &#x3D; Arrays.asList(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;);\n\n    Spliterator&lt;String&gt; spliterator &#x3D; lists.stream().spliterator();\n\n    Spliterator&lt;String&gt; stringSpliterator &#x3D; spliterator.trySplit();\n\n    if (stringSpliterator !&#x3D; null) stringSpliterator.forEachRemaining(System.out::println);\n\n    System.out.println(&quot;------------------&quot;);\n\n    spliterator.forEachRemaining(System.out::println);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ‰“å°çš„ç»“æœï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">A\nB\n------------------\nC\nD<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™é‡Œåªæ˜¯ç»™å¤§å®¶æä¾›äº†è¿™ç§æ–¹å¼è€Œå·²ï¼Œä¾‹å­æœ¬èº«æ²¡æœ‰ä»€ä¹ˆå«ä¹‰ï¼Œä½†æ˜¯å½“ä½ å¯¹å¤§æ•°æ®é›†æ‰§è¡Œå¹¶è¡Œå¤„ç†æ—¶ï¼Œæ‹†åˆ†å¯èƒ½æ˜¯ææœ‰å¸®åŠ©çš„äº†ã€‚ä½†æ›´å¤šæƒ…å†µä¸‹ï¼Œè¦å¯¹æµæ‰§è¡Œå¹¶è¡Œæ“ä½œæ—¶ï¼Œä½¿ç”¨å…¶ä»–æŸä¸ªStreamæ–¹æ³•æ›´å¥½ï¼Œè€Œä¸å¿…æ‰‹åŠ¨å¤„ç†Spliteratorçš„è¿™äº›ç»†èŠ‚ï¼ŒSpliteratoræœ€é€‚åˆçš„åœºæ™¯æ˜¯ï¼Œç»™å®šçš„æ‰€æœ‰æ–¹æ³•éƒ½ä¸èƒ½æ»¡è¶³ä½ çš„è¦æ±‚æ—¶ï¼Œæ‰è€ƒè™‘ã€‚</p>\n<h4 id=\"æœ€åæ¥ä¸€ä¸ªæ€»ç»“\"><a href=\"#æœ€åæ¥ä¸€ä¸ªæ€»ç»“\" class=\"headerlink\" title=\"æœ€åæ¥ä¸€ä¸ªæ€»ç»“\"></a>æœ€åæ¥ä¸€ä¸ªæ€»ç»“</h4><p>åˆ°è¿™é‡Œï¼ŒJava8 Streamæµçš„çŸ¥è¯†ï¼ŒåŸºæœ¬ä¸Šå·²ç»ä»‹ç»å®Œäº†ï¼Œç¼©å‡æ“ä½œï¼Œå¹¶è¡Œæµï¼Œæ˜ å°„ï¼Œè¿˜æœ‰æ”¶é›†æ˜¯Streamæµçš„æ ¸å¿ƒå†…å®¹ï¼Œä½†æ˜¯è¦æƒ³æŒæ¡å¥½è¿™äº›å†…å®¹ï¼Œç¬¬äºŒç¯‡çš„åŸºæœ¬çŸ¥è¯†ä½ æ˜¯è·‘ä¸æ‰çš„ï¼Œå› æ­¤æˆ‘çš„å»ºè®®è¿˜æ˜¯è€è€å®å®ï¼Œä»ç¬¬ä¸€ç¯‡å¼€å§‹è®¤çœŸçœ‹ï¼Œçœ‹å®Œè¿™7ç¯‡æ–‡ç« ï¼Œä½ åŸºæœ¬å·²ç»éå¸¸ç³»ç»Ÿåœ°æŒæ¡Java8çš„StreamæµçŸ¥è¯†äº†ã€‚</p>\n<p>å¤§å®¶ä¹Ÿä¸è¦å¿˜è®°<code>Collectors</code>ç±»ï¼Œé‡Œé¢æä¾›ç»™æˆ‘ä»¬çš„æ–¹æ³•ï¼ŒåŸºæœ¬ä¸Šèƒ½å¤„ç†å„ç§å„æ ·çš„æ”¶é›†å…ƒç´ é—®é¢˜äº†ï¼Œå¦‚æœä½ ä»ç¬¬ä¸€ç¯‡æ–‡ç« å¼€å§‹çœ‹ï¼Œä¸€ç›´çœ‹åˆ°è¿™é‡Œäº†ï¼Œé‚£ä½ ä»¥åå°½é‡å¤šä½¿ç”¨Streamæµæ¥å¤„ç†é›†åˆå§ï¼Œåªæ˜¯å­¦ä¼šè¿™äº›çŸ¥è¯†æ˜¯æ²¡æœ‰ç”¨çš„ï¼Œè¦å¤šåœ¨ä½ ä»¬çš„é¡¹ç›®ä¸­è¿ç”¨ä»–ä»¬ï¼Œè¿™æ ·æ‰èƒ½æ›´åŠ å¥½åœ°ç†è§£ï¼Œå¦‚æœå¤§å®¶åœ¨ä½¿æœ‰çš„è¿‡ç¨‹ä¸­é‡åˆ°ä»€ä¹ˆæ ·çš„é—®é¢˜ï¼Œæ¬¢è¿æ¥è¿™é‡Œé¢ç•™è¨€ï¼Œæˆ‘çœ‹åˆ°äº†ï¼Œä¸€å®šç¬¬ä¸€æ—¶é—´å’Œå¤§å®¶ä¸€èµ·æ¢ç´¢è§£å†³çš„æ–¹æ³•ã€‚</p>\n"},{"title":"Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸€ï¼‰åŸºç¡€ä½“éªŒ","date":"2025-10-15T03:36:33.000Z","_content":"#### ä»€ä¹ˆæ˜¯æµAPI? å®ƒèƒ½åšä¸€äº›ä»€ä¹ˆ?\n\næˆ‘ä»¬åº”è¯¥çŸ¥é“(ç»å¯¹çŸ¥é“~)APIæ˜¯ä¸€ä¸ªç¨‹åºå‘ä½¿ç”¨è€…æä¾›çš„ä¸€äº›æ–¹æ³•ï¼Œé€šè¿‡è¿™äº›æ–¹æ³•å°±èƒ½å®ç°æŸäº›åŠŸèƒ½ã€‚æ‰€ä»¥å¯¹äºæµAPIæ¥è¯´ï¼Œé‡ç‚¹æ˜¯æ€ä¹ˆç†è§£\"æµ\"è¿™ä¸ªæ¦‚å¿µï¼Œæ‰€è°“çš„æµ:å°±æ˜¯æ•°æ®çš„æ¸ é“ï¼Œæ‰€ä»¥ï¼Œæµä»£è¡¨çš„æ˜¯ä¸€ä¸ªå¯¹è±¡çš„åºåˆ—å®ƒå’ŒJava I/Oç±»é‡Œä½¿ç”¨çš„\"æµ\"ä¸åŒã€‚è™½ç„¶åœ¨æ¦‚å¿µä¸Šä¸java.util.streamä¸­å®šä¹‰çš„æµæ˜¯ç±»ä¼¼çš„ï¼Œä½†å®ƒä»¬æ˜¯ä¸åŒçš„ï¼ŒæµAPIä¸­çš„æµæ˜¯æè¿°æŸä¸ªæµç±»å‹çš„å¯¹è±¡ã€‚\n\næµAPIä¸­çš„æµæ“ä½œçš„æ•°æ®æºï¼Œæ˜¯æ•°ç»„æˆ–è€…æ˜¯é›†åˆã€‚å®ƒæœ¬èº«æ˜¯ä¸å­˜å‚¨æ•°æ®çš„ï¼Œåªæ˜¯ç§»åŠ¨æ•°æ®ï¼Œåœ¨ç§»åŠ¨è¿‡ç¨‹ä¸­å¯èƒ½ä¼šå¯¹æ•°æ®è¿›è¡Œè¿‡æ»¤ï¼Œæ’åºæˆ–è€…å…¶å®ƒæ“ä½œï¼Œä½†æ˜¯ï¼Œä¸€èˆ¬æƒ…å†µä¸‹(ç»å¤§æ•°æƒ…å†µä¸‹)ï¼Œæµæ“ä½œæœ¬èº«ä¸ä¼šä¿®æ”¹æ•°æ®æºï¼Œæ¯”å¦‚ï¼Œå¯¹æµæ’åºä¸ä¼šä¿®æ”¹æ•°æ®æºçš„é¡ºåºã€‚ç›¸åï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æµï¼Œå…¶ä¸­åŒ…å«æ’åºåçš„ç»“æœã€‚\n\n#### ä»ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä½“éªŒæµAPIçš„å¼ºå¤§ä¸ä¼˜é›…\n  \nè¿™ä¸ªç®€å•çš„Demoï¼Œä¸»è¦æ˜¯å¯¹ä¸€ä¸ªç”±1-6ä¹±åºç»„æˆçš„Listå¯¹åº”çš„æµè¿›è¡Œæ“ä½œï¼Œç„¶åé€šè¿‡è¿™ä¸ªæµï¼Œå°±å¯ä»¥è·å–åˆ°åˆ—è¡¨é‡Œé¢æœ€å¤§æœ€å°å€¼ã€æ’åºã€è¿‡æ»¤æŸäº›å…ƒç´ ç­‰ç­‰çš„æ“ä½œã€‚å¹¶ä¸”è¿™æ­¤æ“ä½œä¸ä¼šæ”¹å˜åŸListé‡Œé¢çš„æ•°æ®ã€‚Demoé‡Œé¢éœ€è¦æ³¨æ„çš„åœ°æ–¹å°±æ˜¯æµAPIé‡Œé¢çš„\"ç»ˆç«¯æ“ä½œ\"å’Œ\"ä¸­é—´æ“ä½œ\"çš„åŒºåˆ«:å…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œç»ˆç«¯æ“ä½œä¼šæ¶ˆè´¹æµï¼Œä¸€ä¸ªè¢«æ¶ˆè´¹è¿‡çš„æµæ˜¯ä¸èƒ½è¢«å†æ¬¡åˆ©ç”¨çš„ï¼Œä½†æˆ‘ä»¬åœ¨å®é™…åº”ç”¨çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šå—åˆ°å¤ªå¤§çš„å½±å“(Ps:å¦‚æœä½ ä»¬èƒ½åŠ¨æ‰‹å®è·µä¸€ä¸‹æˆ‘ç›¸ä¿¡ä½ ä½“éªŒæ›´å¥½ï¼Œå¼ºçƒˆæ¨èï¼)\n\n```\npublic class Main {\n\n\n    public static void main(String[] args) { \n        learnStream();\n    }\n\n    private static void learnStream() {\n        //é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ª1-6ä¹±åºçš„List\n        List<Integer> lists = new ArrayList<>();\n        lists.add(4);\n        lists.add(3);\n        lists.add(6);\n        lists.add(1);\n        lists.add(5);\n        lists.add(2);\n\n        //çœ‹çœ‹Listé‡Œé¢çš„æ•°æ®æ˜¯ä»€ä¹ˆæ ·å­çš„å…ˆ\n        System.out.print(\"Listé‡Œé¢çš„æ•°æ®:\");\n        for (Integer elem : lists) System.out.print(elem + \" \");// 4 3 6 1 5 2\n\n        System.out.println();\n\n        //æœ€å°å€¼\n        System.out.print(\"Listä¸­æœ€å°çš„å€¼ä¸º:\");\n        Stream<Integer> stream = lists.stream();\n        Optional<Integer> min = stream.min(Integer::compareTo);\n        if (min.isPresent()) {\n            System.out.println(min.get());//1\n        }\n\n\n        //æœ€å¤§å€¼\n        System.out.print(\"Listä¸­æœ€å¤§çš„å€¼ä¸º:\");\n        lists.stream().max(Integer::compareTo).ifPresent(System.out::println);//6\n\n        //æ’åº\n        System.out.print(\"å°†Listæµè¿›è¡Œæ’åº:\");\n        Stream<Integer> sorted = lists.stream().sorted();\n        sorted.forEach(elem -> System.out.print(elem + \" \"));// 1 2 3 4 5 6\n\n        System.out.println();\n\n        //è¿‡æ»¤\n        System.out.print(\"è¿‡æ»¤Listæµï¼Œåªå‰©ä¸‹é‚£äº›å¤§äº3çš„å…ƒç´ :\");\n        lists.stream()\n                .filter(elem -> elem > 3)\n                .forEach(elem -> System.out.print(elem + \" \"));// 4 5 6\n\n        System.out.println();\n\n        //è¿‡æ»¤\n        System.out.println(\"è¿‡æ»¤Listæµï¼Œåªå‰©ä¸‹é‚£äº›å¤§äº0å¹¶ä¸”å°äº4çš„å…ƒç´ :\\n=====begin=====\");\n        lists.stream()\n                .filter(elem -> elem > 0)\n                .filter(elem -> elem < 4)\n                .sorted(Integer::compareTo)\n                .forEach(System.out::println);// 1 2 3\n\n        System.out.println(\"=====end=====\");\n        //ç»è¿‡äº†å‰é¢çš„è¿™ä¹ˆå¤šæµæ“ä½œï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹Listé‡Œé¢çš„å€¼æœ‰æ²¡æœ‰å‘ç”Ÿä»€ä¹ˆæ”¹å˜\n        System.out.print(\"åŸListé‡Œé¢çš„æ•°æ®:\");\n        for (Integer elem : lists) System.out.print(elem + \" \");// 4 3 6 1 5 2\n    }\n}\n```\n\nå¦‚æœåˆšæ‰çš„Demoä½ è®¤çœŸè¯»äº†ï¼Œæˆ‘ç›¸ä¿¡ä½ å¿ƒé‡Œé¢å¤šå¤šå°‘å°‘éƒ½ä¼šäº§ç”Ÿä¸€ç‚¹ç‚¹æ¶Ÿæ¼ªï¼Œæ²¡é”™ï¼ŒæµAPIç»“åˆlambdaè¡¨è¾¾å¼ï¼Œå°±æ˜¯è¿™ä¹ˆä¼˜ç¾!ä¸‹é¢æˆ‘è¯¦ç»†ä»‹ç»ä¸€ä¸‹æ•´ä¸ªDemoï¼Œè®©å¤§å®¶æ›´åŠ æ¸…æ·…:\n\n### æœ€å°å€¼\n\n```\n //æœ€å°å€¼\nSystem.out.print(\"Listä¸­æœ€å°çš„å€¼ä¸º:\");\nStream<Integer> stream = lists.stream();\nOptional<Integer> min = stream.min(Integer::compareTo);\nif (min.isPresent()) {\n     System.out.println(min.get());//1\n}\n```\né¦–å…ˆé€šè¿‡stream()æ–¹æ³•è·å–Listå¯¹åº”çš„æµï¼Œå¦‚æœä½ å¯¹Java8çš„é›†åˆæ¡†æ¶æœ‰ä¸€å®šçš„äº†è§£ï¼Œä½ åº”è¯¥çŸ¥é“stream()æ˜¯ç”±Collectionæ¥å£æä¾›çš„ã€‚ç„¶åå°±å¯ä»¥é€šè¿‡min()è·å–æµä¸­çš„æœ€å°å€¼äº†ï¼Œå½“ç„¶è¿™ä¸ªæµä¸­çš„æœ€å°å€¼è‚¯å®šä¹Ÿæ˜¯Listé‡Œé¢çš„æœ€å°å€¼ã€‚min()æ–¹æ³•æ¥æ”¶ä¸€ä¸ªComparatorç±»å‹çš„å‚æ•°ï¼Œè¿™ä¸ªæ¯”è¾ƒå™¨æ˜¯ç”¨äºæ¯”è¾ƒæµä¸­çš„ä¸¤ä¸ªå…ƒç´ çš„ã€‚æˆ‘ä»¬è¿™é‡ŒæŠŠIntegerçš„compareTo()çš„å¼•ç”¨ä¼ é€’ç»™äº†min()ã€‚å®ƒè¿”å›çš„ç±»å‹æ˜¯Optionalï¼ŒOptionalå¯è°“æ˜¯NullPointExceptionçš„å¤§æ€å™¨å•Šï¼Œæ„Ÿå…´è¶£çš„åŒå­¦ï¼Œäº†è§£ä¸€ä¸‹ã€‚ç„¶ååˆ¤æ–­æœ€å°å€¼å­˜ä¸å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œå°±é€šè¿‡Optionalçš„get()è¯»å–å‡ºæ¥ã€‚å¾ˆç®€å•æœ‰æœ¨æœ‰!\n\n#### æœ€å¤§å€¼\n\n```\n//æœ€å¤§å€¼\nSystem.out.print(\"Listä¸­æœ€å¤§çš„å€¼ä¸º:\");\nlists.stream().max(Integer::compareTo).ifPresent(System.out::println);//6\n```\nè¯­æ³•ç³–çˆ½YYæœ‰æœ¨æœ‰ï¼Œä¸è¿‡éœ€è¦æ³¨æ„çš„ä¸€ç‚¹ï¼Œå› ä¸ºmin()æ˜¯ä¸€ä¸ªç»ˆç«¯æ“ä½œï¼Œæ‰€ä»¥è¿™ä¸ªæµæ˜¯ä¸å¯ä»¥å†ç”¨äº†ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦é€šè¿‡stream()é‡æ–°ç”Ÿæˆä¸€ä¸ªæµï¼Œ(ä½†è¿™å…¶å®å¹¶ä¸å½±å“æˆ‘ä»¬çš„å®é™…ç”Ÿäº§çš„:â‘ æ–¹æ³•åŠŸèƒ½å•ä¸€åŸåˆ™â‘¡è¿˜æœ‰å…¶å®ƒå¾ˆå¤šå¾ˆå¼ºå¤§çš„æ–¹æ³•ç»„åˆèƒ½è®©ä½ å®ç°å„ç§åŠŸèƒ½å•Š.)ifPresentå…¶å®å’Œä¸Šé¢çš„æœ€å°å€¼çš„ifåˆ¤æ–­æ˜¯ä¸€å®šè¦ï¼Œå¦‚æœå­˜åœ¨æœ€å¤§å€¼ï¼Œæˆ‘ä»¬å°±æ‰“å°ä¸€ä¸‹ï¼Œè¿™é‡Œåªä¸è¿‡ç”¨äº†ä¸€äº›å‡½æ•°å¼å†™æ³•è€Œå·²ã€‚\n\n#### æ’åºå’Œéå†\n\n```\n //æ’åº\nSystem.out.print(\"å°†Listæµè¿›è¡Œæ’åº:\");\nStream<Integer> sorted = lists.stream().sorted();\nsorted.forEach(elem -> System.out.print(elem + \" \"));// 1 2 3 4 5 6\n```\né€šè¿‡ä¸Šé¢çš„è®²è§£ï¼Œç›¸ä¿¡è¿™ä¸ªå·²ç»éš¾ä¸äº†ä½ äº†ï¼Œsorted()æ–¹æ³•æ˜¯ç”¨äºæ’åºçš„ï¼Œå®ƒçš„ä¸€ä¸ªé‡è½½æ–¹æ³•å¯ä»¥æ¥æ”¶ä¸€ä¸ªComparatorç±»å‹çš„å‚æ•°ï¼Œè®©ä½ è‡ªå®šä¹‰ä½ çš„æ’åºè§„åˆ™ã€‚forEachæ–¹æ³•å°±éå†ã€‚\n\n#### è¿‡æ»¤\n\n```\n//è¿‡æ»¤\nSystem.out.println(\"è¿‡æ»¤Listæµï¼Œåªå‰©ä¸‹é‚£äº›å¤§äº0å¹¶ä¸”å°äº4çš„å…ƒç´ :\\n=====begin=====\");\nlists.stream()\n          .filter(elem -> elem > 0)\n          .filter(elem -> elem < 4)\n          .sorted(Integer::compareTo)\n          .forEach(System.out::println);// 1 2 3\n\nSystem.out.println(\"=====end=====\");\n```\nfilter()æ˜¯åŸºäºä¸€ä¸ªè°“è¯è¿‡æ»¤æµï¼Œå®ƒè¿”å›ä¸€ä¸ªåªåŒ…å«æ»¡è¶³è°“è¯çš„å…ƒç´ çš„æ–°æµã€‚å®ƒçš„å‚æ•°å½¢å¼æ˜¯Predicate<? super T>æ˜¯åœ¨java.util.functionåŒ…ä¸‹çš„æ³›å‹å‡½æ•°å¼æ¥å£ã€‚å¹¶ä¸”filteræ˜¯ä¸€ä¸ªä¸­é—´æ“ä½œï¼Œè€Œä¸”è¿˜å¯ä»¥åŒæ—¶å­˜åœ¨å¤šä¸ªfilterã€‚è¿™é‡Œçš„ä¸¤ä¸ªè¿‡æ»¤å™¨ï¼Œæˆ‘ä»¬éƒ½ä¼ é€’äº†lambdaè¡¨è¾¾å¼ã€‚\n\n#### å°ç»“ä¸€ä¸‹\n\nå…¶å®åŸºæœ¬çš„æµAPIä½¿ç”¨å°±æ˜¯è¿™ä¹ˆç®€å•ï¼Œç»“åˆlambdaè¡¨è¾¾å¼åï¼Œä¸€åˆ‡éƒ½å˜å¾—ç‰¹åˆ«æ¸…æ·…ï¼Œè¿™ä¸ªç®€å•çš„Demoå±•ç¤ºäº†ä¸€äº›åŸºç¡€çš„åŠŸèƒ½ï¼Œå®ƒæˆ–è®¸å°±æ‰©å±•äº†ä½ æ“ä½œæ•°ç»„æˆ–è€…é›†åˆæ¡†æ¶çš„æ€è·¯ï¼Œè®©ä½ æ“ä½œé›†åˆå’Œæ•°ç»„ï¼Œå˜å¾—æ›´åŠ çš„å®¹æ˜“ï¼Œç®€å•å’Œé«˜æ•ˆã€‚å½“ç„¶æµAPIçš„çš„åŠŸèƒ½è‚¯å®šä¸æ­¢è¿™ä¸€ç‚¹ç‚¹ï¼Œæˆ‘ä¼šé™†é™†ç»­ç»­å®Œå–„æ•´ä¸ªç³»åˆ—ï¼Œå¤§å®¶è·Ÿç€æˆ‘çš„æ­¥ä¼ï¼Œå°±è¿™ä¸€æ¬¡ï¼Œè¸è¸å®å®å­¦å¥½æµå¼APIï¼Œèµ°å‘äººç”Ÿå·…å³°ï¼Œè¿å¨¶ç™½å¯Œç¾ï¼\n","source":"_posts/æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸€ï¼‰åŸºç¡€ä½“éªŒ.md","raw":"---\ntitle: Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸€ï¼‰åŸºç¡€ä½“éªŒ\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: æ–°ç‰¹æ€§\n---\n#### ä»€ä¹ˆæ˜¯æµAPI? å®ƒèƒ½åšä¸€äº›ä»€ä¹ˆ?\n\næˆ‘ä»¬åº”è¯¥çŸ¥é“(ç»å¯¹çŸ¥é“~)APIæ˜¯ä¸€ä¸ªç¨‹åºå‘ä½¿ç”¨è€…æä¾›çš„ä¸€äº›æ–¹æ³•ï¼Œé€šè¿‡è¿™äº›æ–¹æ³•å°±èƒ½å®ç°æŸäº›åŠŸèƒ½ã€‚æ‰€ä»¥å¯¹äºæµAPIæ¥è¯´ï¼Œé‡ç‚¹æ˜¯æ€ä¹ˆç†è§£\"æµ\"è¿™ä¸ªæ¦‚å¿µï¼Œæ‰€è°“çš„æµ:å°±æ˜¯æ•°æ®çš„æ¸ é“ï¼Œæ‰€ä»¥ï¼Œæµä»£è¡¨çš„æ˜¯ä¸€ä¸ªå¯¹è±¡çš„åºåˆ—å®ƒå’ŒJava I/Oç±»é‡Œä½¿ç”¨çš„\"æµ\"ä¸åŒã€‚è™½ç„¶åœ¨æ¦‚å¿µä¸Šä¸java.util.streamä¸­å®šä¹‰çš„æµæ˜¯ç±»ä¼¼çš„ï¼Œä½†å®ƒä»¬æ˜¯ä¸åŒçš„ï¼ŒæµAPIä¸­çš„æµæ˜¯æè¿°æŸä¸ªæµç±»å‹çš„å¯¹è±¡ã€‚\n\næµAPIä¸­çš„æµæ“ä½œçš„æ•°æ®æºï¼Œæ˜¯æ•°ç»„æˆ–è€…æ˜¯é›†åˆã€‚å®ƒæœ¬èº«æ˜¯ä¸å­˜å‚¨æ•°æ®çš„ï¼Œåªæ˜¯ç§»åŠ¨æ•°æ®ï¼Œåœ¨ç§»åŠ¨è¿‡ç¨‹ä¸­å¯èƒ½ä¼šå¯¹æ•°æ®è¿›è¡Œè¿‡æ»¤ï¼Œæ’åºæˆ–è€…å…¶å®ƒæ“ä½œï¼Œä½†æ˜¯ï¼Œä¸€èˆ¬æƒ…å†µä¸‹(ç»å¤§æ•°æƒ…å†µä¸‹)ï¼Œæµæ“ä½œæœ¬èº«ä¸ä¼šä¿®æ”¹æ•°æ®æºï¼Œæ¯”å¦‚ï¼Œå¯¹æµæ’åºä¸ä¼šä¿®æ”¹æ•°æ®æºçš„é¡ºåºã€‚ç›¸åï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æµï¼Œå…¶ä¸­åŒ…å«æ’åºåçš„ç»“æœã€‚\n\n#### ä»ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä½“éªŒæµAPIçš„å¼ºå¤§ä¸ä¼˜é›…\n  \nè¿™ä¸ªç®€å•çš„Demoï¼Œä¸»è¦æ˜¯å¯¹ä¸€ä¸ªç”±1-6ä¹±åºç»„æˆçš„Listå¯¹åº”çš„æµè¿›è¡Œæ“ä½œï¼Œç„¶åé€šè¿‡è¿™ä¸ªæµï¼Œå°±å¯ä»¥è·å–åˆ°åˆ—è¡¨é‡Œé¢æœ€å¤§æœ€å°å€¼ã€æ’åºã€è¿‡æ»¤æŸäº›å…ƒç´ ç­‰ç­‰çš„æ“ä½œã€‚å¹¶ä¸”è¿™æ­¤æ“ä½œä¸ä¼šæ”¹å˜åŸListé‡Œé¢çš„æ•°æ®ã€‚Demoé‡Œé¢éœ€è¦æ³¨æ„çš„åœ°æ–¹å°±æ˜¯æµAPIé‡Œé¢çš„\"ç»ˆç«¯æ“ä½œ\"å’Œ\"ä¸­é—´æ“ä½œ\"çš„åŒºåˆ«:å…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œç»ˆç«¯æ“ä½œä¼šæ¶ˆè´¹æµï¼Œä¸€ä¸ªè¢«æ¶ˆè´¹è¿‡çš„æµæ˜¯ä¸èƒ½è¢«å†æ¬¡åˆ©ç”¨çš„ï¼Œä½†æˆ‘ä»¬åœ¨å®é™…åº”ç”¨çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šå—åˆ°å¤ªå¤§çš„å½±å“(Ps:å¦‚æœä½ ä»¬èƒ½åŠ¨æ‰‹å®è·µä¸€ä¸‹æˆ‘ç›¸ä¿¡ä½ ä½“éªŒæ›´å¥½ï¼Œå¼ºçƒˆæ¨èï¼)\n\n```\npublic class Main {\n\n\n    public static void main(String[] args) { \n        learnStream();\n    }\n\n    private static void learnStream() {\n        //é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ª1-6ä¹±åºçš„List\n        List<Integer> lists = new ArrayList<>();\n        lists.add(4);\n        lists.add(3);\n        lists.add(6);\n        lists.add(1);\n        lists.add(5);\n        lists.add(2);\n\n        //çœ‹çœ‹Listé‡Œé¢çš„æ•°æ®æ˜¯ä»€ä¹ˆæ ·å­çš„å…ˆ\n        System.out.print(\"Listé‡Œé¢çš„æ•°æ®:\");\n        for (Integer elem : lists) System.out.print(elem + \" \");// 4 3 6 1 5 2\n\n        System.out.println();\n\n        //æœ€å°å€¼\n        System.out.print(\"Listä¸­æœ€å°çš„å€¼ä¸º:\");\n        Stream<Integer> stream = lists.stream();\n        Optional<Integer> min = stream.min(Integer::compareTo);\n        if (min.isPresent()) {\n            System.out.println(min.get());//1\n        }\n\n\n        //æœ€å¤§å€¼\n        System.out.print(\"Listä¸­æœ€å¤§çš„å€¼ä¸º:\");\n        lists.stream().max(Integer::compareTo).ifPresent(System.out::println);//6\n\n        //æ’åº\n        System.out.print(\"å°†Listæµè¿›è¡Œæ’åº:\");\n        Stream<Integer> sorted = lists.stream().sorted();\n        sorted.forEach(elem -> System.out.print(elem + \" \"));// 1 2 3 4 5 6\n\n        System.out.println();\n\n        //è¿‡æ»¤\n        System.out.print(\"è¿‡æ»¤Listæµï¼Œåªå‰©ä¸‹é‚£äº›å¤§äº3çš„å…ƒç´ :\");\n        lists.stream()\n                .filter(elem -> elem > 3)\n                .forEach(elem -> System.out.print(elem + \" \"));// 4 5 6\n\n        System.out.println();\n\n        //è¿‡æ»¤\n        System.out.println(\"è¿‡æ»¤Listæµï¼Œåªå‰©ä¸‹é‚£äº›å¤§äº0å¹¶ä¸”å°äº4çš„å…ƒç´ :\\n=====begin=====\");\n        lists.stream()\n                .filter(elem -> elem > 0)\n                .filter(elem -> elem < 4)\n                .sorted(Integer::compareTo)\n                .forEach(System.out::println);// 1 2 3\n\n        System.out.println(\"=====end=====\");\n        //ç»è¿‡äº†å‰é¢çš„è¿™ä¹ˆå¤šæµæ“ä½œï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹Listé‡Œé¢çš„å€¼æœ‰æ²¡æœ‰å‘ç”Ÿä»€ä¹ˆæ”¹å˜\n        System.out.print(\"åŸListé‡Œé¢çš„æ•°æ®:\");\n        for (Integer elem : lists) System.out.print(elem + \" \");// 4 3 6 1 5 2\n    }\n}\n```\n\nå¦‚æœåˆšæ‰çš„Demoä½ è®¤çœŸè¯»äº†ï¼Œæˆ‘ç›¸ä¿¡ä½ å¿ƒé‡Œé¢å¤šå¤šå°‘å°‘éƒ½ä¼šäº§ç”Ÿä¸€ç‚¹ç‚¹æ¶Ÿæ¼ªï¼Œæ²¡é”™ï¼ŒæµAPIç»“åˆlambdaè¡¨è¾¾å¼ï¼Œå°±æ˜¯è¿™ä¹ˆä¼˜ç¾!ä¸‹é¢æˆ‘è¯¦ç»†ä»‹ç»ä¸€ä¸‹æ•´ä¸ªDemoï¼Œè®©å¤§å®¶æ›´åŠ æ¸…æ·…:\n\n### æœ€å°å€¼\n\n```\n //æœ€å°å€¼\nSystem.out.print(\"Listä¸­æœ€å°çš„å€¼ä¸º:\");\nStream<Integer> stream = lists.stream();\nOptional<Integer> min = stream.min(Integer::compareTo);\nif (min.isPresent()) {\n     System.out.println(min.get());//1\n}\n```\né¦–å…ˆé€šè¿‡stream()æ–¹æ³•è·å–Listå¯¹åº”çš„æµï¼Œå¦‚æœä½ å¯¹Java8çš„é›†åˆæ¡†æ¶æœ‰ä¸€å®šçš„äº†è§£ï¼Œä½ åº”è¯¥çŸ¥é“stream()æ˜¯ç”±Collectionæ¥å£æä¾›çš„ã€‚ç„¶åå°±å¯ä»¥é€šè¿‡min()è·å–æµä¸­çš„æœ€å°å€¼äº†ï¼Œå½“ç„¶è¿™ä¸ªæµä¸­çš„æœ€å°å€¼è‚¯å®šä¹Ÿæ˜¯Listé‡Œé¢çš„æœ€å°å€¼ã€‚min()æ–¹æ³•æ¥æ”¶ä¸€ä¸ªComparatorç±»å‹çš„å‚æ•°ï¼Œè¿™ä¸ªæ¯”è¾ƒå™¨æ˜¯ç”¨äºæ¯”è¾ƒæµä¸­çš„ä¸¤ä¸ªå…ƒç´ çš„ã€‚æˆ‘ä»¬è¿™é‡ŒæŠŠIntegerçš„compareTo()çš„å¼•ç”¨ä¼ é€’ç»™äº†min()ã€‚å®ƒè¿”å›çš„ç±»å‹æ˜¯Optionalï¼ŒOptionalå¯è°“æ˜¯NullPointExceptionçš„å¤§æ€å™¨å•Šï¼Œæ„Ÿå…´è¶£çš„åŒå­¦ï¼Œäº†è§£ä¸€ä¸‹ã€‚ç„¶ååˆ¤æ–­æœ€å°å€¼å­˜ä¸å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œå°±é€šè¿‡Optionalçš„get()è¯»å–å‡ºæ¥ã€‚å¾ˆç®€å•æœ‰æœ¨æœ‰!\n\n#### æœ€å¤§å€¼\n\n```\n//æœ€å¤§å€¼\nSystem.out.print(\"Listä¸­æœ€å¤§çš„å€¼ä¸º:\");\nlists.stream().max(Integer::compareTo).ifPresent(System.out::println);//6\n```\nè¯­æ³•ç³–çˆ½YYæœ‰æœ¨æœ‰ï¼Œä¸è¿‡éœ€è¦æ³¨æ„çš„ä¸€ç‚¹ï¼Œå› ä¸ºmin()æ˜¯ä¸€ä¸ªç»ˆç«¯æ“ä½œï¼Œæ‰€ä»¥è¿™ä¸ªæµæ˜¯ä¸å¯ä»¥å†ç”¨äº†ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦é€šè¿‡stream()é‡æ–°ç”Ÿæˆä¸€ä¸ªæµï¼Œ(ä½†è¿™å…¶å®å¹¶ä¸å½±å“æˆ‘ä»¬çš„å®é™…ç”Ÿäº§çš„:â‘ æ–¹æ³•åŠŸèƒ½å•ä¸€åŸåˆ™â‘¡è¿˜æœ‰å…¶å®ƒå¾ˆå¤šå¾ˆå¼ºå¤§çš„æ–¹æ³•ç»„åˆèƒ½è®©ä½ å®ç°å„ç§åŠŸèƒ½å•Š.)ifPresentå…¶å®å’Œä¸Šé¢çš„æœ€å°å€¼çš„ifåˆ¤æ–­æ˜¯ä¸€å®šè¦ï¼Œå¦‚æœå­˜åœ¨æœ€å¤§å€¼ï¼Œæˆ‘ä»¬å°±æ‰“å°ä¸€ä¸‹ï¼Œè¿™é‡Œåªä¸è¿‡ç”¨äº†ä¸€äº›å‡½æ•°å¼å†™æ³•è€Œå·²ã€‚\n\n#### æ’åºå’Œéå†\n\n```\n //æ’åº\nSystem.out.print(\"å°†Listæµè¿›è¡Œæ’åº:\");\nStream<Integer> sorted = lists.stream().sorted();\nsorted.forEach(elem -> System.out.print(elem + \" \"));// 1 2 3 4 5 6\n```\né€šè¿‡ä¸Šé¢çš„è®²è§£ï¼Œç›¸ä¿¡è¿™ä¸ªå·²ç»éš¾ä¸äº†ä½ äº†ï¼Œsorted()æ–¹æ³•æ˜¯ç”¨äºæ’åºçš„ï¼Œå®ƒçš„ä¸€ä¸ªé‡è½½æ–¹æ³•å¯ä»¥æ¥æ”¶ä¸€ä¸ªComparatorç±»å‹çš„å‚æ•°ï¼Œè®©ä½ è‡ªå®šä¹‰ä½ çš„æ’åºè§„åˆ™ã€‚forEachæ–¹æ³•å°±éå†ã€‚\n\n#### è¿‡æ»¤\n\n```\n//è¿‡æ»¤\nSystem.out.println(\"è¿‡æ»¤Listæµï¼Œåªå‰©ä¸‹é‚£äº›å¤§äº0å¹¶ä¸”å°äº4çš„å…ƒç´ :\\n=====begin=====\");\nlists.stream()\n          .filter(elem -> elem > 0)\n          .filter(elem -> elem < 4)\n          .sorted(Integer::compareTo)\n          .forEach(System.out::println);// 1 2 3\n\nSystem.out.println(\"=====end=====\");\n```\nfilter()æ˜¯åŸºäºä¸€ä¸ªè°“è¯è¿‡æ»¤æµï¼Œå®ƒè¿”å›ä¸€ä¸ªåªåŒ…å«æ»¡è¶³è°“è¯çš„å…ƒç´ çš„æ–°æµã€‚å®ƒçš„å‚æ•°å½¢å¼æ˜¯Predicate<? super T>æ˜¯åœ¨java.util.functionåŒ…ä¸‹çš„æ³›å‹å‡½æ•°å¼æ¥å£ã€‚å¹¶ä¸”filteræ˜¯ä¸€ä¸ªä¸­é—´æ“ä½œï¼Œè€Œä¸”è¿˜å¯ä»¥åŒæ—¶å­˜åœ¨å¤šä¸ªfilterã€‚è¿™é‡Œçš„ä¸¤ä¸ªè¿‡æ»¤å™¨ï¼Œæˆ‘ä»¬éƒ½ä¼ é€’äº†lambdaè¡¨è¾¾å¼ã€‚\n\n#### å°ç»“ä¸€ä¸‹\n\nå…¶å®åŸºæœ¬çš„æµAPIä½¿ç”¨å°±æ˜¯è¿™ä¹ˆç®€å•ï¼Œç»“åˆlambdaè¡¨è¾¾å¼åï¼Œä¸€åˆ‡éƒ½å˜å¾—ç‰¹åˆ«æ¸…æ·…ï¼Œè¿™ä¸ªç®€å•çš„Demoå±•ç¤ºäº†ä¸€äº›åŸºç¡€çš„åŠŸèƒ½ï¼Œå®ƒæˆ–è®¸å°±æ‰©å±•äº†ä½ æ“ä½œæ•°ç»„æˆ–è€…é›†åˆæ¡†æ¶çš„æ€è·¯ï¼Œè®©ä½ æ“ä½œé›†åˆå’Œæ•°ç»„ï¼Œå˜å¾—æ›´åŠ çš„å®¹æ˜“ï¼Œç®€å•å’Œé«˜æ•ˆã€‚å½“ç„¶æµAPIçš„çš„åŠŸèƒ½è‚¯å®šä¸æ­¢è¿™ä¸€ç‚¹ç‚¹ï¼Œæˆ‘ä¼šé™†é™†ç»­ç»­å®Œå–„æ•´ä¸ªç³»åˆ—ï¼Œå¤§å®¶è·Ÿç€æˆ‘çš„æ­¥ä¼ï¼Œå°±è¿™ä¸€æ¬¡ï¼Œè¸è¸å®å®å­¦å¥½æµå¼APIï¼Œèµ°å‘äººç”Ÿå·…å³°ï¼Œè¿å¨¶ç™½å¯Œç¾ï¼\n","slug":"æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸€ï¼‰åŸºç¡€ä½“éªŒ","published":1,"updated":"2025-10-15T07:20:51.422Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu0779006lqkd4faqhax6o","content":"<h4 id=\"ä»€ä¹ˆæ˜¯æµAPI-å®ƒèƒ½åšä¸€äº›ä»€ä¹ˆ\"><a href=\"#ä»€ä¹ˆæ˜¯æµAPI-å®ƒèƒ½åšä¸€äº›ä»€ä¹ˆ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯æµAPI? å®ƒèƒ½åšä¸€äº›ä»€ä¹ˆ?\"></a>ä»€ä¹ˆæ˜¯æµAPI? å®ƒèƒ½åšä¸€äº›ä»€ä¹ˆ?</h4><p>æˆ‘ä»¬åº”è¯¥çŸ¥é“(ç»å¯¹çŸ¥é“~)APIæ˜¯ä¸€ä¸ªç¨‹åºå‘ä½¿ç”¨è€…æä¾›çš„ä¸€äº›æ–¹æ³•ï¼Œé€šè¿‡è¿™äº›æ–¹æ³•å°±èƒ½å®ç°æŸäº›åŠŸèƒ½ã€‚æ‰€ä»¥å¯¹äºæµAPIæ¥è¯´ï¼Œé‡ç‚¹æ˜¯æ€ä¹ˆç†è§£â€æµâ€è¿™ä¸ªæ¦‚å¿µï¼Œæ‰€è°“çš„æµ:å°±æ˜¯æ•°æ®çš„æ¸ é“ï¼Œæ‰€ä»¥ï¼Œæµä»£è¡¨çš„æ˜¯ä¸€ä¸ªå¯¹è±¡çš„åºåˆ—å®ƒå’ŒJava I&#x2F;Oç±»é‡Œä½¿ç”¨çš„â€æµâ€ä¸åŒã€‚è™½ç„¶åœ¨æ¦‚å¿µä¸Šä¸java.util.streamä¸­å®šä¹‰çš„æµæ˜¯ç±»ä¼¼çš„ï¼Œä½†å®ƒä»¬æ˜¯ä¸åŒçš„ï¼ŒæµAPIä¸­çš„æµæ˜¯æè¿°æŸä¸ªæµç±»å‹çš„å¯¹è±¡ã€‚</p>\n<p>æµAPIä¸­çš„æµæ“ä½œçš„æ•°æ®æºï¼Œæ˜¯æ•°ç»„æˆ–è€…æ˜¯é›†åˆã€‚å®ƒæœ¬èº«æ˜¯ä¸å­˜å‚¨æ•°æ®çš„ï¼Œåªæ˜¯ç§»åŠ¨æ•°æ®ï¼Œåœ¨ç§»åŠ¨è¿‡ç¨‹ä¸­å¯èƒ½ä¼šå¯¹æ•°æ®è¿›è¡Œè¿‡æ»¤ï¼Œæ’åºæˆ–è€…å…¶å®ƒæ“ä½œï¼Œä½†æ˜¯ï¼Œä¸€èˆ¬æƒ…å†µä¸‹(ç»å¤§æ•°æƒ…å†µä¸‹)ï¼Œæµæ“ä½œæœ¬èº«ä¸ä¼šä¿®æ”¹æ•°æ®æºï¼Œæ¯”å¦‚ï¼Œå¯¹æµæ’åºä¸ä¼šä¿®æ”¹æ•°æ®æºçš„é¡ºåºã€‚ç›¸åï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æµï¼Œå…¶ä¸­åŒ…å«æ’åºåçš„ç»“æœã€‚</p>\n<h4 id=\"ä»ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä½“éªŒæµAPIçš„å¼ºå¤§ä¸ä¼˜é›…\"><a href=\"#ä»ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä½“éªŒæµAPIçš„å¼ºå¤§ä¸ä¼˜é›…\" class=\"headerlink\" title=\"ä»ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä½“éªŒæµAPIçš„å¼ºå¤§ä¸ä¼˜é›…\"></a>ä»ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä½“éªŒæµAPIçš„å¼ºå¤§ä¸ä¼˜é›…</h4><p>è¿™ä¸ªç®€å•çš„Demoï¼Œä¸»è¦æ˜¯å¯¹ä¸€ä¸ªç”±1-6ä¹±åºç»„æˆçš„Listå¯¹åº”çš„æµè¿›è¡Œæ“ä½œï¼Œç„¶åé€šè¿‡è¿™ä¸ªæµï¼Œå°±å¯ä»¥è·å–åˆ°åˆ—è¡¨é‡Œé¢æœ€å¤§æœ€å°å€¼ã€æ’åºã€è¿‡æ»¤æŸäº›å…ƒç´ ç­‰ç­‰çš„æ“ä½œã€‚å¹¶ä¸”è¿™æ­¤æ“ä½œä¸ä¼šæ”¹å˜åŸListé‡Œé¢çš„æ•°æ®ã€‚Demoé‡Œé¢éœ€è¦æ³¨æ„çš„åœ°æ–¹å°±æ˜¯æµAPIé‡Œé¢çš„â€ç»ˆç«¯æ“ä½œâ€å’Œâ€ä¸­é—´æ“ä½œâ€çš„åŒºåˆ«:å…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œç»ˆç«¯æ“ä½œä¼šæ¶ˆè´¹æµï¼Œä¸€ä¸ªè¢«æ¶ˆè´¹è¿‡çš„æµæ˜¯ä¸èƒ½è¢«å†æ¬¡åˆ©ç”¨çš„ï¼Œä½†æˆ‘ä»¬åœ¨å®é™…åº”ç”¨çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šå—åˆ°å¤ªå¤§çš„å½±å“(Ps:å¦‚æœä½ ä»¬èƒ½åŠ¨æ‰‹å®è·µä¸€ä¸‹æˆ‘ç›¸ä¿¡ä½ ä½“éªŒæ›´å¥½ï¼Œå¼ºçƒˆæ¨èï¼)</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class Main &#123;\n\n\n    public static void main(String[] args) &#123; \n        learnStream();\n    &#125;\n\n    private static void learnStream() &#123;\n        &#x2F;&#x2F;é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ª1-6ä¹±åºçš„List\n        List&lt;Integer&gt; lists &#x3D; new ArrayList&lt;&gt;();\n        lists.add(4);\n        lists.add(3);\n        lists.add(6);\n        lists.add(1);\n        lists.add(5);\n        lists.add(2);\n\n        &#x2F;&#x2F;çœ‹çœ‹Listé‡Œé¢çš„æ•°æ®æ˜¯ä»€ä¹ˆæ ·å­çš„å…ˆ\n        System.out.print(&quot;Listé‡Œé¢çš„æ•°æ®:&quot;);\n        for (Integer elem : lists) System.out.print(elem + &quot; &quot;);&#x2F;&#x2F; 4 3 6 1 5 2\n\n        System.out.println();\n\n        &#x2F;&#x2F;æœ€å°å€¼\n        System.out.print(&quot;Listä¸­æœ€å°çš„å€¼ä¸º:&quot;);\n        Stream&lt;Integer&gt; stream &#x3D; lists.stream();\n        Optional&lt;Integer&gt; min &#x3D; stream.min(Integer::compareTo);\n        if (min.isPresent()) &#123;\n            System.out.println(min.get());&#x2F;&#x2F;1\n        &#125;\n\n\n        &#x2F;&#x2F;æœ€å¤§å€¼\n        System.out.print(&quot;Listä¸­æœ€å¤§çš„å€¼ä¸º:&quot;);\n        lists.stream().max(Integer::compareTo).ifPresent(System.out::println);&#x2F;&#x2F;6\n\n        &#x2F;&#x2F;æ’åº\n        System.out.print(&quot;å°†Listæµè¿›è¡Œæ’åº:&quot;);\n        Stream&lt;Integer&gt; sorted &#x3D; lists.stream().sorted();\n        sorted.forEach(elem -&gt; System.out.print(elem + &quot; &quot;));&#x2F;&#x2F; 1 2 3 4 5 6\n\n        System.out.println();\n\n        &#x2F;&#x2F;è¿‡æ»¤\n        System.out.print(&quot;è¿‡æ»¤Listæµï¼Œåªå‰©ä¸‹é‚£äº›å¤§äº3çš„å…ƒç´ :&quot;);\n        lists.stream()\n                .filter(elem -&gt; elem &gt; 3)\n                .forEach(elem -&gt; System.out.print(elem + &quot; &quot;));&#x2F;&#x2F; 4 5 6\n\n        System.out.println();\n\n        &#x2F;&#x2F;è¿‡æ»¤\n        System.out.println(&quot;è¿‡æ»¤Listæµï¼Œåªå‰©ä¸‹é‚£äº›å¤§äº0å¹¶ä¸”å°äº4çš„å…ƒç´ :\\n&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;begin&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;);\n        lists.stream()\n                .filter(elem -&gt; elem &gt; 0)\n                .filter(elem -&gt; elem &lt; 4)\n                .sorted(Integer::compareTo)\n                .forEach(System.out::println);&#x2F;&#x2F; 1 2 3\n\n        System.out.println(&quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;end&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;);\n        &#x2F;&#x2F;ç»è¿‡äº†å‰é¢çš„è¿™ä¹ˆå¤šæµæ“ä½œï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹Listé‡Œé¢çš„å€¼æœ‰æ²¡æœ‰å‘ç”Ÿä»€ä¹ˆæ”¹å˜\n        System.out.print(&quot;åŸListé‡Œé¢çš„æ•°æ®:&quot;);\n        for (Integer elem : lists) System.out.print(elem + &quot; &quot;);&#x2F;&#x2F; 4 3 6 1 5 2\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¦‚æœåˆšæ‰çš„Demoä½ è®¤çœŸè¯»äº†ï¼Œæˆ‘ç›¸ä¿¡ä½ å¿ƒé‡Œé¢å¤šå¤šå°‘å°‘éƒ½ä¼šäº§ç”Ÿä¸€ç‚¹ç‚¹æ¶Ÿæ¼ªï¼Œæ²¡é”™ï¼ŒæµAPIç»“åˆlambdaè¡¨è¾¾å¼ï¼Œå°±æ˜¯è¿™ä¹ˆä¼˜ç¾!ä¸‹é¢æˆ‘è¯¦ç»†ä»‹ç»ä¸€ä¸‹æ•´ä¸ªDemoï¼Œè®©å¤§å®¶æ›´åŠ æ¸…æ·…:</p>\n<h3 id=\"æœ€å°å€¼\"><a href=\"#æœ€å°å€¼\" class=\"headerlink\" title=\"æœ€å°å€¼\"></a>æœ€å°å€¼</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\"> &#x2F;&#x2F;æœ€å°å€¼\nSystem.out.print(&quot;Listä¸­æœ€å°çš„å€¼ä¸º:&quot;);\nStream&lt;Integer&gt; stream &#x3D; lists.stream();\nOptional&lt;Integer&gt; min &#x3D; stream.min(Integer::compareTo);\nif (min.isPresent()) &#123;\n     System.out.println(min.get());&#x2F;&#x2F;1\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>é¦–å…ˆé€šè¿‡stream()æ–¹æ³•è·å–Listå¯¹åº”çš„æµï¼Œå¦‚æœä½ å¯¹Java8çš„é›†åˆæ¡†æ¶æœ‰ä¸€å®šçš„äº†è§£ï¼Œä½ åº”è¯¥çŸ¥é“stream()æ˜¯ç”±Collectionæ¥å£æä¾›çš„ã€‚ç„¶åå°±å¯ä»¥é€šè¿‡min()è·å–æµä¸­çš„æœ€å°å€¼äº†ï¼Œå½“ç„¶è¿™ä¸ªæµä¸­çš„æœ€å°å€¼è‚¯å®šä¹Ÿæ˜¯Listé‡Œé¢çš„æœ€å°å€¼ã€‚min()æ–¹æ³•æ¥æ”¶ä¸€ä¸ªComparatorç±»å‹çš„å‚æ•°ï¼Œè¿™ä¸ªæ¯”è¾ƒå™¨æ˜¯ç”¨äºæ¯”è¾ƒæµä¸­çš„ä¸¤ä¸ªå…ƒç´ çš„ã€‚æˆ‘ä»¬è¿™é‡ŒæŠŠIntegerçš„compareTo()çš„å¼•ç”¨ä¼ é€’ç»™äº†min()ã€‚å®ƒè¿”å›çš„ç±»å‹æ˜¯Optionalï¼ŒOptionalå¯è°“æ˜¯NullPointExceptionçš„å¤§æ€å™¨å•Šï¼Œæ„Ÿå…´è¶£çš„åŒå­¦ï¼Œäº†è§£ä¸€ä¸‹ã€‚ç„¶ååˆ¤æ–­æœ€å°å€¼å­˜ä¸å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œå°±é€šè¿‡Optionalçš„get()è¯»å–å‡ºæ¥ã€‚å¾ˆç®€å•æœ‰æœ¨æœ‰!</p>\n<h4 id=\"æœ€å¤§å€¼\"><a href=\"#æœ€å¤§å€¼\" class=\"headerlink\" title=\"æœ€å¤§å€¼\"></a>æœ€å¤§å€¼</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F;æœ€å¤§å€¼\nSystem.out.print(&quot;Listä¸­æœ€å¤§çš„å€¼ä¸º:&quot;);\nlists.stream().max(Integer::compareTo).ifPresent(System.out::println);&#x2F;&#x2F;6<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>è¯­æ³•ç³–çˆ½YYæœ‰æœ¨æœ‰ï¼Œä¸è¿‡éœ€è¦æ³¨æ„çš„ä¸€ç‚¹ï¼Œå› ä¸ºmin()æ˜¯ä¸€ä¸ªç»ˆç«¯æ“ä½œï¼Œæ‰€ä»¥è¿™ä¸ªæµæ˜¯ä¸å¯ä»¥å†ç”¨äº†ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦é€šè¿‡stream()é‡æ–°ç”Ÿæˆä¸€ä¸ªæµï¼Œ(ä½†è¿™å…¶å®å¹¶ä¸å½±å“æˆ‘ä»¬çš„å®é™…ç”Ÿäº§çš„:â‘ æ–¹æ³•åŠŸèƒ½å•ä¸€åŸåˆ™â‘¡è¿˜æœ‰å…¶å®ƒå¾ˆå¤šå¾ˆå¼ºå¤§çš„æ–¹æ³•ç»„åˆèƒ½è®©ä½ å®ç°å„ç§åŠŸèƒ½å•Š.)ifPresentå…¶å®å’Œä¸Šé¢çš„æœ€å°å€¼çš„ifåˆ¤æ–­æ˜¯ä¸€å®šè¦ï¼Œå¦‚æœå­˜åœ¨æœ€å¤§å€¼ï¼Œæˆ‘ä»¬å°±æ‰“å°ä¸€ä¸‹ï¼Œè¿™é‡Œåªä¸è¿‡ç”¨äº†ä¸€äº›å‡½æ•°å¼å†™æ³•è€Œå·²ã€‚</p>\n<h4 id=\"æ’åºå’Œéå†\"><a href=\"#æ’åºå’Œéå†\" class=\"headerlink\" title=\"æ’åºå’Œéå†\"></a>æ’åºå’Œéå†</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\"> &#x2F;&#x2F;æ’åº\nSystem.out.print(&quot;å°†Listæµè¿›è¡Œæ’åº:&quot;);\nStream&lt;Integer&gt; sorted &#x3D; lists.stream().sorted();\nsorted.forEach(elem -&gt; System.out.print(elem + &quot; &quot;));&#x2F;&#x2F; 1 2 3 4 5 6<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<p>é€šè¿‡ä¸Šé¢çš„è®²è§£ï¼Œç›¸ä¿¡è¿™ä¸ªå·²ç»éš¾ä¸äº†ä½ äº†ï¼Œsorted()æ–¹æ³•æ˜¯ç”¨äºæ’åºçš„ï¼Œå®ƒçš„ä¸€ä¸ªé‡è½½æ–¹æ³•å¯ä»¥æ¥æ”¶ä¸€ä¸ªComparatorç±»å‹çš„å‚æ•°ï¼Œè®©ä½ è‡ªå®šä¹‰ä½ çš„æ’åºè§„åˆ™ã€‚forEachæ–¹æ³•å°±éå†ã€‚</p>\n<h4 id=\"è¿‡æ»¤\"><a href=\"#è¿‡æ»¤\" class=\"headerlink\" title=\"è¿‡æ»¤\"></a>è¿‡æ»¤</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F;è¿‡æ»¤\nSystem.out.println(&quot;è¿‡æ»¤Listæµï¼Œåªå‰©ä¸‹é‚£äº›å¤§äº0å¹¶ä¸”å°äº4çš„å…ƒç´ :\\n&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;begin&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;);\nlists.stream()\n          .filter(elem -&gt; elem &gt; 0)\n          .filter(elem -&gt; elem &lt; 4)\n          .sorted(Integer::compareTo)\n          .forEach(System.out::println);&#x2F;&#x2F; 1 2 3\n\nSystem.out.println(&quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;end&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>filter()æ˜¯åŸºäºä¸€ä¸ªè°“è¯è¿‡æ»¤æµï¼Œå®ƒè¿”å›ä¸€ä¸ªåªåŒ…å«æ»¡è¶³è°“è¯çš„å…ƒç´ çš„æ–°æµã€‚å®ƒçš„å‚æ•°å½¢å¼æ˜¯Predicate&lt;? super T&gt;æ˜¯åœ¨java.util.functionåŒ…ä¸‹çš„æ³›å‹å‡½æ•°å¼æ¥å£ã€‚å¹¶ä¸”filteræ˜¯ä¸€ä¸ªä¸­é—´æ“ä½œï¼Œè€Œä¸”è¿˜å¯ä»¥åŒæ—¶å­˜åœ¨å¤šä¸ªfilterã€‚è¿™é‡Œçš„ä¸¤ä¸ªè¿‡æ»¤å™¨ï¼Œæˆ‘ä»¬éƒ½ä¼ é€’äº†lambdaè¡¨è¾¾å¼ã€‚</p>\n<h4 id=\"å°ç»“ä¸€ä¸‹\"><a href=\"#å°ç»“ä¸€ä¸‹\" class=\"headerlink\" title=\"å°ç»“ä¸€ä¸‹\"></a>å°ç»“ä¸€ä¸‹</h4><p>å…¶å®åŸºæœ¬çš„æµAPIä½¿ç”¨å°±æ˜¯è¿™ä¹ˆç®€å•ï¼Œç»“åˆlambdaè¡¨è¾¾å¼åï¼Œä¸€åˆ‡éƒ½å˜å¾—ç‰¹åˆ«æ¸…æ·…ï¼Œè¿™ä¸ªç®€å•çš„Demoå±•ç¤ºäº†ä¸€äº›åŸºç¡€çš„åŠŸèƒ½ï¼Œå®ƒæˆ–è®¸å°±æ‰©å±•äº†ä½ æ“ä½œæ•°ç»„æˆ–è€…é›†åˆæ¡†æ¶çš„æ€è·¯ï¼Œè®©ä½ æ“ä½œé›†åˆå’Œæ•°ç»„ï¼Œå˜å¾—æ›´åŠ çš„å®¹æ˜“ï¼Œç®€å•å’Œé«˜æ•ˆã€‚å½“ç„¶æµAPIçš„çš„åŠŸèƒ½è‚¯å®šä¸æ­¢è¿™ä¸€ç‚¹ç‚¹ï¼Œæˆ‘ä¼šé™†é™†ç»­ç»­å®Œå–„æ•´ä¸ªç³»åˆ—ï¼Œå¤§å®¶è·Ÿç€æˆ‘çš„æ­¥ä¼ï¼Œå°±è¿™ä¸€æ¬¡ï¼Œè¸è¸å®å®å­¦å¥½æµå¼APIï¼Œèµ°å‘äººç”Ÿå·…å³°ï¼Œè¿å¨¶ç™½å¯Œç¾ï¼</p>\n","excerpt":"","more":"<h4 id=\"ä»€ä¹ˆæ˜¯æµAPI-å®ƒèƒ½åšä¸€äº›ä»€ä¹ˆ\"><a href=\"#ä»€ä¹ˆæ˜¯æµAPI-å®ƒèƒ½åšä¸€äº›ä»€ä¹ˆ\" class=\"headerlink\" title=\"ä»€ä¹ˆæ˜¯æµAPI? å®ƒèƒ½åšä¸€äº›ä»€ä¹ˆ?\"></a>ä»€ä¹ˆæ˜¯æµAPI? å®ƒèƒ½åšä¸€äº›ä»€ä¹ˆ?</h4><p>æˆ‘ä»¬åº”è¯¥çŸ¥é“(ç»å¯¹çŸ¥é“~)APIæ˜¯ä¸€ä¸ªç¨‹åºå‘ä½¿ç”¨è€…æä¾›çš„ä¸€äº›æ–¹æ³•ï¼Œé€šè¿‡è¿™äº›æ–¹æ³•å°±èƒ½å®ç°æŸäº›åŠŸèƒ½ã€‚æ‰€ä»¥å¯¹äºæµAPIæ¥è¯´ï¼Œé‡ç‚¹æ˜¯æ€ä¹ˆç†è§£â€æµâ€è¿™ä¸ªæ¦‚å¿µï¼Œæ‰€è°“çš„æµ:å°±æ˜¯æ•°æ®çš„æ¸ é“ï¼Œæ‰€ä»¥ï¼Œæµä»£è¡¨çš„æ˜¯ä¸€ä¸ªå¯¹è±¡çš„åºåˆ—å®ƒå’ŒJava I&#x2F;Oç±»é‡Œä½¿ç”¨çš„â€æµâ€ä¸åŒã€‚è™½ç„¶åœ¨æ¦‚å¿µä¸Šä¸java.util.streamä¸­å®šä¹‰çš„æµæ˜¯ç±»ä¼¼çš„ï¼Œä½†å®ƒä»¬æ˜¯ä¸åŒçš„ï¼ŒæµAPIä¸­çš„æµæ˜¯æè¿°æŸä¸ªæµç±»å‹çš„å¯¹è±¡ã€‚</p>\n<p>æµAPIä¸­çš„æµæ“ä½œçš„æ•°æ®æºï¼Œæ˜¯æ•°ç»„æˆ–è€…æ˜¯é›†åˆã€‚å®ƒæœ¬èº«æ˜¯ä¸å­˜å‚¨æ•°æ®çš„ï¼Œåªæ˜¯ç§»åŠ¨æ•°æ®ï¼Œåœ¨ç§»åŠ¨è¿‡ç¨‹ä¸­å¯èƒ½ä¼šå¯¹æ•°æ®è¿›è¡Œè¿‡æ»¤ï¼Œæ’åºæˆ–è€…å…¶å®ƒæ“ä½œï¼Œä½†æ˜¯ï¼Œä¸€èˆ¬æƒ…å†µä¸‹(ç»å¤§æ•°æƒ…å†µä¸‹)ï¼Œæµæ“ä½œæœ¬èº«ä¸ä¼šä¿®æ”¹æ•°æ®æºï¼Œæ¯”å¦‚ï¼Œå¯¹æµæ’åºä¸ä¼šä¿®æ”¹æ•°æ®æºçš„é¡ºåºã€‚ç›¸åï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æµï¼Œå…¶ä¸­åŒ…å«æ’åºåçš„ç»“æœã€‚</p>\n<h4 id=\"ä»ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä½“éªŒæµAPIçš„å¼ºå¤§ä¸ä¼˜é›…\"><a href=\"#ä»ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä½“éªŒæµAPIçš„å¼ºå¤§ä¸ä¼˜é›…\" class=\"headerlink\" title=\"ä»ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä½“éªŒæµAPIçš„å¼ºå¤§ä¸ä¼˜é›…\"></a>ä»ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼Œä½“éªŒæµAPIçš„å¼ºå¤§ä¸ä¼˜é›…</h4><p>è¿™ä¸ªç®€å•çš„Demoï¼Œä¸»è¦æ˜¯å¯¹ä¸€ä¸ªç”±1-6ä¹±åºç»„æˆçš„Listå¯¹åº”çš„æµè¿›è¡Œæ“ä½œï¼Œç„¶åé€šè¿‡è¿™ä¸ªæµï¼Œå°±å¯ä»¥è·å–åˆ°åˆ—è¡¨é‡Œé¢æœ€å¤§æœ€å°å€¼ã€æ’åºã€è¿‡æ»¤æŸäº›å…ƒç´ ç­‰ç­‰çš„æ“ä½œã€‚å¹¶ä¸”è¿™æ­¤æ“ä½œä¸ä¼šæ”¹å˜åŸListé‡Œé¢çš„æ•°æ®ã€‚Demoé‡Œé¢éœ€è¦æ³¨æ„çš„åœ°æ–¹å°±æ˜¯æµAPIé‡Œé¢çš„â€ç»ˆç«¯æ“ä½œâ€å’Œâ€ä¸­é—´æ“ä½œâ€çš„åŒºåˆ«:å…¶å®ä¹Ÿå¾ˆç®€å•ï¼Œç»ˆç«¯æ“ä½œä¼šæ¶ˆè´¹æµï¼Œä¸€ä¸ªè¢«æ¶ˆè´¹è¿‡çš„æµæ˜¯ä¸èƒ½è¢«å†æ¬¡åˆ©ç”¨çš„ï¼Œä½†æˆ‘ä»¬åœ¨å®é™…åº”ç”¨çš„æ—¶å€™ï¼Œå¹¶ä¸ä¼šå—åˆ°å¤ªå¤§çš„å½±å“(Ps:å¦‚æœä½ ä»¬èƒ½åŠ¨æ‰‹å®è·µä¸€ä¸‹æˆ‘ç›¸ä¿¡ä½ ä½“éªŒæ›´å¥½ï¼Œå¼ºçƒˆæ¨èï¼)</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class Main &#123;\n\n\n    public static void main(String[] args) &#123; \n        learnStream();\n    &#125;\n\n    private static void learnStream() &#123;\n        &#x2F;&#x2F;é¦–å…ˆï¼Œåˆ›å»ºä¸€ä¸ª1-6ä¹±åºçš„List\n        List&lt;Integer&gt; lists &#x3D; new ArrayList&lt;&gt;();\n        lists.add(4);\n        lists.add(3);\n        lists.add(6);\n        lists.add(1);\n        lists.add(5);\n        lists.add(2);\n\n        &#x2F;&#x2F;çœ‹çœ‹Listé‡Œé¢çš„æ•°æ®æ˜¯ä»€ä¹ˆæ ·å­çš„å…ˆ\n        System.out.print(&quot;Listé‡Œé¢çš„æ•°æ®:&quot;);\n        for (Integer elem : lists) System.out.print(elem + &quot; &quot;);&#x2F;&#x2F; 4 3 6 1 5 2\n\n        System.out.println();\n\n        &#x2F;&#x2F;æœ€å°å€¼\n        System.out.print(&quot;Listä¸­æœ€å°çš„å€¼ä¸º:&quot;);\n        Stream&lt;Integer&gt; stream &#x3D; lists.stream();\n        Optional&lt;Integer&gt; min &#x3D; stream.min(Integer::compareTo);\n        if (min.isPresent()) &#123;\n            System.out.println(min.get());&#x2F;&#x2F;1\n        &#125;\n\n\n        &#x2F;&#x2F;æœ€å¤§å€¼\n        System.out.print(&quot;Listä¸­æœ€å¤§çš„å€¼ä¸º:&quot;);\n        lists.stream().max(Integer::compareTo).ifPresent(System.out::println);&#x2F;&#x2F;6\n\n        &#x2F;&#x2F;æ’åº\n        System.out.print(&quot;å°†Listæµè¿›è¡Œæ’åº:&quot;);\n        Stream&lt;Integer&gt; sorted &#x3D; lists.stream().sorted();\n        sorted.forEach(elem -&gt; System.out.print(elem + &quot; &quot;));&#x2F;&#x2F; 1 2 3 4 5 6\n\n        System.out.println();\n\n        &#x2F;&#x2F;è¿‡æ»¤\n        System.out.print(&quot;è¿‡æ»¤Listæµï¼Œåªå‰©ä¸‹é‚£äº›å¤§äº3çš„å…ƒç´ :&quot;);\n        lists.stream()\n                .filter(elem -&gt; elem &gt; 3)\n                .forEach(elem -&gt; System.out.print(elem + &quot; &quot;));&#x2F;&#x2F; 4 5 6\n\n        System.out.println();\n\n        &#x2F;&#x2F;è¿‡æ»¤\n        System.out.println(&quot;è¿‡æ»¤Listæµï¼Œåªå‰©ä¸‹é‚£äº›å¤§äº0å¹¶ä¸”å°äº4çš„å…ƒç´ :\\n&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;begin&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;);\n        lists.stream()\n                .filter(elem -&gt; elem &gt; 0)\n                .filter(elem -&gt; elem &lt; 4)\n                .sorted(Integer::compareTo)\n                .forEach(System.out::println);&#x2F;&#x2F; 1 2 3\n\n        System.out.println(&quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;end&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;);\n        &#x2F;&#x2F;ç»è¿‡äº†å‰é¢çš„è¿™ä¹ˆå¤šæµæ“ä½œï¼Œæˆ‘ä»¬å†æ¥çœ‹çœ‹Listé‡Œé¢çš„å€¼æœ‰æ²¡æœ‰å‘ç”Ÿä»€ä¹ˆæ”¹å˜\n        System.out.print(&quot;åŸListé‡Œé¢çš„æ•°æ®:&quot;);\n        for (Integer elem : lists) System.out.print(elem + &quot; &quot;);&#x2F;&#x2F; 4 3 6 1 5 2\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¦‚æœåˆšæ‰çš„Demoä½ è®¤çœŸè¯»äº†ï¼Œæˆ‘ç›¸ä¿¡ä½ å¿ƒé‡Œé¢å¤šå¤šå°‘å°‘éƒ½ä¼šäº§ç”Ÿä¸€ç‚¹ç‚¹æ¶Ÿæ¼ªï¼Œæ²¡é”™ï¼ŒæµAPIç»“åˆlambdaè¡¨è¾¾å¼ï¼Œå°±æ˜¯è¿™ä¹ˆä¼˜ç¾!ä¸‹é¢æˆ‘è¯¦ç»†ä»‹ç»ä¸€ä¸‹æ•´ä¸ªDemoï¼Œè®©å¤§å®¶æ›´åŠ æ¸…æ·…:</p>\n<h3 id=\"æœ€å°å€¼\"><a href=\"#æœ€å°å€¼\" class=\"headerlink\" title=\"æœ€å°å€¼\"></a>æœ€å°å€¼</h3><pre class=\"line-numbers language-none\"><code class=\"language-none\"> &#x2F;&#x2F;æœ€å°å€¼\nSystem.out.print(&quot;Listä¸­æœ€å°çš„å€¼ä¸º:&quot;);\nStream&lt;Integer&gt; stream &#x3D; lists.stream();\nOptional&lt;Integer&gt; min &#x3D; stream.min(Integer::compareTo);\nif (min.isPresent()) &#123;\n     System.out.println(min.get());&#x2F;&#x2F;1\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>é¦–å…ˆé€šè¿‡stream()æ–¹æ³•è·å–Listå¯¹åº”çš„æµï¼Œå¦‚æœä½ å¯¹Java8çš„é›†åˆæ¡†æ¶æœ‰ä¸€å®šçš„äº†è§£ï¼Œä½ åº”è¯¥çŸ¥é“stream()æ˜¯ç”±Collectionæ¥å£æä¾›çš„ã€‚ç„¶åå°±å¯ä»¥é€šè¿‡min()è·å–æµä¸­çš„æœ€å°å€¼äº†ï¼Œå½“ç„¶è¿™ä¸ªæµä¸­çš„æœ€å°å€¼è‚¯å®šä¹Ÿæ˜¯Listé‡Œé¢çš„æœ€å°å€¼ã€‚min()æ–¹æ³•æ¥æ”¶ä¸€ä¸ªComparatorç±»å‹çš„å‚æ•°ï¼Œè¿™ä¸ªæ¯”è¾ƒå™¨æ˜¯ç”¨äºæ¯”è¾ƒæµä¸­çš„ä¸¤ä¸ªå…ƒç´ çš„ã€‚æˆ‘ä»¬è¿™é‡ŒæŠŠIntegerçš„compareTo()çš„å¼•ç”¨ä¼ é€’ç»™äº†min()ã€‚å®ƒè¿”å›çš„ç±»å‹æ˜¯Optionalï¼ŒOptionalå¯è°“æ˜¯NullPointExceptionçš„å¤§æ€å™¨å•Šï¼Œæ„Ÿå…´è¶£çš„åŒå­¦ï¼Œäº†è§£ä¸€ä¸‹ã€‚ç„¶ååˆ¤æ–­æœ€å°å€¼å­˜ä¸å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨ï¼Œå°±é€šè¿‡Optionalçš„get()è¯»å–å‡ºæ¥ã€‚å¾ˆç®€å•æœ‰æœ¨æœ‰!</p>\n<h4 id=\"æœ€å¤§å€¼\"><a href=\"#æœ€å¤§å€¼\" class=\"headerlink\" title=\"æœ€å¤§å€¼\"></a>æœ€å¤§å€¼</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F;æœ€å¤§å€¼\nSystem.out.print(&quot;Listä¸­æœ€å¤§çš„å€¼ä¸º:&quot;);\nlists.stream().max(Integer::compareTo).ifPresent(System.out::println);&#x2F;&#x2F;6<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n<p>è¯­æ³•ç³–çˆ½YYæœ‰æœ¨æœ‰ï¼Œä¸è¿‡éœ€è¦æ³¨æ„çš„ä¸€ç‚¹ï¼Œå› ä¸ºmin()æ˜¯ä¸€ä¸ªç»ˆç«¯æ“ä½œï¼Œæ‰€ä»¥è¿™ä¸ªæµæ˜¯ä¸å¯ä»¥å†ç”¨äº†ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦é€šè¿‡stream()é‡æ–°ç”Ÿæˆä¸€ä¸ªæµï¼Œ(ä½†è¿™å…¶å®å¹¶ä¸å½±å“æˆ‘ä»¬çš„å®é™…ç”Ÿäº§çš„:â‘ æ–¹æ³•åŠŸèƒ½å•ä¸€åŸåˆ™â‘¡è¿˜æœ‰å…¶å®ƒå¾ˆå¤šå¾ˆå¼ºå¤§çš„æ–¹æ³•ç»„åˆèƒ½è®©ä½ å®ç°å„ç§åŠŸèƒ½å•Š.)ifPresentå…¶å®å’Œä¸Šé¢çš„æœ€å°å€¼çš„ifåˆ¤æ–­æ˜¯ä¸€å®šè¦ï¼Œå¦‚æœå­˜åœ¨æœ€å¤§å€¼ï¼Œæˆ‘ä»¬å°±æ‰“å°ä¸€ä¸‹ï¼Œè¿™é‡Œåªä¸è¿‡ç”¨äº†ä¸€äº›å‡½æ•°å¼å†™æ³•è€Œå·²ã€‚</p>\n<h4 id=\"æ’åºå’Œéå†\"><a href=\"#æ’åºå’Œéå†\" class=\"headerlink\" title=\"æ’åºå’Œéå†\"></a>æ’åºå’Œéå†</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\"> &#x2F;&#x2F;æ’åº\nSystem.out.print(&quot;å°†Listæµè¿›è¡Œæ’åº:&quot;);\nStream&lt;Integer&gt; sorted &#x3D; lists.stream().sorted();\nsorted.forEach(elem -&gt; System.out.print(elem + &quot; &quot;));&#x2F;&#x2F; 1 2 3 4 5 6<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<p>é€šè¿‡ä¸Šé¢çš„è®²è§£ï¼Œç›¸ä¿¡è¿™ä¸ªå·²ç»éš¾ä¸äº†ä½ äº†ï¼Œsorted()æ–¹æ³•æ˜¯ç”¨äºæ’åºçš„ï¼Œå®ƒçš„ä¸€ä¸ªé‡è½½æ–¹æ³•å¯ä»¥æ¥æ”¶ä¸€ä¸ªComparatorç±»å‹çš„å‚æ•°ï¼Œè®©ä½ è‡ªå®šä¹‰ä½ çš„æ’åºè§„åˆ™ã€‚forEachæ–¹æ³•å°±éå†ã€‚</p>\n<h4 id=\"è¿‡æ»¤\"><a href=\"#è¿‡æ»¤\" class=\"headerlink\" title=\"è¿‡æ»¤\"></a>è¿‡æ»¤</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F;è¿‡æ»¤\nSystem.out.println(&quot;è¿‡æ»¤Listæµï¼Œåªå‰©ä¸‹é‚£äº›å¤§äº0å¹¶ä¸”å°äº4çš„å…ƒç´ :\\n&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;begin&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;);\nlists.stream()\n          .filter(elem -&gt; elem &gt; 0)\n          .filter(elem -&gt; elem &lt; 4)\n          .sorted(Integer::compareTo)\n          .forEach(System.out::println);&#x2F;&#x2F; 1 2 3\n\nSystem.out.println(&quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;end&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>filter()æ˜¯åŸºäºä¸€ä¸ªè°“è¯è¿‡æ»¤æµï¼Œå®ƒè¿”å›ä¸€ä¸ªåªåŒ…å«æ»¡è¶³è°“è¯çš„å…ƒç´ çš„æ–°æµã€‚å®ƒçš„å‚æ•°å½¢å¼æ˜¯Predicate&lt;? super T&gt;æ˜¯åœ¨java.util.functionåŒ…ä¸‹çš„æ³›å‹å‡½æ•°å¼æ¥å£ã€‚å¹¶ä¸”filteræ˜¯ä¸€ä¸ªä¸­é—´æ“ä½œï¼Œè€Œä¸”è¿˜å¯ä»¥åŒæ—¶å­˜åœ¨å¤šä¸ªfilterã€‚è¿™é‡Œçš„ä¸¤ä¸ªè¿‡æ»¤å™¨ï¼Œæˆ‘ä»¬éƒ½ä¼ é€’äº†lambdaè¡¨è¾¾å¼ã€‚</p>\n<h4 id=\"å°ç»“ä¸€ä¸‹\"><a href=\"#å°ç»“ä¸€ä¸‹\" class=\"headerlink\" title=\"å°ç»“ä¸€ä¸‹\"></a>å°ç»“ä¸€ä¸‹</h4><p>å…¶å®åŸºæœ¬çš„æµAPIä½¿ç”¨å°±æ˜¯è¿™ä¹ˆç®€å•ï¼Œç»“åˆlambdaè¡¨è¾¾å¼åï¼Œä¸€åˆ‡éƒ½å˜å¾—ç‰¹åˆ«æ¸…æ·…ï¼Œè¿™ä¸ªç®€å•çš„Demoå±•ç¤ºäº†ä¸€äº›åŸºç¡€çš„åŠŸèƒ½ï¼Œå®ƒæˆ–è®¸å°±æ‰©å±•äº†ä½ æ“ä½œæ•°ç»„æˆ–è€…é›†åˆæ¡†æ¶çš„æ€è·¯ï¼Œè®©ä½ æ“ä½œé›†åˆå’Œæ•°ç»„ï¼Œå˜å¾—æ›´åŠ çš„å®¹æ˜“ï¼Œç®€å•å’Œé«˜æ•ˆã€‚å½“ç„¶æµAPIçš„çš„åŠŸèƒ½è‚¯å®šä¸æ­¢è¿™ä¸€ç‚¹ç‚¹ï¼Œæˆ‘ä¼šé™†é™†ç»­ç»­å®Œå–„æ•´ä¸ªç³»åˆ—ï¼Œå¤§å®¶è·Ÿç€æˆ‘çš„æ­¥ä¼ï¼Œå°±è¿™ä¸€æ¬¡ï¼Œè¸è¸å®å®å­¦å¥½æµå¼APIï¼Œèµ°å‘äººç”Ÿå·…å³°ï¼Œè¿å¨¶ç™½å¯Œç¾ï¼</p>\n"},{"title":"Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸‰ï¼‰ç¼©å‡æ“ä½œ","date":"2025-10-15T03:36:33.000Z","_content":"\nå’Œå‰é¢ä¸¤ç¯‡æ–‡ç« ä¸€èµ·æœç”¨ï¼Œæ•ˆæœä¼šæ›´ä½³ã€‚é€šè¿‡å¯¹æµAPIçš„åŸºç¡€ä½“éªŒDemoå’Œå…³é”®çŸ¥è¯†ç‚¹çš„è®²è§£ï¼Œç›¸ä¿¡å¤§å®¶å¯¹æµAPIéƒ½æœ‰ä¸€å®šçš„è®¤è¯†äº†ï¼Œä½†æ˜¯æµAPIå¼ºå¤§çš„åŠŸèƒ½ï¼Œå¯ä¸ä»…ä»…åƒå‰é¢ä¸¤ç¯‡æ–‡ç« ä¸­è¯´çš„é‚£æ ·ç®€å•ï¼Œå¤§å®¶åº”è¯¥æ³¨æ„åˆ°ï¼Œåœ¨ç¬¬äºŒç¯‡ä¸­ï¼Œæˆ‘å¯¹Streamæ¥å£è¿›è¡Œä»‹ç»çš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰æŠŠä»–çš„å…¨éƒ¨æ–¹æ³•éƒ½è¿›è¡Œäº†è§£æè¯´æ˜ã€‚æ²¡é”™ï¼Œä»è¿™ä¸€ç¯‡å¼€å§‹ï¼Œé‚£äº›è¿˜æ²¡æœ‰è®²è§£çš„æ–¹æ³•ï¼Œå¾ˆå¯èƒ½å°±å¼€å§‹å˜æˆæˆ‘ä»¬çš„ä¸»è§’äº†ï¼Œå¤§å®¶ä»é¢˜ç›®ä¸Šé¢åº”è¯¥çŸ¥é“äº†ï¼Œæœ¬æœŸæˆ‘ä»¬è¦è®²çš„æ˜¯æµAPIçš„ç¼©å‡æ“ä½œã€‚\n\n#### ä½•ä¸ºç¼©å‡æ“ä½œï¼Ÿ\n\næˆ‘ä»¬å…ˆè€ƒè™‘ä¸€ä¸‹min()å’Œmax()ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•æˆ‘ä»¬åœ¨ç¬¬ä¸€ç¯‡å’Œç¬¬äºŒç¯‡ä¸­å‡æœ‰æåˆ°ï¼Œå…¶ä¸­min()æ˜¯è¿”å›æµä¸­çš„æœ€å°å€¼ï¼Œè€Œmax()è¿”å›æµä¸­æœ€å¤§å€¼ï¼Œå‰ææ˜¯ä»–ä»¬å­˜åœ¨ã€‚ä»–ä»¬ä¹‹é—´çš„ç‰¹ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿâ‘ éƒ½è¿”å›äº†ä¸€ä¸ªå€¼â‘¡ç”±ä¸€å¯çŸ¥ï¼Œä»–ä»¬æ˜¯ç»ˆç«¯æ“ä½œã€‚å¦‚æœæˆ‘ä»¬ç”¨æµAPIçš„æœ¯è¯­æ¥å½¢å®¹å‰é¢è¿™ä¸¤ç§ç‰¹æ€§çš„ç»“åˆä½“çš„è¯ï¼Œå®ƒä»¬ä»£è¡¨äº†ç¼©å‡æ“ä½œã€‚å› ä¸ºæ¯ä¸ªç¼©å‡æ“ä½œéƒ½æŠŠä¸€ä¸ªæµç¼©å‡ä¸ºä¸€ä¸ªå€¼ï¼Œå¥½æ¯”æœ€å¤§å€¼ï¼Œæœ€å°å€¼ã€‚å½“ç„¶æµAPIï¼ŒæŠŠmin()å’Œmax()ï¼Œcount()è¿™äº›æ“ä½œç§°ä¸ºç‰¹ä¾‹ç¼©å‡ã€‚å³ç„¶è¯´åˆ°äº†ç‰¹ä¾‹ï¼Œè‚¯å®šå°±æœ‰æ³›åŒ–è¿™ç§æ¦‚å¿µäº†ï¼Œä»–å°±æ˜¯reduce()æ–¹æ³•äº†ï¼Œå…¶å®ç¬¬äºŒç¯‡å½“ä¸­ï¼Œä»–å·²ç»å‡ºç°è¿‡äº†ï¼Œåªæ˜¯å½“æ—¶æˆ‘æ²¡æœ‰å»å¼ºè°ƒä»–ã€‚\n```\npublic interface Stream<T> extends BaseStream<T, Stream<T>> {\n//ã€ã€ã€å¿½ç•¥å…¶ä»–æ— å…³ç´§è¦çš„å…ƒç´ \nT reduce(T identity, BinaryOperator<T> accumulator);\nOptional<T> reduce(BinaryOperator<T> accumulator);\n<U> U reduce(U identity,\n          BiFunction<U, ? super T, U> accumulator,\n          BinaryOperator<U> combiner);\nï½\n``` \nStreamæ¥å£å®šä¹‰äº†ä¸‰ä¸ªç‰ˆæœ¬çš„reduce()ï¼Œæˆ‘ä»¬å…ˆä½¿ç”¨å‰é¢ä¸¤ä¸ª,\n```\nT reduce(T identity, BinaryOperator<T> accumulator);//1\nOptional<T> reduce(BinaryOperator<T> accumulator);//2\n```\nç¬¬ä¸€ä¸ªç‰ˆæœ¬è¿”å›çš„æ˜¯ä¸€ä¸ªTç±»å‹çš„å¯¹è±¡ï¼ŒTä»£è¡¨çš„æ˜¯æµä¸­çš„å…ƒç´ ç±»å‹ï¼ç¬¬äºŒä¸ªç‰ˆæœ¬æ˜¯è¿”å›ä¸€ä¸ªOptionalç±»å‹å¯¹è±¡ã€‚å¯¹äºè¿™ä¸¤ç§å½¢å¼ï¼Œaccumulatoræ˜¯ä¸€ä¸ªæ“ä½œä¸¤ä¸ªå€¼å¹¶å¾—åˆ°ç»“æœçš„å‡½æ•°ã€‚åœ¨ç¬¬ä¸€ä¸ªç‰ˆæœ¬å½“ä¸­ï¼Œidentityæ˜¯è¿™æ ·ä¸€ä¸ªå€¼ï¼Œå¯¹äºæ¶‰åŠidentityå’Œæµä¸­ä»»æ„çš„ç´¯ç§¯æ“ä½œï¼Œå¾—åˆ°çš„ç»“æœå°±æ˜¯å…ƒç´ è‡ªèº«ï¼Œæ²¡æœ‰ä»»ä½•æ”¹å˜ã€‚æ¯”å¦‚ï¼Œå¦‚æœæ˜¯åŠ æ³•ï¼Œä»–å°±æ˜¯0ï¼Œå¦‚æœæ˜¯ä¹˜æ³•ä»–å°±æ˜¯1ã€‚\n\nå…¶ä¸­çš„accumulatoræ˜¯ä¸€ä¸ªBinaryOperator<T>çš„ç±»å‹ï¼Œä»–æ˜¯java.util.functionåŒ…ä¸­å£°æ˜çš„å‡½æ•°å¼æ¥å£ï¼Œå®ƒæ‰©å±•äº†BiFunctionå‡½æ•°å¼æ¥å£.\n\n```\n@FunctionalInterface\npublic interface BinaryOperator<T> extends BiFunction<T,T,T> {\n}\n\n@FunctionalInterface\npublic interface BiFunction<T, U, R> {\n   R apply(T t, U u);//notice\n}\n```\n\nBiFunctionæ¥å£ä¸­çš„apply()æ–¹æ³•çš„åŸå‹åœ¨*`//notice`*ã€‚å…¶ä¸­RæŒ‡å®šäº†ç»“æœçš„ç±»å‹ï¼ŒTï¼ŒUåˆ†åˆ«æ˜¯ç¬¬ä¸€å‚æ•°çš„ç±»å‹å’Œç¬¬äºŒä¸ªå‚æ•°çš„ç±»å‹ï¼Œå› æ­¤apply()å¯¹ä»–çš„ä¸¤ä¸ªæ“ä½œæ•°(t,u)åº”ç”¨åˆ°åŒä¸€ä¸ªå‡½æ•°ä¸Šï¼Œå¹¶è¿”å›ç»“æœï¼Œè€Œå¯¹BinaryOperator<T>æ¥è¯´ï¼Œä»–åœ¨æ‰©å±• BiFunctionæ—¶ï¼ŒæŒ‡å®šäº†æ‰€æœ‰çš„ç±»å‹å‚æ•°éƒ½æ˜¯ç›¸åŒçš„Tï¼Œå› æ­¤å¯¹äºBinaryOperator<T>å‡½æ•°å¼æ¥å£çš„applyæ¥è¯´ï¼Œä»–ä¹Ÿå°±å˜æˆäº†  T apply(T t, T u),æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼Œåœ¨åº”ç”¨reduce()æ—¶ï¼Œapply()çš„ç¬¬ä¸€ä¸ªå‚æ•°t,åŒ…å«çš„æ˜¯ä¸€ä¸ªç»“æœï¼ŒuåŒ…å«çš„æ˜¯ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶ï¼Œå°†å–å†³äºä½¿ç”¨reduce()çš„ç‰ˆæœ¬ï¼Œtå¯èƒ½æ˜¯å•ä½å€¼ï¼Œæˆ–è€…æ˜¯å‰ä¸€ä¸ªå…ƒç´ ã€‚\n\n#### ç¼©å‡æ“ä½œçš„ä¸‰ä¸ªçº¦æŸ\n\n* **æ— çŠ¶æ€**\n* **ä¸å¹²é¢„**\n* **å…³è”æ€§**\n\næ— çŠ¶æ€ï¼Œè¿™é‡Œå¯ä¸æ˜¯LOLçš„é‚£ä¸ªæ— çŠ¶æ€ï¼Œæ¯•ç«Ÿä»–é€€å½¹äº†ã€‚ç›¸ä¿¡è¯»è¿‡ç¬¬äºŒç¯‡æ–‡ç« çš„åŒå­¦å·²ç»å¾ˆå®¹æ˜“ç†è§£äº†ï¼Œç®€å•æ¥è¯´æ— çŠ¶æ€å°±æ˜¯æ¯ä¸ªå…ƒç´ éƒ½è¢«å•ç‹¬åœ°å¤„ç†ï¼Œä»–å’Œæµä¸­çš„å…¶å®ƒå…ƒç´ æ˜¯æ²¡æœ‰ä»»ä½•ä¾èµ–å…³ç³»çš„ã€‚ä¸å¹²é¢„æ˜¯æŒ‡æ“ä½œæ•°ä¸ä¼šæ”¹å˜æ•°æ®æºã€‚æœ€åï¼Œæ“ä½œå¿…é¡»å…·æœ‰å…³è”æ€§ï¼Œè¿™é‡Œçš„å…³è”æ€§æ˜¯æŒ‡æ ‡å‡†çš„æ•°å­¦å«ä¹‰ï¼Œå³ï¼Œç»™å®šä¸€ä¸ªå…³è”è¿ç®—ç¬¦ï¼Œåœ¨ä¸€ç³»åˆ—æ“ä½œä¸­ä½¿ç”¨è¯¥è¿ç®—ç¬¦ï¼Œå…ˆå¤„ç†å“ªä¸€å¯¹æ“ä½œæ•°æ˜¯æ— å…³ç´§è¦çš„ã€‚æ¯”å¦‚ï¼Œ(1 * 2) * 3  <===> 1 * (2 * 3)ã€‚`å…¶ä¸­å…³è”æ€§ï¼Œåœ¨å¹¶è¡Œæµä¸­ï¼Œæ˜¯è‡³å…³é‡è¦çš„ã€‚`ä¸‹é¢æˆ‘ç”¨ä¸€ä¸ªç®€å•çš„ä¾‹å­å¸¦ç€å¤§å®¶å®æˆ˜ä¸€ä¸‹æ³›åŒ–ç¼©å‡æ“ä½œreduce()çš„ä½¿ç”¨ã€‚\n\n```\npublic class Main {\n\n    public static void main(String[] args) {\n        learnStream();\n    }\n\n\n    private static void learnStream() {\n        List<Integer> lists = new ArrayList<>();\n        lists.add(1);\n        lists.add(2);\n        lists.add(3);\n        lists.add(4);\n        lists.add(5);\n        lists.add(6);\n\n        Optional<Integer> sum = lists.stream().reduce((a, b) -> a + b);\n        if (sum.isPresent()) System.out.println(\"listçš„æ€»å’Œä¸º:\" + sum.get());//21\n        //<====> lists.stream().reduce((a, b) -> a + b).ifPresent(System.out::println);\n\n        Integer sum2 = lists.stream().reduce(0, (a, b) -> a + b);//21\n        System.out.println(\"listçš„æ€»å’Œä¸º:\" + sum2);\n\n        Optional<Integer> product = lists.stream().reduce((a, b) -> a * b);\n        if (product.isPresent()) System.out.println(\"listçš„ç§¯ä¸º:\" + product.get());//720\n\n        Integer product2 = lists.stream().reduce(1, (a, b) -> a * b);\n        System.out.println(\"listçš„ç§¯ä¸º:\" + product2);//720\n    }\n}\n```\n\nè¿™ä¸ªDemoä¸»è¦æ˜¯è®¡ç®—äº†ä¸€ä¸ªlisté‡Œé¢çš„æ€»å’Œï¼Œç§¯çš„æ“ä½œï¼Œå¤§å®¶å¯ä»¥å’Œä¼ ç»Ÿçš„ç®—æ€»å’Œï¼Œç§¯çš„æ–¹æ³•è¿›è¡Œå¯¹ç…§ï¼Œæ¯”ä¸€æ¯”è¡¡é‡ä¸€ä¸‹å°±æœ‰è‡ªå·±çš„ç­”æ¡ˆäº†ã€‚ä½†æ˜¯å¦‚æœä½ ä»¥ä¸ºæµAPIä»…æ­¤è€Œå·²ï¼Œé‚£ä½ å°±é”™äº†ã€‚è¶Šæ˜¯åé¢çš„ä¸œè¥¿ï¼Œå°±è¶Šè£…Bï¼Œæˆ‘åœ¨åˆšçŸ¥é“ä»–ä»¬çš„æ—¶å€™ï¼Œåæ­£æ˜¯è¢«å“äº†ä¸€è·³çš„ï¼Œä½†è¿™äº›éƒ½æ˜¯åè¯äº†ï¼Œç°åœ¨æˆ‘ä»¬æ¥è¯¦è§£ä¸€ä¸‹Demo,å¹¶ç»™å‡ºæ‰©å±•çš„æ–¹å‘ï¼šæˆ‘ä»¬è¿™ä¸ªä¾‹å­ä¸»è¦æ˜¯ç”¨äº†lambdaè¡¨è¾¾å¼å¯¹listè¿›è¡Œäº†æ±‚å’Œï¼Œæ±‚ç§¯ï¼Œå¯¹äºç¬¬ä¸€ä¸ªç‰ˆæœ¬ä¸ºè¯´ï¼Œæ±‚å’Œçš„æ—¶å€™ï¼Œidentityçš„å€¼ä¸º0ï¼Œæ±‚ç§¯çš„æ—¶å€™å®ƒçš„å€¼ä¸º1ï¼Œå¼ºçƒˆå»ºè®®ä½ ä»¬è‡ªå·±æ„Ÿå—ä¸€ä¸‹identityçš„å˜åŒ–å¯¹æ•´ä¸ªç»“æœçš„å˜åŒ–äº§ç”Ÿä»€ä¹ˆ çš„å½±å“ï¼Œæ”¹å˜ä¸€ä¸‹identityçš„å€¼ï¼Œå†è¿è¡Œä¸€ä¸‹ï¼Œä½ å°±æœ‰ç»“æœäº†ï¼Œå¦ä¸€ä¸ªæ‰©å±•ç‚¹æ˜¯ï¼š\n\n```\n Integer product3 = lists.stream().reduce(1, (a, b) -> {\n            if (b % 2 == 0) return a * b; else return a;//è¿™é‡Œä½ å¯ä»¥ä¸ºæ‰€æ¬²ä¸º!\n });\n System.out.println(\"listçš„å¶æ•°çš„ç§¯ä¸º:\" + product3);//48\n```\n#### å°ç»“ä¸€ä¸‹\n\nå¯¹äºæµçš„ç¼©å‡æ“ä½œæ¥è¯´,ä¸»è¦è¦çŸ¥é“,ä»–åªè¿”å›ä¸€ä¸ªå€¼,å¹¶ä¸”å®ƒæ˜¯ä¸€ä¸ªç»ˆç«¯æ“ä½œ,ç„¶åè¿˜æœ‰çš„å°±æ˜¯è¦çŸ¥é“ç¼©å‡æ“ä½œçš„ä¸‰ä¸ªçº¦æŸäº†,å…¶å®æœ€é‡è¦çš„å°±æ˜¯æ— çŠ¶æ€æ€§å’Œå…³è”æ€§äº†.è¿™ä¸€å°èŠ‚è¦è¯´çš„,ä¹Ÿå°±è¿™ä¹ˆå¤šäº†,åº”è¯¥å¾ˆå®¹æ˜“å°±æŠŠä»–æ”¶åˆ°è‡ªå·±çš„æŠ€èƒ½æ ‘ä¸Šé¢äº†ã€‚\n","source":"_posts/æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸‰ï¼‰ç¼©å‡æ“ä½œ.md","raw":"---\ntitle: Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸‰ï¼‰ç¼©å‡æ“ä½œ\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: æ–°ç‰¹æ€§\n---\n\nå’Œå‰é¢ä¸¤ç¯‡æ–‡ç« ä¸€èµ·æœç”¨ï¼Œæ•ˆæœä¼šæ›´ä½³ã€‚é€šè¿‡å¯¹æµAPIçš„åŸºç¡€ä½“éªŒDemoå’Œå…³é”®çŸ¥è¯†ç‚¹çš„è®²è§£ï¼Œç›¸ä¿¡å¤§å®¶å¯¹æµAPIéƒ½æœ‰ä¸€å®šçš„è®¤è¯†äº†ï¼Œä½†æ˜¯æµAPIå¼ºå¤§çš„åŠŸèƒ½ï¼Œå¯ä¸ä»…ä»…åƒå‰é¢ä¸¤ç¯‡æ–‡ç« ä¸­è¯´çš„é‚£æ ·ç®€å•ï¼Œå¤§å®¶åº”è¯¥æ³¨æ„åˆ°ï¼Œåœ¨ç¬¬äºŒç¯‡ä¸­ï¼Œæˆ‘å¯¹Streamæ¥å£è¿›è¡Œä»‹ç»çš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰æŠŠä»–çš„å…¨éƒ¨æ–¹æ³•éƒ½è¿›è¡Œäº†è§£æè¯´æ˜ã€‚æ²¡é”™ï¼Œä»è¿™ä¸€ç¯‡å¼€å§‹ï¼Œé‚£äº›è¿˜æ²¡æœ‰è®²è§£çš„æ–¹æ³•ï¼Œå¾ˆå¯èƒ½å°±å¼€å§‹å˜æˆæˆ‘ä»¬çš„ä¸»è§’äº†ï¼Œå¤§å®¶ä»é¢˜ç›®ä¸Šé¢åº”è¯¥çŸ¥é“äº†ï¼Œæœ¬æœŸæˆ‘ä»¬è¦è®²çš„æ˜¯æµAPIçš„ç¼©å‡æ“ä½œã€‚\n\n#### ä½•ä¸ºç¼©å‡æ“ä½œï¼Ÿ\n\næˆ‘ä»¬å…ˆè€ƒè™‘ä¸€ä¸‹min()å’Œmax()ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•æˆ‘ä»¬åœ¨ç¬¬ä¸€ç¯‡å’Œç¬¬äºŒç¯‡ä¸­å‡æœ‰æåˆ°ï¼Œå…¶ä¸­min()æ˜¯è¿”å›æµä¸­çš„æœ€å°å€¼ï¼Œè€Œmax()è¿”å›æµä¸­æœ€å¤§å€¼ï¼Œå‰ææ˜¯ä»–ä»¬å­˜åœ¨ã€‚ä»–ä»¬ä¹‹é—´çš„ç‰¹ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿâ‘ éƒ½è¿”å›äº†ä¸€ä¸ªå€¼â‘¡ç”±ä¸€å¯çŸ¥ï¼Œä»–ä»¬æ˜¯ç»ˆç«¯æ“ä½œã€‚å¦‚æœæˆ‘ä»¬ç”¨æµAPIçš„æœ¯è¯­æ¥å½¢å®¹å‰é¢è¿™ä¸¤ç§ç‰¹æ€§çš„ç»“åˆä½“çš„è¯ï¼Œå®ƒä»¬ä»£è¡¨äº†ç¼©å‡æ“ä½œã€‚å› ä¸ºæ¯ä¸ªç¼©å‡æ“ä½œéƒ½æŠŠä¸€ä¸ªæµç¼©å‡ä¸ºä¸€ä¸ªå€¼ï¼Œå¥½æ¯”æœ€å¤§å€¼ï¼Œæœ€å°å€¼ã€‚å½“ç„¶æµAPIï¼ŒæŠŠmin()å’Œmax()ï¼Œcount()è¿™äº›æ“ä½œç§°ä¸ºç‰¹ä¾‹ç¼©å‡ã€‚å³ç„¶è¯´åˆ°äº†ç‰¹ä¾‹ï¼Œè‚¯å®šå°±æœ‰æ³›åŒ–è¿™ç§æ¦‚å¿µäº†ï¼Œä»–å°±æ˜¯reduce()æ–¹æ³•äº†ï¼Œå…¶å®ç¬¬äºŒç¯‡å½“ä¸­ï¼Œä»–å·²ç»å‡ºç°è¿‡äº†ï¼Œåªæ˜¯å½“æ—¶æˆ‘æ²¡æœ‰å»å¼ºè°ƒä»–ã€‚\n```\npublic interface Stream<T> extends BaseStream<T, Stream<T>> {\n//ã€ã€ã€å¿½ç•¥å…¶ä»–æ— å…³ç´§è¦çš„å…ƒç´ \nT reduce(T identity, BinaryOperator<T> accumulator);\nOptional<T> reduce(BinaryOperator<T> accumulator);\n<U> U reduce(U identity,\n          BiFunction<U, ? super T, U> accumulator,\n          BinaryOperator<U> combiner);\nï½\n``` \nStreamæ¥å£å®šä¹‰äº†ä¸‰ä¸ªç‰ˆæœ¬çš„reduce()ï¼Œæˆ‘ä»¬å…ˆä½¿ç”¨å‰é¢ä¸¤ä¸ª,\n```\nT reduce(T identity, BinaryOperator<T> accumulator);//1\nOptional<T> reduce(BinaryOperator<T> accumulator);//2\n```\nç¬¬ä¸€ä¸ªç‰ˆæœ¬è¿”å›çš„æ˜¯ä¸€ä¸ªTç±»å‹çš„å¯¹è±¡ï¼ŒTä»£è¡¨çš„æ˜¯æµä¸­çš„å…ƒç´ ç±»å‹ï¼ç¬¬äºŒä¸ªç‰ˆæœ¬æ˜¯è¿”å›ä¸€ä¸ªOptionalç±»å‹å¯¹è±¡ã€‚å¯¹äºè¿™ä¸¤ç§å½¢å¼ï¼Œaccumulatoræ˜¯ä¸€ä¸ªæ“ä½œä¸¤ä¸ªå€¼å¹¶å¾—åˆ°ç»“æœçš„å‡½æ•°ã€‚åœ¨ç¬¬ä¸€ä¸ªç‰ˆæœ¬å½“ä¸­ï¼Œidentityæ˜¯è¿™æ ·ä¸€ä¸ªå€¼ï¼Œå¯¹äºæ¶‰åŠidentityå’Œæµä¸­ä»»æ„çš„ç´¯ç§¯æ“ä½œï¼Œå¾—åˆ°çš„ç»“æœå°±æ˜¯å…ƒç´ è‡ªèº«ï¼Œæ²¡æœ‰ä»»ä½•æ”¹å˜ã€‚æ¯”å¦‚ï¼Œå¦‚æœæ˜¯åŠ æ³•ï¼Œä»–å°±æ˜¯0ï¼Œå¦‚æœæ˜¯ä¹˜æ³•ä»–å°±æ˜¯1ã€‚\n\nå…¶ä¸­çš„accumulatoræ˜¯ä¸€ä¸ªBinaryOperator<T>çš„ç±»å‹ï¼Œä»–æ˜¯java.util.functionåŒ…ä¸­å£°æ˜çš„å‡½æ•°å¼æ¥å£ï¼Œå®ƒæ‰©å±•äº†BiFunctionå‡½æ•°å¼æ¥å£.\n\n```\n@FunctionalInterface\npublic interface BinaryOperator<T> extends BiFunction<T,T,T> {\n}\n\n@FunctionalInterface\npublic interface BiFunction<T, U, R> {\n   R apply(T t, U u);//notice\n}\n```\n\nBiFunctionæ¥å£ä¸­çš„apply()æ–¹æ³•çš„åŸå‹åœ¨*`//notice`*ã€‚å…¶ä¸­RæŒ‡å®šäº†ç»“æœçš„ç±»å‹ï¼ŒTï¼ŒUåˆ†åˆ«æ˜¯ç¬¬ä¸€å‚æ•°çš„ç±»å‹å’Œç¬¬äºŒä¸ªå‚æ•°çš„ç±»å‹ï¼Œå› æ­¤apply()å¯¹ä»–çš„ä¸¤ä¸ªæ“ä½œæ•°(t,u)åº”ç”¨åˆ°åŒä¸€ä¸ªå‡½æ•°ä¸Šï¼Œå¹¶è¿”å›ç»“æœï¼Œè€Œå¯¹BinaryOperator<T>æ¥è¯´ï¼Œä»–åœ¨æ‰©å±• BiFunctionæ—¶ï¼ŒæŒ‡å®šäº†æ‰€æœ‰çš„ç±»å‹å‚æ•°éƒ½æ˜¯ç›¸åŒçš„Tï¼Œå› æ­¤å¯¹äºBinaryOperator<T>å‡½æ•°å¼æ¥å£çš„applyæ¥è¯´ï¼Œä»–ä¹Ÿå°±å˜æˆäº†  T apply(T t, T u),æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼Œåœ¨åº”ç”¨reduce()æ—¶ï¼Œapply()çš„ç¬¬ä¸€ä¸ªå‚æ•°t,åŒ…å«çš„æ˜¯ä¸€ä¸ªç»“æœï¼ŒuåŒ…å«çš„æ˜¯ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶ï¼Œå°†å–å†³äºä½¿ç”¨reduce()çš„ç‰ˆæœ¬ï¼Œtå¯èƒ½æ˜¯å•ä½å€¼ï¼Œæˆ–è€…æ˜¯å‰ä¸€ä¸ªå…ƒç´ ã€‚\n\n#### ç¼©å‡æ“ä½œçš„ä¸‰ä¸ªçº¦æŸ\n\n* **æ— çŠ¶æ€**\n* **ä¸å¹²é¢„**\n* **å…³è”æ€§**\n\næ— çŠ¶æ€ï¼Œè¿™é‡Œå¯ä¸æ˜¯LOLçš„é‚£ä¸ªæ— çŠ¶æ€ï¼Œæ¯•ç«Ÿä»–é€€å½¹äº†ã€‚ç›¸ä¿¡è¯»è¿‡ç¬¬äºŒç¯‡æ–‡ç« çš„åŒå­¦å·²ç»å¾ˆå®¹æ˜“ç†è§£äº†ï¼Œç®€å•æ¥è¯´æ— çŠ¶æ€å°±æ˜¯æ¯ä¸ªå…ƒç´ éƒ½è¢«å•ç‹¬åœ°å¤„ç†ï¼Œä»–å’Œæµä¸­çš„å…¶å®ƒå…ƒç´ æ˜¯æ²¡æœ‰ä»»ä½•ä¾èµ–å…³ç³»çš„ã€‚ä¸å¹²é¢„æ˜¯æŒ‡æ“ä½œæ•°ä¸ä¼šæ”¹å˜æ•°æ®æºã€‚æœ€åï¼Œæ“ä½œå¿…é¡»å…·æœ‰å…³è”æ€§ï¼Œè¿™é‡Œçš„å…³è”æ€§æ˜¯æŒ‡æ ‡å‡†çš„æ•°å­¦å«ä¹‰ï¼Œå³ï¼Œç»™å®šä¸€ä¸ªå…³è”è¿ç®—ç¬¦ï¼Œåœ¨ä¸€ç³»åˆ—æ“ä½œä¸­ä½¿ç”¨è¯¥è¿ç®—ç¬¦ï¼Œå…ˆå¤„ç†å“ªä¸€å¯¹æ“ä½œæ•°æ˜¯æ— å…³ç´§è¦çš„ã€‚æ¯”å¦‚ï¼Œ(1 * 2) * 3  <===> 1 * (2 * 3)ã€‚`å…¶ä¸­å…³è”æ€§ï¼Œåœ¨å¹¶è¡Œæµä¸­ï¼Œæ˜¯è‡³å…³é‡è¦çš„ã€‚`ä¸‹é¢æˆ‘ç”¨ä¸€ä¸ªç®€å•çš„ä¾‹å­å¸¦ç€å¤§å®¶å®æˆ˜ä¸€ä¸‹æ³›åŒ–ç¼©å‡æ“ä½œreduce()çš„ä½¿ç”¨ã€‚\n\n```\npublic class Main {\n\n    public static void main(String[] args) {\n        learnStream();\n    }\n\n\n    private static void learnStream() {\n        List<Integer> lists = new ArrayList<>();\n        lists.add(1);\n        lists.add(2);\n        lists.add(3);\n        lists.add(4);\n        lists.add(5);\n        lists.add(6);\n\n        Optional<Integer> sum = lists.stream().reduce((a, b) -> a + b);\n        if (sum.isPresent()) System.out.println(\"listçš„æ€»å’Œä¸º:\" + sum.get());//21\n        //<====> lists.stream().reduce((a, b) -> a + b).ifPresent(System.out::println);\n\n        Integer sum2 = lists.stream().reduce(0, (a, b) -> a + b);//21\n        System.out.println(\"listçš„æ€»å’Œä¸º:\" + sum2);\n\n        Optional<Integer> product = lists.stream().reduce((a, b) -> a * b);\n        if (product.isPresent()) System.out.println(\"listçš„ç§¯ä¸º:\" + product.get());//720\n\n        Integer product2 = lists.stream().reduce(1, (a, b) -> a * b);\n        System.out.println(\"listçš„ç§¯ä¸º:\" + product2);//720\n    }\n}\n```\n\nè¿™ä¸ªDemoä¸»è¦æ˜¯è®¡ç®—äº†ä¸€ä¸ªlisté‡Œé¢çš„æ€»å’Œï¼Œç§¯çš„æ“ä½œï¼Œå¤§å®¶å¯ä»¥å’Œä¼ ç»Ÿçš„ç®—æ€»å’Œï¼Œç§¯çš„æ–¹æ³•è¿›è¡Œå¯¹ç…§ï¼Œæ¯”ä¸€æ¯”è¡¡é‡ä¸€ä¸‹å°±æœ‰è‡ªå·±çš„ç­”æ¡ˆäº†ã€‚ä½†æ˜¯å¦‚æœä½ ä»¥ä¸ºæµAPIä»…æ­¤è€Œå·²ï¼Œé‚£ä½ å°±é”™äº†ã€‚è¶Šæ˜¯åé¢çš„ä¸œè¥¿ï¼Œå°±è¶Šè£…Bï¼Œæˆ‘åœ¨åˆšçŸ¥é“ä»–ä»¬çš„æ—¶å€™ï¼Œåæ­£æ˜¯è¢«å“äº†ä¸€è·³çš„ï¼Œä½†è¿™äº›éƒ½æ˜¯åè¯äº†ï¼Œç°åœ¨æˆ‘ä»¬æ¥è¯¦è§£ä¸€ä¸‹Demo,å¹¶ç»™å‡ºæ‰©å±•çš„æ–¹å‘ï¼šæˆ‘ä»¬è¿™ä¸ªä¾‹å­ä¸»è¦æ˜¯ç”¨äº†lambdaè¡¨è¾¾å¼å¯¹listè¿›è¡Œäº†æ±‚å’Œï¼Œæ±‚ç§¯ï¼Œå¯¹äºç¬¬ä¸€ä¸ªç‰ˆæœ¬ä¸ºè¯´ï¼Œæ±‚å’Œçš„æ—¶å€™ï¼Œidentityçš„å€¼ä¸º0ï¼Œæ±‚ç§¯çš„æ—¶å€™å®ƒçš„å€¼ä¸º1ï¼Œå¼ºçƒˆå»ºè®®ä½ ä»¬è‡ªå·±æ„Ÿå—ä¸€ä¸‹identityçš„å˜åŒ–å¯¹æ•´ä¸ªç»“æœçš„å˜åŒ–äº§ç”Ÿä»€ä¹ˆ çš„å½±å“ï¼Œæ”¹å˜ä¸€ä¸‹identityçš„å€¼ï¼Œå†è¿è¡Œä¸€ä¸‹ï¼Œä½ å°±æœ‰ç»“æœäº†ï¼Œå¦ä¸€ä¸ªæ‰©å±•ç‚¹æ˜¯ï¼š\n\n```\n Integer product3 = lists.stream().reduce(1, (a, b) -> {\n            if (b % 2 == 0) return a * b; else return a;//è¿™é‡Œä½ å¯ä»¥ä¸ºæ‰€æ¬²ä¸º!\n });\n System.out.println(\"listçš„å¶æ•°çš„ç§¯ä¸º:\" + product3);//48\n```\n#### å°ç»“ä¸€ä¸‹\n\nå¯¹äºæµçš„ç¼©å‡æ“ä½œæ¥è¯´,ä¸»è¦è¦çŸ¥é“,ä»–åªè¿”å›ä¸€ä¸ªå€¼,å¹¶ä¸”å®ƒæ˜¯ä¸€ä¸ªç»ˆç«¯æ“ä½œ,ç„¶åè¿˜æœ‰çš„å°±æ˜¯è¦çŸ¥é“ç¼©å‡æ“ä½œçš„ä¸‰ä¸ªçº¦æŸäº†,å…¶å®æœ€é‡è¦çš„å°±æ˜¯æ— çŠ¶æ€æ€§å’Œå…³è”æ€§äº†.è¿™ä¸€å°èŠ‚è¦è¯´çš„,ä¹Ÿå°±è¿™ä¹ˆå¤šäº†,åº”è¯¥å¾ˆå®¹æ˜“å°±æŠŠä»–æ”¶åˆ°è‡ªå·±çš„æŠ€èƒ½æ ‘ä¸Šé¢äº†ã€‚\n","slug":"æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆä¸‰ï¼‰ç¼©å‡æ“ä½œ","published":1,"updated":"2025-10-15T07:20:51.402Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu0779006oqkd418tq5mpd","content":"<p>å’Œå‰é¢ä¸¤ç¯‡æ–‡ç« ä¸€èµ·æœç”¨ï¼Œæ•ˆæœä¼šæ›´ä½³ã€‚é€šè¿‡å¯¹æµAPIçš„åŸºç¡€ä½“éªŒDemoå’Œå…³é”®çŸ¥è¯†ç‚¹çš„è®²è§£ï¼Œç›¸ä¿¡å¤§å®¶å¯¹æµAPIéƒ½æœ‰ä¸€å®šçš„è®¤è¯†äº†ï¼Œä½†æ˜¯æµAPIå¼ºå¤§çš„åŠŸèƒ½ï¼Œå¯ä¸ä»…ä»…åƒå‰é¢ä¸¤ç¯‡æ–‡ç« ä¸­è¯´çš„é‚£æ ·ç®€å•ï¼Œå¤§å®¶åº”è¯¥æ³¨æ„åˆ°ï¼Œåœ¨ç¬¬äºŒç¯‡ä¸­ï¼Œæˆ‘å¯¹Streamæ¥å£è¿›è¡Œä»‹ç»çš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰æŠŠä»–çš„å…¨éƒ¨æ–¹æ³•éƒ½è¿›è¡Œäº†è§£æè¯´æ˜ã€‚æ²¡é”™ï¼Œä»è¿™ä¸€ç¯‡å¼€å§‹ï¼Œé‚£äº›è¿˜æ²¡æœ‰è®²è§£çš„æ–¹æ³•ï¼Œå¾ˆå¯èƒ½å°±å¼€å§‹å˜æˆæˆ‘ä»¬çš„ä¸»è§’äº†ï¼Œå¤§å®¶ä»é¢˜ç›®ä¸Šé¢åº”è¯¥çŸ¥é“äº†ï¼Œæœ¬æœŸæˆ‘ä»¬è¦è®²çš„æ˜¯æµAPIçš„ç¼©å‡æ“ä½œã€‚</p>\n<h4 id=\"ä½•ä¸ºç¼©å‡æ“ä½œï¼Ÿ\"><a href=\"#ä½•ä¸ºç¼©å‡æ“ä½œï¼Ÿ\" class=\"headerlink\" title=\"ä½•ä¸ºç¼©å‡æ“ä½œï¼Ÿ\"></a>ä½•ä¸ºç¼©å‡æ“ä½œï¼Ÿ</h4><p>æˆ‘ä»¬å…ˆè€ƒè™‘ä¸€ä¸‹min()å’Œmax()ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•æˆ‘ä»¬åœ¨ç¬¬ä¸€ç¯‡å’Œç¬¬äºŒç¯‡ä¸­å‡æœ‰æåˆ°ï¼Œå…¶ä¸­min()æ˜¯è¿”å›æµä¸­çš„æœ€å°å€¼ï¼Œè€Œmax()è¿”å›æµä¸­æœ€å¤§å€¼ï¼Œå‰ææ˜¯ä»–ä»¬å­˜åœ¨ã€‚ä»–ä»¬ä¹‹é—´çš„ç‰¹ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿâ‘ éƒ½è¿”å›äº†ä¸€ä¸ªå€¼â‘¡ç”±ä¸€å¯çŸ¥ï¼Œä»–ä»¬æ˜¯ç»ˆç«¯æ“ä½œã€‚å¦‚æœæˆ‘ä»¬ç”¨æµAPIçš„æœ¯è¯­æ¥å½¢å®¹å‰é¢è¿™ä¸¤ç§ç‰¹æ€§çš„ç»“åˆä½“çš„è¯ï¼Œå®ƒä»¬ä»£è¡¨äº†ç¼©å‡æ“ä½œã€‚å› ä¸ºæ¯ä¸ªç¼©å‡æ“ä½œéƒ½æŠŠä¸€ä¸ªæµç¼©å‡ä¸ºä¸€ä¸ªå€¼ï¼Œå¥½æ¯”æœ€å¤§å€¼ï¼Œæœ€å°å€¼ã€‚å½“ç„¶æµAPIï¼ŒæŠŠmin()å’Œmax()ï¼Œcount()è¿™äº›æ“ä½œç§°ä¸ºç‰¹ä¾‹ç¼©å‡ã€‚å³ç„¶è¯´åˆ°äº†ç‰¹ä¾‹ï¼Œè‚¯å®šå°±æœ‰æ³›åŒ–è¿™ç§æ¦‚å¿µäº†ï¼Œä»–å°±æ˜¯reduce()æ–¹æ³•äº†ï¼Œå…¶å®ç¬¬äºŒç¯‡å½“ä¸­ï¼Œä»–å·²ç»å‡ºç°è¿‡äº†ï¼Œåªæ˜¯å½“æ—¶æˆ‘æ²¡æœ‰å»å¼ºè°ƒä»–ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public interface Stream&lt;T&gt; extends BaseStream&lt;T, Stream&lt;T&gt;&gt; &#123;\n&#x2F;&#x2F;ã€ã€ã€å¿½ç•¥å…¶ä»–æ— å…³ç´§è¦çš„å…ƒç´ \nT reduce(T identity, BinaryOperator&lt;T&gt; accumulator);\nOptional&lt;T&gt; reduce(BinaryOperator&lt;T&gt; accumulator);\n&lt;U&gt; U reduce(U identity,\n          BiFunction&lt;U, ? super T, U&gt; accumulator,\n          BinaryOperator&lt;U&gt; combiner);\nï½<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>Streamæ¥å£å®šä¹‰äº†ä¸‰ä¸ªç‰ˆæœ¬çš„reduce()ï¼Œæˆ‘ä»¬å…ˆä½¿ç”¨å‰é¢ä¸¤ä¸ª,</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">T reduce(T identity, BinaryOperator&lt;T&gt; accumulator);&#x2F;&#x2F;1\nOptional&lt;T&gt; reduce(BinaryOperator&lt;T&gt; accumulator);&#x2F;&#x2F;2<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>ç¬¬ä¸€ä¸ªç‰ˆæœ¬è¿”å›çš„æ˜¯ä¸€ä¸ªTç±»å‹çš„å¯¹è±¡ï¼ŒTä»£è¡¨çš„æ˜¯æµä¸­çš„å…ƒç´ ç±»å‹ï¼ç¬¬äºŒä¸ªç‰ˆæœ¬æ˜¯è¿”å›ä¸€ä¸ªOptionalç±»å‹å¯¹è±¡ã€‚å¯¹äºè¿™ä¸¤ç§å½¢å¼ï¼Œaccumulatoræ˜¯ä¸€ä¸ªæ“ä½œä¸¤ä¸ªå€¼å¹¶å¾—åˆ°ç»“æœçš„å‡½æ•°ã€‚åœ¨ç¬¬ä¸€ä¸ªç‰ˆæœ¬å½“ä¸­ï¼Œidentityæ˜¯è¿™æ ·ä¸€ä¸ªå€¼ï¼Œå¯¹äºæ¶‰åŠidentityå’Œæµä¸­ä»»æ„çš„ç´¯ç§¯æ“ä½œï¼Œå¾—åˆ°çš„ç»“æœå°±æ˜¯å…ƒç´ è‡ªèº«ï¼Œæ²¡æœ‰ä»»ä½•æ”¹å˜ã€‚æ¯”å¦‚ï¼Œå¦‚æœæ˜¯åŠ æ³•ï¼Œä»–å°±æ˜¯0ï¼Œå¦‚æœæ˜¯ä¹˜æ³•ä»–å°±æ˜¯1ã€‚</p>\n<p>å…¶ä¸­çš„accumulatoræ˜¯ä¸€ä¸ªBinaryOperator<T>çš„ç±»å‹ï¼Œä»–æ˜¯java.util.functionåŒ…ä¸­å£°æ˜çš„å‡½æ•°å¼æ¥å£ï¼Œå®ƒæ‰©å±•äº†BiFunctionå‡½æ•°å¼æ¥å£.</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@FunctionalInterface\npublic interface BinaryOperator&lt;T&gt; extends BiFunction&lt;T,T,T&gt; &#123;\n&#125;\n\n@FunctionalInterface\npublic interface BiFunction&lt;T, U, R&gt; &#123;\n   R apply(T t, U u);&#x2F;&#x2F;notice\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>BiFunctionæ¥å£ä¸­çš„apply()æ–¹æ³•çš„åŸå‹åœ¨*<code>//notice</code>*ã€‚å…¶ä¸­RæŒ‡å®šäº†ç»“æœçš„ç±»å‹ï¼ŒTï¼ŒUåˆ†åˆ«æ˜¯ç¬¬ä¸€å‚æ•°çš„ç±»å‹å’Œç¬¬äºŒä¸ªå‚æ•°çš„ç±»å‹ï¼Œå› æ­¤apply()å¯¹ä»–çš„ä¸¤ä¸ªæ“ä½œæ•°(t,u)åº”ç”¨åˆ°åŒä¸€ä¸ªå‡½æ•°ä¸Šï¼Œå¹¶è¿”å›ç»“æœï¼Œè€Œå¯¹BinaryOperator<T>æ¥è¯´ï¼Œä»–åœ¨æ‰©å±• BiFunctionæ—¶ï¼ŒæŒ‡å®šäº†æ‰€æœ‰çš„ç±»å‹å‚æ•°éƒ½æ˜¯ç›¸åŒçš„Tï¼Œå› æ­¤å¯¹äºBinaryOperator<T>å‡½æ•°å¼æ¥å£çš„applyæ¥è¯´ï¼Œä»–ä¹Ÿå°±å˜æˆäº†  T apply(T t, T u),æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼Œåœ¨åº”ç”¨reduce()æ—¶ï¼Œapply()çš„ç¬¬ä¸€ä¸ªå‚æ•°t,åŒ…å«çš„æ˜¯ä¸€ä¸ªç»“æœï¼ŒuåŒ…å«çš„æ˜¯ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶ï¼Œå°†å–å†³äºä½¿ç”¨reduce()çš„ç‰ˆæœ¬ï¼Œtå¯èƒ½æ˜¯å•ä½å€¼ï¼Œæˆ–è€…æ˜¯å‰ä¸€ä¸ªå…ƒç´ ã€‚</p>\n<h4 id=\"ç¼©å‡æ“ä½œçš„ä¸‰ä¸ªçº¦æŸ\"><a href=\"#ç¼©å‡æ“ä½œçš„ä¸‰ä¸ªçº¦æŸ\" class=\"headerlink\" title=\"ç¼©å‡æ“ä½œçš„ä¸‰ä¸ªçº¦æŸ\"></a>ç¼©å‡æ“ä½œçš„ä¸‰ä¸ªçº¦æŸ</h4><ul>\n<li><strong>æ— çŠ¶æ€</strong></li>\n<li><strong>ä¸å¹²é¢„</strong></li>\n<li><strong>å…³è”æ€§</strong></li>\n</ul>\n<p>æ— çŠ¶æ€ï¼Œè¿™é‡Œå¯ä¸æ˜¯LOLçš„é‚£ä¸ªæ— çŠ¶æ€ï¼Œæ¯•ç«Ÿä»–é€€å½¹äº†ã€‚ç›¸ä¿¡è¯»è¿‡ç¬¬äºŒç¯‡æ–‡ç« çš„åŒå­¦å·²ç»å¾ˆå®¹æ˜“ç†è§£äº†ï¼Œç®€å•æ¥è¯´æ— çŠ¶æ€å°±æ˜¯æ¯ä¸ªå…ƒç´ éƒ½è¢«å•ç‹¬åœ°å¤„ç†ï¼Œä»–å’Œæµä¸­çš„å…¶å®ƒå…ƒç´ æ˜¯æ²¡æœ‰ä»»ä½•ä¾èµ–å…³ç³»çš„ã€‚ä¸å¹²é¢„æ˜¯æŒ‡æ“ä½œæ•°ä¸ä¼šæ”¹å˜æ•°æ®æºã€‚æœ€åï¼Œæ“ä½œå¿…é¡»å…·æœ‰å…³è”æ€§ï¼Œè¿™é‡Œçš„å…³è”æ€§æ˜¯æŒ‡æ ‡å‡†çš„æ•°å­¦å«ä¹‰ï¼Œå³ï¼Œç»™å®šä¸€ä¸ªå…³è”è¿ç®—ç¬¦ï¼Œåœ¨ä¸€ç³»åˆ—æ“ä½œä¸­ä½¿ç”¨è¯¥è¿ç®—ç¬¦ï¼Œå…ˆå¤„ç†å“ªä¸€å¯¹æ“ä½œæ•°æ˜¯æ— å…³ç´§è¦çš„ã€‚æ¯”å¦‚ï¼Œ(1 * 2) * 3  &lt;&#x3D;&#x3D;&#x3D;&gt; 1 * (2 * 3)ã€‚<code>å…¶ä¸­å…³è”æ€§ï¼Œåœ¨å¹¶è¡Œæµä¸­ï¼Œæ˜¯è‡³å…³é‡è¦çš„ã€‚</code>ä¸‹é¢æˆ‘ç”¨ä¸€ä¸ªç®€å•çš„ä¾‹å­å¸¦ç€å¤§å®¶å®æˆ˜ä¸€ä¸‹æ³›åŒ–ç¼©å‡æ“ä½œreduce()çš„ä½¿ç”¨ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class Main &#123;\n\n    public static void main(String[] args) &#123;\n        learnStream();\n    &#125;\n\n\n    private static void learnStream() &#123;\n        List&lt;Integer&gt; lists &#x3D; new ArrayList&lt;&gt;();\n        lists.add(1);\n        lists.add(2);\n        lists.add(3);\n        lists.add(4);\n        lists.add(5);\n        lists.add(6);\n\n        Optional&lt;Integer&gt; sum &#x3D; lists.stream().reduce((a, b) -&gt; a + b);\n        if (sum.isPresent()) System.out.println(&quot;listçš„æ€»å’Œä¸º:&quot; + sum.get());&#x2F;&#x2F;21\n        &#x2F;&#x2F;&lt;&#x3D;&#x3D;&#x3D;&#x3D;&gt; lists.stream().reduce((a, b) -&gt; a + b).ifPresent(System.out::println);\n\n        Integer sum2 &#x3D; lists.stream().reduce(0, (a, b) -&gt; a + b);&#x2F;&#x2F;21\n        System.out.println(&quot;listçš„æ€»å’Œä¸º:&quot; + sum2);\n\n        Optional&lt;Integer&gt; product &#x3D; lists.stream().reduce((a, b) -&gt; a * b);\n        if (product.isPresent()) System.out.println(&quot;listçš„ç§¯ä¸º:&quot; + product.get());&#x2F;&#x2F;720\n\n        Integer product2 &#x3D; lists.stream().reduce(1, (a, b) -&gt; a * b);\n        System.out.println(&quot;listçš„ç§¯ä¸º:&quot; + product2);&#x2F;&#x2F;720\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªDemoä¸»è¦æ˜¯è®¡ç®—äº†ä¸€ä¸ªlisté‡Œé¢çš„æ€»å’Œï¼Œç§¯çš„æ“ä½œï¼Œå¤§å®¶å¯ä»¥å’Œä¼ ç»Ÿçš„ç®—æ€»å’Œï¼Œç§¯çš„æ–¹æ³•è¿›è¡Œå¯¹ç…§ï¼Œæ¯”ä¸€æ¯”è¡¡é‡ä¸€ä¸‹å°±æœ‰è‡ªå·±çš„ç­”æ¡ˆäº†ã€‚ä½†æ˜¯å¦‚æœä½ ä»¥ä¸ºæµAPIä»…æ­¤è€Œå·²ï¼Œé‚£ä½ å°±é”™äº†ã€‚è¶Šæ˜¯åé¢çš„ä¸œè¥¿ï¼Œå°±è¶Šè£…Bï¼Œæˆ‘åœ¨åˆšçŸ¥é“ä»–ä»¬çš„æ—¶å€™ï¼Œåæ­£æ˜¯è¢«å“äº†ä¸€è·³çš„ï¼Œä½†è¿™äº›éƒ½æ˜¯åè¯äº†ï¼Œç°åœ¨æˆ‘ä»¬æ¥è¯¦è§£ä¸€ä¸‹Demo,å¹¶ç»™å‡ºæ‰©å±•çš„æ–¹å‘ï¼šæˆ‘ä»¬è¿™ä¸ªä¾‹å­ä¸»è¦æ˜¯ç”¨äº†lambdaè¡¨è¾¾å¼å¯¹listè¿›è¡Œäº†æ±‚å’Œï¼Œæ±‚ç§¯ï¼Œå¯¹äºç¬¬ä¸€ä¸ªç‰ˆæœ¬ä¸ºè¯´ï¼Œæ±‚å’Œçš„æ—¶å€™ï¼Œidentityçš„å€¼ä¸º0ï¼Œæ±‚ç§¯çš„æ—¶å€™å®ƒçš„å€¼ä¸º1ï¼Œå¼ºçƒˆå»ºè®®ä½ ä»¬è‡ªå·±æ„Ÿå—ä¸€ä¸‹identityçš„å˜åŒ–å¯¹æ•´ä¸ªç»“æœçš„å˜åŒ–äº§ç”Ÿä»€ä¹ˆ çš„å½±å“ï¼Œæ”¹å˜ä¸€ä¸‹identityçš„å€¼ï¼Œå†è¿è¡Œä¸€ä¸‹ï¼Œä½ å°±æœ‰ç»“æœäº†ï¼Œå¦ä¸€ä¸ªæ‰©å±•ç‚¹æ˜¯ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Integer product3 &#x3D; lists.stream().reduce(1, (a, b) -&gt; &#123;\n           if (b % 2 &#x3D;&#x3D; 0) return a * b; else return a;&#x2F;&#x2F;è¿™é‡Œä½ å¯ä»¥ä¸ºæ‰€æ¬²ä¸º!\n&#125;);\nSystem.out.println(&quot;listçš„å¶æ•°çš„ç§¯ä¸º:&quot; + product3);&#x2F;&#x2F;48<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<h4 id=\"å°ç»“ä¸€ä¸‹\"><a href=\"#å°ç»“ä¸€ä¸‹\" class=\"headerlink\" title=\"å°ç»“ä¸€ä¸‹\"></a>å°ç»“ä¸€ä¸‹</h4><p>å¯¹äºæµçš„ç¼©å‡æ“ä½œæ¥è¯´,ä¸»è¦è¦çŸ¥é“,ä»–åªè¿”å›ä¸€ä¸ªå€¼,å¹¶ä¸”å®ƒæ˜¯ä¸€ä¸ªç»ˆç«¯æ“ä½œ,ç„¶åè¿˜æœ‰çš„å°±æ˜¯è¦çŸ¥é“ç¼©å‡æ“ä½œçš„ä¸‰ä¸ªçº¦æŸäº†,å…¶å®æœ€é‡è¦çš„å°±æ˜¯æ— çŠ¶æ€æ€§å’Œå…³è”æ€§äº†.è¿™ä¸€å°èŠ‚è¦è¯´çš„,ä¹Ÿå°±è¿™ä¹ˆå¤šäº†,åº”è¯¥å¾ˆå®¹æ˜“å°±æŠŠä»–æ”¶åˆ°è‡ªå·±çš„æŠ€èƒ½æ ‘ä¸Šé¢äº†ã€‚</p>\n","excerpt":"","more":"<p>å’Œå‰é¢ä¸¤ç¯‡æ–‡ç« ä¸€èµ·æœç”¨ï¼Œæ•ˆæœä¼šæ›´ä½³ã€‚é€šè¿‡å¯¹æµAPIçš„åŸºç¡€ä½“éªŒDemoå’Œå…³é”®çŸ¥è¯†ç‚¹çš„è®²è§£ï¼Œç›¸ä¿¡å¤§å®¶å¯¹æµAPIéƒ½æœ‰ä¸€å®šçš„è®¤è¯†äº†ï¼Œä½†æ˜¯æµAPIå¼ºå¤§çš„åŠŸèƒ½ï¼Œå¯ä¸ä»…ä»…åƒå‰é¢ä¸¤ç¯‡æ–‡ç« ä¸­è¯´çš„é‚£æ ·ç®€å•ï¼Œå¤§å®¶åº”è¯¥æ³¨æ„åˆ°ï¼Œåœ¨ç¬¬äºŒç¯‡ä¸­ï¼Œæˆ‘å¯¹Streamæ¥å£è¿›è¡Œä»‹ç»çš„æ—¶å€™ï¼Œå¹¶æ²¡æœ‰æŠŠä»–çš„å…¨éƒ¨æ–¹æ³•éƒ½è¿›è¡Œäº†è§£æè¯´æ˜ã€‚æ²¡é”™ï¼Œä»è¿™ä¸€ç¯‡å¼€å§‹ï¼Œé‚£äº›è¿˜æ²¡æœ‰è®²è§£çš„æ–¹æ³•ï¼Œå¾ˆå¯èƒ½å°±å¼€å§‹å˜æˆæˆ‘ä»¬çš„ä¸»è§’äº†ï¼Œå¤§å®¶ä»é¢˜ç›®ä¸Šé¢åº”è¯¥çŸ¥é“äº†ï¼Œæœ¬æœŸæˆ‘ä»¬è¦è®²çš„æ˜¯æµAPIçš„ç¼©å‡æ“ä½œã€‚</p>\n<h4 id=\"ä½•ä¸ºç¼©å‡æ“ä½œï¼Ÿ\"><a href=\"#ä½•ä¸ºç¼©å‡æ“ä½œï¼Ÿ\" class=\"headerlink\" title=\"ä½•ä¸ºç¼©å‡æ“ä½œï¼Ÿ\"></a>ä½•ä¸ºç¼©å‡æ“ä½œï¼Ÿ</h4><p>æˆ‘ä»¬å…ˆè€ƒè™‘ä¸€ä¸‹min()å’Œmax()ï¼Œè¿™ä¸¤ä¸ªæ–¹æ³•æˆ‘ä»¬åœ¨ç¬¬ä¸€ç¯‡å’Œç¬¬äºŒç¯‡ä¸­å‡æœ‰æåˆ°ï¼Œå…¶ä¸­min()æ˜¯è¿”å›æµä¸­çš„æœ€å°å€¼ï¼Œè€Œmax()è¿”å›æµä¸­æœ€å¤§å€¼ï¼Œå‰ææ˜¯ä»–ä»¬å­˜åœ¨ã€‚ä»–ä»¬ä¹‹é—´çš„ç‰¹ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿâ‘ éƒ½è¿”å›äº†ä¸€ä¸ªå€¼â‘¡ç”±ä¸€å¯çŸ¥ï¼Œä»–ä»¬æ˜¯ç»ˆç«¯æ“ä½œã€‚å¦‚æœæˆ‘ä»¬ç”¨æµAPIçš„æœ¯è¯­æ¥å½¢å®¹å‰é¢è¿™ä¸¤ç§ç‰¹æ€§çš„ç»“åˆä½“çš„è¯ï¼Œå®ƒä»¬ä»£è¡¨äº†ç¼©å‡æ“ä½œã€‚å› ä¸ºæ¯ä¸ªç¼©å‡æ“ä½œéƒ½æŠŠä¸€ä¸ªæµç¼©å‡ä¸ºä¸€ä¸ªå€¼ï¼Œå¥½æ¯”æœ€å¤§å€¼ï¼Œæœ€å°å€¼ã€‚å½“ç„¶æµAPIï¼ŒæŠŠmin()å’Œmax()ï¼Œcount()è¿™äº›æ“ä½œç§°ä¸ºç‰¹ä¾‹ç¼©å‡ã€‚å³ç„¶è¯´åˆ°äº†ç‰¹ä¾‹ï¼Œè‚¯å®šå°±æœ‰æ³›åŒ–è¿™ç§æ¦‚å¿µäº†ï¼Œä»–å°±æ˜¯reduce()æ–¹æ³•äº†ï¼Œå…¶å®ç¬¬äºŒç¯‡å½“ä¸­ï¼Œä»–å·²ç»å‡ºç°è¿‡äº†ï¼Œåªæ˜¯å½“æ—¶æˆ‘æ²¡æœ‰å»å¼ºè°ƒä»–ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public interface Stream&lt;T&gt; extends BaseStream&lt;T, Stream&lt;T&gt;&gt; &#123;\n&#x2F;&#x2F;ã€ã€ã€å¿½ç•¥å…¶ä»–æ— å…³ç´§è¦çš„å…ƒç´ \nT reduce(T identity, BinaryOperator&lt;T&gt; accumulator);\nOptional&lt;T&gt; reduce(BinaryOperator&lt;T&gt; accumulator);\n&lt;U&gt; U reduce(U identity,\n          BiFunction&lt;U, ? super T, U&gt; accumulator,\n          BinaryOperator&lt;U&gt; combiner);\nï½<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n<p>Streamæ¥å£å®šä¹‰äº†ä¸‰ä¸ªç‰ˆæœ¬çš„reduce()ï¼Œæˆ‘ä»¬å…ˆä½¿ç”¨å‰é¢ä¸¤ä¸ª,</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">T reduce(T identity, BinaryOperator&lt;T&gt; accumulator);&#x2F;&#x2F;1\nOptional&lt;T&gt; reduce(BinaryOperator&lt;T&gt; accumulator);&#x2F;&#x2F;2<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n<p>ç¬¬ä¸€ä¸ªç‰ˆæœ¬è¿”å›çš„æ˜¯ä¸€ä¸ªTç±»å‹çš„å¯¹è±¡ï¼ŒTä»£è¡¨çš„æ˜¯æµä¸­çš„å…ƒç´ ç±»å‹ï¼ç¬¬äºŒä¸ªç‰ˆæœ¬æ˜¯è¿”å›ä¸€ä¸ªOptionalç±»å‹å¯¹è±¡ã€‚å¯¹äºè¿™ä¸¤ç§å½¢å¼ï¼Œaccumulatoræ˜¯ä¸€ä¸ªæ“ä½œä¸¤ä¸ªå€¼å¹¶å¾—åˆ°ç»“æœçš„å‡½æ•°ã€‚åœ¨ç¬¬ä¸€ä¸ªç‰ˆæœ¬å½“ä¸­ï¼Œidentityæ˜¯è¿™æ ·ä¸€ä¸ªå€¼ï¼Œå¯¹äºæ¶‰åŠidentityå’Œæµä¸­ä»»æ„çš„ç´¯ç§¯æ“ä½œï¼Œå¾—åˆ°çš„ç»“æœå°±æ˜¯å…ƒç´ è‡ªèº«ï¼Œæ²¡æœ‰ä»»ä½•æ”¹å˜ã€‚æ¯”å¦‚ï¼Œå¦‚æœæ˜¯åŠ æ³•ï¼Œä»–å°±æ˜¯0ï¼Œå¦‚æœæ˜¯ä¹˜æ³•ä»–å°±æ˜¯1ã€‚</p>\n<p>å…¶ä¸­çš„accumulatoræ˜¯ä¸€ä¸ªBinaryOperator<T>çš„ç±»å‹ï¼Œä»–æ˜¯java.util.functionåŒ…ä¸­å£°æ˜çš„å‡½æ•°å¼æ¥å£ï¼Œå®ƒæ‰©å±•äº†BiFunctionå‡½æ•°å¼æ¥å£.</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@FunctionalInterface\npublic interface BinaryOperator&lt;T&gt; extends BiFunction&lt;T,T,T&gt; &#123;\n&#125;\n\n@FunctionalInterface\npublic interface BiFunction&lt;T, U, R&gt; &#123;\n   R apply(T t, U u);&#x2F;&#x2F;notice\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>BiFunctionæ¥å£ä¸­çš„apply()æ–¹æ³•çš„åŸå‹åœ¨*<code>//notice</code>*ã€‚å…¶ä¸­RæŒ‡å®šäº†ç»“æœçš„ç±»å‹ï¼ŒTï¼ŒUåˆ†åˆ«æ˜¯ç¬¬ä¸€å‚æ•°çš„ç±»å‹å’Œç¬¬äºŒä¸ªå‚æ•°çš„ç±»å‹ï¼Œå› æ­¤apply()å¯¹ä»–çš„ä¸¤ä¸ªæ“ä½œæ•°(t,u)åº”ç”¨åˆ°åŒä¸€ä¸ªå‡½æ•°ä¸Šï¼Œå¹¶è¿”å›ç»“æœï¼Œè€Œå¯¹BinaryOperator<T>æ¥è¯´ï¼Œä»–åœ¨æ‰©å±• BiFunctionæ—¶ï¼ŒæŒ‡å®šäº†æ‰€æœ‰çš„ç±»å‹å‚æ•°éƒ½æ˜¯ç›¸åŒçš„Tï¼Œå› æ­¤å¯¹äºBinaryOperator<T>å‡½æ•°å¼æ¥å£çš„applyæ¥è¯´ï¼Œä»–ä¹Ÿå°±å˜æˆäº†  T apply(T t, T u),æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯ï¼Œåœ¨åº”ç”¨reduce()æ—¶ï¼Œapply()çš„ç¬¬ä¸€ä¸ªå‚æ•°t,åŒ…å«çš„æ˜¯ä¸€ä¸ªç»“æœï¼ŒuåŒ…å«çš„æ˜¯ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚åœ¨ç¬¬ä¸€æ¬¡è°ƒç”¨æ—¶ï¼Œå°†å–å†³äºä½¿ç”¨reduce()çš„ç‰ˆæœ¬ï¼Œtå¯èƒ½æ˜¯å•ä½å€¼ï¼Œæˆ–è€…æ˜¯å‰ä¸€ä¸ªå…ƒç´ ã€‚</p>\n<h4 id=\"ç¼©å‡æ“ä½œçš„ä¸‰ä¸ªçº¦æŸ\"><a href=\"#ç¼©å‡æ“ä½œçš„ä¸‰ä¸ªçº¦æŸ\" class=\"headerlink\" title=\"ç¼©å‡æ“ä½œçš„ä¸‰ä¸ªçº¦æŸ\"></a>ç¼©å‡æ“ä½œçš„ä¸‰ä¸ªçº¦æŸ</h4><ul>\n<li><strong>æ— çŠ¶æ€</strong></li>\n<li><strong>ä¸å¹²é¢„</strong></li>\n<li><strong>å…³è”æ€§</strong></li>\n</ul>\n<p>æ— çŠ¶æ€ï¼Œè¿™é‡Œå¯ä¸æ˜¯LOLçš„é‚£ä¸ªæ— çŠ¶æ€ï¼Œæ¯•ç«Ÿä»–é€€å½¹äº†ã€‚ç›¸ä¿¡è¯»è¿‡ç¬¬äºŒç¯‡æ–‡ç« çš„åŒå­¦å·²ç»å¾ˆå®¹æ˜“ç†è§£äº†ï¼Œç®€å•æ¥è¯´æ— çŠ¶æ€å°±æ˜¯æ¯ä¸ªå…ƒç´ éƒ½è¢«å•ç‹¬åœ°å¤„ç†ï¼Œä»–å’Œæµä¸­çš„å…¶å®ƒå…ƒç´ æ˜¯æ²¡æœ‰ä»»ä½•ä¾èµ–å…³ç³»çš„ã€‚ä¸å¹²é¢„æ˜¯æŒ‡æ“ä½œæ•°ä¸ä¼šæ”¹å˜æ•°æ®æºã€‚æœ€åï¼Œæ“ä½œå¿…é¡»å…·æœ‰å…³è”æ€§ï¼Œè¿™é‡Œçš„å…³è”æ€§æ˜¯æŒ‡æ ‡å‡†çš„æ•°å­¦å«ä¹‰ï¼Œå³ï¼Œç»™å®šä¸€ä¸ªå…³è”è¿ç®—ç¬¦ï¼Œåœ¨ä¸€ç³»åˆ—æ“ä½œä¸­ä½¿ç”¨è¯¥è¿ç®—ç¬¦ï¼Œå…ˆå¤„ç†å“ªä¸€å¯¹æ“ä½œæ•°æ˜¯æ— å…³ç´§è¦çš„ã€‚æ¯”å¦‚ï¼Œ(1 * 2) * 3  &lt;&#x3D;&#x3D;&#x3D;&gt; 1 * (2 * 3)ã€‚<code>å…¶ä¸­å…³è”æ€§ï¼Œåœ¨å¹¶è¡Œæµä¸­ï¼Œæ˜¯è‡³å…³é‡è¦çš„ã€‚</code>ä¸‹é¢æˆ‘ç”¨ä¸€ä¸ªç®€å•çš„ä¾‹å­å¸¦ç€å¤§å®¶å®æˆ˜ä¸€ä¸‹æ³›åŒ–ç¼©å‡æ“ä½œreduce()çš„ä½¿ç”¨ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class Main &#123;\n\n    public static void main(String[] args) &#123;\n        learnStream();\n    &#125;\n\n\n    private static void learnStream() &#123;\n        List&lt;Integer&gt; lists &#x3D; new ArrayList&lt;&gt;();\n        lists.add(1);\n        lists.add(2);\n        lists.add(3);\n        lists.add(4);\n        lists.add(5);\n        lists.add(6);\n\n        Optional&lt;Integer&gt; sum &#x3D; lists.stream().reduce((a, b) -&gt; a + b);\n        if (sum.isPresent()) System.out.println(&quot;listçš„æ€»å’Œä¸º:&quot; + sum.get());&#x2F;&#x2F;21\n        &#x2F;&#x2F;&lt;&#x3D;&#x3D;&#x3D;&#x3D;&gt; lists.stream().reduce((a, b) -&gt; a + b).ifPresent(System.out::println);\n\n        Integer sum2 &#x3D; lists.stream().reduce(0, (a, b) -&gt; a + b);&#x2F;&#x2F;21\n        System.out.println(&quot;listçš„æ€»å’Œä¸º:&quot; + sum2);\n\n        Optional&lt;Integer&gt; product &#x3D; lists.stream().reduce((a, b) -&gt; a * b);\n        if (product.isPresent()) System.out.println(&quot;listçš„ç§¯ä¸º:&quot; + product.get());&#x2F;&#x2F;720\n\n        Integer product2 &#x3D; lists.stream().reduce(1, (a, b) -&gt; a * b);\n        System.out.println(&quot;listçš„ç§¯ä¸º:&quot; + product2);&#x2F;&#x2F;720\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¿™ä¸ªDemoä¸»è¦æ˜¯è®¡ç®—äº†ä¸€ä¸ªlisté‡Œé¢çš„æ€»å’Œï¼Œç§¯çš„æ“ä½œï¼Œå¤§å®¶å¯ä»¥å’Œä¼ ç»Ÿçš„ç®—æ€»å’Œï¼Œç§¯çš„æ–¹æ³•è¿›è¡Œå¯¹ç…§ï¼Œæ¯”ä¸€æ¯”è¡¡é‡ä¸€ä¸‹å°±æœ‰è‡ªå·±çš„ç­”æ¡ˆäº†ã€‚ä½†æ˜¯å¦‚æœä½ ä»¥ä¸ºæµAPIä»…æ­¤è€Œå·²ï¼Œé‚£ä½ å°±é”™äº†ã€‚è¶Šæ˜¯åé¢çš„ä¸œè¥¿ï¼Œå°±è¶Šè£…Bï¼Œæˆ‘åœ¨åˆšçŸ¥é“ä»–ä»¬çš„æ—¶å€™ï¼Œåæ­£æ˜¯è¢«å“äº†ä¸€è·³çš„ï¼Œä½†è¿™äº›éƒ½æ˜¯åè¯äº†ï¼Œç°åœ¨æˆ‘ä»¬æ¥è¯¦è§£ä¸€ä¸‹Demo,å¹¶ç»™å‡ºæ‰©å±•çš„æ–¹å‘ï¼šæˆ‘ä»¬è¿™ä¸ªä¾‹å­ä¸»è¦æ˜¯ç”¨äº†lambdaè¡¨è¾¾å¼å¯¹listè¿›è¡Œäº†æ±‚å’Œï¼Œæ±‚ç§¯ï¼Œå¯¹äºç¬¬ä¸€ä¸ªç‰ˆæœ¬ä¸ºè¯´ï¼Œæ±‚å’Œçš„æ—¶å€™ï¼Œidentityçš„å€¼ä¸º0ï¼Œæ±‚ç§¯çš„æ—¶å€™å®ƒçš„å€¼ä¸º1ï¼Œå¼ºçƒˆå»ºè®®ä½ ä»¬è‡ªå·±æ„Ÿå—ä¸€ä¸‹identityçš„å˜åŒ–å¯¹æ•´ä¸ªç»“æœçš„å˜åŒ–äº§ç”Ÿä»€ä¹ˆ çš„å½±å“ï¼Œæ”¹å˜ä¸€ä¸‹identityçš„å€¼ï¼Œå†è¿è¡Œä¸€ä¸‹ï¼Œä½ å°±æœ‰ç»“æœäº†ï¼Œå¦ä¸€ä¸ªæ‰©å±•ç‚¹æ˜¯ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">Integer product3 &#x3D; lists.stream().reduce(1, (a, b) -&gt; &#123;\n           if (b % 2 &#x3D;&#x3D; 0) return a * b; else return a;&#x2F;&#x2F;è¿™é‡Œä½ å¯ä»¥ä¸ºæ‰€æ¬²ä¸º!\n&#125;);\nSystem.out.println(&quot;listçš„å¶æ•°çš„ç§¯ä¸º:&quot; + product3);&#x2F;&#x2F;48<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<h4 id=\"å°ç»“ä¸€ä¸‹\"><a href=\"#å°ç»“ä¸€ä¸‹\" class=\"headerlink\" title=\"å°ç»“ä¸€ä¸‹\"></a>å°ç»“ä¸€ä¸‹</h4><p>å¯¹äºæµçš„ç¼©å‡æ“ä½œæ¥è¯´,ä¸»è¦è¦çŸ¥é“,ä»–åªè¿”å›ä¸€ä¸ªå€¼,å¹¶ä¸”å®ƒæ˜¯ä¸€ä¸ªç»ˆç«¯æ“ä½œ,ç„¶åè¿˜æœ‰çš„å°±æ˜¯è¦çŸ¥é“ç¼©å‡æ“ä½œçš„ä¸‰ä¸ªçº¦æŸäº†,å…¶å®æœ€é‡è¦çš„å°±æ˜¯æ— çŠ¶æ€æ€§å’Œå…³è”æ€§äº†.è¿™ä¸€å°èŠ‚è¦è¯´çš„,ä¹Ÿå°±è¿™ä¹ˆå¤šäº†,åº”è¯¥å¾ˆå®¹æ˜“å°±æŠŠä»–æ”¶åˆ°è‡ªå·±çš„æŠ€èƒ½æ ‘ä¸Šé¢äº†ã€‚</p>\n"},{"title":"Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆäºŒï¼‰å…³é”®çŸ¥è¯†ç‚¹","date":"2025-10-15T03:36:33.000Z","_content":"\næˆ‘ä»¬çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œä¸»è¦æ˜¯é€šè¿‡ä¸€ä¸ªDemoï¼Œè®©å¤§å®¶ä½“éªŒäº†ä¸€ä¸‹ä½¿ç”¨æµAPIçš„é‚£ç§é…£ç•…æ·‹æ¼“çš„æ„Ÿè§‰ã€‚å¦‚æœä½ æ²¡æœ‰å®è·µï¼Œæˆ‘è¿˜æ˜¯å†æ¬¡å‘¼åä½ åŠ¨æ‰‹æ•²ä¸€æ•²ï¼Œè‡ªå·±å®å®åœ¨è·‘ä¸€éä¸Šä¸€ç¯‡çš„Demoã€‚ç›¸ä¿¡ä½ çš„æ„Ÿå—å’Œç†è§£ä¹Ÿä¼šéšä¹‹åŠ æ·±çš„ã€‚ç»§ç»­æ¢ç´¢æµAPIçš„é«˜çº§åŠŸèƒ½ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆä»æ¥å£çº§åˆ«å…¨é¢äº†è§£ä¸€ä¸‹æµAPIï¼Œè¿™ä¸ªå¯¹äºæˆ‘ä»¬æ¥è¯´æ˜¯è‡³å…³é‡è¦çš„ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ç»™å¤§å®¶å‡†å¤‡äº†ä¸€å¼ æµAPIå…³é”®çŸ¥è¯†ç‚¹çš„UMLå›¾ã€‚ä½†æ˜¯å¤§å®¶åªéœ€è¦èŠ±ä¸€ä¸¤åˆ†é’Ÿï¼Œæ•´ç†çœ‹ä¸€ä¸‹å°±å¯ä»¥äº†ï¼Œä¸éœ€è¦è®°ä½ï¼Œå…ˆæœ‰ä¸ªå°è±¡ï¼Œåé¢æˆ‘ç»™å¤§å®¶è®²è§£ä¸€äº›å…³é”®çš„æ–¹æ³•:\n\n#### æµAPI UML\n\n![æµAPI UML](https://upload-images.jianshu.io/upload_images/1640787-129cbee787eef3b4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\næˆ‘å…ˆæ•´ä½“ä»‹ç»ä¸€ä¸‹:æµAPIå®šä¹‰çš„å‡ ä¸ªæ¥å£ï¼Œéƒ½æ˜¯åœ¨java.util.streamåŒ…ä¸­çš„.å…¶ä¸­ä¸Šå›¾ä¸­çš„BaseStreamæ¥å£æ˜¯æœ€åŸºç¡€çš„æ¥å£ï¼Œå®ƒæä¾›äº†æ‰€æœ‰æµéƒ½å¯ä»¥ä½¿ç”¨çš„åŸºæœ¬åŠŸèƒ½:\n\n```\npublic interface BaseStream<T, S extends BaseStream<T, S>> extends AutoCloseable {\n//....å…ˆå¿½ç•¥è¿™äº›å…·ä½“çš„ç»†èŠ‚\n}\n```\n\nç”±è¿™ä¸ªæ¥å£çš„å®šä¹‰æˆ‘ä»¬å¾—çŸ¥ï¼ŒBaseStreamæ˜¯ä¸€ä¸ªæ³›å‹æ¥å£,å®ƒæœ‰ä¸¤ä¸ªç±»å‹å‚æ•°Tå’ŒSï¼Œ å…¶ä¸­TæŒ‡å®šäº†æµä¸­çš„å…ƒç´ çš„ç±»å‹,å¹¶ä¸”ç”±<S extends BaseStream<T, S>>å¯ä»¥çŸ¥é“Så¿…é¡»ä¸ºBaseStreamæˆ–BaseStreamå­ç±»(æ¢å¥è¯è¯´,å°±æ˜¯Så¿…é¡»æ˜¯æ‰©å±•è‡ªBaseStreamçš„)ã€‚BaseStreamç»§æ‰¿äº†AutoCloseableæ¥å£ã€‚è¿™ä¸ªæ¥å£ä¸»è¦æ˜¯ç®€åŒ–äº†å…³é—­èµ„æºçš„æ“ä½œã€‚ä½†æ˜¯åƒå¹³æ—¶æˆ‘ä»¬æ“ä½œçš„é›†åˆæˆ–æ•°ç»„ï¼ŒåŸºæœ¬ä¸Šéƒ½ä¸ä¼šå‡ºç°å…³é—­æµçš„æƒ…å†µã€‚\n\n```\n//ç”±BaseStreamæ¥å£æ´¾ç”Ÿå‡ºçš„æµæ¥å£åŒ…æ‹¬IntStream ï¼ŒLongStreamï¼ŒDoubleStream ï¼ŒStream<T>\npublic interface IntStream extends BaseStream<Integer, IntStream> {\n}\npublic interface LongStream extends BaseStream<Long, LongStream> {\n}\npublic interface DoubleStream extends BaseStream<Double, DoubleStream> {\n}\n\n//è¿™æ˜¯æœ€å…·ä»£è¡¨æ€§çš„æ¥å£\npublic interface Stream<T> extends BaseStream<T, Stream<T>> {\n//....å…ˆå¿½ç•¥è¿™äº›å…·ä½“çš„ç»†èŠ‚\n}\n```\n\nç”±äºStreamæ¥å£æ˜¯æœ€å…·ä»£è¡¨æ€§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±é€‰æ‹©å®ƒæ¥è®²è§£ï¼Œå…¶å®åœ¨æˆ‘ä»¬å­¦å®ŒStreamæ¥å£ï¼Œå…¶å®ƒçš„ä¸‰ä¸ªæ¥å£ï¼Œåœ¨ä½¿ç”¨ä¸ŠåŸºæœ¬æ˜¯ä¸€è‡´çš„äº†ï¼Œæˆ‘ä»¬ä¸Šä¸€ç¯‡çš„DemoåŸºæœ¬ä¸Šä¹Ÿæ˜¯ä½¿ç”¨Streamæ¥å£æ¥åšçš„ç»ƒä¹ ã€‚æˆ‘ä»¬å›æƒ³ä¸€ä¸‹:åœ¨ä¸Šä¸€ä¸ªDemoä¸­æˆ‘ä»¬é€šè¿‡é›†åˆæ¡†æ¶çš„stream()æ–¹æ³•ï¼Œå°±èƒ½è¿”å›ä¸€ä¸ªæµäº†ï¼Œå®ƒçš„è¿”å›ç±»å‹å°±æ˜¯Stream<T>ï¼Œæ¯”å¦‚æˆ‘ä»¬Stream<Integer>ï¼Œç”±æ­¤å¾—çŸ¥ï¼ŒStreamæ¥å£é‡Œçš„ç±»å‹å‚æ•°Tå°±æ˜¯æµä¸­çš„å…ƒç´ çš„ç±»å‹ã€‚æœ¨æœ‰é”™ï¼Œå°±æ˜¯è¿™æ ·æ»´ã€‚åˆ°è¿™é‡Œï¼Œæ•´ä¸ªç³»åˆ—ä½ ä»¬å·²ç»å…¨éƒ¨å­¦ä¼šäº†ï¼Œä¸‹è¯¾ã€‚\n\n![](https://upload-images.jianshu.io/upload_images/1640787-cac539e2ac3e760f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\næˆ˜æ–—æ‰åˆšåˆšå¼€å§‹ï¼\n\n![](https://upload-images.jianshu.io/upload_images/1640787-65d8e79c87d2ec76.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\nç°åœ¨æ˜¯æ—¶å€™å¼€å§‹è®°å¿†ä¸€äº›çŸ¥è¯†äº†.\n\n#### BaseStreamè¯¦è§£:\n\n```\npublic interface BaseStream<T, S extends BaseStream<T, S>> extends AutoCloseable {\n     Iterator<T> iterator();//line2\n     Spliterator<T> spliterator();//line3\n     boolean isParallel();//line4\n     S sequential();//line5\n     S parallel();//line6\n     S unordered();//line7\n     S onClose(Runnable closeHandler);//line8\n     @Override\n     void close();//line10\n}\n```\n\n* **Iterator<T> iterator();**  *`//line2`*\nè·å¾—æµçš„è¿­ä»£å™¨ï¼Œå¹¶è¿”å›å¯¹è¯¥è¿­ä»£å™¨çš„å¼•ç”¨(ç»ˆç«¯æ“ä½œ)\n* **Spliterator<T> spliterator();** *`//line3`*\nè·å–æµçš„spliteratorï¼Œå¹¶è¿”å›å…¶å¼•ç”¨(ç»ˆç«¯æ“ä½œ)\n* **boolean isParallel();** *`//line4`*\nå¦‚æœè°ƒç”¨æµæ˜¯ä¸€ä¸ªå¹¶è¡Œæµï¼Œåˆ™è¿”å›true;å¦‚æœè°ƒç”¨æµæ˜¯ä¸€ä¸ªé¡ºåºæµï¼Œåˆ™è¿”å›falseã€‚\n* **S sequential();** *`//line5`*\nåŸºäºè°ƒç”¨æµï¼Œè¿”å›ä¸€ä¸ªé¡ºåºæµã€‚å¦‚æœè°ƒç”¨æµå·²ç»æ˜¯é¡ºåºæµäº†ï¼Œå°±è¿”å›è¯¥æµã€‚(ä¸­é—´æ“ä½œ)\n* **S parallel();** *`//line6`*\nåŸºäºè°ƒç”¨æµï¼Œè¿”å›ä¸€ä¸ªå¹¶è¡Œæµã€‚å¦‚æœè°ƒç”¨æµå·²ç»æ˜¯å¹¶è¡Œæµäº†ï¼Œå°±è¿”å›è¯¥æµã€‚(ä¸­é—´æ“ä½œ)\n* **S unordered();** *`//line7`*\nåŸºäºè°ƒç”¨æµï¼Œè¿”å›ä¸€ä¸ªæ— åºæµã€‚å¦‚æœè°ƒç”¨æµå·²ç»æ˜¯æ— åºæµäº†ï¼Œå°±è¿”å›è¯¥æµã€‚(ä¸­é—´æ“ä½œ)\n* **S onClose(Runnable closeHandler);** *`//line8`*\nè¿”å›ä¸€ä¸ªæ–°æµï¼ŒcloseHandleræŒ‡å®šäº†è¯¥æµçš„å…³é—­å¤„ç†ç¨‹åºï¼Œå½“å…³é—­è¯¥æµæ—¶ï¼Œå°†è°ƒç”¨è¿™ä¸ªå¤„ç†ç¨‹åºã€‚(ä¸­é—´æ“ä½œ)\n* **void close();** *`//line10`*\nä»AutoCloseableç»§æ‰¿æ¥çš„ï¼Œè°ƒç”¨æ³¨å†Œå…³é—­å¤„ç†ç¨‹åºï¼Œå…³é—­è°ƒç”¨æµ(å¾ˆå°‘ä¼šè¢«ä½¿ç”¨åˆ°)\n\n#### \"ç»ˆç«¯æ“ä½œ\"&\"ä¸­é—´æ“ä½œ\"\n\nç»†å¿ƒçš„åŒå­¦åº”è¯¥æ³¨æ„åˆ°äº†ï¼ŒBaseStreamæ¥å£é‡Œé¢çš„å¾ˆå¤šæ–¹æ³•éƒ½åœ¨æœ€åæ ‡è¯†äº†(ç»ˆç«¯æ“ä½œ)å’Œ(ä¸­é—´æ“ä½œ)ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯éå¸¸é‡è¦çš„ã€‚\n* **ç»ˆç«¯æ“ä½œ**   ä¼šæ¶ˆè´¹æµï¼Œè¿™ç§æ“ä½œä¼šäº§ç”Ÿä¸€ä¸ªç»“æœçš„ï¼Œæ¯”å¦‚ä¸Šé¢çš„ iterator()å’Œ spliterator()ï¼Œä»¥åŠä¸Šä¸€ç¯‡ä¸­æåˆ°çš„min()å’Œmax()ï¼Œæˆ–è€…æ˜¯æ‰§è¡ŒæŸä¸€ç§æ“ä½œï¼Œæ¯”å¦‚ä¸Šä¸€ç¯‡çš„forEach()ï¼Œå¦‚æœä¸€ä¸ªæµè¢«æ¶ˆè´¹è¿‡äº†ï¼Œé‚£å®ƒå°±ä¸èƒ½è¢«é‡ç”¨çš„ã€‚\n\n* **ä¸­é—´æ“ä½œ**   ä¸­é—´æ“ä½œä¼šäº§ç”Ÿå¦ä¸€ä¸ªæµã€‚å› æ­¤ä¸­é—´æ“ä½œå¯ä»¥ç”¨æ¥åˆ›å»ºæ‰§è¡Œä¸€ç³»åˆ—åŠ¨ä½œçš„ç®¡é“ã€‚ä¸€ä¸ªç‰¹åˆ«éœ€è¦æ³¨æ„çš„ç‚¹æ˜¯:ä¸­é—´æ“ä½œä¸æ˜¯ç«‹å³å‘ç”Ÿçš„ã€‚ç›¸åï¼Œå½“åœ¨ä¸­é—´æ“ä½œåˆ›å»ºçš„æ–°æµä¸Šæ‰§è¡Œå®Œç»ˆç«¯æ“ä½œåï¼Œä¸­é—´æ“ä½œæŒ‡å®šçš„æ“ä½œæ‰ä¼šå‘ç”Ÿã€‚æ‰€ä»¥ä¸­é—´æ“ä½œæ˜¯å»¶è¿Ÿå‘ç”Ÿçš„ï¼Œä¸­é—´æ“ä½œçš„å»¶è¿Ÿè¡Œä¸ºä¸»è¦æ˜¯è®©æµAPIèƒ½å¤Ÿæ›´åŠ é«˜æ•ˆåœ°æ‰§è¡Œã€‚\n\n#### \"ä¸­é—´æ“ä½œ\"çš„çŠ¶æ€\n\næµçš„ä¸­é—´æ“ä½œï¼Œå¯ä»¥ä¸ºåˆ†`æ— çŠ¶æ€æ“ä½œ`å’Œ`æœ‰çŠ¶æ€æ“ä½œ`ä¸¤ç§ï¼Œåœ¨æ— çŠ¶æ€æ“ä½œä¸­ï¼Œåœ¨å¤„ç†æµä¸­çš„å…ƒç´ æ—¶ï¼Œä¼šå¯¹å½“å‰çš„å…ƒç´ è¿›è¡Œå•ç‹¬å¤„ç†ã€‚æ¯”å¦‚:è°“è¯è¿‡æ»¤æ“ä½œï¼Œå› ä¸ºæ¯ä¸ªå…ƒç´ éƒ½æ˜¯è¢«å•ç‹¬è¿›è¡Œå¤„ç†çš„ï¼Œæ‰€æœ‰å®ƒå’Œæµä¸­çš„å…¶å®ƒå…ƒç´ æ— å…³ï¼Œå› æ­¤è¢«ç§°ä¸ºæ— çŠ¶æ€æ“ä½œ;è€Œåœ¨æœ‰çŠ¶æ€æ“ä½œä¸­ï¼ŒæŸä¸ªå…ƒç´ çš„å¤„ç†å¯èƒ½ä¾èµ–äºå…¶ä»–å…ƒç´ ã€‚æ¯”å¦‚æŸ¥æ‰¾æœ€å°å€¼ï¼Œæœ€å¤§å€¼ï¼Œå’Œæ’åºï¼Œå› ä¸ºä»–ä»¬éƒ½ä¾èµ–äºå…¶ä»–çš„å…ƒç´ ã€‚å› æ­¤ä¸ºç§°ä¸ºæœ‰çŠ¶æ€æ“ä½œã€‚`å½“éœ€è¦è¿›è¡Œå¹¶è¡Œå¤„ç†æµæ—¶ï¼Œæœ‰çŠ¶æ€çš„æ“ä½œå’Œæ— çŠ¶æ€çš„åŒºåˆ«æ˜¯éå¸¸é‡è¦çš„ï¼Œå› ä¸ºæœ‰çŠ¶æ€æ“ä½œå¯èƒ½éœ€è¦å‡ æ¬¡å¤„ç†æ‰èƒ½å®Œæˆï¼Œåé¢çš„æ–‡ç« æˆ‘å°†ä¼šç»™å¤§å®¶è¯¦ç»†åœ°è®²ï¼Œç°åœ¨åªéœ€è¦æ­£å¸¸å­¦ä¹ ä¸‹å»å°±å¯ä»¥äº†`\n\nå¦å¤–ï¼ŒæŒ‡å‡ºä¸€ç‚¹ï¼Œå¦‚æœå¤§å®¶äº†è§£æ³›å‹çš„è¯ï¼Œåº”è¯¥çŸ¥é“ï¼Œæ³›å‹çš„ç±»å‹å‚æ•°åªèƒ½æ˜¯å¼•ç”¨ç±»å‹ï¼Œå› æ­¤Streamæ“ä½œçš„å¯¹è±¡åªèƒ½æ˜¯å¼•ç”¨ç±»å‹çš„ï¼Œä¸èƒ½ç”¨äºåŸºæœ¬ç±»å‹ã€‚å½“ç„¶å®˜æ–¹æ—©å·²è€ƒè™‘åˆ°è¿™ä¸€ç‚¹äº†ï¼Œå‰é¢ä½ ä»¬çœ‹åˆ°çš„IntStreamï¼ŒLongStreamï¼ŒDoubleStreamå°±æ˜¯å®˜æ–¹ç»™æˆ‘ä»¬æä¾›çš„å¤„ç†åŸºæœ¬ç±»å‹çš„æµäº†ã€‚æ­¤å¤„æ˜¯ä¸æ˜¯åº”è¯¥ç»™ä»–ä»¬æŒå£°ï¼\n\n#### Streamè¯¦è§£\n\nåœ¨æœ‰äº†å‰é¢çš„é‚£äº›çŸ¥è¯†ä½œé“ºå«ä¹‹åï¼Œå­¦Streamæ¥å£åº”è¯¥ä¼šé¡ºé£é¡ºæ°´äº†ã€‚è¿˜æ˜¯å…ˆçœ‹çœ‹Streamçš„è¯¦æƒ…å…ˆ:\n\n```\npublic interface Stream<T> extends BaseStream<T, Stream<T>> {\n    Stream<T> filter(Predicate<? super T> predicate);//line2\n    <R> Stream<R> map(Function<? super T, ? extends R> mapper);//line3\n    IntStream mapToInt(ToIntFunction<? super T> mapper);//line4\n    LongStream mapToLong(ToLongFunction<? super T> mapper);\n    DoubleStream mapToDouble(ToDoubleFunction<? super T> mapper);\n    <R> Stream<R> flatMap(Function<? super T, ? extends Stream<? extends R>> mapper);\n    IntStream flatMapToInt(Function<? super T, ? extends IntStream> mapper);\n    LongStream flatMapToLong(Function<? super T, ? extends LongStream> mapper);\n    DoubleStream flatMapToDouble(Function<? super T, ? extends DoubleStream> mapper);\n    Stream<T> distinct();\n    Stream<T> sorted();//line12\n    Stream<T> sorted(Comparator<? super T> comparator);//line13\n    Stream<T> peek(Consumer<? super T> action);\n    Stream<T> limit(long maxSize);\n    Stream<T> skip(long n);\n    void forEach(Consumer<? super T> action);//line17\n    void forEachOrdered(Consumer<? super T> action);//line18\n    Object[] toArray();\n    <A> A[] toArray(IntFunction<A[]> generator);\n    T reduce(T identity, BinaryOperator<T> accumulator);\n    Optional<T> reduce(BinaryOperator<T> accumulator);\n    <U> U reduce(U identity,\n                 BiFunction<U, ? super T, U> accumulator,\n                 BinaryOperator<U> combiner);\n    <R> R collect(Supplier<R> supplier,\n                  BiConsumer<R, ? super T> accumulator,\n                  BiConsumer<R, R> combiner);\n    <R, A> R collect(Collector<? super T, A, R> collector);\n    Optional<T> min(Comparator<? super T> comparator);//line30\n    Optional<T> max(Comparator<? super T> comparator);//line31\n    long count();\n    boolean anyMatch(Predicate<? super T> predicate);\n    boolean allMatch(Predicate<? super T> predicate);\n    boolean noneMatch(Predicate<? super T> predicate);\n    Optional<T> findFirst();\n    Optional<T> findAny();\n\n    // Static factories\n\n    public static<T> Builder<T> builder() {\n        return new Streams.StreamBuilderImpl<>();\n    }\n\n\n    public static<T> Stream<T> empty() {\n        return StreamSupport.stream(Spliterators.<T>emptySpliterator(), false);\n    }\n\n\n    public static<T> Stream<T> of(T t) {\n        return StreamSupport.stream(new Streams.StreamBuilderImpl<>(t), false);\n    }\n\n\n    @SafeVarargs\n    @SuppressWarnings(\"varargs\") // Creating a stream from an array is safe\n    public static<T> Stream<T> of(T... values) {\n        return Arrays.stream(values);\n    }\n\n\n    public static<T> Stream<T> iterate(final T seed, final UnaryOperator<T> f) {\n        Objects.requireNonNull(f);\n        final Iterator<T> iterator = new Iterator<T>() {\n            @SuppressWarnings(\"unchecked\")\n            T t = (T) Streams.NONE;\n\n            @Override\n            public boolean hasNext() {\n                return true;\n            }\n\n            @Override\n            public T next() {\n                return t = (t == Streams.NONE) ? seed : f.apply(t);\n            }\n        };\n        return StreamSupport.stream(Spliterators.spliteratorUnknownSize(\n                iterator,\n                Spliterator.ORDERED | Spliterator.IMMUTABLE), false);\n    }\n\n\n    public static<T> Stream<T> generate(Supplier<T> s) {\n        Objects.requireNonNull(s);\n        return StreamSupport.stream(\n                new StreamSpliterators.InfiniteSupplyingSpliterator.OfRef<>(Long.MAX_VALUE, s), false);\n    }\n\n\n    public static <T> Stream<T> concat(Stream<? extends T> a, Stream<? extends T> b) {\n        Objects.requireNonNull(a);\n        Objects.requireNonNull(b);\n\n        @SuppressWarnings(\"unchecked\")\n        Spliterator<T> split = new Streams.ConcatSpliterator.OfRef<>(\n                (Spliterator<T>) a.spliterator(), (Spliterator<T>) b.spliterator());\n        Stream<T> stream = StreamSupport.stream(split, a.isParallel() || b.isParallel());\n        return stream.onClose(Streams.composedClose(a, b));\n    }\n}\n```\n\n* **Stream<T> filter(Predicate<? super T> predicate);**  *`//line2`*\näº§ç”Ÿä¸€ä¸ªæ–°æµï¼Œå…¶ä¸­åŒ…å«è°ƒç”¨æµä¸­æ»¡è¶³predicateæŒ‡å®šçš„è°“è¯å…ƒç´ (ä¸­é—´æ“ä½œ)\n* **<R> Stream<R> map(Function<? super T, ? extends R> mapper);**  *`//line3`*\näº§ç”Ÿä¸€ä¸ªæ–°æµï¼Œå¯¹è°ƒç”¨æµä¸­çš„å…ƒç´ åº”ç”¨mapperï¼Œæ–°æµä¸­åŒ…å«è¿™äº›å…ƒç´ ã€‚(ä¸­é—´æ“ä½œ)\n* **IntStream mapToInt(ToIntFunction<? super T> mapper);** *`//line4`*\nå¯¹è°ƒç”¨æµä¸­å…ƒç´ åº”ç”¨mapperï¼Œäº§ç”ŸåŒ…å«è¿™äº›å…ƒç´ çš„ä¸€ä¸ªæ–°IntStreamæµã€‚(ä¸­é—´æ“ä½œ)\n* **Stream<T> sorted();** *`//line12`*\n* **Stream<T> sorted(Comparator<? super T> comparator);** *`//line13`*`\näº§ç”Ÿä¸€ä¸ªè‡ªç„¶é¡ºåºæ’åºæˆ–è€…æŒ‡å®šæ’åºæ¡ä»¶çš„æ–°æµ(ä¸­é—´æ“ä½œ)\n* **void forEach(Consumer<? super T> action);**  *`//line17`*\n* **void forEachOrdered(Consumer<? super T> action);** *`//line18`*\néå†äº†æµä¸­çš„å…ƒç´ (ç»ˆç«¯æ“ä½œ)\n* **Optional<T> min(Comparator<? super T> comparator)**  *`//line30`*\n* **Optional<T> max(Comparator<? super T> comparator);** *`//line31`*\nè·å¾—æµä¸­æœ€å¤§æœ€å°å€¼ï¼Œæ¯”è¾ƒå™¨å¯ä»¥ç”±è‡ªå·±å®šä¹‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨JDKæä¾›çš„(ç»ˆç«¯æ“ä½œ)\n\n#### å°ç»“ä¸€ä¸‹\n\nè¿™ä¸€ç¯‡ä¸»è¦æ˜¯ä»‹ç»äº†æµAPIçš„ä¸€äº›å…³é”®æ–¹æ³•ï¼Œå’Œä¸€äº›å…³é”®çš„æ¦‚å¿µï¼Œè™½ç„¶ç¨å¾®æ¯ç‡¥äº†ä¸€ç‚¹ï¼Œä½†æ˜¯ï¼Œä¸èƒ½å¦è®¤ï¼Œå…¨é¢åœ°å­¦ä¹ æµAPIï¼Œä¼šè®©ä½ å¯¹æµAPIçš„è®¤è¯†ä¼šæ›´åŠ çš„æ·±åˆ»ï¼Œæ‰€ä»¥å¦‚æœæ—¶é—´å…è®¸ï¼Œè¯·å†è®¤çœŸè¯»è¯»è¿™ä¸€ç¯‡æ–‡ç« å§ï¼Œå½“ç„¶ï¼Œä¹Ÿå¯ä»¥åœ¨å®è·µä¸­æ…¢æ…¢è®¤è¯†å®ƒä»¬ï¼Œä½†æ˜¯ï¼Œå¯¹äºè¿™äº›åŸºæœ¬æ¦‚å¿µçš„çŸ¥è¯†ï¼Œä½ è¶Šæ—©æŒæ¡ï¼Œå¯¹ä½ çš„ç›Šå¤„æ˜¯æ›´åŠ å¤§çš„ã€‚åˆ°æ­¤ä¸ºæ­¢ï¼ŒæµAPIçš„åŸºç¡€çŸ¥è¯†å·²ç»å­¦å®Œäº†ï¼Œåé¢çš„å‡ ç¯‡æ–‡ç« æˆ‘ä»¬å°±è¦å¼€å§‹æ›´åŠ æ·±å…¥åœ°ç†è§£å’Œè¿ç”¨ä»–ä»¬å®ç°ä¸€èµ·å¼ºæœ‰åŠ›çš„åŠŸèƒ½äº†ï¼\n","source":"_posts/æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆäºŒï¼‰å…³é”®çŸ¥è¯†ç‚¹.md","raw":"---\ntitle: Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆäºŒï¼‰å…³é”®çŸ¥è¯†ç‚¹\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: æ–°ç‰¹æ€§\n---\n\næˆ‘ä»¬çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œä¸»è¦æ˜¯é€šè¿‡ä¸€ä¸ªDemoï¼Œè®©å¤§å®¶ä½“éªŒäº†ä¸€ä¸‹ä½¿ç”¨æµAPIçš„é‚£ç§é…£ç•…æ·‹æ¼“çš„æ„Ÿè§‰ã€‚å¦‚æœä½ æ²¡æœ‰å®è·µï¼Œæˆ‘è¿˜æ˜¯å†æ¬¡å‘¼åä½ åŠ¨æ‰‹æ•²ä¸€æ•²ï¼Œè‡ªå·±å®å®åœ¨è·‘ä¸€éä¸Šä¸€ç¯‡çš„Demoã€‚ç›¸ä¿¡ä½ çš„æ„Ÿå—å’Œç†è§£ä¹Ÿä¼šéšä¹‹åŠ æ·±çš„ã€‚ç»§ç»­æ¢ç´¢æµAPIçš„é«˜çº§åŠŸèƒ½ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆä»æ¥å£çº§åˆ«å…¨é¢äº†è§£ä¸€ä¸‹æµAPIï¼Œè¿™ä¸ªå¯¹äºæˆ‘ä»¬æ¥è¯´æ˜¯è‡³å…³é‡è¦çš„ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ç»™å¤§å®¶å‡†å¤‡äº†ä¸€å¼ æµAPIå…³é”®çŸ¥è¯†ç‚¹çš„UMLå›¾ã€‚ä½†æ˜¯å¤§å®¶åªéœ€è¦èŠ±ä¸€ä¸¤åˆ†é’Ÿï¼Œæ•´ç†çœ‹ä¸€ä¸‹å°±å¯ä»¥äº†ï¼Œä¸éœ€è¦è®°ä½ï¼Œå…ˆæœ‰ä¸ªå°è±¡ï¼Œåé¢æˆ‘ç»™å¤§å®¶è®²è§£ä¸€äº›å…³é”®çš„æ–¹æ³•:\n\n#### æµAPI UML\n\n![æµAPI UML](https://upload-images.jianshu.io/upload_images/1640787-129cbee787eef3b4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\næˆ‘å…ˆæ•´ä½“ä»‹ç»ä¸€ä¸‹:æµAPIå®šä¹‰çš„å‡ ä¸ªæ¥å£ï¼Œéƒ½æ˜¯åœ¨java.util.streamåŒ…ä¸­çš„.å…¶ä¸­ä¸Šå›¾ä¸­çš„BaseStreamæ¥å£æ˜¯æœ€åŸºç¡€çš„æ¥å£ï¼Œå®ƒæä¾›äº†æ‰€æœ‰æµéƒ½å¯ä»¥ä½¿ç”¨çš„åŸºæœ¬åŠŸèƒ½:\n\n```\npublic interface BaseStream<T, S extends BaseStream<T, S>> extends AutoCloseable {\n//....å…ˆå¿½ç•¥è¿™äº›å…·ä½“çš„ç»†èŠ‚\n}\n```\n\nç”±è¿™ä¸ªæ¥å£çš„å®šä¹‰æˆ‘ä»¬å¾—çŸ¥ï¼ŒBaseStreamæ˜¯ä¸€ä¸ªæ³›å‹æ¥å£,å®ƒæœ‰ä¸¤ä¸ªç±»å‹å‚æ•°Tå’ŒSï¼Œ å…¶ä¸­TæŒ‡å®šäº†æµä¸­çš„å…ƒç´ çš„ç±»å‹,å¹¶ä¸”ç”±<S extends BaseStream<T, S>>å¯ä»¥çŸ¥é“Så¿…é¡»ä¸ºBaseStreamæˆ–BaseStreamå­ç±»(æ¢å¥è¯è¯´,å°±æ˜¯Så¿…é¡»æ˜¯æ‰©å±•è‡ªBaseStreamçš„)ã€‚BaseStreamç»§æ‰¿äº†AutoCloseableæ¥å£ã€‚è¿™ä¸ªæ¥å£ä¸»è¦æ˜¯ç®€åŒ–äº†å…³é—­èµ„æºçš„æ“ä½œã€‚ä½†æ˜¯åƒå¹³æ—¶æˆ‘ä»¬æ“ä½œçš„é›†åˆæˆ–æ•°ç»„ï¼ŒåŸºæœ¬ä¸Šéƒ½ä¸ä¼šå‡ºç°å…³é—­æµçš„æƒ…å†µã€‚\n\n```\n//ç”±BaseStreamæ¥å£æ´¾ç”Ÿå‡ºçš„æµæ¥å£åŒ…æ‹¬IntStream ï¼ŒLongStreamï¼ŒDoubleStream ï¼ŒStream<T>\npublic interface IntStream extends BaseStream<Integer, IntStream> {\n}\npublic interface LongStream extends BaseStream<Long, LongStream> {\n}\npublic interface DoubleStream extends BaseStream<Double, DoubleStream> {\n}\n\n//è¿™æ˜¯æœ€å…·ä»£è¡¨æ€§çš„æ¥å£\npublic interface Stream<T> extends BaseStream<T, Stream<T>> {\n//....å…ˆå¿½ç•¥è¿™äº›å…·ä½“çš„ç»†èŠ‚\n}\n```\n\nç”±äºStreamæ¥å£æ˜¯æœ€å…·ä»£è¡¨æ€§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±é€‰æ‹©å®ƒæ¥è®²è§£ï¼Œå…¶å®åœ¨æˆ‘ä»¬å­¦å®ŒStreamæ¥å£ï¼Œå…¶å®ƒçš„ä¸‰ä¸ªæ¥å£ï¼Œåœ¨ä½¿ç”¨ä¸ŠåŸºæœ¬æ˜¯ä¸€è‡´çš„äº†ï¼Œæˆ‘ä»¬ä¸Šä¸€ç¯‡çš„DemoåŸºæœ¬ä¸Šä¹Ÿæ˜¯ä½¿ç”¨Streamæ¥å£æ¥åšçš„ç»ƒä¹ ã€‚æˆ‘ä»¬å›æƒ³ä¸€ä¸‹:åœ¨ä¸Šä¸€ä¸ªDemoä¸­æˆ‘ä»¬é€šè¿‡é›†åˆæ¡†æ¶çš„stream()æ–¹æ³•ï¼Œå°±èƒ½è¿”å›ä¸€ä¸ªæµäº†ï¼Œå®ƒçš„è¿”å›ç±»å‹å°±æ˜¯Stream<T>ï¼Œæ¯”å¦‚æˆ‘ä»¬Stream<Integer>ï¼Œç”±æ­¤å¾—çŸ¥ï¼ŒStreamæ¥å£é‡Œçš„ç±»å‹å‚æ•°Tå°±æ˜¯æµä¸­çš„å…ƒç´ çš„ç±»å‹ã€‚æœ¨æœ‰é”™ï¼Œå°±æ˜¯è¿™æ ·æ»´ã€‚åˆ°è¿™é‡Œï¼Œæ•´ä¸ªç³»åˆ—ä½ ä»¬å·²ç»å…¨éƒ¨å­¦ä¼šäº†ï¼Œä¸‹è¯¾ã€‚\n\n![](https://upload-images.jianshu.io/upload_images/1640787-cac539e2ac3e760f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\næˆ˜æ–—æ‰åˆšåˆšå¼€å§‹ï¼\n\n![](https://upload-images.jianshu.io/upload_images/1640787-65d8e79c87d2ec76.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240)\n\nç°åœ¨æ˜¯æ—¶å€™å¼€å§‹è®°å¿†ä¸€äº›çŸ¥è¯†äº†.\n\n#### BaseStreamè¯¦è§£:\n\n```\npublic interface BaseStream<T, S extends BaseStream<T, S>> extends AutoCloseable {\n     Iterator<T> iterator();//line2\n     Spliterator<T> spliterator();//line3\n     boolean isParallel();//line4\n     S sequential();//line5\n     S parallel();//line6\n     S unordered();//line7\n     S onClose(Runnable closeHandler);//line8\n     @Override\n     void close();//line10\n}\n```\n\n* **Iterator<T> iterator();**  *`//line2`*\nè·å¾—æµçš„è¿­ä»£å™¨ï¼Œå¹¶è¿”å›å¯¹è¯¥è¿­ä»£å™¨çš„å¼•ç”¨(ç»ˆç«¯æ“ä½œ)\n* **Spliterator<T> spliterator();** *`//line3`*\nè·å–æµçš„spliteratorï¼Œå¹¶è¿”å›å…¶å¼•ç”¨(ç»ˆç«¯æ“ä½œ)\n* **boolean isParallel();** *`//line4`*\nå¦‚æœè°ƒç”¨æµæ˜¯ä¸€ä¸ªå¹¶è¡Œæµï¼Œåˆ™è¿”å›true;å¦‚æœè°ƒç”¨æµæ˜¯ä¸€ä¸ªé¡ºåºæµï¼Œåˆ™è¿”å›falseã€‚\n* **S sequential();** *`//line5`*\nåŸºäºè°ƒç”¨æµï¼Œè¿”å›ä¸€ä¸ªé¡ºåºæµã€‚å¦‚æœè°ƒç”¨æµå·²ç»æ˜¯é¡ºåºæµäº†ï¼Œå°±è¿”å›è¯¥æµã€‚(ä¸­é—´æ“ä½œ)\n* **S parallel();** *`//line6`*\nåŸºäºè°ƒç”¨æµï¼Œè¿”å›ä¸€ä¸ªå¹¶è¡Œæµã€‚å¦‚æœè°ƒç”¨æµå·²ç»æ˜¯å¹¶è¡Œæµäº†ï¼Œå°±è¿”å›è¯¥æµã€‚(ä¸­é—´æ“ä½œ)\n* **S unordered();** *`//line7`*\nåŸºäºè°ƒç”¨æµï¼Œè¿”å›ä¸€ä¸ªæ— åºæµã€‚å¦‚æœè°ƒç”¨æµå·²ç»æ˜¯æ— åºæµäº†ï¼Œå°±è¿”å›è¯¥æµã€‚(ä¸­é—´æ“ä½œ)\n* **S onClose(Runnable closeHandler);** *`//line8`*\nè¿”å›ä¸€ä¸ªæ–°æµï¼ŒcloseHandleræŒ‡å®šäº†è¯¥æµçš„å…³é—­å¤„ç†ç¨‹åºï¼Œå½“å…³é—­è¯¥æµæ—¶ï¼Œå°†è°ƒç”¨è¿™ä¸ªå¤„ç†ç¨‹åºã€‚(ä¸­é—´æ“ä½œ)\n* **void close();** *`//line10`*\nä»AutoCloseableç»§æ‰¿æ¥çš„ï¼Œè°ƒç”¨æ³¨å†Œå…³é—­å¤„ç†ç¨‹åºï¼Œå…³é—­è°ƒç”¨æµ(å¾ˆå°‘ä¼šè¢«ä½¿ç”¨åˆ°)\n\n#### \"ç»ˆç«¯æ“ä½œ\"&\"ä¸­é—´æ“ä½œ\"\n\nç»†å¿ƒçš„åŒå­¦åº”è¯¥æ³¨æ„åˆ°äº†ï¼ŒBaseStreamæ¥å£é‡Œé¢çš„å¾ˆå¤šæ–¹æ³•éƒ½åœ¨æœ€åæ ‡è¯†äº†(ç»ˆç«¯æ“ä½œ)å’Œ(ä¸­é—´æ“ä½œ)ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯éå¸¸é‡è¦çš„ã€‚\n* **ç»ˆç«¯æ“ä½œ**   ä¼šæ¶ˆè´¹æµï¼Œè¿™ç§æ“ä½œä¼šäº§ç”Ÿä¸€ä¸ªç»“æœçš„ï¼Œæ¯”å¦‚ä¸Šé¢çš„ iterator()å’Œ spliterator()ï¼Œä»¥åŠä¸Šä¸€ç¯‡ä¸­æåˆ°çš„min()å’Œmax()ï¼Œæˆ–è€…æ˜¯æ‰§è¡ŒæŸä¸€ç§æ“ä½œï¼Œæ¯”å¦‚ä¸Šä¸€ç¯‡çš„forEach()ï¼Œå¦‚æœä¸€ä¸ªæµè¢«æ¶ˆè´¹è¿‡äº†ï¼Œé‚£å®ƒå°±ä¸èƒ½è¢«é‡ç”¨çš„ã€‚\n\n* **ä¸­é—´æ“ä½œ**   ä¸­é—´æ“ä½œä¼šäº§ç”Ÿå¦ä¸€ä¸ªæµã€‚å› æ­¤ä¸­é—´æ“ä½œå¯ä»¥ç”¨æ¥åˆ›å»ºæ‰§è¡Œä¸€ç³»åˆ—åŠ¨ä½œçš„ç®¡é“ã€‚ä¸€ä¸ªç‰¹åˆ«éœ€è¦æ³¨æ„çš„ç‚¹æ˜¯:ä¸­é—´æ“ä½œä¸æ˜¯ç«‹å³å‘ç”Ÿçš„ã€‚ç›¸åï¼Œå½“åœ¨ä¸­é—´æ“ä½œåˆ›å»ºçš„æ–°æµä¸Šæ‰§è¡Œå®Œç»ˆç«¯æ“ä½œåï¼Œä¸­é—´æ“ä½œæŒ‡å®šçš„æ“ä½œæ‰ä¼šå‘ç”Ÿã€‚æ‰€ä»¥ä¸­é—´æ“ä½œæ˜¯å»¶è¿Ÿå‘ç”Ÿçš„ï¼Œä¸­é—´æ“ä½œçš„å»¶è¿Ÿè¡Œä¸ºä¸»è¦æ˜¯è®©æµAPIèƒ½å¤Ÿæ›´åŠ é«˜æ•ˆåœ°æ‰§è¡Œã€‚\n\n#### \"ä¸­é—´æ“ä½œ\"çš„çŠ¶æ€\n\næµçš„ä¸­é—´æ“ä½œï¼Œå¯ä»¥ä¸ºåˆ†`æ— çŠ¶æ€æ“ä½œ`å’Œ`æœ‰çŠ¶æ€æ“ä½œ`ä¸¤ç§ï¼Œåœ¨æ— çŠ¶æ€æ“ä½œä¸­ï¼Œåœ¨å¤„ç†æµä¸­çš„å…ƒç´ æ—¶ï¼Œä¼šå¯¹å½“å‰çš„å…ƒç´ è¿›è¡Œå•ç‹¬å¤„ç†ã€‚æ¯”å¦‚:è°“è¯è¿‡æ»¤æ“ä½œï¼Œå› ä¸ºæ¯ä¸ªå…ƒç´ éƒ½æ˜¯è¢«å•ç‹¬è¿›è¡Œå¤„ç†çš„ï¼Œæ‰€æœ‰å®ƒå’Œæµä¸­çš„å…¶å®ƒå…ƒç´ æ— å…³ï¼Œå› æ­¤è¢«ç§°ä¸ºæ— çŠ¶æ€æ“ä½œ;è€Œåœ¨æœ‰çŠ¶æ€æ“ä½œä¸­ï¼ŒæŸä¸ªå…ƒç´ çš„å¤„ç†å¯èƒ½ä¾èµ–äºå…¶ä»–å…ƒç´ ã€‚æ¯”å¦‚æŸ¥æ‰¾æœ€å°å€¼ï¼Œæœ€å¤§å€¼ï¼Œå’Œæ’åºï¼Œå› ä¸ºä»–ä»¬éƒ½ä¾èµ–äºå…¶ä»–çš„å…ƒç´ ã€‚å› æ­¤ä¸ºç§°ä¸ºæœ‰çŠ¶æ€æ“ä½œã€‚`å½“éœ€è¦è¿›è¡Œå¹¶è¡Œå¤„ç†æµæ—¶ï¼Œæœ‰çŠ¶æ€çš„æ“ä½œå’Œæ— çŠ¶æ€çš„åŒºåˆ«æ˜¯éå¸¸é‡è¦çš„ï¼Œå› ä¸ºæœ‰çŠ¶æ€æ“ä½œå¯èƒ½éœ€è¦å‡ æ¬¡å¤„ç†æ‰èƒ½å®Œæˆï¼Œåé¢çš„æ–‡ç« æˆ‘å°†ä¼šç»™å¤§å®¶è¯¦ç»†åœ°è®²ï¼Œç°åœ¨åªéœ€è¦æ­£å¸¸å­¦ä¹ ä¸‹å»å°±å¯ä»¥äº†`\n\nå¦å¤–ï¼ŒæŒ‡å‡ºä¸€ç‚¹ï¼Œå¦‚æœå¤§å®¶äº†è§£æ³›å‹çš„è¯ï¼Œåº”è¯¥çŸ¥é“ï¼Œæ³›å‹çš„ç±»å‹å‚æ•°åªèƒ½æ˜¯å¼•ç”¨ç±»å‹ï¼Œå› æ­¤Streamæ“ä½œçš„å¯¹è±¡åªèƒ½æ˜¯å¼•ç”¨ç±»å‹çš„ï¼Œä¸èƒ½ç”¨äºåŸºæœ¬ç±»å‹ã€‚å½“ç„¶å®˜æ–¹æ—©å·²è€ƒè™‘åˆ°è¿™ä¸€ç‚¹äº†ï¼Œå‰é¢ä½ ä»¬çœ‹åˆ°çš„IntStreamï¼ŒLongStreamï¼ŒDoubleStreamå°±æ˜¯å®˜æ–¹ç»™æˆ‘ä»¬æä¾›çš„å¤„ç†åŸºæœ¬ç±»å‹çš„æµäº†ã€‚æ­¤å¤„æ˜¯ä¸æ˜¯åº”è¯¥ç»™ä»–ä»¬æŒå£°ï¼\n\n#### Streamè¯¦è§£\n\nåœ¨æœ‰äº†å‰é¢çš„é‚£äº›çŸ¥è¯†ä½œé“ºå«ä¹‹åï¼Œå­¦Streamæ¥å£åº”è¯¥ä¼šé¡ºé£é¡ºæ°´äº†ã€‚è¿˜æ˜¯å…ˆçœ‹çœ‹Streamçš„è¯¦æƒ…å…ˆ:\n\n```\npublic interface Stream<T> extends BaseStream<T, Stream<T>> {\n    Stream<T> filter(Predicate<? super T> predicate);//line2\n    <R> Stream<R> map(Function<? super T, ? extends R> mapper);//line3\n    IntStream mapToInt(ToIntFunction<? super T> mapper);//line4\n    LongStream mapToLong(ToLongFunction<? super T> mapper);\n    DoubleStream mapToDouble(ToDoubleFunction<? super T> mapper);\n    <R> Stream<R> flatMap(Function<? super T, ? extends Stream<? extends R>> mapper);\n    IntStream flatMapToInt(Function<? super T, ? extends IntStream> mapper);\n    LongStream flatMapToLong(Function<? super T, ? extends LongStream> mapper);\n    DoubleStream flatMapToDouble(Function<? super T, ? extends DoubleStream> mapper);\n    Stream<T> distinct();\n    Stream<T> sorted();//line12\n    Stream<T> sorted(Comparator<? super T> comparator);//line13\n    Stream<T> peek(Consumer<? super T> action);\n    Stream<T> limit(long maxSize);\n    Stream<T> skip(long n);\n    void forEach(Consumer<? super T> action);//line17\n    void forEachOrdered(Consumer<? super T> action);//line18\n    Object[] toArray();\n    <A> A[] toArray(IntFunction<A[]> generator);\n    T reduce(T identity, BinaryOperator<T> accumulator);\n    Optional<T> reduce(BinaryOperator<T> accumulator);\n    <U> U reduce(U identity,\n                 BiFunction<U, ? super T, U> accumulator,\n                 BinaryOperator<U> combiner);\n    <R> R collect(Supplier<R> supplier,\n                  BiConsumer<R, ? super T> accumulator,\n                  BiConsumer<R, R> combiner);\n    <R, A> R collect(Collector<? super T, A, R> collector);\n    Optional<T> min(Comparator<? super T> comparator);//line30\n    Optional<T> max(Comparator<? super T> comparator);//line31\n    long count();\n    boolean anyMatch(Predicate<? super T> predicate);\n    boolean allMatch(Predicate<? super T> predicate);\n    boolean noneMatch(Predicate<? super T> predicate);\n    Optional<T> findFirst();\n    Optional<T> findAny();\n\n    // Static factories\n\n    public static<T> Builder<T> builder() {\n        return new Streams.StreamBuilderImpl<>();\n    }\n\n\n    public static<T> Stream<T> empty() {\n        return StreamSupport.stream(Spliterators.<T>emptySpliterator(), false);\n    }\n\n\n    public static<T> Stream<T> of(T t) {\n        return StreamSupport.stream(new Streams.StreamBuilderImpl<>(t), false);\n    }\n\n\n    @SafeVarargs\n    @SuppressWarnings(\"varargs\") // Creating a stream from an array is safe\n    public static<T> Stream<T> of(T... values) {\n        return Arrays.stream(values);\n    }\n\n\n    public static<T> Stream<T> iterate(final T seed, final UnaryOperator<T> f) {\n        Objects.requireNonNull(f);\n        final Iterator<T> iterator = new Iterator<T>() {\n            @SuppressWarnings(\"unchecked\")\n            T t = (T) Streams.NONE;\n\n            @Override\n            public boolean hasNext() {\n                return true;\n            }\n\n            @Override\n            public T next() {\n                return t = (t == Streams.NONE) ? seed : f.apply(t);\n            }\n        };\n        return StreamSupport.stream(Spliterators.spliteratorUnknownSize(\n                iterator,\n                Spliterator.ORDERED | Spliterator.IMMUTABLE), false);\n    }\n\n\n    public static<T> Stream<T> generate(Supplier<T> s) {\n        Objects.requireNonNull(s);\n        return StreamSupport.stream(\n                new StreamSpliterators.InfiniteSupplyingSpliterator.OfRef<>(Long.MAX_VALUE, s), false);\n    }\n\n\n    public static <T> Stream<T> concat(Stream<? extends T> a, Stream<? extends T> b) {\n        Objects.requireNonNull(a);\n        Objects.requireNonNull(b);\n\n        @SuppressWarnings(\"unchecked\")\n        Spliterator<T> split = new Streams.ConcatSpliterator.OfRef<>(\n                (Spliterator<T>) a.spliterator(), (Spliterator<T>) b.spliterator());\n        Stream<T> stream = StreamSupport.stream(split, a.isParallel() || b.isParallel());\n        return stream.onClose(Streams.composedClose(a, b));\n    }\n}\n```\n\n* **Stream<T> filter(Predicate<? super T> predicate);**  *`//line2`*\näº§ç”Ÿä¸€ä¸ªæ–°æµï¼Œå…¶ä¸­åŒ…å«è°ƒç”¨æµä¸­æ»¡è¶³predicateæŒ‡å®šçš„è°“è¯å…ƒç´ (ä¸­é—´æ“ä½œ)\n* **<R> Stream<R> map(Function<? super T, ? extends R> mapper);**  *`//line3`*\näº§ç”Ÿä¸€ä¸ªæ–°æµï¼Œå¯¹è°ƒç”¨æµä¸­çš„å…ƒç´ åº”ç”¨mapperï¼Œæ–°æµä¸­åŒ…å«è¿™äº›å…ƒç´ ã€‚(ä¸­é—´æ“ä½œ)\n* **IntStream mapToInt(ToIntFunction<? super T> mapper);** *`//line4`*\nå¯¹è°ƒç”¨æµä¸­å…ƒç´ åº”ç”¨mapperï¼Œäº§ç”ŸåŒ…å«è¿™äº›å…ƒç´ çš„ä¸€ä¸ªæ–°IntStreamæµã€‚(ä¸­é—´æ“ä½œ)\n* **Stream<T> sorted();** *`//line12`*\n* **Stream<T> sorted(Comparator<? super T> comparator);** *`//line13`*`\näº§ç”Ÿä¸€ä¸ªè‡ªç„¶é¡ºåºæ’åºæˆ–è€…æŒ‡å®šæ’åºæ¡ä»¶çš„æ–°æµ(ä¸­é—´æ“ä½œ)\n* **void forEach(Consumer<? super T> action);**  *`//line17`*\n* **void forEachOrdered(Consumer<? super T> action);** *`//line18`*\néå†äº†æµä¸­çš„å…ƒç´ (ç»ˆç«¯æ“ä½œ)\n* **Optional<T> min(Comparator<? super T> comparator)**  *`//line30`*\n* **Optional<T> max(Comparator<? super T> comparator);** *`//line31`*\nè·å¾—æµä¸­æœ€å¤§æœ€å°å€¼ï¼Œæ¯”è¾ƒå™¨å¯ä»¥ç”±è‡ªå·±å®šä¹‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨JDKæä¾›çš„(ç»ˆç«¯æ“ä½œ)\n\n#### å°ç»“ä¸€ä¸‹\n\nè¿™ä¸€ç¯‡ä¸»è¦æ˜¯ä»‹ç»äº†æµAPIçš„ä¸€äº›å…³é”®æ–¹æ³•ï¼Œå’Œä¸€äº›å…³é”®çš„æ¦‚å¿µï¼Œè™½ç„¶ç¨å¾®æ¯ç‡¥äº†ä¸€ç‚¹ï¼Œä½†æ˜¯ï¼Œä¸èƒ½å¦è®¤ï¼Œå…¨é¢åœ°å­¦ä¹ æµAPIï¼Œä¼šè®©ä½ å¯¹æµAPIçš„è®¤è¯†ä¼šæ›´åŠ çš„æ·±åˆ»ï¼Œæ‰€ä»¥å¦‚æœæ—¶é—´å…è®¸ï¼Œè¯·å†è®¤çœŸè¯»è¯»è¿™ä¸€ç¯‡æ–‡ç« å§ï¼Œå½“ç„¶ï¼Œä¹Ÿå¯ä»¥åœ¨å®è·µä¸­æ…¢æ…¢è®¤è¯†å®ƒä»¬ï¼Œä½†æ˜¯ï¼Œå¯¹äºè¿™äº›åŸºæœ¬æ¦‚å¿µçš„çŸ¥è¯†ï¼Œä½ è¶Šæ—©æŒæ¡ï¼Œå¯¹ä½ çš„ç›Šå¤„æ˜¯æ›´åŠ å¤§çš„ã€‚åˆ°æ­¤ä¸ºæ­¢ï¼ŒæµAPIçš„åŸºç¡€çŸ¥è¯†å·²ç»å­¦å®Œäº†ï¼Œåé¢çš„å‡ ç¯‡æ–‡ç« æˆ‘ä»¬å°±è¦å¼€å§‹æ›´åŠ æ·±å…¥åœ°ç†è§£å’Œè¿ç”¨ä»–ä»¬å®ç°ä¸€èµ·å¼ºæœ‰åŠ›çš„åŠŸèƒ½äº†ï¼\n","slug":"æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆäºŒï¼‰å…³é”®çŸ¥è¯†ç‚¹","published":1,"updated":"2025-10-15T07:20:51.443Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu077a006rqkd4flbfd9t1","content":"<p>æˆ‘ä»¬çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œä¸»è¦æ˜¯é€šè¿‡ä¸€ä¸ªDemoï¼Œè®©å¤§å®¶ä½“éªŒäº†ä¸€ä¸‹ä½¿ç”¨æµAPIçš„é‚£ç§é…£ç•…æ·‹æ¼“çš„æ„Ÿè§‰ã€‚å¦‚æœä½ æ²¡æœ‰å®è·µï¼Œæˆ‘è¿˜æ˜¯å†æ¬¡å‘¼åä½ åŠ¨æ‰‹æ•²ä¸€æ•²ï¼Œè‡ªå·±å®å®åœ¨è·‘ä¸€éä¸Šä¸€ç¯‡çš„Demoã€‚ç›¸ä¿¡ä½ çš„æ„Ÿå—å’Œç†è§£ä¹Ÿä¼šéšä¹‹åŠ æ·±çš„ã€‚ç»§ç»­æ¢ç´¢æµAPIçš„é«˜çº§åŠŸèƒ½ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆä»æ¥å£çº§åˆ«å…¨é¢äº†è§£ä¸€ä¸‹æµAPIï¼Œè¿™ä¸ªå¯¹äºæˆ‘ä»¬æ¥è¯´æ˜¯è‡³å…³é‡è¦çš„ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ç»™å¤§å®¶å‡†å¤‡äº†ä¸€å¼ æµAPIå…³é”®çŸ¥è¯†ç‚¹çš„UMLå›¾ã€‚ä½†æ˜¯å¤§å®¶åªéœ€è¦èŠ±ä¸€ä¸¤åˆ†é’Ÿï¼Œæ•´ç†çœ‹ä¸€ä¸‹å°±å¯ä»¥äº†ï¼Œä¸éœ€è¦è®°ä½ï¼Œå…ˆæœ‰ä¸ªå°è±¡ï¼Œåé¢æˆ‘ç»™å¤§å®¶è®²è§£ä¸€äº›å…³é”®çš„æ–¹æ³•:</p>\n<h4 id=\"æµAPI-UML\"><a href=\"#æµAPI-UML\" class=\"headerlink\" title=\"æµAPI UML\"></a>æµAPI UML</h4><p><img src=\"https://upload-images.jianshu.io/upload_images/1640787-129cbee787eef3b4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"æµAPI UML\"></p>\n<p>æˆ‘å…ˆæ•´ä½“ä»‹ç»ä¸€ä¸‹:æµAPIå®šä¹‰çš„å‡ ä¸ªæ¥å£ï¼Œéƒ½æ˜¯åœ¨java.util.streamåŒ…ä¸­çš„.å…¶ä¸­ä¸Šå›¾ä¸­çš„BaseStreamæ¥å£æ˜¯æœ€åŸºç¡€çš„æ¥å£ï¼Œå®ƒæä¾›äº†æ‰€æœ‰æµéƒ½å¯ä»¥ä½¿ç”¨çš„åŸºæœ¬åŠŸèƒ½:</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public interface BaseStream&lt;T, S extends BaseStream&lt;T, S&gt;&gt; extends AutoCloseable &#123;\n&#x2F;&#x2F;....å…ˆå¿½ç•¥è¿™äº›å…·ä½“çš„ç»†èŠ‚\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ç”±è¿™ä¸ªæ¥å£çš„å®šä¹‰æˆ‘ä»¬å¾—çŸ¥ï¼ŒBaseStreamæ˜¯ä¸€ä¸ªæ³›å‹æ¥å£,å®ƒæœ‰ä¸¤ä¸ªç±»å‹å‚æ•°Tå’ŒSï¼Œ å…¶ä¸­TæŒ‡å®šäº†æµä¸­çš„å…ƒç´ çš„ç±»å‹,å¹¶ä¸”ç”±&lt;S extends BaseStream&lt;T, S&gt;&gt;å¯ä»¥çŸ¥é“Så¿…é¡»ä¸ºBaseStreamæˆ–BaseStreamå­ç±»(æ¢å¥è¯è¯´,å°±æ˜¯Så¿…é¡»æ˜¯æ‰©å±•è‡ªBaseStreamçš„)ã€‚BaseStreamç»§æ‰¿äº†AutoCloseableæ¥å£ã€‚è¿™ä¸ªæ¥å£ä¸»è¦æ˜¯ç®€åŒ–äº†å…³é—­èµ„æºçš„æ“ä½œã€‚ä½†æ˜¯åƒå¹³æ—¶æˆ‘ä»¬æ“ä½œçš„é›†åˆæˆ–æ•°ç»„ï¼ŒåŸºæœ¬ä¸Šéƒ½ä¸ä¼šå‡ºç°å…³é—­æµçš„æƒ…å†µã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F;ç”±BaseStreamæ¥å£æ´¾ç”Ÿå‡ºçš„æµæ¥å£åŒ…æ‹¬IntStream ï¼ŒLongStreamï¼ŒDoubleStream ï¼ŒStream&lt;T&gt;\npublic interface IntStream extends BaseStream&lt;Integer, IntStream&gt; &#123;\n&#125;\npublic interface LongStream extends BaseStream&lt;Long, LongStream&gt; &#123;\n&#125;\npublic interface DoubleStream extends BaseStream&lt;Double, DoubleStream&gt; &#123;\n&#125;\n\n&#x2F;&#x2F;è¿™æ˜¯æœ€å…·ä»£è¡¨æ€§çš„æ¥å£\npublic interface Stream&lt;T&gt; extends BaseStream&lt;T, Stream&lt;T&gt;&gt; &#123;\n&#x2F;&#x2F;....å…ˆå¿½ç•¥è¿™äº›å…·ä½“çš„ç»†èŠ‚\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç”±äºStreamæ¥å£æ˜¯æœ€å…·ä»£è¡¨æ€§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±é€‰æ‹©å®ƒæ¥è®²è§£ï¼Œå…¶å®åœ¨æˆ‘ä»¬å­¦å®ŒStreamæ¥å£ï¼Œå…¶å®ƒçš„ä¸‰ä¸ªæ¥å£ï¼Œåœ¨ä½¿ç”¨ä¸ŠåŸºæœ¬æ˜¯ä¸€è‡´çš„äº†ï¼Œæˆ‘ä»¬ä¸Šä¸€ç¯‡çš„DemoåŸºæœ¬ä¸Šä¹Ÿæ˜¯ä½¿ç”¨Streamæ¥å£æ¥åšçš„ç»ƒä¹ ã€‚æˆ‘ä»¬å›æƒ³ä¸€ä¸‹:åœ¨ä¸Šä¸€ä¸ªDemoä¸­æˆ‘ä»¬é€šè¿‡é›†åˆæ¡†æ¶çš„stream()æ–¹æ³•ï¼Œå°±èƒ½è¿”å›ä¸€ä¸ªæµäº†ï¼Œå®ƒçš„è¿”å›ç±»å‹å°±æ˜¯Stream<T>ï¼Œæ¯”å¦‚æˆ‘ä»¬Stream<Integer>ï¼Œç”±æ­¤å¾—çŸ¥ï¼ŒStreamæ¥å£é‡Œçš„ç±»å‹å‚æ•°Tå°±æ˜¯æµä¸­çš„å…ƒç´ çš„ç±»å‹ã€‚æœ¨æœ‰é”™ï¼Œå°±æ˜¯è¿™æ ·æ»´ã€‚åˆ°è¿™é‡Œï¼Œæ•´ä¸ªç³»åˆ—ä½ ä»¬å·²ç»å…¨éƒ¨å­¦ä¼šäº†ï¼Œä¸‹è¯¾ã€‚</p>\n<p><img src=\"https://upload-images.jianshu.io/upload_images/1640787-cac539e2ac3e760f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\"></p>\n<p>æˆ˜æ–—æ‰åˆšåˆšå¼€å§‹ï¼</p>\n<p><img src=\"https://upload-images.jianshu.io/upload_images/1640787-65d8e79c87d2ec76.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\"></p>\n<p>ç°åœ¨æ˜¯æ—¶å€™å¼€å§‹è®°å¿†ä¸€äº›çŸ¥è¯†äº†.</p>\n<h4 id=\"BaseStreamè¯¦è§£\"><a href=\"#BaseStreamè¯¦è§£\" class=\"headerlink\" title=\"BaseStreamè¯¦è§£:\"></a>BaseStreamè¯¦è§£:</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">public interface BaseStream&lt;T, S extends BaseStream&lt;T, S&gt;&gt; extends AutoCloseable &#123;\n     Iterator&lt;T&gt; iterator();&#x2F;&#x2F;line2\n     Spliterator&lt;T&gt; spliterator();&#x2F;&#x2F;line3\n     boolean isParallel();&#x2F;&#x2F;line4\n     S sequential();&#x2F;&#x2F;line5\n     S parallel();&#x2F;&#x2F;line6\n     S unordered();&#x2F;&#x2F;line7\n     S onClose(Runnable closeHandler);&#x2F;&#x2F;line8\n     @Override\n     void close();&#x2F;&#x2F;line10\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li><strong>Iterator<T> iterator();</strong>  <em><code>//line2</code></em><br>è·å¾—æµçš„è¿­ä»£å™¨ï¼Œå¹¶è¿”å›å¯¹è¯¥è¿­ä»£å™¨çš„å¼•ç”¨(ç»ˆç«¯æ“ä½œ)</li>\n<li><strong>Spliterator<T> spliterator();</strong> <em><code>//line3</code></em><br>è·å–æµçš„spliteratorï¼Œå¹¶è¿”å›å…¶å¼•ç”¨(ç»ˆç«¯æ“ä½œ)</li>\n<li><strong>boolean isParallel();</strong> <em><code>//line4</code></em><br>å¦‚æœè°ƒç”¨æµæ˜¯ä¸€ä¸ªå¹¶è¡Œæµï¼Œåˆ™è¿”å›true;å¦‚æœè°ƒç”¨æµæ˜¯ä¸€ä¸ªé¡ºåºæµï¼Œåˆ™è¿”å›falseã€‚</li>\n<li><strong>S sequential();</strong> <em><code>//line5</code></em><br>åŸºäºè°ƒç”¨æµï¼Œè¿”å›ä¸€ä¸ªé¡ºåºæµã€‚å¦‚æœè°ƒç”¨æµå·²ç»æ˜¯é¡ºåºæµäº†ï¼Œå°±è¿”å›è¯¥æµã€‚(ä¸­é—´æ“ä½œ)</li>\n<li><strong>S parallel();</strong> <em><code>//line6</code></em><br>åŸºäºè°ƒç”¨æµï¼Œè¿”å›ä¸€ä¸ªå¹¶è¡Œæµã€‚å¦‚æœè°ƒç”¨æµå·²ç»æ˜¯å¹¶è¡Œæµäº†ï¼Œå°±è¿”å›è¯¥æµã€‚(ä¸­é—´æ“ä½œ)</li>\n<li><strong>S unordered();</strong> <em><code>//line7</code></em><br>åŸºäºè°ƒç”¨æµï¼Œè¿”å›ä¸€ä¸ªæ— åºæµã€‚å¦‚æœè°ƒç”¨æµå·²ç»æ˜¯æ— åºæµäº†ï¼Œå°±è¿”å›è¯¥æµã€‚(ä¸­é—´æ“ä½œ)</li>\n<li><strong>S onClose(Runnable closeHandler);</strong> <em><code>//line8</code></em><br>è¿”å›ä¸€ä¸ªæ–°æµï¼ŒcloseHandleræŒ‡å®šäº†è¯¥æµçš„å…³é—­å¤„ç†ç¨‹åºï¼Œå½“å…³é—­è¯¥æµæ—¶ï¼Œå°†è°ƒç”¨è¿™ä¸ªå¤„ç†ç¨‹åºã€‚(ä¸­é—´æ“ä½œ)</li>\n<li><strong>void close();</strong> <em><code>//line10</code></em><br>ä»AutoCloseableç»§æ‰¿æ¥çš„ï¼Œè°ƒç”¨æ³¨å†Œå…³é—­å¤„ç†ç¨‹åºï¼Œå…³é—­è°ƒç”¨æµ(å¾ˆå°‘ä¼šè¢«ä½¿ç”¨åˆ°)</li>\n</ul>\n<h4 id=\"â€œç»ˆç«¯æ“ä½œâ€-â€ä¸­é—´æ“ä½œâ€\"><a href=\"#â€œç»ˆç«¯æ“ä½œâ€-â€ä¸­é—´æ“ä½œâ€\" class=\"headerlink\" title=\"â€œç»ˆç«¯æ“ä½œâ€&amp;â€ä¸­é—´æ“ä½œâ€\"></a>â€œç»ˆç«¯æ“ä½œâ€&amp;â€ä¸­é—´æ“ä½œâ€</h4><p>ç»†å¿ƒçš„åŒå­¦åº”è¯¥æ³¨æ„åˆ°äº†ï¼ŒBaseStreamæ¥å£é‡Œé¢çš„å¾ˆå¤šæ–¹æ³•éƒ½åœ¨æœ€åæ ‡è¯†äº†(ç»ˆç«¯æ“ä½œ)å’Œ(ä¸­é—´æ“ä½œ)ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯éå¸¸é‡è¦çš„ã€‚</p>\n<ul>\n<li><p><strong>ç»ˆç«¯æ“ä½œ</strong>   ä¼šæ¶ˆè´¹æµï¼Œè¿™ç§æ“ä½œä¼šäº§ç”Ÿä¸€ä¸ªç»“æœçš„ï¼Œæ¯”å¦‚ä¸Šé¢çš„ iterator()å’Œ spliterator()ï¼Œä»¥åŠä¸Šä¸€ç¯‡ä¸­æåˆ°çš„min()å’Œmax()ï¼Œæˆ–è€…æ˜¯æ‰§è¡ŒæŸä¸€ç§æ“ä½œï¼Œæ¯”å¦‚ä¸Šä¸€ç¯‡çš„forEach()ï¼Œå¦‚æœä¸€ä¸ªæµè¢«æ¶ˆè´¹è¿‡äº†ï¼Œé‚£å®ƒå°±ä¸èƒ½è¢«é‡ç”¨çš„ã€‚</p>\n</li>\n<li><p><strong>ä¸­é—´æ“ä½œ</strong>   ä¸­é—´æ“ä½œä¼šäº§ç”Ÿå¦ä¸€ä¸ªæµã€‚å› æ­¤ä¸­é—´æ“ä½œå¯ä»¥ç”¨æ¥åˆ›å»ºæ‰§è¡Œä¸€ç³»åˆ—åŠ¨ä½œçš„ç®¡é“ã€‚ä¸€ä¸ªç‰¹åˆ«éœ€è¦æ³¨æ„çš„ç‚¹æ˜¯:ä¸­é—´æ“ä½œä¸æ˜¯ç«‹å³å‘ç”Ÿçš„ã€‚ç›¸åï¼Œå½“åœ¨ä¸­é—´æ“ä½œåˆ›å»ºçš„æ–°æµä¸Šæ‰§è¡Œå®Œç»ˆç«¯æ“ä½œåï¼Œä¸­é—´æ“ä½œæŒ‡å®šçš„æ“ä½œæ‰ä¼šå‘ç”Ÿã€‚æ‰€ä»¥ä¸­é—´æ“ä½œæ˜¯å»¶è¿Ÿå‘ç”Ÿçš„ï¼Œä¸­é—´æ“ä½œçš„å»¶è¿Ÿè¡Œä¸ºä¸»è¦æ˜¯è®©æµAPIèƒ½å¤Ÿæ›´åŠ é«˜æ•ˆåœ°æ‰§è¡Œã€‚</p>\n</li>\n</ul>\n<h4 id=\"â€œä¸­é—´æ“ä½œâ€çš„çŠ¶æ€\"><a href=\"#â€œä¸­é—´æ“ä½œâ€çš„çŠ¶æ€\" class=\"headerlink\" title=\"â€œä¸­é—´æ“ä½œâ€çš„çŠ¶æ€\"></a>â€œä¸­é—´æ“ä½œâ€çš„çŠ¶æ€</h4><p>æµçš„ä¸­é—´æ“ä½œï¼Œå¯ä»¥ä¸ºåˆ†<code>æ— çŠ¶æ€æ“ä½œ</code>å’Œ<code>æœ‰çŠ¶æ€æ“ä½œ</code>ä¸¤ç§ï¼Œåœ¨æ— çŠ¶æ€æ“ä½œä¸­ï¼Œåœ¨å¤„ç†æµä¸­çš„å…ƒç´ æ—¶ï¼Œä¼šå¯¹å½“å‰çš„å…ƒç´ è¿›è¡Œå•ç‹¬å¤„ç†ã€‚æ¯”å¦‚:è°“è¯è¿‡æ»¤æ“ä½œï¼Œå› ä¸ºæ¯ä¸ªå…ƒç´ éƒ½æ˜¯è¢«å•ç‹¬è¿›è¡Œå¤„ç†çš„ï¼Œæ‰€æœ‰å®ƒå’Œæµä¸­çš„å…¶å®ƒå…ƒç´ æ— å…³ï¼Œå› æ­¤è¢«ç§°ä¸ºæ— çŠ¶æ€æ“ä½œ;è€Œåœ¨æœ‰çŠ¶æ€æ“ä½œä¸­ï¼ŒæŸä¸ªå…ƒç´ çš„å¤„ç†å¯èƒ½ä¾èµ–äºå…¶ä»–å…ƒç´ ã€‚æ¯”å¦‚æŸ¥æ‰¾æœ€å°å€¼ï¼Œæœ€å¤§å€¼ï¼Œå’Œæ’åºï¼Œå› ä¸ºä»–ä»¬éƒ½ä¾èµ–äºå…¶ä»–çš„å…ƒç´ ã€‚å› æ­¤ä¸ºç§°ä¸ºæœ‰çŠ¶æ€æ“ä½œã€‚<code>å½“éœ€è¦è¿›è¡Œå¹¶è¡Œå¤„ç†æµæ—¶ï¼Œæœ‰çŠ¶æ€çš„æ“ä½œå’Œæ— çŠ¶æ€çš„åŒºåˆ«æ˜¯éå¸¸é‡è¦çš„ï¼Œå› ä¸ºæœ‰çŠ¶æ€æ“ä½œå¯èƒ½éœ€è¦å‡ æ¬¡å¤„ç†æ‰èƒ½å®Œæˆï¼Œåé¢çš„æ–‡ç« æˆ‘å°†ä¼šç»™å¤§å®¶è¯¦ç»†åœ°è®²ï¼Œç°åœ¨åªéœ€è¦æ­£å¸¸å­¦ä¹ ä¸‹å»å°±å¯ä»¥äº†</code></p>\n<p>å¦å¤–ï¼ŒæŒ‡å‡ºä¸€ç‚¹ï¼Œå¦‚æœå¤§å®¶äº†è§£æ³›å‹çš„è¯ï¼Œåº”è¯¥çŸ¥é“ï¼Œæ³›å‹çš„ç±»å‹å‚æ•°åªèƒ½æ˜¯å¼•ç”¨ç±»å‹ï¼Œå› æ­¤Streamæ“ä½œçš„å¯¹è±¡åªèƒ½æ˜¯å¼•ç”¨ç±»å‹çš„ï¼Œä¸èƒ½ç”¨äºåŸºæœ¬ç±»å‹ã€‚å½“ç„¶å®˜æ–¹æ—©å·²è€ƒè™‘åˆ°è¿™ä¸€ç‚¹äº†ï¼Œå‰é¢ä½ ä»¬çœ‹åˆ°çš„IntStreamï¼ŒLongStreamï¼ŒDoubleStreamå°±æ˜¯å®˜æ–¹ç»™æˆ‘ä»¬æä¾›çš„å¤„ç†åŸºæœ¬ç±»å‹çš„æµäº†ã€‚æ­¤å¤„æ˜¯ä¸æ˜¯åº”è¯¥ç»™ä»–ä»¬æŒå£°ï¼</p>\n<h4 id=\"Streamè¯¦è§£\"><a href=\"#Streamè¯¦è§£\" class=\"headerlink\" title=\"Streamè¯¦è§£\"></a>Streamè¯¦è§£</h4><p>åœ¨æœ‰äº†å‰é¢çš„é‚£äº›çŸ¥è¯†ä½œé“ºå«ä¹‹åï¼Œå­¦Streamæ¥å£åº”è¯¥ä¼šé¡ºé£é¡ºæ°´äº†ã€‚è¿˜æ˜¯å…ˆçœ‹çœ‹Streamçš„è¯¦æƒ…å…ˆ:</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public interface Stream&lt;T&gt; extends BaseStream&lt;T, Stream&lt;T&gt;&gt; &#123;\n    Stream&lt;T&gt; filter(Predicate&lt;? super T&gt; predicate);&#x2F;&#x2F;line2\n    &lt;R&gt; Stream&lt;R&gt; map(Function&lt;? super T, ? extends R&gt; mapper);&#x2F;&#x2F;line3\n    IntStream mapToInt(ToIntFunction&lt;? super T&gt; mapper);&#x2F;&#x2F;line4\n    LongStream mapToLong(ToLongFunction&lt;? super T&gt; mapper);\n    DoubleStream mapToDouble(ToDoubleFunction&lt;? super T&gt; mapper);\n    &lt;R&gt; Stream&lt;R&gt; flatMap(Function&lt;? super T, ? extends Stream&lt;? extends R&gt;&gt; mapper);\n    IntStream flatMapToInt(Function&lt;? super T, ? extends IntStream&gt; mapper);\n    LongStream flatMapToLong(Function&lt;? super T, ? extends LongStream&gt; mapper);\n    DoubleStream flatMapToDouble(Function&lt;? super T, ? extends DoubleStream&gt; mapper);\n    Stream&lt;T&gt; distinct();\n    Stream&lt;T&gt; sorted();&#x2F;&#x2F;line12\n    Stream&lt;T&gt; sorted(Comparator&lt;? super T&gt; comparator);&#x2F;&#x2F;line13\n    Stream&lt;T&gt; peek(Consumer&lt;? super T&gt; action);\n    Stream&lt;T&gt; limit(long maxSize);\n    Stream&lt;T&gt; skip(long n);\n    void forEach(Consumer&lt;? super T&gt; action);&#x2F;&#x2F;line17\n    void forEachOrdered(Consumer&lt;? super T&gt; action);&#x2F;&#x2F;line18\n    Object[] toArray();\n    &lt;A&gt; A[] toArray(IntFunction&lt;A[]&gt; generator);\n    T reduce(T identity, BinaryOperator&lt;T&gt; accumulator);\n    Optional&lt;T&gt; reduce(BinaryOperator&lt;T&gt; accumulator);\n    &lt;U&gt; U reduce(U identity,\n                 BiFunction&lt;U, ? super T, U&gt; accumulator,\n                 BinaryOperator&lt;U&gt; combiner);\n    &lt;R&gt; R collect(Supplier&lt;R&gt; supplier,\n                  BiConsumer&lt;R, ? super T&gt; accumulator,\n                  BiConsumer&lt;R, R&gt; combiner);\n    &lt;R, A&gt; R collect(Collector&lt;? super T, A, R&gt; collector);\n    Optional&lt;T&gt; min(Comparator&lt;? super T&gt; comparator);&#x2F;&#x2F;line30\n    Optional&lt;T&gt; max(Comparator&lt;? super T&gt; comparator);&#x2F;&#x2F;line31\n    long count();\n    boolean anyMatch(Predicate&lt;? super T&gt; predicate);\n    boolean allMatch(Predicate&lt;? super T&gt; predicate);\n    boolean noneMatch(Predicate&lt;? super T&gt; predicate);\n    Optional&lt;T&gt; findFirst();\n    Optional&lt;T&gt; findAny();\n\n    &#x2F;&#x2F; Static factories\n\n    public static&lt;T&gt; Builder&lt;T&gt; builder() &#123;\n        return new Streams.StreamBuilderImpl&lt;&gt;();\n    &#125;\n\n\n    public static&lt;T&gt; Stream&lt;T&gt; empty() &#123;\n        return StreamSupport.stream(Spliterators.&lt;T&gt;emptySpliterator(), false);\n    &#125;\n\n\n    public static&lt;T&gt; Stream&lt;T&gt; of(T t) &#123;\n        return StreamSupport.stream(new Streams.StreamBuilderImpl&lt;&gt;(t), false);\n    &#125;\n\n\n    @SafeVarargs\n    @SuppressWarnings(&quot;varargs&quot;) &#x2F;&#x2F; Creating a stream from an array is safe\n    public static&lt;T&gt; Stream&lt;T&gt; of(T... values) &#123;\n        return Arrays.stream(values);\n    &#125;\n\n\n    public static&lt;T&gt; Stream&lt;T&gt; iterate(final T seed, final UnaryOperator&lt;T&gt; f) &#123;\n        Objects.requireNonNull(f);\n        final Iterator&lt;T&gt; iterator &#x3D; new Iterator&lt;T&gt;() &#123;\n            @SuppressWarnings(&quot;unchecked&quot;)\n            T t &#x3D; (T) Streams.NONE;\n\n            @Override\n            public boolean hasNext() &#123;\n                return true;\n            &#125;\n\n            @Override\n            public T next() &#123;\n                return t &#x3D; (t &#x3D;&#x3D; Streams.NONE) ? seed : f.apply(t);\n            &#125;\n        &#125;;\n        return StreamSupport.stream(Spliterators.spliteratorUnknownSize(\n                iterator,\n                Spliterator.ORDERED | Spliterator.IMMUTABLE), false);\n    &#125;\n\n\n    public static&lt;T&gt; Stream&lt;T&gt; generate(Supplier&lt;T&gt; s) &#123;\n        Objects.requireNonNull(s);\n        return StreamSupport.stream(\n                new StreamSpliterators.InfiniteSupplyingSpliterator.OfRef&lt;&gt;(Long.MAX_VALUE, s), false);\n    &#125;\n\n\n    public static &lt;T&gt; Stream&lt;T&gt; concat(Stream&lt;? extends T&gt; a, Stream&lt;? extends T&gt; b) &#123;\n        Objects.requireNonNull(a);\n        Objects.requireNonNull(b);\n\n        @SuppressWarnings(&quot;unchecked&quot;)\n        Spliterator&lt;T&gt; split &#x3D; new Streams.ConcatSpliterator.OfRef&lt;&gt;(\n                (Spliterator&lt;T&gt;) a.spliterator(), (Spliterator&lt;T&gt;) b.spliterator());\n        Stream&lt;T&gt; stream &#x3D; StreamSupport.stream(split, a.isParallel() || b.isParallel());\n        return stream.onClose(Streams.composedClose(a, b));\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li><strong>Stream<T> filter(Predicate&lt;? super T&gt; predicate);</strong>  <em><code>//line2</code></em><br>äº§ç”Ÿä¸€ä¸ªæ–°æµï¼Œå…¶ä¸­åŒ…å«è°ƒç”¨æµä¸­æ»¡è¶³predicateæŒ‡å®šçš„è°“è¯å…ƒç´ (ä¸­é—´æ“ä½œ)</li>\n<li><strong><R> Stream<R> map(Function&lt;? super T, ? extends R&gt; mapper);</strong>  <em><code>//line3</code></em><br>äº§ç”Ÿä¸€ä¸ªæ–°æµï¼Œå¯¹è°ƒç”¨æµä¸­çš„å…ƒç´ åº”ç”¨mapperï¼Œæ–°æµä¸­åŒ…å«è¿™äº›å…ƒç´ ã€‚(ä¸­é—´æ“ä½œ)</li>\n<li><strong>IntStream mapToInt(ToIntFunction&lt;? super T&gt; mapper);</strong> <em><code>//line4</code></em><br>å¯¹è°ƒç”¨æµä¸­å…ƒç´ åº”ç”¨mapperï¼Œäº§ç”ŸåŒ…å«è¿™äº›å…ƒç´ çš„ä¸€ä¸ªæ–°IntStreamæµã€‚(ä¸­é—´æ“ä½œ)</li>\n<li><strong>Stream<T> sorted();</strong> <em><code>//line12</code></em></li>\n<li><strong>Stream<T> sorted(Comparator&lt;? super T&gt; comparator);</strong> <em><code>//line13</code></em>&#96;<br>äº§ç”Ÿä¸€ä¸ªè‡ªç„¶é¡ºåºæ’åºæˆ–è€…æŒ‡å®šæ’åºæ¡ä»¶çš„æ–°æµ(ä¸­é—´æ“ä½œ)</li>\n<li><strong>void forEach(Consumer&lt;? super T&gt; action);</strong>  <em><code>//line17</code></em></li>\n<li><strong>void forEachOrdered(Consumer&lt;? super T&gt; action);</strong> <em><code>//line18</code></em><br>éå†äº†æµä¸­çš„å…ƒç´ (ç»ˆç«¯æ“ä½œ)</li>\n<li><strong>Optional<T> min(Comparator&lt;? super T&gt; comparator)</strong>  <em><code>//line30</code></em></li>\n<li><strong>Optional<T> max(Comparator&lt;? super T&gt; comparator);</strong> <em><code>//line31</code></em><br>è·å¾—æµä¸­æœ€å¤§æœ€å°å€¼ï¼Œæ¯”è¾ƒå™¨å¯ä»¥ç”±è‡ªå·±å®šä¹‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨JDKæä¾›çš„(ç»ˆç«¯æ“ä½œ)</li>\n</ul>\n<h4 id=\"å°ç»“ä¸€ä¸‹\"><a href=\"#å°ç»“ä¸€ä¸‹\" class=\"headerlink\" title=\"å°ç»“ä¸€ä¸‹\"></a>å°ç»“ä¸€ä¸‹</h4><p>è¿™ä¸€ç¯‡ä¸»è¦æ˜¯ä»‹ç»äº†æµAPIçš„ä¸€äº›å…³é”®æ–¹æ³•ï¼Œå’Œä¸€äº›å…³é”®çš„æ¦‚å¿µï¼Œè™½ç„¶ç¨å¾®æ¯ç‡¥äº†ä¸€ç‚¹ï¼Œä½†æ˜¯ï¼Œä¸èƒ½å¦è®¤ï¼Œå…¨é¢åœ°å­¦ä¹ æµAPIï¼Œä¼šè®©ä½ å¯¹æµAPIçš„è®¤è¯†ä¼šæ›´åŠ çš„æ·±åˆ»ï¼Œæ‰€ä»¥å¦‚æœæ—¶é—´å…è®¸ï¼Œè¯·å†è®¤çœŸè¯»è¯»è¿™ä¸€ç¯‡æ–‡ç« å§ï¼Œå½“ç„¶ï¼Œä¹Ÿå¯ä»¥åœ¨å®è·µä¸­æ…¢æ…¢è®¤è¯†å®ƒä»¬ï¼Œä½†æ˜¯ï¼Œå¯¹äºè¿™äº›åŸºæœ¬æ¦‚å¿µçš„çŸ¥è¯†ï¼Œä½ è¶Šæ—©æŒæ¡ï¼Œå¯¹ä½ çš„ç›Šå¤„æ˜¯æ›´åŠ å¤§çš„ã€‚åˆ°æ­¤ä¸ºæ­¢ï¼ŒæµAPIçš„åŸºç¡€çŸ¥è¯†å·²ç»å­¦å®Œäº†ï¼Œåé¢çš„å‡ ç¯‡æ–‡ç« æˆ‘ä»¬å°±è¦å¼€å§‹æ›´åŠ æ·±å…¥åœ°ç†è§£å’Œè¿ç”¨ä»–ä»¬å®ç°ä¸€èµ·å¼ºæœ‰åŠ›çš„åŠŸèƒ½äº†ï¼</p>\n","excerpt":"","more":"<p>æˆ‘ä»¬çš„ç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œä¸»è¦æ˜¯é€šè¿‡ä¸€ä¸ªDemoï¼Œè®©å¤§å®¶ä½“éªŒäº†ä¸€ä¸‹ä½¿ç”¨æµAPIçš„é‚£ç§é…£ç•…æ·‹æ¼“çš„æ„Ÿè§‰ã€‚å¦‚æœä½ æ²¡æœ‰å®è·µï¼Œæˆ‘è¿˜æ˜¯å†æ¬¡å‘¼åä½ åŠ¨æ‰‹æ•²ä¸€æ•²ï¼Œè‡ªå·±å®å®åœ¨è·‘ä¸€éä¸Šä¸€ç¯‡çš„Demoã€‚ç›¸ä¿¡ä½ çš„æ„Ÿå—å’Œç†è§£ä¹Ÿä¼šéšä¹‹åŠ æ·±çš„ã€‚ç»§ç»­æ¢ç´¢æµAPIçš„é«˜çº§åŠŸèƒ½ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆä»æ¥å£çº§åˆ«å…¨é¢äº†è§£ä¸€ä¸‹æµAPIï¼Œè¿™ä¸ªå¯¹äºæˆ‘ä»¬æ¥è¯´æ˜¯è‡³å…³é‡è¦çš„ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ç»™å¤§å®¶å‡†å¤‡äº†ä¸€å¼ æµAPIå…³é”®çŸ¥è¯†ç‚¹çš„UMLå›¾ã€‚ä½†æ˜¯å¤§å®¶åªéœ€è¦èŠ±ä¸€ä¸¤åˆ†é’Ÿï¼Œæ•´ç†çœ‹ä¸€ä¸‹å°±å¯ä»¥äº†ï¼Œä¸éœ€è¦è®°ä½ï¼Œå…ˆæœ‰ä¸ªå°è±¡ï¼Œåé¢æˆ‘ç»™å¤§å®¶è®²è§£ä¸€äº›å…³é”®çš„æ–¹æ³•:</p>\n<h4 id=\"æµAPI-UML\"><a href=\"#æµAPI-UML\" class=\"headerlink\" title=\"æµAPI UML\"></a>æµAPI UML</h4><p><img src=\"https://upload-images.jianshu.io/upload_images/1640787-129cbee787eef3b4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\" alt=\"æµAPI UML\"></p>\n<p>æˆ‘å…ˆæ•´ä½“ä»‹ç»ä¸€ä¸‹:æµAPIå®šä¹‰çš„å‡ ä¸ªæ¥å£ï¼Œéƒ½æ˜¯åœ¨java.util.streamåŒ…ä¸­çš„.å…¶ä¸­ä¸Šå›¾ä¸­çš„BaseStreamæ¥å£æ˜¯æœ€åŸºç¡€çš„æ¥å£ï¼Œå®ƒæä¾›äº†æ‰€æœ‰æµéƒ½å¯ä»¥ä½¿ç”¨çš„åŸºæœ¬åŠŸèƒ½:</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public interface BaseStream&lt;T, S extends BaseStream&lt;T, S&gt;&gt; extends AutoCloseable &#123;\n&#x2F;&#x2F;....å…ˆå¿½ç•¥è¿™äº›å…·ä½“çš„ç»†èŠ‚\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>ç”±è¿™ä¸ªæ¥å£çš„å®šä¹‰æˆ‘ä»¬å¾—çŸ¥ï¼ŒBaseStreamæ˜¯ä¸€ä¸ªæ³›å‹æ¥å£,å®ƒæœ‰ä¸¤ä¸ªç±»å‹å‚æ•°Tå’ŒSï¼Œ å…¶ä¸­TæŒ‡å®šäº†æµä¸­çš„å…ƒç´ çš„ç±»å‹,å¹¶ä¸”ç”±&lt;S extends BaseStream&lt;T, S&gt;&gt;å¯ä»¥çŸ¥é“Så¿…é¡»ä¸ºBaseStreamæˆ–BaseStreamå­ç±»(æ¢å¥è¯è¯´,å°±æ˜¯Så¿…é¡»æ˜¯æ‰©å±•è‡ªBaseStreamçš„)ã€‚BaseStreamç»§æ‰¿äº†AutoCloseableæ¥å£ã€‚è¿™ä¸ªæ¥å£ä¸»è¦æ˜¯ç®€åŒ–äº†å…³é—­èµ„æºçš„æ“ä½œã€‚ä½†æ˜¯åƒå¹³æ—¶æˆ‘ä»¬æ“ä½œçš„é›†åˆæˆ–æ•°ç»„ï¼ŒåŸºæœ¬ä¸Šéƒ½ä¸ä¼šå‡ºç°å…³é—­æµçš„æƒ…å†µã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;&#x2F;ç”±BaseStreamæ¥å£æ´¾ç”Ÿå‡ºçš„æµæ¥å£åŒ…æ‹¬IntStream ï¼ŒLongStreamï¼ŒDoubleStream ï¼ŒStream&lt;T&gt;\npublic interface IntStream extends BaseStream&lt;Integer, IntStream&gt; &#123;\n&#125;\npublic interface LongStream extends BaseStream&lt;Long, LongStream&gt; &#123;\n&#125;\npublic interface DoubleStream extends BaseStream&lt;Double, DoubleStream&gt; &#123;\n&#125;\n\n&#x2F;&#x2F;è¿™æ˜¯æœ€å…·ä»£è¡¨æ€§çš„æ¥å£\npublic interface Stream&lt;T&gt; extends BaseStream&lt;T, Stream&lt;T&gt;&gt; &#123;\n&#x2F;&#x2F;....å…ˆå¿½ç•¥è¿™äº›å…·ä½“çš„ç»†èŠ‚\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç”±äºStreamæ¥å£æ˜¯æœ€å…·ä»£è¡¨æ€§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±é€‰æ‹©å®ƒæ¥è®²è§£ï¼Œå…¶å®åœ¨æˆ‘ä»¬å­¦å®ŒStreamæ¥å£ï¼Œå…¶å®ƒçš„ä¸‰ä¸ªæ¥å£ï¼Œåœ¨ä½¿ç”¨ä¸ŠåŸºæœ¬æ˜¯ä¸€è‡´çš„äº†ï¼Œæˆ‘ä»¬ä¸Šä¸€ç¯‡çš„DemoåŸºæœ¬ä¸Šä¹Ÿæ˜¯ä½¿ç”¨Streamæ¥å£æ¥åšçš„ç»ƒä¹ ã€‚æˆ‘ä»¬å›æƒ³ä¸€ä¸‹:åœ¨ä¸Šä¸€ä¸ªDemoä¸­æˆ‘ä»¬é€šè¿‡é›†åˆæ¡†æ¶çš„stream()æ–¹æ³•ï¼Œå°±èƒ½è¿”å›ä¸€ä¸ªæµäº†ï¼Œå®ƒçš„è¿”å›ç±»å‹å°±æ˜¯Stream<T>ï¼Œæ¯”å¦‚æˆ‘ä»¬Stream<Integer>ï¼Œç”±æ­¤å¾—çŸ¥ï¼ŒStreamæ¥å£é‡Œçš„ç±»å‹å‚æ•°Tå°±æ˜¯æµä¸­çš„å…ƒç´ çš„ç±»å‹ã€‚æœ¨æœ‰é”™ï¼Œå°±æ˜¯è¿™æ ·æ»´ã€‚åˆ°è¿™é‡Œï¼Œæ•´ä¸ªç³»åˆ—ä½ ä»¬å·²ç»å…¨éƒ¨å­¦ä¼šäº†ï¼Œä¸‹è¯¾ã€‚</p>\n<p><img src=\"https://upload-images.jianshu.io/upload_images/1640787-cac539e2ac3e760f.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\"></p>\n<p>æˆ˜æ–—æ‰åˆšåˆšå¼€å§‹ï¼</p>\n<p><img src=\"https://upload-images.jianshu.io/upload_images/1640787-65d8e79c87d2ec76.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240\"></p>\n<p>ç°åœ¨æ˜¯æ—¶å€™å¼€å§‹è®°å¿†ä¸€äº›çŸ¥è¯†äº†.</p>\n<h4 id=\"BaseStreamè¯¦è§£\"><a href=\"#BaseStreamè¯¦è§£\" class=\"headerlink\" title=\"BaseStreamè¯¦è§£:\"></a>BaseStreamè¯¦è§£:</h4><pre class=\"line-numbers language-none\"><code class=\"language-none\">public interface BaseStream&lt;T, S extends BaseStream&lt;T, S&gt;&gt; extends AutoCloseable &#123;\n     Iterator&lt;T&gt; iterator();&#x2F;&#x2F;line2\n     Spliterator&lt;T&gt; spliterator();&#x2F;&#x2F;line3\n     boolean isParallel();&#x2F;&#x2F;line4\n     S sequential();&#x2F;&#x2F;line5\n     S parallel();&#x2F;&#x2F;line6\n     S unordered();&#x2F;&#x2F;line7\n     S onClose(Runnable closeHandler);&#x2F;&#x2F;line8\n     @Override\n     void close();&#x2F;&#x2F;line10\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li><strong>Iterator<T> iterator();</strong>  <em><code>//line2</code></em><br>è·å¾—æµçš„è¿­ä»£å™¨ï¼Œå¹¶è¿”å›å¯¹è¯¥è¿­ä»£å™¨çš„å¼•ç”¨(ç»ˆç«¯æ“ä½œ)</li>\n<li><strong>Spliterator<T> spliterator();</strong> <em><code>//line3</code></em><br>è·å–æµçš„spliteratorï¼Œå¹¶è¿”å›å…¶å¼•ç”¨(ç»ˆç«¯æ“ä½œ)</li>\n<li><strong>boolean isParallel();</strong> <em><code>//line4</code></em><br>å¦‚æœè°ƒç”¨æµæ˜¯ä¸€ä¸ªå¹¶è¡Œæµï¼Œåˆ™è¿”å›true;å¦‚æœè°ƒç”¨æµæ˜¯ä¸€ä¸ªé¡ºåºæµï¼Œåˆ™è¿”å›falseã€‚</li>\n<li><strong>S sequential();</strong> <em><code>//line5</code></em><br>åŸºäºè°ƒç”¨æµï¼Œè¿”å›ä¸€ä¸ªé¡ºåºæµã€‚å¦‚æœè°ƒç”¨æµå·²ç»æ˜¯é¡ºåºæµäº†ï¼Œå°±è¿”å›è¯¥æµã€‚(ä¸­é—´æ“ä½œ)</li>\n<li><strong>S parallel();</strong> <em><code>//line6</code></em><br>åŸºäºè°ƒç”¨æµï¼Œè¿”å›ä¸€ä¸ªå¹¶è¡Œæµã€‚å¦‚æœè°ƒç”¨æµå·²ç»æ˜¯å¹¶è¡Œæµäº†ï¼Œå°±è¿”å›è¯¥æµã€‚(ä¸­é—´æ“ä½œ)</li>\n<li><strong>S unordered();</strong> <em><code>//line7</code></em><br>åŸºäºè°ƒç”¨æµï¼Œè¿”å›ä¸€ä¸ªæ— åºæµã€‚å¦‚æœè°ƒç”¨æµå·²ç»æ˜¯æ— åºæµäº†ï¼Œå°±è¿”å›è¯¥æµã€‚(ä¸­é—´æ“ä½œ)</li>\n<li><strong>S onClose(Runnable closeHandler);</strong> <em><code>//line8</code></em><br>è¿”å›ä¸€ä¸ªæ–°æµï¼ŒcloseHandleræŒ‡å®šäº†è¯¥æµçš„å…³é—­å¤„ç†ç¨‹åºï¼Œå½“å…³é—­è¯¥æµæ—¶ï¼Œå°†è°ƒç”¨è¿™ä¸ªå¤„ç†ç¨‹åºã€‚(ä¸­é—´æ“ä½œ)</li>\n<li><strong>void close();</strong> <em><code>//line10</code></em><br>ä»AutoCloseableç»§æ‰¿æ¥çš„ï¼Œè°ƒç”¨æ³¨å†Œå…³é—­å¤„ç†ç¨‹åºï¼Œå…³é—­è°ƒç”¨æµ(å¾ˆå°‘ä¼šè¢«ä½¿ç”¨åˆ°)</li>\n</ul>\n<h4 id=\"â€œç»ˆç«¯æ“ä½œâ€-â€ä¸­é—´æ“ä½œâ€\"><a href=\"#â€œç»ˆç«¯æ“ä½œâ€-â€ä¸­é—´æ“ä½œâ€\" class=\"headerlink\" title=\"â€œç»ˆç«¯æ“ä½œâ€&amp;â€ä¸­é—´æ“ä½œâ€\"></a>â€œç»ˆç«¯æ“ä½œâ€&amp;â€ä¸­é—´æ“ä½œâ€</h4><p>ç»†å¿ƒçš„åŒå­¦åº”è¯¥æ³¨æ„åˆ°äº†ï¼ŒBaseStreamæ¥å£é‡Œé¢çš„å¾ˆå¤šæ–¹æ³•éƒ½åœ¨æœ€åæ ‡è¯†äº†(ç»ˆç«¯æ“ä½œ)å’Œ(ä¸­é—´æ“ä½œ)ï¼Œå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯éå¸¸é‡è¦çš„ã€‚</p>\n<ul>\n<li><p><strong>ç»ˆç«¯æ“ä½œ</strong>   ä¼šæ¶ˆè´¹æµï¼Œè¿™ç§æ“ä½œä¼šäº§ç”Ÿä¸€ä¸ªç»“æœçš„ï¼Œæ¯”å¦‚ä¸Šé¢çš„ iterator()å’Œ spliterator()ï¼Œä»¥åŠä¸Šä¸€ç¯‡ä¸­æåˆ°çš„min()å’Œmax()ï¼Œæˆ–è€…æ˜¯æ‰§è¡ŒæŸä¸€ç§æ“ä½œï¼Œæ¯”å¦‚ä¸Šä¸€ç¯‡çš„forEach()ï¼Œå¦‚æœä¸€ä¸ªæµè¢«æ¶ˆè´¹è¿‡äº†ï¼Œé‚£å®ƒå°±ä¸èƒ½è¢«é‡ç”¨çš„ã€‚</p>\n</li>\n<li><p><strong>ä¸­é—´æ“ä½œ</strong>   ä¸­é—´æ“ä½œä¼šäº§ç”Ÿå¦ä¸€ä¸ªæµã€‚å› æ­¤ä¸­é—´æ“ä½œå¯ä»¥ç”¨æ¥åˆ›å»ºæ‰§è¡Œä¸€ç³»åˆ—åŠ¨ä½œçš„ç®¡é“ã€‚ä¸€ä¸ªç‰¹åˆ«éœ€è¦æ³¨æ„çš„ç‚¹æ˜¯:ä¸­é—´æ“ä½œä¸æ˜¯ç«‹å³å‘ç”Ÿçš„ã€‚ç›¸åï¼Œå½“åœ¨ä¸­é—´æ“ä½œåˆ›å»ºçš„æ–°æµä¸Šæ‰§è¡Œå®Œç»ˆç«¯æ“ä½œåï¼Œä¸­é—´æ“ä½œæŒ‡å®šçš„æ“ä½œæ‰ä¼šå‘ç”Ÿã€‚æ‰€ä»¥ä¸­é—´æ“ä½œæ˜¯å»¶è¿Ÿå‘ç”Ÿçš„ï¼Œä¸­é—´æ“ä½œçš„å»¶è¿Ÿè¡Œä¸ºä¸»è¦æ˜¯è®©æµAPIèƒ½å¤Ÿæ›´åŠ é«˜æ•ˆåœ°æ‰§è¡Œã€‚</p>\n</li>\n</ul>\n<h4 id=\"â€œä¸­é—´æ“ä½œâ€çš„çŠ¶æ€\"><a href=\"#â€œä¸­é—´æ“ä½œâ€çš„çŠ¶æ€\" class=\"headerlink\" title=\"â€œä¸­é—´æ“ä½œâ€çš„çŠ¶æ€\"></a>â€œä¸­é—´æ“ä½œâ€çš„çŠ¶æ€</h4><p>æµçš„ä¸­é—´æ“ä½œï¼Œå¯ä»¥ä¸ºåˆ†<code>æ— çŠ¶æ€æ“ä½œ</code>å’Œ<code>æœ‰çŠ¶æ€æ“ä½œ</code>ä¸¤ç§ï¼Œåœ¨æ— çŠ¶æ€æ“ä½œä¸­ï¼Œåœ¨å¤„ç†æµä¸­çš„å…ƒç´ æ—¶ï¼Œä¼šå¯¹å½“å‰çš„å…ƒç´ è¿›è¡Œå•ç‹¬å¤„ç†ã€‚æ¯”å¦‚:è°“è¯è¿‡æ»¤æ“ä½œï¼Œå› ä¸ºæ¯ä¸ªå…ƒç´ éƒ½æ˜¯è¢«å•ç‹¬è¿›è¡Œå¤„ç†çš„ï¼Œæ‰€æœ‰å®ƒå’Œæµä¸­çš„å…¶å®ƒå…ƒç´ æ— å…³ï¼Œå› æ­¤è¢«ç§°ä¸ºæ— çŠ¶æ€æ“ä½œ;è€Œåœ¨æœ‰çŠ¶æ€æ“ä½œä¸­ï¼ŒæŸä¸ªå…ƒç´ çš„å¤„ç†å¯èƒ½ä¾èµ–äºå…¶ä»–å…ƒç´ ã€‚æ¯”å¦‚æŸ¥æ‰¾æœ€å°å€¼ï¼Œæœ€å¤§å€¼ï¼Œå’Œæ’åºï¼Œå› ä¸ºä»–ä»¬éƒ½ä¾èµ–äºå…¶ä»–çš„å…ƒç´ ã€‚å› æ­¤ä¸ºç§°ä¸ºæœ‰çŠ¶æ€æ“ä½œã€‚<code>å½“éœ€è¦è¿›è¡Œå¹¶è¡Œå¤„ç†æµæ—¶ï¼Œæœ‰çŠ¶æ€çš„æ“ä½œå’Œæ— çŠ¶æ€çš„åŒºåˆ«æ˜¯éå¸¸é‡è¦çš„ï¼Œå› ä¸ºæœ‰çŠ¶æ€æ“ä½œå¯èƒ½éœ€è¦å‡ æ¬¡å¤„ç†æ‰èƒ½å®Œæˆï¼Œåé¢çš„æ–‡ç« æˆ‘å°†ä¼šç»™å¤§å®¶è¯¦ç»†åœ°è®²ï¼Œç°åœ¨åªéœ€è¦æ­£å¸¸å­¦ä¹ ä¸‹å»å°±å¯ä»¥äº†</code></p>\n<p>å¦å¤–ï¼ŒæŒ‡å‡ºä¸€ç‚¹ï¼Œå¦‚æœå¤§å®¶äº†è§£æ³›å‹çš„è¯ï¼Œåº”è¯¥çŸ¥é“ï¼Œæ³›å‹çš„ç±»å‹å‚æ•°åªèƒ½æ˜¯å¼•ç”¨ç±»å‹ï¼Œå› æ­¤Streamæ“ä½œçš„å¯¹è±¡åªèƒ½æ˜¯å¼•ç”¨ç±»å‹çš„ï¼Œä¸èƒ½ç”¨äºåŸºæœ¬ç±»å‹ã€‚å½“ç„¶å®˜æ–¹æ—©å·²è€ƒè™‘åˆ°è¿™ä¸€ç‚¹äº†ï¼Œå‰é¢ä½ ä»¬çœ‹åˆ°çš„IntStreamï¼ŒLongStreamï¼ŒDoubleStreamå°±æ˜¯å®˜æ–¹ç»™æˆ‘ä»¬æä¾›çš„å¤„ç†åŸºæœ¬ç±»å‹çš„æµäº†ã€‚æ­¤å¤„æ˜¯ä¸æ˜¯åº”è¯¥ç»™ä»–ä»¬æŒå£°ï¼</p>\n<h4 id=\"Streamè¯¦è§£\"><a href=\"#Streamè¯¦è§£\" class=\"headerlink\" title=\"Streamè¯¦è§£\"></a>Streamè¯¦è§£</h4><p>åœ¨æœ‰äº†å‰é¢çš„é‚£äº›çŸ¥è¯†ä½œé“ºå«ä¹‹åï¼Œå­¦Streamæ¥å£åº”è¯¥ä¼šé¡ºé£é¡ºæ°´äº†ã€‚è¿˜æ˜¯å…ˆçœ‹çœ‹Streamçš„è¯¦æƒ…å…ˆ:</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public interface Stream&lt;T&gt; extends BaseStream&lt;T, Stream&lt;T&gt;&gt; &#123;\n    Stream&lt;T&gt; filter(Predicate&lt;? super T&gt; predicate);&#x2F;&#x2F;line2\n    &lt;R&gt; Stream&lt;R&gt; map(Function&lt;? super T, ? extends R&gt; mapper);&#x2F;&#x2F;line3\n    IntStream mapToInt(ToIntFunction&lt;? super T&gt; mapper);&#x2F;&#x2F;line4\n    LongStream mapToLong(ToLongFunction&lt;? super T&gt; mapper);\n    DoubleStream mapToDouble(ToDoubleFunction&lt;? super T&gt; mapper);\n    &lt;R&gt; Stream&lt;R&gt; flatMap(Function&lt;? super T, ? extends Stream&lt;? extends R&gt;&gt; mapper);\n    IntStream flatMapToInt(Function&lt;? super T, ? extends IntStream&gt; mapper);\n    LongStream flatMapToLong(Function&lt;? super T, ? extends LongStream&gt; mapper);\n    DoubleStream flatMapToDouble(Function&lt;? super T, ? extends DoubleStream&gt; mapper);\n    Stream&lt;T&gt; distinct();\n    Stream&lt;T&gt; sorted();&#x2F;&#x2F;line12\n    Stream&lt;T&gt; sorted(Comparator&lt;? super T&gt; comparator);&#x2F;&#x2F;line13\n    Stream&lt;T&gt; peek(Consumer&lt;? super T&gt; action);\n    Stream&lt;T&gt; limit(long maxSize);\n    Stream&lt;T&gt; skip(long n);\n    void forEach(Consumer&lt;? super T&gt; action);&#x2F;&#x2F;line17\n    void forEachOrdered(Consumer&lt;? super T&gt; action);&#x2F;&#x2F;line18\n    Object[] toArray();\n    &lt;A&gt; A[] toArray(IntFunction&lt;A[]&gt; generator);\n    T reduce(T identity, BinaryOperator&lt;T&gt; accumulator);\n    Optional&lt;T&gt; reduce(BinaryOperator&lt;T&gt; accumulator);\n    &lt;U&gt; U reduce(U identity,\n                 BiFunction&lt;U, ? super T, U&gt; accumulator,\n                 BinaryOperator&lt;U&gt; combiner);\n    &lt;R&gt; R collect(Supplier&lt;R&gt; supplier,\n                  BiConsumer&lt;R, ? super T&gt; accumulator,\n                  BiConsumer&lt;R, R&gt; combiner);\n    &lt;R, A&gt; R collect(Collector&lt;? super T, A, R&gt; collector);\n    Optional&lt;T&gt; min(Comparator&lt;? super T&gt; comparator);&#x2F;&#x2F;line30\n    Optional&lt;T&gt; max(Comparator&lt;? super T&gt; comparator);&#x2F;&#x2F;line31\n    long count();\n    boolean anyMatch(Predicate&lt;? super T&gt; predicate);\n    boolean allMatch(Predicate&lt;? super T&gt; predicate);\n    boolean noneMatch(Predicate&lt;? super T&gt; predicate);\n    Optional&lt;T&gt; findFirst();\n    Optional&lt;T&gt; findAny();\n\n    &#x2F;&#x2F; Static factories\n\n    public static&lt;T&gt; Builder&lt;T&gt; builder() &#123;\n        return new Streams.StreamBuilderImpl&lt;&gt;();\n    &#125;\n\n\n    public static&lt;T&gt; Stream&lt;T&gt; empty() &#123;\n        return StreamSupport.stream(Spliterators.&lt;T&gt;emptySpliterator(), false);\n    &#125;\n\n\n    public static&lt;T&gt; Stream&lt;T&gt; of(T t) &#123;\n        return StreamSupport.stream(new Streams.StreamBuilderImpl&lt;&gt;(t), false);\n    &#125;\n\n\n    @SafeVarargs\n    @SuppressWarnings(&quot;varargs&quot;) &#x2F;&#x2F; Creating a stream from an array is safe\n    public static&lt;T&gt; Stream&lt;T&gt; of(T... values) &#123;\n        return Arrays.stream(values);\n    &#125;\n\n\n    public static&lt;T&gt; Stream&lt;T&gt; iterate(final T seed, final UnaryOperator&lt;T&gt; f) &#123;\n        Objects.requireNonNull(f);\n        final Iterator&lt;T&gt; iterator &#x3D; new Iterator&lt;T&gt;() &#123;\n            @SuppressWarnings(&quot;unchecked&quot;)\n            T t &#x3D; (T) Streams.NONE;\n\n            @Override\n            public boolean hasNext() &#123;\n                return true;\n            &#125;\n\n            @Override\n            public T next() &#123;\n                return t &#x3D; (t &#x3D;&#x3D; Streams.NONE) ? seed : f.apply(t);\n            &#125;\n        &#125;;\n        return StreamSupport.stream(Spliterators.spliteratorUnknownSize(\n                iterator,\n                Spliterator.ORDERED | Spliterator.IMMUTABLE), false);\n    &#125;\n\n\n    public static&lt;T&gt; Stream&lt;T&gt; generate(Supplier&lt;T&gt; s) &#123;\n        Objects.requireNonNull(s);\n        return StreamSupport.stream(\n                new StreamSpliterators.InfiniteSupplyingSpliterator.OfRef&lt;&gt;(Long.MAX_VALUE, s), false);\n    &#125;\n\n\n    public static &lt;T&gt; Stream&lt;T&gt; concat(Stream&lt;? extends T&gt; a, Stream&lt;? extends T&gt; b) &#123;\n        Objects.requireNonNull(a);\n        Objects.requireNonNull(b);\n\n        @SuppressWarnings(&quot;unchecked&quot;)\n        Spliterator&lt;T&gt; split &#x3D; new Streams.ConcatSpliterator.OfRef&lt;&gt;(\n                (Spliterator&lt;T&gt;) a.spliterator(), (Spliterator&lt;T&gt;) b.spliterator());\n        Stream&lt;T&gt; stream &#x3D; StreamSupport.stream(split, a.isParallel() || b.isParallel());\n        return stream.onClose(Streams.composedClose(a, b));\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<ul>\n<li><strong>Stream<T> filter(Predicate&lt;? super T&gt; predicate);</strong>  <em><code>//line2</code></em><br>äº§ç”Ÿä¸€ä¸ªæ–°æµï¼Œå…¶ä¸­åŒ…å«è°ƒç”¨æµä¸­æ»¡è¶³predicateæŒ‡å®šçš„è°“è¯å…ƒç´ (ä¸­é—´æ“ä½œ)</li>\n<li><strong><R> Stream<R> map(Function&lt;? super T, ? extends R&gt; mapper);</strong>  <em><code>//line3</code></em><br>äº§ç”Ÿä¸€ä¸ªæ–°æµï¼Œå¯¹è°ƒç”¨æµä¸­çš„å…ƒç´ åº”ç”¨mapperï¼Œæ–°æµä¸­åŒ…å«è¿™äº›å…ƒç´ ã€‚(ä¸­é—´æ“ä½œ)</li>\n<li><strong>IntStream mapToInt(ToIntFunction&lt;? super T&gt; mapper);</strong> <em><code>//line4</code></em><br>å¯¹è°ƒç”¨æµä¸­å…ƒç´ åº”ç”¨mapperï¼Œäº§ç”ŸåŒ…å«è¿™äº›å…ƒç´ çš„ä¸€ä¸ªæ–°IntStreamæµã€‚(ä¸­é—´æ“ä½œ)</li>\n<li><strong>Stream<T> sorted();</strong> <em><code>//line12</code></em></li>\n<li><strong>Stream<T> sorted(Comparator&lt;? super T&gt; comparator);</strong> <em><code>//line13</code></em>&#96;<br>äº§ç”Ÿä¸€ä¸ªè‡ªç„¶é¡ºåºæ’åºæˆ–è€…æŒ‡å®šæ’åºæ¡ä»¶çš„æ–°æµ(ä¸­é—´æ“ä½œ)</li>\n<li><strong>void forEach(Consumer&lt;? super T&gt; action);</strong>  <em><code>//line17</code></em></li>\n<li><strong>void forEachOrdered(Consumer&lt;? super T&gt; action);</strong> <em><code>//line18</code></em><br>éå†äº†æµä¸­çš„å…ƒç´ (ç»ˆç«¯æ“ä½œ)</li>\n<li><strong>Optional<T> min(Comparator&lt;? super T&gt; comparator)</strong>  <em><code>//line30</code></em></li>\n<li><strong>Optional<T> max(Comparator&lt;? super T&gt; comparator);</strong> <em><code>//line31</code></em><br>è·å¾—æµä¸­æœ€å¤§æœ€å°å€¼ï¼Œæ¯”è¾ƒå™¨å¯ä»¥ç”±è‡ªå·±å®šä¹‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨JDKæä¾›çš„(ç»ˆç«¯æ“ä½œ)</li>\n</ul>\n<h4 id=\"å°ç»“ä¸€ä¸‹\"><a href=\"#å°ç»“ä¸€ä¸‹\" class=\"headerlink\" title=\"å°ç»“ä¸€ä¸‹\"></a>å°ç»“ä¸€ä¸‹</h4><p>è¿™ä¸€ç¯‡ä¸»è¦æ˜¯ä»‹ç»äº†æµAPIçš„ä¸€äº›å…³é”®æ–¹æ³•ï¼Œå’Œä¸€äº›å…³é”®çš„æ¦‚å¿µï¼Œè™½ç„¶ç¨å¾®æ¯ç‡¥äº†ä¸€ç‚¹ï¼Œä½†æ˜¯ï¼Œä¸èƒ½å¦è®¤ï¼Œå…¨é¢åœ°å­¦ä¹ æµAPIï¼Œä¼šè®©ä½ å¯¹æµAPIçš„è®¤è¯†ä¼šæ›´åŠ çš„æ·±åˆ»ï¼Œæ‰€ä»¥å¦‚æœæ—¶é—´å…è®¸ï¼Œè¯·å†è®¤çœŸè¯»è¯»è¿™ä¸€ç¯‡æ–‡ç« å§ï¼Œå½“ç„¶ï¼Œä¹Ÿå¯ä»¥åœ¨å®è·µä¸­æ…¢æ…¢è®¤è¯†å®ƒä»¬ï¼Œä½†æ˜¯ï¼Œå¯¹äºè¿™äº›åŸºæœ¬æ¦‚å¿µçš„çŸ¥è¯†ï¼Œä½ è¶Šæ—©æŒæ¡ï¼Œå¯¹ä½ çš„ç›Šå¤„æ˜¯æ›´åŠ å¤§çš„ã€‚åˆ°æ­¤ä¸ºæ­¢ï¼ŒæµAPIçš„åŸºç¡€çŸ¥è¯†å·²ç»å­¦å®Œäº†ï¼Œåé¢çš„å‡ ç¯‡æ–‡ç« æˆ‘ä»¬å°±è¦å¼€å§‹æ›´åŠ æ·±å…¥åœ°ç†è§£å’Œè¿ç”¨ä»–ä»¬å®ç°ä¸€èµ·å¼ºæœ‰åŠ›çš„åŠŸèƒ½äº†ï¼</p>\n"},{"title":"Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆå…­ï¼‰æ”¶é›†","date":"2025-10-15T03:36:33.000Z","_content":"\næˆ‘ä»¬å‰é¢çš„äº”ç¯‡æ–‡ç« åŸºæœ¬éƒ½æ˜¯åœ¨è¯´å°†ä¸€ä¸ªé›†åˆè½¬æˆä¸€ä¸ªæµï¼Œç„¶åå¯¹æµè¿›è¡Œæ“ä½œï¼Œå…¶å®è¿™ç§æ“ä½œæ˜¯æœ€å¤šçš„ï¼Œä½†æœ‰æ—¶å€™æˆ‘ä»¬ä¹Ÿæ˜¯éœ€è¦ä»æµä¸­æ”¶é›†èµ·ä¸€äº›å…ƒç´ ï¼Œå¹¶ä»¥é›†åˆçš„æ–¹å¼è¿”å›ï¼Œæˆ‘ä»¬æŠŠè¿™ç§åå‘æ“ä½œç§°ä¸ºæ”¶é›†ã€‚\n\næµAPIä¹Ÿç»™æˆ‘ä»¬æä¾›äº†ç›¸åº”çš„æ–¹æ³•ã€‚\n\n#### å¦‚ä½•åœ¨æµä¸­ä½¿ç”¨æ”¶é›†åŠŸèƒ½ï¼Ÿ\n\næˆ‘ä»¬å…ˆçœ‹ä¸€çœ‹æµAPIç»™æˆ‘ä»¬æä¾›çš„æ–¹æ³•ï¼š\n\n```\npublic interface Stream<T> extends BaseStream<T, Stream<T>> {\n//...å¿½ç•¥é‚£äº›ä¸é‡è¦çš„ä¸œè¥¿\n<R> R collect(Supplier<R> supplier,\n                  BiConsumer<R, ? super T> accumulator,\n                  BiConsumer<R, R> combiner);\n<R, A> R collect(Collector<? super T, A, R> collector);\nï½\n```\n\næµAPIä¸­ç»™æˆ‘ä»¬æä¾›äº†ä¸¤ç§ï¼Œæˆ‘ç»™å¤§å®¶åˆ†æä¸€ä¸‹\n\n**<R, A> R collect(Collector<? super T, A, R> collector);**\n\nå…¶ä¸­RæŒ‡å®šç»“æœçš„ç±»å‹ï¼ŒTæŒ‡å®šäº†è°ƒç”¨æµçš„å…ƒç´ ç±»å‹ã€‚å†…éƒ¨ç§¯ç´¯çš„ç±»å‹ç”±AæŒ‡å®šã€‚collectorFuncæ˜¯ä¸€ä¸ªæ”¶é›†å™¨ï¼ŒæŒ‡å®šæ”¶é›†è¿‡ç¨‹å¦‚ä½•æ‰§è¡Œï¼Œcollect()æ–¹æ³•æ˜¯ä¸€ä¸ªç»ˆç«¯æ–¹æ³•ã€‚\n\nè™½ç„¶æˆ‘ä»¬åŸºæœ¬ä¸Šå¾ˆå°‘ä¼šç”¨åˆ°è‡ªå®šä¹‰çš„collectorFunc,ä½†æ˜¯äº†ä¸ºæ‰©å±•å¤§å®¶çš„çŸ¥è¯†é¢ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç®€å•åœ°èŠä¸€èŠCollectorï¼ŒBecause it's my style! \n\n`Collector`æ¥å£ä½äº`java.util.stream`åŒ…ä¸­çš„å£°æ˜ï¼Œå®ƒçš„å®¹é¢œæ˜¯è¿™æ ·çš„ï¼š\n\n```\npackage java.util.stream;\npublic interface Collector<T, A, R> {\n      Supplier<A> supplier();\n      BiConsumer<A, T> accumulator();\n      BinaryOperator<A> combiner();\n      Function<A, R> finisher();\n}\n```\n\nå…¶ä¸­Tã€Aã€Rçš„å«ä¹‰å’Œä¸Šé¢æ˜¯ä¸€æ ·çš„`å…¶ä¸­RæŒ‡å®šç»“æœçš„ç±»å‹ï¼ŒTæŒ‡å®šäº†è°ƒç”¨æµçš„å…ƒç´ ç±»å‹ã€‚å†…éƒ¨ç§¯ç´¯çš„ç±»å‹ç”±AæŒ‡å®š`ã€‚\n\nä½†æ˜¯è¿™ä¸€ç¯‡æˆ‘ä»¬ä¸å®ç°ä»–ä»¬ï¼Œå› ä¸ºJDKå·²ç»ç»™æˆ‘ä»¬æä¾›äº†å¾ˆå¼ºå¤§çš„æ–¹æ³•äº†ï¼Œä»–ä»¬ä½äº`java.util.stream`ä¸‹é¢çš„`Collectors`ç±»ï¼Œæˆ‘ä»¬æœ¬ç¯‡ä¹Ÿä¸»è¦æ˜¯ä½¿ç”¨`Collectors`æ¥å®ç°æ”¶é›†çš„åŠŸèƒ½ã€‚\n\n`Collectors`ç±»æ˜¯ä¸€ä¸ªæœ€ç»ˆç±»ï¼Œé‡Œé¢æä¾›äº†å¤§é‡çš„é™æ€çš„æ”¶é›†å™¨æ–¹æ³•ï¼Œå€ŸåŠ©ä»–ï¼Œæˆ‘ä»¬åŸºæœ¬å¯ä»¥å®ç°å„ç§å¤æ‚çš„åŠŸèƒ½äº†ã€‚\n\næˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹toListå’ŒtoSetæ–¹æ³•:\n\n```\npublic static <T>  Collector<T, ?, List<T>> toList()\npublic static <T> Collector<T, ?, Set<T>> toSet()\n```\n\nå…¶ä¸­`Collectors#toList()`è¿”å›çš„æ”¶é›†å™¨å¯ä»¥æŠŠæµä¸­å…ƒç´ æ”¶é›†åˆ°ä¸€ä¸ªListä¸­ï¼Œ`Collectors#toSet()`è¿”å›çš„æ”¶é›†å™¨å¯ä»¥æŠŠæµä¸­çš„å…ƒç´ æ”¶é›†åˆ°ä¸€ä¸ªSetä¸­ã€‚æ¯”å¦‚ï¼šå¦‚æœä½ æƒ³æŠŠå…ƒç´ æ”¶é›†åˆ°Listä¸­ï¼Œä½ å¯ä»¥è¿™æ ·ç”¨ï¼Œ`steam.collect(Collectors.toList)`ã€‚\n\næ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æŠŠæˆ‘ä»¬çš„ç‹è€…è£è€€å›¢é˜Ÿç»æµä¾‹å­ä¿®æ”¹ä¸€ä¸‹ï¼ŒæŠŠæ˜æ˜Ÿç©å®¶å’Œå½“å‰è·å¾—çš„é‡‘å¸æ•°æ”¶é›†åˆ°ä¸€ä¸ªListé‡Œé¢ï¼ŒæŠŠå‡ºåœºçš„è‹±é›„æ”¶é›†åˆ°ä¸€ä¸ªSeté‡Œé¢ï¼š\n\n```\n#ç©å®¶ä½¿ç”¨çš„è‹±é›„ä»¥åŠå½“å‰è·å¾—çš„é‡‘å¸æ•°\npublic class HeroPlayerGold {\n    /** ä½¿ç”¨çš„è‹±é›„åå­— */\n    private String hero;\n    /** ç©å®¶çš„ID */\n    private String player;\n    /** è·å¾—çš„é‡‘å¸æ•° */\n    private int gold;\n\n\n    public HeroPlayerGold(String hero, String player, int gold) {\n        this.hero = hero;\n        this.player = player;\n        this.gold = gold;\n    }\n\n    @Override\n    public String toString() {\n        return \"HeroPlayerGold{\" +\n                \"hero='\" + hero + '\\'' +\n                \", player='\" + player + '\\'' +\n                \", gold=\" + gold +\n                '}';\n    }\n//çœç•¥get/set\n}\n\n#å‡ºåœºçš„è‹±é›„\npublic class Hero {\n    /** ä½¿ç”¨çš„è‹±é›„åå­— */\n    private String hero;\n\n    public Hero(String hero) {\n        this.hero = hero;\n    }\n\n    @Override\n    public String toString() {\n        return \"Hero{\" +\n                \"hero='\" + hero + '\\'' +\n                '}';\n    }\n//çœç•¥get/set\n}\n\n#æµ‹è¯•ç±»\npublic class Main {\n    public static void main(String[] args) {\n        learnCollect();\n    }\n\n    private static void learnCollect() {\n        List<HeroPlayerGold> lists = new ArrayList<>();\n        lists.add(new HeroPlayerGold(\"ç›–ä¼¦\", \"RNG-Letme\", 100));\n        lists.add(new HeroPlayerGold(\"è¯¸è‘›äº®\", \"RNG-Xiaohu\", 300));\n        lists.add(new HeroPlayerGold(\"éœ²å¨œ\", \"RNG-MLXG\", 300));\n        lists.add(new HeroPlayerGold(\"ç‹„ä»æ°\", \"RNG-UZI\", 500));\n        lists.add(new HeroPlayerGold(\"ç‰›å¤´\", \"RNG-Ming\", 500));\n\n        List<PlayerGold> playerGolds = lists.stream()\n                .map(plary -> new PlayerGold(plary.getPlayer(), plary.getGold()))\n                .collect(Collectors.toList());\n        System.out.println(\"============PlayerGold begin==============\");\n        playerGolds.forEach(System.out::println);\n        System.out.println(\"============PlayerGold end================\\n\");\n\n\n\n        Set<Hero> heroes = lists.stream().map(player -> new Hero(player.getHero())).collect(Collectors.toSet());\n        System.out.println(\"============Hero begin==============\");\n        heroes.forEach(System.out::println);\n        System.out.println(\"============Hero end================\");\n    }\n}\n```\n\nè¾“å‡ºçš„æ—¥å¿—ï¼š\n\n```\n============PlayerGold begin==============\nPlayerGold{player='RNG-Letme', gold=100}\nPlayerGold{player='RNG-Xiaohu', gold=300}\nPlayerGold{player='RNG-MLXG', gold=300}\nPlayerGold{player='RNG-UZI', gold=500}\nPlayerGold{player='RNG-Ming', gold=500}\n============PlayerGold end================\n\n============Hero begin==============\nHero{hero='éœ²å¨œ'}\nHero{hero='ç‰›å¤´'}\nHero{hero='ç›–ä¼¦'}\nHero{hero='ç‹„ä»æ°'}\nHero{hero='è¯¸è‘›äº®'}\n============Hero end================\n```\n\nçœ‹åˆ°è¿™é‡Œï¼Œå¤§å®¶æœ‰æ„Ÿå—åˆ°æµAPIçš„å¨åŠ›äº†å—ï¼Ÿæç¤ºä¸€ä¸‹ï¼Œå°è£…ä¸€ä¸ªå·¥å…·ç±»ï¼Œç„¶åç»“åˆä¸€FastJsonè¿™ç§ä¸œè¥¿ä¸€èµ·ä½¿ç”¨ï¼æ˜¯çœŸçš„å¥½ç”¨å•Šï¼å…¶å®å°†æ•°æ®ä»é›†åˆç§»åˆ°æµä¸­ï¼Œæˆ–è€…å°†æ•°æ®ä»æµç§»å›é›†åˆçš„èƒ½åŠ›ï¼Œæ˜¯æµAPIç»™æˆ‘ä»¬æä¾›çš„ä¸€ä¸ªå¼ºå¤§ç‰¹æ€§ï¼Œå› ä¸ºè¿™å…è®¸é€šè¿‡æµæ¥æ“ä½œé›†åˆï¼Œç„¶åæŠŠæµé‡æ–°æ‰“åŒ…æˆé›†åˆã€‚æ­¤å¤–ï¼Œæ¡ä»¶åˆé€‚çš„æ—¶å€™ï¼Œè®©æµæ“ä½œå¹¶è¡Œå‘ç”Ÿï¼Œæé«˜æ•ˆç‡ã€‚\n\næ¥ä¸‹æ¥æˆ‘ä»¬åˆ†æç¬¬äºŒä¸ªæ–¹æ³•ï¼Œ\n\n```\n <R> R collect(Supplier<R> supplier,\n                  BiConsumer<R, ? super T> accumulator,\n                  BiConsumer<R, R> combiner);\n```\n\næˆ‘ä»¬ç¬¬äºŒä¸ªç‰ˆæœ¬çš„æ”¶é›†æ–¹æ³•ï¼Œä¸»è¦æ˜¯å¯ä»¥åœ¨æ”¶é›†çš„è¿‡ç¨‹ä¸­ï¼Œç»™äºˆæ›´å¤šçš„æ§åˆ¶ã€‚å…¶ä¸­supplieræŒ‡å®šå¦‚ä½•åˆ›å»ºç”¨äºä¿å­˜ç»“æœçš„å¯¹è±¡ï¼Œæ¯”å¦‚ï¼Œè¦ä½¿ç”¨ArrayListä½œä¸ºç»“æœçš„é›†åˆï¼Œéœ€è¦æŒ‡å®šå®ƒçš„æ„é€ å‡½æ•°ï¼Œaccumulatorå‡½æ•°æ˜¯å°†ä¸€ä¸ªå…ƒç´ æ·»åŠ åˆ°ç»“æœä¸­ï¼Œè€Œcombinerå‡½æ•°åˆå¹¶ä¸¤ä¸ªéƒ¨åˆ†çš„ç»“æœã€‚\n\nå¤§å®¶åº”è¯¥å‘ç°äº†å§ï¼Œä»–çš„å·¥ä½œæ–¹å¼å’Œæˆ‘ä»¬ç¬¬ä¸‰ç¯‡ä»‹ç»ç¼©å‡æ“ä½œæ—¶çš„reduceæ–¹æ³•æ˜¯å¾ˆåƒçš„ã€‚å®ƒä»¬éƒ½å¿…é¡»æ˜¯æ— çŠ¶æ€å’Œä¸å¹²é¢„çš„ï¼Œå¹¶ä¸”å¿…é¡»æœ‰å…³è”æ€§ï¼Œä¸‰ä¸ªçº¦æŸæ¡ä»¶ç¼ºä¸€ä¸å¯ã€‚\n\n`Supplier`ä¹Ÿæ˜¯`java.util.function`åŒ…ä¸­çš„ä¸€ä¸ªå‡½æ•°å¼æ¥å£:\n\n```\n@FunctionalInterface\npublic interface Supplier<T> {\n    T get();\n}\n```\n\nåªæœ‰ä¸€ä¸ªget()ï¼Œå¹¶ä¸”æ˜¯æ²¡æœ‰å‚æ•°çš„ï¼Œåœ¨collect()æ–¹æ³•è¿”å›ä¸€ä¸ªRç±»å‹çš„å¯¹è±¡ï¼Œå¹¶ä¸”get()æ–¹æ³•è¿”å›ä¸€ä¸ªæŒ‡å‘é›†åˆçš„å¼•ç”¨ã€‚\n\nè€Œaccumulator,combinerçš„ç±»å‹æ˜¯`BiConsumer`ï¼Œä»–ä»¬ä¹Ÿæ˜¯`java.util.function`åŒ…ä¸­çš„ä¸€ä¸ªå‡½æ•°å¼æ¥å£:\n\n```\n@FunctionalInterface\npublic interface BiConsumer<T, U> {\n    void accept(T t, U u);\n}\n```\n\nå…¶ä¸­t,uæ‰§è¡ŒæŸç§ç±»å‹çš„æ“ä½œï¼Œå¯¹äºaccumulatoræ¥è¯´ï¼ŒtæŒ‡å®šäº†ç›®æ ‡é›†åˆï¼ŒuæŒ‡å®šäº†è¦æ·»åŠ åˆ°è¯¥é›†åˆçš„å…ƒç´ ã€‚å¯¹äºcombineræ¥è¯´ï¼Œtå’ŒuæŒ‡å®šçš„æ˜¯ä¸¤ä¸ªè¦è¢«åˆå¹¶çš„é›†åˆã€‚\n\næˆ‘ä»¬æŠŠå‰é¢çš„ä¾‹å­æ”¹å˜ä¸€ä¸‹ï¼Œç„¶åä¹Ÿè¯¦ç»†åœ°è¯´ä¸€ä¸‹ï¼Œåœ¨æ²¡æœ‰ç”¨lambdaå’Œä½¿ç”¨lambdaä¹‹åçš„åŒºåˆ«ï¼š\n\nè¿™ä¸ªæ˜¯æ²¡æœ‰ä½¿ç”¨lambdaå‰çš„ï¼š\n\n```\nprivate static void learnCollect() {\n        List<HeroPlayerGold> lists = new ArrayList<>();\n        lists.add(new HeroPlayerGold(\"ç›–ä¼¦\", \"RNG-Letme\", 100));\n        lists.add(new HeroPlayerGold(\"è¯¸è‘›äº®\", \"RNG-Xiaohu\", 300));\n        lists.add(new HeroPlayerGold(\"éœ²å¨œ\", \"RNG-MLXG\", 300));\n        lists.add(new HeroPlayerGold(\"ç‹„ä»æ°\", \"RNG-UZI\", 500));\n        lists.add(new HeroPlayerGold(\"ç‰›å¤´\", \"RNG-Ming\", 500));\n\n\n        lists.stream().collect(new Supplier<HashSet<HeroPlayerGold>>() {\n                                   @Override\n                                   public HashSet<HeroPlayerGold> get() {\n                                       return new HashSet<>();\n                                   }\n                               },//ç¬¬ä¸€ä¸ªå‚æ•°\n                new BiConsumer<HashSet<HeroPlayerGold>, HeroPlayerGold>() {\n                    @Override\n                    public void accept(HashSet<HeroPlayerGold> heroPlayerGolds, HeroPlayerGold heroPlayerGold) {\n                        heroPlayerGolds.add(heroPlayerGold);\n                    }\n                },//ç¬¬äºŒä¸ªå‚æ•°\n                new BiConsumer<HashSet<HeroPlayerGold>, HashSet<HeroPlayerGold>>() {\n                    @Override\n                    public void accept(HashSet<HeroPlayerGold> heroPlayerGolds, HashSet<HeroPlayerGold> heroPlayerGolds2) {\n                        heroPlayerGolds.addAll(heroPlayerGolds2);\n                    }\n                }//ç¬¬ä¸‰ä¸ªå‚æ•°\n        ).forEach(System.out::println);\n    }\n```\n\nåœ¨æ²¡æœ‰ä½¿ç”¨lambdaå‰ï¼Œè™½ç„¶çœ‹èµ·æ¥çš„è®©äººçœ¼èŠ±ç¼­ä¹±çš„ï¼Œä½†ä¸å¾—ä¸è¯´ï¼Œä»–å…¶å®èƒ½å¸®åŠ©æˆ‘ä»¬å®ç°éå¸¸å¼ºå¤§çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰çš„æ”¶é›†è¿‡ç¨‹ï¼Œå…¨éƒ¨éƒ½å¯ä»¥äº¤ç»™è¿™ä¸ªå®¶ä¼™ï¼Œæˆ‘ä»¬ç”¨lambdaæ•´ç†ä¸€ä¸‹ï¼š\n\n```\nprivate static void learnCollect() {\n        List<HeroPlayerGold> lists = new ArrayList<>();\n        lists.add(new HeroPlayerGold(\"ç›–ä¼¦\", \"RNG-Letme\", 100));\n        lists.add(new HeroPlayerGold(\"è¯¸è‘›äº®\", \"RNG-Xiaohu\", 300));\n        lists.add(new HeroPlayerGold(\"éœ²å¨œ\", \"RNG-MLXG\", 300));\n        lists.add(new HeroPlayerGold(\"ç‹„ä»æ°\", \"RNG-UZI\", 500));\n        lists.add(new HeroPlayerGold(\"ç‰›å¤´\", \"RNG-Ming\", 500));\n\n\n        lists.stream().collect(() -> new HashSet<>(),\n                                (set,elem)->set.add(elem),\n                                (setA,setB)->setA.addAll(setB)\n        ).forEach(System.out::println);\n        \n}\n```\n\nå¤§å®¶ä»¥ä¸ºåˆ°è¿™é‡Œå°±ç»“æŸäº†å—ï¼Ÿå…¶å®è¿˜å¯ä»¥ä½¿ç”¨æ–¹æ³•å¼•ç”¨å’Œæ„é€ å‡½æ•°å¼•ç”¨æ¥ç®€åŒ–ï¼š\n\n```\nprivate static void learnCollect() {\n        List<HeroPlayerGold> lists = new ArrayList<>();\n        lists.add(new HeroPlayerGold(\"ç›–ä¼¦\", \"RNG-Letme\", 100));\n        lists.add(new HeroPlayerGold(\"è¯¸è‘›äº®\", \"RNG-Xiaohu\", 300));\n        lists.add(new HeroPlayerGold(\"éœ²å¨œ\", \"RNG-MLXG\", 300));\n        lists.add(new HeroPlayerGold(\"ç‹„ä»æ°\", \"RNG-UZI\", 500));\n        lists.add(new HeroPlayerGold(\"ç‰›å¤´\", \"RNG-Ming\", 500));\n\n\n        lists.stream().collect(HashSet::new,\n                               HashSet::add,\n                               HashSet::addAll\n        ).forEach(System.out::println);\n}\n```\n\n#### å°ç»“ä¸€ä¸‹\n\næœ¬ç¯‡å¸¦å¤§å®¶å…¥é—¨äº†Streamçš„æ”¶é›†æ“ä½œï¼Œä½†æ˜¯æœ‰äº†äº›è¿™å…¥é—¨æ“ä½œï¼Œæˆ‘ç›¸ä¿¡ï¼Œä½ åœ¨æˆ‘çš„æ¼”å˜è¿‡ç¨‹ä¸­å·²ç»å‘ç°äº†æ‰©å±•ç‚¹äº†ï¼Œä¸ç®¡æ˜¯supplierï¼Œaccumulatorè¿˜æ˜¯combinerï¼Œéƒ½å¯ä»¥åœ¨é‡Œé¢æ”¾ä¸€äº›ç‰¹åˆ«çš„æ“ä½œè¿›å»ï¼Œä»è€Œæ»¡è¶³ä½ ä»¬çš„å„ç§è¦æ±‚ã€‚\n\nå¦å¤–ä¸€ä¸ªç‚¹ï¼Œå¤§å®¶ä¸€å®šä¸è¦å¿˜è®°äº†Collectorsè¿™ä¸ªæœ€ç»ˆç±»ï¼Œé‡Œé¢å·²ç»æä¾›äº†å¾ˆå¤šå¾ˆå¼ºå¤§çš„é™æ€æ–¹æ³•ï¼Œå¦‚æœä½ ä»¬é‡åˆ°ä¸€äº›ç‰¹åˆ«çš„éœ€æ±‚ï¼Œé¦–å…ˆè¦æƒ³åˆ°çš„åº”è¯¥æ˜¯Collectorsï¼Œå¦‚æœé‡Œé¢çš„æ–¹æ³•éƒ½ä¸èƒ½å®ç°ä½ çš„è¦æ±‚ï¼Œå†è€ƒè™‘é€šè¿‡ç¬¬äºŒä¸ªç‰ˆæœ¬çš„collect()æ–¹æ³•å®ç°ä½ çš„è‡ªå®šä¹‰æ”¶é›†è¿‡ç¨‹å§ã€‚\n\n\n\n\n\n","source":"_posts/æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆå…­ï¼‰æ”¶é›†.md","raw":"---\ntitle: Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆå…­ï¼‰æ”¶é›†\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: æ–°ç‰¹æ€§\n---\n\næˆ‘ä»¬å‰é¢çš„äº”ç¯‡æ–‡ç« åŸºæœ¬éƒ½æ˜¯åœ¨è¯´å°†ä¸€ä¸ªé›†åˆè½¬æˆä¸€ä¸ªæµï¼Œç„¶åå¯¹æµè¿›è¡Œæ“ä½œï¼Œå…¶å®è¿™ç§æ“ä½œæ˜¯æœ€å¤šçš„ï¼Œä½†æœ‰æ—¶å€™æˆ‘ä»¬ä¹Ÿæ˜¯éœ€è¦ä»æµä¸­æ”¶é›†èµ·ä¸€äº›å…ƒç´ ï¼Œå¹¶ä»¥é›†åˆçš„æ–¹å¼è¿”å›ï¼Œæˆ‘ä»¬æŠŠè¿™ç§åå‘æ“ä½œç§°ä¸ºæ”¶é›†ã€‚\n\næµAPIä¹Ÿç»™æˆ‘ä»¬æä¾›äº†ç›¸åº”çš„æ–¹æ³•ã€‚\n\n#### å¦‚ä½•åœ¨æµä¸­ä½¿ç”¨æ”¶é›†åŠŸèƒ½ï¼Ÿ\n\næˆ‘ä»¬å…ˆçœ‹ä¸€çœ‹æµAPIç»™æˆ‘ä»¬æä¾›çš„æ–¹æ³•ï¼š\n\n```\npublic interface Stream<T> extends BaseStream<T, Stream<T>> {\n//...å¿½ç•¥é‚£äº›ä¸é‡è¦çš„ä¸œè¥¿\n<R> R collect(Supplier<R> supplier,\n                  BiConsumer<R, ? super T> accumulator,\n                  BiConsumer<R, R> combiner);\n<R, A> R collect(Collector<? super T, A, R> collector);\nï½\n```\n\næµAPIä¸­ç»™æˆ‘ä»¬æä¾›äº†ä¸¤ç§ï¼Œæˆ‘ç»™å¤§å®¶åˆ†æä¸€ä¸‹\n\n**<R, A> R collect(Collector<? super T, A, R> collector);**\n\nå…¶ä¸­RæŒ‡å®šç»“æœçš„ç±»å‹ï¼ŒTæŒ‡å®šäº†è°ƒç”¨æµçš„å…ƒç´ ç±»å‹ã€‚å†…éƒ¨ç§¯ç´¯çš„ç±»å‹ç”±AæŒ‡å®šã€‚collectorFuncæ˜¯ä¸€ä¸ªæ”¶é›†å™¨ï¼ŒæŒ‡å®šæ”¶é›†è¿‡ç¨‹å¦‚ä½•æ‰§è¡Œï¼Œcollect()æ–¹æ³•æ˜¯ä¸€ä¸ªç»ˆç«¯æ–¹æ³•ã€‚\n\nè™½ç„¶æˆ‘ä»¬åŸºæœ¬ä¸Šå¾ˆå°‘ä¼šç”¨åˆ°è‡ªå®šä¹‰çš„collectorFunc,ä½†æ˜¯äº†ä¸ºæ‰©å±•å¤§å®¶çš„çŸ¥è¯†é¢ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç®€å•åœ°èŠä¸€èŠCollectorï¼ŒBecause it's my style! \n\n`Collector`æ¥å£ä½äº`java.util.stream`åŒ…ä¸­çš„å£°æ˜ï¼Œå®ƒçš„å®¹é¢œæ˜¯è¿™æ ·çš„ï¼š\n\n```\npackage java.util.stream;\npublic interface Collector<T, A, R> {\n      Supplier<A> supplier();\n      BiConsumer<A, T> accumulator();\n      BinaryOperator<A> combiner();\n      Function<A, R> finisher();\n}\n```\n\nå…¶ä¸­Tã€Aã€Rçš„å«ä¹‰å’Œä¸Šé¢æ˜¯ä¸€æ ·çš„`å…¶ä¸­RæŒ‡å®šç»“æœçš„ç±»å‹ï¼ŒTæŒ‡å®šäº†è°ƒç”¨æµçš„å…ƒç´ ç±»å‹ã€‚å†…éƒ¨ç§¯ç´¯çš„ç±»å‹ç”±AæŒ‡å®š`ã€‚\n\nä½†æ˜¯è¿™ä¸€ç¯‡æˆ‘ä»¬ä¸å®ç°ä»–ä»¬ï¼Œå› ä¸ºJDKå·²ç»ç»™æˆ‘ä»¬æä¾›äº†å¾ˆå¼ºå¤§çš„æ–¹æ³•äº†ï¼Œä»–ä»¬ä½äº`java.util.stream`ä¸‹é¢çš„`Collectors`ç±»ï¼Œæˆ‘ä»¬æœ¬ç¯‡ä¹Ÿä¸»è¦æ˜¯ä½¿ç”¨`Collectors`æ¥å®ç°æ”¶é›†çš„åŠŸèƒ½ã€‚\n\n`Collectors`ç±»æ˜¯ä¸€ä¸ªæœ€ç»ˆç±»ï¼Œé‡Œé¢æä¾›äº†å¤§é‡çš„é™æ€çš„æ”¶é›†å™¨æ–¹æ³•ï¼Œå€ŸåŠ©ä»–ï¼Œæˆ‘ä»¬åŸºæœ¬å¯ä»¥å®ç°å„ç§å¤æ‚çš„åŠŸèƒ½äº†ã€‚\n\næˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹toListå’ŒtoSetæ–¹æ³•:\n\n```\npublic static <T>  Collector<T, ?, List<T>> toList()\npublic static <T> Collector<T, ?, Set<T>> toSet()\n```\n\nå…¶ä¸­`Collectors#toList()`è¿”å›çš„æ”¶é›†å™¨å¯ä»¥æŠŠæµä¸­å…ƒç´ æ”¶é›†åˆ°ä¸€ä¸ªListä¸­ï¼Œ`Collectors#toSet()`è¿”å›çš„æ”¶é›†å™¨å¯ä»¥æŠŠæµä¸­çš„å…ƒç´ æ”¶é›†åˆ°ä¸€ä¸ªSetä¸­ã€‚æ¯”å¦‚ï¼šå¦‚æœä½ æƒ³æŠŠå…ƒç´ æ”¶é›†åˆ°Listä¸­ï¼Œä½ å¯ä»¥è¿™æ ·ç”¨ï¼Œ`steam.collect(Collectors.toList)`ã€‚\n\næ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æŠŠæˆ‘ä»¬çš„ç‹è€…è£è€€å›¢é˜Ÿç»æµä¾‹å­ä¿®æ”¹ä¸€ä¸‹ï¼ŒæŠŠæ˜æ˜Ÿç©å®¶å’Œå½“å‰è·å¾—çš„é‡‘å¸æ•°æ”¶é›†åˆ°ä¸€ä¸ªListé‡Œé¢ï¼ŒæŠŠå‡ºåœºçš„è‹±é›„æ”¶é›†åˆ°ä¸€ä¸ªSeté‡Œé¢ï¼š\n\n```\n#ç©å®¶ä½¿ç”¨çš„è‹±é›„ä»¥åŠå½“å‰è·å¾—çš„é‡‘å¸æ•°\npublic class HeroPlayerGold {\n    /** ä½¿ç”¨çš„è‹±é›„åå­— */\n    private String hero;\n    /** ç©å®¶çš„ID */\n    private String player;\n    /** è·å¾—çš„é‡‘å¸æ•° */\n    private int gold;\n\n\n    public HeroPlayerGold(String hero, String player, int gold) {\n        this.hero = hero;\n        this.player = player;\n        this.gold = gold;\n    }\n\n    @Override\n    public String toString() {\n        return \"HeroPlayerGold{\" +\n                \"hero='\" + hero + '\\'' +\n                \", player='\" + player + '\\'' +\n                \", gold=\" + gold +\n                '}';\n    }\n//çœç•¥get/set\n}\n\n#å‡ºåœºçš„è‹±é›„\npublic class Hero {\n    /** ä½¿ç”¨çš„è‹±é›„åå­— */\n    private String hero;\n\n    public Hero(String hero) {\n        this.hero = hero;\n    }\n\n    @Override\n    public String toString() {\n        return \"Hero{\" +\n                \"hero='\" + hero + '\\'' +\n                '}';\n    }\n//çœç•¥get/set\n}\n\n#æµ‹è¯•ç±»\npublic class Main {\n    public static void main(String[] args) {\n        learnCollect();\n    }\n\n    private static void learnCollect() {\n        List<HeroPlayerGold> lists = new ArrayList<>();\n        lists.add(new HeroPlayerGold(\"ç›–ä¼¦\", \"RNG-Letme\", 100));\n        lists.add(new HeroPlayerGold(\"è¯¸è‘›äº®\", \"RNG-Xiaohu\", 300));\n        lists.add(new HeroPlayerGold(\"éœ²å¨œ\", \"RNG-MLXG\", 300));\n        lists.add(new HeroPlayerGold(\"ç‹„ä»æ°\", \"RNG-UZI\", 500));\n        lists.add(new HeroPlayerGold(\"ç‰›å¤´\", \"RNG-Ming\", 500));\n\n        List<PlayerGold> playerGolds = lists.stream()\n                .map(plary -> new PlayerGold(plary.getPlayer(), plary.getGold()))\n                .collect(Collectors.toList());\n        System.out.println(\"============PlayerGold begin==============\");\n        playerGolds.forEach(System.out::println);\n        System.out.println(\"============PlayerGold end================\\n\");\n\n\n\n        Set<Hero> heroes = lists.stream().map(player -> new Hero(player.getHero())).collect(Collectors.toSet());\n        System.out.println(\"============Hero begin==============\");\n        heroes.forEach(System.out::println);\n        System.out.println(\"============Hero end================\");\n    }\n}\n```\n\nè¾“å‡ºçš„æ—¥å¿—ï¼š\n\n```\n============PlayerGold begin==============\nPlayerGold{player='RNG-Letme', gold=100}\nPlayerGold{player='RNG-Xiaohu', gold=300}\nPlayerGold{player='RNG-MLXG', gold=300}\nPlayerGold{player='RNG-UZI', gold=500}\nPlayerGold{player='RNG-Ming', gold=500}\n============PlayerGold end================\n\n============Hero begin==============\nHero{hero='éœ²å¨œ'}\nHero{hero='ç‰›å¤´'}\nHero{hero='ç›–ä¼¦'}\nHero{hero='ç‹„ä»æ°'}\nHero{hero='è¯¸è‘›äº®'}\n============Hero end================\n```\n\nçœ‹åˆ°è¿™é‡Œï¼Œå¤§å®¶æœ‰æ„Ÿå—åˆ°æµAPIçš„å¨åŠ›äº†å—ï¼Ÿæç¤ºä¸€ä¸‹ï¼Œå°è£…ä¸€ä¸ªå·¥å…·ç±»ï¼Œç„¶åç»“åˆä¸€FastJsonè¿™ç§ä¸œè¥¿ä¸€èµ·ä½¿ç”¨ï¼æ˜¯çœŸçš„å¥½ç”¨å•Šï¼å…¶å®å°†æ•°æ®ä»é›†åˆç§»åˆ°æµä¸­ï¼Œæˆ–è€…å°†æ•°æ®ä»æµç§»å›é›†åˆçš„èƒ½åŠ›ï¼Œæ˜¯æµAPIç»™æˆ‘ä»¬æä¾›çš„ä¸€ä¸ªå¼ºå¤§ç‰¹æ€§ï¼Œå› ä¸ºè¿™å…è®¸é€šè¿‡æµæ¥æ“ä½œé›†åˆï¼Œç„¶åæŠŠæµé‡æ–°æ‰“åŒ…æˆé›†åˆã€‚æ­¤å¤–ï¼Œæ¡ä»¶åˆé€‚çš„æ—¶å€™ï¼Œè®©æµæ“ä½œå¹¶è¡Œå‘ç”Ÿï¼Œæé«˜æ•ˆç‡ã€‚\n\næ¥ä¸‹æ¥æˆ‘ä»¬åˆ†æç¬¬äºŒä¸ªæ–¹æ³•ï¼Œ\n\n```\n <R> R collect(Supplier<R> supplier,\n                  BiConsumer<R, ? super T> accumulator,\n                  BiConsumer<R, R> combiner);\n```\n\næˆ‘ä»¬ç¬¬äºŒä¸ªç‰ˆæœ¬çš„æ”¶é›†æ–¹æ³•ï¼Œä¸»è¦æ˜¯å¯ä»¥åœ¨æ”¶é›†çš„è¿‡ç¨‹ä¸­ï¼Œç»™äºˆæ›´å¤šçš„æ§åˆ¶ã€‚å…¶ä¸­supplieræŒ‡å®šå¦‚ä½•åˆ›å»ºç”¨äºä¿å­˜ç»“æœçš„å¯¹è±¡ï¼Œæ¯”å¦‚ï¼Œè¦ä½¿ç”¨ArrayListä½œä¸ºç»“æœçš„é›†åˆï¼Œéœ€è¦æŒ‡å®šå®ƒçš„æ„é€ å‡½æ•°ï¼Œaccumulatorå‡½æ•°æ˜¯å°†ä¸€ä¸ªå…ƒç´ æ·»åŠ åˆ°ç»“æœä¸­ï¼Œè€Œcombinerå‡½æ•°åˆå¹¶ä¸¤ä¸ªéƒ¨åˆ†çš„ç»“æœã€‚\n\nå¤§å®¶åº”è¯¥å‘ç°äº†å§ï¼Œä»–çš„å·¥ä½œæ–¹å¼å’Œæˆ‘ä»¬ç¬¬ä¸‰ç¯‡ä»‹ç»ç¼©å‡æ“ä½œæ—¶çš„reduceæ–¹æ³•æ˜¯å¾ˆåƒçš„ã€‚å®ƒä»¬éƒ½å¿…é¡»æ˜¯æ— çŠ¶æ€å’Œä¸å¹²é¢„çš„ï¼Œå¹¶ä¸”å¿…é¡»æœ‰å…³è”æ€§ï¼Œä¸‰ä¸ªçº¦æŸæ¡ä»¶ç¼ºä¸€ä¸å¯ã€‚\n\n`Supplier`ä¹Ÿæ˜¯`java.util.function`åŒ…ä¸­çš„ä¸€ä¸ªå‡½æ•°å¼æ¥å£:\n\n```\n@FunctionalInterface\npublic interface Supplier<T> {\n    T get();\n}\n```\n\nåªæœ‰ä¸€ä¸ªget()ï¼Œå¹¶ä¸”æ˜¯æ²¡æœ‰å‚æ•°çš„ï¼Œåœ¨collect()æ–¹æ³•è¿”å›ä¸€ä¸ªRç±»å‹çš„å¯¹è±¡ï¼Œå¹¶ä¸”get()æ–¹æ³•è¿”å›ä¸€ä¸ªæŒ‡å‘é›†åˆçš„å¼•ç”¨ã€‚\n\nè€Œaccumulator,combinerçš„ç±»å‹æ˜¯`BiConsumer`ï¼Œä»–ä»¬ä¹Ÿæ˜¯`java.util.function`åŒ…ä¸­çš„ä¸€ä¸ªå‡½æ•°å¼æ¥å£:\n\n```\n@FunctionalInterface\npublic interface BiConsumer<T, U> {\n    void accept(T t, U u);\n}\n```\n\nå…¶ä¸­t,uæ‰§è¡ŒæŸç§ç±»å‹çš„æ“ä½œï¼Œå¯¹äºaccumulatoræ¥è¯´ï¼ŒtæŒ‡å®šäº†ç›®æ ‡é›†åˆï¼ŒuæŒ‡å®šäº†è¦æ·»åŠ åˆ°è¯¥é›†åˆçš„å…ƒç´ ã€‚å¯¹äºcombineræ¥è¯´ï¼Œtå’ŒuæŒ‡å®šçš„æ˜¯ä¸¤ä¸ªè¦è¢«åˆå¹¶çš„é›†åˆã€‚\n\næˆ‘ä»¬æŠŠå‰é¢çš„ä¾‹å­æ”¹å˜ä¸€ä¸‹ï¼Œç„¶åä¹Ÿè¯¦ç»†åœ°è¯´ä¸€ä¸‹ï¼Œåœ¨æ²¡æœ‰ç”¨lambdaå’Œä½¿ç”¨lambdaä¹‹åçš„åŒºåˆ«ï¼š\n\nè¿™ä¸ªæ˜¯æ²¡æœ‰ä½¿ç”¨lambdaå‰çš„ï¼š\n\n```\nprivate static void learnCollect() {\n        List<HeroPlayerGold> lists = new ArrayList<>();\n        lists.add(new HeroPlayerGold(\"ç›–ä¼¦\", \"RNG-Letme\", 100));\n        lists.add(new HeroPlayerGold(\"è¯¸è‘›äº®\", \"RNG-Xiaohu\", 300));\n        lists.add(new HeroPlayerGold(\"éœ²å¨œ\", \"RNG-MLXG\", 300));\n        lists.add(new HeroPlayerGold(\"ç‹„ä»æ°\", \"RNG-UZI\", 500));\n        lists.add(new HeroPlayerGold(\"ç‰›å¤´\", \"RNG-Ming\", 500));\n\n\n        lists.stream().collect(new Supplier<HashSet<HeroPlayerGold>>() {\n                                   @Override\n                                   public HashSet<HeroPlayerGold> get() {\n                                       return new HashSet<>();\n                                   }\n                               },//ç¬¬ä¸€ä¸ªå‚æ•°\n                new BiConsumer<HashSet<HeroPlayerGold>, HeroPlayerGold>() {\n                    @Override\n                    public void accept(HashSet<HeroPlayerGold> heroPlayerGolds, HeroPlayerGold heroPlayerGold) {\n                        heroPlayerGolds.add(heroPlayerGold);\n                    }\n                },//ç¬¬äºŒä¸ªå‚æ•°\n                new BiConsumer<HashSet<HeroPlayerGold>, HashSet<HeroPlayerGold>>() {\n                    @Override\n                    public void accept(HashSet<HeroPlayerGold> heroPlayerGolds, HashSet<HeroPlayerGold> heroPlayerGolds2) {\n                        heroPlayerGolds.addAll(heroPlayerGolds2);\n                    }\n                }//ç¬¬ä¸‰ä¸ªå‚æ•°\n        ).forEach(System.out::println);\n    }\n```\n\nåœ¨æ²¡æœ‰ä½¿ç”¨lambdaå‰ï¼Œè™½ç„¶çœ‹èµ·æ¥çš„è®©äººçœ¼èŠ±ç¼­ä¹±çš„ï¼Œä½†ä¸å¾—ä¸è¯´ï¼Œä»–å…¶å®èƒ½å¸®åŠ©æˆ‘ä»¬å®ç°éå¸¸å¼ºå¤§çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰çš„æ”¶é›†è¿‡ç¨‹ï¼Œå…¨éƒ¨éƒ½å¯ä»¥äº¤ç»™è¿™ä¸ªå®¶ä¼™ï¼Œæˆ‘ä»¬ç”¨lambdaæ•´ç†ä¸€ä¸‹ï¼š\n\n```\nprivate static void learnCollect() {\n        List<HeroPlayerGold> lists = new ArrayList<>();\n        lists.add(new HeroPlayerGold(\"ç›–ä¼¦\", \"RNG-Letme\", 100));\n        lists.add(new HeroPlayerGold(\"è¯¸è‘›äº®\", \"RNG-Xiaohu\", 300));\n        lists.add(new HeroPlayerGold(\"éœ²å¨œ\", \"RNG-MLXG\", 300));\n        lists.add(new HeroPlayerGold(\"ç‹„ä»æ°\", \"RNG-UZI\", 500));\n        lists.add(new HeroPlayerGold(\"ç‰›å¤´\", \"RNG-Ming\", 500));\n\n\n        lists.stream().collect(() -> new HashSet<>(),\n                                (set,elem)->set.add(elem),\n                                (setA,setB)->setA.addAll(setB)\n        ).forEach(System.out::println);\n        \n}\n```\n\nå¤§å®¶ä»¥ä¸ºåˆ°è¿™é‡Œå°±ç»“æŸäº†å—ï¼Ÿå…¶å®è¿˜å¯ä»¥ä½¿ç”¨æ–¹æ³•å¼•ç”¨å’Œæ„é€ å‡½æ•°å¼•ç”¨æ¥ç®€åŒ–ï¼š\n\n```\nprivate static void learnCollect() {\n        List<HeroPlayerGold> lists = new ArrayList<>();\n        lists.add(new HeroPlayerGold(\"ç›–ä¼¦\", \"RNG-Letme\", 100));\n        lists.add(new HeroPlayerGold(\"è¯¸è‘›äº®\", \"RNG-Xiaohu\", 300));\n        lists.add(new HeroPlayerGold(\"éœ²å¨œ\", \"RNG-MLXG\", 300));\n        lists.add(new HeroPlayerGold(\"ç‹„ä»æ°\", \"RNG-UZI\", 500));\n        lists.add(new HeroPlayerGold(\"ç‰›å¤´\", \"RNG-Ming\", 500));\n\n\n        lists.stream().collect(HashSet::new,\n                               HashSet::add,\n                               HashSet::addAll\n        ).forEach(System.out::println);\n}\n```\n\n#### å°ç»“ä¸€ä¸‹\n\næœ¬ç¯‡å¸¦å¤§å®¶å…¥é—¨äº†Streamçš„æ”¶é›†æ“ä½œï¼Œä½†æ˜¯æœ‰äº†äº›è¿™å…¥é—¨æ“ä½œï¼Œæˆ‘ç›¸ä¿¡ï¼Œä½ åœ¨æˆ‘çš„æ¼”å˜è¿‡ç¨‹ä¸­å·²ç»å‘ç°äº†æ‰©å±•ç‚¹äº†ï¼Œä¸ç®¡æ˜¯supplierï¼Œaccumulatorè¿˜æ˜¯combinerï¼Œéƒ½å¯ä»¥åœ¨é‡Œé¢æ”¾ä¸€äº›ç‰¹åˆ«çš„æ“ä½œè¿›å»ï¼Œä»è€Œæ»¡è¶³ä½ ä»¬çš„å„ç§è¦æ±‚ã€‚\n\nå¦å¤–ä¸€ä¸ªç‚¹ï¼Œå¤§å®¶ä¸€å®šä¸è¦å¿˜è®°äº†Collectorsè¿™ä¸ªæœ€ç»ˆç±»ï¼Œé‡Œé¢å·²ç»æä¾›äº†å¾ˆå¤šå¾ˆå¼ºå¤§çš„é™æ€æ–¹æ³•ï¼Œå¦‚æœä½ ä»¬é‡åˆ°ä¸€äº›ç‰¹åˆ«çš„éœ€æ±‚ï¼Œé¦–å…ˆè¦æƒ³åˆ°çš„åº”è¯¥æ˜¯Collectorsï¼Œå¦‚æœé‡Œé¢çš„æ–¹æ³•éƒ½ä¸èƒ½å®ç°ä½ çš„è¦æ±‚ï¼Œå†è€ƒè™‘é€šè¿‡ç¬¬äºŒä¸ªç‰ˆæœ¬çš„collect()æ–¹æ³•å®ç°ä½ çš„è‡ªå®šä¹‰æ”¶é›†è¿‡ç¨‹å§ã€‚\n\n\n\n\n\n","slug":"æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆå…­ï¼‰æ”¶é›†","published":1,"updated":"2025-10-15T07:20:51.417Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu077a006uqkd4e06sgza9","content":"<p>æˆ‘ä»¬å‰é¢çš„äº”ç¯‡æ–‡ç« åŸºæœ¬éƒ½æ˜¯åœ¨è¯´å°†ä¸€ä¸ªé›†åˆè½¬æˆä¸€ä¸ªæµï¼Œç„¶åå¯¹æµè¿›è¡Œæ“ä½œï¼Œå…¶å®è¿™ç§æ“ä½œæ˜¯æœ€å¤šçš„ï¼Œä½†æœ‰æ—¶å€™æˆ‘ä»¬ä¹Ÿæ˜¯éœ€è¦ä»æµä¸­æ”¶é›†èµ·ä¸€äº›å…ƒç´ ï¼Œå¹¶ä»¥é›†åˆçš„æ–¹å¼è¿”å›ï¼Œæˆ‘ä»¬æŠŠè¿™ç§åå‘æ“ä½œç§°ä¸ºæ”¶é›†ã€‚</p>\n<p>æµAPIä¹Ÿç»™æˆ‘ä»¬æä¾›äº†ç›¸åº”çš„æ–¹æ³•ã€‚</p>\n<h4 id=\"å¦‚ä½•åœ¨æµä¸­ä½¿ç”¨æ”¶é›†åŠŸèƒ½ï¼Ÿ\"><a href=\"#å¦‚ä½•åœ¨æµä¸­ä½¿ç”¨æ”¶é›†åŠŸèƒ½ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•åœ¨æµä¸­ä½¿ç”¨æ”¶é›†åŠŸèƒ½ï¼Ÿ\"></a>å¦‚ä½•åœ¨æµä¸­ä½¿ç”¨æ”¶é›†åŠŸèƒ½ï¼Ÿ</h4><p>æˆ‘ä»¬å…ˆçœ‹ä¸€çœ‹æµAPIç»™æˆ‘ä»¬æä¾›çš„æ–¹æ³•ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public interface Stream&lt;T&gt; extends BaseStream&lt;T, Stream&lt;T&gt;&gt; &#123;\n&#x2F;&#x2F;...å¿½ç•¥é‚£äº›ä¸é‡è¦çš„ä¸œè¥¿\n&lt;R&gt; R collect(Supplier&lt;R&gt; supplier,\n                  BiConsumer&lt;R, ? super T&gt; accumulator,\n                  BiConsumer&lt;R, R&gt; combiner);\n&lt;R, A&gt; R collect(Collector&lt;? super T, A, R&gt; collector);\nï½<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æµAPIä¸­ç»™æˆ‘ä»¬æä¾›äº†ä¸¤ç§ï¼Œæˆ‘ç»™å¤§å®¶åˆ†æä¸€ä¸‹</p>\n<p><strong>&lt;R, A&gt; R collect(Collector&lt;? super T, A, R&gt; collector);</strong></p>\n<p>å…¶ä¸­RæŒ‡å®šç»“æœçš„ç±»å‹ï¼ŒTæŒ‡å®šäº†è°ƒç”¨æµçš„å…ƒç´ ç±»å‹ã€‚å†…éƒ¨ç§¯ç´¯çš„ç±»å‹ç”±AæŒ‡å®šã€‚collectorFuncæ˜¯ä¸€ä¸ªæ”¶é›†å™¨ï¼ŒæŒ‡å®šæ”¶é›†è¿‡ç¨‹å¦‚ä½•æ‰§è¡Œï¼Œcollect()æ–¹æ³•æ˜¯ä¸€ä¸ªç»ˆç«¯æ–¹æ³•ã€‚</p>\n<p>è™½ç„¶æˆ‘ä»¬åŸºæœ¬ä¸Šå¾ˆå°‘ä¼šç”¨åˆ°è‡ªå®šä¹‰çš„collectorFunc,ä½†æ˜¯äº†ä¸ºæ‰©å±•å¤§å®¶çš„çŸ¥è¯†é¢ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç®€å•åœ°èŠä¸€èŠCollectorï¼ŒBecause itâ€™s my style! </p>\n<p><code>Collector</code>æ¥å£ä½äº<code>java.util.stream</code>åŒ…ä¸­çš„å£°æ˜ï¼Œå®ƒçš„å®¹é¢œæ˜¯è¿™æ ·çš„ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">package java.util.stream;\npublic interface Collector&lt;T, A, R&gt; &#123;\n      Supplier&lt;A&gt; supplier();\n      BiConsumer&lt;A, T&gt; accumulator();\n      BinaryOperator&lt;A&gt; combiner();\n      Function&lt;A, R&gt; finisher();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å…¶ä¸­Tã€Aã€Rçš„å«ä¹‰å’Œä¸Šé¢æ˜¯ä¸€æ ·çš„<code>å…¶ä¸­RæŒ‡å®šç»“æœçš„ç±»å‹ï¼ŒTæŒ‡å®šäº†è°ƒç”¨æµçš„å…ƒç´ ç±»å‹ã€‚å†…éƒ¨ç§¯ç´¯çš„ç±»å‹ç”±AæŒ‡å®š</code>ã€‚</p>\n<p>ä½†æ˜¯è¿™ä¸€ç¯‡æˆ‘ä»¬ä¸å®ç°ä»–ä»¬ï¼Œå› ä¸ºJDKå·²ç»ç»™æˆ‘ä»¬æä¾›äº†å¾ˆå¼ºå¤§çš„æ–¹æ³•äº†ï¼Œä»–ä»¬ä½äº<code>java.util.stream</code>ä¸‹é¢çš„<code>Collectors</code>ç±»ï¼Œæˆ‘ä»¬æœ¬ç¯‡ä¹Ÿä¸»è¦æ˜¯ä½¿ç”¨<code>Collectors</code>æ¥å®ç°æ”¶é›†çš„åŠŸèƒ½ã€‚</p>\n<p><code>Collectors</code>ç±»æ˜¯ä¸€ä¸ªæœ€ç»ˆç±»ï¼Œé‡Œé¢æä¾›äº†å¤§é‡çš„é™æ€çš„æ”¶é›†å™¨æ–¹æ³•ï¼Œå€ŸåŠ©ä»–ï¼Œæˆ‘ä»¬åŸºæœ¬å¯ä»¥å®ç°å„ç§å¤æ‚çš„åŠŸèƒ½äº†ã€‚</p>\n<p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹toListå’ŒtoSetæ–¹æ³•:</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static &lt;T&gt;  Collector&lt;T, ?, List&lt;T&gt;&gt; toList()\npublic static &lt;T&gt; Collector&lt;T, ?, Set&lt;T&gt;&gt; toSet()<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>å…¶ä¸­<code>Collectors#toList()</code>è¿”å›çš„æ”¶é›†å™¨å¯ä»¥æŠŠæµä¸­å…ƒç´ æ”¶é›†åˆ°ä¸€ä¸ªListä¸­ï¼Œ<code>Collectors#toSet()</code>è¿”å›çš„æ”¶é›†å™¨å¯ä»¥æŠŠæµä¸­çš„å…ƒç´ æ”¶é›†åˆ°ä¸€ä¸ªSetä¸­ã€‚æ¯”å¦‚ï¼šå¦‚æœä½ æƒ³æŠŠå…ƒç´ æ”¶é›†åˆ°Listä¸­ï¼Œä½ å¯ä»¥è¿™æ ·ç”¨ï¼Œ<code>steam.collect(Collectors.toList)</code>ã€‚</p>\n<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æŠŠæˆ‘ä»¬çš„ç‹è€…è£è€€å›¢é˜Ÿç»æµä¾‹å­ä¿®æ”¹ä¸€ä¸‹ï¼ŒæŠŠæ˜æ˜Ÿç©å®¶å’Œå½“å‰è·å¾—çš„é‡‘å¸æ•°æ”¶é›†åˆ°ä¸€ä¸ªListé‡Œé¢ï¼ŒæŠŠå‡ºåœºçš„è‹±é›„æ”¶é›†åˆ°ä¸€ä¸ªSeté‡Œé¢ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">#ç©å®¶ä½¿ç”¨çš„è‹±é›„ä»¥åŠå½“å‰è·å¾—çš„é‡‘å¸æ•°\npublic class HeroPlayerGold &#123;\n    &#x2F;** ä½¿ç”¨çš„è‹±é›„åå­— *&#x2F;\n    private String hero;\n    &#x2F;** ç©å®¶çš„ID *&#x2F;\n    private String player;\n    &#x2F;** è·å¾—çš„é‡‘å¸æ•° *&#x2F;\n    private int gold;\n\n\n    public HeroPlayerGold(String hero, String player, int gold) &#123;\n        this.hero &#x3D; hero;\n        this.player &#x3D; player;\n        this.gold &#x3D; gold;\n    &#125;\n\n    @Override\n    public String toString() &#123;\n        return &quot;HeroPlayerGold&#123;&quot; +\n                &quot;hero&#x3D;&#39;&quot; + hero + &#39;\\&#39;&#39; +\n                &quot;, player&#x3D;&#39;&quot; + player + &#39;\\&#39;&#39; +\n                &quot;, gold&#x3D;&quot; + gold +\n                &#39;&#125;&#39;;\n    &#125;\n&#x2F;&#x2F;çœç•¥get&#x2F;set\n&#125;\n\n#å‡ºåœºçš„è‹±é›„\npublic class Hero &#123;\n    &#x2F;** ä½¿ç”¨çš„è‹±é›„åå­— *&#x2F;\n    private String hero;\n\n    public Hero(String hero) &#123;\n        this.hero &#x3D; hero;\n    &#125;\n\n    @Override\n    public String toString() &#123;\n        return &quot;Hero&#123;&quot; +\n                &quot;hero&#x3D;&#39;&quot; + hero + &#39;\\&#39;&#39; +\n                &#39;&#125;&#39;;\n    &#125;\n&#x2F;&#x2F;çœç•¥get&#x2F;set\n&#125;\n\n#æµ‹è¯•ç±»\npublic class Main &#123;\n    public static void main(String[] args) &#123;\n        learnCollect();\n    &#125;\n\n    private static void learnCollect() &#123;\n        List&lt;HeroPlayerGold&gt; lists &#x3D; new ArrayList&lt;&gt;();\n        lists.add(new HeroPlayerGold(&quot;ç›–ä¼¦&quot;, &quot;RNG-Letme&quot;, 100));\n        lists.add(new HeroPlayerGold(&quot;è¯¸è‘›äº®&quot;, &quot;RNG-Xiaohu&quot;, 300));\n        lists.add(new HeroPlayerGold(&quot;éœ²å¨œ&quot;, &quot;RNG-MLXG&quot;, 300));\n        lists.add(new HeroPlayerGold(&quot;ç‹„ä»æ°&quot;, &quot;RNG-UZI&quot;, 500));\n        lists.add(new HeroPlayerGold(&quot;ç‰›å¤´&quot;, &quot;RNG-Ming&quot;, 500));\n\n        List&lt;PlayerGold&gt; playerGolds &#x3D; lists.stream()\n                .map(plary -&gt; new PlayerGold(plary.getPlayer(), plary.getGold()))\n                .collect(Collectors.toList());\n        System.out.println(&quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;PlayerGold begin&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;);\n        playerGolds.forEach(System.out::println);\n        System.out.println(&quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;PlayerGold end&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;\\n&quot;);\n\n\n\n        Set&lt;Hero&gt; heroes &#x3D; lists.stream().map(player -&gt; new Hero(player.getHero())).collect(Collectors.toSet());\n        System.out.println(&quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Hero begin&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;);\n        heroes.forEach(System.out::println);\n        System.out.println(&quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Hero end&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;);\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¾“å‡ºçš„æ—¥å¿—ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;PlayerGold begin&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;\nPlayerGold&#123;player&#x3D;&#39;RNG-Letme&#39;, gold&#x3D;100&#125;\nPlayerGold&#123;player&#x3D;&#39;RNG-Xiaohu&#39;, gold&#x3D;300&#125;\nPlayerGold&#123;player&#x3D;&#39;RNG-MLXG&#39;, gold&#x3D;300&#125;\nPlayerGold&#123;player&#x3D;&#39;RNG-UZI&#39;, gold&#x3D;500&#125;\nPlayerGold&#123;player&#x3D;&#39;RNG-Ming&#39;, gold&#x3D;500&#125;\n&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;PlayerGold end&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;\n\n&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Hero begin&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;\nHero&#123;hero&#x3D;&#39;éœ²å¨œ&#39;&#125;\nHero&#123;hero&#x3D;&#39;ç‰›å¤´&#39;&#125;\nHero&#123;hero&#x3D;&#39;ç›–ä¼¦&#39;&#125;\nHero&#123;hero&#x3D;&#39;ç‹„ä»æ°&#39;&#125;\nHero&#123;hero&#x3D;&#39;è¯¸è‘›äº®&#39;&#125;\n&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Hero end&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>çœ‹åˆ°è¿™é‡Œï¼Œå¤§å®¶æœ‰æ„Ÿå—åˆ°æµAPIçš„å¨åŠ›äº†å—ï¼Ÿæç¤ºä¸€ä¸‹ï¼Œå°è£…ä¸€ä¸ªå·¥å…·ç±»ï¼Œç„¶åç»“åˆä¸€FastJsonè¿™ç§ä¸œè¥¿ä¸€èµ·ä½¿ç”¨ï¼æ˜¯çœŸçš„å¥½ç”¨å•Šï¼å…¶å®å°†æ•°æ®ä»é›†åˆç§»åˆ°æµä¸­ï¼Œæˆ–è€…å°†æ•°æ®ä»æµç§»å›é›†åˆçš„èƒ½åŠ›ï¼Œæ˜¯æµAPIç»™æˆ‘ä»¬æä¾›çš„ä¸€ä¸ªå¼ºå¤§ç‰¹æ€§ï¼Œå› ä¸ºè¿™å…è®¸é€šè¿‡æµæ¥æ“ä½œé›†åˆï¼Œç„¶åæŠŠæµé‡æ–°æ‰“åŒ…æˆé›†åˆã€‚æ­¤å¤–ï¼Œæ¡ä»¶åˆé€‚çš„æ—¶å€™ï¼Œè®©æµæ“ä½œå¹¶è¡Œå‘ç”Ÿï¼Œæé«˜æ•ˆç‡ã€‚</p>\n<p>æ¥ä¸‹æ¥æˆ‘ä»¬åˆ†æç¬¬äºŒä¸ªæ–¹æ³•ï¼Œ</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;R&gt; R collect(Supplier&lt;R&gt; supplier,\n                 BiConsumer&lt;R, ? super T&gt; accumulator,\n                 BiConsumer&lt;R, R&gt; combiner);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>æˆ‘ä»¬ç¬¬äºŒä¸ªç‰ˆæœ¬çš„æ”¶é›†æ–¹æ³•ï¼Œä¸»è¦æ˜¯å¯ä»¥åœ¨æ”¶é›†çš„è¿‡ç¨‹ä¸­ï¼Œç»™äºˆæ›´å¤šçš„æ§åˆ¶ã€‚å…¶ä¸­supplieræŒ‡å®šå¦‚ä½•åˆ›å»ºç”¨äºä¿å­˜ç»“æœçš„å¯¹è±¡ï¼Œæ¯”å¦‚ï¼Œè¦ä½¿ç”¨ArrayListä½œä¸ºç»“æœçš„é›†åˆï¼Œéœ€è¦æŒ‡å®šå®ƒçš„æ„é€ å‡½æ•°ï¼Œaccumulatorå‡½æ•°æ˜¯å°†ä¸€ä¸ªå…ƒç´ æ·»åŠ åˆ°ç»“æœä¸­ï¼Œè€Œcombinerå‡½æ•°åˆå¹¶ä¸¤ä¸ªéƒ¨åˆ†çš„ç»“æœã€‚</p>\n<p>å¤§å®¶åº”è¯¥å‘ç°äº†å§ï¼Œä»–çš„å·¥ä½œæ–¹å¼å’Œæˆ‘ä»¬ç¬¬ä¸‰ç¯‡ä»‹ç»ç¼©å‡æ“ä½œæ—¶çš„reduceæ–¹æ³•æ˜¯å¾ˆåƒçš„ã€‚å®ƒä»¬éƒ½å¿…é¡»æ˜¯æ— çŠ¶æ€å’Œä¸å¹²é¢„çš„ï¼Œå¹¶ä¸”å¿…é¡»æœ‰å…³è”æ€§ï¼Œä¸‰ä¸ªçº¦æŸæ¡ä»¶ç¼ºä¸€ä¸å¯ã€‚</p>\n<p><code>Supplier</code>ä¹Ÿæ˜¯<code>java.util.function</code>åŒ…ä¸­çš„ä¸€ä¸ªå‡½æ•°å¼æ¥å£:</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@FunctionalInterface\npublic interface Supplier&lt;T&gt; &#123;\n    T get();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>åªæœ‰ä¸€ä¸ªget()ï¼Œå¹¶ä¸”æ˜¯æ²¡æœ‰å‚æ•°çš„ï¼Œåœ¨collect()æ–¹æ³•è¿”å›ä¸€ä¸ªRç±»å‹çš„å¯¹è±¡ï¼Œå¹¶ä¸”get()æ–¹æ³•è¿”å›ä¸€ä¸ªæŒ‡å‘é›†åˆçš„å¼•ç”¨ã€‚</p>\n<p>è€Œaccumulator,combinerçš„ç±»å‹æ˜¯<code>BiConsumer</code>ï¼Œä»–ä»¬ä¹Ÿæ˜¯<code>java.util.function</code>åŒ…ä¸­çš„ä¸€ä¸ªå‡½æ•°å¼æ¥å£:</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@FunctionalInterface\npublic interface BiConsumer&lt;T, U&gt; &#123;\n    void accept(T t, U u);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å…¶ä¸­t,uæ‰§è¡ŒæŸç§ç±»å‹çš„æ“ä½œï¼Œå¯¹äºaccumulatoræ¥è¯´ï¼ŒtæŒ‡å®šäº†ç›®æ ‡é›†åˆï¼ŒuæŒ‡å®šäº†è¦æ·»åŠ åˆ°è¯¥é›†åˆçš„å…ƒç´ ã€‚å¯¹äºcombineræ¥è¯´ï¼Œtå’ŒuæŒ‡å®šçš„æ˜¯ä¸¤ä¸ªè¦è¢«åˆå¹¶çš„é›†åˆã€‚</p>\n<p>æˆ‘ä»¬æŠŠå‰é¢çš„ä¾‹å­æ”¹å˜ä¸€ä¸‹ï¼Œç„¶åä¹Ÿè¯¦ç»†åœ°è¯´ä¸€ä¸‹ï¼Œåœ¨æ²¡æœ‰ç”¨lambdaå’Œä½¿ç”¨lambdaä¹‹åçš„åŒºåˆ«ï¼š</p>\n<p>è¿™ä¸ªæ˜¯æ²¡æœ‰ä½¿ç”¨lambdaå‰çš„ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void learnCollect() &#123;\n        List&lt;HeroPlayerGold&gt; lists &#x3D; new ArrayList&lt;&gt;();\n        lists.add(new HeroPlayerGold(&quot;ç›–ä¼¦&quot;, &quot;RNG-Letme&quot;, 100));\n        lists.add(new HeroPlayerGold(&quot;è¯¸è‘›äº®&quot;, &quot;RNG-Xiaohu&quot;, 300));\n        lists.add(new HeroPlayerGold(&quot;éœ²å¨œ&quot;, &quot;RNG-MLXG&quot;, 300));\n        lists.add(new HeroPlayerGold(&quot;ç‹„ä»æ°&quot;, &quot;RNG-UZI&quot;, 500));\n        lists.add(new HeroPlayerGold(&quot;ç‰›å¤´&quot;, &quot;RNG-Ming&quot;, 500));\n\n\n        lists.stream().collect(new Supplier&lt;HashSet&lt;HeroPlayerGold&gt;&gt;() &#123;\n                                   @Override\n                                   public HashSet&lt;HeroPlayerGold&gt; get() &#123;\n                                       return new HashSet&lt;&gt;();\n                                   &#125;\n                               &#125;,&#x2F;&#x2F;ç¬¬ä¸€ä¸ªå‚æ•°\n                new BiConsumer&lt;HashSet&lt;HeroPlayerGold&gt;, HeroPlayerGold&gt;() &#123;\n                    @Override\n                    public void accept(HashSet&lt;HeroPlayerGold&gt; heroPlayerGolds, HeroPlayerGold heroPlayerGold) &#123;\n                        heroPlayerGolds.add(heroPlayerGold);\n                    &#125;\n                &#125;,&#x2F;&#x2F;ç¬¬äºŒä¸ªå‚æ•°\n                new BiConsumer&lt;HashSet&lt;HeroPlayerGold&gt;, HashSet&lt;HeroPlayerGold&gt;&gt;() &#123;\n                    @Override\n                    public void accept(HashSet&lt;HeroPlayerGold&gt; heroPlayerGolds, HashSet&lt;HeroPlayerGold&gt; heroPlayerGolds2) &#123;\n                        heroPlayerGolds.addAll(heroPlayerGolds2);\n                    &#125;\n                &#125;&#x2F;&#x2F;ç¬¬ä¸‰ä¸ªå‚æ•°\n        ).forEach(System.out::println);\n    &#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>åœ¨æ²¡æœ‰ä½¿ç”¨lambdaå‰ï¼Œè™½ç„¶çœ‹èµ·æ¥çš„è®©äººçœ¼èŠ±ç¼­ä¹±çš„ï¼Œä½†ä¸å¾—ä¸è¯´ï¼Œä»–å…¶å®èƒ½å¸®åŠ©æˆ‘ä»¬å®ç°éå¸¸å¼ºå¤§çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰çš„æ”¶é›†è¿‡ç¨‹ï¼Œå…¨éƒ¨éƒ½å¯ä»¥äº¤ç»™è¿™ä¸ªå®¶ä¼™ï¼Œæˆ‘ä»¬ç”¨lambdaæ•´ç†ä¸€ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void learnCollect() &#123;\n        List&lt;HeroPlayerGold&gt; lists &#x3D; new ArrayList&lt;&gt;();\n        lists.add(new HeroPlayerGold(&quot;ç›–ä¼¦&quot;, &quot;RNG-Letme&quot;, 100));\n        lists.add(new HeroPlayerGold(&quot;è¯¸è‘›äº®&quot;, &quot;RNG-Xiaohu&quot;, 300));\n        lists.add(new HeroPlayerGold(&quot;éœ²å¨œ&quot;, &quot;RNG-MLXG&quot;, 300));\n        lists.add(new HeroPlayerGold(&quot;ç‹„ä»æ°&quot;, &quot;RNG-UZI&quot;, 500));\n        lists.add(new HeroPlayerGold(&quot;ç‰›å¤´&quot;, &quot;RNG-Ming&quot;, 500));\n\n\n        lists.stream().collect(() -&gt; new HashSet&lt;&gt;(),\n                                (set,elem)-&gt;set.add(elem),\n                                (setA,setB)-&gt;setA.addAll(setB)\n        ).forEach(System.out::println);\n        \n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¤§å®¶ä»¥ä¸ºåˆ°è¿™é‡Œå°±ç»“æŸäº†å—ï¼Ÿå…¶å®è¿˜å¯ä»¥ä½¿ç”¨æ–¹æ³•å¼•ç”¨å’Œæ„é€ å‡½æ•°å¼•ç”¨æ¥ç®€åŒ–ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void learnCollect() &#123;\n        List&lt;HeroPlayerGold&gt; lists &#x3D; new ArrayList&lt;&gt;();\n        lists.add(new HeroPlayerGold(&quot;ç›–ä¼¦&quot;, &quot;RNG-Letme&quot;, 100));\n        lists.add(new HeroPlayerGold(&quot;è¯¸è‘›äº®&quot;, &quot;RNG-Xiaohu&quot;, 300));\n        lists.add(new HeroPlayerGold(&quot;éœ²å¨œ&quot;, &quot;RNG-MLXG&quot;, 300));\n        lists.add(new HeroPlayerGold(&quot;ç‹„ä»æ°&quot;, &quot;RNG-UZI&quot;, 500));\n        lists.add(new HeroPlayerGold(&quot;ç‰›å¤´&quot;, &quot;RNG-Ming&quot;, 500));\n\n\n        lists.stream().collect(HashSet::new,\n                               HashSet::add,\n                               HashSet::addAll\n        ).forEach(System.out::println);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"å°ç»“ä¸€ä¸‹\"><a href=\"#å°ç»“ä¸€ä¸‹\" class=\"headerlink\" title=\"å°ç»“ä¸€ä¸‹\"></a>å°ç»“ä¸€ä¸‹</h4><p>æœ¬ç¯‡å¸¦å¤§å®¶å…¥é—¨äº†Streamçš„æ”¶é›†æ“ä½œï¼Œä½†æ˜¯æœ‰äº†äº›è¿™å…¥é—¨æ“ä½œï¼Œæˆ‘ç›¸ä¿¡ï¼Œä½ åœ¨æˆ‘çš„æ¼”å˜è¿‡ç¨‹ä¸­å·²ç»å‘ç°äº†æ‰©å±•ç‚¹äº†ï¼Œä¸ç®¡æ˜¯supplierï¼Œaccumulatorè¿˜æ˜¯combinerï¼Œéƒ½å¯ä»¥åœ¨é‡Œé¢æ”¾ä¸€äº›ç‰¹åˆ«çš„æ“ä½œè¿›å»ï¼Œä»è€Œæ»¡è¶³ä½ ä»¬çš„å„ç§è¦æ±‚ã€‚</p>\n<p>å¦å¤–ä¸€ä¸ªç‚¹ï¼Œå¤§å®¶ä¸€å®šä¸è¦å¿˜è®°äº†Collectorsè¿™ä¸ªæœ€ç»ˆç±»ï¼Œé‡Œé¢å·²ç»æä¾›äº†å¾ˆå¤šå¾ˆå¼ºå¤§çš„é™æ€æ–¹æ³•ï¼Œå¦‚æœä½ ä»¬é‡åˆ°ä¸€äº›ç‰¹åˆ«çš„éœ€æ±‚ï¼Œé¦–å…ˆè¦æƒ³åˆ°çš„åº”è¯¥æ˜¯Collectorsï¼Œå¦‚æœé‡Œé¢çš„æ–¹æ³•éƒ½ä¸èƒ½å®ç°ä½ çš„è¦æ±‚ï¼Œå†è€ƒè™‘é€šè¿‡ç¬¬äºŒä¸ªç‰ˆæœ¬çš„collect()æ–¹æ³•å®ç°ä½ çš„è‡ªå®šä¹‰æ”¶é›†è¿‡ç¨‹å§ã€‚</p>\n","excerpt":"","more":"<p>æˆ‘ä»¬å‰é¢çš„äº”ç¯‡æ–‡ç« åŸºæœ¬éƒ½æ˜¯åœ¨è¯´å°†ä¸€ä¸ªé›†åˆè½¬æˆä¸€ä¸ªæµï¼Œç„¶åå¯¹æµè¿›è¡Œæ“ä½œï¼Œå…¶å®è¿™ç§æ“ä½œæ˜¯æœ€å¤šçš„ï¼Œä½†æœ‰æ—¶å€™æˆ‘ä»¬ä¹Ÿæ˜¯éœ€è¦ä»æµä¸­æ”¶é›†èµ·ä¸€äº›å…ƒç´ ï¼Œå¹¶ä»¥é›†åˆçš„æ–¹å¼è¿”å›ï¼Œæˆ‘ä»¬æŠŠè¿™ç§åå‘æ“ä½œç§°ä¸ºæ”¶é›†ã€‚</p>\n<p>æµAPIä¹Ÿç»™æˆ‘ä»¬æä¾›äº†ç›¸åº”çš„æ–¹æ³•ã€‚</p>\n<h4 id=\"å¦‚ä½•åœ¨æµä¸­ä½¿ç”¨æ”¶é›†åŠŸèƒ½ï¼Ÿ\"><a href=\"#å¦‚ä½•åœ¨æµä¸­ä½¿ç”¨æ”¶é›†åŠŸèƒ½ï¼Ÿ\" class=\"headerlink\" title=\"å¦‚ä½•åœ¨æµä¸­ä½¿ç”¨æ”¶é›†åŠŸèƒ½ï¼Ÿ\"></a>å¦‚ä½•åœ¨æµä¸­ä½¿ç”¨æ”¶é›†åŠŸèƒ½ï¼Ÿ</h4><p>æˆ‘ä»¬å…ˆçœ‹ä¸€çœ‹æµAPIç»™æˆ‘ä»¬æä¾›çš„æ–¹æ³•ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public interface Stream&lt;T&gt; extends BaseStream&lt;T, Stream&lt;T&gt;&gt; &#123;\n&#x2F;&#x2F;...å¿½ç•¥é‚£äº›ä¸é‡è¦çš„ä¸œè¥¿\n&lt;R&gt; R collect(Supplier&lt;R&gt; supplier,\n                  BiConsumer&lt;R, ? super T&gt; accumulator,\n                  BiConsumer&lt;R, R&gt; combiner);\n&lt;R, A&gt; R collect(Collector&lt;? super T, A, R&gt; collector);\nï½<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æµAPIä¸­ç»™æˆ‘ä»¬æä¾›äº†ä¸¤ç§ï¼Œæˆ‘ç»™å¤§å®¶åˆ†æä¸€ä¸‹</p>\n<p><strong>&lt;R, A&gt; R collect(Collector&lt;? super T, A, R&gt; collector);</strong></p>\n<p>å…¶ä¸­RæŒ‡å®šç»“æœçš„ç±»å‹ï¼ŒTæŒ‡å®šäº†è°ƒç”¨æµçš„å…ƒç´ ç±»å‹ã€‚å†…éƒ¨ç§¯ç´¯çš„ç±»å‹ç”±AæŒ‡å®šã€‚collectorFuncæ˜¯ä¸€ä¸ªæ”¶é›†å™¨ï¼ŒæŒ‡å®šæ”¶é›†è¿‡ç¨‹å¦‚ä½•æ‰§è¡Œï¼Œcollect()æ–¹æ³•æ˜¯ä¸€ä¸ªç»ˆç«¯æ–¹æ³•ã€‚</p>\n<p>è™½ç„¶æˆ‘ä»¬åŸºæœ¬ä¸Šå¾ˆå°‘ä¼šç”¨åˆ°è‡ªå®šä¹‰çš„collectorFunc,ä½†æ˜¯äº†ä¸ºæ‰©å±•å¤§å®¶çš„çŸ¥è¯†é¢ï¼Œæˆ‘ä»¬è¿˜æ˜¯ç®€å•åœ°èŠä¸€èŠCollectorï¼ŒBecause itâ€™s my style! </p>\n<p><code>Collector</code>æ¥å£ä½äº<code>java.util.stream</code>åŒ…ä¸­çš„å£°æ˜ï¼Œå®ƒçš„å®¹é¢œæ˜¯è¿™æ ·çš„ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">package java.util.stream;\npublic interface Collector&lt;T, A, R&gt; &#123;\n      Supplier&lt;A&gt; supplier();\n      BiConsumer&lt;A, T&gt; accumulator();\n      BinaryOperator&lt;A&gt; combiner();\n      Function&lt;A, R&gt; finisher();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å…¶ä¸­Tã€Aã€Rçš„å«ä¹‰å’Œä¸Šé¢æ˜¯ä¸€æ ·çš„<code>å…¶ä¸­RæŒ‡å®šç»“æœçš„ç±»å‹ï¼ŒTæŒ‡å®šäº†è°ƒç”¨æµçš„å…ƒç´ ç±»å‹ã€‚å†…éƒ¨ç§¯ç´¯çš„ç±»å‹ç”±AæŒ‡å®š</code>ã€‚</p>\n<p>ä½†æ˜¯è¿™ä¸€ç¯‡æˆ‘ä»¬ä¸å®ç°ä»–ä»¬ï¼Œå› ä¸ºJDKå·²ç»ç»™æˆ‘ä»¬æä¾›äº†å¾ˆå¼ºå¤§çš„æ–¹æ³•äº†ï¼Œä»–ä»¬ä½äº<code>java.util.stream</code>ä¸‹é¢çš„<code>Collectors</code>ç±»ï¼Œæˆ‘ä»¬æœ¬ç¯‡ä¹Ÿä¸»è¦æ˜¯ä½¿ç”¨<code>Collectors</code>æ¥å®ç°æ”¶é›†çš„åŠŸèƒ½ã€‚</p>\n<p><code>Collectors</code>ç±»æ˜¯ä¸€ä¸ªæœ€ç»ˆç±»ï¼Œé‡Œé¢æä¾›äº†å¤§é‡çš„é™æ€çš„æ”¶é›†å™¨æ–¹æ³•ï¼Œå€ŸåŠ©ä»–ï¼Œæˆ‘ä»¬åŸºæœ¬å¯ä»¥å®ç°å„ç§å¤æ‚çš„åŠŸèƒ½äº†ã€‚</p>\n<p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹toListå’ŒtoSetæ–¹æ³•:</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public static &lt;T&gt;  Collector&lt;T, ?, List&lt;T&gt;&gt; toList()\npublic static &lt;T&gt; Collector&lt;T, ?, Set&lt;T&gt;&gt; toSet()<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span></span></code></pre>\n\n<p>å…¶ä¸­<code>Collectors#toList()</code>è¿”å›çš„æ”¶é›†å™¨å¯ä»¥æŠŠæµä¸­å…ƒç´ æ”¶é›†åˆ°ä¸€ä¸ªListä¸­ï¼Œ<code>Collectors#toSet()</code>è¿”å›çš„æ”¶é›†å™¨å¯ä»¥æŠŠæµä¸­çš„å…ƒç´ æ”¶é›†åˆ°ä¸€ä¸ªSetä¸­ã€‚æ¯”å¦‚ï¼šå¦‚æœä½ æƒ³æŠŠå…ƒç´ æ”¶é›†åˆ°Listä¸­ï¼Œä½ å¯ä»¥è¿™æ ·ç”¨ï¼Œ<code>steam.collect(Collectors.toList)</code>ã€‚</p>\n<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬æŠŠæˆ‘ä»¬çš„ç‹è€…è£è€€å›¢é˜Ÿç»æµä¾‹å­ä¿®æ”¹ä¸€ä¸‹ï¼ŒæŠŠæ˜æ˜Ÿç©å®¶å’Œå½“å‰è·å¾—çš„é‡‘å¸æ•°æ”¶é›†åˆ°ä¸€ä¸ªListé‡Œé¢ï¼ŒæŠŠå‡ºåœºçš„è‹±é›„æ”¶é›†åˆ°ä¸€ä¸ªSeté‡Œé¢ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">#ç©å®¶ä½¿ç”¨çš„è‹±é›„ä»¥åŠå½“å‰è·å¾—çš„é‡‘å¸æ•°\npublic class HeroPlayerGold &#123;\n    &#x2F;** ä½¿ç”¨çš„è‹±é›„åå­— *&#x2F;\n    private String hero;\n    &#x2F;** ç©å®¶çš„ID *&#x2F;\n    private String player;\n    &#x2F;** è·å¾—çš„é‡‘å¸æ•° *&#x2F;\n    private int gold;\n\n\n    public HeroPlayerGold(String hero, String player, int gold) &#123;\n        this.hero &#x3D; hero;\n        this.player &#x3D; player;\n        this.gold &#x3D; gold;\n    &#125;\n\n    @Override\n    public String toString() &#123;\n        return &quot;HeroPlayerGold&#123;&quot; +\n                &quot;hero&#x3D;&#39;&quot; + hero + &#39;\\&#39;&#39; +\n                &quot;, player&#x3D;&#39;&quot; + player + &#39;\\&#39;&#39; +\n                &quot;, gold&#x3D;&quot; + gold +\n                &#39;&#125;&#39;;\n    &#125;\n&#x2F;&#x2F;çœç•¥get&#x2F;set\n&#125;\n\n#å‡ºåœºçš„è‹±é›„\npublic class Hero &#123;\n    &#x2F;** ä½¿ç”¨çš„è‹±é›„åå­— *&#x2F;\n    private String hero;\n\n    public Hero(String hero) &#123;\n        this.hero &#x3D; hero;\n    &#125;\n\n    @Override\n    public String toString() &#123;\n        return &quot;Hero&#123;&quot; +\n                &quot;hero&#x3D;&#39;&quot; + hero + &#39;\\&#39;&#39; +\n                &#39;&#125;&#39;;\n    &#125;\n&#x2F;&#x2F;çœç•¥get&#x2F;set\n&#125;\n\n#æµ‹è¯•ç±»\npublic class Main &#123;\n    public static void main(String[] args) &#123;\n        learnCollect();\n    &#125;\n\n    private static void learnCollect() &#123;\n        List&lt;HeroPlayerGold&gt; lists &#x3D; new ArrayList&lt;&gt;();\n        lists.add(new HeroPlayerGold(&quot;ç›–ä¼¦&quot;, &quot;RNG-Letme&quot;, 100));\n        lists.add(new HeroPlayerGold(&quot;è¯¸è‘›äº®&quot;, &quot;RNG-Xiaohu&quot;, 300));\n        lists.add(new HeroPlayerGold(&quot;éœ²å¨œ&quot;, &quot;RNG-MLXG&quot;, 300));\n        lists.add(new HeroPlayerGold(&quot;ç‹„ä»æ°&quot;, &quot;RNG-UZI&quot;, 500));\n        lists.add(new HeroPlayerGold(&quot;ç‰›å¤´&quot;, &quot;RNG-Ming&quot;, 500));\n\n        List&lt;PlayerGold&gt; playerGolds &#x3D; lists.stream()\n                .map(plary -&gt; new PlayerGold(plary.getPlayer(), plary.getGold()))\n                .collect(Collectors.toList());\n        System.out.println(&quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;PlayerGold begin&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;);\n        playerGolds.forEach(System.out::println);\n        System.out.println(&quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;PlayerGold end&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;\\n&quot;);\n\n\n\n        Set&lt;Hero&gt; heroes &#x3D; lists.stream().map(player -&gt; new Hero(player.getHero())).collect(Collectors.toSet());\n        System.out.println(&quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Hero begin&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;);\n        heroes.forEach(System.out::println);\n        System.out.println(&quot;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Hero end&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&quot;);\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¾“å‡ºçš„æ—¥å¿—ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;PlayerGold begin&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;\nPlayerGold&#123;player&#x3D;&#39;RNG-Letme&#39;, gold&#x3D;100&#125;\nPlayerGold&#123;player&#x3D;&#39;RNG-Xiaohu&#39;, gold&#x3D;300&#125;\nPlayerGold&#123;player&#x3D;&#39;RNG-MLXG&#39;, gold&#x3D;300&#125;\nPlayerGold&#123;player&#x3D;&#39;RNG-UZI&#39;, gold&#x3D;500&#125;\nPlayerGold&#123;player&#x3D;&#39;RNG-Ming&#39;, gold&#x3D;500&#125;\n&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;PlayerGold end&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;\n\n&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Hero begin&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;\nHero&#123;hero&#x3D;&#39;éœ²å¨œ&#39;&#125;\nHero&#123;hero&#x3D;&#39;ç‰›å¤´&#39;&#125;\nHero&#123;hero&#x3D;&#39;ç›–ä¼¦&#39;&#125;\nHero&#123;hero&#x3D;&#39;ç‹„ä»æ°&#39;&#125;\nHero&#123;hero&#x3D;&#39;è¯¸è‘›äº®&#39;&#125;\n&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;Hero end&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;&#x3D;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>çœ‹åˆ°è¿™é‡Œï¼Œå¤§å®¶æœ‰æ„Ÿå—åˆ°æµAPIçš„å¨åŠ›äº†å—ï¼Ÿæç¤ºä¸€ä¸‹ï¼Œå°è£…ä¸€ä¸ªå·¥å…·ç±»ï¼Œç„¶åç»“åˆä¸€FastJsonè¿™ç§ä¸œè¥¿ä¸€èµ·ä½¿ç”¨ï¼æ˜¯çœŸçš„å¥½ç”¨å•Šï¼å…¶å®å°†æ•°æ®ä»é›†åˆç§»åˆ°æµä¸­ï¼Œæˆ–è€…å°†æ•°æ®ä»æµç§»å›é›†åˆçš„èƒ½åŠ›ï¼Œæ˜¯æµAPIç»™æˆ‘ä»¬æä¾›çš„ä¸€ä¸ªå¼ºå¤§ç‰¹æ€§ï¼Œå› ä¸ºè¿™å…è®¸é€šè¿‡æµæ¥æ“ä½œé›†åˆï¼Œç„¶åæŠŠæµé‡æ–°æ‰“åŒ…æˆé›†åˆã€‚æ­¤å¤–ï¼Œæ¡ä»¶åˆé€‚çš„æ—¶å€™ï¼Œè®©æµæ“ä½œå¹¶è¡Œå‘ç”Ÿï¼Œæé«˜æ•ˆç‡ã€‚</p>\n<p>æ¥ä¸‹æ¥æˆ‘ä»¬åˆ†æç¬¬äºŒä¸ªæ–¹æ³•ï¼Œ</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&lt;R&gt; R collect(Supplier&lt;R&gt; supplier,\n                 BiConsumer&lt;R, ? super T&gt; accumulator,\n                 BiConsumer&lt;R, R&gt; combiner);<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span></span></code></pre>\n\n<p>æˆ‘ä»¬ç¬¬äºŒä¸ªç‰ˆæœ¬çš„æ”¶é›†æ–¹æ³•ï¼Œä¸»è¦æ˜¯å¯ä»¥åœ¨æ”¶é›†çš„è¿‡ç¨‹ä¸­ï¼Œç»™äºˆæ›´å¤šçš„æ§åˆ¶ã€‚å…¶ä¸­supplieræŒ‡å®šå¦‚ä½•åˆ›å»ºç”¨äºä¿å­˜ç»“æœçš„å¯¹è±¡ï¼Œæ¯”å¦‚ï¼Œè¦ä½¿ç”¨ArrayListä½œä¸ºç»“æœçš„é›†åˆï¼Œéœ€è¦æŒ‡å®šå®ƒçš„æ„é€ å‡½æ•°ï¼Œaccumulatorå‡½æ•°æ˜¯å°†ä¸€ä¸ªå…ƒç´ æ·»åŠ åˆ°ç»“æœä¸­ï¼Œè€Œcombinerå‡½æ•°åˆå¹¶ä¸¤ä¸ªéƒ¨åˆ†çš„ç»“æœã€‚</p>\n<p>å¤§å®¶åº”è¯¥å‘ç°äº†å§ï¼Œä»–çš„å·¥ä½œæ–¹å¼å’Œæˆ‘ä»¬ç¬¬ä¸‰ç¯‡ä»‹ç»ç¼©å‡æ“ä½œæ—¶çš„reduceæ–¹æ³•æ˜¯å¾ˆåƒçš„ã€‚å®ƒä»¬éƒ½å¿…é¡»æ˜¯æ— çŠ¶æ€å’Œä¸å¹²é¢„çš„ï¼Œå¹¶ä¸”å¿…é¡»æœ‰å…³è”æ€§ï¼Œä¸‰ä¸ªçº¦æŸæ¡ä»¶ç¼ºä¸€ä¸å¯ã€‚</p>\n<p><code>Supplier</code>ä¹Ÿæ˜¯<code>java.util.function</code>åŒ…ä¸­çš„ä¸€ä¸ªå‡½æ•°å¼æ¥å£:</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@FunctionalInterface\npublic interface Supplier&lt;T&gt; &#123;\n    T get();\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>åªæœ‰ä¸€ä¸ªget()ï¼Œå¹¶ä¸”æ˜¯æ²¡æœ‰å‚æ•°çš„ï¼Œåœ¨collect()æ–¹æ³•è¿”å›ä¸€ä¸ªRç±»å‹çš„å¯¹è±¡ï¼Œå¹¶ä¸”get()æ–¹æ³•è¿”å›ä¸€ä¸ªæŒ‡å‘é›†åˆçš„å¼•ç”¨ã€‚</p>\n<p>è€Œaccumulator,combinerçš„ç±»å‹æ˜¯<code>BiConsumer</code>ï¼Œä»–ä»¬ä¹Ÿæ˜¯<code>java.util.function</code>åŒ…ä¸­çš„ä¸€ä¸ªå‡½æ•°å¼æ¥å£:</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@FunctionalInterface\npublic interface BiConsumer&lt;T, U&gt; &#123;\n    void accept(T t, U u);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å…¶ä¸­t,uæ‰§è¡ŒæŸç§ç±»å‹çš„æ“ä½œï¼Œå¯¹äºaccumulatoræ¥è¯´ï¼ŒtæŒ‡å®šäº†ç›®æ ‡é›†åˆï¼ŒuæŒ‡å®šäº†è¦æ·»åŠ åˆ°è¯¥é›†åˆçš„å…ƒç´ ã€‚å¯¹äºcombineræ¥è¯´ï¼Œtå’ŒuæŒ‡å®šçš„æ˜¯ä¸¤ä¸ªè¦è¢«åˆå¹¶çš„é›†åˆã€‚</p>\n<p>æˆ‘ä»¬æŠŠå‰é¢çš„ä¾‹å­æ”¹å˜ä¸€ä¸‹ï¼Œç„¶åä¹Ÿè¯¦ç»†åœ°è¯´ä¸€ä¸‹ï¼Œåœ¨æ²¡æœ‰ç”¨lambdaå’Œä½¿ç”¨lambdaä¹‹åçš„åŒºåˆ«ï¼š</p>\n<p>è¿™ä¸ªæ˜¯æ²¡æœ‰ä½¿ç”¨lambdaå‰çš„ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void learnCollect() &#123;\n        List&lt;HeroPlayerGold&gt; lists &#x3D; new ArrayList&lt;&gt;();\n        lists.add(new HeroPlayerGold(&quot;ç›–ä¼¦&quot;, &quot;RNG-Letme&quot;, 100));\n        lists.add(new HeroPlayerGold(&quot;è¯¸è‘›äº®&quot;, &quot;RNG-Xiaohu&quot;, 300));\n        lists.add(new HeroPlayerGold(&quot;éœ²å¨œ&quot;, &quot;RNG-MLXG&quot;, 300));\n        lists.add(new HeroPlayerGold(&quot;ç‹„ä»æ°&quot;, &quot;RNG-UZI&quot;, 500));\n        lists.add(new HeroPlayerGold(&quot;ç‰›å¤´&quot;, &quot;RNG-Ming&quot;, 500));\n\n\n        lists.stream().collect(new Supplier&lt;HashSet&lt;HeroPlayerGold&gt;&gt;() &#123;\n                                   @Override\n                                   public HashSet&lt;HeroPlayerGold&gt; get() &#123;\n                                       return new HashSet&lt;&gt;();\n                                   &#125;\n                               &#125;,&#x2F;&#x2F;ç¬¬ä¸€ä¸ªå‚æ•°\n                new BiConsumer&lt;HashSet&lt;HeroPlayerGold&gt;, HeroPlayerGold&gt;() &#123;\n                    @Override\n                    public void accept(HashSet&lt;HeroPlayerGold&gt; heroPlayerGolds, HeroPlayerGold heroPlayerGold) &#123;\n                        heroPlayerGolds.add(heroPlayerGold);\n                    &#125;\n                &#125;,&#x2F;&#x2F;ç¬¬äºŒä¸ªå‚æ•°\n                new BiConsumer&lt;HashSet&lt;HeroPlayerGold&gt;, HashSet&lt;HeroPlayerGold&gt;&gt;() &#123;\n                    @Override\n                    public void accept(HashSet&lt;HeroPlayerGold&gt; heroPlayerGolds, HashSet&lt;HeroPlayerGold&gt; heroPlayerGolds2) &#123;\n                        heroPlayerGolds.addAll(heroPlayerGolds2);\n                    &#125;\n                &#125;&#x2F;&#x2F;ç¬¬ä¸‰ä¸ªå‚æ•°\n        ).forEach(System.out::println);\n    &#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>åœ¨æ²¡æœ‰ä½¿ç”¨lambdaå‰ï¼Œè™½ç„¶çœ‹èµ·æ¥çš„è®©äººçœ¼èŠ±ç¼­ä¹±çš„ï¼Œä½†ä¸å¾—ä¸è¯´ï¼Œä»–å…¶å®èƒ½å¸®åŠ©æˆ‘ä»¬å®ç°éå¸¸å¼ºå¤§çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰çš„æ”¶é›†è¿‡ç¨‹ï¼Œå…¨éƒ¨éƒ½å¯ä»¥äº¤ç»™è¿™ä¸ªå®¶ä¼™ï¼Œæˆ‘ä»¬ç”¨lambdaæ•´ç†ä¸€ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void learnCollect() &#123;\n        List&lt;HeroPlayerGold&gt; lists &#x3D; new ArrayList&lt;&gt;();\n        lists.add(new HeroPlayerGold(&quot;ç›–ä¼¦&quot;, &quot;RNG-Letme&quot;, 100));\n        lists.add(new HeroPlayerGold(&quot;è¯¸è‘›äº®&quot;, &quot;RNG-Xiaohu&quot;, 300));\n        lists.add(new HeroPlayerGold(&quot;éœ²å¨œ&quot;, &quot;RNG-MLXG&quot;, 300));\n        lists.add(new HeroPlayerGold(&quot;ç‹„ä»æ°&quot;, &quot;RNG-UZI&quot;, 500));\n        lists.add(new HeroPlayerGold(&quot;ç‰›å¤´&quot;, &quot;RNG-Ming&quot;, 500));\n\n\n        lists.stream().collect(() -&gt; new HashSet&lt;&gt;(),\n                                (set,elem)-&gt;set.add(elem),\n                                (setA,setB)-&gt;setA.addAll(setB)\n        ).forEach(System.out::println);\n        \n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¤§å®¶ä»¥ä¸ºåˆ°è¿™é‡Œå°±ç»“æŸäº†å—ï¼Ÿå…¶å®è¿˜å¯ä»¥ä½¿ç”¨æ–¹æ³•å¼•ç”¨å’Œæ„é€ å‡½æ•°å¼•ç”¨æ¥ç®€åŒ–ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void learnCollect() &#123;\n        List&lt;HeroPlayerGold&gt; lists &#x3D; new ArrayList&lt;&gt;();\n        lists.add(new HeroPlayerGold(&quot;ç›–ä¼¦&quot;, &quot;RNG-Letme&quot;, 100));\n        lists.add(new HeroPlayerGold(&quot;è¯¸è‘›äº®&quot;, &quot;RNG-Xiaohu&quot;, 300));\n        lists.add(new HeroPlayerGold(&quot;éœ²å¨œ&quot;, &quot;RNG-MLXG&quot;, 300));\n        lists.add(new HeroPlayerGold(&quot;ç‹„ä»æ°&quot;, &quot;RNG-UZI&quot;, 500));\n        lists.add(new HeroPlayerGold(&quot;ç‰›å¤´&quot;, &quot;RNG-Ming&quot;, 500));\n\n\n        lists.stream().collect(HashSet::new,\n                               HashSet::add,\n                               HashSet::addAll\n        ).forEach(System.out::println);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"å°ç»“ä¸€ä¸‹\"><a href=\"#å°ç»“ä¸€ä¸‹\" class=\"headerlink\" title=\"å°ç»“ä¸€ä¸‹\"></a>å°ç»“ä¸€ä¸‹</h4><p>æœ¬ç¯‡å¸¦å¤§å®¶å…¥é—¨äº†Streamçš„æ”¶é›†æ“ä½œï¼Œä½†æ˜¯æœ‰äº†äº›è¿™å…¥é—¨æ“ä½œï¼Œæˆ‘ç›¸ä¿¡ï¼Œä½ åœ¨æˆ‘çš„æ¼”å˜è¿‡ç¨‹ä¸­å·²ç»å‘ç°äº†æ‰©å±•ç‚¹äº†ï¼Œä¸ç®¡æ˜¯supplierï¼Œaccumulatorè¿˜æ˜¯combinerï¼Œéƒ½å¯ä»¥åœ¨é‡Œé¢æ”¾ä¸€äº›ç‰¹åˆ«çš„æ“ä½œè¿›å»ï¼Œä»è€Œæ»¡è¶³ä½ ä»¬çš„å„ç§è¦æ±‚ã€‚</p>\n<p>å¦å¤–ä¸€ä¸ªç‚¹ï¼Œå¤§å®¶ä¸€å®šä¸è¦å¿˜è®°äº†Collectorsè¿™ä¸ªæœ€ç»ˆç±»ï¼Œé‡Œé¢å·²ç»æä¾›äº†å¾ˆå¤šå¾ˆå¼ºå¤§çš„é™æ€æ–¹æ³•ï¼Œå¦‚æœä½ ä»¬é‡åˆ°ä¸€äº›ç‰¹åˆ«çš„éœ€æ±‚ï¼Œé¦–å…ˆè¦æƒ³åˆ°çš„åº”è¯¥æ˜¯Collectorsï¼Œå¦‚æœé‡Œé¢çš„æ–¹æ³•éƒ½ä¸èƒ½å®ç°ä½ çš„è¦æ±‚ï¼Œå†è€ƒè™‘é€šè¿‡ç¬¬äºŒä¸ªç‰ˆæœ¬çš„collect()æ–¹æ³•å®ç°ä½ çš„è‡ªå®šä¹‰æ”¶é›†è¿‡ç¨‹å§ã€‚</p>\n"},{"title":"Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆäº”ï¼‰æ˜ å°„","date":"2025-10-15T03:36:33.000Z","_content":"\nç»è¿‡äº†å‰é¢å››ç¯‡æ–‡ç« çš„å­¦ä¹ ï¼Œç›¸ä¿¡å¤§å®¶å¯¹Streamæµå·²ç»æ˜¯ç›¸å½“çš„ç†Ÿæ‚‰äº†ï¼ŒåŒæ—¶ä¹ŸæŒæ¡äº†ä¸€äº›é«˜çº§åŠŸèƒ½äº†ï¼Œå¦‚æœä½ ä¹‹å‰æœ‰é˜…è¯»è¿‡é›†åˆæ¡†æ¶çš„åŸºçŸ³`Collection`æ¥å£ï¼Œæ˜¯ä¸æ˜¯åœ¨ç»è¿‡å‰é¢çš„å­¦ä¹ ï¼Œä»¥å‰çœ‹ä¸æ‡‚çš„ä¸œè¥¿ï¼Œçªç„¶ä¹‹é—´å°±æç„¶å¤§æ‚Ÿäº†å‘¢ï¼Ÿ\n\nä»Šå¤©æˆ‘ä»¬çš„ä¸»è§’æ˜¯Streamæµé‡Œé¢çš„æ˜ å°„ã€‚ç”±äºä¹‹å‰ï¼Œæ˜ å°„å¹¶æ²¡æœ‰å†æˆ‘ä»¬çš„Demoï¼Œä¾‹å­ä¸­å‡ºç°è¿‡ï¼Œæ‰€ä»¥å¯¹å¤§å®¶æ¥è¯´å¯èƒ½ä¼šç¨å¾®æœ‰ä¸€ç‚¹ç‚¹é™Œç”Ÿçš„ï¼Œä½†é€šè¿‡è¿™ä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ç›¸ä¿¡èƒ½è§£å†³ä½ çš„ç–‘é—®ã€‚\n\nåœ¨æ­£å¼å¼€å§‹ä¹‹å‰ï¼Œæˆ‘å’Œå¤§å®¶ç»§ç»­è¯´è¯´æµAPIæ“ä½œï¼Œä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰æ³¨æ„åˆ°ï¼Œå…¶å®æˆ‘ä»¬æ‰€æœ‰çš„æµAPIæ“ä½œéƒ½æ˜¯é’ˆå¯¹æµä¸­çš„å…ƒç´ è¿›è¡Œçš„ï¼Œå¹¶ä¸”éƒ½æ˜¯åŸºäºåŒä¸€æµé‡Œé¢çš„ï¼Œå¤§å®¶æœ‰æ²¡æœ‰è¿™æ ·çš„ç–‘é—®ï¼Œæ€ä¹ˆæ ·æŠŠä¸€ä¸ªæµçš„å…ƒç´ å¼„åˆ°å¦ä¸€ä¸ªæµé‡Œé¢å‘¢ï¼Ÿæ€ä¹ˆæŠŠæµä¸­çš„ä¸€äº›æ»¡è¶³æ¡ä»¶çš„å…ƒç´ æ”¾åˆ°ä¸€ä¸ªæ–°æµé‡Œé¢å‘¢ï¼Ÿ\n\né€šè¿‡è¿™ä¸€èŠ‚ï¼Œä½ å°†ä¼šæŒæ¡è§£å†³åˆšæ‰é—®é¢˜çš„æœ¬é¢†ã€‚å¦å¤–å†æä¸€ç‚¹ï¼Œå¦‚æœæµæ“ä½œåªæœ‰ä¸­é—´æ“ä½œï¼Œæ²¡æœ‰ç»ˆç«¯æ“ä½œï¼Œé‚£ä¹ˆè¿™äº›ä¸­é—´æ“ä½œæ˜¯ä¸ä¼šæ‰§è¡Œçš„ï¼Œæ¢å¥è¯è¯´ï¼Œåªæœ‰ç»ˆç«¯æ“ä½œæ‰èƒ½è§¦å‘ä¸­é—´æ“ä½œçš„è¿è¡Œã€‚\n\n#### æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦æ˜ å°„ï¼Ÿ\n\nå› ä¸ºåœ¨å¾ˆå¤šæ—¶å€™ï¼Œå°†ä¸€ä¸ªæµçš„å…ƒç´ æ˜ å°„åˆ°å¦ä¸€ä¸ªæµå¯¹æˆ‘ä»¬æ˜¯éå¸¸æœ‰å¸®åŠ©çš„ã€‚æ¯”å¦‚æœ‰ä¸€ä¸ªåŒ…å«æœ‰åå­—ï¼Œæ‰‹æœºå·ç å’Œé’±çš„æ•°æ®åº“æ„æˆçš„æµï¼Œå¯èƒ½ä½ åªæƒ³è¦æ˜ å°„é’±è¿™ä¸ªå­—æ®µåˆ°å¦ä¸€ä¸ªæµï¼Œè¿™æ—¶å€™å¯èƒ½ä¹‹å‰å­¦åˆ°çš„çŸ¥è¯†å°±è¿˜ä¸èƒ½è§£å†³ï¼Œäºæ˜¯æ˜ å°„å°±ç«™äº†å‡ºæ¥äº†ã€‚\n\nå¦å¤–ï¼Œå¦‚æœä½ å¸Œæœ›å¯¹æµä¸­çš„å…ƒç´ åº”ç”¨ä¸€äº›è½¬æ¢ï¼Œç„¶åæŠŠè½¬æ¢çš„å…ƒç´ æ˜ å°„åˆ°ä¸€ä¸ªæ–°æµé‡Œé¢ï¼Œè¿™æ—¶å€™ä¹Ÿå¯ä»¥ç”¨æ˜ å°„ã€‚\n\næˆ‘ä»¬å…ˆæ¥çœ‹çœ‹æµAPIåº“ç»™æˆ‘ä»¬æä¾›äº†ä»€ä¹ˆæ ·çš„æ”¯æŒ\n\n```\npublic interface Stream<T> extends BaseStream<T, Stream<T>> {\n    <R> Stream<R> map(Function<? super T, ? extends R> mapper);//line2\n    IntStream mapToInt(ToIntFunction<? super T> mapper);//line3\n    LongStream mapToLong(ToLongFunction<? super T> mapper);//line4\n    DoubleStream mapToDouble(ToDoubleFunction<? super T> mapper);//line5\n    <R> Stream<R> flatMap(Function<? super T, ? extends Stream<? extends R>> mapper);//line6\n    IntStream flatMapToInt(Function<? super T, ? extends IntStream> mapper);//line7\n    LongStream flatMapToLong(Function<? super T, ? extends LongStream> mapper);//line8\n    DoubleStream flatMapToDouble(Function<? super T, ? extends DoubleStream> mapper);//line9\n}\n```\n\næˆ‘å’Œå¤§å®¶åˆ†æä¸€ä¸ªæœ€å…·æœ‰ä¸€èˆ¬æ€§çš„æ˜ å°„æ–¹æ³•map()ï¼Œç›¸ä¿¡å¤§å®¶å°±èƒ½ä¸¾ä¸€åä¸‰äº†ï¼Œmap()å®šä¹‰å¦‚ä¸‹ï¼Œ\n\n **<R> Stream<R> map(Function<? super T, ? extends R> mapper);**\n\nå…¶ä¸­ï¼ŒRæŒ‡å®šæ–°æµçš„å…ƒç´ ç±»å‹ï¼ŒTæŒ‡å®šè°ƒç”¨æµçš„å…ƒç´ ç±»å‹ï¼Œmapperæ˜¯å®Œæˆæ˜ å°„çš„Functionå®ä¾‹ï¼Œè¢«ç§°ä¸ºæ˜ å°„å‡½æ•°ï¼Œæ˜ å°„å‡½æ•°å¿…é¡»æ˜¯æ— çŠ¶æ€å’Œä¸å¹²é¢„çš„ï¼ˆå¤§å®¶å¯¹è¿™äºŒä¸ªçº¦æŸæ¡ä»¶åº”è¯¥å¾ˆç†Ÿæ‚‰äº†å§ï¼‰ã€‚å› ä¸ºmap()æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªæ–°æµï¼Œå› æ­¤å®ƒæ˜¯ä¸€ä¸ªä¸­é—´æ“ä½œã€‚\n\n`Function`æ˜¯ `java.util.function`åŒ…ä¸­å£°æ˜çš„ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œå£°æ˜å¦‚ä¸‹ï¼š\n\n```\n@FunctionalInterface\npublic interface Function<T, R> {\n     R apply(T t);\n}\n```\nåœ¨map()çš„ä½¿æœ‰è¿‡ç¨‹ä¸­ï¼ŒTæ˜¯è°ƒç”¨æµçš„å…ƒç´ ç±»å‹ï¼ŒRæ˜¯æ˜ å°„çš„ç»“æœç±»å‹ã€‚å…¶ä¸­,apply(T t)ä¸­çš„tæ˜¯å¯¹è¢«æ˜ å°„å¯¹è±¡çš„å¼•ç”¨ï¼Œè¢«è¿”å›æ˜ å°„ç»“æœã€‚ä¸‹é¢æˆ‘ä»¬å°†ä¸Šä¸€ç¯‡ä¸­çš„ä¾‹å­è¿›è¡Œå˜å½¢ï¼Œç”¨æ˜ å°„æ¥å®Œæˆä»–:\n\n`å‡è®¾Listé‡Œé¢æœ‰ä¸‰ä¸ªIntegerç±»å‹çš„å…ƒç´ åˆ†åˆ«ä¸º1ï¼Œ2ï¼Œ3ã€‚ç°åœ¨çš„éœ€æ±‚æ˜¯åˆ†åˆ«è®©Listé‡Œé¢çš„æ¯ä¸ªå…ƒç´ éƒ½æ”¾å¤§ä¸¤å€åï¼Œå†æ±‚ç§¯ã€‚è¿™ä¸ªéœ€æ±‚çš„æ­£ç¡®ç­”æ¡ˆåº”è¯¥æ˜¯48;`\n\n```\nprivate static void learnMap() {\n     List<Integer> lists = new ArrayList<>();\n        lists.add(1);\n        lists.add(2);\n        lists.add(3);\n     //ä½¿ç”¨å¹¶è¡Œæµæ¥å¤„ç†\n     Integer product = lists.parallelStream().reduce(1, (a, b) -> a *  (b * 2),\n                                                        (a, b) -> a * b);\n     System.out.println(\"product:\" + product);//48\n\n     //ä½¿ç”¨æ˜ å°„æ¥å¤„ç† \n     //Integer productMap = lists.parallelStream().map((a) -> a * 2).reduce(1, (a, b) -> a * b);\n     Stream<Integer> productNewMapStream = lists.parallelStream().map((a) -> a * 2);\n     Integer productMap = productNewMapStream.reduce(1, (a, b) -> a * b);\n     System.out.println(\"productMap:\" + productMap);//48\n}\n```\n\nä¸ä½¿ç”¨å¹¶è¡Œæµä¸åŒï¼Œåœ¨ä½¿ç”¨æ˜ å°„å¤„ç†çš„æ—¶å€™ï¼Œå…ƒç´ æ‰©å¤§2å€å‘ç”Ÿæ—¶æœºä¸ä¸€æ ·äº†ï¼Œä½¿ç”¨å¹¶è¡Œæµå…ƒç´ æ‰©å¤§æ˜¯åœ¨ç¼©å‡çš„è¿‡ç¨‹å½“ä¸­çš„ï¼Œè€Œä½¿ç”¨æ˜ å°„å¤„ç†æ—¶ï¼Œå…ƒç´ æ‰©å¤§æ˜¯å‘ç”Ÿåœ¨æ˜ å°„è¿‡ç¨‹ä¸­çš„ã€‚å› æ­¤æ˜ å°„è¿‡ç¨‹å®Œç¨‹ä¹‹åï¼Œä¸éœ€è¦reduce()æä¾›åˆå¹¶å™¨äº†ã€‚\n\nä¸Šé¢çš„è¿™ä¸ªä¾‹å­è¿˜æ˜¯ç®€å•äº†ä¸€ç‚¹ï¼Œä¸‹é¢å†ä¸¾ä¸€ä¸ªä¾‹å­,ç‹è€…è£è€€å›¢é˜Ÿç»æµè®¡ç®—ï¼š\n\n```\n#ç©å®¶ä½¿ç”¨çš„è‹±é›„ä»¥åŠå½“å‰è·å¾—çš„é‡‘å¸æ•°\npublic class HeroPlayerGold {\n    /** ä½¿ç”¨çš„è‹±é›„åå­— */\n    private String hero;\n    /** ç©å®¶çš„ID */\n    private String player;\n    /** è·å¾—çš„é‡‘å¸æ•° */\n    private int gold;\n\n    public HeroPlayerGold(String hero, String player, int gold) {\n        this.hero = hero;\n        this.player = player;\n        this.gold = gold;\n    }\n  //çœç•¥get/set/toString\n}\n\n#ç©å®¶è·å¾—çš„é‡‘å¸æ•°\npublic class Gold {\n    /** è·å¾—çš„é‡‘å¸æ•° */\n    private int gold;\n\n    public Gold(int gold) {\n        this.gold = gold;\n    }\n //çœç•¥get/set/toString\nï½\n\n#æµ‹è¯•ç±»\npublic class Main {\n    public static void main(String[] args) {\n        learnMap2th();\n    }\n\n    private static void learnMap2th() {\n        List<HeroPlayerGold> lists = new ArrayList<>();\n        lists.add(new HeroPlayerGold(\"ç›–ä¼¦\", \"RNG-Letme\", 100));\n        lists.add(new HeroPlayerGold(\"è¯¸è‘›äº®\", \"RNG-Xiaohu\", 300));\n        lists.add(new HeroPlayerGold(\"éœ²å¨œ\", \"RNG-MLXG\", 300));\n        lists.add(new HeroPlayerGold(\"ç‹„ä»æ°\", \"RNG-UZI\", 500));\n        lists.add(new HeroPlayerGold(\"ç‰›å¤´\", \"RNG-Ming\", 500));\n\n        //è®¡ç®—å›¢é˜Ÿç»æµ\n        int teamMoney = lists.stream()\n                .map(player -> new Gold(player.getGold()))//note1\n                .mapToInt(Gold::getGold)\n                .reduce(0, (a, b) -> a + b);\n        System.out.println(\"å›¢é˜Ÿç»æµï¼š\" + teamMoney);//1700\n\n\n        //è®¡ç®—å›¢é˜Ÿç»æµ2\n        double teamMoney2 = lists.stream()\n                .mapToDouble(HeroPlayerGold::getGold)\n                .reduce(0, (a, b) -> a + b);\n        System.out.println(\"å›¢é˜Ÿç»æµï¼š\" + teamMoney2);//1700.0\n    }\n}\n\n```\n\nä»£ç åº”è¯¥ä¸éš¾ç†è§£ï¼Œé€šè¿‡ä»£ç ï¼Œå¤§å®¶åº”è¯¥çŸ¥é“æˆ‘ä»¬å‡è®¾çš„åœºæ™¯äº†ã€‚æˆ‘ä»¬çš„RNGå»å‚åŠ ç‹è€…è£è€€æ¯”èµ›äº†ï¼Œåƒè¿™ç§å›¢é˜Ÿæ¸¸æˆï¼Œè§‚ä¼—åœ¨ç»æµæ–¹é¢å…³æ³¨æ›´å¤šçš„å¯èƒ½æ˜¯å›¢é˜Ÿç»æµï¼Œè€Œä¸æ˜¯ä¸ªäººç»æµã€‚\n\nåœ¨æˆ‘ä»¬`HeroPlayerGold`ç±»é‡Œé¢å­˜æœ‰æ˜æ˜Ÿç©å®¶ï¼Œä½¿ç”¨çš„è‹±é›„ï¼Œå’Œè¿™å±€æ¯”èµ›æŸä¸ªç©å®¶å½“å‰è·å¾—çš„é‡‘å¸æ•°ï¼Œæˆ‘ä»¬å¦æœ‰ä¸€ä¸ªä¸“ä»¬ç®¡ç†é‡‘å¸çš„`Gold`ç±»ï¼Œæˆ‘ä»¬ç¬¬ä¸€ç§è®¡ç®—å›¢é˜Ÿç»æµçš„æ–¹å¼ï¼Œä½¿æŠŠ`HeroPlayerGold`é‡Œé¢çš„`gold`å­—æ®µè½¬æ¢åˆ°`Gold`é‡Œé¢äº†<sup> `//note1` </sup>,è¿™é‡Œäº§ç”Ÿçš„æ–°æµåªåŒ…å«äº†åŸå§‹æµä¸­é€‰å®šçš„`gold`å­—æ®µï¼Œå› ä¸ºæˆ‘ä»¬çš„åŸå§‹æµä¸­åŒ…å«äº†`hero`ã€`player`ã€`gold`,ä¸‰ä¸ªå­—æ®µï¼Œæˆ‘ä»¬åªé€‰å–äº†`gold`å­—æ®µï¼ˆå› ä¸ºæˆ‘ä»¬åªå…³å¿ƒè¿™ä¸ªå­—æ®µï¼‰ï¼Œæ‰€ä»¥å…¶å®ƒçš„ä¸¤ä¸ªå­—æ®µè¢«ä¸¢å¼ƒäº†ã€‚ç„¶åä»æ–°æµå–å‡º`Gold`é‡Œé¢çš„`gold`å­—æ®µå¹¶æŠŠä»–è½¬æˆä¸€ä¸ª`IntStream`ï¼Œç„¶åæˆ‘ä»¬å°±è¦ä»¥é€šè¿‡ç¼©å‡æ“ä½œå®Œæˆæˆ‘ä»¬çš„å›¢é˜Ÿç»æµè®¡ç®—äº†ã€‚\n\nç¬¬ä¸€ç§æ–¹å¼ï¼Œå¤§å®¶éœ€è¦å¥½å¥½ç†è§£ï¼Œç†è§£äº†ï¼Œæˆ‘ç›¸ä¿¡ä½ ä»¬çš„é¡¹ç›®ä¸­ï¼Œå¾ˆå¤šå¾ˆå¤šåœ°æ–¹å¯ä»¥ç”¨å¾—ä¸Šäº†ï¼Œå†ä¹Ÿä¸éœ€è¦åŠ¨ä¸åŠ¨å°±æŸ¥æ•°æ®åº“äº†ï¼Œæ€æ ·æ•ˆç‡é«˜æ€æ ·æ¥ï¼Œåªæ˜¯ä¸€ç§å»ºè®®ã€‚ç¬¬äºŒç§åªæ˜¯å¿«é€Ÿè®¡ç®—å›¢é˜Ÿç»æµè€Œå·²ï¼Œæ²¡ä»€ä¹ˆå€¼å¾—è®²çš„ã€‚\n\næ¥ä¸‹æ¥è®²ä¸€ä¸‹ä»–çš„æ‰©å±•æ–¹å‘ï¼šå¤§å®¶è¿˜è®°å¾—æˆ‘åœ¨ç¬¬äºŒç¯‡ä¸­ä»‹ç»ä¸­é—´æ“ä½œæ¦‚å¿µçš„æ—¶å€™å—ï¼Ÿ`ä¸­é—´æ“ä½œä¼šäº§ç”Ÿå¦ä¸€ä¸ªæµã€‚å› æ­¤ä¸­é—´æ“ä½œå¯ä»¥ç”¨æ¥åˆ›å»ºæ‰§è¡Œä¸€ç³»åˆ—åŠ¨ä½œçš„ç®¡é“ã€‚`æˆ‘ä»¬å¯ä»¥æŠŠå¤šä¸ªä¸­é—´æ“ä½œæ”¾åˆ°ç®¡é“ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾ˆå®¹æ˜“å°±åˆ›å»ºå‡ºå¾ˆå¼ºå¤§çš„ç»„åˆæ“ä½œäº†ï¼Œå‘æŒ¥ä½ çš„æƒ³è±¡ï¼Œæ‰“å‡ºä½ ä»¬çš„ç»„åˆæ‹³;\n\næˆ‘ç°åœ¨ä¸¾ä¸€ä¸ªä¾‹å­ï¼šæ¯”å¦‚ç°åœ¨ç›¸ç»Ÿè®¡å›¢é˜Ÿé‡Œé¢ä¸¤ä¸ªCä½çš„ç»æµå äº†å¤šå°‘ï¼Œä»£ç çœ‹èµ·æ¥å¯èƒ½å°±æ˜¯è¿™æ ·äº†ï¼š\n```\n private static void learnMap2th() {\n        List<HeroPlayerGold> lists = new ArrayList<>();\n        lists.add(new HeroPlayerGold(\"ç›–ä¼¦\", \"RNG-Letme\", 100));\n        lists.add(new HeroPlayerGold(\"è¯¸è‘›äº®\", \"RNG-Xiaohu\", 300));\n        lists.add(new HeroPlayerGold(\"éœ²å¨œ\", \"RNG-MLXG\", 300));\n        lists.add(new HeroPlayerGold(\"ç‹„ä»æ°\", \"RNG-UZI\", 500));\n        lists.add(new HeroPlayerGold(\"ç‰›å¤´\", \"RNG-Ming\", 500));\n        \n        //è®¡ç®—ä¸¤ä¸ªCä½çš„ç»æµå’Œ\n        lists.stream()\n                .filter(player-> \"RNG-Xiaohu\".equals(player.getPlayer()) || \"RNG-UZI\".equals(player.getPlayer()))\n                .map(player->new Gold(player.getGold()))\n                .mapToInt(Gold::getGold)\n                .reduce((a,b)->a+b)\n                .ifPresent(System.out::println);//800\n    }\n```\n\nå¤§å®¶æœ‰æ²¡æœ‰æ„Ÿè§‰ï¼Œè¿™ç§æ“ä½œæ€ä¹ˆå¸¦æœ‰ç‚¹æ•°æ®åº“çš„é£æ ¼å•Šï¼Ÿå…¶å®åœ¨åˆ›å»ºæ•°æ®åº“æŸ¥è¯¢çš„æ—¶å€™ï¼Œè¿™ç§è¿‡æ»¤æ“ä½œååˆ†å¸¸è§ï¼Œå¦‚æœä½ ç»å¸¸åœ¨ä½ çš„é¡¹ç›®ä¸­ä½¿ç”¨æµAPIï¼Œè¿™å‡ ä¸ªæ¡ä»¶ç®—ä»€ä¹ˆ?ç­‰ä½ ä»¬æŠŠæµAPIç”¨ç†Ÿäº†ä¹‹åï¼Œä½ ä»¬å®Œå…¨å¯ä»¥é€šè¿‡è¿™ç§é“¾å¼æ“ä½œåˆ›å»ºå‡ºéå¸¸å¤æ‚çš„æŸ¥è¯¢ï¼Œåˆå¹¶å’Œé€‰æ‹©çš„æ“ä½œã€‚\n\né€šè¿‡å‰é¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å·²ç»æŠŠ`map()`ï¼Œ`mapToInt()`ï¼Œ`mapToLong()`ï¼Œ`mapToDouble`éƒ½è®²äº†ã€‚é‚£ä¹ˆå‰©ä¸‹çš„å°±æ˜¯flatMap()æ–¹æ³•äº†ã€‚æœ¬æ¥æƒ³è®©å¤§å®¶è‡ªè¡Œå»ç†è§£è¿™ä¸ªæ–¹æ³•çš„ï¼Œå› ä¸ºæ€•è¿™ç¯‡æ–‡ç« å†™å¾—å¤ªé•¿äº†ã€‚ä½†æ˜¯åé¢æƒ³æƒ³ï¼Œè¿˜æ˜¯æˆ‘æ¥ç»™å¤§å®¶åˆ†æä¸€ä¸‹å§ã€‚\n\n**<R> Stream<R> flatMap(Function<? super T, ? extends Stream<? extends R>> mapper);**\n\né€šè¿‡å‰é¢çš„å­¦ä¹ æˆ‘ä»¬çŸ¥é“`mapper`æ˜¯ä¸€ä¸ªæ˜ å°„å‡½æ•°ï¼Œå®ƒå’Œmap()æ–¹æ³•ä¹Ÿä¸€æ ·ä¹Ÿä¼šè¿”å›ä¸€ä¸ªæ–°æµï¼Œæˆ‘ä»¬æŠŠè¿”å›çš„æ–°æµç§°ä¸ºæ˜ å°„æµã€‚**æˆ‘ä»¬æä¾›çš„æ˜ å°„å‡½æ•°ä¼šå¤„ç†åŸå§‹æµä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œè€Œæ˜ å°„æµä¸­åŒ…å«äº†æ‰€æœ‰ç»è¿‡æˆ‘ä»¬æ˜ å°„å‡½æ•°å¤„ç†åäº§ç”Ÿçš„æ–°å…ƒç´ ã€‚** åŠ ç²—éƒ¨ä»½éœ€è¦é‡ç‚¹ç†è§£ã€‚\n\næˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æºç å¯¹flatMap()çš„æ³¨é‡Š:\n\n> The  flatMap() operation has the effect of applying a one-to-many  transformation to the elements of the stream, and then flattening the resulting elements into a new stream.\n\nå¤§æ„å°±æ˜¯ï¼š**flatMap()æ“ä½œèƒ½æŠŠåŸå§‹æµä¸­çš„å…ƒç´ è¿›è¡Œä¸€å¯¹å¤šçš„è½¬æ¢ï¼Œå¹¶ä¸”å°†æ–°ç”Ÿæˆçš„å…ƒç´ å…¨éƒ½åˆå¹¶åˆ°å®ƒè¿”å›çš„æµé‡Œé¢ã€‚**æ ¹æ®æˆ‘ä»¬æ‰€å­¦çš„çŸ¥è¯†ï¼Œä»–çš„è¿™ç§ä¸€å¯¹å¤šçš„è½¬æ¢åŠŸèƒ½è‚¯å®šå°±æ˜¯æ˜ å°„å‡½æ•°æä¾›çš„ï¼Œè¿™ä¸€ç‚¹æ²¡æœ‰ç–‘é—®å§ï¼ç„¶åæºç çš„æ³¨é‡Šä¸Šé¢è¿˜æä¾›äº†ä¸€ä¸ªä¾‹å­ï¼Œé€šè¿‡æ³¨é‡ŠåŠ ä¾‹å­ï¼Œæˆ‘ç›¸ä¿¡å¤§å®¶éƒ½èƒ½éå¸¸æ¸…æ¥šåœ°ç†è§£flatMap()äº†ã€‚\n\n```\n    /* <p>If {@code orders} is a stream of purchase orders, and each purchase\n     * order contains a collection of line items, then the following produces a\n     * stream containing all the line items in all the orders:\n     * <pre>{@code\n     *     orders.flatMap(order -> order.getLineItems().stream())...\n     * }</pre>\n     */\n```\n\n**å¦‚æœordersæ˜¯ä¸€æ‰¹é‡‡è´­è®¢å•å¯¹åº”çš„æµï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªé‡‡è´­è®¢å•éƒ½åŒ…å«ä¸€ç³»åˆ—çš„é‡‡è´­é¡¹ï¼Œé‚£ä¹ˆ`orders.flatMap(order -> order.getLineItems().stream())...`ç”Ÿæˆçš„æ–°æµå°†åŒ…å«è¿™ä¸€æ‰¹é‡‡è´­è®¢å•ä¸­æ‰€æœ‰é‡‡è´­é¡¹ã€‚** \n\næˆ‘ä»¬ç”¨ä¼ªä»£ç æ¥å°±æ›´åŠ æ¸…æ™°äº†`Stream<Orders<OrderItem>>`====>Stream<OrderItem>ã€‚å¤§å®¶èƒ½ç†è§£äº†å—ï¼Ÿè¿˜æ²¡ç†è§£ï¼Ÿå†æ¥ä¸€ä¸ªä¾‹å­ï¼š\n\n```\n private static void learnFlatMap() {\n        //(å¹¿å·  æ·±åœ³  ä¸Šæµ·  åŒ—äº¬)çš„å…¨æ‹¼çš„ä¸€äº›ç»„åˆ,ä¸‹é¢æˆ‘ä»¬å°±æŠŠæ¯ä¸€ä¸ªåŸå¸‚éƒ½åˆ’åˆ†ä¸€ä¸‹\n        List<String> citys = Arrays.asList(\"GuangZhou ShangHai\", \"GuangZhou ShenZhen\",\n                \"ShangHai ShenZhen\", \"BeiJing ShangHai\", \"GuangZhou BeiJing\", \"ShenZhen BeiJing\");\n\n        //è¿™é‡Œæ‰“å°çš„æ•°ç»„å¯¹åº”çš„åœ°å€\n        citys.stream().map(mCitys -> Arrays.stream(mCitys.split(\" \"))).forEach(System.out::println);//note1\n\n        System.out.println();\n\n        //æµé‡Œé¢çš„å…ƒç´ è¿˜æ˜¯ä¸€ä¸ªæ•°ç»„\n        citys.stream()\n                .map(mCities -> Arrays.stream(mCities.split(\" \")))//æµé‡Œé¢çš„æ¯ä¸ªå…ƒç´ è¿˜æ˜¯æ•°ç»„\n                .forEach(cities ->cities.forEach(city-> System.out.print(city+\" \")));//note2\n\n        System.out.println();\n        System.out.println();\n\n        //ç›´æ¥ä¸€ä¸ªflatMap()å°±æŠŠæ•°ç»„åˆå¹¶åˆ°æ˜ å°„æµé‡Œé¢äº†\n        citys.stream().flatMap(mCities->Arrays.stream(mCities.split(\" \"))).forEach(System.out::println);//note3\n\n        System.out.println();\n\n        //ä½¿ç”¨distinct()æ–¹æ³•å»é‡ï¼\n        citys.stream().flatMap(mCities->Arrays.stream(mCities.split(\" \"))).distinct().forEach(System.out::println);//note4\n\n    }\n```\n\nå…¶ä¸­<sup> `//note1` </sup>å¤„æ˜¯æ— æ³•æ‰“å°å…ƒç´ çš„ï¼Œä½¿ç”¨map()æ‰“å°å…ƒç´ çš„æ–¹å¼åœ¨<sup> `//note2` </sup>ï¼ŒåŸå› ä¹Ÿåœ¨æ³¨é‡Šä¸­äº¤å¾…äº†ï¼Œä½†æ˜¯ä½¿ç”¨äº†flatMap()æ–¹æ³•åï¼Œç›´æ¥å°±å¯ä»¥æ‰“å°äº†<sup> `//note3` </sup>ï¼Œåˆ°è¿™é‡Œï¼Œåº”è¯¥å°±èƒ½ç†è§£**å¦‚æœordersæ˜¯ä¸€æ‰¹é‡‡è´­è®¢å•å¯¹åº”çš„æµï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªé‡‡è´­è®¢å•éƒ½åŒ…å«ä¸€ç³»åˆ—çš„é‡‡è´­é¡¹ï¼Œé‚£ä¹ˆ`orders.flatMap(order -> order.getLineItems().stream())...`ç”Ÿæˆçš„æ–°æµå°†åŒ…å«è¿™ä¸€æ‰¹é‡‡è´­è®¢å•ä¸­æ‰€æœ‰é‡‡è´­é¡¹ã€‚** äº†å§ã€‚æœ€å<sup> `//note4` </sup>æ˜¯ä¸€ä¸ªå»é‡çš„æ–¹æ³•ï¼Œå¤§å®¶è¿è¡Œä¸€éå§ã€‚\n\n#### å°ç»“ä¸€ä¸‹\n\né€šè¿‡è¿™ä¸€ç¯‡æ–‡ç« ï¼Œç›¸ä¿¡å¤§å®¶å¯¹æµAPIä¸­çš„æ˜ å°„å·²ç»ä¸å†é™Œç”Ÿäº†ï¼Œå…¶å®æœ€éœ€è¦æ³¨æ„çš„ä¸€ä¸ªç‚¹æ˜¯,map()å’ŒflatMap()çš„åŒºåˆ«ï¼Œæˆ‘ä¹Ÿä¸€æ­¥æ­¥åœ°å¸¦ç€å¤§å®¶ç†è§£å’Œåº”ç”¨äº†ã€‚å…¶å®åœ¨æµAPIè¿™ä¸€å—ä¸­ï¼Œå¤§å®¶å•å•æŒæ¡æ¦‚å¿µæ˜¯æ²¡ä»€ä¹ˆç”¨çš„ï¼Œä¸€å®šè¦å»å®æˆ˜äº†ï¼Œä¸€ä¸ªé¡¹ç›®é‡Œé¢ï¼Œé›†åˆæ¡†æ¶è¿™ç§ä¸œè¥¿ç”¨å¾—è¿˜æ˜¯ç‰¹åˆ«å¤šçš„ï¼Œç”¨åˆ°é›†åˆæ¡†æ¶çš„å¤§éƒ¨ä»½æƒ…å†µï¼Œå…¶å®éƒ½å¯ä»¥è€ƒè™‘ä¸€ä¸‹ç”¨Streamæµå»æ“ä½œä¸€ä¸‹ï¼Œä¸ä»…å¢åŠ æ•ˆç‡ï¼Œè¿˜å¯ä»¥å¢åŠ ä¸šåŠ¡æµç¨‹çš„æ¸…æ™°åº¦ã€‚\n","source":"_posts/æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆäº”ï¼‰æ˜ å°„.md","raw":"---\ntitle: Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆäº”ï¼‰æ˜ å°„\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: æ–°ç‰¹æ€§\n---\n\nç»è¿‡äº†å‰é¢å››ç¯‡æ–‡ç« çš„å­¦ä¹ ï¼Œç›¸ä¿¡å¤§å®¶å¯¹Streamæµå·²ç»æ˜¯ç›¸å½“çš„ç†Ÿæ‚‰äº†ï¼ŒåŒæ—¶ä¹ŸæŒæ¡äº†ä¸€äº›é«˜çº§åŠŸèƒ½äº†ï¼Œå¦‚æœä½ ä¹‹å‰æœ‰é˜…è¯»è¿‡é›†åˆæ¡†æ¶çš„åŸºçŸ³`Collection`æ¥å£ï¼Œæ˜¯ä¸æ˜¯åœ¨ç»è¿‡å‰é¢çš„å­¦ä¹ ï¼Œä»¥å‰çœ‹ä¸æ‡‚çš„ä¸œè¥¿ï¼Œçªç„¶ä¹‹é—´å°±æç„¶å¤§æ‚Ÿäº†å‘¢ï¼Ÿ\n\nä»Šå¤©æˆ‘ä»¬çš„ä¸»è§’æ˜¯Streamæµé‡Œé¢çš„æ˜ å°„ã€‚ç”±äºä¹‹å‰ï¼Œæ˜ å°„å¹¶æ²¡æœ‰å†æˆ‘ä»¬çš„Demoï¼Œä¾‹å­ä¸­å‡ºç°è¿‡ï¼Œæ‰€ä»¥å¯¹å¤§å®¶æ¥è¯´å¯èƒ½ä¼šç¨å¾®æœ‰ä¸€ç‚¹ç‚¹é™Œç”Ÿçš„ï¼Œä½†é€šè¿‡è¿™ä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ç›¸ä¿¡èƒ½è§£å†³ä½ çš„ç–‘é—®ã€‚\n\nåœ¨æ­£å¼å¼€å§‹ä¹‹å‰ï¼Œæˆ‘å’Œå¤§å®¶ç»§ç»­è¯´è¯´æµAPIæ“ä½œï¼Œä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰æ³¨æ„åˆ°ï¼Œå…¶å®æˆ‘ä»¬æ‰€æœ‰çš„æµAPIæ“ä½œéƒ½æ˜¯é’ˆå¯¹æµä¸­çš„å…ƒç´ è¿›è¡Œçš„ï¼Œå¹¶ä¸”éƒ½æ˜¯åŸºäºåŒä¸€æµé‡Œé¢çš„ï¼Œå¤§å®¶æœ‰æ²¡æœ‰è¿™æ ·çš„ç–‘é—®ï¼Œæ€ä¹ˆæ ·æŠŠä¸€ä¸ªæµçš„å…ƒç´ å¼„åˆ°å¦ä¸€ä¸ªæµé‡Œé¢å‘¢ï¼Ÿæ€ä¹ˆæŠŠæµä¸­çš„ä¸€äº›æ»¡è¶³æ¡ä»¶çš„å…ƒç´ æ”¾åˆ°ä¸€ä¸ªæ–°æµé‡Œé¢å‘¢ï¼Ÿ\n\né€šè¿‡è¿™ä¸€èŠ‚ï¼Œä½ å°†ä¼šæŒæ¡è§£å†³åˆšæ‰é—®é¢˜çš„æœ¬é¢†ã€‚å¦å¤–å†æä¸€ç‚¹ï¼Œå¦‚æœæµæ“ä½œåªæœ‰ä¸­é—´æ“ä½œï¼Œæ²¡æœ‰ç»ˆç«¯æ“ä½œï¼Œé‚£ä¹ˆè¿™äº›ä¸­é—´æ“ä½œæ˜¯ä¸ä¼šæ‰§è¡Œçš„ï¼Œæ¢å¥è¯è¯´ï¼Œåªæœ‰ç»ˆç«¯æ“ä½œæ‰èƒ½è§¦å‘ä¸­é—´æ“ä½œçš„è¿è¡Œã€‚\n\n#### æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦æ˜ å°„ï¼Ÿ\n\nå› ä¸ºåœ¨å¾ˆå¤šæ—¶å€™ï¼Œå°†ä¸€ä¸ªæµçš„å…ƒç´ æ˜ å°„åˆ°å¦ä¸€ä¸ªæµå¯¹æˆ‘ä»¬æ˜¯éå¸¸æœ‰å¸®åŠ©çš„ã€‚æ¯”å¦‚æœ‰ä¸€ä¸ªåŒ…å«æœ‰åå­—ï¼Œæ‰‹æœºå·ç å’Œé’±çš„æ•°æ®åº“æ„æˆçš„æµï¼Œå¯èƒ½ä½ åªæƒ³è¦æ˜ å°„é’±è¿™ä¸ªå­—æ®µåˆ°å¦ä¸€ä¸ªæµï¼Œè¿™æ—¶å€™å¯èƒ½ä¹‹å‰å­¦åˆ°çš„çŸ¥è¯†å°±è¿˜ä¸èƒ½è§£å†³ï¼Œäºæ˜¯æ˜ å°„å°±ç«™äº†å‡ºæ¥äº†ã€‚\n\nå¦å¤–ï¼Œå¦‚æœä½ å¸Œæœ›å¯¹æµä¸­çš„å…ƒç´ åº”ç”¨ä¸€äº›è½¬æ¢ï¼Œç„¶åæŠŠè½¬æ¢çš„å…ƒç´ æ˜ å°„åˆ°ä¸€ä¸ªæ–°æµé‡Œé¢ï¼Œè¿™æ—¶å€™ä¹Ÿå¯ä»¥ç”¨æ˜ å°„ã€‚\n\næˆ‘ä»¬å…ˆæ¥çœ‹çœ‹æµAPIåº“ç»™æˆ‘ä»¬æä¾›äº†ä»€ä¹ˆæ ·çš„æ”¯æŒ\n\n```\npublic interface Stream<T> extends BaseStream<T, Stream<T>> {\n    <R> Stream<R> map(Function<? super T, ? extends R> mapper);//line2\n    IntStream mapToInt(ToIntFunction<? super T> mapper);//line3\n    LongStream mapToLong(ToLongFunction<? super T> mapper);//line4\n    DoubleStream mapToDouble(ToDoubleFunction<? super T> mapper);//line5\n    <R> Stream<R> flatMap(Function<? super T, ? extends Stream<? extends R>> mapper);//line6\n    IntStream flatMapToInt(Function<? super T, ? extends IntStream> mapper);//line7\n    LongStream flatMapToLong(Function<? super T, ? extends LongStream> mapper);//line8\n    DoubleStream flatMapToDouble(Function<? super T, ? extends DoubleStream> mapper);//line9\n}\n```\n\næˆ‘å’Œå¤§å®¶åˆ†æä¸€ä¸ªæœ€å…·æœ‰ä¸€èˆ¬æ€§çš„æ˜ å°„æ–¹æ³•map()ï¼Œç›¸ä¿¡å¤§å®¶å°±èƒ½ä¸¾ä¸€åä¸‰äº†ï¼Œmap()å®šä¹‰å¦‚ä¸‹ï¼Œ\n\n **<R> Stream<R> map(Function<? super T, ? extends R> mapper);**\n\nå…¶ä¸­ï¼ŒRæŒ‡å®šæ–°æµçš„å…ƒç´ ç±»å‹ï¼ŒTæŒ‡å®šè°ƒç”¨æµçš„å…ƒç´ ç±»å‹ï¼Œmapperæ˜¯å®Œæˆæ˜ å°„çš„Functionå®ä¾‹ï¼Œè¢«ç§°ä¸ºæ˜ å°„å‡½æ•°ï¼Œæ˜ å°„å‡½æ•°å¿…é¡»æ˜¯æ— çŠ¶æ€å’Œä¸å¹²é¢„çš„ï¼ˆå¤§å®¶å¯¹è¿™äºŒä¸ªçº¦æŸæ¡ä»¶åº”è¯¥å¾ˆç†Ÿæ‚‰äº†å§ï¼‰ã€‚å› ä¸ºmap()æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªæ–°æµï¼Œå› æ­¤å®ƒæ˜¯ä¸€ä¸ªä¸­é—´æ“ä½œã€‚\n\n`Function`æ˜¯ `java.util.function`åŒ…ä¸­å£°æ˜çš„ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œå£°æ˜å¦‚ä¸‹ï¼š\n\n```\n@FunctionalInterface\npublic interface Function<T, R> {\n     R apply(T t);\n}\n```\nåœ¨map()çš„ä½¿æœ‰è¿‡ç¨‹ä¸­ï¼ŒTæ˜¯è°ƒç”¨æµçš„å…ƒç´ ç±»å‹ï¼ŒRæ˜¯æ˜ å°„çš„ç»“æœç±»å‹ã€‚å…¶ä¸­,apply(T t)ä¸­çš„tæ˜¯å¯¹è¢«æ˜ å°„å¯¹è±¡çš„å¼•ç”¨ï¼Œè¢«è¿”å›æ˜ å°„ç»“æœã€‚ä¸‹é¢æˆ‘ä»¬å°†ä¸Šä¸€ç¯‡ä¸­çš„ä¾‹å­è¿›è¡Œå˜å½¢ï¼Œç”¨æ˜ å°„æ¥å®Œæˆä»–:\n\n`å‡è®¾Listé‡Œé¢æœ‰ä¸‰ä¸ªIntegerç±»å‹çš„å…ƒç´ åˆ†åˆ«ä¸º1ï¼Œ2ï¼Œ3ã€‚ç°åœ¨çš„éœ€æ±‚æ˜¯åˆ†åˆ«è®©Listé‡Œé¢çš„æ¯ä¸ªå…ƒç´ éƒ½æ”¾å¤§ä¸¤å€åï¼Œå†æ±‚ç§¯ã€‚è¿™ä¸ªéœ€æ±‚çš„æ­£ç¡®ç­”æ¡ˆåº”è¯¥æ˜¯48;`\n\n```\nprivate static void learnMap() {\n     List<Integer> lists = new ArrayList<>();\n        lists.add(1);\n        lists.add(2);\n        lists.add(3);\n     //ä½¿ç”¨å¹¶è¡Œæµæ¥å¤„ç†\n     Integer product = lists.parallelStream().reduce(1, (a, b) -> a *  (b * 2),\n                                                        (a, b) -> a * b);\n     System.out.println(\"product:\" + product);//48\n\n     //ä½¿ç”¨æ˜ å°„æ¥å¤„ç† \n     //Integer productMap = lists.parallelStream().map((a) -> a * 2).reduce(1, (a, b) -> a * b);\n     Stream<Integer> productNewMapStream = lists.parallelStream().map((a) -> a * 2);\n     Integer productMap = productNewMapStream.reduce(1, (a, b) -> a * b);\n     System.out.println(\"productMap:\" + productMap);//48\n}\n```\n\nä¸ä½¿ç”¨å¹¶è¡Œæµä¸åŒï¼Œåœ¨ä½¿ç”¨æ˜ å°„å¤„ç†çš„æ—¶å€™ï¼Œå…ƒç´ æ‰©å¤§2å€å‘ç”Ÿæ—¶æœºä¸ä¸€æ ·äº†ï¼Œä½¿ç”¨å¹¶è¡Œæµå…ƒç´ æ‰©å¤§æ˜¯åœ¨ç¼©å‡çš„è¿‡ç¨‹å½“ä¸­çš„ï¼Œè€Œä½¿ç”¨æ˜ å°„å¤„ç†æ—¶ï¼Œå…ƒç´ æ‰©å¤§æ˜¯å‘ç”Ÿåœ¨æ˜ å°„è¿‡ç¨‹ä¸­çš„ã€‚å› æ­¤æ˜ å°„è¿‡ç¨‹å®Œç¨‹ä¹‹åï¼Œä¸éœ€è¦reduce()æä¾›åˆå¹¶å™¨äº†ã€‚\n\nä¸Šé¢çš„è¿™ä¸ªä¾‹å­è¿˜æ˜¯ç®€å•äº†ä¸€ç‚¹ï¼Œä¸‹é¢å†ä¸¾ä¸€ä¸ªä¾‹å­,ç‹è€…è£è€€å›¢é˜Ÿç»æµè®¡ç®—ï¼š\n\n```\n#ç©å®¶ä½¿ç”¨çš„è‹±é›„ä»¥åŠå½“å‰è·å¾—çš„é‡‘å¸æ•°\npublic class HeroPlayerGold {\n    /** ä½¿ç”¨çš„è‹±é›„åå­— */\n    private String hero;\n    /** ç©å®¶çš„ID */\n    private String player;\n    /** è·å¾—çš„é‡‘å¸æ•° */\n    private int gold;\n\n    public HeroPlayerGold(String hero, String player, int gold) {\n        this.hero = hero;\n        this.player = player;\n        this.gold = gold;\n    }\n  //çœç•¥get/set/toString\n}\n\n#ç©å®¶è·å¾—çš„é‡‘å¸æ•°\npublic class Gold {\n    /** è·å¾—çš„é‡‘å¸æ•° */\n    private int gold;\n\n    public Gold(int gold) {\n        this.gold = gold;\n    }\n //çœç•¥get/set/toString\nï½\n\n#æµ‹è¯•ç±»\npublic class Main {\n    public static void main(String[] args) {\n        learnMap2th();\n    }\n\n    private static void learnMap2th() {\n        List<HeroPlayerGold> lists = new ArrayList<>();\n        lists.add(new HeroPlayerGold(\"ç›–ä¼¦\", \"RNG-Letme\", 100));\n        lists.add(new HeroPlayerGold(\"è¯¸è‘›äº®\", \"RNG-Xiaohu\", 300));\n        lists.add(new HeroPlayerGold(\"éœ²å¨œ\", \"RNG-MLXG\", 300));\n        lists.add(new HeroPlayerGold(\"ç‹„ä»æ°\", \"RNG-UZI\", 500));\n        lists.add(new HeroPlayerGold(\"ç‰›å¤´\", \"RNG-Ming\", 500));\n\n        //è®¡ç®—å›¢é˜Ÿç»æµ\n        int teamMoney = lists.stream()\n                .map(player -> new Gold(player.getGold()))//note1\n                .mapToInt(Gold::getGold)\n                .reduce(0, (a, b) -> a + b);\n        System.out.println(\"å›¢é˜Ÿç»æµï¼š\" + teamMoney);//1700\n\n\n        //è®¡ç®—å›¢é˜Ÿç»æµ2\n        double teamMoney2 = lists.stream()\n                .mapToDouble(HeroPlayerGold::getGold)\n                .reduce(0, (a, b) -> a + b);\n        System.out.println(\"å›¢é˜Ÿç»æµï¼š\" + teamMoney2);//1700.0\n    }\n}\n\n```\n\nä»£ç åº”è¯¥ä¸éš¾ç†è§£ï¼Œé€šè¿‡ä»£ç ï¼Œå¤§å®¶åº”è¯¥çŸ¥é“æˆ‘ä»¬å‡è®¾çš„åœºæ™¯äº†ã€‚æˆ‘ä»¬çš„RNGå»å‚åŠ ç‹è€…è£è€€æ¯”èµ›äº†ï¼Œåƒè¿™ç§å›¢é˜Ÿæ¸¸æˆï¼Œè§‚ä¼—åœ¨ç»æµæ–¹é¢å…³æ³¨æ›´å¤šçš„å¯èƒ½æ˜¯å›¢é˜Ÿç»æµï¼Œè€Œä¸æ˜¯ä¸ªäººç»æµã€‚\n\nåœ¨æˆ‘ä»¬`HeroPlayerGold`ç±»é‡Œé¢å­˜æœ‰æ˜æ˜Ÿç©å®¶ï¼Œä½¿ç”¨çš„è‹±é›„ï¼Œå’Œè¿™å±€æ¯”èµ›æŸä¸ªç©å®¶å½“å‰è·å¾—çš„é‡‘å¸æ•°ï¼Œæˆ‘ä»¬å¦æœ‰ä¸€ä¸ªä¸“ä»¬ç®¡ç†é‡‘å¸çš„`Gold`ç±»ï¼Œæˆ‘ä»¬ç¬¬ä¸€ç§è®¡ç®—å›¢é˜Ÿç»æµçš„æ–¹å¼ï¼Œä½¿æŠŠ`HeroPlayerGold`é‡Œé¢çš„`gold`å­—æ®µè½¬æ¢åˆ°`Gold`é‡Œé¢äº†<sup> `//note1` </sup>,è¿™é‡Œäº§ç”Ÿçš„æ–°æµåªåŒ…å«äº†åŸå§‹æµä¸­é€‰å®šçš„`gold`å­—æ®µï¼Œå› ä¸ºæˆ‘ä»¬çš„åŸå§‹æµä¸­åŒ…å«äº†`hero`ã€`player`ã€`gold`,ä¸‰ä¸ªå­—æ®µï¼Œæˆ‘ä»¬åªé€‰å–äº†`gold`å­—æ®µï¼ˆå› ä¸ºæˆ‘ä»¬åªå…³å¿ƒè¿™ä¸ªå­—æ®µï¼‰ï¼Œæ‰€ä»¥å…¶å®ƒçš„ä¸¤ä¸ªå­—æ®µè¢«ä¸¢å¼ƒäº†ã€‚ç„¶åä»æ–°æµå–å‡º`Gold`é‡Œé¢çš„`gold`å­—æ®µå¹¶æŠŠä»–è½¬æˆä¸€ä¸ª`IntStream`ï¼Œç„¶åæˆ‘ä»¬å°±è¦ä»¥é€šè¿‡ç¼©å‡æ“ä½œå®Œæˆæˆ‘ä»¬çš„å›¢é˜Ÿç»æµè®¡ç®—äº†ã€‚\n\nç¬¬ä¸€ç§æ–¹å¼ï¼Œå¤§å®¶éœ€è¦å¥½å¥½ç†è§£ï¼Œç†è§£äº†ï¼Œæˆ‘ç›¸ä¿¡ä½ ä»¬çš„é¡¹ç›®ä¸­ï¼Œå¾ˆå¤šå¾ˆå¤šåœ°æ–¹å¯ä»¥ç”¨å¾—ä¸Šäº†ï¼Œå†ä¹Ÿä¸éœ€è¦åŠ¨ä¸åŠ¨å°±æŸ¥æ•°æ®åº“äº†ï¼Œæ€æ ·æ•ˆç‡é«˜æ€æ ·æ¥ï¼Œåªæ˜¯ä¸€ç§å»ºè®®ã€‚ç¬¬äºŒç§åªæ˜¯å¿«é€Ÿè®¡ç®—å›¢é˜Ÿç»æµè€Œå·²ï¼Œæ²¡ä»€ä¹ˆå€¼å¾—è®²çš„ã€‚\n\næ¥ä¸‹æ¥è®²ä¸€ä¸‹ä»–çš„æ‰©å±•æ–¹å‘ï¼šå¤§å®¶è¿˜è®°å¾—æˆ‘åœ¨ç¬¬äºŒç¯‡ä¸­ä»‹ç»ä¸­é—´æ“ä½œæ¦‚å¿µçš„æ—¶å€™å—ï¼Ÿ`ä¸­é—´æ“ä½œä¼šäº§ç”Ÿå¦ä¸€ä¸ªæµã€‚å› æ­¤ä¸­é—´æ“ä½œå¯ä»¥ç”¨æ¥åˆ›å»ºæ‰§è¡Œä¸€ç³»åˆ—åŠ¨ä½œçš„ç®¡é“ã€‚`æˆ‘ä»¬å¯ä»¥æŠŠå¤šä¸ªä¸­é—´æ“ä½œæ”¾åˆ°ç®¡é“ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾ˆå®¹æ˜“å°±åˆ›å»ºå‡ºå¾ˆå¼ºå¤§çš„ç»„åˆæ“ä½œäº†ï¼Œå‘æŒ¥ä½ çš„æƒ³è±¡ï¼Œæ‰“å‡ºä½ ä»¬çš„ç»„åˆæ‹³;\n\næˆ‘ç°åœ¨ä¸¾ä¸€ä¸ªä¾‹å­ï¼šæ¯”å¦‚ç°åœ¨ç›¸ç»Ÿè®¡å›¢é˜Ÿé‡Œé¢ä¸¤ä¸ªCä½çš„ç»æµå äº†å¤šå°‘ï¼Œä»£ç çœ‹èµ·æ¥å¯èƒ½å°±æ˜¯è¿™æ ·äº†ï¼š\n```\n private static void learnMap2th() {\n        List<HeroPlayerGold> lists = new ArrayList<>();\n        lists.add(new HeroPlayerGold(\"ç›–ä¼¦\", \"RNG-Letme\", 100));\n        lists.add(new HeroPlayerGold(\"è¯¸è‘›äº®\", \"RNG-Xiaohu\", 300));\n        lists.add(new HeroPlayerGold(\"éœ²å¨œ\", \"RNG-MLXG\", 300));\n        lists.add(new HeroPlayerGold(\"ç‹„ä»æ°\", \"RNG-UZI\", 500));\n        lists.add(new HeroPlayerGold(\"ç‰›å¤´\", \"RNG-Ming\", 500));\n        \n        //è®¡ç®—ä¸¤ä¸ªCä½çš„ç»æµå’Œ\n        lists.stream()\n                .filter(player-> \"RNG-Xiaohu\".equals(player.getPlayer()) || \"RNG-UZI\".equals(player.getPlayer()))\n                .map(player->new Gold(player.getGold()))\n                .mapToInt(Gold::getGold)\n                .reduce((a,b)->a+b)\n                .ifPresent(System.out::println);//800\n    }\n```\n\nå¤§å®¶æœ‰æ²¡æœ‰æ„Ÿè§‰ï¼Œè¿™ç§æ“ä½œæ€ä¹ˆå¸¦æœ‰ç‚¹æ•°æ®åº“çš„é£æ ¼å•Šï¼Ÿå…¶å®åœ¨åˆ›å»ºæ•°æ®åº“æŸ¥è¯¢çš„æ—¶å€™ï¼Œè¿™ç§è¿‡æ»¤æ“ä½œååˆ†å¸¸è§ï¼Œå¦‚æœä½ ç»å¸¸åœ¨ä½ çš„é¡¹ç›®ä¸­ä½¿ç”¨æµAPIï¼Œè¿™å‡ ä¸ªæ¡ä»¶ç®—ä»€ä¹ˆ?ç­‰ä½ ä»¬æŠŠæµAPIç”¨ç†Ÿäº†ä¹‹åï¼Œä½ ä»¬å®Œå…¨å¯ä»¥é€šè¿‡è¿™ç§é“¾å¼æ“ä½œåˆ›å»ºå‡ºéå¸¸å¤æ‚çš„æŸ¥è¯¢ï¼Œåˆå¹¶å’Œé€‰æ‹©çš„æ“ä½œã€‚\n\né€šè¿‡å‰é¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å·²ç»æŠŠ`map()`ï¼Œ`mapToInt()`ï¼Œ`mapToLong()`ï¼Œ`mapToDouble`éƒ½è®²äº†ã€‚é‚£ä¹ˆå‰©ä¸‹çš„å°±æ˜¯flatMap()æ–¹æ³•äº†ã€‚æœ¬æ¥æƒ³è®©å¤§å®¶è‡ªè¡Œå»ç†è§£è¿™ä¸ªæ–¹æ³•çš„ï¼Œå› ä¸ºæ€•è¿™ç¯‡æ–‡ç« å†™å¾—å¤ªé•¿äº†ã€‚ä½†æ˜¯åé¢æƒ³æƒ³ï¼Œè¿˜æ˜¯æˆ‘æ¥ç»™å¤§å®¶åˆ†æä¸€ä¸‹å§ã€‚\n\n**<R> Stream<R> flatMap(Function<? super T, ? extends Stream<? extends R>> mapper);**\n\né€šè¿‡å‰é¢çš„å­¦ä¹ æˆ‘ä»¬çŸ¥é“`mapper`æ˜¯ä¸€ä¸ªæ˜ å°„å‡½æ•°ï¼Œå®ƒå’Œmap()æ–¹æ³•ä¹Ÿä¸€æ ·ä¹Ÿä¼šè¿”å›ä¸€ä¸ªæ–°æµï¼Œæˆ‘ä»¬æŠŠè¿”å›çš„æ–°æµç§°ä¸ºæ˜ å°„æµã€‚**æˆ‘ä»¬æä¾›çš„æ˜ å°„å‡½æ•°ä¼šå¤„ç†åŸå§‹æµä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œè€Œæ˜ å°„æµä¸­åŒ…å«äº†æ‰€æœ‰ç»è¿‡æˆ‘ä»¬æ˜ å°„å‡½æ•°å¤„ç†åäº§ç”Ÿçš„æ–°å…ƒç´ ã€‚** åŠ ç²—éƒ¨ä»½éœ€è¦é‡ç‚¹ç†è§£ã€‚\n\næˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æºç å¯¹flatMap()çš„æ³¨é‡Š:\n\n> The  flatMap() operation has the effect of applying a one-to-many  transformation to the elements of the stream, and then flattening the resulting elements into a new stream.\n\nå¤§æ„å°±æ˜¯ï¼š**flatMap()æ“ä½œèƒ½æŠŠåŸå§‹æµä¸­çš„å…ƒç´ è¿›è¡Œä¸€å¯¹å¤šçš„è½¬æ¢ï¼Œå¹¶ä¸”å°†æ–°ç”Ÿæˆçš„å…ƒç´ å…¨éƒ½åˆå¹¶åˆ°å®ƒè¿”å›çš„æµé‡Œé¢ã€‚**æ ¹æ®æˆ‘ä»¬æ‰€å­¦çš„çŸ¥è¯†ï¼Œä»–çš„è¿™ç§ä¸€å¯¹å¤šçš„è½¬æ¢åŠŸèƒ½è‚¯å®šå°±æ˜¯æ˜ å°„å‡½æ•°æä¾›çš„ï¼Œè¿™ä¸€ç‚¹æ²¡æœ‰ç–‘é—®å§ï¼ç„¶åæºç çš„æ³¨é‡Šä¸Šé¢è¿˜æä¾›äº†ä¸€ä¸ªä¾‹å­ï¼Œé€šè¿‡æ³¨é‡ŠåŠ ä¾‹å­ï¼Œæˆ‘ç›¸ä¿¡å¤§å®¶éƒ½èƒ½éå¸¸æ¸…æ¥šåœ°ç†è§£flatMap()äº†ã€‚\n\n```\n    /* <p>If {@code orders} is a stream of purchase orders, and each purchase\n     * order contains a collection of line items, then the following produces a\n     * stream containing all the line items in all the orders:\n     * <pre>{@code\n     *     orders.flatMap(order -> order.getLineItems().stream())...\n     * }</pre>\n     */\n```\n\n**å¦‚æœordersæ˜¯ä¸€æ‰¹é‡‡è´­è®¢å•å¯¹åº”çš„æµï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªé‡‡è´­è®¢å•éƒ½åŒ…å«ä¸€ç³»åˆ—çš„é‡‡è´­é¡¹ï¼Œé‚£ä¹ˆ`orders.flatMap(order -> order.getLineItems().stream())...`ç”Ÿæˆçš„æ–°æµå°†åŒ…å«è¿™ä¸€æ‰¹é‡‡è´­è®¢å•ä¸­æ‰€æœ‰é‡‡è´­é¡¹ã€‚** \n\næˆ‘ä»¬ç”¨ä¼ªä»£ç æ¥å°±æ›´åŠ æ¸…æ™°äº†`Stream<Orders<OrderItem>>`====>Stream<OrderItem>ã€‚å¤§å®¶èƒ½ç†è§£äº†å—ï¼Ÿè¿˜æ²¡ç†è§£ï¼Ÿå†æ¥ä¸€ä¸ªä¾‹å­ï¼š\n\n```\n private static void learnFlatMap() {\n        //(å¹¿å·  æ·±åœ³  ä¸Šæµ·  åŒ—äº¬)çš„å…¨æ‹¼çš„ä¸€äº›ç»„åˆ,ä¸‹é¢æˆ‘ä»¬å°±æŠŠæ¯ä¸€ä¸ªåŸå¸‚éƒ½åˆ’åˆ†ä¸€ä¸‹\n        List<String> citys = Arrays.asList(\"GuangZhou ShangHai\", \"GuangZhou ShenZhen\",\n                \"ShangHai ShenZhen\", \"BeiJing ShangHai\", \"GuangZhou BeiJing\", \"ShenZhen BeiJing\");\n\n        //è¿™é‡Œæ‰“å°çš„æ•°ç»„å¯¹åº”çš„åœ°å€\n        citys.stream().map(mCitys -> Arrays.stream(mCitys.split(\" \"))).forEach(System.out::println);//note1\n\n        System.out.println();\n\n        //æµé‡Œé¢çš„å…ƒç´ è¿˜æ˜¯ä¸€ä¸ªæ•°ç»„\n        citys.stream()\n                .map(mCities -> Arrays.stream(mCities.split(\" \")))//æµé‡Œé¢çš„æ¯ä¸ªå…ƒç´ è¿˜æ˜¯æ•°ç»„\n                .forEach(cities ->cities.forEach(city-> System.out.print(city+\" \")));//note2\n\n        System.out.println();\n        System.out.println();\n\n        //ç›´æ¥ä¸€ä¸ªflatMap()å°±æŠŠæ•°ç»„åˆå¹¶åˆ°æ˜ å°„æµé‡Œé¢äº†\n        citys.stream().flatMap(mCities->Arrays.stream(mCities.split(\" \"))).forEach(System.out::println);//note3\n\n        System.out.println();\n\n        //ä½¿ç”¨distinct()æ–¹æ³•å»é‡ï¼\n        citys.stream().flatMap(mCities->Arrays.stream(mCities.split(\" \"))).distinct().forEach(System.out::println);//note4\n\n    }\n```\n\nå…¶ä¸­<sup> `//note1` </sup>å¤„æ˜¯æ— æ³•æ‰“å°å…ƒç´ çš„ï¼Œä½¿ç”¨map()æ‰“å°å…ƒç´ çš„æ–¹å¼åœ¨<sup> `//note2` </sup>ï¼ŒåŸå› ä¹Ÿåœ¨æ³¨é‡Šä¸­äº¤å¾…äº†ï¼Œä½†æ˜¯ä½¿ç”¨äº†flatMap()æ–¹æ³•åï¼Œç›´æ¥å°±å¯ä»¥æ‰“å°äº†<sup> `//note3` </sup>ï¼Œåˆ°è¿™é‡Œï¼Œåº”è¯¥å°±èƒ½ç†è§£**å¦‚æœordersæ˜¯ä¸€æ‰¹é‡‡è´­è®¢å•å¯¹åº”çš„æµï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªé‡‡è´­è®¢å•éƒ½åŒ…å«ä¸€ç³»åˆ—çš„é‡‡è´­é¡¹ï¼Œé‚£ä¹ˆ`orders.flatMap(order -> order.getLineItems().stream())...`ç”Ÿæˆçš„æ–°æµå°†åŒ…å«è¿™ä¸€æ‰¹é‡‡è´­è®¢å•ä¸­æ‰€æœ‰é‡‡è´­é¡¹ã€‚** äº†å§ã€‚æœ€å<sup> `//note4` </sup>æ˜¯ä¸€ä¸ªå»é‡çš„æ–¹æ³•ï¼Œå¤§å®¶è¿è¡Œä¸€éå§ã€‚\n\n#### å°ç»“ä¸€ä¸‹\n\né€šè¿‡è¿™ä¸€ç¯‡æ–‡ç« ï¼Œç›¸ä¿¡å¤§å®¶å¯¹æµAPIä¸­çš„æ˜ å°„å·²ç»ä¸å†é™Œç”Ÿäº†ï¼Œå…¶å®æœ€éœ€è¦æ³¨æ„çš„ä¸€ä¸ªç‚¹æ˜¯,map()å’ŒflatMap()çš„åŒºåˆ«ï¼Œæˆ‘ä¹Ÿä¸€æ­¥æ­¥åœ°å¸¦ç€å¤§å®¶ç†è§£å’Œåº”ç”¨äº†ã€‚å…¶å®åœ¨æµAPIè¿™ä¸€å—ä¸­ï¼Œå¤§å®¶å•å•æŒæ¡æ¦‚å¿µæ˜¯æ²¡ä»€ä¹ˆç”¨çš„ï¼Œä¸€å®šè¦å»å®æˆ˜äº†ï¼Œä¸€ä¸ªé¡¹ç›®é‡Œé¢ï¼Œé›†åˆæ¡†æ¶è¿™ç§ä¸œè¥¿ç”¨å¾—è¿˜æ˜¯ç‰¹åˆ«å¤šçš„ï¼Œç”¨åˆ°é›†åˆæ¡†æ¶çš„å¤§éƒ¨ä»½æƒ…å†µï¼Œå…¶å®éƒ½å¯ä»¥è€ƒè™‘ä¸€ä¸‹ç”¨Streamæµå»æ“ä½œä¸€ä¸‹ï¼Œä¸ä»…å¢åŠ æ•ˆç‡ï¼Œè¿˜å¯ä»¥å¢åŠ ä¸šåŠ¡æµç¨‹çš„æ¸…æ™°åº¦ã€‚\n","slug":"æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆäº”ï¼‰æ˜ å°„","published":1,"updated":"2025-10-15T07:20:51.385Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu077a006xqkd4ep8vcgtq","content":"<p>ç»è¿‡äº†å‰é¢å››ç¯‡æ–‡ç« çš„å­¦ä¹ ï¼Œç›¸ä¿¡å¤§å®¶å¯¹Streamæµå·²ç»æ˜¯ç›¸å½“çš„ç†Ÿæ‚‰äº†ï¼ŒåŒæ—¶ä¹ŸæŒæ¡äº†ä¸€äº›é«˜çº§åŠŸèƒ½äº†ï¼Œå¦‚æœä½ ä¹‹å‰æœ‰é˜…è¯»è¿‡é›†åˆæ¡†æ¶çš„åŸºçŸ³<code>Collection</code>æ¥å£ï¼Œæ˜¯ä¸æ˜¯åœ¨ç»è¿‡å‰é¢çš„å­¦ä¹ ï¼Œä»¥å‰çœ‹ä¸æ‡‚çš„ä¸œè¥¿ï¼Œçªç„¶ä¹‹é—´å°±æç„¶å¤§æ‚Ÿäº†å‘¢ï¼Ÿ</p>\n<p>ä»Šå¤©æˆ‘ä»¬çš„ä¸»è§’æ˜¯Streamæµé‡Œé¢çš„æ˜ å°„ã€‚ç”±äºä¹‹å‰ï¼Œæ˜ å°„å¹¶æ²¡æœ‰å†æˆ‘ä»¬çš„Demoï¼Œä¾‹å­ä¸­å‡ºç°è¿‡ï¼Œæ‰€ä»¥å¯¹å¤§å®¶æ¥è¯´å¯èƒ½ä¼šç¨å¾®æœ‰ä¸€ç‚¹ç‚¹é™Œç”Ÿçš„ï¼Œä½†é€šè¿‡è¿™ä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ç›¸ä¿¡èƒ½è§£å†³ä½ çš„ç–‘é—®ã€‚</p>\n<p>åœ¨æ­£å¼å¼€å§‹ä¹‹å‰ï¼Œæˆ‘å’Œå¤§å®¶ç»§ç»­è¯´è¯´æµAPIæ“ä½œï¼Œä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰æ³¨æ„åˆ°ï¼Œå…¶å®æˆ‘ä»¬æ‰€æœ‰çš„æµAPIæ“ä½œéƒ½æ˜¯é’ˆå¯¹æµä¸­çš„å…ƒç´ è¿›è¡Œçš„ï¼Œå¹¶ä¸”éƒ½æ˜¯åŸºäºåŒä¸€æµé‡Œé¢çš„ï¼Œå¤§å®¶æœ‰æ²¡æœ‰è¿™æ ·çš„ç–‘é—®ï¼Œæ€ä¹ˆæ ·æŠŠä¸€ä¸ªæµçš„å…ƒç´ å¼„åˆ°å¦ä¸€ä¸ªæµé‡Œé¢å‘¢ï¼Ÿæ€ä¹ˆæŠŠæµä¸­çš„ä¸€äº›æ»¡è¶³æ¡ä»¶çš„å…ƒç´ æ”¾åˆ°ä¸€ä¸ªæ–°æµé‡Œé¢å‘¢ï¼Ÿ</p>\n<p>é€šè¿‡è¿™ä¸€èŠ‚ï¼Œä½ å°†ä¼šæŒæ¡è§£å†³åˆšæ‰é—®é¢˜çš„æœ¬é¢†ã€‚å¦å¤–å†æä¸€ç‚¹ï¼Œå¦‚æœæµæ“ä½œåªæœ‰ä¸­é—´æ“ä½œï¼Œæ²¡æœ‰ç»ˆç«¯æ“ä½œï¼Œé‚£ä¹ˆè¿™äº›ä¸­é—´æ“ä½œæ˜¯ä¸ä¼šæ‰§è¡Œçš„ï¼Œæ¢å¥è¯è¯´ï¼Œåªæœ‰ç»ˆç«¯æ“ä½œæ‰èƒ½è§¦å‘ä¸­é—´æ“ä½œçš„è¿è¡Œã€‚</p>\n<h4 id=\"æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦æ˜ å°„ï¼Ÿ\"><a href=\"#æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦æ˜ å°„ï¼Ÿ\" class=\"headerlink\" title=\"æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦æ˜ å°„ï¼Ÿ\"></a>æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦æ˜ å°„ï¼Ÿ</h4><p>å› ä¸ºåœ¨å¾ˆå¤šæ—¶å€™ï¼Œå°†ä¸€ä¸ªæµçš„å…ƒç´ æ˜ å°„åˆ°å¦ä¸€ä¸ªæµå¯¹æˆ‘ä»¬æ˜¯éå¸¸æœ‰å¸®åŠ©çš„ã€‚æ¯”å¦‚æœ‰ä¸€ä¸ªåŒ…å«æœ‰åå­—ï¼Œæ‰‹æœºå·ç å’Œé’±çš„æ•°æ®åº“æ„æˆçš„æµï¼Œå¯èƒ½ä½ åªæƒ³è¦æ˜ å°„é’±è¿™ä¸ªå­—æ®µåˆ°å¦ä¸€ä¸ªæµï¼Œè¿™æ—¶å€™å¯èƒ½ä¹‹å‰å­¦åˆ°çš„çŸ¥è¯†å°±è¿˜ä¸èƒ½è§£å†³ï¼Œäºæ˜¯æ˜ å°„å°±ç«™äº†å‡ºæ¥äº†ã€‚</p>\n<p>å¦å¤–ï¼Œå¦‚æœä½ å¸Œæœ›å¯¹æµä¸­çš„å…ƒç´ åº”ç”¨ä¸€äº›è½¬æ¢ï¼Œç„¶åæŠŠè½¬æ¢çš„å…ƒç´ æ˜ å°„åˆ°ä¸€ä¸ªæ–°æµé‡Œé¢ï¼Œè¿™æ—¶å€™ä¹Ÿå¯ä»¥ç”¨æ˜ å°„ã€‚</p>\n<p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹æµAPIåº“ç»™æˆ‘ä»¬æä¾›äº†ä»€ä¹ˆæ ·çš„æ”¯æŒ</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public interface Stream&lt;T&gt; extends BaseStream&lt;T, Stream&lt;T&gt;&gt; &#123;\n    &lt;R&gt; Stream&lt;R&gt; map(Function&lt;? super T, ? extends R&gt; mapper);&#x2F;&#x2F;line2\n    IntStream mapToInt(ToIntFunction&lt;? super T&gt; mapper);&#x2F;&#x2F;line3\n    LongStream mapToLong(ToLongFunction&lt;? super T&gt; mapper);&#x2F;&#x2F;line4\n    DoubleStream mapToDouble(ToDoubleFunction&lt;? super T&gt; mapper);&#x2F;&#x2F;line5\n    &lt;R&gt; Stream&lt;R&gt; flatMap(Function&lt;? super T, ? extends Stream&lt;? extends R&gt;&gt; mapper);&#x2F;&#x2F;line6\n    IntStream flatMapToInt(Function&lt;? super T, ? extends IntStream&gt; mapper);&#x2F;&#x2F;line7\n    LongStream flatMapToLong(Function&lt;? super T, ? extends LongStream&gt; mapper);&#x2F;&#x2F;line8\n    DoubleStream flatMapToDouble(Function&lt;? super T, ? extends DoubleStream&gt; mapper);&#x2F;&#x2F;line9\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æˆ‘å’Œå¤§å®¶åˆ†æä¸€ä¸ªæœ€å…·æœ‰ä¸€èˆ¬æ€§çš„æ˜ å°„æ–¹æ³•map()ï¼Œç›¸ä¿¡å¤§å®¶å°±èƒ½ä¸¾ä¸€åä¸‰äº†ï¼Œmap()å®šä¹‰å¦‚ä¸‹ï¼Œ</p>\n<p> <strong><R> Stream<R> map(Function&lt;? super T, ? extends R&gt; mapper);</strong></p>\n<p>å…¶ä¸­ï¼ŒRæŒ‡å®šæ–°æµçš„å…ƒç´ ç±»å‹ï¼ŒTæŒ‡å®šè°ƒç”¨æµçš„å…ƒç´ ç±»å‹ï¼Œmapperæ˜¯å®Œæˆæ˜ å°„çš„Functionå®ä¾‹ï¼Œè¢«ç§°ä¸ºæ˜ å°„å‡½æ•°ï¼Œæ˜ å°„å‡½æ•°å¿…é¡»æ˜¯æ— çŠ¶æ€å’Œä¸å¹²é¢„çš„ï¼ˆå¤§å®¶å¯¹è¿™äºŒä¸ªçº¦æŸæ¡ä»¶åº”è¯¥å¾ˆç†Ÿæ‚‰äº†å§ï¼‰ã€‚å› ä¸ºmap()æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªæ–°æµï¼Œå› æ­¤å®ƒæ˜¯ä¸€ä¸ªä¸­é—´æ“ä½œã€‚</p>\n<p><code>Function</code>æ˜¯ <code>java.util.function</code>åŒ…ä¸­å£°æ˜çš„ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œå£°æ˜å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@FunctionalInterface\npublic interface Function&lt;T, R&gt; &#123;\n     R apply(T t);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<p>åœ¨map()çš„ä½¿æœ‰è¿‡ç¨‹ä¸­ï¼ŒTæ˜¯è°ƒç”¨æµçš„å…ƒç´ ç±»å‹ï¼ŒRæ˜¯æ˜ å°„çš„ç»“æœç±»å‹ã€‚å…¶ä¸­,apply(T t)ä¸­çš„tæ˜¯å¯¹è¢«æ˜ å°„å¯¹è±¡çš„å¼•ç”¨ï¼Œè¢«è¿”å›æ˜ å°„ç»“æœã€‚ä¸‹é¢æˆ‘ä»¬å°†ä¸Šä¸€ç¯‡ä¸­çš„ä¾‹å­è¿›è¡Œå˜å½¢ï¼Œç”¨æ˜ å°„æ¥å®Œæˆä»–:</p>\n<p><code>å‡è®¾Listé‡Œé¢æœ‰ä¸‰ä¸ªIntegerç±»å‹çš„å…ƒç´ åˆ†åˆ«ä¸º1ï¼Œ2ï¼Œ3ã€‚ç°åœ¨çš„éœ€æ±‚æ˜¯åˆ†åˆ«è®©Listé‡Œé¢çš„æ¯ä¸ªå…ƒç´ éƒ½æ”¾å¤§ä¸¤å€åï¼Œå†æ±‚ç§¯ã€‚è¿™ä¸ªéœ€æ±‚çš„æ­£ç¡®ç­”æ¡ˆåº”è¯¥æ˜¯48;</code></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void learnMap() &#123;\n     List&lt;Integer&gt; lists &#x3D; new ArrayList&lt;&gt;();\n        lists.add(1);\n        lists.add(2);\n        lists.add(3);\n     &#x2F;&#x2F;ä½¿ç”¨å¹¶è¡Œæµæ¥å¤„ç†\n     Integer product &#x3D; lists.parallelStream().reduce(1, (a, b) -&gt; a *  (b * 2),\n                                                        (a, b) -&gt; a * b);\n     System.out.println(&quot;product:&quot; + product);&#x2F;&#x2F;48\n\n     &#x2F;&#x2F;ä½¿ç”¨æ˜ å°„æ¥å¤„ç† \n     &#x2F;&#x2F;Integer productMap &#x3D; lists.parallelStream().map((a) -&gt; a * 2).reduce(1, (a, b) -&gt; a * b);\n     Stream&lt;Integer&gt; productNewMapStream &#x3D; lists.parallelStream().map((a) -&gt; a * 2);\n     Integer productMap &#x3D; productNewMapStream.reduce(1, (a, b) -&gt; a * b);\n     System.out.println(&quot;productMap:&quot; + productMap);&#x2F;&#x2F;48\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä¸ä½¿ç”¨å¹¶è¡Œæµä¸åŒï¼Œåœ¨ä½¿ç”¨æ˜ å°„å¤„ç†çš„æ—¶å€™ï¼Œå…ƒç´ æ‰©å¤§2å€å‘ç”Ÿæ—¶æœºä¸ä¸€æ ·äº†ï¼Œä½¿ç”¨å¹¶è¡Œæµå…ƒç´ æ‰©å¤§æ˜¯åœ¨ç¼©å‡çš„è¿‡ç¨‹å½“ä¸­çš„ï¼Œè€Œä½¿ç”¨æ˜ å°„å¤„ç†æ—¶ï¼Œå…ƒç´ æ‰©å¤§æ˜¯å‘ç”Ÿåœ¨æ˜ å°„è¿‡ç¨‹ä¸­çš„ã€‚å› æ­¤æ˜ å°„è¿‡ç¨‹å®Œç¨‹ä¹‹åï¼Œä¸éœ€è¦reduce()æä¾›åˆå¹¶å™¨äº†ã€‚</p>\n<p>ä¸Šé¢çš„è¿™ä¸ªä¾‹å­è¿˜æ˜¯ç®€å•äº†ä¸€ç‚¹ï¼Œä¸‹é¢å†ä¸¾ä¸€ä¸ªä¾‹å­,ç‹è€…è£è€€å›¢é˜Ÿç»æµè®¡ç®—ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">#ç©å®¶ä½¿ç”¨çš„è‹±é›„ä»¥åŠå½“å‰è·å¾—çš„é‡‘å¸æ•°\npublic class HeroPlayerGold &#123;\n    &#x2F;** ä½¿ç”¨çš„è‹±é›„åå­— *&#x2F;\n    private String hero;\n    &#x2F;** ç©å®¶çš„ID *&#x2F;\n    private String player;\n    &#x2F;** è·å¾—çš„é‡‘å¸æ•° *&#x2F;\n    private int gold;\n\n    public HeroPlayerGold(String hero, String player, int gold) &#123;\n        this.hero &#x3D; hero;\n        this.player &#x3D; player;\n        this.gold &#x3D; gold;\n    &#125;\n  &#x2F;&#x2F;çœç•¥get&#x2F;set&#x2F;toString\n&#125;\n\n#ç©å®¶è·å¾—çš„é‡‘å¸æ•°\npublic class Gold &#123;\n    &#x2F;** è·å¾—çš„é‡‘å¸æ•° *&#x2F;\n    private int gold;\n\n    public Gold(int gold) &#123;\n        this.gold &#x3D; gold;\n    &#125;\n &#x2F;&#x2F;çœç•¥get&#x2F;set&#x2F;toString\nï½\n\n#æµ‹è¯•ç±»\npublic class Main &#123;\n    public static void main(String[] args) &#123;\n        learnMap2th();\n    &#125;\n\n    private static void learnMap2th() &#123;\n        List&lt;HeroPlayerGold&gt; lists &#x3D; new ArrayList&lt;&gt;();\n        lists.add(new HeroPlayerGold(&quot;ç›–ä¼¦&quot;, &quot;RNG-Letme&quot;, 100));\n        lists.add(new HeroPlayerGold(&quot;è¯¸è‘›äº®&quot;, &quot;RNG-Xiaohu&quot;, 300));\n        lists.add(new HeroPlayerGold(&quot;éœ²å¨œ&quot;, &quot;RNG-MLXG&quot;, 300));\n        lists.add(new HeroPlayerGold(&quot;ç‹„ä»æ°&quot;, &quot;RNG-UZI&quot;, 500));\n        lists.add(new HeroPlayerGold(&quot;ç‰›å¤´&quot;, &quot;RNG-Ming&quot;, 500));\n\n        &#x2F;&#x2F;è®¡ç®—å›¢é˜Ÿç»æµ\n        int teamMoney &#x3D; lists.stream()\n                .map(player -&gt; new Gold(player.getGold()))&#x2F;&#x2F;note1\n                .mapToInt(Gold::getGold)\n                .reduce(0, (a, b) -&gt; a + b);\n        System.out.println(&quot;å›¢é˜Ÿç»æµï¼š&quot; + teamMoney);&#x2F;&#x2F;1700\n\n\n        &#x2F;&#x2F;è®¡ç®—å›¢é˜Ÿç»æµ2\n        double teamMoney2 &#x3D; lists.stream()\n                .mapToDouble(HeroPlayerGold::getGold)\n                .reduce(0, (a, b) -&gt; a + b);\n        System.out.println(&quot;å›¢é˜Ÿç»æµï¼š&quot; + teamMoney2);&#x2F;&#x2F;1700.0\n    &#125;\n&#125;\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä»£ç åº”è¯¥ä¸éš¾ç†è§£ï¼Œé€šè¿‡ä»£ç ï¼Œå¤§å®¶åº”è¯¥çŸ¥é“æˆ‘ä»¬å‡è®¾çš„åœºæ™¯äº†ã€‚æˆ‘ä»¬çš„RNGå»å‚åŠ ç‹è€…è£è€€æ¯”èµ›äº†ï¼Œåƒè¿™ç§å›¢é˜Ÿæ¸¸æˆï¼Œè§‚ä¼—åœ¨ç»æµæ–¹é¢å…³æ³¨æ›´å¤šçš„å¯èƒ½æ˜¯å›¢é˜Ÿç»æµï¼Œè€Œä¸æ˜¯ä¸ªäººç»æµã€‚</p>\n<p>åœ¨æˆ‘ä»¬<code>HeroPlayerGold</code>ç±»é‡Œé¢å­˜æœ‰æ˜æ˜Ÿç©å®¶ï¼Œä½¿ç”¨çš„è‹±é›„ï¼Œå’Œè¿™å±€æ¯”èµ›æŸä¸ªç©å®¶å½“å‰è·å¾—çš„é‡‘å¸æ•°ï¼Œæˆ‘ä»¬å¦æœ‰ä¸€ä¸ªä¸“ä»¬ç®¡ç†é‡‘å¸çš„<code>Gold</code>ç±»ï¼Œæˆ‘ä»¬ç¬¬ä¸€ç§è®¡ç®—å›¢é˜Ÿç»æµçš„æ–¹å¼ï¼Œä½¿æŠŠ<code>HeroPlayerGold</code>é‡Œé¢çš„<code>gold</code>å­—æ®µè½¬æ¢åˆ°<code>Gold</code>é‡Œé¢äº†<sup> <code>//note1</code> </sup>,è¿™é‡Œäº§ç”Ÿçš„æ–°æµåªåŒ…å«äº†åŸå§‹æµä¸­é€‰å®šçš„<code>gold</code>å­—æ®µï¼Œå› ä¸ºæˆ‘ä»¬çš„åŸå§‹æµä¸­åŒ…å«äº†<code>hero</code>ã€<code>player</code>ã€<code>gold</code>,ä¸‰ä¸ªå­—æ®µï¼Œæˆ‘ä»¬åªé€‰å–äº†<code>gold</code>å­—æ®µï¼ˆå› ä¸ºæˆ‘ä»¬åªå…³å¿ƒè¿™ä¸ªå­—æ®µï¼‰ï¼Œæ‰€ä»¥å…¶å®ƒçš„ä¸¤ä¸ªå­—æ®µè¢«ä¸¢å¼ƒäº†ã€‚ç„¶åä»æ–°æµå–å‡º<code>Gold</code>é‡Œé¢çš„<code>gold</code>å­—æ®µå¹¶æŠŠä»–è½¬æˆä¸€ä¸ª<code>IntStream</code>ï¼Œç„¶åæˆ‘ä»¬å°±è¦ä»¥é€šè¿‡ç¼©å‡æ“ä½œå®Œæˆæˆ‘ä»¬çš„å›¢é˜Ÿç»æµè®¡ç®—äº†ã€‚</p>\n<p>ç¬¬ä¸€ç§æ–¹å¼ï¼Œå¤§å®¶éœ€è¦å¥½å¥½ç†è§£ï¼Œç†è§£äº†ï¼Œæˆ‘ç›¸ä¿¡ä½ ä»¬çš„é¡¹ç›®ä¸­ï¼Œå¾ˆå¤šå¾ˆå¤šåœ°æ–¹å¯ä»¥ç”¨å¾—ä¸Šäº†ï¼Œå†ä¹Ÿä¸éœ€è¦åŠ¨ä¸åŠ¨å°±æŸ¥æ•°æ®åº“äº†ï¼Œæ€æ ·æ•ˆç‡é«˜æ€æ ·æ¥ï¼Œåªæ˜¯ä¸€ç§å»ºè®®ã€‚ç¬¬äºŒç§åªæ˜¯å¿«é€Ÿè®¡ç®—å›¢é˜Ÿç»æµè€Œå·²ï¼Œæ²¡ä»€ä¹ˆå€¼å¾—è®²çš„ã€‚</p>\n<p>æ¥ä¸‹æ¥è®²ä¸€ä¸‹ä»–çš„æ‰©å±•æ–¹å‘ï¼šå¤§å®¶è¿˜è®°å¾—æˆ‘åœ¨ç¬¬äºŒç¯‡ä¸­ä»‹ç»ä¸­é—´æ“ä½œæ¦‚å¿µçš„æ—¶å€™å—ï¼Ÿ<code>ä¸­é—´æ“ä½œä¼šäº§ç”Ÿå¦ä¸€ä¸ªæµã€‚å› æ­¤ä¸­é—´æ“ä½œå¯ä»¥ç”¨æ¥åˆ›å»ºæ‰§è¡Œä¸€ç³»åˆ—åŠ¨ä½œçš„ç®¡é“ã€‚</code>æˆ‘ä»¬å¯ä»¥æŠŠå¤šä¸ªä¸­é—´æ“ä½œæ”¾åˆ°ç®¡é“ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾ˆå®¹æ˜“å°±åˆ›å»ºå‡ºå¾ˆå¼ºå¤§çš„ç»„åˆæ“ä½œäº†ï¼Œå‘æŒ¥ä½ çš„æƒ³è±¡ï¼Œæ‰“å‡ºä½ ä»¬çš„ç»„åˆæ‹³;</p>\n<p>æˆ‘ç°åœ¨ä¸¾ä¸€ä¸ªä¾‹å­ï¼šæ¯”å¦‚ç°åœ¨ç›¸ç»Ÿè®¡å›¢é˜Ÿé‡Œé¢ä¸¤ä¸ªCä½çš„ç»æµå äº†å¤šå°‘ï¼Œä»£ç çœ‹èµ·æ¥å¯èƒ½å°±æ˜¯è¿™æ ·äº†ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void learnMap2th() &#123;\n       List&lt;HeroPlayerGold&gt; lists &#x3D; new ArrayList&lt;&gt;();\n       lists.add(new HeroPlayerGold(&quot;ç›–ä¼¦&quot;, &quot;RNG-Letme&quot;, 100));\n       lists.add(new HeroPlayerGold(&quot;è¯¸è‘›äº®&quot;, &quot;RNG-Xiaohu&quot;, 300));\n       lists.add(new HeroPlayerGold(&quot;éœ²å¨œ&quot;, &quot;RNG-MLXG&quot;, 300));\n       lists.add(new HeroPlayerGold(&quot;ç‹„ä»æ°&quot;, &quot;RNG-UZI&quot;, 500));\n       lists.add(new HeroPlayerGold(&quot;ç‰›å¤´&quot;, &quot;RNG-Ming&quot;, 500));\n       \n       &#x2F;&#x2F;è®¡ç®—ä¸¤ä¸ªCä½çš„ç»æµå’Œ\n       lists.stream()\n               .filter(player-&gt; &quot;RNG-Xiaohu&quot;.equals(player.getPlayer()) || &quot;RNG-UZI&quot;.equals(player.getPlayer()))\n               .map(player-&gt;new Gold(player.getGold()))\n               .mapToInt(Gold::getGold)\n               .reduce((a,b)-&gt;a+b)\n               .ifPresent(System.out::println);&#x2F;&#x2F;800\n   &#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¤§å®¶æœ‰æ²¡æœ‰æ„Ÿè§‰ï¼Œè¿™ç§æ“ä½œæ€ä¹ˆå¸¦æœ‰ç‚¹æ•°æ®åº“çš„é£æ ¼å•Šï¼Ÿå…¶å®åœ¨åˆ›å»ºæ•°æ®åº“æŸ¥è¯¢çš„æ—¶å€™ï¼Œè¿™ç§è¿‡æ»¤æ“ä½œååˆ†å¸¸è§ï¼Œå¦‚æœä½ ç»å¸¸åœ¨ä½ çš„é¡¹ç›®ä¸­ä½¿ç”¨æµAPIï¼Œè¿™å‡ ä¸ªæ¡ä»¶ç®—ä»€ä¹ˆ?ç­‰ä½ ä»¬æŠŠæµAPIç”¨ç†Ÿäº†ä¹‹åï¼Œä½ ä»¬å®Œå…¨å¯ä»¥é€šè¿‡è¿™ç§é“¾å¼æ“ä½œåˆ›å»ºå‡ºéå¸¸å¤æ‚çš„æŸ¥è¯¢ï¼Œåˆå¹¶å’Œé€‰æ‹©çš„æ“ä½œã€‚</p>\n<p>é€šè¿‡å‰é¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å·²ç»æŠŠ<code>map()</code>ï¼Œ<code>mapToInt()</code>ï¼Œ<code>mapToLong()</code>ï¼Œ<code>mapToDouble</code>éƒ½è®²äº†ã€‚é‚£ä¹ˆå‰©ä¸‹çš„å°±æ˜¯flatMap()æ–¹æ³•äº†ã€‚æœ¬æ¥æƒ³è®©å¤§å®¶è‡ªè¡Œå»ç†è§£è¿™ä¸ªæ–¹æ³•çš„ï¼Œå› ä¸ºæ€•è¿™ç¯‡æ–‡ç« å†™å¾—å¤ªé•¿äº†ã€‚ä½†æ˜¯åé¢æƒ³æƒ³ï¼Œè¿˜æ˜¯æˆ‘æ¥ç»™å¤§å®¶åˆ†æä¸€ä¸‹å§ã€‚</p>\n<p><strong><R> Stream<R> flatMap(Function&lt;? super T, ? extends Stream&lt;? extends R&gt;&gt; mapper);</strong></p>\n<p>é€šè¿‡å‰é¢çš„å­¦ä¹ æˆ‘ä»¬çŸ¥é“<code>mapper</code>æ˜¯ä¸€ä¸ªæ˜ å°„å‡½æ•°ï¼Œå®ƒå’Œmap()æ–¹æ³•ä¹Ÿä¸€æ ·ä¹Ÿä¼šè¿”å›ä¸€ä¸ªæ–°æµï¼Œæˆ‘ä»¬æŠŠè¿”å›çš„æ–°æµç§°ä¸ºæ˜ å°„æµã€‚<strong>æˆ‘ä»¬æä¾›çš„æ˜ å°„å‡½æ•°ä¼šå¤„ç†åŸå§‹æµä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œè€Œæ˜ å°„æµä¸­åŒ…å«äº†æ‰€æœ‰ç»è¿‡æˆ‘ä»¬æ˜ å°„å‡½æ•°å¤„ç†åäº§ç”Ÿçš„æ–°å…ƒç´ ã€‚</strong> åŠ ç²—éƒ¨ä»½éœ€è¦é‡ç‚¹ç†è§£ã€‚</p>\n<p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æºç å¯¹flatMap()çš„æ³¨é‡Š:</p>\n<blockquote>\n<p>The  flatMap() operation has the effect of applying a one-to-many  transformation to the elements of the stream, and then flattening the resulting elements into a new stream.</p>\n</blockquote>\n<p>å¤§æ„å°±æ˜¯ï¼š<strong>flatMap()æ“ä½œèƒ½æŠŠåŸå§‹æµä¸­çš„å…ƒç´ è¿›è¡Œä¸€å¯¹å¤šçš„è½¬æ¢ï¼Œå¹¶ä¸”å°†æ–°ç”Ÿæˆçš„å…ƒç´ å…¨éƒ½åˆå¹¶åˆ°å®ƒè¿”å›çš„æµé‡Œé¢ã€‚</strong>æ ¹æ®æˆ‘ä»¬æ‰€å­¦çš„çŸ¥è¯†ï¼Œä»–çš„è¿™ç§ä¸€å¯¹å¤šçš„è½¬æ¢åŠŸèƒ½è‚¯å®šå°±æ˜¯æ˜ å°„å‡½æ•°æä¾›çš„ï¼Œè¿™ä¸€ç‚¹æ²¡æœ‰ç–‘é—®å§ï¼ç„¶åæºç çš„æ³¨é‡Šä¸Šé¢è¿˜æä¾›äº†ä¸€ä¸ªä¾‹å­ï¼Œé€šè¿‡æ³¨é‡ŠåŠ ä¾‹å­ï¼Œæˆ‘ç›¸ä¿¡å¤§å®¶éƒ½èƒ½éå¸¸æ¸…æ¥šåœ°ç†è§£flatMap()äº†ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;* &lt;p&gt;If &#123;@code orders&#125; is a stream of purchase orders, and each purchase\n * order contains a collection of line items, then the following produces a\n * stream containing all the line items in all the orders:\n * &lt;pre&gt;&#123;@code\n *     orders.flatMap(order -&gt; order.getLineItems().stream())...\n * &#125;&lt;&#x2F;pre&gt;\n *&#x2F;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>å¦‚æœordersæ˜¯ä¸€æ‰¹é‡‡è´­è®¢å•å¯¹åº”çš„æµï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªé‡‡è´­è®¢å•éƒ½åŒ…å«ä¸€ç³»åˆ—çš„é‡‡è´­é¡¹ï¼Œé‚£ä¹ˆ<code>orders.flatMap(order -&gt; order.getLineItems().stream())...</code>ç”Ÿæˆçš„æ–°æµå°†åŒ…å«è¿™ä¸€æ‰¹é‡‡è´­è®¢å•ä¸­æ‰€æœ‰é‡‡è´­é¡¹ã€‚</strong> </p>\n<p>æˆ‘ä»¬ç”¨ä¼ªä»£ç æ¥å°±æ›´åŠ æ¸…æ™°äº†<code>Stream&lt;Orders&lt;OrderItem&gt;&gt;</code>&#x3D;&#x3D;&#x3D;&#x3D;&gt;Stream<OrderItem>ã€‚å¤§å®¶èƒ½ç†è§£äº†å—ï¼Ÿè¿˜æ²¡ç†è§£ï¼Ÿå†æ¥ä¸€ä¸ªä¾‹å­ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void learnFlatMap() &#123;\n       &#x2F;&#x2F;(å¹¿å·  æ·±åœ³  ä¸Šæµ·  åŒ—äº¬)çš„å…¨æ‹¼çš„ä¸€äº›ç»„åˆ,ä¸‹é¢æˆ‘ä»¬å°±æŠŠæ¯ä¸€ä¸ªåŸå¸‚éƒ½åˆ’åˆ†ä¸€ä¸‹\n       List&lt;String&gt; citys &#x3D; Arrays.asList(&quot;GuangZhou ShangHai&quot;, &quot;GuangZhou ShenZhen&quot;,\n               &quot;ShangHai ShenZhen&quot;, &quot;BeiJing ShangHai&quot;, &quot;GuangZhou BeiJing&quot;, &quot;ShenZhen BeiJing&quot;);\n\n       &#x2F;&#x2F;è¿™é‡Œæ‰“å°çš„æ•°ç»„å¯¹åº”çš„åœ°å€\n       citys.stream().map(mCitys -&gt; Arrays.stream(mCitys.split(&quot; &quot;))).forEach(System.out::println);&#x2F;&#x2F;note1\n\n       System.out.println();\n\n       &#x2F;&#x2F;æµé‡Œé¢çš„å…ƒç´ è¿˜æ˜¯ä¸€ä¸ªæ•°ç»„\n       citys.stream()\n               .map(mCities -&gt; Arrays.stream(mCities.split(&quot; &quot;)))&#x2F;&#x2F;æµé‡Œé¢çš„æ¯ä¸ªå…ƒç´ è¿˜æ˜¯æ•°ç»„\n               .forEach(cities -&gt;cities.forEach(city-&gt; System.out.print(city+&quot; &quot;)));&#x2F;&#x2F;note2\n\n       System.out.println();\n       System.out.println();\n\n       &#x2F;&#x2F;ç›´æ¥ä¸€ä¸ªflatMap()å°±æŠŠæ•°ç»„åˆå¹¶åˆ°æ˜ å°„æµé‡Œé¢äº†\n       citys.stream().flatMap(mCities-&gt;Arrays.stream(mCities.split(&quot; &quot;))).forEach(System.out::println);&#x2F;&#x2F;note3\n\n       System.out.println();\n\n       &#x2F;&#x2F;ä½¿ç”¨distinct()æ–¹æ³•å»é‡ï¼\n       citys.stream().flatMap(mCities-&gt;Arrays.stream(mCities.split(&quot; &quot;))).distinct().forEach(System.out::println);&#x2F;&#x2F;note4\n\n   &#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å…¶ä¸­<sup> <code>//note1</code> </sup>å¤„æ˜¯æ— æ³•æ‰“å°å…ƒç´ çš„ï¼Œä½¿ç”¨map()æ‰“å°å…ƒç´ çš„æ–¹å¼åœ¨<sup> <code>//note2</code> </sup>ï¼ŒåŸå› ä¹Ÿåœ¨æ³¨é‡Šä¸­äº¤å¾…äº†ï¼Œä½†æ˜¯ä½¿ç”¨äº†flatMap()æ–¹æ³•åï¼Œç›´æ¥å°±å¯ä»¥æ‰“å°äº†<sup> <code>//note3</code> </sup>ï¼Œåˆ°è¿™é‡Œï¼Œåº”è¯¥å°±èƒ½ç†è§£<strong>å¦‚æœordersæ˜¯ä¸€æ‰¹é‡‡è´­è®¢å•å¯¹åº”çš„æµï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªé‡‡è´­è®¢å•éƒ½åŒ…å«ä¸€ç³»åˆ—çš„é‡‡è´­é¡¹ï¼Œé‚£ä¹ˆ<code>orders.flatMap(order -&gt; order.getLineItems().stream())...</code>ç”Ÿæˆçš„æ–°æµå°†åŒ…å«è¿™ä¸€æ‰¹é‡‡è´­è®¢å•ä¸­æ‰€æœ‰é‡‡è´­é¡¹ã€‚</strong> äº†å§ã€‚æœ€å<sup> <code>//note4</code> </sup>æ˜¯ä¸€ä¸ªå»é‡çš„æ–¹æ³•ï¼Œå¤§å®¶è¿è¡Œä¸€éå§ã€‚</p>\n<h4 id=\"å°ç»“ä¸€ä¸‹\"><a href=\"#å°ç»“ä¸€ä¸‹\" class=\"headerlink\" title=\"å°ç»“ä¸€ä¸‹\"></a>å°ç»“ä¸€ä¸‹</h4><p>é€šè¿‡è¿™ä¸€ç¯‡æ–‡ç« ï¼Œç›¸ä¿¡å¤§å®¶å¯¹æµAPIä¸­çš„æ˜ å°„å·²ç»ä¸å†é™Œç”Ÿäº†ï¼Œå…¶å®æœ€éœ€è¦æ³¨æ„çš„ä¸€ä¸ªç‚¹æ˜¯,map()å’ŒflatMap()çš„åŒºåˆ«ï¼Œæˆ‘ä¹Ÿä¸€æ­¥æ­¥åœ°å¸¦ç€å¤§å®¶ç†è§£å’Œåº”ç”¨äº†ã€‚å…¶å®åœ¨æµAPIè¿™ä¸€å—ä¸­ï¼Œå¤§å®¶å•å•æŒæ¡æ¦‚å¿µæ˜¯æ²¡ä»€ä¹ˆç”¨çš„ï¼Œä¸€å®šè¦å»å®æˆ˜äº†ï¼Œä¸€ä¸ªé¡¹ç›®é‡Œé¢ï¼Œé›†åˆæ¡†æ¶è¿™ç§ä¸œè¥¿ç”¨å¾—è¿˜æ˜¯ç‰¹åˆ«å¤šçš„ï¼Œç”¨åˆ°é›†åˆæ¡†æ¶çš„å¤§éƒ¨ä»½æƒ…å†µï¼Œå…¶å®éƒ½å¯ä»¥è€ƒè™‘ä¸€ä¸‹ç”¨Streamæµå»æ“ä½œä¸€ä¸‹ï¼Œä¸ä»…å¢åŠ æ•ˆç‡ï¼Œè¿˜å¯ä»¥å¢åŠ ä¸šåŠ¡æµç¨‹çš„æ¸…æ™°åº¦ã€‚</p>\n","excerpt":"","more":"<p>ç»è¿‡äº†å‰é¢å››ç¯‡æ–‡ç« çš„å­¦ä¹ ï¼Œç›¸ä¿¡å¤§å®¶å¯¹Streamæµå·²ç»æ˜¯ç›¸å½“çš„ç†Ÿæ‚‰äº†ï¼ŒåŒæ—¶ä¹ŸæŒæ¡äº†ä¸€äº›é«˜çº§åŠŸèƒ½äº†ï¼Œå¦‚æœä½ ä¹‹å‰æœ‰é˜…è¯»è¿‡é›†åˆæ¡†æ¶çš„åŸºçŸ³<code>Collection</code>æ¥å£ï¼Œæ˜¯ä¸æ˜¯åœ¨ç»è¿‡å‰é¢çš„å­¦ä¹ ï¼Œä»¥å‰çœ‹ä¸æ‡‚çš„ä¸œè¥¿ï¼Œçªç„¶ä¹‹é—´å°±æç„¶å¤§æ‚Ÿäº†å‘¢ï¼Ÿ</p>\n<p>ä»Šå¤©æˆ‘ä»¬çš„ä¸»è§’æ˜¯Streamæµé‡Œé¢çš„æ˜ å°„ã€‚ç”±äºä¹‹å‰ï¼Œæ˜ å°„å¹¶æ²¡æœ‰å†æˆ‘ä»¬çš„Demoï¼Œä¾‹å­ä¸­å‡ºç°è¿‡ï¼Œæ‰€ä»¥å¯¹å¤§å®¶æ¥è¯´å¯èƒ½ä¼šç¨å¾®æœ‰ä¸€ç‚¹ç‚¹é™Œç”Ÿçš„ï¼Œä½†é€šè¿‡è¿™ä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ç›¸ä¿¡èƒ½è§£å†³ä½ çš„ç–‘é—®ã€‚</p>\n<p>åœ¨æ­£å¼å¼€å§‹ä¹‹å‰ï¼Œæˆ‘å’Œå¤§å®¶ç»§ç»­è¯´è¯´æµAPIæ“ä½œï¼Œä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰æ³¨æ„åˆ°ï¼Œå…¶å®æˆ‘ä»¬æ‰€æœ‰çš„æµAPIæ“ä½œéƒ½æ˜¯é’ˆå¯¹æµä¸­çš„å…ƒç´ è¿›è¡Œçš„ï¼Œå¹¶ä¸”éƒ½æ˜¯åŸºäºåŒä¸€æµé‡Œé¢çš„ï¼Œå¤§å®¶æœ‰æ²¡æœ‰è¿™æ ·çš„ç–‘é—®ï¼Œæ€ä¹ˆæ ·æŠŠä¸€ä¸ªæµçš„å…ƒç´ å¼„åˆ°å¦ä¸€ä¸ªæµé‡Œé¢å‘¢ï¼Ÿæ€ä¹ˆæŠŠæµä¸­çš„ä¸€äº›æ»¡è¶³æ¡ä»¶çš„å…ƒç´ æ”¾åˆ°ä¸€ä¸ªæ–°æµé‡Œé¢å‘¢ï¼Ÿ</p>\n<p>é€šè¿‡è¿™ä¸€èŠ‚ï¼Œä½ å°†ä¼šæŒæ¡è§£å†³åˆšæ‰é—®é¢˜çš„æœ¬é¢†ã€‚å¦å¤–å†æä¸€ç‚¹ï¼Œå¦‚æœæµæ“ä½œåªæœ‰ä¸­é—´æ“ä½œï¼Œæ²¡æœ‰ç»ˆç«¯æ“ä½œï¼Œé‚£ä¹ˆè¿™äº›ä¸­é—´æ“ä½œæ˜¯ä¸ä¼šæ‰§è¡Œçš„ï¼Œæ¢å¥è¯è¯´ï¼Œåªæœ‰ç»ˆç«¯æ“ä½œæ‰èƒ½è§¦å‘ä¸­é—´æ“ä½œçš„è¿è¡Œã€‚</p>\n<h4 id=\"æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦æ˜ å°„ï¼Ÿ\"><a href=\"#æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦æ˜ å°„ï¼Ÿ\" class=\"headerlink\" title=\"æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦æ˜ å°„ï¼Ÿ\"></a>æˆ‘ä»¬ä¸ºä»€ä¹ˆéœ€è¦æ˜ å°„ï¼Ÿ</h4><p>å› ä¸ºåœ¨å¾ˆå¤šæ—¶å€™ï¼Œå°†ä¸€ä¸ªæµçš„å…ƒç´ æ˜ å°„åˆ°å¦ä¸€ä¸ªæµå¯¹æˆ‘ä»¬æ˜¯éå¸¸æœ‰å¸®åŠ©çš„ã€‚æ¯”å¦‚æœ‰ä¸€ä¸ªåŒ…å«æœ‰åå­—ï¼Œæ‰‹æœºå·ç å’Œé’±çš„æ•°æ®åº“æ„æˆçš„æµï¼Œå¯èƒ½ä½ åªæƒ³è¦æ˜ å°„é’±è¿™ä¸ªå­—æ®µåˆ°å¦ä¸€ä¸ªæµï¼Œè¿™æ—¶å€™å¯èƒ½ä¹‹å‰å­¦åˆ°çš„çŸ¥è¯†å°±è¿˜ä¸èƒ½è§£å†³ï¼Œäºæ˜¯æ˜ å°„å°±ç«™äº†å‡ºæ¥äº†ã€‚</p>\n<p>å¦å¤–ï¼Œå¦‚æœä½ å¸Œæœ›å¯¹æµä¸­çš„å…ƒç´ åº”ç”¨ä¸€äº›è½¬æ¢ï¼Œç„¶åæŠŠè½¬æ¢çš„å…ƒç´ æ˜ å°„åˆ°ä¸€ä¸ªæ–°æµé‡Œé¢ï¼Œè¿™æ—¶å€™ä¹Ÿå¯ä»¥ç”¨æ˜ å°„ã€‚</p>\n<p>æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹æµAPIåº“ç»™æˆ‘ä»¬æä¾›äº†ä»€ä¹ˆæ ·çš„æ”¯æŒ</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public interface Stream&lt;T&gt; extends BaseStream&lt;T, Stream&lt;T&gt;&gt; &#123;\n    &lt;R&gt; Stream&lt;R&gt; map(Function&lt;? super T, ? extends R&gt; mapper);&#x2F;&#x2F;line2\n    IntStream mapToInt(ToIntFunction&lt;? super T&gt; mapper);&#x2F;&#x2F;line3\n    LongStream mapToLong(ToLongFunction&lt;? super T&gt; mapper);&#x2F;&#x2F;line4\n    DoubleStream mapToDouble(ToDoubleFunction&lt;? super T&gt; mapper);&#x2F;&#x2F;line5\n    &lt;R&gt; Stream&lt;R&gt; flatMap(Function&lt;? super T, ? extends Stream&lt;? extends R&gt;&gt; mapper);&#x2F;&#x2F;line6\n    IntStream flatMapToInt(Function&lt;? super T, ? extends IntStream&gt; mapper);&#x2F;&#x2F;line7\n    LongStream flatMapToLong(Function&lt;? super T, ? extends LongStream&gt; mapper);&#x2F;&#x2F;line8\n    DoubleStream flatMapToDouble(Function&lt;? super T, ? extends DoubleStream&gt; mapper);&#x2F;&#x2F;line9\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æˆ‘å’Œå¤§å®¶åˆ†æä¸€ä¸ªæœ€å…·æœ‰ä¸€èˆ¬æ€§çš„æ˜ å°„æ–¹æ³•map()ï¼Œç›¸ä¿¡å¤§å®¶å°±èƒ½ä¸¾ä¸€åä¸‰äº†ï¼Œmap()å®šä¹‰å¦‚ä¸‹ï¼Œ</p>\n<p> <strong><R> Stream<R> map(Function&lt;? super T, ? extends R&gt; mapper);</strong></p>\n<p>å…¶ä¸­ï¼ŒRæŒ‡å®šæ–°æµçš„å…ƒç´ ç±»å‹ï¼ŒTæŒ‡å®šè°ƒç”¨æµçš„å…ƒç´ ç±»å‹ï¼Œmapperæ˜¯å®Œæˆæ˜ å°„çš„Functionå®ä¾‹ï¼Œè¢«ç§°ä¸ºæ˜ å°„å‡½æ•°ï¼Œæ˜ å°„å‡½æ•°å¿…é¡»æ˜¯æ— çŠ¶æ€å’Œä¸å¹²é¢„çš„ï¼ˆå¤§å®¶å¯¹è¿™äºŒä¸ªçº¦æŸæ¡ä»¶åº”è¯¥å¾ˆç†Ÿæ‚‰äº†å§ï¼‰ã€‚å› ä¸ºmap()æ–¹æ³•ä¼šè¿”å›ä¸€ä¸ªæ–°æµï¼Œå› æ­¤å®ƒæ˜¯ä¸€ä¸ªä¸­é—´æ“ä½œã€‚</p>\n<p><code>Function</code>æ˜¯ <code>java.util.function</code>åŒ…ä¸­å£°æ˜çš„ä¸€ä¸ªå‡½æ•°å¼æ¥å£ï¼Œå£°æ˜å¦‚ä¸‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">@FunctionalInterface\npublic interface Function&lt;T, R&gt; &#123;\n     R apply(T t);\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span></span></code></pre>\n<p>åœ¨map()çš„ä½¿æœ‰è¿‡ç¨‹ä¸­ï¼ŒTæ˜¯è°ƒç”¨æµçš„å…ƒç´ ç±»å‹ï¼ŒRæ˜¯æ˜ å°„çš„ç»“æœç±»å‹ã€‚å…¶ä¸­,apply(T t)ä¸­çš„tæ˜¯å¯¹è¢«æ˜ å°„å¯¹è±¡çš„å¼•ç”¨ï¼Œè¢«è¿”å›æ˜ å°„ç»“æœã€‚ä¸‹é¢æˆ‘ä»¬å°†ä¸Šä¸€ç¯‡ä¸­çš„ä¾‹å­è¿›è¡Œå˜å½¢ï¼Œç”¨æ˜ å°„æ¥å®Œæˆä»–:</p>\n<p><code>å‡è®¾Listé‡Œé¢æœ‰ä¸‰ä¸ªIntegerç±»å‹çš„å…ƒç´ åˆ†åˆ«ä¸º1ï¼Œ2ï¼Œ3ã€‚ç°åœ¨çš„éœ€æ±‚æ˜¯åˆ†åˆ«è®©Listé‡Œé¢çš„æ¯ä¸ªå…ƒç´ éƒ½æ”¾å¤§ä¸¤å€åï¼Œå†æ±‚ç§¯ã€‚è¿™ä¸ªéœ€æ±‚çš„æ­£ç¡®ç­”æ¡ˆåº”è¯¥æ˜¯48;</code></p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void learnMap() &#123;\n     List&lt;Integer&gt; lists &#x3D; new ArrayList&lt;&gt;();\n        lists.add(1);\n        lists.add(2);\n        lists.add(3);\n     &#x2F;&#x2F;ä½¿ç”¨å¹¶è¡Œæµæ¥å¤„ç†\n     Integer product &#x3D; lists.parallelStream().reduce(1, (a, b) -&gt; a *  (b * 2),\n                                                        (a, b) -&gt; a * b);\n     System.out.println(&quot;product:&quot; + product);&#x2F;&#x2F;48\n\n     &#x2F;&#x2F;ä½¿ç”¨æ˜ å°„æ¥å¤„ç† \n     &#x2F;&#x2F;Integer productMap &#x3D; lists.parallelStream().map((a) -&gt; a * 2).reduce(1, (a, b) -&gt; a * b);\n     Stream&lt;Integer&gt; productNewMapStream &#x3D; lists.parallelStream().map((a) -&gt; a * 2);\n     Integer productMap &#x3D; productNewMapStream.reduce(1, (a, b) -&gt; a * b);\n     System.out.println(&quot;productMap:&quot; + productMap);&#x2F;&#x2F;48\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä¸ä½¿ç”¨å¹¶è¡Œæµä¸åŒï¼Œåœ¨ä½¿ç”¨æ˜ å°„å¤„ç†çš„æ—¶å€™ï¼Œå…ƒç´ æ‰©å¤§2å€å‘ç”Ÿæ—¶æœºä¸ä¸€æ ·äº†ï¼Œä½¿ç”¨å¹¶è¡Œæµå…ƒç´ æ‰©å¤§æ˜¯åœ¨ç¼©å‡çš„è¿‡ç¨‹å½“ä¸­çš„ï¼Œè€Œä½¿ç”¨æ˜ å°„å¤„ç†æ—¶ï¼Œå…ƒç´ æ‰©å¤§æ˜¯å‘ç”Ÿåœ¨æ˜ å°„è¿‡ç¨‹ä¸­çš„ã€‚å› æ­¤æ˜ å°„è¿‡ç¨‹å®Œç¨‹ä¹‹åï¼Œä¸éœ€è¦reduce()æä¾›åˆå¹¶å™¨äº†ã€‚</p>\n<p>ä¸Šé¢çš„è¿™ä¸ªä¾‹å­è¿˜æ˜¯ç®€å•äº†ä¸€ç‚¹ï¼Œä¸‹é¢å†ä¸¾ä¸€ä¸ªä¾‹å­,ç‹è€…è£è€€å›¢é˜Ÿç»æµè®¡ç®—ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">#ç©å®¶ä½¿ç”¨çš„è‹±é›„ä»¥åŠå½“å‰è·å¾—çš„é‡‘å¸æ•°\npublic class HeroPlayerGold &#123;\n    &#x2F;** ä½¿ç”¨çš„è‹±é›„åå­— *&#x2F;\n    private String hero;\n    &#x2F;** ç©å®¶çš„ID *&#x2F;\n    private String player;\n    &#x2F;** è·å¾—çš„é‡‘å¸æ•° *&#x2F;\n    private int gold;\n\n    public HeroPlayerGold(String hero, String player, int gold) &#123;\n        this.hero &#x3D; hero;\n        this.player &#x3D; player;\n        this.gold &#x3D; gold;\n    &#125;\n  &#x2F;&#x2F;çœç•¥get&#x2F;set&#x2F;toString\n&#125;\n\n#ç©å®¶è·å¾—çš„é‡‘å¸æ•°\npublic class Gold &#123;\n    &#x2F;** è·å¾—çš„é‡‘å¸æ•° *&#x2F;\n    private int gold;\n\n    public Gold(int gold) &#123;\n        this.gold &#x3D; gold;\n    &#125;\n &#x2F;&#x2F;çœç•¥get&#x2F;set&#x2F;toString\nï½\n\n#æµ‹è¯•ç±»\npublic class Main &#123;\n    public static void main(String[] args) &#123;\n        learnMap2th();\n    &#125;\n\n    private static void learnMap2th() &#123;\n        List&lt;HeroPlayerGold&gt; lists &#x3D; new ArrayList&lt;&gt;();\n        lists.add(new HeroPlayerGold(&quot;ç›–ä¼¦&quot;, &quot;RNG-Letme&quot;, 100));\n        lists.add(new HeroPlayerGold(&quot;è¯¸è‘›äº®&quot;, &quot;RNG-Xiaohu&quot;, 300));\n        lists.add(new HeroPlayerGold(&quot;éœ²å¨œ&quot;, &quot;RNG-MLXG&quot;, 300));\n        lists.add(new HeroPlayerGold(&quot;ç‹„ä»æ°&quot;, &quot;RNG-UZI&quot;, 500));\n        lists.add(new HeroPlayerGold(&quot;ç‰›å¤´&quot;, &quot;RNG-Ming&quot;, 500));\n\n        &#x2F;&#x2F;è®¡ç®—å›¢é˜Ÿç»æµ\n        int teamMoney &#x3D; lists.stream()\n                .map(player -&gt; new Gold(player.getGold()))&#x2F;&#x2F;note1\n                .mapToInt(Gold::getGold)\n                .reduce(0, (a, b) -&gt; a + b);\n        System.out.println(&quot;å›¢é˜Ÿç»æµï¼š&quot; + teamMoney);&#x2F;&#x2F;1700\n\n\n        &#x2F;&#x2F;è®¡ç®—å›¢é˜Ÿç»æµ2\n        double teamMoney2 &#x3D; lists.stream()\n                .mapToDouble(HeroPlayerGold::getGold)\n                .reduce(0, (a, b) -&gt; a + b);\n        System.out.println(&quot;å›¢é˜Ÿç»æµï¼š&quot; + teamMoney2);&#x2F;&#x2F;1700.0\n    &#125;\n&#125;\n<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä»£ç åº”è¯¥ä¸éš¾ç†è§£ï¼Œé€šè¿‡ä»£ç ï¼Œå¤§å®¶åº”è¯¥çŸ¥é“æˆ‘ä»¬å‡è®¾çš„åœºæ™¯äº†ã€‚æˆ‘ä»¬çš„RNGå»å‚åŠ ç‹è€…è£è€€æ¯”èµ›äº†ï¼Œåƒè¿™ç§å›¢é˜Ÿæ¸¸æˆï¼Œè§‚ä¼—åœ¨ç»æµæ–¹é¢å…³æ³¨æ›´å¤šçš„å¯èƒ½æ˜¯å›¢é˜Ÿç»æµï¼Œè€Œä¸æ˜¯ä¸ªäººç»æµã€‚</p>\n<p>åœ¨æˆ‘ä»¬<code>HeroPlayerGold</code>ç±»é‡Œé¢å­˜æœ‰æ˜æ˜Ÿç©å®¶ï¼Œä½¿ç”¨çš„è‹±é›„ï¼Œå’Œè¿™å±€æ¯”èµ›æŸä¸ªç©å®¶å½“å‰è·å¾—çš„é‡‘å¸æ•°ï¼Œæˆ‘ä»¬å¦æœ‰ä¸€ä¸ªä¸“ä»¬ç®¡ç†é‡‘å¸çš„<code>Gold</code>ç±»ï¼Œæˆ‘ä»¬ç¬¬ä¸€ç§è®¡ç®—å›¢é˜Ÿç»æµçš„æ–¹å¼ï¼Œä½¿æŠŠ<code>HeroPlayerGold</code>é‡Œé¢çš„<code>gold</code>å­—æ®µè½¬æ¢åˆ°<code>Gold</code>é‡Œé¢äº†<sup> <code>//note1</code> </sup>,è¿™é‡Œäº§ç”Ÿçš„æ–°æµåªåŒ…å«äº†åŸå§‹æµä¸­é€‰å®šçš„<code>gold</code>å­—æ®µï¼Œå› ä¸ºæˆ‘ä»¬çš„åŸå§‹æµä¸­åŒ…å«äº†<code>hero</code>ã€<code>player</code>ã€<code>gold</code>,ä¸‰ä¸ªå­—æ®µï¼Œæˆ‘ä»¬åªé€‰å–äº†<code>gold</code>å­—æ®µï¼ˆå› ä¸ºæˆ‘ä»¬åªå…³å¿ƒè¿™ä¸ªå­—æ®µï¼‰ï¼Œæ‰€ä»¥å…¶å®ƒçš„ä¸¤ä¸ªå­—æ®µè¢«ä¸¢å¼ƒäº†ã€‚ç„¶åä»æ–°æµå–å‡º<code>Gold</code>é‡Œé¢çš„<code>gold</code>å­—æ®µå¹¶æŠŠä»–è½¬æˆä¸€ä¸ª<code>IntStream</code>ï¼Œç„¶åæˆ‘ä»¬å°±è¦ä»¥é€šè¿‡ç¼©å‡æ“ä½œå®Œæˆæˆ‘ä»¬çš„å›¢é˜Ÿç»æµè®¡ç®—äº†ã€‚</p>\n<p>ç¬¬ä¸€ç§æ–¹å¼ï¼Œå¤§å®¶éœ€è¦å¥½å¥½ç†è§£ï¼Œç†è§£äº†ï¼Œæˆ‘ç›¸ä¿¡ä½ ä»¬çš„é¡¹ç›®ä¸­ï¼Œå¾ˆå¤šå¾ˆå¤šåœ°æ–¹å¯ä»¥ç”¨å¾—ä¸Šäº†ï¼Œå†ä¹Ÿä¸éœ€è¦åŠ¨ä¸åŠ¨å°±æŸ¥æ•°æ®åº“äº†ï¼Œæ€æ ·æ•ˆç‡é«˜æ€æ ·æ¥ï¼Œåªæ˜¯ä¸€ç§å»ºè®®ã€‚ç¬¬äºŒç§åªæ˜¯å¿«é€Ÿè®¡ç®—å›¢é˜Ÿç»æµè€Œå·²ï¼Œæ²¡ä»€ä¹ˆå€¼å¾—è®²çš„ã€‚</p>\n<p>æ¥ä¸‹æ¥è®²ä¸€ä¸‹ä»–çš„æ‰©å±•æ–¹å‘ï¼šå¤§å®¶è¿˜è®°å¾—æˆ‘åœ¨ç¬¬äºŒç¯‡ä¸­ä»‹ç»ä¸­é—´æ“ä½œæ¦‚å¿µçš„æ—¶å€™å—ï¼Ÿ<code>ä¸­é—´æ“ä½œä¼šäº§ç”Ÿå¦ä¸€ä¸ªæµã€‚å› æ­¤ä¸­é—´æ“ä½œå¯ä»¥ç”¨æ¥åˆ›å»ºæ‰§è¡Œä¸€ç³»åˆ—åŠ¨ä½œçš„ç®¡é“ã€‚</code>æˆ‘ä»¬å¯ä»¥æŠŠå¤šä¸ªä¸­é—´æ“ä½œæ”¾åˆ°ç®¡é“ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾ˆå®¹æ˜“å°±åˆ›å»ºå‡ºå¾ˆå¼ºå¤§çš„ç»„åˆæ“ä½œäº†ï¼Œå‘æŒ¥ä½ çš„æƒ³è±¡ï¼Œæ‰“å‡ºä½ ä»¬çš„ç»„åˆæ‹³;</p>\n<p>æˆ‘ç°åœ¨ä¸¾ä¸€ä¸ªä¾‹å­ï¼šæ¯”å¦‚ç°åœ¨ç›¸ç»Ÿè®¡å›¢é˜Ÿé‡Œé¢ä¸¤ä¸ªCä½çš„ç»æµå äº†å¤šå°‘ï¼Œä»£ç çœ‹èµ·æ¥å¯èƒ½å°±æ˜¯è¿™æ ·äº†ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void learnMap2th() &#123;\n       List&lt;HeroPlayerGold&gt; lists &#x3D; new ArrayList&lt;&gt;();\n       lists.add(new HeroPlayerGold(&quot;ç›–ä¼¦&quot;, &quot;RNG-Letme&quot;, 100));\n       lists.add(new HeroPlayerGold(&quot;è¯¸è‘›äº®&quot;, &quot;RNG-Xiaohu&quot;, 300));\n       lists.add(new HeroPlayerGold(&quot;éœ²å¨œ&quot;, &quot;RNG-MLXG&quot;, 300));\n       lists.add(new HeroPlayerGold(&quot;ç‹„ä»æ°&quot;, &quot;RNG-UZI&quot;, 500));\n       lists.add(new HeroPlayerGold(&quot;ç‰›å¤´&quot;, &quot;RNG-Ming&quot;, 500));\n       \n       &#x2F;&#x2F;è®¡ç®—ä¸¤ä¸ªCä½çš„ç»æµå’Œ\n       lists.stream()\n               .filter(player-&gt; &quot;RNG-Xiaohu&quot;.equals(player.getPlayer()) || &quot;RNG-UZI&quot;.equals(player.getPlayer()))\n               .map(player-&gt;new Gold(player.getGold()))\n               .mapToInt(Gold::getGold)\n               .reduce((a,b)-&gt;a+b)\n               .ifPresent(System.out::println);&#x2F;&#x2F;800\n   &#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¤§å®¶æœ‰æ²¡æœ‰æ„Ÿè§‰ï¼Œè¿™ç§æ“ä½œæ€ä¹ˆå¸¦æœ‰ç‚¹æ•°æ®åº“çš„é£æ ¼å•Šï¼Ÿå…¶å®åœ¨åˆ›å»ºæ•°æ®åº“æŸ¥è¯¢çš„æ—¶å€™ï¼Œè¿™ç§è¿‡æ»¤æ“ä½œååˆ†å¸¸è§ï¼Œå¦‚æœä½ ç»å¸¸åœ¨ä½ çš„é¡¹ç›®ä¸­ä½¿ç”¨æµAPIï¼Œè¿™å‡ ä¸ªæ¡ä»¶ç®—ä»€ä¹ˆ?ç­‰ä½ ä»¬æŠŠæµAPIç”¨ç†Ÿäº†ä¹‹åï¼Œä½ ä»¬å®Œå…¨å¯ä»¥é€šè¿‡è¿™ç§é“¾å¼æ“ä½œåˆ›å»ºå‡ºéå¸¸å¤æ‚çš„æŸ¥è¯¢ï¼Œåˆå¹¶å’Œé€‰æ‹©çš„æ“ä½œã€‚</p>\n<p>é€šè¿‡å‰é¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å·²ç»æŠŠ<code>map()</code>ï¼Œ<code>mapToInt()</code>ï¼Œ<code>mapToLong()</code>ï¼Œ<code>mapToDouble</code>éƒ½è®²äº†ã€‚é‚£ä¹ˆå‰©ä¸‹çš„å°±æ˜¯flatMap()æ–¹æ³•äº†ã€‚æœ¬æ¥æƒ³è®©å¤§å®¶è‡ªè¡Œå»ç†è§£è¿™ä¸ªæ–¹æ³•çš„ï¼Œå› ä¸ºæ€•è¿™ç¯‡æ–‡ç« å†™å¾—å¤ªé•¿äº†ã€‚ä½†æ˜¯åé¢æƒ³æƒ³ï¼Œè¿˜æ˜¯æˆ‘æ¥ç»™å¤§å®¶åˆ†æä¸€ä¸‹å§ã€‚</p>\n<p><strong><R> Stream<R> flatMap(Function&lt;? super T, ? extends Stream&lt;? extends R&gt;&gt; mapper);</strong></p>\n<p>é€šè¿‡å‰é¢çš„å­¦ä¹ æˆ‘ä»¬çŸ¥é“<code>mapper</code>æ˜¯ä¸€ä¸ªæ˜ å°„å‡½æ•°ï¼Œå®ƒå’Œmap()æ–¹æ³•ä¹Ÿä¸€æ ·ä¹Ÿä¼šè¿”å›ä¸€ä¸ªæ–°æµï¼Œæˆ‘ä»¬æŠŠè¿”å›çš„æ–°æµç§°ä¸ºæ˜ å°„æµã€‚<strong>æˆ‘ä»¬æä¾›çš„æ˜ å°„å‡½æ•°ä¼šå¤„ç†åŸå§‹æµä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œè€Œæ˜ å°„æµä¸­åŒ…å«äº†æ‰€æœ‰ç»è¿‡æˆ‘ä»¬æ˜ å°„å‡½æ•°å¤„ç†åäº§ç”Ÿçš„æ–°å…ƒç´ ã€‚</strong> åŠ ç²—éƒ¨ä»½éœ€è¦é‡ç‚¹ç†è§£ã€‚</p>\n<p>æˆ‘ä»¬æ¥çœ‹ä¸€ä¸‹æºç å¯¹flatMap()çš„æ³¨é‡Š:</p>\n<blockquote>\n<p>The  flatMap() operation has the effect of applying a one-to-many  transformation to the elements of the stream, and then flattening the resulting elements into a new stream.</p>\n</blockquote>\n<p>å¤§æ„å°±æ˜¯ï¼š<strong>flatMap()æ“ä½œèƒ½æŠŠåŸå§‹æµä¸­çš„å…ƒç´ è¿›è¡Œä¸€å¯¹å¤šçš„è½¬æ¢ï¼Œå¹¶ä¸”å°†æ–°ç”Ÿæˆçš„å…ƒç´ å…¨éƒ½åˆå¹¶åˆ°å®ƒè¿”å›çš„æµé‡Œé¢ã€‚</strong>æ ¹æ®æˆ‘ä»¬æ‰€å­¦çš„çŸ¥è¯†ï¼Œä»–çš„è¿™ç§ä¸€å¯¹å¤šçš„è½¬æ¢åŠŸèƒ½è‚¯å®šå°±æ˜¯æ˜ å°„å‡½æ•°æä¾›çš„ï¼Œè¿™ä¸€ç‚¹æ²¡æœ‰ç–‘é—®å§ï¼ç„¶åæºç çš„æ³¨é‡Šä¸Šé¢è¿˜æä¾›äº†ä¸€ä¸ªä¾‹å­ï¼Œé€šè¿‡æ³¨é‡ŠåŠ ä¾‹å­ï¼Œæˆ‘ç›¸ä¿¡å¤§å®¶éƒ½èƒ½éå¸¸æ¸…æ¥šåœ°ç†è§£flatMap()äº†ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">&#x2F;* &lt;p&gt;If &#123;@code orders&#125; is a stream of purchase orders, and each purchase\n * order contains a collection of line items, then the following produces a\n * stream containing all the line items in all the orders:\n * &lt;pre&gt;&#123;@code\n *     orders.flatMap(order -&gt; order.getLineItems().stream())...\n * &#125;&lt;&#x2F;pre&gt;\n *&#x2F;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p><strong>å¦‚æœordersæ˜¯ä¸€æ‰¹é‡‡è´­è®¢å•å¯¹åº”çš„æµï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªé‡‡è´­è®¢å•éƒ½åŒ…å«ä¸€ç³»åˆ—çš„é‡‡è´­é¡¹ï¼Œé‚£ä¹ˆ<code>orders.flatMap(order -&gt; order.getLineItems().stream())...</code>ç”Ÿæˆçš„æ–°æµå°†åŒ…å«è¿™ä¸€æ‰¹é‡‡è´­è®¢å•ä¸­æ‰€æœ‰é‡‡è´­é¡¹ã€‚</strong> </p>\n<p>æˆ‘ä»¬ç”¨ä¼ªä»£ç æ¥å°±æ›´åŠ æ¸…æ™°äº†<code>Stream&lt;Orders&lt;OrderItem&gt;&gt;</code>&#x3D;&#x3D;&#x3D;&#x3D;&gt;Stream<OrderItem>ã€‚å¤§å®¶èƒ½ç†è§£äº†å—ï¼Ÿè¿˜æ²¡ç†è§£ï¼Ÿå†æ¥ä¸€ä¸ªä¾‹å­ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void learnFlatMap() &#123;\n       &#x2F;&#x2F;(å¹¿å·  æ·±åœ³  ä¸Šæµ·  åŒ—äº¬)çš„å…¨æ‹¼çš„ä¸€äº›ç»„åˆ,ä¸‹é¢æˆ‘ä»¬å°±æŠŠæ¯ä¸€ä¸ªåŸå¸‚éƒ½åˆ’åˆ†ä¸€ä¸‹\n       List&lt;String&gt; citys &#x3D; Arrays.asList(&quot;GuangZhou ShangHai&quot;, &quot;GuangZhou ShenZhen&quot;,\n               &quot;ShangHai ShenZhen&quot;, &quot;BeiJing ShangHai&quot;, &quot;GuangZhou BeiJing&quot;, &quot;ShenZhen BeiJing&quot;);\n\n       &#x2F;&#x2F;è¿™é‡Œæ‰“å°çš„æ•°ç»„å¯¹åº”çš„åœ°å€\n       citys.stream().map(mCitys -&gt; Arrays.stream(mCitys.split(&quot; &quot;))).forEach(System.out::println);&#x2F;&#x2F;note1\n\n       System.out.println();\n\n       &#x2F;&#x2F;æµé‡Œé¢çš„å…ƒç´ è¿˜æ˜¯ä¸€ä¸ªæ•°ç»„\n       citys.stream()\n               .map(mCities -&gt; Arrays.stream(mCities.split(&quot; &quot;)))&#x2F;&#x2F;æµé‡Œé¢çš„æ¯ä¸ªå…ƒç´ è¿˜æ˜¯æ•°ç»„\n               .forEach(cities -&gt;cities.forEach(city-&gt; System.out.print(city+&quot; &quot;)));&#x2F;&#x2F;note2\n\n       System.out.println();\n       System.out.println();\n\n       &#x2F;&#x2F;ç›´æ¥ä¸€ä¸ªflatMap()å°±æŠŠæ•°ç»„åˆå¹¶åˆ°æ˜ å°„æµé‡Œé¢äº†\n       citys.stream().flatMap(mCities-&gt;Arrays.stream(mCities.split(&quot; &quot;))).forEach(System.out::println);&#x2F;&#x2F;note3\n\n       System.out.println();\n\n       &#x2F;&#x2F;ä½¿ç”¨distinct()æ–¹æ³•å»é‡ï¼\n       citys.stream().flatMap(mCities-&gt;Arrays.stream(mCities.split(&quot; &quot;))).distinct().forEach(System.out::println);&#x2F;&#x2F;note4\n\n   &#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å…¶ä¸­<sup> <code>//note1</code> </sup>å¤„æ˜¯æ— æ³•æ‰“å°å…ƒç´ çš„ï¼Œä½¿ç”¨map()æ‰“å°å…ƒç´ çš„æ–¹å¼åœ¨<sup> <code>//note2</code> </sup>ï¼ŒåŸå› ä¹Ÿåœ¨æ³¨é‡Šä¸­äº¤å¾…äº†ï¼Œä½†æ˜¯ä½¿ç”¨äº†flatMap()æ–¹æ³•åï¼Œç›´æ¥å°±å¯ä»¥æ‰“å°äº†<sup> <code>//note3</code> </sup>ï¼Œåˆ°è¿™é‡Œï¼Œåº”è¯¥å°±èƒ½ç†è§£<strong>å¦‚æœordersæ˜¯ä¸€æ‰¹é‡‡è´­è®¢å•å¯¹åº”çš„æµï¼Œå¹¶ä¸”æ¯ä¸€ä¸ªé‡‡è´­è®¢å•éƒ½åŒ…å«ä¸€ç³»åˆ—çš„é‡‡è´­é¡¹ï¼Œé‚£ä¹ˆ<code>orders.flatMap(order -&gt; order.getLineItems().stream())...</code>ç”Ÿæˆçš„æ–°æµå°†åŒ…å«è¿™ä¸€æ‰¹é‡‡è´­è®¢å•ä¸­æ‰€æœ‰é‡‡è´­é¡¹ã€‚</strong> äº†å§ã€‚æœ€å<sup> <code>//note4</code> </sup>æ˜¯ä¸€ä¸ªå»é‡çš„æ–¹æ³•ï¼Œå¤§å®¶è¿è¡Œä¸€éå§ã€‚</p>\n<h4 id=\"å°ç»“ä¸€ä¸‹\"><a href=\"#å°ç»“ä¸€ä¸‹\" class=\"headerlink\" title=\"å°ç»“ä¸€ä¸‹\"></a>å°ç»“ä¸€ä¸‹</h4><p>é€šè¿‡è¿™ä¸€ç¯‡æ–‡ç« ï¼Œç›¸ä¿¡å¤§å®¶å¯¹æµAPIä¸­çš„æ˜ å°„å·²ç»ä¸å†é™Œç”Ÿäº†ï¼Œå…¶å®æœ€éœ€è¦æ³¨æ„çš„ä¸€ä¸ªç‚¹æ˜¯,map()å’ŒflatMap()çš„åŒºåˆ«ï¼Œæˆ‘ä¹Ÿä¸€æ­¥æ­¥åœ°å¸¦ç€å¤§å®¶ç†è§£å’Œåº”ç”¨äº†ã€‚å…¶å®åœ¨æµAPIè¿™ä¸€å—ä¸­ï¼Œå¤§å®¶å•å•æŒæ¡æ¦‚å¿µæ˜¯æ²¡ä»€ä¹ˆç”¨çš„ï¼Œä¸€å®šè¦å»å®æˆ˜äº†ï¼Œä¸€ä¸ªé¡¹ç›®é‡Œé¢ï¼Œé›†åˆæ¡†æ¶è¿™ç§ä¸œè¥¿ç”¨å¾—è¿˜æ˜¯ç‰¹åˆ«å¤šçš„ï¼Œç”¨åˆ°é›†åˆæ¡†æ¶çš„å¤§éƒ¨ä»½æƒ…å†µï¼Œå…¶å®éƒ½å¯ä»¥è€ƒè™‘ä¸€ä¸‹ç”¨Streamæµå»æ“ä½œä¸€ä¸‹ï¼Œä¸ä»…å¢åŠ æ•ˆç‡ï¼Œè¿˜å¯ä»¥å¢åŠ ä¸šåŠ¡æµç¨‹çš„æ¸…æ™°åº¦ã€‚</p>\n"},{"title":"Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆå››ï¼‰å¹¶è¡Œæµ","date":"2025-10-15T03:36:33.000Z","_content":"\néšç€å¯¹æµAPIè®¤è¯†çš„æ…¢æ…¢æ·±å…¥ï¼Œæœ¬ç« æˆ‘ä»¬è¦è®¨è®ºçš„çŸ¥è¯†ç‚¹æ˜¯æµAPIé‡Œé¢çš„å¹¶è¡Œæµäº†ã€‚\n\nåœ¨å¼€å§‹è®¨è®ºå¹¶è¡Œæµä¹‹å‰ï¼Œæˆ‘å…ˆå¼•å‘ä¸€ä¸‹å¤§å®¶çš„æ€è€ƒï¼Œå°±ä½ çœ‹åˆ°è¿™ç¯‡æ–‡ç« çš„æ—¶é—´ï¼Œä½ ä»¬æ˜¯ä¸æ˜¯ç»å¸¸å¬åˆ°ï¼ŒIntel i7 CPUä»€ä¹ˆ8æ ¸16çº¿ç¨‹ï¼Œä»€ä¹ˆAndroidæ‰‹æœº8æ ¸4GBè¿™ç§æ¶ˆæ¯ï¼Œæ—¢ç„¶æˆ‘ä»¬æ˜¯å¤„äºä¸€ä¸ªå¤šæ ¸å¤„ç†å™¨çš„æ—¶ä»£ï¼Œä½ ä»¬æœ‰æ²¡æœ‰æƒ³è¿‡å¹¶è¡Œåœ°æ“ä½œæ•°ç»„å’Œé›†åˆæ¡†æ¶ï¼Œä»è€Œé«˜é€Ÿåœ°æ‰§è¡Œæˆ‘ä»¬å¯¹æ•°ç»„æˆ–è€…é›†åˆçš„ä¸€äº›æ“ä½œå‘¢ï¼Ÿ\n\næˆ–è®¸ä½ æœ‰æƒ³è¿‡è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯å› ä¸ºå¹¶è¡Œç¼–ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œæ‰€ä»¥è¿™äº›æƒ³æ³•è¿˜åœç•™åœ¨ä½ çš„è„‘æµ·å½“ä¸­ï¼Œåˆæˆ–è€…ä½ å·²ç»åœ¨è·¯ä¸Šäº†ï¼Œåæ­£ä½ ä»¬å°±æ˜¯æœ€æ£’çš„ï¼ˆæˆ‘ä»–å¦ˆéƒ½è¿™ä¹ˆå¤¸ä½ ä»¬äº†ï¼Œå°±ä¸èƒ½ç‚¹ä¸ªå–œæ¬¢ï¼Ÿï¼‰ã€‚\n\nä¸ç®¡å¦‚ä½•ï¼Œåœ¨ä½ çœ‹åˆ°è¿™ä¸€ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œæˆ‘å°†å¸¦ä½ èµ°å‘å¹¶è¡Œåœ°æ“ä½œæ•°ç»„æˆ–è€…é›†åˆï¼Œå½“ç„¶æ˜¯ä½¿ç”¨æˆ‘ä»¬çš„å¹¶è¡ŒæµçŸ¥è¯†å•¦ã€‚\n\n#### å¹¶è¡Œæµ\n\nå¹¶è¡Œç¼–ç¨‹å¯è°“æ˜¯ååˆ†å¤æ‚å¹¶ä¸”å¾ˆå®¹æ˜“å‡ºé”™çš„ï¼Œè¿™ä¼°è®¡å°±æ˜¯æˆ‘ä»¬ç»å¤§éƒ¨åˆ†äººçš„æ‹¦è„šçŸ³ã€‚åˆšå¥½Streamæµåº“ç»™æˆ‘ä»¬è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œåœ¨æµAPIåº“é‡Œé¢æä¾›äº†è½»æ¾å¯é çš„å¹¶è¡Œæ“ä½œã€‚è¦æƒ³å¹¶è¡Œå¤„ç†æµç›¸å½“ç®€å•ï¼Œåªéœ€è¦ä½¿ç”¨ä¸€ä¸ªå¹¶è¡Œæµå°±å¯ä»¥äº†ã€‚\n\nå¦‚ç¬¬äºŒç¯‡æ–‡ç« ä¸­æåˆ°çš„é‚£æ ·ï¼Œæˆ‘ä»¬è·å–ä¸€ä¸ªå¹¶è¡Œæµæ˜¯éå¸¸ç®€å•çš„ï¼Œåªéœ€è¦å¯¹æµè°ƒç”¨ä¸€ä¸‹parallel()å°±å¯ä»¥è·å–åˆ°ä¸€ä¸ªå¹¶è¡Œæµäº†ï¼ˆä»€ä¹ˆä½ å±…ç„¶ä¸çŸ¥é“ï¼Ÿé‚£ä¹ˆå¤šäººçœ‹äº†æˆ‘çš„æ–‡ç« ï¼Œä¼°è®¡ä½ è¦è¢«ä»–ä»¬ç”©å¼€å‡ æ¡è¡—äº†ï¼Œèµ¶ç´§å›å»çœ‹å§ã€‚ï¼‰ï¼Œç¬¬äºŒç§æ–¹å¼å°±æ›´åŠ ç®€å•äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Collectionæ¥å£æä¾›ç»™æˆ‘ä»¬parallelStream(),ä¹Ÿæ˜¯å¯ä»¥è·å–åˆ°ä¸€ä¸ªå¹¶è¡Œæµçš„ã€‚\n\nå½“ç„¶ï¼Œå¹¶è¡Œæ“ä½œè‚¯å®šæ˜¯éœ€è¦ç¯å¢ƒæ”¯æŒçš„ï¼Œä½ æäº†ä¸€å°ä¸€æ ¸ä¸€çº¿ç¨‹çš„å°éœ¸ç‹ï¼Œæ¥è·‘æˆ‘çš„é«˜å¤§ä¸Šå¹¶è¡Œæµï¼Œæˆ‘ä¹Ÿåªèƒ½æ…¢æ…¢æ¥äº†ã€‚å¦‚æœä½ ä¸æ˜¯å°éœ¸ç‹ï¼Œé‚£æˆ‘ä»¬å¯ä»¥å¼€å§‹è¿™èŠ‚è¯¾çš„å®æˆ˜äº†ï¼Œå…ˆæ‹¿ä¸Šä¸€ç¯‡çš„ä¾‹å­æ¥æ”¹ä¸€ä¸‹å…ˆï¼Œå¦‚æœä½ ä¸è®¤çœŸè§‚å¯Ÿï¼Œä½ éƒ½æ‰¾ä¸å‡ºä»–ä»¬çš„ä¸åŒä¹‹å¤„ï¼š\n\n```\npublic class Main {\n\n    public static void main(String[] args) {\n        learnStream();\n    }\n\n\n\n    private static void learnStream() {\n        List<Integer> lists = new ArrayList<>();\n        lists.add(1);\n        lists.add(2);\n        lists.add(3);\n        lists.add(4);\n        lists.add(5);\n        lists.add(6);\n\n        Optional<Integer> sum = lists.parallelStream().reduce((a, b) -> a + b);//è¿™é‡ŒæŠŠstream()æ¢æˆäº†parallelStreamï¼ˆï¼‰\n        if (sum.isPresent()) System.out.println(\"listçš„æ€»å’Œä¸º:\" + sum.get());//21\n        //<====> lists.stream().reduce((a, b) -> a + b).ifPresent(System.out::println);\n\n        Integer sum2 = lists.stream().reduce(0, (a, b) -> a + b);//21\n        System.out.println(\"listçš„æ€»å’Œä¸º:\" + sum2);\n\n        Optional<Integer> product = lists.stream().reduce((a, b) -> a * b);\n        if (product.isPresent()) System.out.println(\"listçš„ç§¯ä¸º:\" + product.get());//720\n\n        Integer product2 = lists.parallelStream().reduce(1, (a, b) -> a * b);//è¿™é‡ŒæŠŠstream()æ¢æˆäº†parallelStreamï¼ˆï¼‰\n        System.out.println(\"listçš„ç§¯ä¸º:\" + product2);//720\n    }\n}\n```\n\nå¾—åˆ°ç»“æœå’Œä¸Šä¸€ç¯‡æ–‡ç« çš„ä¸€æ¨¡ä¸€æ ·ã€‚ä½†æ˜¯å› ä¸ºä¹˜æ³•å’ŒåŠ æ³•æ“ä½œæ˜¯å¯ä»¥å‘ç”Ÿåœ¨ä¸åŒçš„çº¿ç¨‹é‡Œé¢çš„ï¼Œå› æ­¤è¿™ä¸¤ä¸ªä¾‹å­ï¼Œåœ¨æ•°æ®æºè¶³å¤Ÿå¤§çš„æ—¶å€™ï¼Œä»–ä»¬çš„è¿è¡Œçš„æ—¶é—´ï¼Œå·®åˆ«ç›¸å½“åœ°å¤§äº†å•Šã€‚\n\nä¸€èˆ¬æ¥è¯´ï¼Œåº”ç”¨åˆ°å¹¶è¡Œæµçš„ä»»ä½•æ“ä½œéƒ½å¿…é¡»æ˜¯ç¬¦åˆç¼©å‡æ“ä½œçš„ä¸‰ä¸ªçº¦æŸæ¡ä»¶ï¼Œæ— çŠ¶æ€ï¼Œä¸å¹²é¢„ï¼Œå…³è”æ€§ï¼å› ä¸ºè¿™ä¸‰å¤§çº¦æŸç¡®ä¿åœ¨å¹¶è¡Œæµä¸Šæ‰§è¡Œæ“ä½œçš„ç»“æœå’Œåœ¨é¡ºåºæµä¸Šæ‰§è¡Œçš„ç»“æœæ˜¯ç›¸åŒçš„ã€‚\n\næˆ‘ä»¬åœ¨ä¸Šä¸€ç¯‡è®²ç¼©å‡æ“ä½œçš„æ—¶å€™ï¼Œæåˆ°äº†ä¸‰ä¸ªreduce(),ä½†æ˜¯æˆ‘ä»¬åªè®²äº†ä¸¤ä¸ªï¼Œæˆ‘å°±ä¸å’Œä½ ä»¬çš®äº†ï¼Œç›´æ¥å¼€è®²å‰©ä¸‹çš„é‚£ä¸€ä¸ªï¼Œåœ¨å¹¶è¡Œæµé‡Œé¢ï¼Œä½ ä»¬ä¼šå‘ç°è¿™ä¸ªç‰ˆæœ¬çš„reduce()æ‰æ˜¯çœŸçˆ±å•Šï¼\n\n```\npublic interface Stream<T> extends BaseStream<T, Stream<T>> {\n//ã€ã€ã€å¿½ç•¥å…¶ä»–æ— å…³ç´§è¦çš„å…ƒç´ \n<U> U reduce(U identity,\n          BiFunction<U, ? super T, U> accumulator,\n          BinaryOperator<U> combiner);\nï½\n```\n\nåœ¨reduce()çš„è¿™ä¸ªç‰ˆæœ¬å½“ä¸­ï¼Œaccumulatorè¢«ç§°ä¸ºç´¯åŠ å™¨ï¼Œcombinerè¢«ç§°ä¸ºåˆæˆå™¨ï¼Œcombinerå®šä¹‰çš„å‡½æ•°å°†accumulatoræåˆ°çš„ä¸¤ä¸ªå€¼åˆå¹¶èµ·æ¥ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸Šé¢çš„é‚£ä¸ªä¾‹å­æ”¹æˆï¼š\n\n```\n    private static void reduce3th() {\n        List<Integer> lists = new ArrayList<>();\n        lists.add(1);\n        lists.add(2);\n        lists.add(3);\n        lists.add(4);\n        lists.add(5);\n        lists.add(6);\n\n        Integer product2 = lists.parallelStream().reduce(1, (a, b) -> a * b,\n                                                            (a, b) -> a * b);\n        System.out.println(\"listçš„ç§¯ä¸º:\" + product2);//720\n    }\n```\n\nä»–ä»¬å¾—åˆ°çš„ç»“æœè¿˜æ˜¯ä¸€æ ·çš„ã€‚\n\nä½ ä»¬å¯èƒ½ä»¥ä¸ºaccumulatorå’Œcombineræ‰§è¡Œçš„æ“ä½œæ˜¯ç›¸åŒçš„ï¼Œä½†å…¶å®ä»–ä»¬æ˜¯å¯ä»¥ä¸åŒçš„ï¼Œä¸‹é¢çš„ä¾‹å­ï¼Œä½ ä»¬è¦è®¤çœŸçœ‹äº†ï¼šå‡è®¾Listé‡Œé¢æœ‰ä¸‰ä¸ªIntegerç±»å‹çš„å…ƒç´ åˆ†åˆ«ä¸º1ï¼Œ2ï¼Œ3ã€‚\n\nç°åœ¨çš„éœ€æ±‚æ˜¯åˆ†åˆ«è®©Listé‡Œé¢çš„æ¯ä¸ªå…ƒç´ éƒ½æ”¾å¤§ä¸¤å€åï¼Œå†æ±‚ç§¯ã€‚è¿™ä¸ªéœ€æ±‚çš„æ­£ç¡®ç­”æ¡ˆåº”è¯¥æ˜¯48;\n\n```\n    private static void reduce3th() {\n        List<Integer> lists = new ArrayList<>();\n        lists.add(1);\n        lists.add(2);\n        lists.add(3);\n\n        Integer product = lists.parallelStream().reduce(1, (a, b) -> a *  (b * 2),\n                                                           (a, b) -> a * b);\n        System.out.println(\"product:\" + product);//48\n    }\n```\n\nç´¯åŠ å™¨éƒ¨åˆ†æ˜¯å°†ä¸¤ä¸ªå…ƒç´ åˆ†åˆ«æ”¾å¤§ä¸¤å€åï¼Œå†ç›¸ä¹˜,åˆå¹¶å™¨ï¼Œæ˜¯å°†ä¸¤ä¸ªéƒ¨åˆ†ç›¸ä¹˜ï¼å¦‚æœèƒ½ç†è§£è¿™é‡Œï¼Œæ­å–œä½ ï¼Œä½ çš„æŠ€èƒ½æœ‰ç›¸å½“å¤§çš„é•¿è¿›äº†ï¼ä¼°è®¡Streamæµä½ å°±å¯ä»¥æ— å¾€è€Œä¸åˆ©äº†ã€‚\n\nå¦‚æœä½ è¿˜ä¸èƒ½ç†è§£ï¼Œå°±åº”è¯¥ç»§ç»­å¾€ä¸‹çœ‹äº†ï¼Œè·Ÿç€æˆ‘çš„æ­¥ä¼æ…¢æ…¢èµ°ï¼š\n\n```\n    ç´¯åŠ å™¨éƒ¨åˆ†ï¼ˆæ°´å¹³å‘å³ï¼‰\n        accumulator\n-----------------------------â€º\nthread-1:   1 * 1 * 2   =   2    |    åˆå¹¶å™¨æ–¹å‘ï¼ˆç«–ç›´å‘ä¸‹ï¼‰\nthread-2:   1 * 2 * 2   =   4    |         combiner\nthread-3:   1 * 3 * 2   =   6    |   å› æ­¤æœ€ç»ˆçš„ç­”æ¡ˆæ˜¯2  *  4  *  6  =   48ï¼ˆæ²¡æ¯›ç—…ï¼‰\n                                 Ë‡\næ³¨ï¼šæ°´å¹³æ–¹å‘æœ€å‰é¢çš„1å°±æ˜¯identityçš„å€¼\n```\n\næ­¤æ—¶ï¼Œaccumulatorå’Œcombineræ‰§è¡Œçš„æ“ä½œæ˜¯ä¸æ˜¯ä¸€å®šä¸èƒ½ç›¸åŒäº†ã€‚ç†è§£è¿™äº›ï¼Œå¯¹äºç†è§£å¹¶è¡Œæµæ˜¯éå¸¸é‡è¦çš„ã€‚\n\nå¦‚æœæ­¤æ—¶çš„combinerè¿˜æ˜¯å’Œaccumulatorç›¸åŒï¼Œé‚£ä¹ˆç»“æœæ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼šè¯·çœ‹ï¼š\n\n```\n    private static void reduce3th() {\n        List<Integer> lists = new ArrayList<>();\n        lists.add(1);\n        lists.add(2);\n        lists.add(3);\n\n        Integer product = lists.parallelStream().reduce(1, (a, b) -> a *  (b * 2),\n                                                           (a, b) -> a * b * 2 );\n        System.out.println(\"product:\" + product);//192\n    }\n```\n\n192è¿™ä¸ªç­”æ¡ˆæ˜¯æ€ä¹ˆæ¥çš„ï¼Ÿ\n\n```\n    ç´¯åŠ å™¨éƒ¨åˆ†ï¼ˆæ°´å¹³å‘å³ï¼‰\n        accumulator\n-----------------------------â€º\nthread-1:   1 * 1 * 2   =   2          |    åˆå¹¶å™¨æ–¹å‘ï¼ˆç«–ç›´å‘ä¸‹ï¼‰\nthread-2:   1 * 2 * 2   =   4  *  2    |         combiner\nthread-3:   1 * 3 * 2   =   6  *  2    |   å› æ­¤æœ€ç»ˆçš„ç­”æ¡ˆæ˜¯2  *  ï¼ˆ 4  *  2 ï¼‰ *  ï¼ˆ6  *  2ï¼‰  =   192ï¼ˆæ²¡æ¯›ç—…ï¼‰\n                                       Ë‡\næ³¨ï¼šæ°´å¹³æ–¹å‘æœ€å‰é¢çš„1å°±æ˜¯identityçš„å€¼\n```\n\n#### é¡ºåºæµ&å¹¶è¡Œæµ&æ— åºæµä¹‹é—´çš„åˆ‡æ¢æ“ä½œ\n\nå¯¹äºè¿™ä¸‰ç§æµçš„åˆ‡æ¢ï¼Œåœ¨BaseStreamæ¥å£ä¸­æä¾›äº†ç›¸åº”çš„æ–¹æ³•ï¼Œå¦‚æœä½ è¿˜æ²¡æœ‰è®°ä½ï¼Œå›å¤´å†çœ‹ä¸€ä¸‹ç¬¬äºŒç¯‡æ–‡ç« å§ã€‚\n\nå…³äºä½¿ç”¨å¹¶è¡Œæµçš„æ—¶å€™ï¼Œè¿˜æœ‰ä¸€ä¸ªç‚¹éœ€è¦è®°ä½ï¼šå¦‚æœé›†åˆä¸­æˆ–è€…æ•°ç»„ä¸­çš„å…ƒç´ æ˜¯æœ‰åºçš„ï¼Œé‚£ä¹ˆå¯¹åº”çš„æµä¹Ÿæ˜¯æœ‰åºçš„ã€‚ä½†æ˜¯åœ¨ä½¿ç”¨å¹¶è¡Œæµæ—¶ï¼Œæœ‰æ—¶å€™æµæ˜¯æ— åºçš„å°±èƒ½è·å¾—æ€§èƒ½ä¸Šçš„æå‡ã€‚å› ä¸ºå¦‚æœæµæ˜¯æ— åºçš„ï¼Œé‚£ä¹ˆæµçš„æ¯ä¸ªéƒ¨åˆ†éƒ½å¯ä»¥è¢«å•ç‹¬çš„æ“ä½œï¼Œè€Œä¸éœ€è¦ä¸å…¶ä»–éƒ¨åˆ†åè°ƒï¼Œä»è€Œæå‡æ€§èƒ½ã€‚ï¼ˆåˆæ˜¯æ— çŠ¶æ€ï¼Œè¯´å¥½çš„é€€ä¼‘äº†å‘¢ï¼‰ã€‚æ‰€ä»¥å½“æµæ“ä½œçš„é¡ºåºä¸é‡è¦çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡BaseStreamæ¥å£æä¾›çš„unordered()æ–¹æ³•æŠŠæµè½¬æ¢æˆä¸€ä¸ªæ— åºæµä¹‹åï¼Œå†è¿›è¡Œå„ç§æ“ä½œã€‚\n\nå¦å¤–ä¸€ç‚¹:forEach()æ–¹æ³•ä¸ä¸€å®šä¼šä¿ç•™å¹¶è¡Œæµçš„é¡ºåºï¼Œå¦‚æœåœ¨å¯¹å¹¶è¡Œæµçš„æ¯ä¸ªå…ƒç´ æ‰§è¡Œæ“ä½œæ—¶ï¼Œä¹Ÿå¸Œæœ›ä¿ç•™é¡ºåºï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨forEachOrdered()æ–¹æ³•ï¼Œå®ƒçš„ç”¨æ³•å’ŒforEach()æ˜¯ä¸€æ ·çš„ã€‚å› ä¸ºåœ¨å‘å¸ƒç¬¬ä¸€ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œå¤§å®¶å¯¹forEachçš„ååº”æ¯”è¾ƒå¤§ï¼Œå¾ˆå¤šäººå…¶å®å¯¹forEachéƒ½æœ‰æƒ³æ³•ï¼šæ¯”å¦‚è°ƒè¯•éš¾ï¼Œç­‰ç­‰ã€‚å€Ÿè¿™ä¸ªæœºä¼šï¼Œæˆ‘è°ˆä¸€è°ˆæˆ‘å¯¹for&forEachçš„çœ‹æ³•ã€‚\n\næˆ‘ä»¬åœ¨è®¿é—®ä¸€ä¸ªæ•°ç»„å…ƒç´ çš„æ—¶å€™ï¼Œæœ€å¿«çš„æ–¹å¼è‚¯å®šæ˜¯é€šè¿‡ç´¢å¼•å»è®¿é—®çš„å§ï¼Œè€Œforå¾ªç¯éå†çš„æ—¶å€™å°±æ˜¯é€šè¿‡ä¸‹æ ‡è¿›è¡Œçš„ï¼Œæ‰€ä»¥æ•ˆç‡é‚£æ˜¯ç›¸å½“çš„é«˜ï¼Œä½†æ˜¯å½“æˆ‘ä»¬çš„æ•°æ®ç»“æ„ä¸æ˜¯æ•°ç»„çš„æ—¶å€™ï¼Œæ¯”å¦‚æ˜¯é“¾è¡¨çš„æ—¶å€™ï¼Œå¯æƒ³è€ŒçŸ¥ï¼Œforå¾ªç¯çš„æ•ˆç‡æ˜¯æœ‰å¤šä½ï¼Œä½†æ˜¯forEachåº•å±‚é‡‡ç”¨çš„æ˜¯è¿­ä»£å™¨çš„æ–¹å¼ï¼Œä»–å¯¹æ•°æ®ç»“æ„æ˜¯æ²¡æœ‰è¦æ±‚çš„ï¼Œä¸ç®¡ä¸Šå±‚çš„æ•°æ®ç»“æ„æ˜¯ä»€ä¹ˆï¼Œä»–éƒ½èƒ½ä¿è¯é«˜æ•ˆåœ°æ‰§è¡Œï¼\n\nå› æ­¤æˆ‘çš„æœ€ç»ˆç­”æ¡ˆ:å¦‚æœæ•°æ®ç»“æ„æ˜¯ArrayListè¿™ç§æ•°æ®ç»“æ„ï¼Œé‚£ä½ å¯ä»¥é‡‡ç”¨for,ä½†æ˜¯ä½ çš„æ•°æ®ç»“æ„å¦‚æœæ˜¯LinkListé‚£ä½ åƒä¸‡åˆ«å†ç”¨for,åº”è¯¥æœæ–­é‡‡ç”¨forEach,å› ä¸ºæ•°æ®ä¸€å¤šèµ·æ¥çš„ï¼Œforæ­¤æ—¶çš„æ•ˆç‡ä½å¾—å¯æ€œï¼Œè¯´ä¸å®šä½ çš„æœºå™¨å°±ç˜«ç—ªäº†ã€‚è¿™ä¹Ÿæ˜¯ä¼˜åŒ–çš„ä¸€ä¸ªå°æŠ€å·§å§ï¼Œå¸Œæœ›èƒ½å¸®åŠ©å¤§å®¶ã€‚\n\n#### å°ç»“ä¸€ä¸‹\n\nå¹¶è¡Œæµå­¦ä¼šäº†ï¼Œä½ çš„åŠŸåŠ›ï¼ŒçœŸçš„å°±å¢é•¿äº†ã€‚æ•ˆç‡å†ä¹Ÿä¸æ˜¯é—®é¢˜äº†ï¼ŒåŸºæœ¬ä¸Šå…³äºå¹¶è¡Œæµçš„æ–¹æ–¹é¢é¢ï¼Œè¿™ç¯‡æ–‡ç« éƒ½å·²ç»è¯´æåˆ°äº†ï¼Œä½†æ˜¯Streamåœ¨JDKä¸­çš„å˜åŒ–è¿˜æ˜¯æŒºå¿«çš„ï¼Œæˆ‘ä¸€æ—¦å‘ç°æœ‰ä»€ä¹ˆæ”¹åŠ¨ï¼Œä¼šæœ€å¿«åœ°æ›´æ–°è¿™ç¯‡æ–‡ç« ã€‚ä¸‹ä¸€ç¯‡æˆ‘ä»¬ç»§ç»­æ¢ç´¢æ–°çŸ¥è¯†ç‚¹ã€‚\n","source":"_posts/æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆå››ï¼‰å¹¶è¡Œæµ.md","raw":"---\ntitle: Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆå››ï¼‰å¹¶è¡Œæµ\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: æ–°ç‰¹æ€§\n---\n\néšç€å¯¹æµAPIè®¤è¯†çš„æ…¢æ…¢æ·±å…¥ï¼Œæœ¬ç« æˆ‘ä»¬è¦è®¨è®ºçš„çŸ¥è¯†ç‚¹æ˜¯æµAPIé‡Œé¢çš„å¹¶è¡Œæµäº†ã€‚\n\nåœ¨å¼€å§‹è®¨è®ºå¹¶è¡Œæµä¹‹å‰ï¼Œæˆ‘å…ˆå¼•å‘ä¸€ä¸‹å¤§å®¶çš„æ€è€ƒï¼Œå°±ä½ çœ‹åˆ°è¿™ç¯‡æ–‡ç« çš„æ—¶é—´ï¼Œä½ ä»¬æ˜¯ä¸æ˜¯ç»å¸¸å¬åˆ°ï¼ŒIntel i7 CPUä»€ä¹ˆ8æ ¸16çº¿ç¨‹ï¼Œä»€ä¹ˆAndroidæ‰‹æœº8æ ¸4GBè¿™ç§æ¶ˆæ¯ï¼Œæ—¢ç„¶æˆ‘ä»¬æ˜¯å¤„äºä¸€ä¸ªå¤šæ ¸å¤„ç†å™¨çš„æ—¶ä»£ï¼Œä½ ä»¬æœ‰æ²¡æœ‰æƒ³è¿‡å¹¶è¡Œåœ°æ“ä½œæ•°ç»„å’Œé›†åˆæ¡†æ¶ï¼Œä»è€Œé«˜é€Ÿåœ°æ‰§è¡Œæˆ‘ä»¬å¯¹æ•°ç»„æˆ–è€…é›†åˆçš„ä¸€äº›æ“ä½œå‘¢ï¼Ÿ\n\næˆ–è®¸ä½ æœ‰æƒ³è¿‡è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯å› ä¸ºå¹¶è¡Œç¼–ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œæ‰€ä»¥è¿™äº›æƒ³æ³•è¿˜åœç•™åœ¨ä½ çš„è„‘æµ·å½“ä¸­ï¼Œåˆæˆ–è€…ä½ å·²ç»åœ¨è·¯ä¸Šäº†ï¼Œåæ­£ä½ ä»¬å°±æ˜¯æœ€æ£’çš„ï¼ˆæˆ‘ä»–å¦ˆéƒ½è¿™ä¹ˆå¤¸ä½ ä»¬äº†ï¼Œå°±ä¸èƒ½ç‚¹ä¸ªå–œæ¬¢ï¼Ÿï¼‰ã€‚\n\nä¸ç®¡å¦‚ä½•ï¼Œåœ¨ä½ çœ‹åˆ°è¿™ä¸€ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œæˆ‘å°†å¸¦ä½ èµ°å‘å¹¶è¡Œåœ°æ“ä½œæ•°ç»„æˆ–è€…é›†åˆï¼Œå½“ç„¶æ˜¯ä½¿ç”¨æˆ‘ä»¬çš„å¹¶è¡ŒæµçŸ¥è¯†å•¦ã€‚\n\n#### å¹¶è¡Œæµ\n\nå¹¶è¡Œç¼–ç¨‹å¯è°“æ˜¯ååˆ†å¤æ‚å¹¶ä¸”å¾ˆå®¹æ˜“å‡ºé”™çš„ï¼Œè¿™ä¼°è®¡å°±æ˜¯æˆ‘ä»¬ç»å¤§éƒ¨åˆ†äººçš„æ‹¦è„šçŸ³ã€‚åˆšå¥½Streamæµåº“ç»™æˆ‘ä»¬è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œåœ¨æµAPIåº“é‡Œé¢æä¾›äº†è½»æ¾å¯é çš„å¹¶è¡Œæ“ä½œã€‚è¦æƒ³å¹¶è¡Œå¤„ç†æµç›¸å½“ç®€å•ï¼Œåªéœ€è¦ä½¿ç”¨ä¸€ä¸ªå¹¶è¡Œæµå°±å¯ä»¥äº†ã€‚\n\nå¦‚ç¬¬äºŒç¯‡æ–‡ç« ä¸­æåˆ°çš„é‚£æ ·ï¼Œæˆ‘ä»¬è·å–ä¸€ä¸ªå¹¶è¡Œæµæ˜¯éå¸¸ç®€å•çš„ï¼Œåªéœ€è¦å¯¹æµè°ƒç”¨ä¸€ä¸‹parallel()å°±å¯ä»¥è·å–åˆ°ä¸€ä¸ªå¹¶è¡Œæµäº†ï¼ˆä»€ä¹ˆä½ å±…ç„¶ä¸çŸ¥é“ï¼Ÿé‚£ä¹ˆå¤šäººçœ‹äº†æˆ‘çš„æ–‡ç« ï¼Œä¼°è®¡ä½ è¦è¢«ä»–ä»¬ç”©å¼€å‡ æ¡è¡—äº†ï¼Œèµ¶ç´§å›å»çœ‹å§ã€‚ï¼‰ï¼Œç¬¬äºŒç§æ–¹å¼å°±æ›´åŠ ç®€å•äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Collectionæ¥å£æä¾›ç»™æˆ‘ä»¬parallelStream(),ä¹Ÿæ˜¯å¯ä»¥è·å–åˆ°ä¸€ä¸ªå¹¶è¡Œæµçš„ã€‚\n\nå½“ç„¶ï¼Œå¹¶è¡Œæ“ä½œè‚¯å®šæ˜¯éœ€è¦ç¯å¢ƒæ”¯æŒçš„ï¼Œä½ æäº†ä¸€å°ä¸€æ ¸ä¸€çº¿ç¨‹çš„å°éœ¸ç‹ï¼Œæ¥è·‘æˆ‘çš„é«˜å¤§ä¸Šå¹¶è¡Œæµï¼Œæˆ‘ä¹Ÿåªèƒ½æ…¢æ…¢æ¥äº†ã€‚å¦‚æœä½ ä¸æ˜¯å°éœ¸ç‹ï¼Œé‚£æˆ‘ä»¬å¯ä»¥å¼€å§‹è¿™èŠ‚è¯¾çš„å®æˆ˜äº†ï¼Œå…ˆæ‹¿ä¸Šä¸€ç¯‡çš„ä¾‹å­æ¥æ”¹ä¸€ä¸‹å…ˆï¼Œå¦‚æœä½ ä¸è®¤çœŸè§‚å¯Ÿï¼Œä½ éƒ½æ‰¾ä¸å‡ºä»–ä»¬çš„ä¸åŒä¹‹å¤„ï¼š\n\n```\npublic class Main {\n\n    public static void main(String[] args) {\n        learnStream();\n    }\n\n\n\n    private static void learnStream() {\n        List<Integer> lists = new ArrayList<>();\n        lists.add(1);\n        lists.add(2);\n        lists.add(3);\n        lists.add(4);\n        lists.add(5);\n        lists.add(6);\n\n        Optional<Integer> sum = lists.parallelStream().reduce((a, b) -> a + b);//è¿™é‡ŒæŠŠstream()æ¢æˆäº†parallelStreamï¼ˆï¼‰\n        if (sum.isPresent()) System.out.println(\"listçš„æ€»å’Œä¸º:\" + sum.get());//21\n        //<====> lists.stream().reduce((a, b) -> a + b).ifPresent(System.out::println);\n\n        Integer sum2 = lists.stream().reduce(0, (a, b) -> a + b);//21\n        System.out.println(\"listçš„æ€»å’Œä¸º:\" + sum2);\n\n        Optional<Integer> product = lists.stream().reduce((a, b) -> a * b);\n        if (product.isPresent()) System.out.println(\"listçš„ç§¯ä¸º:\" + product.get());//720\n\n        Integer product2 = lists.parallelStream().reduce(1, (a, b) -> a * b);//è¿™é‡ŒæŠŠstream()æ¢æˆäº†parallelStreamï¼ˆï¼‰\n        System.out.println(\"listçš„ç§¯ä¸º:\" + product2);//720\n    }\n}\n```\n\nå¾—åˆ°ç»“æœå’Œä¸Šä¸€ç¯‡æ–‡ç« çš„ä¸€æ¨¡ä¸€æ ·ã€‚ä½†æ˜¯å› ä¸ºä¹˜æ³•å’ŒåŠ æ³•æ“ä½œæ˜¯å¯ä»¥å‘ç”Ÿåœ¨ä¸åŒçš„çº¿ç¨‹é‡Œé¢çš„ï¼Œå› æ­¤è¿™ä¸¤ä¸ªä¾‹å­ï¼Œåœ¨æ•°æ®æºè¶³å¤Ÿå¤§çš„æ—¶å€™ï¼Œä»–ä»¬çš„è¿è¡Œçš„æ—¶é—´ï¼Œå·®åˆ«ç›¸å½“åœ°å¤§äº†å•Šã€‚\n\nä¸€èˆ¬æ¥è¯´ï¼Œåº”ç”¨åˆ°å¹¶è¡Œæµçš„ä»»ä½•æ“ä½œéƒ½å¿…é¡»æ˜¯ç¬¦åˆç¼©å‡æ“ä½œçš„ä¸‰ä¸ªçº¦æŸæ¡ä»¶ï¼Œæ— çŠ¶æ€ï¼Œä¸å¹²é¢„ï¼Œå…³è”æ€§ï¼å› ä¸ºè¿™ä¸‰å¤§çº¦æŸç¡®ä¿åœ¨å¹¶è¡Œæµä¸Šæ‰§è¡Œæ“ä½œçš„ç»“æœå’Œåœ¨é¡ºåºæµä¸Šæ‰§è¡Œçš„ç»“æœæ˜¯ç›¸åŒçš„ã€‚\n\næˆ‘ä»¬åœ¨ä¸Šä¸€ç¯‡è®²ç¼©å‡æ“ä½œçš„æ—¶å€™ï¼Œæåˆ°äº†ä¸‰ä¸ªreduce(),ä½†æ˜¯æˆ‘ä»¬åªè®²äº†ä¸¤ä¸ªï¼Œæˆ‘å°±ä¸å’Œä½ ä»¬çš®äº†ï¼Œç›´æ¥å¼€è®²å‰©ä¸‹çš„é‚£ä¸€ä¸ªï¼Œåœ¨å¹¶è¡Œæµé‡Œé¢ï¼Œä½ ä»¬ä¼šå‘ç°è¿™ä¸ªç‰ˆæœ¬çš„reduce()æ‰æ˜¯çœŸçˆ±å•Šï¼\n\n```\npublic interface Stream<T> extends BaseStream<T, Stream<T>> {\n//ã€ã€ã€å¿½ç•¥å…¶ä»–æ— å…³ç´§è¦çš„å…ƒç´ \n<U> U reduce(U identity,\n          BiFunction<U, ? super T, U> accumulator,\n          BinaryOperator<U> combiner);\nï½\n```\n\nåœ¨reduce()çš„è¿™ä¸ªç‰ˆæœ¬å½“ä¸­ï¼Œaccumulatorè¢«ç§°ä¸ºç´¯åŠ å™¨ï¼Œcombinerè¢«ç§°ä¸ºåˆæˆå™¨ï¼Œcombinerå®šä¹‰çš„å‡½æ•°å°†accumulatoræåˆ°çš„ä¸¤ä¸ªå€¼åˆå¹¶èµ·æ¥ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸Šé¢çš„é‚£ä¸ªä¾‹å­æ”¹æˆï¼š\n\n```\n    private static void reduce3th() {\n        List<Integer> lists = new ArrayList<>();\n        lists.add(1);\n        lists.add(2);\n        lists.add(3);\n        lists.add(4);\n        lists.add(5);\n        lists.add(6);\n\n        Integer product2 = lists.parallelStream().reduce(1, (a, b) -> a * b,\n                                                            (a, b) -> a * b);\n        System.out.println(\"listçš„ç§¯ä¸º:\" + product2);//720\n    }\n```\n\nä»–ä»¬å¾—åˆ°çš„ç»“æœè¿˜æ˜¯ä¸€æ ·çš„ã€‚\n\nä½ ä»¬å¯èƒ½ä»¥ä¸ºaccumulatorå’Œcombineræ‰§è¡Œçš„æ“ä½œæ˜¯ç›¸åŒçš„ï¼Œä½†å…¶å®ä»–ä»¬æ˜¯å¯ä»¥ä¸åŒçš„ï¼Œä¸‹é¢çš„ä¾‹å­ï¼Œä½ ä»¬è¦è®¤çœŸçœ‹äº†ï¼šå‡è®¾Listé‡Œé¢æœ‰ä¸‰ä¸ªIntegerç±»å‹çš„å…ƒç´ åˆ†åˆ«ä¸º1ï¼Œ2ï¼Œ3ã€‚\n\nç°åœ¨çš„éœ€æ±‚æ˜¯åˆ†åˆ«è®©Listé‡Œé¢çš„æ¯ä¸ªå…ƒç´ éƒ½æ”¾å¤§ä¸¤å€åï¼Œå†æ±‚ç§¯ã€‚è¿™ä¸ªéœ€æ±‚çš„æ­£ç¡®ç­”æ¡ˆåº”è¯¥æ˜¯48;\n\n```\n    private static void reduce3th() {\n        List<Integer> lists = new ArrayList<>();\n        lists.add(1);\n        lists.add(2);\n        lists.add(3);\n\n        Integer product = lists.parallelStream().reduce(1, (a, b) -> a *  (b * 2),\n                                                           (a, b) -> a * b);\n        System.out.println(\"product:\" + product);//48\n    }\n```\n\nç´¯åŠ å™¨éƒ¨åˆ†æ˜¯å°†ä¸¤ä¸ªå…ƒç´ åˆ†åˆ«æ”¾å¤§ä¸¤å€åï¼Œå†ç›¸ä¹˜,åˆå¹¶å™¨ï¼Œæ˜¯å°†ä¸¤ä¸ªéƒ¨åˆ†ç›¸ä¹˜ï¼å¦‚æœèƒ½ç†è§£è¿™é‡Œï¼Œæ­å–œä½ ï¼Œä½ çš„æŠ€èƒ½æœ‰ç›¸å½“å¤§çš„é•¿è¿›äº†ï¼ä¼°è®¡Streamæµä½ å°±å¯ä»¥æ— å¾€è€Œä¸åˆ©äº†ã€‚\n\nå¦‚æœä½ è¿˜ä¸èƒ½ç†è§£ï¼Œå°±åº”è¯¥ç»§ç»­å¾€ä¸‹çœ‹äº†ï¼Œè·Ÿç€æˆ‘çš„æ­¥ä¼æ…¢æ…¢èµ°ï¼š\n\n```\n    ç´¯åŠ å™¨éƒ¨åˆ†ï¼ˆæ°´å¹³å‘å³ï¼‰\n        accumulator\n-----------------------------â€º\nthread-1:   1 * 1 * 2   =   2    |    åˆå¹¶å™¨æ–¹å‘ï¼ˆç«–ç›´å‘ä¸‹ï¼‰\nthread-2:   1 * 2 * 2   =   4    |         combiner\nthread-3:   1 * 3 * 2   =   6    |   å› æ­¤æœ€ç»ˆçš„ç­”æ¡ˆæ˜¯2  *  4  *  6  =   48ï¼ˆæ²¡æ¯›ç—…ï¼‰\n                                 Ë‡\næ³¨ï¼šæ°´å¹³æ–¹å‘æœ€å‰é¢çš„1å°±æ˜¯identityçš„å€¼\n```\n\næ­¤æ—¶ï¼Œaccumulatorå’Œcombineræ‰§è¡Œçš„æ“ä½œæ˜¯ä¸æ˜¯ä¸€å®šä¸èƒ½ç›¸åŒäº†ã€‚ç†è§£è¿™äº›ï¼Œå¯¹äºç†è§£å¹¶è¡Œæµæ˜¯éå¸¸é‡è¦çš„ã€‚\n\nå¦‚æœæ­¤æ—¶çš„combinerè¿˜æ˜¯å’Œaccumulatorç›¸åŒï¼Œé‚£ä¹ˆç»“æœæ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼šè¯·çœ‹ï¼š\n\n```\n    private static void reduce3th() {\n        List<Integer> lists = new ArrayList<>();\n        lists.add(1);\n        lists.add(2);\n        lists.add(3);\n\n        Integer product = lists.parallelStream().reduce(1, (a, b) -> a *  (b * 2),\n                                                           (a, b) -> a * b * 2 );\n        System.out.println(\"product:\" + product);//192\n    }\n```\n\n192è¿™ä¸ªç­”æ¡ˆæ˜¯æ€ä¹ˆæ¥çš„ï¼Ÿ\n\n```\n    ç´¯åŠ å™¨éƒ¨åˆ†ï¼ˆæ°´å¹³å‘å³ï¼‰\n        accumulator\n-----------------------------â€º\nthread-1:   1 * 1 * 2   =   2          |    åˆå¹¶å™¨æ–¹å‘ï¼ˆç«–ç›´å‘ä¸‹ï¼‰\nthread-2:   1 * 2 * 2   =   4  *  2    |         combiner\nthread-3:   1 * 3 * 2   =   6  *  2    |   å› æ­¤æœ€ç»ˆçš„ç­”æ¡ˆæ˜¯2  *  ï¼ˆ 4  *  2 ï¼‰ *  ï¼ˆ6  *  2ï¼‰  =   192ï¼ˆæ²¡æ¯›ç—…ï¼‰\n                                       Ë‡\næ³¨ï¼šæ°´å¹³æ–¹å‘æœ€å‰é¢çš„1å°±æ˜¯identityçš„å€¼\n```\n\n#### é¡ºåºæµ&å¹¶è¡Œæµ&æ— åºæµä¹‹é—´çš„åˆ‡æ¢æ“ä½œ\n\nå¯¹äºè¿™ä¸‰ç§æµçš„åˆ‡æ¢ï¼Œåœ¨BaseStreamæ¥å£ä¸­æä¾›äº†ç›¸åº”çš„æ–¹æ³•ï¼Œå¦‚æœä½ è¿˜æ²¡æœ‰è®°ä½ï¼Œå›å¤´å†çœ‹ä¸€ä¸‹ç¬¬äºŒç¯‡æ–‡ç« å§ã€‚\n\nå…³äºä½¿ç”¨å¹¶è¡Œæµçš„æ—¶å€™ï¼Œè¿˜æœ‰ä¸€ä¸ªç‚¹éœ€è¦è®°ä½ï¼šå¦‚æœé›†åˆä¸­æˆ–è€…æ•°ç»„ä¸­çš„å…ƒç´ æ˜¯æœ‰åºçš„ï¼Œé‚£ä¹ˆå¯¹åº”çš„æµä¹Ÿæ˜¯æœ‰åºçš„ã€‚ä½†æ˜¯åœ¨ä½¿ç”¨å¹¶è¡Œæµæ—¶ï¼Œæœ‰æ—¶å€™æµæ˜¯æ— åºçš„å°±èƒ½è·å¾—æ€§èƒ½ä¸Šçš„æå‡ã€‚å› ä¸ºå¦‚æœæµæ˜¯æ— åºçš„ï¼Œé‚£ä¹ˆæµçš„æ¯ä¸ªéƒ¨åˆ†éƒ½å¯ä»¥è¢«å•ç‹¬çš„æ“ä½œï¼Œè€Œä¸éœ€è¦ä¸å…¶ä»–éƒ¨åˆ†åè°ƒï¼Œä»è€Œæå‡æ€§èƒ½ã€‚ï¼ˆåˆæ˜¯æ— çŠ¶æ€ï¼Œè¯´å¥½çš„é€€ä¼‘äº†å‘¢ï¼‰ã€‚æ‰€ä»¥å½“æµæ“ä½œçš„é¡ºåºä¸é‡è¦çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡BaseStreamæ¥å£æä¾›çš„unordered()æ–¹æ³•æŠŠæµè½¬æ¢æˆä¸€ä¸ªæ— åºæµä¹‹åï¼Œå†è¿›è¡Œå„ç§æ“ä½œã€‚\n\nå¦å¤–ä¸€ç‚¹:forEach()æ–¹æ³•ä¸ä¸€å®šä¼šä¿ç•™å¹¶è¡Œæµçš„é¡ºåºï¼Œå¦‚æœåœ¨å¯¹å¹¶è¡Œæµçš„æ¯ä¸ªå…ƒç´ æ‰§è¡Œæ“ä½œæ—¶ï¼Œä¹Ÿå¸Œæœ›ä¿ç•™é¡ºåºï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨forEachOrdered()æ–¹æ³•ï¼Œå®ƒçš„ç”¨æ³•å’ŒforEach()æ˜¯ä¸€æ ·çš„ã€‚å› ä¸ºåœ¨å‘å¸ƒç¬¬ä¸€ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œå¤§å®¶å¯¹forEachçš„ååº”æ¯”è¾ƒå¤§ï¼Œå¾ˆå¤šäººå…¶å®å¯¹forEachéƒ½æœ‰æƒ³æ³•ï¼šæ¯”å¦‚è°ƒè¯•éš¾ï¼Œç­‰ç­‰ã€‚å€Ÿè¿™ä¸ªæœºä¼šï¼Œæˆ‘è°ˆä¸€è°ˆæˆ‘å¯¹for&forEachçš„çœ‹æ³•ã€‚\n\næˆ‘ä»¬åœ¨è®¿é—®ä¸€ä¸ªæ•°ç»„å…ƒç´ çš„æ—¶å€™ï¼Œæœ€å¿«çš„æ–¹å¼è‚¯å®šæ˜¯é€šè¿‡ç´¢å¼•å»è®¿é—®çš„å§ï¼Œè€Œforå¾ªç¯éå†çš„æ—¶å€™å°±æ˜¯é€šè¿‡ä¸‹æ ‡è¿›è¡Œçš„ï¼Œæ‰€ä»¥æ•ˆç‡é‚£æ˜¯ç›¸å½“çš„é«˜ï¼Œä½†æ˜¯å½“æˆ‘ä»¬çš„æ•°æ®ç»“æ„ä¸æ˜¯æ•°ç»„çš„æ—¶å€™ï¼Œæ¯”å¦‚æ˜¯é“¾è¡¨çš„æ—¶å€™ï¼Œå¯æƒ³è€ŒçŸ¥ï¼Œforå¾ªç¯çš„æ•ˆç‡æ˜¯æœ‰å¤šä½ï¼Œä½†æ˜¯forEachåº•å±‚é‡‡ç”¨çš„æ˜¯è¿­ä»£å™¨çš„æ–¹å¼ï¼Œä»–å¯¹æ•°æ®ç»“æ„æ˜¯æ²¡æœ‰è¦æ±‚çš„ï¼Œä¸ç®¡ä¸Šå±‚çš„æ•°æ®ç»“æ„æ˜¯ä»€ä¹ˆï¼Œä»–éƒ½èƒ½ä¿è¯é«˜æ•ˆåœ°æ‰§è¡Œï¼\n\nå› æ­¤æˆ‘çš„æœ€ç»ˆç­”æ¡ˆ:å¦‚æœæ•°æ®ç»“æ„æ˜¯ArrayListè¿™ç§æ•°æ®ç»“æ„ï¼Œé‚£ä½ å¯ä»¥é‡‡ç”¨for,ä½†æ˜¯ä½ çš„æ•°æ®ç»“æ„å¦‚æœæ˜¯LinkListé‚£ä½ åƒä¸‡åˆ«å†ç”¨for,åº”è¯¥æœæ–­é‡‡ç”¨forEach,å› ä¸ºæ•°æ®ä¸€å¤šèµ·æ¥çš„ï¼Œforæ­¤æ—¶çš„æ•ˆç‡ä½å¾—å¯æ€œï¼Œè¯´ä¸å®šä½ çš„æœºå™¨å°±ç˜«ç—ªäº†ã€‚è¿™ä¹Ÿæ˜¯ä¼˜åŒ–çš„ä¸€ä¸ªå°æŠ€å·§å§ï¼Œå¸Œæœ›èƒ½å¸®åŠ©å¤§å®¶ã€‚\n\n#### å°ç»“ä¸€ä¸‹\n\nå¹¶è¡Œæµå­¦ä¼šäº†ï¼Œä½ çš„åŠŸåŠ›ï¼ŒçœŸçš„å°±å¢é•¿äº†ã€‚æ•ˆç‡å†ä¹Ÿä¸æ˜¯é—®é¢˜äº†ï¼ŒåŸºæœ¬ä¸Šå…³äºå¹¶è¡Œæµçš„æ–¹æ–¹é¢é¢ï¼Œè¿™ç¯‡æ–‡ç« éƒ½å·²ç»è¯´æåˆ°äº†ï¼Œä½†æ˜¯Streamåœ¨JDKä¸­çš„å˜åŒ–è¿˜æ˜¯æŒºå¿«çš„ï¼Œæˆ‘ä¸€æ—¦å‘ç°æœ‰ä»€ä¹ˆæ”¹åŠ¨ï¼Œä¼šæœ€å¿«åœ°æ›´æ–°è¿™ç¯‡æ–‡ç« ã€‚ä¸‹ä¸€ç¯‡æˆ‘ä»¬ç»§ç»­æ¢ç´¢æ–°çŸ¥è¯†ç‚¹ã€‚\n","slug":"æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹ Stream æµï¼ˆå››ï¼‰å¹¶è¡Œæµ","published":1,"updated":"2025-10-15T07:20:51.506Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu077b007dqkd42ibebwb4","content":"<p>éšç€å¯¹æµAPIè®¤è¯†çš„æ…¢æ…¢æ·±å…¥ï¼Œæœ¬ç« æˆ‘ä»¬è¦è®¨è®ºçš„çŸ¥è¯†ç‚¹æ˜¯æµAPIé‡Œé¢çš„å¹¶è¡Œæµäº†ã€‚</p>\n<p>åœ¨å¼€å§‹è®¨è®ºå¹¶è¡Œæµä¹‹å‰ï¼Œæˆ‘å…ˆå¼•å‘ä¸€ä¸‹å¤§å®¶çš„æ€è€ƒï¼Œå°±ä½ çœ‹åˆ°è¿™ç¯‡æ–‡ç« çš„æ—¶é—´ï¼Œä½ ä»¬æ˜¯ä¸æ˜¯ç»å¸¸å¬åˆ°ï¼ŒIntel i7 CPUä»€ä¹ˆ8æ ¸16çº¿ç¨‹ï¼Œä»€ä¹ˆAndroidæ‰‹æœº8æ ¸4GBè¿™ç§æ¶ˆæ¯ï¼Œæ—¢ç„¶æˆ‘ä»¬æ˜¯å¤„äºä¸€ä¸ªå¤šæ ¸å¤„ç†å™¨çš„æ—¶ä»£ï¼Œä½ ä»¬æœ‰æ²¡æœ‰æƒ³è¿‡å¹¶è¡Œåœ°æ“ä½œæ•°ç»„å’Œé›†åˆæ¡†æ¶ï¼Œä»è€Œé«˜é€Ÿåœ°æ‰§è¡Œæˆ‘ä»¬å¯¹æ•°ç»„æˆ–è€…é›†åˆçš„ä¸€äº›æ“ä½œå‘¢ï¼Ÿ</p>\n<p>æˆ–è®¸ä½ æœ‰æƒ³è¿‡è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯å› ä¸ºå¹¶è¡Œç¼–ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œæ‰€ä»¥è¿™äº›æƒ³æ³•è¿˜åœç•™åœ¨ä½ çš„è„‘æµ·å½“ä¸­ï¼Œåˆæˆ–è€…ä½ å·²ç»åœ¨è·¯ä¸Šäº†ï¼Œåæ­£ä½ ä»¬å°±æ˜¯æœ€æ£’çš„ï¼ˆæˆ‘ä»–å¦ˆéƒ½è¿™ä¹ˆå¤¸ä½ ä»¬äº†ï¼Œå°±ä¸èƒ½ç‚¹ä¸ªå–œæ¬¢ï¼Ÿï¼‰ã€‚</p>\n<p>ä¸ç®¡å¦‚ä½•ï¼Œåœ¨ä½ çœ‹åˆ°è¿™ä¸€ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œæˆ‘å°†å¸¦ä½ èµ°å‘å¹¶è¡Œåœ°æ“ä½œæ•°ç»„æˆ–è€…é›†åˆï¼Œå½“ç„¶æ˜¯ä½¿ç”¨æˆ‘ä»¬çš„å¹¶è¡ŒæµçŸ¥è¯†å•¦ã€‚</p>\n<h4 id=\"å¹¶è¡Œæµ\"><a href=\"#å¹¶è¡Œæµ\" class=\"headerlink\" title=\"å¹¶è¡Œæµ\"></a>å¹¶è¡Œæµ</h4><p>å¹¶è¡Œç¼–ç¨‹å¯è°“æ˜¯ååˆ†å¤æ‚å¹¶ä¸”å¾ˆå®¹æ˜“å‡ºé”™çš„ï¼Œè¿™ä¼°è®¡å°±æ˜¯æˆ‘ä»¬ç»å¤§éƒ¨åˆ†äººçš„æ‹¦è„šçŸ³ã€‚åˆšå¥½Streamæµåº“ç»™æˆ‘ä»¬è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œåœ¨æµAPIåº“é‡Œé¢æä¾›äº†è½»æ¾å¯é çš„å¹¶è¡Œæ“ä½œã€‚è¦æƒ³å¹¶è¡Œå¤„ç†æµç›¸å½“ç®€å•ï¼Œåªéœ€è¦ä½¿ç”¨ä¸€ä¸ªå¹¶è¡Œæµå°±å¯ä»¥äº†ã€‚</p>\n<p>å¦‚ç¬¬äºŒç¯‡æ–‡ç« ä¸­æåˆ°çš„é‚£æ ·ï¼Œæˆ‘ä»¬è·å–ä¸€ä¸ªå¹¶è¡Œæµæ˜¯éå¸¸ç®€å•çš„ï¼Œåªéœ€è¦å¯¹æµè°ƒç”¨ä¸€ä¸‹parallel()å°±å¯ä»¥è·å–åˆ°ä¸€ä¸ªå¹¶è¡Œæµäº†ï¼ˆä»€ä¹ˆä½ å±…ç„¶ä¸çŸ¥é“ï¼Ÿé‚£ä¹ˆå¤šäººçœ‹äº†æˆ‘çš„æ–‡ç« ï¼Œä¼°è®¡ä½ è¦è¢«ä»–ä»¬ç”©å¼€å‡ æ¡è¡—äº†ï¼Œèµ¶ç´§å›å»çœ‹å§ã€‚ï¼‰ï¼Œç¬¬äºŒç§æ–¹å¼å°±æ›´åŠ ç®€å•äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Collectionæ¥å£æä¾›ç»™æˆ‘ä»¬parallelStream(),ä¹Ÿæ˜¯å¯ä»¥è·å–åˆ°ä¸€ä¸ªå¹¶è¡Œæµçš„ã€‚</p>\n<p>å½“ç„¶ï¼Œå¹¶è¡Œæ“ä½œè‚¯å®šæ˜¯éœ€è¦ç¯å¢ƒæ”¯æŒçš„ï¼Œä½ æäº†ä¸€å°ä¸€æ ¸ä¸€çº¿ç¨‹çš„å°éœ¸ç‹ï¼Œæ¥è·‘æˆ‘çš„é«˜å¤§ä¸Šå¹¶è¡Œæµï¼Œæˆ‘ä¹Ÿåªèƒ½æ…¢æ…¢æ¥äº†ã€‚å¦‚æœä½ ä¸æ˜¯å°éœ¸ç‹ï¼Œé‚£æˆ‘ä»¬å¯ä»¥å¼€å§‹è¿™èŠ‚è¯¾çš„å®æˆ˜äº†ï¼Œå…ˆæ‹¿ä¸Šä¸€ç¯‡çš„ä¾‹å­æ¥æ”¹ä¸€ä¸‹å…ˆï¼Œå¦‚æœä½ ä¸è®¤çœŸè§‚å¯Ÿï¼Œä½ éƒ½æ‰¾ä¸å‡ºä»–ä»¬çš„ä¸åŒä¹‹å¤„ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class Main &#123;\n\n    public static void main(String[] args) &#123;\n        learnStream();\n    &#125;\n\n\n\n    private static void learnStream() &#123;\n        List&lt;Integer&gt; lists &#x3D; new ArrayList&lt;&gt;();\n        lists.add(1);\n        lists.add(2);\n        lists.add(3);\n        lists.add(4);\n        lists.add(5);\n        lists.add(6);\n\n        Optional&lt;Integer&gt; sum &#x3D; lists.parallelStream().reduce((a, b) -&gt; a + b);&#x2F;&#x2F;è¿™é‡ŒæŠŠstream()æ¢æˆäº†parallelStreamï¼ˆï¼‰\n        if (sum.isPresent()) System.out.println(&quot;listçš„æ€»å’Œä¸º:&quot; + sum.get());&#x2F;&#x2F;21\n        &#x2F;&#x2F;&lt;&#x3D;&#x3D;&#x3D;&#x3D;&gt; lists.stream().reduce((a, b) -&gt; a + b).ifPresent(System.out::println);\n\n        Integer sum2 &#x3D; lists.stream().reduce(0, (a, b) -&gt; a + b);&#x2F;&#x2F;21\n        System.out.println(&quot;listçš„æ€»å’Œä¸º:&quot; + sum2);\n\n        Optional&lt;Integer&gt; product &#x3D; lists.stream().reduce((a, b) -&gt; a * b);\n        if (product.isPresent()) System.out.println(&quot;listçš„ç§¯ä¸º:&quot; + product.get());&#x2F;&#x2F;720\n\n        Integer product2 &#x3D; lists.parallelStream().reduce(1, (a, b) -&gt; a * b);&#x2F;&#x2F;è¿™é‡ŒæŠŠstream()æ¢æˆäº†parallelStreamï¼ˆï¼‰\n        System.out.println(&quot;listçš„ç§¯ä¸º:&quot; + product2);&#x2F;&#x2F;720\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¾—åˆ°ç»“æœå’Œä¸Šä¸€ç¯‡æ–‡ç« çš„ä¸€æ¨¡ä¸€æ ·ã€‚ä½†æ˜¯å› ä¸ºä¹˜æ³•å’ŒåŠ æ³•æ“ä½œæ˜¯å¯ä»¥å‘ç”Ÿåœ¨ä¸åŒçš„çº¿ç¨‹é‡Œé¢çš„ï¼Œå› æ­¤è¿™ä¸¤ä¸ªä¾‹å­ï¼Œåœ¨æ•°æ®æºè¶³å¤Ÿå¤§çš„æ—¶å€™ï¼Œä»–ä»¬çš„è¿è¡Œçš„æ—¶é—´ï¼Œå·®åˆ«ç›¸å½“åœ°å¤§äº†å•Šã€‚</p>\n<p>ä¸€èˆ¬æ¥è¯´ï¼Œåº”ç”¨åˆ°å¹¶è¡Œæµçš„ä»»ä½•æ“ä½œéƒ½å¿…é¡»æ˜¯ç¬¦åˆç¼©å‡æ“ä½œçš„ä¸‰ä¸ªçº¦æŸæ¡ä»¶ï¼Œæ— çŠ¶æ€ï¼Œä¸å¹²é¢„ï¼Œå…³è”æ€§ï¼å› ä¸ºè¿™ä¸‰å¤§çº¦æŸç¡®ä¿åœ¨å¹¶è¡Œæµä¸Šæ‰§è¡Œæ“ä½œçš„ç»“æœå’Œåœ¨é¡ºåºæµä¸Šæ‰§è¡Œçš„ç»“æœæ˜¯ç›¸åŒçš„ã€‚</p>\n<p>æˆ‘ä»¬åœ¨ä¸Šä¸€ç¯‡è®²ç¼©å‡æ“ä½œçš„æ—¶å€™ï¼Œæåˆ°äº†ä¸‰ä¸ªreduce(),ä½†æ˜¯æˆ‘ä»¬åªè®²äº†ä¸¤ä¸ªï¼Œæˆ‘å°±ä¸å’Œä½ ä»¬çš®äº†ï¼Œç›´æ¥å¼€è®²å‰©ä¸‹çš„é‚£ä¸€ä¸ªï¼Œåœ¨å¹¶è¡Œæµé‡Œé¢ï¼Œä½ ä»¬ä¼šå‘ç°è¿™ä¸ªç‰ˆæœ¬çš„reduce()æ‰æ˜¯çœŸçˆ±å•Šï¼</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public interface Stream&lt;T&gt; extends BaseStream&lt;T, Stream&lt;T&gt;&gt; &#123;\n&#x2F;&#x2F;ã€ã€ã€å¿½ç•¥å…¶ä»–æ— å…³ç´§è¦çš„å…ƒç´ \n&lt;U&gt; U reduce(U identity,\n          BiFunction&lt;U, ? super T, U&gt; accumulator,\n          BinaryOperator&lt;U&gt; combiner);\nï½<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>åœ¨reduce()çš„è¿™ä¸ªç‰ˆæœ¬å½“ä¸­ï¼Œaccumulatorè¢«ç§°ä¸ºç´¯åŠ å™¨ï¼Œcombinerè¢«ç§°ä¸ºåˆæˆå™¨ï¼Œcombinerå®šä¹‰çš„å‡½æ•°å°†accumulatoræåˆ°çš„ä¸¤ä¸ªå€¼åˆå¹¶èµ·æ¥ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸Šé¢çš„é‚£ä¸ªä¾‹å­æ”¹æˆï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void reduce3th() &#123;\n    List&lt;Integer&gt; lists &#x3D; new ArrayList&lt;&gt;();\n    lists.add(1);\n    lists.add(2);\n    lists.add(3);\n    lists.add(4);\n    lists.add(5);\n    lists.add(6);\n\n    Integer product2 &#x3D; lists.parallelStream().reduce(1, (a, b) -&gt; a * b,\n                                                        (a, b) -&gt; a * b);\n    System.out.println(&quot;listçš„ç§¯ä¸º:&quot; + product2);&#x2F;&#x2F;720\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä»–ä»¬å¾—åˆ°çš„ç»“æœè¿˜æ˜¯ä¸€æ ·çš„ã€‚</p>\n<p>ä½ ä»¬å¯èƒ½ä»¥ä¸ºaccumulatorå’Œcombineræ‰§è¡Œçš„æ“ä½œæ˜¯ç›¸åŒçš„ï¼Œä½†å…¶å®ä»–ä»¬æ˜¯å¯ä»¥ä¸åŒçš„ï¼Œä¸‹é¢çš„ä¾‹å­ï¼Œä½ ä»¬è¦è®¤çœŸçœ‹äº†ï¼šå‡è®¾Listé‡Œé¢æœ‰ä¸‰ä¸ªIntegerç±»å‹çš„å…ƒç´ åˆ†åˆ«ä¸º1ï¼Œ2ï¼Œ3ã€‚</p>\n<p>ç°åœ¨çš„éœ€æ±‚æ˜¯åˆ†åˆ«è®©Listé‡Œé¢çš„æ¯ä¸ªå…ƒç´ éƒ½æ”¾å¤§ä¸¤å€åï¼Œå†æ±‚ç§¯ã€‚è¿™ä¸ªéœ€æ±‚çš„æ­£ç¡®ç­”æ¡ˆåº”è¯¥æ˜¯48;</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void reduce3th() &#123;\n    List&lt;Integer&gt; lists &#x3D; new ArrayList&lt;&gt;();\n    lists.add(1);\n    lists.add(2);\n    lists.add(3);\n\n    Integer product &#x3D; lists.parallelStream().reduce(1, (a, b) -&gt; a *  (b * 2),\n                                                       (a, b) -&gt; a * b);\n    System.out.println(&quot;product:&quot; + product);&#x2F;&#x2F;48\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç´¯åŠ å™¨éƒ¨åˆ†æ˜¯å°†ä¸¤ä¸ªå…ƒç´ åˆ†åˆ«æ”¾å¤§ä¸¤å€åï¼Œå†ç›¸ä¹˜,åˆå¹¶å™¨ï¼Œæ˜¯å°†ä¸¤ä¸ªéƒ¨åˆ†ç›¸ä¹˜ï¼å¦‚æœèƒ½ç†è§£è¿™é‡Œï¼Œæ­å–œä½ ï¼Œä½ çš„æŠ€èƒ½æœ‰ç›¸å½“å¤§çš„é•¿è¿›äº†ï¼ä¼°è®¡Streamæµä½ å°±å¯ä»¥æ— å¾€è€Œä¸åˆ©äº†ã€‚</p>\n<p>å¦‚æœä½ è¿˜ä¸èƒ½ç†è§£ï¼Œå°±åº”è¯¥ç»§ç»­å¾€ä¸‹çœ‹äº†ï¼Œè·Ÿç€æˆ‘çš„æ­¥ä¼æ…¢æ…¢èµ°ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">    ç´¯åŠ å™¨éƒ¨åˆ†ï¼ˆæ°´å¹³å‘å³ï¼‰\n        accumulator\n-----------------------------â€º\nthread-1:   1 * 1 * 2   &#x3D;   2    |    åˆå¹¶å™¨æ–¹å‘ï¼ˆç«–ç›´å‘ä¸‹ï¼‰\nthread-2:   1 * 2 * 2   &#x3D;   4    |         combiner\nthread-3:   1 * 3 * 2   &#x3D;   6    |   å› æ­¤æœ€ç»ˆçš„ç­”æ¡ˆæ˜¯2  *  4  *  6  &#x3D;   48ï¼ˆæ²¡æ¯›ç—…ï¼‰\n                                 Ë‡\næ³¨ï¼šæ°´å¹³æ–¹å‘æœ€å‰é¢çš„1å°±æ˜¯identityçš„å€¼<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ­¤æ—¶ï¼Œaccumulatorå’Œcombineræ‰§è¡Œçš„æ“ä½œæ˜¯ä¸æ˜¯ä¸€å®šä¸èƒ½ç›¸åŒäº†ã€‚ç†è§£è¿™äº›ï¼Œå¯¹äºç†è§£å¹¶è¡Œæµæ˜¯éå¸¸é‡è¦çš„ã€‚</p>\n<p>å¦‚æœæ­¤æ—¶çš„combinerè¿˜æ˜¯å’Œaccumulatorç›¸åŒï¼Œé‚£ä¹ˆç»“æœæ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼šè¯·çœ‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void reduce3th() &#123;\n    List&lt;Integer&gt; lists &#x3D; new ArrayList&lt;&gt;();\n    lists.add(1);\n    lists.add(2);\n    lists.add(3);\n\n    Integer product &#x3D; lists.parallelStream().reduce(1, (a, b) -&gt; a *  (b * 2),\n                                                       (a, b) -&gt; a * b * 2 );\n    System.out.println(&quot;product:&quot; + product);&#x2F;&#x2F;192\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>192è¿™ä¸ªç­”æ¡ˆæ˜¯æ€ä¹ˆæ¥çš„ï¼Ÿ</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">    ç´¯åŠ å™¨éƒ¨åˆ†ï¼ˆæ°´å¹³å‘å³ï¼‰\n        accumulator\n-----------------------------â€º\nthread-1:   1 * 1 * 2   &#x3D;   2          |    åˆå¹¶å™¨æ–¹å‘ï¼ˆç«–ç›´å‘ä¸‹ï¼‰\nthread-2:   1 * 2 * 2   &#x3D;   4  *  2    |         combiner\nthread-3:   1 * 3 * 2   &#x3D;   6  *  2    |   å› æ­¤æœ€ç»ˆçš„ç­”æ¡ˆæ˜¯2  *  ï¼ˆ 4  *  2 ï¼‰ *  ï¼ˆ6  *  2ï¼‰  &#x3D;   192ï¼ˆæ²¡æ¯›ç—…ï¼‰\n                                       Ë‡\næ³¨ï¼šæ°´å¹³æ–¹å‘æœ€å‰é¢çš„1å°±æ˜¯identityçš„å€¼<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"é¡ºåºæµ-å¹¶è¡Œæµ-æ— åºæµä¹‹é—´çš„åˆ‡æ¢æ“ä½œ\"><a href=\"#é¡ºåºæµ-å¹¶è¡Œæµ-æ— åºæµä¹‹é—´çš„åˆ‡æ¢æ“ä½œ\" class=\"headerlink\" title=\"é¡ºåºæµ&amp;å¹¶è¡Œæµ&amp;æ— åºæµä¹‹é—´çš„åˆ‡æ¢æ“ä½œ\"></a>é¡ºåºæµ&amp;å¹¶è¡Œæµ&amp;æ— åºæµä¹‹é—´çš„åˆ‡æ¢æ“ä½œ</h4><p>å¯¹äºè¿™ä¸‰ç§æµçš„åˆ‡æ¢ï¼Œåœ¨BaseStreamæ¥å£ä¸­æä¾›äº†ç›¸åº”çš„æ–¹æ³•ï¼Œå¦‚æœä½ è¿˜æ²¡æœ‰è®°ä½ï¼Œå›å¤´å†çœ‹ä¸€ä¸‹ç¬¬äºŒç¯‡æ–‡ç« å§ã€‚</p>\n<p>å…³äºä½¿ç”¨å¹¶è¡Œæµçš„æ—¶å€™ï¼Œè¿˜æœ‰ä¸€ä¸ªç‚¹éœ€è¦è®°ä½ï¼šå¦‚æœé›†åˆä¸­æˆ–è€…æ•°ç»„ä¸­çš„å…ƒç´ æ˜¯æœ‰åºçš„ï¼Œé‚£ä¹ˆå¯¹åº”çš„æµä¹Ÿæ˜¯æœ‰åºçš„ã€‚ä½†æ˜¯åœ¨ä½¿ç”¨å¹¶è¡Œæµæ—¶ï¼Œæœ‰æ—¶å€™æµæ˜¯æ— åºçš„å°±èƒ½è·å¾—æ€§èƒ½ä¸Šçš„æå‡ã€‚å› ä¸ºå¦‚æœæµæ˜¯æ— åºçš„ï¼Œé‚£ä¹ˆæµçš„æ¯ä¸ªéƒ¨åˆ†éƒ½å¯ä»¥è¢«å•ç‹¬çš„æ“ä½œï¼Œè€Œä¸éœ€è¦ä¸å…¶ä»–éƒ¨åˆ†åè°ƒï¼Œä»è€Œæå‡æ€§èƒ½ã€‚ï¼ˆåˆæ˜¯æ— çŠ¶æ€ï¼Œè¯´å¥½çš„é€€ä¼‘äº†å‘¢ï¼‰ã€‚æ‰€ä»¥å½“æµæ“ä½œçš„é¡ºåºä¸é‡è¦çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡BaseStreamæ¥å£æä¾›çš„unordered()æ–¹æ³•æŠŠæµè½¬æ¢æˆä¸€ä¸ªæ— åºæµä¹‹åï¼Œå†è¿›è¡Œå„ç§æ“ä½œã€‚</p>\n<p>å¦å¤–ä¸€ç‚¹:forEach()æ–¹æ³•ä¸ä¸€å®šä¼šä¿ç•™å¹¶è¡Œæµçš„é¡ºåºï¼Œå¦‚æœåœ¨å¯¹å¹¶è¡Œæµçš„æ¯ä¸ªå…ƒç´ æ‰§è¡Œæ“ä½œæ—¶ï¼Œä¹Ÿå¸Œæœ›ä¿ç•™é¡ºåºï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨forEachOrdered()æ–¹æ³•ï¼Œå®ƒçš„ç”¨æ³•å’ŒforEach()æ˜¯ä¸€æ ·çš„ã€‚å› ä¸ºåœ¨å‘å¸ƒç¬¬ä¸€ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œå¤§å®¶å¯¹forEachçš„ååº”æ¯”è¾ƒå¤§ï¼Œå¾ˆå¤šäººå…¶å®å¯¹forEachéƒ½æœ‰æƒ³æ³•ï¼šæ¯”å¦‚è°ƒè¯•éš¾ï¼Œç­‰ç­‰ã€‚å€Ÿè¿™ä¸ªæœºä¼šï¼Œæˆ‘è°ˆä¸€è°ˆæˆ‘å¯¹for&amp;forEachçš„çœ‹æ³•ã€‚</p>\n<p>æˆ‘ä»¬åœ¨è®¿é—®ä¸€ä¸ªæ•°ç»„å…ƒç´ çš„æ—¶å€™ï¼Œæœ€å¿«çš„æ–¹å¼è‚¯å®šæ˜¯é€šè¿‡ç´¢å¼•å»è®¿é—®çš„å§ï¼Œè€Œforå¾ªç¯éå†çš„æ—¶å€™å°±æ˜¯é€šè¿‡ä¸‹æ ‡è¿›è¡Œçš„ï¼Œæ‰€ä»¥æ•ˆç‡é‚£æ˜¯ç›¸å½“çš„é«˜ï¼Œä½†æ˜¯å½“æˆ‘ä»¬çš„æ•°æ®ç»“æ„ä¸æ˜¯æ•°ç»„çš„æ—¶å€™ï¼Œæ¯”å¦‚æ˜¯é“¾è¡¨çš„æ—¶å€™ï¼Œå¯æƒ³è€ŒçŸ¥ï¼Œforå¾ªç¯çš„æ•ˆç‡æ˜¯æœ‰å¤šä½ï¼Œä½†æ˜¯forEachåº•å±‚é‡‡ç”¨çš„æ˜¯è¿­ä»£å™¨çš„æ–¹å¼ï¼Œä»–å¯¹æ•°æ®ç»“æ„æ˜¯æ²¡æœ‰è¦æ±‚çš„ï¼Œä¸ç®¡ä¸Šå±‚çš„æ•°æ®ç»“æ„æ˜¯ä»€ä¹ˆï¼Œä»–éƒ½èƒ½ä¿è¯é«˜æ•ˆåœ°æ‰§è¡Œï¼</p>\n<p>å› æ­¤æˆ‘çš„æœ€ç»ˆç­”æ¡ˆ:å¦‚æœæ•°æ®ç»“æ„æ˜¯ArrayListè¿™ç§æ•°æ®ç»“æ„ï¼Œé‚£ä½ å¯ä»¥é‡‡ç”¨for,ä½†æ˜¯ä½ çš„æ•°æ®ç»“æ„å¦‚æœæ˜¯LinkListé‚£ä½ åƒä¸‡åˆ«å†ç”¨for,åº”è¯¥æœæ–­é‡‡ç”¨forEach,å› ä¸ºæ•°æ®ä¸€å¤šèµ·æ¥çš„ï¼Œforæ­¤æ—¶çš„æ•ˆç‡ä½å¾—å¯æ€œï¼Œè¯´ä¸å®šä½ çš„æœºå™¨å°±ç˜«ç—ªäº†ã€‚è¿™ä¹Ÿæ˜¯ä¼˜åŒ–çš„ä¸€ä¸ªå°æŠ€å·§å§ï¼Œå¸Œæœ›èƒ½å¸®åŠ©å¤§å®¶ã€‚</p>\n<h4 id=\"å°ç»“ä¸€ä¸‹\"><a href=\"#å°ç»“ä¸€ä¸‹\" class=\"headerlink\" title=\"å°ç»“ä¸€ä¸‹\"></a>å°ç»“ä¸€ä¸‹</h4><p>å¹¶è¡Œæµå­¦ä¼šäº†ï¼Œä½ çš„åŠŸåŠ›ï¼ŒçœŸçš„å°±å¢é•¿äº†ã€‚æ•ˆç‡å†ä¹Ÿä¸æ˜¯é—®é¢˜äº†ï¼ŒåŸºæœ¬ä¸Šå…³äºå¹¶è¡Œæµçš„æ–¹æ–¹é¢é¢ï¼Œè¿™ç¯‡æ–‡ç« éƒ½å·²ç»è¯´æåˆ°äº†ï¼Œä½†æ˜¯Streamåœ¨JDKä¸­çš„å˜åŒ–è¿˜æ˜¯æŒºå¿«çš„ï¼Œæˆ‘ä¸€æ—¦å‘ç°æœ‰ä»€ä¹ˆæ”¹åŠ¨ï¼Œä¼šæœ€å¿«åœ°æ›´æ–°è¿™ç¯‡æ–‡ç« ã€‚ä¸‹ä¸€ç¯‡æˆ‘ä»¬ç»§ç»­æ¢ç´¢æ–°çŸ¥è¯†ç‚¹ã€‚</p>\n","excerpt":"","more":"<p>éšç€å¯¹æµAPIè®¤è¯†çš„æ…¢æ…¢æ·±å…¥ï¼Œæœ¬ç« æˆ‘ä»¬è¦è®¨è®ºçš„çŸ¥è¯†ç‚¹æ˜¯æµAPIé‡Œé¢çš„å¹¶è¡Œæµäº†ã€‚</p>\n<p>åœ¨å¼€å§‹è®¨è®ºå¹¶è¡Œæµä¹‹å‰ï¼Œæˆ‘å…ˆå¼•å‘ä¸€ä¸‹å¤§å®¶çš„æ€è€ƒï¼Œå°±ä½ çœ‹åˆ°è¿™ç¯‡æ–‡ç« çš„æ—¶é—´ï¼Œä½ ä»¬æ˜¯ä¸æ˜¯ç»å¸¸å¬åˆ°ï¼ŒIntel i7 CPUä»€ä¹ˆ8æ ¸16çº¿ç¨‹ï¼Œä»€ä¹ˆAndroidæ‰‹æœº8æ ¸4GBè¿™ç§æ¶ˆæ¯ï¼Œæ—¢ç„¶æˆ‘ä»¬æ˜¯å¤„äºä¸€ä¸ªå¤šæ ¸å¤„ç†å™¨çš„æ—¶ä»£ï¼Œä½ ä»¬æœ‰æ²¡æœ‰æƒ³è¿‡å¹¶è¡Œåœ°æ“ä½œæ•°ç»„å’Œé›†åˆæ¡†æ¶ï¼Œä»è€Œé«˜é€Ÿåœ°æ‰§è¡Œæˆ‘ä»¬å¯¹æ•°ç»„æˆ–è€…é›†åˆçš„ä¸€äº›æ“ä½œå‘¢ï¼Ÿ</p>\n<p>æˆ–è®¸ä½ æœ‰æƒ³è¿‡è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯å› ä¸ºå¹¶è¡Œç¼–ç¨‹æ¯”è¾ƒå¤æ‚ï¼Œæ‰€ä»¥è¿™äº›æƒ³æ³•è¿˜åœç•™åœ¨ä½ çš„è„‘æµ·å½“ä¸­ï¼Œåˆæˆ–è€…ä½ å·²ç»åœ¨è·¯ä¸Šäº†ï¼Œåæ­£ä½ ä»¬å°±æ˜¯æœ€æ£’çš„ï¼ˆæˆ‘ä»–å¦ˆéƒ½è¿™ä¹ˆå¤¸ä½ ä»¬äº†ï¼Œå°±ä¸èƒ½ç‚¹ä¸ªå–œæ¬¢ï¼Ÿï¼‰ã€‚</p>\n<p>ä¸ç®¡å¦‚ä½•ï¼Œåœ¨ä½ çœ‹åˆ°è¿™ä¸€ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œæˆ‘å°†å¸¦ä½ èµ°å‘å¹¶è¡Œåœ°æ“ä½œæ•°ç»„æˆ–è€…é›†åˆï¼Œå½“ç„¶æ˜¯ä½¿ç”¨æˆ‘ä»¬çš„å¹¶è¡ŒæµçŸ¥è¯†å•¦ã€‚</p>\n<h4 id=\"å¹¶è¡Œæµ\"><a href=\"#å¹¶è¡Œæµ\" class=\"headerlink\" title=\"å¹¶è¡Œæµ\"></a>å¹¶è¡Œæµ</h4><p>å¹¶è¡Œç¼–ç¨‹å¯è°“æ˜¯ååˆ†å¤æ‚å¹¶ä¸”å¾ˆå®¹æ˜“å‡ºé”™çš„ï¼Œè¿™ä¼°è®¡å°±æ˜¯æˆ‘ä»¬ç»å¤§éƒ¨åˆ†äººçš„æ‹¦è„šçŸ³ã€‚åˆšå¥½Streamæµåº“ç»™æˆ‘ä»¬è§£å†³äº†è¿™ä¸ªé—®é¢˜ï¼Œåœ¨æµAPIåº“é‡Œé¢æä¾›äº†è½»æ¾å¯é çš„å¹¶è¡Œæ“ä½œã€‚è¦æƒ³å¹¶è¡Œå¤„ç†æµç›¸å½“ç®€å•ï¼Œåªéœ€è¦ä½¿ç”¨ä¸€ä¸ªå¹¶è¡Œæµå°±å¯ä»¥äº†ã€‚</p>\n<p>å¦‚ç¬¬äºŒç¯‡æ–‡ç« ä¸­æåˆ°çš„é‚£æ ·ï¼Œæˆ‘ä»¬è·å–ä¸€ä¸ªå¹¶è¡Œæµæ˜¯éå¸¸ç®€å•çš„ï¼Œåªéœ€è¦å¯¹æµè°ƒç”¨ä¸€ä¸‹parallel()å°±å¯ä»¥è·å–åˆ°ä¸€ä¸ªå¹¶è¡Œæµäº†ï¼ˆä»€ä¹ˆä½ å±…ç„¶ä¸çŸ¥é“ï¼Ÿé‚£ä¹ˆå¤šäººçœ‹äº†æˆ‘çš„æ–‡ç« ï¼Œä¼°è®¡ä½ è¦è¢«ä»–ä»¬ç”©å¼€å‡ æ¡è¡—äº†ï¼Œèµ¶ç´§å›å»çœ‹å§ã€‚ï¼‰ï¼Œç¬¬äºŒç§æ–¹å¼å°±æ›´åŠ ç®€å•äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨Collectionæ¥å£æä¾›ç»™æˆ‘ä»¬parallelStream(),ä¹Ÿæ˜¯å¯ä»¥è·å–åˆ°ä¸€ä¸ªå¹¶è¡Œæµçš„ã€‚</p>\n<p>å½“ç„¶ï¼Œå¹¶è¡Œæ“ä½œè‚¯å®šæ˜¯éœ€è¦ç¯å¢ƒæ”¯æŒçš„ï¼Œä½ æäº†ä¸€å°ä¸€æ ¸ä¸€çº¿ç¨‹çš„å°éœ¸ç‹ï¼Œæ¥è·‘æˆ‘çš„é«˜å¤§ä¸Šå¹¶è¡Œæµï¼Œæˆ‘ä¹Ÿåªèƒ½æ…¢æ…¢æ¥äº†ã€‚å¦‚æœä½ ä¸æ˜¯å°éœ¸ç‹ï¼Œé‚£æˆ‘ä»¬å¯ä»¥å¼€å§‹è¿™èŠ‚è¯¾çš„å®æˆ˜äº†ï¼Œå…ˆæ‹¿ä¸Šä¸€ç¯‡çš„ä¾‹å­æ¥æ”¹ä¸€ä¸‹å…ˆï¼Œå¦‚æœä½ ä¸è®¤çœŸè§‚å¯Ÿï¼Œä½ éƒ½æ‰¾ä¸å‡ºä»–ä»¬çš„ä¸åŒä¹‹å¤„ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class Main &#123;\n\n    public static void main(String[] args) &#123;\n        learnStream();\n    &#125;\n\n\n\n    private static void learnStream() &#123;\n        List&lt;Integer&gt; lists &#x3D; new ArrayList&lt;&gt;();\n        lists.add(1);\n        lists.add(2);\n        lists.add(3);\n        lists.add(4);\n        lists.add(5);\n        lists.add(6);\n\n        Optional&lt;Integer&gt; sum &#x3D; lists.parallelStream().reduce((a, b) -&gt; a + b);&#x2F;&#x2F;è¿™é‡ŒæŠŠstream()æ¢æˆäº†parallelStreamï¼ˆï¼‰\n        if (sum.isPresent()) System.out.println(&quot;listçš„æ€»å’Œä¸º:&quot; + sum.get());&#x2F;&#x2F;21\n        &#x2F;&#x2F;&lt;&#x3D;&#x3D;&#x3D;&#x3D;&gt; lists.stream().reduce((a, b) -&gt; a + b).ifPresent(System.out::println);\n\n        Integer sum2 &#x3D; lists.stream().reduce(0, (a, b) -&gt; a + b);&#x2F;&#x2F;21\n        System.out.println(&quot;listçš„æ€»å’Œä¸º:&quot; + sum2);\n\n        Optional&lt;Integer&gt; product &#x3D; lists.stream().reduce((a, b) -&gt; a * b);\n        if (product.isPresent()) System.out.println(&quot;listçš„ç§¯ä¸º:&quot; + product.get());&#x2F;&#x2F;720\n\n        Integer product2 &#x3D; lists.parallelStream().reduce(1, (a, b) -&gt; a * b);&#x2F;&#x2F;è¿™é‡ŒæŠŠstream()æ¢æˆäº†parallelStreamï¼ˆï¼‰\n        System.out.println(&quot;listçš„ç§¯ä¸º:&quot; + product2);&#x2F;&#x2F;720\n    &#125;\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¾—åˆ°ç»“æœå’Œä¸Šä¸€ç¯‡æ–‡ç« çš„ä¸€æ¨¡ä¸€æ ·ã€‚ä½†æ˜¯å› ä¸ºä¹˜æ³•å’ŒåŠ æ³•æ“ä½œæ˜¯å¯ä»¥å‘ç”Ÿåœ¨ä¸åŒçš„çº¿ç¨‹é‡Œé¢çš„ï¼Œå› æ­¤è¿™ä¸¤ä¸ªä¾‹å­ï¼Œåœ¨æ•°æ®æºè¶³å¤Ÿå¤§çš„æ—¶å€™ï¼Œä»–ä»¬çš„è¿è¡Œçš„æ—¶é—´ï¼Œå·®åˆ«ç›¸å½“åœ°å¤§äº†å•Šã€‚</p>\n<p>ä¸€èˆ¬æ¥è¯´ï¼Œåº”ç”¨åˆ°å¹¶è¡Œæµçš„ä»»ä½•æ“ä½œéƒ½å¿…é¡»æ˜¯ç¬¦åˆç¼©å‡æ“ä½œçš„ä¸‰ä¸ªçº¦æŸæ¡ä»¶ï¼Œæ— çŠ¶æ€ï¼Œä¸å¹²é¢„ï¼Œå…³è”æ€§ï¼å› ä¸ºè¿™ä¸‰å¤§çº¦æŸç¡®ä¿åœ¨å¹¶è¡Œæµä¸Šæ‰§è¡Œæ“ä½œçš„ç»“æœå’Œåœ¨é¡ºåºæµä¸Šæ‰§è¡Œçš„ç»“æœæ˜¯ç›¸åŒçš„ã€‚</p>\n<p>æˆ‘ä»¬åœ¨ä¸Šä¸€ç¯‡è®²ç¼©å‡æ“ä½œçš„æ—¶å€™ï¼Œæåˆ°äº†ä¸‰ä¸ªreduce(),ä½†æ˜¯æˆ‘ä»¬åªè®²äº†ä¸¤ä¸ªï¼Œæˆ‘å°±ä¸å’Œä½ ä»¬çš®äº†ï¼Œç›´æ¥å¼€è®²å‰©ä¸‹çš„é‚£ä¸€ä¸ªï¼Œåœ¨å¹¶è¡Œæµé‡Œé¢ï¼Œä½ ä»¬ä¼šå‘ç°è¿™ä¸ªç‰ˆæœ¬çš„reduce()æ‰æ˜¯çœŸçˆ±å•Šï¼</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public interface Stream&lt;T&gt; extends BaseStream&lt;T, Stream&lt;T&gt;&gt; &#123;\n&#x2F;&#x2F;ã€ã€ã€å¿½ç•¥å…¶ä»–æ— å…³ç´§è¦çš„å…ƒç´ \n&lt;U&gt; U reduce(U identity,\n          BiFunction&lt;U, ? super T, U&gt; accumulator,\n          BinaryOperator&lt;U&gt; combiner);\nï½<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>åœ¨reduce()çš„è¿™ä¸ªç‰ˆæœ¬å½“ä¸­ï¼Œaccumulatorè¢«ç§°ä¸ºç´¯åŠ å™¨ï¼Œcombinerè¢«ç§°ä¸ºåˆæˆå™¨ï¼Œcombinerå®šä¹‰çš„å‡½æ•°å°†accumulatoræåˆ°çš„ä¸¤ä¸ªå€¼åˆå¹¶èµ·æ¥ï¼Œå› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠä¸Šé¢çš„é‚£ä¸ªä¾‹å­æ”¹æˆï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void reduce3th() &#123;\n    List&lt;Integer&gt; lists &#x3D; new ArrayList&lt;&gt;();\n    lists.add(1);\n    lists.add(2);\n    lists.add(3);\n    lists.add(4);\n    lists.add(5);\n    lists.add(6);\n\n    Integer product2 &#x3D; lists.parallelStream().reduce(1, (a, b) -&gt; a * b,\n                                                        (a, b) -&gt; a * b);\n    System.out.println(&quot;listçš„ç§¯ä¸º:&quot; + product2);&#x2F;&#x2F;720\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä»–ä»¬å¾—åˆ°çš„ç»“æœè¿˜æ˜¯ä¸€æ ·çš„ã€‚</p>\n<p>ä½ ä»¬å¯èƒ½ä»¥ä¸ºaccumulatorå’Œcombineræ‰§è¡Œçš„æ“ä½œæ˜¯ç›¸åŒçš„ï¼Œä½†å…¶å®ä»–ä»¬æ˜¯å¯ä»¥ä¸åŒçš„ï¼Œä¸‹é¢çš„ä¾‹å­ï¼Œä½ ä»¬è¦è®¤çœŸçœ‹äº†ï¼šå‡è®¾Listé‡Œé¢æœ‰ä¸‰ä¸ªIntegerç±»å‹çš„å…ƒç´ åˆ†åˆ«ä¸º1ï¼Œ2ï¼Œ3ã€‚</p>\n<p>ç°åœ¨çš„éœ€æ±‚æ˜¯åˆ†åˆ«è®©Listé‡Œé¢çš„æ¯ä¸ªå…ƒç´ éƒ½æ”¾å¤§ä¸¤å€åï¼Œå†æ±‚ç§¯ã€‚è¿™ä¸ªéœ€æ±‚çš„æ­£ç¡®ç­”æ¡ˆåº”è¯¥æ˜¯48;</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void reduce3th() &#123;\n    List&lt;Integer&gt; lists &#x3D; new ArrayList&lt;&gt;();\n    lists.add(1);\n    lists.add(2);\n    lists.add(3);\n\n    Integer product &#x3D; lists.parallelStream().reduce(1, (a, b) -&gt; a *  (b * 2),\n                                                       (a, b) -&gt; a * b);\n    System.out.println(&quot;product:&quot; + product);&#x2F;&#x2F;48\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ç´¯åŠ å™¨éƒ¨åˆ†æ˜¯å°†ä¸¤ä¸ªå…ƒç´ åˆ†åˆ«æ”¾å¤§ä¸¤å€åï¼Œå†ç›¸ä¹˜,åˆå¹¶å™¨ï¼Œæ˜¯å°†ä¸¤ä¸ªéƒ¨åˆ†ç›¸ä¹˜ï¼å¦‚æœèƒ½ç†è§£è¿™é‡Œï¼Œæ­å–œä½ ï¼Œä½ çš„æŠ€èƒ½æœ‰ç›¸å½“å¤§çš„é•¿è¿›äº†ï¼ä¼°è®¡Streamæµä½ å°±å¯ä»¥æ— å¾€è€Œä¸åˆ©äº†ã€‚</p>\n<p>å¦‚æœä½ è¿˜ä¸èƒ½ç†è§£ï¼Œå°±åº”è¯¥ç»§ç»­å¾€ä¸‹çœ‹äº†ï¼Œè·Ÿç€æˆ‘çš„æ­¥ä¼æ…¢æ…¢èµ°ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">    ç´¯åŠ å™¨éƒ¨åˆ†ï¼ˆæ°´å¹³å‘å³ï¼‰\n        accumulator\n-----------------------------â€º\nthread-1:   1 * 1 * 2   &#x3D;   2    |    åˆå¹¶å™¨æ–¹å‘ï¼ˆç«–ç›´å‘ä¸‹ï¼‰\nthread-2:   1 * 2 * 2   &#x3D;   4    |         combiner\nthread-3:   1 * 3 * 2   &#x3D;   6    |   å› æ­¤æœ€ç»ˆçš„ç­”æ¡ˆæ˜¯2  *  4  *  6  &#x3D;   48ï¼ˆæ²¡æ¯›ç—…ï¼‰\n                                 Ë‡\næ³¨ï¼šæ°´å¹³æ–¹å‘æœ€å‰é¢çš„1å°±æ˜¯identityçš„å€¼<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>æ­¤æ—¶ï¼Œaccumulatorå’Œcombineræ‰§è¡Œçš„æ“ä½œæ˜¯ä¸æ˜¯ä¸€å®šä¸èƒ½ç›¸åŒäº†ã€‚ç†è§£è¿™äº›ï¼Œå¯¹äºç†è§£å¹¶è¡Œæµæ˜¯éå¸¸é‡è¦çš„ã€‚</p>\n<p>å¦‚æœæ­¤æ—¶çš„combinerè¿˜æ˜¯å’Œaccumulatorç›¸åŒï¼Œé‚£ä¹ˆç»“æœæ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼šè¯·çœ‹ï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">private static void reduce3th() &#123;\n    List&lt;Integer&gt; lists &#x3D; new ArrayList&lt;&gt;();\n    lists.add(1);\n    lists.add(2);\n    lists.add(3);\n\n    Integer product &#x3D; lists.parallelStream().reduce(1, (a, b) -&gt; a *  (b * 2),\n                                                       (a, b) -&gt; a * b * 2 );\n    System.out.println(&quot;product:&quot; + product);&#x2F;&#x2F;192\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>192è¿™ä¸ªç­”æ¡ˆæ˜¯æ€ä¹ˆæ¥çš„ï¼Ÿ</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">    ç´¯åŠ å™¨éƒ¨åˆ†ï¼ˆæ°´å¹³å‘å³ï¼‰\n        accumulator\n-----------------------------â€º\nthread-1:   1 * 1 * 2   &#x3D;   2          |    åˆå¹¶å™¨æ–¹å‘ï¼ˆç«–ç›´å‘ä¸‹ï¼‰\nthread-2:   1 * 2 * 2   &#x3D;   4  *  2    |         combiner\nthread-3:   1 * 3 * 2   &#x3D;   6  *  2    |   å› æ­¤æœ€ç»ˆçš„ç­”æ¡ˆæ˜¯2  *  ï¼ˆ 4  *  2 ï¼‰ *  ï¼ˆ6  *  2ï¼‰  &#x3D;   192ï¼ˆæ²¡æ¯›ç—…ï¼‰\n                                       Ë‡\næ³¨ï¼šæ°´å¹³æ–¹å‘æœ€å‰é¢çš„1å°±æ˜¯identityçš„å€¼<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<h4 id=\"é¡ºåºæµ-å¹¶è¡Œæµ-æ— åºæµä¹‹é—´çš„åˆ‡æ¢æ“ä½œ\"><a href=\"#é¡ºåºæµ-å¹¶è¡Œæµ-æ— åºæµä¹‹é—´çš„åˆ‡æ¢æ“ä½œ\" class=\"headerlink\" title=\"é¡ºåºæµ&amp;å¹¶è¡Œæµ&amp;æ— åºæµä¹‹é—´çš„åˆ‡æ¢æ“ä½œ\"></a>é¡ºåºæµ&amp;å¹¶è¡Œæµ&amp;æ— åºæµä¹‹é—´çš„åˆ‡æ¢æ“ä½œ</h4><p>å¯¹äºè¿™ä¸‰ç§æµçš„åˆ‡æ¢ï¼Œåœ¨BaseStreamæ¥å£ä¸­æä¾›äº†ç›¸åº”çš„æ–¹æ³•ï¼Œå¦‚æœä½ è¿˜æ²¡æœ‰è®°ä½ï¼Œå›å¤´å†çœ‹ä¸€ä¸‹ç¬¬äºŒç¯‡æ–‡ç« å§ã€‚</p>\n<p>å…³äºä½¿ç”¨å¹¶è¡Œæµçš„æ—¶å€™ï¼Œè¿˜æœ‰ä¸€ä¸ªç‚¹éœ€è¦è®°ä½ï¼šå¦‚æœé›†åˆä¸­æˆ–è€…æ•°ç»„ä¸­çš„å…ƒç´ æ˜¯æœ‰åºçš„ï¼Œé‚£ä¹ˆå¯¹åº”çš„æµä¹Ÿæ˜¯æœ‰åºçš„ã€‚ä½†æ˜¯åœ¨ä½¿ç”¨å¹¶è¡Œæµæ—¶ï¼Œæœ‰æ—¶å€™æµæ˜¯æ— åºçš„å°±èƒ½è·å¾—æ€§èƒ½ä¸Šçš„æå‡ã€‚å› ä¸ºå¦‚æœæµæ˜¯æ— åºçš„ï¼Œé‚£ä¹ˆæµçš„æ¯ä¸ªéƒ¨åˆ†éƒ½å¯ä»¥è¢«å•ç‹¬çš„æ“ä½œï¼Œè€Œä¸éœ€è¦ä¸å…¶ä»–éƒ¨åˆ†åè°ƒï¼Œä»è€Œæå‡æ€§èƒ½ã€‚ï¼ˆåˆæ˜¯æ— çŠ¶æ€ï¼Œè¯´å¥½çš„é€€ä¼‘äº†å‘¢ï¼‰ã€‚æ‰€ä»¥å½“æµæ“ä½œçš„é¡ºåºä¸é‡è¦çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡BaseStreamæ¥å£æä¾›çš„unordered()æ–¹æ³•æŠŠæµè½¬æ¢æˆä¸€ä¸ªæ— åºæµä¹‹åï¼Œå†è¿›è¡Œå„ç§æ“ä½œã€‚</p>\n<p>å¦å¤–ä¸€ç‚¹:forEach()æ–¹æ³•ä¸ä¸€å®šä¼šä¿ç•™å¹¶è¡Œæµçš„é¡ºåºï¼Œå¦‚æœåœ¨å¯¹å¹¶è¡Œæµçš„æ¯ä¸ªå…ƒç´ æ‰§è¡Œæ“ä½œæ—¶ï¼Œä¹Ÿå¸Œæœ›ä¿ç•™é¡ºåºï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨forEachOrdered()æ–¹æ³•ï¼Œå®ƒçš„ç”¨æ³•å’ŒforEach()æ˜¯ä¸€æ ·çš„ã€‚å› ä¸ºåœ¨å‘å¸ƒç¬¬ä¸€ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œå¤§å®¶å¯¹forEachçš„ååº”æ¯”è¾ƒå¤§ï¼Œå¾ˆå¤šäººå…¶å®å¯¹forEachéƒ½æœ‰æƒ³æ³•ï¼šæ¯”å¦‚è°ƒè¯•éš¾ï¼Œç­‰ç­‰ã€‚å€Ÿè¿™ä¸ªæœºä¼šï¼Œæˆ‘è°ˆä¸€è°ˆæˆ‘å¯¹for&amp;forEachçš„çœ‹æ³•ã€‚</p>\n<p>æˆ‘ä»¬åœ¨è®¿é—®ä¸€ä¸ªæ•°ç»„å…ƒç´ çš„æ—¶å€™ï¼Œæœ€å¿«çš„æ–¹å¼è‚¯å®šæ˜¯é€šè¿‡ç´¢å¼•å»è®¿é—®çš„å§ï¼Œè€Œforå¾ªç¯éå†çš„æ—¶å€™å°±æ˜¯é€šè¿‡ä¸‹æ ‡è¿›è¡Œçš„ï¼Œæ‰€ä»¥æ•ˆç‡é‚£æ˜¯ç›¸å½“çš„é«˜ï¼Œä½†æ˜¯å½“æˆ‘ä»¬çš„æ•°æ®ç»“æ„ä¸æ˜¯æ•°ç»„çš„æ—¶å€™ï¼Œæ¯”å¦‚æ˜¯é“¾è¡¨çš„æ—¶å€™ï¼Œå¯æƒ³è€ŒçŸ¥ï¼Œforå¾ªç¯çš„æ•ˆç‡æ˜¯æœ‰å¤šä½ï¼Œä½†æ˜¯forEachåº•å±‚é‡‡ç”¨çš„æ˜¯è¿­ä»£å™¨çš„æ–¹å¼ï¼Œä»–å¯¹æ•°æ®ç»“æ„æ˜¯æ²¡æœ‰è¦æ±‚çš„ï¼Œä¸ç®¡ä¸Šå±‚çš„æ•°æ®ç»“æ„æ˜¯ä»€ä¹ˆï¼Œä»–éƒ½èƒ½ä¿è¯é«˜æ•ˆåœ°æ‰§è¡Œï¼</p>\n<p>å› æ­¤æˆ‘çš„æœ€ç»ˆç­”æ¡ˆ:å¦‚æœæ•°æ®ç»“æ„æ˜¯ArrayListè¿™ç§æ•°æ®ç»“æ„ï¼Œé‚£ä½ å¯ä»¥é‡‡ç”¨for,ä½†æ˜¯ä½ çš„æ•°æ®ç»“æ„å¦‚æœæ˜¯LinkListé‚£ä½ åƒä¸‡åˆ«å†ç”¨for,åº”è¯¥æœæ–­é‡‡ç”¨forEach,å› ä¸ºæ•°æ®ä¸€å¤šèµ·æ¥çš„ï¼Œforæ­¤æ—¶çš„æ•ˆç‡ä½å¾—å¯æ€œï¼Œè¯´ä¸å®šä½ çš„æœºå™¨å°±ç˜«ç—ªäº†ã€‚è¿™ä¹Ÿæ˜¯ä¼˜åŒ–çš„ä¸€ä¸ªå°æŠ€å·§å§ï¼Œå¸Œæœ›èƒ½å¸®åŠ©å¤§å®¶ã€‚</p>\n<h4 id=\"å°ç»“ä¸€ä¸‹\"><a href=\"#å°ç»“ä¸€ä¸‹\" class=\"headerlink\" title=\"å°ç»“ä¸€ä¸‹\"></a>å°ç»“ä¸€ä¸‹</h4><p>å¹¶è¡Œæµå­¦ä¼šäº†ï¼Œä½ çš„åŠŸåŠ›ï¼ŒçœŸçš„å°±å¢é•¿äº†ã€‚æ•ˆç‡å†ä¹Ÿä¸æ˜¯é—®é¢˜äº†ï¼ŒåŸºæœ¬ä¸Šå…³äºå¹¶è¡Œæµçš„æ–¹æ–¹é¢é¢ï¼Œè¿™ç¯‡æ–‡ç« éƒ½å·²ç»è¯´æåˆ°äº†ï¼Œä½†æ˜¯Streamåœ¨JDKä¸­çš„å˜åŒ–è¿˜æ˜¯æŒºå¿«çš„ï¼Œæˆ‘ä¸€æ—¦å‘ç°æœ‰ä»€ä¹ˆæ”¹åŠ¨ï¼Œä¼šæœ€å¿«åœ°æ›´æ–°è¿™ç¯‡æ–‡ç« ã€‚ä¸‹ä¸€ç¯‡æˆ‘ä»¬ç»§ç»­æ¢ç´¢æ–°çŸ¥è¯†ç‚¹ã€‚</p>\n"},{"title":"Java 8 æ–°ç‰¹æ€§ä¹‹Streamæµ","date":"2025-10-15T03:36:33.000Z","_content":"\n## æ˜¯ä»€ä¹ˆæ˜¯Streamæµ\n\n`java.util.stream.Stream`\n\nStreamæµå’Œä¼ ç»Ÿçš„IOæµï¼Œå®ƒä»¬éƒ½å«æµï¼Œå´æ˜¯ä¸¤ä¸ªå®Œå…¨ä¸ä¸€æ ·çš„æ¦‚å¿µå’Œä¸œè¥¿ã€‚\n\næµå¯ä»¥ç®€å•çš„è¯´æ˜¯å¤„ç†æ•°æ®é›†åˆçš„ä¸œè¥¿ï¼Œå¯ä»¥ç”³æ˜å¼æµå¼APIæ¥å¤„ç†é›†åˆï¼Œè€Œä¸æ˜¯å†™ä¸€ä¸ªé€»è¾‘å®ç°ã€‚\n\n## æµåˆ†ç±»\n\næµåˆ†ä¸ºé¡ºåºæµåŠå¹¶è¡Œæµï¼Œé¡ºåºæµå³æ¯ä¸ªæŒ‡ä»¤æŒ‰é¡ºåºæ‰§è¡Œï¼Œå¹¶è¡Œæµå³é›†åˆé‡Œé¢çš„æ“ä½œå¹¶è¡Œæ‰§è¡Œã€‚\n\n```\nList<Integer> numbers = Arrays.asList(1, 2, 3);\n\n//ã€€é¡ºåºæµ\nnumbers.stream().forEach(n -> System.out.print(n));\n\n//å¹¶è¡Œæµ\nnumbers.parallelStream().forEach(n -> System.out.print(n));\n```\n\nä»¥ä¸Šä¾‹å­ï¼Œé¡ºåºæµæ€»æ˜¯è¾“å‡º`123`ï¼Œè€Œå¹¶è¡Œæµåˆ™æ¯æ¬¡ç»“æœéƒ½ä¸ä¸€å®šï¼Œå¹¶è¡Œæµä½¿ç”¨äº†ForkJoinPoolåˆ†è€Œæ²»ä¹‹ï¼Œæ‰€ä»¥æ˜ç™½äº†ForkJoinPoolåŸç†çš„åŒå­¦å°±çŸ¥é“å¹¶è¡Œæµçš„çœŸé¢ç›®äº†ã€‚\n\n## åˆ›å»ºæµ\n\n1ã€è°ƒç”¨é›†åˆçš„stream()æ–¹æ³•æˆ–è€…parallelStream()æ–¹æ³•ã€‚\n\n2ã€Stream.of()æ–¹æ³•ï¼Œæœ‰é’ˆå¯¹int,longçš„ä¸“ç”¨æµIntStreamï¼ŒLongStreamã€‚\n\n## ä½¿ç”¨æµ\n\nä»¥ä¸‹ä¸¾äº†æµçš„ä¸€äº›å¸¸ç”¨çš„ç”¨æ³•ã€‚\n\n```\npublic class StreamTest {\n\n\tpublic static void main(String[] args) {\n\t\tSystem.out.println(\"è¿‡æ»¤ï¼æ‰¾å‡ºå¹´çºªå¤§äº18å²çš„äºº\");\n\t\tList<User> list = initList();\n\t\tlist.stream().filter((User user) -> user.getAge() > 18).collect(Collectors.toList())\n\t\t\t\t.forEach(System.out::println);\n\t\tSystem.out.println();\n\n\t\tSystem.out.println(\"æœ€å¤§å€¼ï¼æ‰¾å‡ºæœ€å¤§å¹´çºªçš„äºº\");\n\t\tlist = initList();\n\t\tOptional<User> max = list.stream().max((u1, u2) -> u1.getAge() - u2.getAge());\n\t\tSystem.out.println(max.get());\n\t\tSystem.out.println();\n\n\t\tSystem.out.println(\"æ˜ å°„-è§„çº³ï¼æ±‚æ‰€æœ‰äººçš„å¹´çºªæ€»å’Œ\");\n\t\tlist = initList();\n\t\tOptional<Integer> reduce = list.stream().map(User::getAge).reduce(Integer::sum);\n\t\tSystem.out.println(reduce.get());\n\t\tSystem.out.println();\n\n\t\tSystem.out.println(\"åˆ†ç»„ï¼æŒ‰å¹´çºªåˆ†ç»„\");\n\t\tlist = initList();\n\t\tMap<Integer, List<User>> userMap = list.stream()\n\t\t\t\t.collect(Collectors.groupingBy(User::getAge));\n\t\tMapUtils.verbosePrint(System.out, null, userMap);\n\t\tSystem.out.println();\n\n\t\tSystem.out.println(\"åˆ›å»ºï¼å»é‡ï¼ç»Ÿè®¡\");\n\t\tStream<User> userStream = Stream\n\t\t\t\t.of(new User(\"u1\", 1), new User(\"u2\", 21), new User(\"u2\", 21));\n\t\tSystem.out.println(userStream.distinct().count());\n\t\tSystem.out.println();\n\n\t}\n\n\tpublic static List<User> initList() {\n\t\tList<User> list = new ArrayList<>();\n\t\tlist.add(new User(\"oaby\", 23));\n\t\tlist.add(new User(\"tom\", 11));\n\t\tlist.add(new User(\"john\", 16));\n\t\tlist.add(new User(\"jennis\", 26));\n\t\tlist.add(new User(\"tin\", 26));\n\t\tlist.add(new User(\"army\", 26));\n\t\tlist.add(new User(\"mack\", 19));\n\t\tlist.add(new User(\"jobs\", 65));\n\t\tlist.add(new User(\"jordan\", 23));\n\t\treturn list;\n\t}\n\n}\n```\n\nè¾“å‡ºç»“æœï¼š\n\n\n```\nè¿‡æ»¤ï¼æ‰¾å‡ºå¹´çºªå¤§äº18å²çš„äºº\nUser [username=oaby, age=23]\nUser [username=jennis, age=26]\nUser [username=tin, age=26]\nUser [username=army, age=26]\nUser [username=mack, age=19]\nUser [username=jobs, age=65]\nUser [username=jordan, age=23]\n\næœ€å¤§å€¼ï¼æ‰¾å‡ºæœ€å¤§å¹´çºªçš„äºº\nUser [username=jobs, age=65]\n\næ˜ å°„-è§„çº³ï¼æ±‚æ‰€æœ‰äººçš„å¹´çºªæ€»å’Œ\n235\n\nåˆ†ç»„ï¼æŒ‰å¹´çºªåˆ†ç»„\n{\n    16 = [User [username=john, age=16]]\n    65 = [User [username=jobs, age=65]]\n    19 = [User [username=mack, age=19]]\n    23 = [User [username=oaby, age=23], User [username=jordan, age=23]]\n    26 = [User [username=jennis, age=26], User [username=tin, age=26], User [username=army, age=26]]\n    11 = [User [username=tom, age=11]]\n}\n\nåˆ›å»ºï¼å»é‡ï¼ç»Ÿè®¡\n2\n```\n\nå¯ä»¥çœ‹å‡ºæµæ“ä½œæ•°æ®é›†åˆå¾ˆå¼ºå¤§å§ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯æµåªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼Œå†æ¬¡ä½¿ç”¨éœ€è¦é‡è¦æ‰“å¼€ã€‚\n\næ›´å¤šçš„ç©æ³•å¯ä»¥è‡ªå·±å»ç ”ç©¶å§ã€‚\n\n\n","source":"_posts/æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹Streamæµ.md","raw":"---\ntitle: Java 8 æ–°ç‰¹æ€§ä¹‹Streamæµ\ndate: 2025-10-15 11:36:33\ncategory: åç«¯\ntags: æ–°ç‰¹æ€§\n---\n\n## æ˜¯ä»€ä¹ˆæ˜¯Streamæµ\n\n`java.util.stream.Stream`\n\nStreamæµå’Œä¼ ç»Ÿçš„IOæµï¼Œå®ƒä»¬éƒ½å«æµï¼Œå´æ˜¯ä¸¤ä¸ªå®Œå…¨ä¸ä¸€æ ·çš„æ¦‚å¿µå’Œä¸œè¥¿ã€‚\n\næµå¯ä»¥ç®€å•çš„è¯´æ˜¯å¤„ç†æ•°æ®é›†åˆçš„ä¸œè¥¿ï¼Œå¯ä»¥ç”³æ˜å¼æµå¼APIæ¥å¤„ç†é›†åˆï¼Œè€Œä¸æ˜¯å†™ä¸€ä¸ªé€»è¾‘å®ç°ã€‚\n\n## æµåˆ†ç±»\n\næµåˆ†ä¸ºé¡ºåºæµåŠå¹¶è¡Œæµï¼Œé¡ºåºæµå³æ¯ä¸ªæŒ‡ä»¤æŒ‰é¡ºåºæ‰§è¡Œï¼Œå¹¶è¡Œæµå³é›†åˆé‡Œé¢çš„æ“ä½œå¹¶è¡Œæ‰§è¡Œã€‚\n\n```\nList<Integer> numbers = Arrays.asList(1, 2, 3);\n\n//ã€€é¡ºåºæµ\nnumbers.stream().forEach(n -> System.out.print(n));\n\n//å¹¶è¡Œæµ\nnumbers.parallelStream().forEach(n -> System.out.print(n));\n```\n\nä»¥ä¸Šä¾‹å­ï¼Œé¡ºåºæµæ€»æ˜¯è¾“å‡º`123`ï¼Œè€Œå¹¶è¡Œæµåˆ™æ¯æ¬¡ç»“æœéƒ½ä¸ä¸€å®šï¼Œå¹¶è¡Œæµä½¿ç”¨äº†ForkJoinPoolåˆ†è€Œæ²»ä¹‹ï¼Œæ‰€ä»¥æ˜ç™½äº†ForkJoinPoolåŸç†çš„åŒå­¦å°±çŸ¥é“å¹¶è¡Œæµçš„çœŸé¢ç›®äº†ã€‚\n\n## åˆ›å»ºæµ\n\n1ã€è°ƒç”¨é›†åˆçš„stream()æ–¹æ³•æˆ–è€…parallelStream()æ–¹æ³•ã€‚\n\n2ã€Stream.of()æ–¹æ³•ï¼Œæœ‰é’ˆå¯¹int,longçš„ä¸“ç”¨æµIntStreamï¼ŒLongStreamã€‚\n\n## ä½¿ç”¨æµ\n\nä»¥ä¸‹ä¸¾äº†æµçš„ä¸€äº›å¸¸ç”¨çš„ç”¨æ³•ã€‚\n\n```\npublic class StreamTest {\n\n\tpublic static void main(String[] args) {\n\t\tSystem.out.println(\"è¿‡æ»¤ï¼æ‰¾å‡ºå¹´çºªå¤§äº18å²çš„äºº\");\n\t\tList<User> list = initList();\n\t\tlist.stream().filter((User user) -> user.getAge() > 18).collect(Collectors.toList())\n\t\t\t\t.forEach(System.out::println);\n\t\tSystem.out.println();\n\n\t\tSystem.out.println(\"æœ€å¤§å€¼ï¼æ‰¾å‡ºæœ€å¤§å¹´çºªçš„äºº\");\n\t\tlist = initList();\n\t\tOptional<User> max = list.stream().max((u1, u2) -> u1.getAge() - u2.getAge());\n\t\tSystem.out.println(max.get());\n\t\tSystem.out.println();\n\n\t\tSystem.out.println(\"æ˜ å°„-è§„çº³ï¼æ±‚æ‰€æœ‰äººçš„å¹´çºªæ€»å’Œ\");\n\t\tlist = initList();\n\t\tOptional<Integer> reduce = list.stream().map(User::getAge).reduce(Integer::sum);\n\t\tSystem.out.println(reduce.get());\n\t\tSystem.out.println();\n\n\t\tSystem.out.println(\"åˆ†ç»„ï¼æŒ‰å¹´çºªåˆ†ç»„\");\n\t\tlist = initList();\n\t\tMap<Integer, List<User>> userMap = list.stream()\n\t\t\t\t.collect(Collectors.groupingBy(User::getAge));\n\t\tMapUtils.verbosePrint(System.out, null, userMap);\n\t\tSystem.out.println();\n\n\t\tSystem.out.println(\"åˆ›å»ºï¼å»é‡ï¼ç»Ÿè®¡\");\n\t\tStream<User> userStream = Stream\n\t\t\t\t.of(new User(\"u1\", 1), new User(\"u2\", 21), new User(\"u2\", 21));\n\t\tSystem.out.println(userStream.distinct().count());\n\t\tSystem.out.println();\n\n\t}\n\n\tpublic static List<User> initList() {\n\t\tList<User> list = new ArrayList<>();\n\t\tlist.add(new User(\"oaby\", 23));\n\t\tlist.add(new User(\"tom\", 11));\n\t\tlist.add(new User(\"john\", 16));\n\t\tlist.add(new User(\"jennis\", 26));\n\t\tlist.add(new User(\"tin\", 26));\n\t\tlist.add(new User(\"army\", 26));\n\t\tlist.add(new User(\"mack\", 19));\n\t\tlist.add(new User(\"jobs\", 65));\n\t\tlist.add(new User(\"jordan\", 23));\n\t\treturn list;\n\t}\n\n}\n```\n\nè¾“å‡ºç»“æœï¼š\n\n\n```\nè¿‡æ»¤ï¼æ‰¾å‡ºå¹´çºªå¤§äº18å²çš„äºº\nUser [username=oaby, age=23]\nUser [username=jennis, age=26]\nUser [username=tin, age=26]\nUser [username=army, age=26]\nUser [username=mack, age=19]\nUser [username=jobs, age=65]\nUser [username=jordan, age=23]\n\næœ€å¤§å€¼ï¼æ‰¾å‡ºæœ€å¤§å¹´çºªçš„äºº\nUser [username=jobs, age=65]\n\næ˜ å°„-è§„çº³ï¼æ±‚æ‰€æœ‰äººçš„å¹´çºªæ€»å’Œ\n235\n\nåˆ†ç»„ï¼æŒ‰å¹´çºªåˆ†ç»„\n{\n    16 = [User [username=john, age=16]]\n    65 = [User [username=jobs, age=65]]\n    19 = [User [username=mack, age=19]]\n    23 = [User [username=oaby, age=23], User [username=jordan, age=23]]\n    26 = [User [username=jennis, age=26], User [username=tin, age=26], User [username=army, age=26]]\n    11 = [User [username=tom, age=11]]\n}\n\nåˆ›å»ºï¼å»é‡ï¼ç»Ÿè®¡\n2\n```\n\nå¯ä»¥çœ‹å‡ºæµæ“ä½œæ•°æ®é›†åˆå¾ˆå¼ºå¤§å§ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯æµåªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼Œå†æ¬¡ä½¿ç”¨éœ€è¦é‡è¦æ‰“å¼€ã€‚\n\næ›´å¤šçš„ç©æ³•å¯ä»¥è‡ªå·±å»ç ”ç©¶å§ã€‚\n\n\n","slug":"æ–°ç‰¹æ€§/Java8/Stream/Java 8 æ–°ç‰¹æ€§ä¹‹Streamæµ","published":1,"updated":"2025-10-15T07:20:51.439Z","comments":1,"layout":"post","photos":[],"_id":"cmgsu077c007eqkd40oz0fsvq","content":"<h2 id=\"æ˜¯ä»€ä¹ˆæ˜¯Streamæµ\"><a href=\"#æ˜¯ä»€ä¹ˆæ˜¯Streamæµ\" class=\"headerlink\" title=\"æ˜¯ä»€ä¹ˆæ˜¯Streamæµ\"></a>æ˜¯ä»€ä¹ˆæ˜¯Streamæµ</h2><p><code>java.util.stream.Stream</code></p>\n<p>Streamæµå’Œä¼ ç»Ÿçš„IOæµï¼Œå®ƒä»¬éƒ½å«æµï¼Œå´æ˜¯ä¸¤ä¸ªå®Œå…¨ä¸ä¸€æ ·çš„æ¦‚å¿µå’Œä¸œè¥¿ã€‚</p>\n<p>æµå¯ä»¥ç®€å•çš„è¯´æ˜¯å¤„ç†æ•°æ®é›†åˆçš„ä¸œè¥¿ï¼Œå¯ä»¥ç”³æ˜å¼æµå¼APIæ¥å¤„ç†é›†åˆï¼Œè€Œä¸æ˜¯å†™ä¸€ä¸ªé€»è¾‘å®ç°ã€‚</p>\n<h2 id=\"æµåˆ†ç±»\"><a href=\"#æµåˆ†ç±»\" class=\"headerlink\" title=\"æµåˆ†ç±»\"></a>æµåˆ†ç±»</h2><p>æµåˆ†ä¸ºé¡ºåºæµåŠå¹¶è¡Œæµï¼Œé¡ºåºæµå³æ¯ä¸ªæŒ‡ä»¤æŒ‰é¡ºåºæ‰§è¡Œï¼Œå¹¶è¡Œæµå³é›†åˆé‡Œé¢çš„æ“ä½œå¹¶è¡Œæ‰§è¡Œã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;Integer&gt; numbers &#x3D; Arrays.asList(1, 2, 3);\n\n&#x2F;&#x2F;ã€€é¡ºåºæµ\nnumbers.stream().forEach(n -&gt; System.out.print(n));\n\n&#x2F;&#x2F;å¹¶è¡Œæµ\nnumbers.parallelStream().forEach(n -&gt; System.out.print(n));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä»¥ä¸Šä¾‹å­ï¼Œé¡ºåºæµæ€»æ˜¯è¾“å‡º<code>123</code>ï¼Œè€Œå¹¶è¡Œæµåˆ™æ¯æ¬¡ç»“æœéƒ½ä¸ä¸€å®šï¼Œå¹¶è¡Œæµä½¿ç”¨äº†ForkJoinPoolåˆ†è€Œæ²»ä¹‹ï¼Œæ‰€ä»¥æ˜ç™½äº†ForkJoinPoolåŸç†çš„åŒå­¦å°±çŸ¥é“å¹¶è¡Œæµçš„çœŸé¢ç›®äº†ã€‚</p>\n<h2 id=\"åˆ›å»ºæµ\"><a href=\"#åˆ›å»ºæµ\" class=\"headerlink\" title=\"åˆ›å»ºæµ\"></a>åˆ›å»ºæµ</h2><p>1ã€è°ƒç”¨é›†åˆçš„stream()æ–¹æ³•æˆ–è€…parallelStream()æ–¹æ³•ã€‚</p>\n<p>2ã€Stream.of()æ–¹æ³•ï¼Œæœ‰é’ˆå¯¹int,longçš„ä¸“ç”¨æµIntStreamï¼ŒLongStreamã€‚</p>\n<h2 id=\"ä½¿ç”¨æµ\"><a href=\"#ä½¿ç”¨æµ\" class=\"headerlink\" title=\"ä½¿ç”¨æµ\"></a>ä½¿ç”¨æµ</h2><p>ä»¥ä¸‹ä¸¾äº†æµçš„ä¸€äº›å¸¸ç”¨çš„ç”¨æ³•ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class StreamTest &#123;\n\n\tpublic static void main(String[] args) &#123;\n\t\tSystem.out.println(&quot;è¿‡æ»¤ï¼æ‰¾å‡ºå¹´çºªå¤§äº18å²çš„äºº&quot;);\n\t\tList&lt;User&gt; list &#x3D; initList();\n\t\tlist.stream().filter((User user) -&gt; user.getAge() &gt; 18).collect(Collectors.toList())\n\t\t\t\t.forEach(System.out::println);\n\t\tSystem.out.println();\n\n\t\tSystem.out.println(&quot;æœ€å¤§å€¼ï¼æ‰¾å‡ºæœ€å¤§å¹´çºªçš„äºº&quot;);\n\t\tlist &#x3D; initList();\n\t\tOptional&lt;User&gt; max &#x3D; list.stream().max((u1, u2) -&gt; u1.getAge() - u2.getAge());\n\t\tSystem.out.println(max.get());\n\t\tSystem.out.println();\n\n\t\tSystem.out.println(&quot;æ˜ å°„-è§„çº³ï¼æ±‚æ‰€æœ‰äººçš„å¹´çºªæ€»å’Œ&quot;);\n\t\tlist &#x3D; initList();\n\t\tOptional&lt;Integer&gt; reduce &#x3D; list.stream().map(User::getAge).reduce(Integer::sum);\n\t\tSystem.out.println(reduce.get());\n\t\tSystem.out.println();\n\n\t\tSystem.out.println(&quot;åˆ†ç»„ï¼æŒ‰å¹´çºªåˆ†ç»„&quot;);\n\t\tlist &#x3D; initList();\n\t\tMap&lt;Integer, List&lt;User&gt;&gt; userMap &#x3D; list.stream()\n\t\t\t\t.collect(Collectors.groupingBy(User::getAge));\n\t\tMapUtils.verbosePrint(System.out, null, userMap);\n\t\tSystem.out.println();\n\n\t\tSystem.out.println(&quot;åˆ›å»ºï¼å»é‡ï¼ç»Ÿè®¡&quot;);\n\t\tStream&lt;User&gt; userStream &#x3D; Stream\n\t\t\t\t.of(new User(&quot;u1&quot;, 1), new User(&quot;u2&quot;, 21), new User(&quot;u2&quot;, 21));\n\t\tSystem.out.println(userStream.distinct().count());\n\t\tSystem.out.println();\n\n\t&#125;\n\n\tpublic static List&lt;User&gt; initList() &#123;\n\t\tList&lt;User&gt; list &#x3D; new ArrayList&lt;&gt;();\n\t\tlist.add(new User(&quot;oaby&quot;, 23));\n\t\tlist.add(new User(&quot;tom&quot;, 11));\n\t\tlist.add(new User(&quot;john&quot;, 16));\n\t\tlist.add(new User(&quot;jennis&quot;, 26));\n\t\tlist.add(new User(&quot;tin&quot;, 26));\n\t\tlist.add(new User(&quot;army&quot;, 26));\n\t\tlist.add(new User(&quot;mack&quot;, 19));\n\t\tlist.add(new User(&quot;jobs&quot;, 65));\n\t\tlist.add(new User(&quot;jordan&quot;, 23));\n\t\treturn list;\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¾“å‡ºç»“æœï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">è¿‡æ»¤ï¼æ‰¾å‡ºå¹´çºªå¤§äº18å²çš„äºº\nUser [username&#x3D;oaby, age&#x3D;23]\nUser [username&#x3D;jennis, age&#x3D;26]\nUser [username&#x3D;tin, age&#x3D;26]\nUser [username&#x3D;army, age&#x3D;26]\nUser [username&#x3D;mack, age&#x3D;19]\nUser [username&#x3D;jobs, age&#x3D;65]\nUser [username&#x3D;jordan, age&#x3D;23]\n\næœ€å¤§å€¼ï¼æ‰¾å‡ºæœ€å¤§å¹´çºªçš„äºº\nUser [username&#x3D;jobs, age&#x3D;65]\n\næ˜ å°„-è§„çº³ï¼æ±‚æ‰€æœ‰äººçš„å¹´çºªæ€»å’Œ\n235\n\nåˆ†ç»„ï¼æŒ‰å¹´çºªåˆ†ç»„\n&#123;\n    16 &#x3D; [User [username&#x3D;john, age&#x3D;16]]\n    65 &#x3D; [User [username&#x3D;jobs, age&#x3D;65]]\n    19 &#x3D; [User [username&#x3D;mack, age&#x3D;19]]\n    23 &#x3D; [User [username&#x3D;oaby, age&#x3D;23], User [username&#x3D;jordan, age&#x3D;23]]\n    26 &#x3D; [User [username&#x3D;jennis, age&#x3D;26], User [username&#x3D;tin, age&#x3D;26], User [username&#x3D;army, age&#x3D;26]]\n    11 &#x3D; [User [username&#x3D;tom, age&#x3D;11]]\n&#125;\n\nåˆ›å»ºï¼å»é‡ï¼ç»Ÿè®¡\n2<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥çœ‹å‡ºæµæ“ä½œæ•°æ®é›†åˆå¾ˆå¼ºå¤§å§ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯æµåªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼Œå†æ¬¡ä½¿ç”¨éœ€è¦é‡è¦æ‰“å¼€ã€‚</p>\n<p>æ›´å¤šçš„ç©æ³•å¯ä»¥è‡ªå·±å»ç ”ç©¶å§ã€‚</p>\n","excerpt":"","more":"<h2 id=\"æ˜¯ä»€ä¹ˆæ˜¯Streamæµ\"><a href=\"#æ˜¯ä»€ä¹ˆæ˜¯Streamæµ\" class=\"headerlink\" title=\"æ˜¯ä»€ä¹ˆæ˜¯Streamæµ\"></a>æ˜¯ä»€ä¹ˆæ˜¯Streamæµ</h2><p><code>java.util.stream.Stream</code></p>\n<p>Streamæµå’Œä¼ ç»Ÿçš„IOæµï¼Œå®ƒä»¬éƒ½å«æµï¼Œå´æ˜¯ä¸¤ä¸ªå®Œå…¨ä¸ä¸€æ ·çš„æ¦‚å¿µå’Œä¸œè¥¿ã€‚</p>\n<p>æµå¯ä»¥ç®€å•çš„è¯´æ˜¯å¤„ç†æ•°æ®é›†åˆçš„ä¸œè¥¿ï¼Œå¯ä»¥ç”³æ˜å¼æµå¼APIæ¥å¤„ç†é›†åˆï¼Œè€Œä¸æ˜¯å†™ä¸€ä¸ªé€»è¾‘å®ç°ã€‚</p>\n<h2 id=\"æµåˆ†ç±»\"><a href=\"#æµåˆ†ç±»\" class=\"headerlink\" title=\"æµåˆ†ç±»\"></a>æµåˆ†ç±»</h2><p>æµåˆ†ä¸ºé¡ºåºæµåŠå¹¶è¡Œæµï¼Œé¡ºåºæµå³æ¯ä¸ªæŒ‡ä»¤æŒ‰é¡ºåºæ‰§è¡Œï¼Œå¹¶è¡Œæµå³é›†åˆé‡Œé¢çš„æ“ä½œå¹¶è¡Œæ‰§è¡Œã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">List&lt;Integer&gt; numbers &#x3D; Arrays.asList(1, 2, 3);\n\n&#x2F;&#x2F;ã€€é¡ºåºæµ\nnumbers.stream().forEach(n -&gt; System.out.print(n));\n\n&#x2F;&#x2F;å¹¶è¡Œæµ\nnumbers.parallelStream().forEach(n -&gt; System.out.print(n));<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>ä»¥ä¸Šä¾‹å­ï¼Œé¡ºåºæµæ€»æ˜¯è¾“å‡º<code>123</code>ï¼Œè€Œå¹¶è¡Œæµåˆ™æ¯æ¬¡ç»“æœéƒ½ä¸ä¸€å®šï¼Œå¹¶è¡Œæµä½¿ç”¨äº†ForkJoinPoolåˆ†è€Œæ²»ä¹‹ï¼Œæ‰€ä»¥æ˜ç™½äº†ForkJoinPoolåŸç†çš„åŒå­¦å°±çŸ¥é“å¹¶è¡Œæµçš„çœŸé¢ç›®äº†ã€‚</p>\n<h2 id=\"åˆ›å»ºæµ\"><a href=\"#åˆ›å»ºæµ\" class=\"headerlink\" title=\"åˆ›å»ºæµ\"></a>åˆ›å»ºæµ</h2><p>1ã€è°ƒç”¨é›†åˆçš„stream()æ–¹æ³•æˆ–è€…parallelStream()æ–¹æ³•ã€‚</p>\n<p>2ã€Stream.of()æ–¹æ³•ï¼Œæœ‰é’ˆå¯¹int,longçš„ä¸“ç”¨æµIntStreamï¼ŒLongStreamã€‚</p>\n<h2 id=\"ä½¿ç”¨æµ\"><a href=\"#ä½¿ç”¨æµ\" class=\"headerlink\" title=\"ä½¿ç”¨æµ\"></a>ä½¿ç”¨æµ</h2><p>ä»¥ä¸‹ä¸¾äº†æµçš„ä¸€äº›å¸¸ç”¨çš„ç”¨æ³•ã€‚</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">public class StreamTest &#123;\n\n\tpublic static void main(String[] args) &#123;\n\t\tSystem.out.println(&quot;è¿‡æ»¤ï¼æ‰¾å‡ºå¹´çºªå¤§äº18å²çš„äºº&quot;);\n\t\tList&lt;User&gt; list &#x3D; initList();\n\t\tlist.stream().filter((User user) -&gt; user.getAge() &gt; 18).collect(Collectors.toList())\n\t\t\t\t.forEach(System.out::println);\n\t\tSystem.out.println();\n\n\t\tSystem.out.println(&quot;æœ€å¤§å€¼ï¼æ‰¾å‡ºæœ€å¤§å¹´çºªçš„äºº&quot;);\n\t\tlist &#x3D; initList();\n\t\tOptional&lt;User&gt; max &#x3D; list.stream().max((u1, u2) -&gt; u1.getAge() - u2.getAge());\n\t\tSystem.out.println(max.get());\n\t\tSystem.out.println();\n\n\t\tSystem.out.println(&quot;æ˜ å°„-è§„çº³ï¼æ±‚æ‰€æœ‰äººçš„å¹´çºªæ€»å’Œ&quot;);\n\t\tlist &#x3D; initList();\n\t\tOptional&lt;Integer&gt; reduce &#x3D; list.stream().map(User::getAge).reduce(Integer::sum);\n\t\tSystem.out.println(reduce.get());\n\t\tSystem.out.println();\n\n\t\tSystem.out.println(&quot;åˆ†ç»„ï¼æŒ‰å¹´çºªåˆ†ç»„&quot;);\n\t\tlist &#x3D; initList();\n\t\tMap&lt;Integer, List&lt;User&gt;&gt; userMap &#x3D; list.stream()\n\t\t\t\t.collect(Collectors.groupingBy(User::getAge));\n\t\tMapUtils.verbosePrint(System.out, null, userMap);\n\t\tSystem.out.println();\n\n\t\tSystem.out.println(&quot;åˆ›å»ºï¼å»é‡ï¼ç»Ÿè®¡&quot;);\n\t\tStream&lt;User&gt; userStream &#x3D; Stream\n\t\t\t\t.of(new User(&quot;u1&quot;, 1), new User(&quot;u2&quot;, 21), new User(&quot;u2&quot;, 21));\n\t\tSystem.out.println(userStream.distinct().count());\n\t\tSystem.out.println();\n\n\t&#125;\n\n\tpublic static List&lt;User&gt; initList() &#123;\n\t\tList&lt;User&gt; list &#x3D; new ArrayList&lt;&gt;();\n\t\tlist.add(new User(&quot;oaby&quot;, 23));\n\t\tlist.add(new User(&quot;tom&quot;, 11));\n\t\tlist.add(new User(&quot;john&quot;, 16));\n\t\tlist.add(new User(&quot;jennis&quot;, 26));\n\t\tlist.add(new User(&quot;tin&quot;, 26));\n\t\tlist.add(new User(&quot;army&quot;, 26));\n\t\tlist.add(new User(&quot;mack&quot;, 19));\n\t\tlist.add(new User(&quot;jobs&quot;, 65));\n\t\tlist.add(new User(&quot;jordan&quot;, 23));\n\t\treturn list;\n\t&#125;\n\n&#125;<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>è¾“å‡ºç»“æœï¼š</p>\n<pre class=\"line-numbers language-none\"><code class=\"language-none\">è¿‡æ»¤ï¼æ‰¾å‡ºå¹´çºªå¤§äº18å²çš„äºº\nUser [username&#x3D;oaby, age&#x3D;23]\nUser [username&#x3D;jennis, age&#x3D;26]\nUser [username&#x3D;tin, age&#x3D;26]\nUser [username&#x3D;army, age&#x3D;26]\nUser [username&#x3D;mack, age&#x3D;19]\nUser [username&#x3D;jobs, age&#x3D;65]\nUser [username&#x3D;jordan, age&#x3D;23]\n\næœ€å¤§å€¼ï¼æ‰¾å‡ºæœ€å¤§å¹´çºªçš„äºº\nUser [username&#x3D;jobs, age&#x3D;65]\n\næ˜ å°„-è§„çº³ï¼æ±‚æ‰€æœ‰äººçš„å¹´çºªæ€»å’Œ\n235\n\nåˆ†ç»„ï¼æŒ‰å¹´çºªåˆ†ç»„\n&#123;\n    16 &#x3D; [User [username&#x3D;john, age&#x3D;16]]\n    65 &#x3D; [User [username&#x3D;jobs, age&#x3D;65]]\n    19 &#x3D; [User [username&#x3D;mack, age&#x3D;19]]\n    23 &#x3D; [User [username&#x3D;oaby, age&#x3D;23], User [username&#x3D;jordan, age&#x3D;23]]\n    26 &#x3D; [User [username&#x3D;jennis, age&#x3D;26], User [username&#x3D;tin, age&#x3D;26], User [username&#x3D;army, age&#x3D;26]]\n    11 &#x3D; [User [username&#x3D;tom, age&#x3D;11]]\n&#125;\n\nåˆ›å»ºï¼å»é‡ï¼ç»Ÿè®¡\n2<span aria-hidden=\"true\" class=\"line-numbers-rows\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>\n\n<p>å¯ä»¥çœ‹å‡ºæµæ“ä½œæ•°æ®é›†åˆå¾ˆå¼ºå¤§å§ï¼Œä½†éœ€è¦æ³¨æ„çš„æ˜¯æµåªèƒ½æ‰§è¡Œä¸€æ¬¡ï¼Œå†æ¬¡ä½¿ç”¨éœ€è¦é‡è¦æ‰“å¼€ã€‚</p>\n<p>æ›´å¤šçš„ç©æ³•å¯ä»¥è‡ªå·±å»ç ”ç©¶å§ã€‚</p>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"cmgsu07650001qkd4cw89bbnf","category_id":"cmgsu07690004qkd484knc1h0","_id":"cmgsu076d000fqkd4cey74bm6"},{"post_id":"cmgsu076c000dqkd47jvjh55h","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076f000lqkd47upqbjp3"},{"post_id":"cmgsu07680003qkd42iuygj9v","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076g000pqkd464rd3mng"},{"post_id":"cmgsu076d000eqkd4glyl48p9","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076g000sqkd4fuw6471l"},{"post_id":"cmgsu076e000iqkd4d2ck5ag5","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076h000xqkd40r37eyiv"},{"post_id":"cmgsu076a0007qkd413e6bn54","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076h0010qkd4fekqbg4u"},{"post_id":"cmgsu076f000kqkd40a0y7rel","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076i0014qkd4a5h347am"},{"post_id":"cmgsu076f000oqkd4cxjcdawn","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076i0017qkd4a8kggmvz"},{"post_id":"cmgsu076b0008qkd4ht4ig6e4","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076j001bqkd490oy0q10"},{"post_id":"cmgsu076g000rqkd4fvzra77j","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076j001eqkd48tnr33kk"},{"post_id":"cmgsu076g000wqkd417w28zfm","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076k001iqkd43ffe2xxx"},{"post_id":"cmgsu076c0009qkd4260v5ajm","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076k001lqkd47q4h2doh"},{"post_id":"cmgsu076h000zqkd4b9042yxp","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076l001pqkd4hol9emt6"},{"post_id":"cmgsu076h0013qkd42sjh4ej0","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076l001sqkd4a5aq6nb2"},{"post_id":"cmgsu076i0016qkd498g4cosa","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076m001wqkd4dlqwal1u"},{"post_id":"cmgsu076j001aqkd4f4878bo7","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076m001zqkd46j334scs"},{"post_id":"cmgsu076j001dqkd4d422aq8t","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076m0022qkd45wxdav9a"},{"post_id":"cmgsu076j001hqkd423ox8ra0","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076n0026qkd4batp13gn"},{"post_id":"cmgsu076k001kqkd44fgl9hlq","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076n0029qkd47187fcjq"},{"post_id":"cmgsu076k001oqkd47hvn1fd4","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076o002dqkd43iabf7s9"},{"post_id":"cmgsu076l001rqkd4e7k6bofk","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076o002gqkd4fs2m782f"},{"post_id":"cmgsu076l001vqkd4706abfkz","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076o002jqkd4heq1a5gf"},{"post_id":"cmgsu076m001yqkd4b6j17olg","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076q002mqkd4dlv6g8bs"},{"post_id":"cmgsu076m0021qkd431iqcc5g","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076q002pqkd43zdi7zur"},{"post_id":"cmgsu076n0025qkd40r4ecb2t","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076r002sqkd4h398givp"},{"post_id":"cmgsu076n0028qkd42e5y8lqn","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076r002vqkd48qk86rvy"},{"post_id":"cmgsu076n002cqkd48rqshy9n","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076s002yqkd44nqd3z8z"},{"post_id":"cmgsu076o002fqkd4blhv0iwh","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076s0031qkd47mavckjd"},{"post_id":"cmgsu076o002iqkd4296q7rb9","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076s0034qkd46j4c5cl0"},{"post_id":"cmgsu076p002lqkd437gr0xfm","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076t0037qkd46xj404by"},{"post_id":"cmgsu076q002oqkd411tz6n5b","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076t003aqkd442gq9895"},{"post_id":"cmgsu076r002rqkd42p0o7veo","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076t003eqkd4fyhr0tm7"},{"post_id":"cmgsu076r002uqkd4gvoxcw3r","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076u003hqkd4agkddda1"},{"post_id":"cmgsu076r002xqkd40why35oe","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076u003lqkd49fa16fp1"},{"post_id":"cmgsu076s0030qkd4f7mb7dqg","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076v003oqkd4fx89disu"},{"post_id":"cmgsu076s0033qkd4ddwdap0i","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076v003sqkd4gwc97w27"},{"post_id":"cmgsu076s0036qkd4h11xeyed","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076v003vqkd44hgvh0o8"},{"post_id":"cmgsu076t0039qkd43yqc2emq","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076w003yqkd4cqtd8vny"},{"post_id":"cmgsu076t003dqkd4alg39ec5","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076w0041qkd44w3gaatg"},{"post_id":"cmgsu076t003gqkd4fn3f1uhe","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076w0044qkd457aj0xzx"},{"post_id":"cmgsu076u003jqkd49t6tc10h","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076x0047qkd4flgn1uxe"},{"post_id":"cmgsu076u003nqkd48kavh4lg","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076x004aqkd4anox7m60"},{"post_id":"cmgsu076v003qqkd4cndjac5l","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076x004dqkd46e5ucogx"},{"post_id":"cmgsu076v003uqkd49gus83ml","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076y004gqkd4fpo56aog"},{"post_id":"cmgsu076v003xqkd4ajswdron","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076y004jqkd43xn61v02"},{"post_id":"cmgsu076w0040qkd45oqzaqxy","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076z004mqkd4bdqoev18"},{"post_id":"cmgsu076w0043qkd420r86rm2","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076z004pqkd4az4gdmf2"},{"post_id":"cmgsu076w0046qkd42f033a2v","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu076z004sqkd4bymne9lm"},{"post_id":"cmgsu076x0049qkd4954efqqm","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu0770004vqkd4hae67esa"},{"post_id":"cmgsu076x004cqkd4ez50c4c3","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu0771004zqkd4esb8d7io"},{"post_id":"cmgsu076y004fqkd4aol40svf","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu07710052qkd40c7f9yal"},{"post_id":"cmgsu076y004iqkd415ts7h45","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu07720056qkd41we912l5"},{"post_id":"cmgsu076y004lqkd494h1csj8","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu07730059qkd44lfx5xwt"},{"post_id":"cmgsu076z004oqkd4c1mr7a2v","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu0774005dqkd45dosg84y"},{"post_id":"cmgsu076z004rqkd4fpic9h04","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu0774005gqkd41mgx5dyd"},{"post_id":"cmgsu0770004uqkd4eb9b9k23","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu0775005jqkd45n1w4uw1"},{"post_id":"cmgsu0770004yqkd4gdt57lbu","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu0775005mqkd4ao1iejd2"},{"post_id":"cmgsu07710051qkd4az5ndksw","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu0775005pqkd4ah347qxk"},{"post_id":"cmgsu07710054qkd46z658v2m","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu0776005sqkd4hecq0pm6"},{"post_id":"cmgsu07720058qkd43z0c8xvf","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu0776005vqkd4cndk4qke"},{"post_id":"cmgsu0773005bqkd4boqfh6mo","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu0776005yqkd4aoqa6q1e"},{"post_id":"cmgsu0774005fqkd4eze9657b","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu07770061qkd433r74x4d"},{"post_id":"cmgsu0775005iqkd44ykeei73","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu07770064qkd46a5k42t3"},{"post_id":"cmgsu0775005lqkd4g5wg2nkh","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu07770067qkd4cxx725al"},{"post_id":"cmgsu0775005oqkd47g96fnmy","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu0778006aqkd43il8dpjq"},{"post_id":"cmgsu0776005rqkd4aqhv9mgk","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu0778006dqkd42udbahku"},{"post_id":"cmgsu0776005uqkd4b4172lae","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu0778006gqkd4bul14vj6"},{"post_id":"cmgsu0776005xqkd415qc4dkv","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu0779006jqkd4alkz9s5d"},{"post_id":"cmgsu07770060qkd42y7u2124","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu0779006mqkd4htfr3ord"},{"post_id":"cmgsu07770063qkd4ef5d5z3h","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu077a006pqkd4bnho8gun"},{"post_id":"cmgsu07770066qkd4giprgphe","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu077a006sqkd42vdwd1ug"},{"post_id":"cmgsu07770069qkd4ga92fel1","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu077a006vqkd4h6he8ied"},{"post_id":"cmgsu0778006cqkd47kih04u2","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu077b006yqkd4bp0nbq5e"},{"post_id":"cmgsu0778006fqkd4ae9z6hs8","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu077b0070qkd478ygbv1l"},{"post_id":"cmgsu0779006iqkd45sit7qro","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu077b0072qkd4fd2s61fh"},{"post_id":"cmgsu0779006lqkd4faqhax6o","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu077b0074qkd4fcas1jwh"},{"post_id":"cmgsu0779006oqkd418tq5mpd","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu077b0076qkd46m4p4vx0"},{"post_id":"cmgsu077a006rqkd4flbfd9t1","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu077b0078qkd41nai7pq8"},{"post_id":"cmgsu077a006uqkd4e06sgza9","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu077b007aqkd48v2r48xo"},{"post_id":"cmgsu077a006xqkd4ep8vcgtq","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu077b007cqkd43ez15kzu"},{"post_id":"cmgsu077b007dqkd42ibebwb4","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu077c007hqkd4ad7500vu"},{"post_id":"cmgsu077c007eqkd40oz0fsvq","category_id":"cmgsu076c000aqkd4csl5d6aa","_id":"cmgsu077c007iqkd43ntydyre"}],"PostTag":[{"post_id":"cmgsu07650001qkd4cw89bbnf","tag_id":"cmgsu076a0005qkd4hhyq8a6n","_id":"cmgsu076c000cqkd490oe7gin"},{"post_id":"cmgsu07680003qkd42iuygj9v","tag_id":"cmgsu076c000bqkd42e9qgyrj","_id":"cmgsu076e000jqkd458ebezo7"},{"post_id":"cmgsu076a0007qkd413e6bn54","tag_id":"cmgsu076d000hqkd44iz37joo","_id":"cmgsu076g000qqkd46ece7vtw"},{"post_id":"cmgsu076f000oqkd4cxjcdawn","tag_id":"cmgsu076f000nqkd4buey5n84","_id":"cmgsu076g000uqkd48hv2agot"},{"post_id":"cmgsu076b0008qkd4ht4ig6e4","tag_id":"cmgsu076f000nqkd4buey5n84","_id":"cmgsu076h000yqkd4ha2b71jb"},{"post_id":"cmgsu076g000rqkd4fvzra77j","tag_id":"cmgsu076f000nqkd4buey5n84","_id":"cmgsu076h0011qkd49ie52piw"},{"post_id":"cmgsu076g000wqkd417w28zfm","tag_id":"cmgsu076f000nqkd4buey5n84","_id":"cmgsu076i0015qkd42u2pf0ue"},{"post_id":"cmgsu076c0009qkd4260v5ajm","tag_id":"cmgsu076f000nqkd4buey5n84","_id":"cmgsu076i0018qkd412bf649u"},{"post_id":"cmgsu076h000zqkd4b9042yxp","tag_id":"cmgsu076f000nqkd4buey5n84","_id":"cmgsu076j001cqkd422tf9fd0"},{"post_id":"cmgsu076h0013qkd42sjh4ej0","tag_id":"cmgsu076f000nqkd4buey5n84","_id":"cmgsu076j001fqkd45s4ibnh8"},{"post_id":"cmgsu076c000dqkd47jvjh55h","tag_id":"cmgsu076f000nqkd4buey5n84","_id":"cmgsu076k001jqkd48vad10me"},{"post_id":"cmgsu076i0016qkd498g4cosa","tag_id":"cmgsu076f000nqkd4buey5n84","_id":"cmgsu076k001mqkd45oaca90y"},{"post_id":"cmgsu076j001aqkd4f4878bo7","tag_id":"cmgsu076f000nqkd4buey5n84","_id":"cmgsu076l001qqkd4e3zsckxt"},{"post_id":"cmgsu076d000eqkd4glyl48p9","tag_id":"cmgsu076f000nqkd4buey5n84","_id":"cmgsu076l001tqkd463zd7xmi"},{"post_id":"cmgsu076j001dqkd4d422aq8t","tag_id":"cmgsu076f000nqkd4buey5n84","_id":"cmgsu076m001xqkd49oxbe9ma"},{"post_id":"cmgsu076j001hqkd423ox8ra0","tag_id":"cmgsu076f000nqkd4buey5n84","_id":"cmgsu076m0020qkd4club09kd"},{"post_id":"cmgsu076e000iqkd4d2ck5ag5","tag_id":"cmgsu076f000nqkd4buey5n84","_id":"cmgsu076n0024qkd4bce762ux"},{"post_id":"cmgsu076k001kqkd44fgl9hlq","tag_id":"cmgsu076f000nqkd4buey5n84","_id":"cmgsu076n0027qkd460vd76xf"},{"post_id":"cmgsu076f000kqkd40a0y7rel","tag_id":"cmgsu076f000nqkd4buey5n84","_id":"cmgsu076n002bqkd407dq7von"},{"post_id":"cmgsu076m001yqkd4b6j17olg","tag_id":"cmgsu076l001uqkd4h1bfembx","_id":"cmgsu076o002eqkd49a9kf4cp"},{"post_id":"cmgsu076k001oqkd47hvn1fd4","tag_id":"cmgsu076l001uqkd4h1bfembx","_id":"cmgsu076o002hqkd46i25846r"},{"post_id":"cmgsu076m0021qkd431iqcc5g","tag_id":"cmgsu076l001uqkd4h1bfembx","_id":"cmgsu076p002kqkd4bj9t5b5w"},{"post_id":"cmgsu076n0025qkd40r4ecb2t","tag_id":"cmgsu076l001uqkd4h1bfembx","_id":"cmgsu076q002nqkd49d0802di"},{"post_id":"cmgsu076l001rqkd4e7k6bofk","tag_id":"cmgsu076l001uqkd4h1bfembx","_id":"cmgsu076r002qqkd4g3u6gnpf"},{"post_id":"cmgsu076n0028qkd42e5y8lqn","tag_id":"cmgsu076l001uqkd4h1bfembx","_id":"cmgsu076r002tqkd47zel83qt"},{"post_id":"cmgsu076n002cqkd48rqshy9n","tag_id":"cmgsu076l001uqkd4h1bfembx","_id":"cmgsu076r002wqkd421yodrbx"},{"post_id":"cmgsu076l001vqkd4706abfkz","tag_id":"cmgsu076l001uqkd4h1bfembx","_id":"cmgsu076s002zqkd484k66tdf"},{"post_id":"cmgsu076o002fqkd4blhv0iwh","tag_id":"cmgsu076l001uqkd4h1bfembx","_id":"cmgsu076s0032qkd4d85e2imo"},{"post_id":"cmgsu076o002iqkd4296q7rb9","tag_id":"cmgsu076l001uqkd4h1bfembx","_id":"cmgsu076s0035qkd4h1and37f"},{"post_id":"cmgsu076p002lqkd437gr0xfm","tag_id":"cmgsu076l001uqkd4h1bfembx","_id":"cmgsu076t0038qkd455h72eaz"},{"post_id":"cmgsu076q002oqkd411tz6n5b","tag_id":"cmgsu076l001uqkd4h1bfembx","_id":"cmgsu076t003cqkd41kt2h88s"},{"post_id":"cmgsu076r002rqkd42p0o7veo","tag_id":"cmgsu076l001uqkd4h1bfembx","_id":"cmgsu076t003fqkd44bhv8ze5"},{"post_id":"cmgsu076r002uqkd4gvoxcw3r","tag_id":"cmgsu076l001uqkd4h1bfembx","_id":"cmgsu076u003iqkd48hf097if"},{"post_id":"cmgsu076r002xqkd40why35oe","tag_id":"cmgsu076l001uqkd4h1bfembx","_id":"cmgsu076u003mqkd416rz258j"},{"post_id":"cmgsu076s0030qkd4f7mb7dqg","tag_id":"cmgsu076l001uqkd4h1bfembx","_id":"cmgsu076v003pqkd46ela1psx"},{"post_id":"cmgsu076s0033qkd4ddwdap0i","tag_id":"cmgsu076l001uqkd4h1bfembx","_id":"cmgsu076v003tqkd45yctaox0"},{"post_id":"cmgsu076s0036qkd4h11xeyed","tag_id":"cmgsu076t003bqkd46465c4ax","_id":"cmgsu076v003wqkd4hmqbd1h1"},{"post_id":"cmgsu076u003jqkd49t6tc10h","tag_id":"cmgsu076t003bqkd46465c4ax","_id":"cmgsu076w003zqkd4gtmc7bph"},{"post_id":"cmgsu076u003nqkd48kavh4lg","tag_id":"cmgsu076t003bqkd46465c4ax","_id":"cmgsu076w0042qkd48vk0e4l4"},{"post_id":"cmgsu076t0039qkd43yqc2emq","tag_id":"cmgsu076t003bqkd46465c4ax","_id":"cmgsu076w0045qkd4dx7v4sxv"},{"post_id":"cmgsu076v003qqkd4cndjac5l","tag_id":"cmgsu076t003bqkd46465c4ax","_id":"cmgsu076x0048qkd4b36bcrdg"},{"post_id":"cmgsu076v003uqkd49gus83ml","tag_id":"cmgsu076t003bqkd46465c4ax","_id":"cmgsu076x004bqkd441qnev5q"},{"post_id":"cmgsu076t003dqkd4alg39ec5","tag_id":"cmgsu076t003bqkd46465c4ax","_id":"cmgsu076x004eqkd48hgv2fn2"},{"post_id":"cmgsu076v003xqkd4ajswdron","tag_id":"cmgsu076t003bqkd46465c4ax","_id":"cmgsu076y004hqkd4gcrj2okf"},{"post_id":"cmgsu076w0040qkd45oqzaqxy","tag_id":"cmgsu076t003bqkd46465c4ax","_id":"cmgsu076y004kqkd41cf5ao13"},{"post_id":"cmgsu076w0043qkd420r86rm2","tag_id":"cmgsu076t003bqkd46465c4ax","_id":"cmgsu076z004nqkd4605q4kkl"},{"post_id":"cmgsu076w0046qkd42f033a2v","tag_id":"cmgsu076t003bqkd46465c4ax","_id":"cmgsu076z004qqkd43v9a497n"},{"post_id":"cmgsu076x0049qkd4954efqqm","tag_id":"cmgsu076t003bqkd46465c4ax","_id":"cmgsu0770004tqkd49hy60if8"},{"post_id":"cmgsu076x004cqkd4ez50c4c3","tag_id":"cmgsu076t003bqkd46465c4ax","_id":"cmgsu0770004xqkd42wivfd6z"},{"post_id":"cmgsu076y004fqkd4aol40svf","tag_id":"cmgsu076t003bqkd46465c4ax","_id":"cmgsu07710050qkd43bu2c46u"},{"post_id":"cmgsu076y004iqkd415ts7h45","tag_id":"cmgsu076t003bqkd46465c4ax","_id":"cmgsu07710053qkd4guskcx81"},{"post_id":"cmgsu076y004lqkd494h1csj8","tag_id":"cmgsu076t003bqkd46465c4ax","_id":"cmgsu07720057qkd4cy7m4xlz"},{"post_id":"cmgsu076z004oqkd4c1mr7a2v","tag_id":"cmgsu076t003bqkd46465c4ax","_id":"cmgsu0773005aqkd43w3vgrfc"},{"post_id":"cmgsu07710051qkd4az5ndksw","tag_id":"cmgsu0770004wqkd4guqbamtk","_id":"cmgsu0774005eqkd4cffk9vfs"},{"post_id":"cmgsu076z004rqkd4fpic9h04","tag_id":"cmgsu0770004wqkd4guqbamtk","_id":"cmgsu0775005hqkd4a752fe2l"},{"post_id":"cmgsu07710054qkd46z658v2m","tag_id":"cmgsu076d000hqkd44iz37joo","_id":"cmgsu0775005kqkd42xph3jt8"},{"post_id":"cmgsu07720058qkd43z0c8xvf","tag_id":"cmgsu076d000hqkd44iz37joo","_id":"cmgsu0775005nqkd45uys6uc0"},{"post_id":"cmgsu0770004uqkd4eb9b9k23","tag_id":"cmgsu0770004wqkd4guqbamtk","_id":"cmgsu0776005qqkd47pgl4us5"},{"post_id":"cmgsu0773005bqkd4boqfh6mo","tag_id":"cmgsu076d000hqkd44iz37joo","_id":"cmgsu0776005tqkd42x1c1l7z"},{"post_id":"cmgsu0774005fqkd4eze9657b","tag_id":"cmgsu076d000hqkd44iz37joo","_id":"cmgsu0776005wqkd4gpl1gbk2"},{"post_id":"cmgsu0770004yqkd4gdt57lbu","tag_id":"cmgsu0770004wqkd4guqbamtk","_id":"cmgsu0776005zqkd42o7m7aal"},{"post_id":"cmgsu0775005iqkd44ykeei73","tag_id":"cmgsu076d000hqkd44iz37joo","_id":"cmgsu07770062qkd4hxsz4wwy"},{"post_id":"cmgsu0775005lqkd4g5wg2nkh","tag_id":"cmgsu076d000hqkd44iz37joo","_id":"cmgsu07770065qkd40l4o17dy"},{"post_id":"cmgsu0775005oqkd47g96fnmy","tag_id":"cmgsu076d000hqkd44iz37joo","_id":"cmgsu07770068qkd4byad81o3"},{"post_id":"cmgsu0776005rqkd4aqhv9mgk","tag_id":"cmgsu076d000hqkd44iz37joo","_id":"cmgsu0778006bqkd4hoz73sfm"},{"post_id":"cmgsu0776005uqkd4b4172lae","tag_id":"cmgsu076d000hqkd44iz37joo","_id":"cmgsu0778006eqkd49ts8dqrv"},{"post_id":"cmgsu0776005xqkd415qc4dkv","tag_id":"cmgsu076d000hqkd44iz37joo","_id":"cmgsu0779006hqkd491m619rc"},{"post_id":"cmgsu07770060qkd42y7u2124","tag_id":"cmgsu076d000hqkd44iz37joo","_id":"cmgsu0779006kqkd40qdk7cgm"},{"post_id":"cmgsu07770063qkd4ef5d5z3h","tag_id":"cmgsu076d000hqkd44iz37joo","_id":"cmgsu0779006nqkd4bx3q8vim"},{"post_id":"cmgsu07770066qkd4giprgphe","tag_id":"cmgsu076d000hqkd44iz37joo","_id":"cmgsu077a006qqkd4c5rk1f0y"},{"post_id":"cmgsu07770069qkd4ga92fel1","tag_id":"cmgsu076d000hqkd44iz37joo","_id":"cmgsu077a006tqkd420dyafet"},{"post_id":"cmgsu0778006cqkd47kih04u2","tag_id":"cmgsu076d000hqkd44iz37joo","_id":"cmgsu077a006wqkd49b5b9h3l"},{"post_id":"cmgsu0778006fqkd4ae9z6hs8","tag_id":"cmgsu076d000hqkd44iz37joo","_id":"cmgsu077b006zqkd4cha0b44x"},{"post_id":"cmgsu0779006iqkd45sit7qro","tag_id":"cmgsu076d000hqkd44iz37joo","_id":"cmgsu077b0071qkd47ha7a1mb"},{"post_id":"cmgsu0779006lqkd4faqhax6o","tag_id":"cmgsu076d000hqkd44iz37joo","_id":"cmgsu077b0073qkd41ay17rqt"},{"post_id":"cmgsu0779006oqkd418tq5mpd","tag_id":"cmgsu076d000hqkd44iz37joo","_id":"cmgsu077b0075qkd43h5bdg8v"},{"post_id":"cmgsu077a006rqkd4flbfd9t1","tag_id":"cmgsu076d000hqkd44iz37joo","_id":"cmgsu077b0077qkd4357faucs"},{"post_id":"cmgsu077a006uqkd4e06sgza9","tag_id":"cmgsu076d000hqkd44iz37joo","_id":"cmgsu077b0079qkd4gwz6afm1"},{"post_id":"cmgsu077a006xqkd4ep8vcgtq","tag_id":"cmgsu076d000hqkd44iz37joo","_id":"cmgsu077b007bqkd4cg76crpo"},{"post_id":"cmgsu077b007dqkd42ibebwb4","tag_id":"cmgsu076d000hqkd44iz37joo","_id":"cmgsu077c007fqkd44aii2z8w"},{"post_id":"cmgsu077c007eqkd40oz0fsvq","tag_id":"cmgsu076d000hqkd44iz37joo","_id":"cmgsu077c007gqkd49ijh4vs7"}],"Tag":[{"name":"æ–‡ç« ","_id":"cmgsu076a0005qkd4hhyq8a6n"},{"name":"JVM","_id":"cmgsu076c000bqkd42e9qgyrj"},{"name":"æ–°ç‰¹æ€§","_id":"cmgsu076d000hqkd44iz37joo"},{"name":"è¿›é˜¶","_id":"cmgsu076f000nqkd4buey5n84"},{"name":"å¤šçº¿ç¨‹","_id":"cmgsu076l001uqkd4h1bfembx"},{"name":"åŸºç¡€","_id":"cmgsu076t003bqkd46465c4ax"},{"name":"é›†åˆ","_id":"cmgsu0770004wqkd4guqbamtk"}]}}